"use strict";(self.webpackChunk_rocket_chat_meteor=self.webpackChunk_rocket_chat_meteor||[]).push([[6478],{"./app/otr/lib/OtrRoomState.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Q:function(){return OtrRoomState}});var OtrRoomState=function(OtrRoomState){return OtrRoomState.DISABLED="DISABLED",OtrRoomState.NOT_STARTED="NOT_STARTED",OtrRoomState.REQUESTED="REQUESTED",OtrRoomState.ESTABLISHING="ESTABLISHING",OtrRoomState.ESTABLISHED="ESTABLISHED",OtrRoomState.ERROR="ERROR",OtrRoomState.TIMEOUT="TIMEOUT",OtrRoomState.DECLINED="DECLINED",OtrRoomState}({})},"./client/views/room/contexts/RoomContext.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Mq:function(){return useRoomSubscription},Nl:function(){return useUserIsSubscribed},RV:function(){return useRoomMessages},Zq:function(){return useVoipRoom},nq:function(){return useRoom},p:function(){return RoomContext},vK:function(){return useOmnichannelRoom}});var _rocket_chat_core_typings__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core-typings/dist/index.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),RoomContext=(0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)(null),useUserIsSubscribed=function useUserIsSubscribed(){var context=(0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(RoomContext);if(!context)throw new Error("use useRoom only inside opened rooms");return!!context.subscription},useRoom=function useRoom(){var context=(0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(RoomContext);if(!context)throw new Error("use useRoom only inside opened rooms");return context.room},useRoomSubscription=function useRoomSubscription(){var context=(0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(RoomContext);if(!context)throw new Error("use useRoomSubscription only inside opened rooms");return context.subscription},useRoomMessages=function useRoomMessages(){var context=(0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(RoomContext);if(!context)throw new Error("use useRoomMessages only inside opened rooms");return{hasMorePreviousMessages:context.hasMorePreviousMessages,hasMoreNextMessages:context.hasMoreNextMessages,isLoadingMoreMessages:context.isLoadingMoreMessages}},useOmnichannelRoom=function useOmnichannelRoom(){var room=((0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(RoomContext)||{}).room;if(!room)throw new Error("use useRoom only inside opened rooms");if(!(0,_rocket_chat_core_typings__WEBPACK_IMPORTED_MODULE_0__.isOmnichannelRoom)(room))throw new Error("invalid room type");return room},useVoipRoom=function useVoipRoom(){var room=((0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(RoomContext)||{}).room;if(!room)throw new Error("use useRoom only inside opened rooms");if(!(0,_rocket_chat_core_typings__WEBPACK_IMPORTED_MODULE_0__.isVoipRoom)(room))throw new Error("invalid room type");return room}},"./client/views/room/contextualBar/OTR/OTR.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{A:function(){return OTR_OTR}});var fuselage=__webpack_require__("./node_modules/@rocket.chat/fuselage/index.js"),dist=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react=__webpack_require__("./node_modules/react/index.js"),OtrRoomState=__webpack_require__("./app/otr/lib/OtrRoomState.ts"),Contextualbar=__webpack_require__("./client/components/Contextualbar/index.ts"),RoomContext=__webpack_require__("./client/views/room/contexts/RoomContext.ts"),OTREstablished=function OTREstablished(_ref){var onClickRefresh=_ref.onClickRefresh,onClickEnd=_ref.onClickEnd,t=(0,dist.useTranslation)();return react.createElement(fuselage.ButtonGroup,{stretch:!0},react.createElement(fuselage.Button,{onClick:onClickRefresh},t("Refresh_keys")),react.createElement(fuselage.Button,{secondary:!0,danger:!0,onClick:onClickEnd},t("End_OTR")))},components_OTREstablished=OTREstablished;OTREstablished.__docgenInfo={description:"",methods:[],displayName:"OTREstablished",props:{onClickRefresh:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onClickEnd:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};var OTRStates=function OTRStates(_ref){var title=_ref.title,description=_ref.description,icon=_ref.icon,onClickStart=_ref.onClickStart,t=(0,dist.useTranslation)();return react.createElement(fuselage.States,null,react.createElement(fuselage.StatesIcon,{name:icon}),react.createElement(fuselage.StatesTitle,null,title),react.createElement(fuselage.StatesSubtitle,null,description),react.createElement(fuselage.StatesActions,null,react.createElement(fuselage.StatesAction,{onClick:onClickStart},t("New_OTR_Chat"))))},components_OTRStates=OTRStates;OTRStates.__docgenInfo={description:"",methods:[],displayName:"OTRStates",props:{title:{required:!0,tsType:{name:"string"},description:""},description:{required:!0,tsType:{name:"string"},description:""},icon:{required:!0,tsType:{name:"IconName"},description:""},onClickStart:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};var OTR=function OTR(_ref){var isOnline=_ref.isOnline,onClickClose=_ref.onClickClose,onClickStart=_ref.onClickStart,onClickEnd=_ref.onClickEnd,onClickRefresh=_ref.onClickRefresh,otrState=_ref.otrState,peerUsername=_ref.peerUsername,t=(0,dist.useTranslation)(),room=(0,RoomContext.nq)();return react.createElement(react.Fragment,null,react.createElement(Contextualbar.mH,null,react.createElement(Contextualbar.A4,{name:"stopwatch"}),react.createElement(Contextualbar.jY,null,t("OTR")),onClickClose&&react.createElement(Contextualbar.pi,{onClick:onClickClose})),react.createElement(Contextualbar.xN,{p:24,color:"default"},react.createElement(fuselage.Box,{fontScale:"h4"},t("Off_the_record_conversation")),function renderOTRBody(){return room.encrypted?react.createElement(fuselage.Callout,{title:t("OTR_not_available"),type:"warning"},t("OTR_not_available_e2ee")):isOnline?function renderOTRState(){switch(otrState){case OtrRoomState.Q.NOT_STARTED:return react.createElement(fuselage.Button,{onClick:onClickStart,primary:!0},t("Start_OTR"));case OtrRoomState.Q.ESTABLISHING:return react.createElement(fuselage.Box,null,react.createElement(fuselage.Box,{fontScale:"p2"},t("Please_wait_while_OTR_is_being_established")),react.createElement(fuselage.Box,{mb:16},react.createElement(fuselage.Throbber,null)));case OtrRoomState.Q.ESTABLISHED:return react.createElement(components_OTREstablished,{onClickEnd:onClickEnd,onClickRefresh:onClickRefresh});case OtrRoomState.Q.DECLINED:return react.createElement(components_OTRStates,{title:t("OTR_Chat_Declined_Title"),description:t("OTR_Chat_Declined_Description",peerUsername||""),icon:"cross",onClickStart:onClickStart});case OtrRoomState.Q.TIMEOUT:return react.createElement(components_OTRStates,{title:t("OTR_Chat_Timeout_Title"),description:t("OTR_Chat_Timeout_Description",peerUsername||""),icon:"clock",onClickStart:onClickStart});default:return react.createElement(components_OTRStates,{title:t("OTR_Chat_Error_Title"),description:t("OTR_Chat_Error_Description"),icon:"warning",onClickStart:onClickStart})}}():react.createElement(fuselage.Box,{fontScale:"p2m"},t("OTR_is_only_available_when_both_users_are_online"))}()))},OTR_OTR=OTR;OTR.__docgenInfo={description:"",methods:[],displayName:"OTR",props:{isOnline:{required:!0,tsType:{name:"boolean"},description:""},onClickClose:{required:!0,tsType:{name:"MouseEventHandler",elements:[{name:"HTMLOrSVGElement"}],raw:"MouseEventHandler<HTMLOrSVGElement>"},description:""},onClickStart:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onClickEnd:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onClickRefresh:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},otrState:{required:!0,tsType:{name:"string"},description:""},peerUsername:{required:!0,tsType:{name:"IUser['username']",raw:"IUser['username']"},description:""}}}},"./client/views/room/contextualBar/OTR/OTR.stories.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Declined:function(){return Declined},Default:function(){return Default},Established:function(){return Established},Establishing:function(){return Establishing},Timeout:function(){return Timeout},Unavailable:function(){return Unavailable},__namedExportsOrder:function(){return __namedExportsOrder}});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_app_otr_lib_OtrRoomState__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./app/otr/lib/OtrRoomState.ts"),_components_Contextualbar__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./client/components/Contextualbar/index.ts"),_OTR__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./client/views/room/contextualBar/OTR/OTR.tsx");__webpack_exports__.default={title:"Room/Contextual Bar/OTR",component:_OTR__WEBPACK_IMPORTED_MODULE_3__.A,parameters:{layout:"fullscreen",actions:{argTypesRegex:"^on.*"}},decorators:[fn=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_Contextualbar__WEBPACK_IMPORTED_MODULE_2__.bc,{height:"100vh"},fn())]};const Template=args=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(_OTR__WEBPACK_IMPORTED_MODULE_3__.A,args),Default=Template.bind({});Default.args={isOnline:!0,otrState:_app_otr_lib_OtrRoomState__WEBPACK_IMPORTED_MODULE_1__.Q.NOT_STARTED};const Establishing=Template.bind({});Establishing.args={isOnline:!0,otrState:_app_otr_lib_OtrRoomState__WEBPACK_IMPORTED_MODULE_1__.Q.ESTABLISHING};const Established=Template.bind({});Established.args={isOnline:!0,otrState:_app_otr_lib_OtrRoomState__WEBPACK_IMPORTED_MODULE_1__.Q.ESTABLISHED};const Unavailable=Template.bind({});Unavailable.args={isOnline:!1};const Timeout=Template.bind({});Timeout.args={isOnline:!0,otrState:_app_otr_lib_OtrRoomState__WEBPACK_IMPORTED_MODULE_1__.Q.TIMEOUT,peerUsername:"testUser"};const Declined=Template.bind({});Declined.args={isOnline:!0,otrState:_app_otr_lib_OtrRoomState__WEBPACK_IMPORTED_MODULE_1__.Q.DECLINED,peerUsername:"testUser"};const __namedExportsOrder=["Default","Establishing","Established","Unavailable","Timeout","Declined"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => <OTR {...args} />",...Default.parameters?.docs?.source}}},Establishing.parameters={...Establishing.parameters,docs:{...Establishing.parameters?.docs,source:{originalSource:"args => <OTR {...args} />",...Establishing.parameters?.docs?.source}}},Established.parameters={...Established.parameters,docs:{...Established.parameters?.docs,source:{originalSource:"args => <OTR {...args} />",...Established.parameters?.docs?.source}}},Unavailable.parameters={...Unavailable.parameters,docs:{...Unavailable.parameters?.docs,source:{originalSource:"args => <OTR {...args} />",...Unavailable.parameters?.docs?.source}}},Timeout.parameters={...Timeout.parameters,docs:{...Timeout.parameters?.docs,source:{originalSource:"args => <OTR {...args} />",...Timeout.parameters?.docs?.source}}},Declined.parameters={...Declined.parameters,docs:{...Declined.parameters?.docs,source:{originalSource:"args => <OTR {...args} />",...Declined.parameters?.docs?.source}}}}}]);