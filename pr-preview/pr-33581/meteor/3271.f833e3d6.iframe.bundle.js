/*! For license information please see 3271.f833e3d6.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunk_rocket_chat_meteor=self.webpackChunk_rocket_chat_meteor||[]).push([[3271],{"./.storybook/mocks/empty.ts":function(){},"./client/voip/modal/DialPad/DialPadModal.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return DialPad_DialPadModal}});var index_module=__webpack_require__("./node_modules/@rocket.chat/css-in-js/dist/index.module.js"),fuselage=__webpack_require__("./node_modules/@rocket.chat/fuselage/index.js"),react=__webpack_require__("./node_modules/react/index.js"),dist=__webpack_require__("../../packages/ui-contexts/dist/index.js"),DialInput=(0,react.forwardRef)((function DialInput(_ref,ref){var handleBackspaceClick=_ref.handleBackspaceClick,handleOnChange=_ref.handleOnChange,isButtonDisabled=_ref.isButtonDisabled,inputError=_ref.inputError,inputName=_ref.inputName,t=(0,dist.useTranslation)();return react.createElement(fuselage.TextInput,{ref:ref,textAlign:"center",placeholder:t("Phone_number"),addon:react.createElement(fuselage.IconButton,{icon:"backspace",small:!0,size:"20px",disabled:isButtonDisabled,onClick:handleBackspaceClick}),error:inputError,onChange:handleOnChange,name:inputName})}));DialInput.__docgenInfo={description:"",methods:[],displayName:"DialInput"};var _templateObject,dist_index_module=__webpack_require__("./node_modules/@rocket.chat/fuselage-hooks/dist/index.module.js");function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var padButtonStyle=(0,index_module.css)(_templateObject||(_templateObject=function _taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n\tbackground-color: transparent;\n\twidth: 94px;\n\theight: 64px;\n\tpadding: 8px;\n\tmargin: 8px;\n\tborder: none;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\n\t&:hover {\n\t\tbackground-color: ",";\n\t}\n"])),fuselage.Palette.surface["surface-neutral"]),PadButton=function PadButton(_ref){var children=_ref.children,onClickPadButton=_ref.onClickPadButton,onLongPressPadButton=_ref.onLongPressPadButton,_children=_slicedToArray(children,2),firstDigit=_children[0],secondDigit=_children[1],_useLongPress=function useLongPress(onLongPress,options){var isLongPress=(0,react.useRef)(!1),timerRef=(0,react.useRef)(),startPressTimer=(0,dist_index_module.useMutableCallback)((function(){var _options$threshold;isLongPress.current=!1,timerRef.current=setTimeout((function(){isLongPress.current=!0,onLongPress()}),null!==(_options$threshold=null==options?void 0:options.threshold)&&void 0!==_options$threshold?_options$threshold:700)}));return{onClick:(0,dist_index_module.useMutableCallback)((function(e){!isLongPress.current&&null!=options&&options.onClick&&options.onClick(e)})),onMouseDown:(0,dist_index_module.useMutableCallback)((function(e){var _options$onMouseDown;startPressTimer(),null==options||null===(_options$onMouseDown=options.onMouseDown)||void 0===_options$onMouseDown||_options$onMouseDown.call(options,e)})),onMouseUp:(0,dist_index_module.useMutableCallback)((function(e){var _options$onMouseUp;clearTimeout(timerRef.current),null==options||null===(_options$onMouseUp=options.onMouseUp)||void 0===_options$onMouseUp||_options$onMouseUp.call(options,e)})),onTouchStart:(0,dist_index_module.useMutableCallback)((function(e){var _options$onTouchStart;startPressTimer(),null==options||null===(_options$onTouchStart=options.onTouchStart)||void 0===_options$onTouchStart||_options$onTouchStart.call(options,e)})),onTouchEnd:(0,dist_index_module.useMutableCallback)((function(e){clearTimeout(timerRef.current),null!=options&&options.onTouchEnd&&options.onTouchEnd(e)}))}}((function(){return onLongPressPadButton(secondDigit)}),{onClick:function onClick(){return onClickPadButton(firstDigit)}}),onClick=_useLongPress.onClick,onMouseDown=_useLongPress.onMouseDown,onMouseUp=_useLongPress.onMouseUp,onTouchStart=_useLongPress.onTouchStart,onTouchEnd=_useLongPress.onTouchEnd;return react.createElement(fuselage.Button,{className:padButtonStyle,onClick:onClick,onMouseDown:onMouseDown,onMouseUp:onMouseUp,onTouchStart:onTouchStart,onTouchEnd:onTouchEnd},react.createElement(fuselage.Box,{is:"span",fontSize:"h2",lineHeight:"32px"},firstDigit),react.createElement(fuselage.Box,{is:"span",fontSize:"c1",lineHeight:"16px",color:"hint"},secondDigit))},DialPad_PadButton=PadButton;PadButton.__docgenInfo={description:"",methods:[],displayName:"PadButton",props:{children:{required:!0,tsType:{name:"tuple",raw:"[string, string]",elements:[{name:"string"},{name:"string"}]},description:""},onClickPadButton:{required:!0,tsType:{name:"signature",type:"function",raw:"(digit: PadDigit[0]) => void",signature:{arguments:[{type:{name:"tuple[0]",raw:"PadDigit[0]"},name:"digit"}],return:{name:"void"}}},description:""},onLongPressPadButton:{required:!0,tsType:{name:"signature",type:"function",raw:"(digit: PadDigit[1]) => void",signature:{arguments:[{type:{name:"tuple[1]",raw:"PadDigit[1]"},name:"digit"}],return:{name:"void"}}},description:""}}};var digits=[["1",""],["2","ABC"],["3","DEF"],["4","GHI"],["5","JKL"],["6","MNO"],["7","PQRS"],["8","TUV"],["9","WXYZ"],["*",""],["0","+"],["#",""]],Pad=function Pad(_ref){var onClickPadButton=_ref.onClickPadButton,onLongPressPadButton=_ref.onLongPressPadButton;return react.createElement(fuselage.Box,{display:"flex",flexWrap:"wrap",justifyContent:"center",mi:"-8px",mbs:"24px"},digits.map((function(digit,idx){return react.createElement(DialPad_PadButton,{key:idx,onClickPadButton:onClickPadButton,onLongPressPadButton:onLongPressPadButton},digit)})))},DialPad_Pad=Pad;Pad.__docgenInfo={description:"",methods:[],displayName:"Pad",props:{onClickPadButton:{required:!0,tsType:{name:"signature",type:"function",raw:"(digit: PadDigit[0]) => void",signature:{arguments:[{type:{name:"tuple[0]",raw:"PadDigit[0]"},name:"digit"}],return:{name:"void"}}},description:""},onLongPressPadButton:{required:!0,tsType:{name:"signature",type:"function",raw:"(digit: PadDigit[1]) => void",signature:{arguments:[{type:{name:"tuple[1]",raw:"PadDigit[1]"},name:"digit"}],return:{name:"void"}}},description:""}}};var index_esm=__webpack_require__("./node_modules/react-hook-form/dist/index.esm.mjs"),useDialModal=__webpack_require__("./client/hooks/useDialModal.tsx"),CallContext=__webpack_require__("./client/contexts/CallContext.ts"),core_typings_dist=__webpack_require__("../../packages/core-typings/dist/index.js"),empty=__webpack_require__("./.storybook/mocks/empty.ts"),emitter_dist_index_module=__webpack_require__("./node_modules/@rocket.chat/emitter/dist/index.module.js");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function toggleMediaStreamTracks(_x,_x2,_x3){return _toggleMediaStreamTracks.apply(this,arguments)}function _toggleMediaStreamTracks(){return _toggleMediaStreamTracks=function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)}))}}(_regeneratorRuntime().mark((function _callee(enable,session,direction){var sessionDescriptionHandler,peerConnection,mediaStreams;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if((sessionDescriptionHandler=session.sessionDescriptionHandler)instanceof empty.SessionDescriptionHandler){_context.next=3;break}throw new Error("Session's session description handler not instance of SessionDescriptionHandler.");case 3:if(peerConnection=sessionDescriptionHandler.peerConnection){_context.next=6;break}throw new Error("Peer connection closed.");case 6:mediaStreams=null,"sender"===direction?mediaStreams=peerConnection.getSenders():"receiver"===direction&&(mediaStreams=peerConnection.getReceivers()),mediaStreams&&mediaStreams.forEach((function(stream){stream.track&&(stream.track.enabled=enable)}));case 9:case"end":return _context.stop()}}),_callee)}))),_toggleMediaStreamTracks.apply(this,arguments)}function Stream_typeof(o){return Stream_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},Stream_typeof(o)}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=Stream_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=Stream_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==Stream_typeof(i)?i:i+""}var Stream=function(){function Stream(mediaStream){!function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}(this,Stream),function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}(this,"mediaStream",void 0),this.mediaStream=mediaStream}return function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(Stream,[{key:"stopTracks",value:function stopTracks(){var _this$mediaStream,tracks=null===(_this$mediaStream=this.mediaStream)||void 0===_this$mediaStream?void 0:_this$mediaStream.getTracks();if(tracks)for(var i=0;i<(null==tracks?void 0:tracks.length);i++)tracks[i].stop()}},{key:"onTrackAdded",value:function onTrackAdded(callBack){var _this$mediaStream2,_this$mediaStream2$on;null===(_this$mediaStream2=this.mediaStream)||void 0===_this$mediaStream2||null===(_this$mediaStream2$on=_this$mediaStream2.onaddtrack)||void 0===_this$mediaStream2$on||_this$mediaStream2$on.call(_this$mediaStream2,callBack)}},{key:"onTrackRemoved",value:function onTrackRemoved(callBack){var _this$mediaStream3,_this$mediaStream3$on;null===(_this$mediaStream3=this.mediaStream)||void 0===_this$mediaStream3||null===(_this$mediaStream3$on=_this$mediaStream3.onremovetrack)||void 0===_this$mediaStream3$on||_this$mediaStream3$on.call(_this$mediaStream3,callBack)}},{key:"clear",value:function clear(){this.mediaStream&&(this.stopTracks(),this.mediaStream=void 0)}}]),Stream}();function LocalStream_typeof(o){return LocalStream_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},LocalStream_typeof(o)}function LocalStream_regeneratorRuntime(){LocalStream_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==LocalStream_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(LocalStream_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function LocalStream_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function LocalStream_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function _next(n){LocalStream_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){LocalStream_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)}))}}function LocalStream_defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,LocalStream_toPropertyKey(o.key),o)}}function LocalStream_toPropertyKey(t){var i=function LocalStream_toPrimitive(t,r){if("object"!=LocalStream_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=LocalStream_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==LocalStream_typeof(i)?i:i+""}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _createSuper(t){var r=_isNativeReflectConstruct();return function(){var e,o=_getPrototypeOf(t);if(r){var s=_getPrototypeOf(this).constructor;e=Reflect.construct(o,arguments,s)}else e=o.apply(this,arguments);return function _possibleConstructorReturn(t,e){if(e&&("object"==LocalStream_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)}(this,e)}}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}var LocalStream=function(_Stream){!function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}(LocalStream,_Stream);var _replaceTrack,_requestNewStream,_super=_createSuper(LocalStream);function LocalStream(){return function LocalStream_classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}(this,LocalStream),_super.apply(this,arguments)}return function LocalStream_createClass(e,r,t){return r&&LocalStream_defineProperties(e.prototype,r),t&&LocalStream_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(LocalStream,null,[{key:"requestNewStream",value:(_requestNewStream=LocalStream_asyncToGenerator(LocalStream_regeneratorRuntime().mark((function _callee(constraints,session){var factory;return LocalStream_regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(factory=(0,empty.defaultMediaStreamFactory)(),null==session||!session.sessionDescriptionHandler){_context.next=3;break}return _context.abrupt("return",factory(constraints,session.sessionDescriptionHandler));case 3:case"end":return _context.stop()}}),_callee)}))),function requestNewStream(_x,_x2){return _requestNewStream.apply(this,arguments)})},{key:"replaceTrack",value:(_replaceTrack=LocalStream_asyncToGenerator(LocalStream_regeneratorRuntime().mark((function _callee2(peerConnection,newStream,mediaType){var senders,replaced,newTracks,i,_senders$i$track,_replaced,_newTracks,_i,_senders$_i$track,_replaced2,_newTracks2,_i2,j,_senders$_i2$track;return LocalStream_regeneratorRuntime().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(senders=peerConnection.getSenders()){_context2.next=3;break}return _context2.abrupt("return",!1);case 3:_context2.t0=mediaType,_context2.next="audio"===_context2.t0?6:"video"===_context2.t0?21:36;break;case 6:if(replaced=!1,newTracks=newStream.getAudioTracks()){_context2.next=11;break}return console.warn("replaceTrack() : No audio tracks in the stream. Returning"),_context2.abrupt("return",!1);case 11:i=0;case 12:if(!(i<(null==senders?void 0:senders.length))){_context2.next=20;break}if("audio"!==(null===(_senders$i$track=senders[i].track)||void 0===_senders$i$track?void 0:_senders$i$track.kind)){_context2.next=17;break}return senders[i].replaceTrack(newTracks[0]),replaced=!0,_context2.abrupt("break",20);case 17:i++,_context2.next=12;break;case 20:return _context2.abrupt("return",replaced);case 21:if(_replaced=!1,_newTracks=newStream.getVideoTracks()){_context2.next=26;break}return console.warn("replaceTrack() : No video tracks in the stream. Returning"),_context2.abrupt("return",!1);case 26:_i=0;case 27:if(!(_i<(null==senders?void 0:senders.length))){_context2.next=35;break}if("video"!==(null===(_senders$_i$track=senders[_i].track)||void 0===_senders$_i$track?void 0:_senders$_i$track.kind)){_context2.next=32;break}return senders[_i].replaceTrack(_newTracks[0]),_replaced=!0,_context2.abrupt("break",35);case 32:_i++,_context2.next=27;break;case 35:return _context2.abrupt("return",_replaced);case 36:if(_replaced2=!1,_newTracks2=newStream.getVideoTracks()){_context2.next=41;break}return console.warn("replaceTrack() : No tracks in the stream. Returning"),_context2.abrupt("return",!1);case 41:_i2=0;case 42:if(!(_i2<(null==senders?void 0:senders.length))){_context2.next=55;break}j=0;case 44:if(!(j<_newTracks2.length)){_context2.next=52;break}if((null===(_senders$_i2$track=senders[_i2].track)||void 0===_senders$_i2$track?void 0:_senders$_i2$track.kind)!==_newTracks2[j].kind){_context2.next=49;break}return senders[_i2].replaceTrack(_newTracks2[j]),_replaced2=!0,_context2.abrupt("break",52);case 49:j++,_context2.next=44;break;case 52:_i2++,_context2.next=42;break;case 55:return _context2.abrupt("return",_replaced2);case 56:case"end":return _context2.stop()}}),_callee2)}))),function replaceTrack(_x3,_x4,_x5){return _replaceTrack.apply(this,arguments)})}]),LocalStream}(Stream);function QueueAggregator_typeof(o){return QueueAggregator_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},QueueAggregator_typeof(o)}function QueueAggregator_slicedToArray(r,e){return function QueueAggregator_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function QueueAggregator_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function QueueAggregator_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return QueueAggregator_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?QueueAggregator_arrayLikeToArray(r,a):void 0}}(r,e)||function QueueAggregator_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function QueueAggregator_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function QueueAggregator_defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,QueueAggregator_toPropertyKey(o.key),o)}}function QueueAggregator_defineProperty(e,r,t){return(r=QueueAggregator_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function QueueAggregator_toPropertyKey(t){var i=function QueueAggregator_toPrimitive(t,r){if("object"!=QueueAggregator_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=QueueAggregator_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==QueueAggregator_typeof(i)?i:i+""}var QueueAggregator=function(){function QueueAggregator(){!function QueueAggregator_classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}(this,QueueAggregator),QueueAggregator_defineProperty(this,"sessionQueueCallServingHistory",void 0),QueueAggregator_defineProperty(this,"currentlyServing",void 0),QueueAggregator_defineProperty(this,"currentQueueMembershipStatus",void 0),QueueAggregator_defineProperty(this,"extension",void 0),this.sessionQueueCallServingHistory=[],this.currentQueueMembershipStatus={}}return function QueueAggregator_createClass(e,r,t){return r&&QueueAggregator_defineProperties(e.prototype,r),t&&QueueAggregator_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(QueueAggregator,[{key:"updateQueueInfo",value:function updateQueueInfo(queueName,queuedCalls){var _this$currentQueueMem;null!==(_this$currentQueueMem=this.currentQueueMembershipStatus)&&void 0!==_this$currentQueueMem&&_this$currentQueueMem[queueName]&&(this.currentQueueMembershipStatus[queueName].callsInQueue=queuedCalls)}},{key:"setMembership",value:function setMembership(subscription){var _this=this;this.extension=subscription.extension,subscription.queues.forEach((function(queue){var queueInfo={queueName:queue.name,callsInQueue:0};_this.currentQueueMembershipStatus[queue.name]=queueInfo}))}},{key:"queueJoined",value:function queueJoined(joiningDetails){this.updateQueueInfo(joiningDetails.queuename,Number(joiningDetails.queuedcalls))}},{key:"callPickedup",value:function callPickedup(queue){this.updateQueueInfo(queue.queuename,Number(queue.queuedcalls))}},{key:"memberAdded",value:function memberAdded(queue){var queueInfo={queueName:queue.queuename,callsInQueue:Number(queue.queuedcalls)};this.currentQueueMembershipStatus[queue.queuename]=queueInfo}},{key:"memberRemoved",value:function memberRemoved(queue){var _this$currentQueueMem2;null!==(_this$currentQueueMem2=this.currentQueueMembershipStatus)&&void 0!==_this$currentQueueMem2&&_this$currentQueueMem2[queue.queuename]&&delete this.currentQueueMembershipStatus[queue.queuename]}},{key:"queueAbandoned",value:function queueAbandoned(queue){this.updateQueueInfo(queue.queuename,Number(queue.queuedcallafterabandon))}},{key:"getCallWaitingCount",value:function getCallWaitingCount(){return Object.entries(this.currentQueueMembershipStatus).reduce((function(acc,_ref){var _ref2=QueueAggregator_slicedToArray(_ref,2);_ref2[0];return acc+_ref2[1].callsInQueue}),0)}},{key:"getCurrentQueueName",value:function getCurrentQueueName(){var _this$currentlyServin;return null!==(_this$currentlyServin=this.currentlyServing)&&void 0!==_this$currentlyServin&&_this$currentlyServin.queueInfo?this.currentlyServing.queueInfo.queueName:""}},{key:"callRinging",value:function callRinging(queueInfo){var _this$currentQueueMem3;if(null!==(_this$currentQueueMem3=this.currentQueueMembershipStatus)&&void 0!==_this$currentQueueMem3&&_this$currentQueueMem3[queueInfo.queuename]){var queueServing={queueInfo:this.currentQueueMembershipStatus[queueInfo.queuename],callerId:{callerId:queueInfo.callerid.id,callerName:queueInfo.callerid.name},callStarted:void 0,callEnded:void 0,agentExtension:this.extension};this.currentlyServing=queueServing}}},{key:"callStarted",value:function callStarted(){this.currentlyServing&&(this.currentlyServing.callStarted=new Date)}},{key:"callEnded",value:function callEnded(){this.currentlyServing&&(this.currentlyServing.callEnded=new Date,this.sessionQueueCallServingHistory.unshift(this.currentlyServing))}}]),QueueAggregator}();function RemoteStream_typeof(o){return RemoteStream_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},RemoteStream_typeof(o)}function RemoteStream_defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,RemoteStream_toPropertyKey(o.key),o)}}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var p=function _superPropBase(t,o){for(;!{}.hasOwnProperty.call(t,o)&&null!==(t=RemoteStream_getPrototypeOf(t)););return t}(e,t);if(p){var n=Object.getOwnPropertyDescriptor(p,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}},_get.apply(null,arguments)}function RemoteStream_setPrototypeOf(t,e){return RemoteStream_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},RemoteStream_setPrototypeOf(t,e)}function RemoteStream_createSuper(t){var r=RemoteStream_isNativeReflectConstruct();return function(){var e,o=RemoteStream_getPrototypeOf(t);if(r){var s=RemoteStream_getPrototypeOf(this).constructor;e=Reflect.construct(o,arguments,s)}else e=o.apply(this,arguments);return function RemoteStream_possibleConstructorReturn(t,e){if(e&&("object"==RemoteStream_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return RemoteStream_assertThisInitialized(t)}(this,e)}}function RemoteStream_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RemoteStream_isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(RemoteStream_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!t})()}function RemoteStream_getPrototypeOf(t){return RemoteStream_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},RemoteStream_getPrototypeOf(t)}function RemoteStream_toPropertyKey(t){var i=function RemoteStream_toPrimitive(t,r){if("object"!=RemoteStream_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=RemoteStream_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==RemoteStream_typeof(i)?i:i+""}var RemoteStream=function(_Stream){!function RemoteStream_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&RemoteStream_setPrototypeOf(t,e)}(RemoteStream,_Stream);var _super=RemoteStream_createSuper(RemoteStream);function RemoteStream(mediaStream){var _this;return function RemoteStream_classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}(this,RemoteStream),function RemoteStream_defineProperty(e,r,t){return(r=RemoteStream_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}(RemoteStream_assertThisInitialized(_this=_super.call(this,mediaStream)),"renderingMediaElement",void 0),_this}return function RemoteStream_createClass(e,r,t){return r&&RemoteStream_defineProperties(e.prototype,r),t&&RemoteStream_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(RemoteStream,[{key:"init",value:function init(rmElement){this.renderingMediaElement&&(this.renderingMediaElement.pause(),this.renderingMediaElement.srcObject=null),this.renderingMediaElement=rmElement}},{key:"play",value:function play(){var autoPlay=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],muteAudio=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.renderingMediaElement&&this.mediaStream&&(this.renderingMediaElement.autoplay=autoPlay,this.renderingMediaElement.srcObject=this.mediaStream,autoPlay&&this.renderingMediaElement.play().catch((function(error){throw error})),muteAudio&&(this.renderingMediaElement.volume=0))}},{key:"pause",value:function pause(){var _this$renderingMediaE;null===(_this$renderingMediaE=this.renderingMediaElement)||void 0===_this$renderingMediaE||_this$renderingMediaE.pause()}},{key:"clear",value:function clear(){_get(RemoteStream_getPrototypeOf(RemoteStream.prototype),"clear",this).call(this),this.renderingMediaElement&&(this.renderingMediaElement.pause(),this.renderingMediaElement.srcObject=null)}}]),RemoteStream}(Stream);function VoIPUser_typeof(o){return VoIPUser_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},VoIPUser_typeof(o)}function VoIPUser_regeneratorRuntime(){VoIPUser_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==VoIPUser_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(VoIPUser_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function VoIPUser_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function VoIPUser_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function _next(n){VoIPUser_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){VoIPUser_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)}))}}function VoIPUser_defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,VoIPUser_toPropertyKey(o.key),o)}}function VoIPUser_setPrototypeOf(t,e){return VoIPUser_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},VoIPUser_setPrototypeOf(t,e)}function VoIPUser_createSuper(t){var r=VoIPUser_isNativeReflectConstruct();return function(){var e,o=VoIPUser_getPrototypeOf(t);if(r){var s=VoIPUser_getPrototypeOf(this).constructor;e=Reflect.construct(o,arguments,s)}else e=o.apply(this,arguments);return function VoIPUser_possibleConstructorReturn(t,e){if(e&&("object"==VoIPUser_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return VoIPUser_assertThisInitialized(t)}(this,e)}}function VoIPUser_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VoIPUser_isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(VoIPUser_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!t})()}function VoIPUser_getPrototypeOf(t){return VoIPUser_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},VoIPUser_getPrototypeOf(t)}function VoIPUser_defineProperty(e,r,t){return(r=VoIPUser_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function VoIPUser_toPropertyKey(t){var i=function VoIPUser_toPrimitive(t,r){if("object"!=VoIPUser_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=VoIPUser_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==VoIPUser_typeof(i)?i:i+""}var VoIPUser=function(_Emitter){!function VoIPUser_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&VoIPUser_setPrototypeOf(t,e)}(VoIPUser,_Emitter);var _create,_makeCall,_makeCallURI,_changeAudioInputDevice,_attemptPostRecoveryRegistrationRoutine,_startOptionsPingForUnstableNetworks,_sendKeepAliveAndWaitForResponse,_attemptPostRecoveryRoutine,_attemptReconnection,_holdCall,_muteCall,_endCall,_acceptCall,_handleHoldUnhold,_handleMuteUnmute,_handleIncomingCall,_onConnected,_init,_super=VoIPUser_createSuper(VoIPUser);function VoIPUser(config,mediaRenderer){var _this;return function VoIPUser_classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}(this,VoIPUser),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this=_super.call(this)),"state",{isReady:!1,enableVideo:!1}),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"remoteStream",void 0),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"userAgentOptions",{}),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"userAgent",void 0),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"registerer",void 0),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"mediaStreamRendered",void 0),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"_connectionState","INITIAL"),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"_held",!1),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"mode",void 0),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"queueInfo",void 0),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"connectionRetryCount",void 0),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"stop",void 0),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"networkEmitter",void 0),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"offlineNetworkHandler",void 0),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"onlineNetworkHandler",void 0),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"optionsKeepaliveInterval",5),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"optionsKeepAliveDebounceTimeInSec",5),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"attemptRegistration",!1),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"session",void 0),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"_callState","INITIAL"),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"_callerInfo",void 0),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"_userState",core_typings_dist.UserState.IDLE),VoIPUser_defineProperty(VoIPUser_assertThisInitialized(_this),"_opInProgress",core_typings_dist.Operation.OP_NONE),_this.config=config,_this.mediaStreamRendered=mediaRenderer,_this.networkEmitter=new emitter_dist_index_module.v,_this.connectionRetryCount=_this.config.connectionRetryCount,_this.stop=!1,_this.onlineNetworkHandler=_this.onNetworkRestored.bind(VoIPUser_assertThisInitialized(_this)),_this.offlineNetworkHandler=_this.onNetworkLost.bind(VoIPUser_assertThisInitialized(_this)),_this}return function VoIPUser_createClass(e,r,t){return r&&VoIPUser_defineProperties(e.prototype,r),t&&VoIPUser_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(VoIPUser,[{key:"operationInProgress",get:function get(){return this._opInProgress}},{key:"userState",get:function get(){return this._userState}},{key:"init",value:(_init=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee3(){var sipUri,transportOptions,sdpFactoryOptions,_this2=this;return VoIPUser_regeneratorRuntime().wrap((function _callee3$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return sipUri="sip:".concat(this.config.authUserName,"@").concat(this.config.sipRegistrarHostnameOrIP),transportOptions={server:this.config.webSocketURI,connectionTimeout:100,keepAliveInterval:20},sdpFactoryOptions={iceGatheringTimeout:10,peerConnectionConfiguration:{iceServers:this.config.iceServers}},this.userAgentOptions={delegate:{onInvite:function(){var _onInvite=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee2(invitation){return VoIPUser_regeneratorRuntime().wrap((function _callee2$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,_this2.handleIncomingCall(invitation);case 2:case"end":return _context.stop()}}),_callee2)})));return function onInvite(_x){return _onInvite.apply(this,arguments)}}()},authorizationPassword:this.config.authPassword,authorizationUsername:this.config.authUserName,uri:empty.UserAgent.makeURI(sipUri),transportOptions:transportOptions,sessionDescriptionHandlerFactoryOptions:sdpFactoryOptions,logConfiguration:!1,logLevel:"error"},this.userAgent=new empty.UserAgent(this.userAgentOptions),this.userAgent.transport.isConnected(),this._opInProgress=core_typings_dist.Operation.OP_CONNECT,_context2.prev=7,this.registerer=new empty.Registerer(this.userAgent),this.userAgent.transport.onConnect=this.onConnected.bind(this),this.userAgent.transport.onDisconnect=this.onDisconnected.bind(this),window.addEventListener("online",this.onlineNetworkHandler),window.addEventListener("offline",this.offlineNetworkHandler),_context2.next=15,this.userAgent.start();case 15:this.config.enableKeepAliveUsingOptionsForUnstableNetworks&&this.startOptionsPingForUnstableNetworks(),_context2.next=22;break;case 18:throw _context2.prev=18,_context2.t0=_context2.catch(7),this._connectionState="ERROR",_context2.t0;case 22:case"end":return _context2.stop()}}),_callee3,this,[[7,18]])}))),function init(){return _init.apply(this,arguments)})},{key:"onConnected",value:(_onConnected=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee4(){return VoIPUser_regeneratorRuntime().wrap((function _callee4$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:this._connectionState="SERVER_CONNECTED",this.state.isReady=!0,this.sendOptions(),this.networkEmitter.emit("connected"),this.registerer&&"INITIAL"!==this.callState&&(this.attemptRegistration=!0);case 5:case"end":return _context3.stop()}}),_callee4,this)}))),function onConnected(){return _onConnected.apply(this,arguments)})},{key:"onDisconnected",value:function onDisconnected(error){this._connectionState="SERVER_DISCONNECTED",this._opInProgress=core_typings_dist.Operation.OP_NONE,this.networkEmitter.emit("disconnected"),error&&(this.networkEmitter.emit("connectionerror",error),this.state.isReady=!1,this.attemptReconnection(0,!1))}},{key:"onNetworkRestored",value:function onNetworkRestored(){this.networkEmitter.emit("localnetworkonline"),"WAITING_FOR_NETWORK"===this._connectionState&&(this.attemptReconnection(),this.registerer&&"INITIAL"!==this.callState&&(this.attemptRegistration=!0))}},{key:"onNetworkLost",value:function onNetworkLost(){this.networkEmitter.emit("localnetworkoffline"),this._connectionState="WAITING_FOR_NETWORK"}},{key:"userConfig",get:function get(){return this.config}},{key:"callState",get:function get(){return this._callState}},{key:"connectionState",get:function get(){return this._connectionState}},{key:"callerInfo",get:function get(){if("IN_CALL"===this.callState||"OFFER_RECEIVED"===this.callState||"ON_HOLD"===this.callState||"OFFER_SENT"===this.callState){if(!this._callerInfo)throw new Error("[VoIPUser callerInfo] invalid state");return{state:this.callState,caller:this._callerInfo,userState:this._userState}}return{state:this.callState,userState:this._userState}}},{key:"localMediaStream",get:function get(){var _this$session,sdh=null===(_this$session=this.session)||void 0===_this$session?void 0:_this$session.sessionDescriptionHandler;if(sdh){if(!(sdh instanceof empty.SessionDescriptionHandler))throw new Error("Session description handler not instance of web SessionDescriptionHandler");return sdh.localMediaStream}}},{key:"onRegistrationRequestAccept",value:function onRegistrationRequestAccept(){this._opInProgress===core_typings_dist.Operation.OP_REGISTER&&(this._callState="REGISTERED",this.emit("registered"),this.emit("stateChanged")),this._opInProgress===core_typings_dist.Operation.OP_UNREGISTER&&(this._callState="UNREGISTERED",this.emit("unregistered"),this.emit("stateChanged"))}},{key:"onRegistrationRequestReject",value:function onRegistrationRequestReject(error){this._opInProgress===core_typings_dist.Operation.OP_REGISTER&&this.emit("registrationerror",error),this._opInProgress===core_typings_dist.Operation.OP_UNREGISTER&&this.emit("unregistrationerror",error)}},{key:"handleIncomingCall",value:(_handleIncomingCall=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee5(invitation){var callerInfo;return VoIPUser_regeneratorRuntime().wrap((function _callee5$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if("REGISTERED"!==this.callState){_context4.next=11;break}return this._opInProgress=core_typings_dist.Operation.OP_PROCESS_INVITE,this._callState="OFFER_RECEIVED",this._userState=core_typings_dist.UserState.UAS,this.session=invitation,this.setupSessionEventHandlers(invitation),callerInfo={callerId:invitation.remoteIdentity.uri.user?invitation.remoteIdentity.uri.user:"",callerName:invitation.remoteIdentity.displayName,host:invitation.remoteIdentity.uri.host},this._callerInfo=callerInfo,this.emit("incomingcall",callerInfo),this.emit("stateChanged"),_context4.abrupt("return");case 11:return _context4.next=13,invitation.reject();case 13:case"end":return _context4.stop()}}),_callee5,this)}))),function handleIncomingCall(_x2){return _handleIncomingCall.apply(this,arguments)})},{key:"setupSessionEventHandlers",value:function setupSessionEventHandlers(session){var _this$session2,_this3=this;null===(_this$session2=this.session)||void 0===_this$session2||_this$session2.stateChange.addListener((function(state){var _this3$remoteStream;if(_this3.session===session)switch(state){case empty.SessionState.Initial:break;case empty.SessionState.Establishing:_this3.emit("ringing",{userState:_this3._userState,callInfo:_this3._callerInfo});break;case empty.SessionState.Established:_this3._userState===core_typings_dist.UserState.UAC&&(_this3._callState="ANSWER_RECEIVED"),_this3._opInProgress=core_typings_dist.Operation.OP_NONE,_this3.setupRemoteMedia(),_this3._callState="IN_CALL",_this3.emit("callestablished",{userState:_this3._userState,callInfo:_this3._callerInfo}),_this3.emit("stateChanged");break;case empty.SessionState.Terminating:case empty.SessionState.Terminated:_this3.session=void 0,_this3._callState="REGISTERED",_this3._opInProgress=core_typings_dist.Operation.OP_NONE,_this3._userState=core_typings_dist.UserState.IDLE,_this3.emit("callterminated"),null===(_this3$remoteStream=_this3.remoteStream)||void 0===_this3$remoteStream||_this3$remoteStream.clear(),_this3.emit("stateChanged");break;default:throw new Error("Unknown session state.")}}))}},{key:"onTrackAdded",value:function onTrackAdded(_event){console.log("onTrackAdded")}},{key:"onTrackRemoved",value:function onTrackRemoved(_event){console.log("onTrackRemoved")}},{key:"setupRemoteMedia",value:function setupRemoteMedia(){var _this$session3,_this$mediaStreamRend;if(!this.session)throw new Error("Session does not exist.");var sdh=null===(_this$session3=this.session)||void 0===_this$session3?void 0:_this$session3.sessionDescriptionHandler;if(sdh){if(!(sdh instanceof empty.SessionDescriptionHandler))throw new Error("Session description handler not instance of web SessionDescriptionHandler");var remoteStream=sdh.remoteMediaStream;if(!remoteStream)throw new Error("Remote media stream is undefined.");this.remoteStream=new RemoteStream(remoteStream);var mediaElement=null===(_this$mediaStreamRend=this.mediaStreamRendered)||void 0===_this$mediaStreamRend?void 0:_this$mediaStreamRend.remoteMediaElement;mediaElement&&(this.remoteStream.init(mediaElement),this.remoteStream.onTrackAdded(this.onTrackAdded.bind(this)),this.remoteStream.onTrackRemoved(this.onTrackRemoved.bind(this)),this.remoteStream.play())}}},{key:"handleMuteUnmute",value:(_handleMuteUnmute=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee6(muteState){var _this$session4,_this$session5,session,sessionDescriptionHandler,options,_this4=this;return VoIPUser_regeneratorRuntime().wrap((function _callee6$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(session=this.session,this._held!==muteState){_context5.next=3;break}return _context5.abrupt("return",Promise.resolve());case 3:if(session){_context5.next=5;break}throw new Error("Session not found");case 5:if((sessionDescriptionHandler=null===(_this$session4=this.session)||void 0===_this$session4?void 0:_this$session4.sessionDescriptionHandler)instanceof empty.SessionDescriptionHandler){_context5.next=8;break}throw new Error("Session's session description handler not instance of SessionDescriptionHandler.");case 8:if(options={requestDelegate:{onAccept:function onAccept(){_this4._held=muteState,toggleMediaStreamTracks(!_this4._held,session,"receiver"),toggleMediaStreamTracks(!_this4._held,session,"sender")},onReject:function onReject(){_this4.emit("muteerror")}}},sessionDescriptionHandler.peerConnection){_context5.next=12;break}throw new Error("Peer connection closed.");case 12:return _context5.abrupt("return",null===(_this$session5=this.session)||void 0===_this$session5?void 0:_this$session5.invite(options).then((function(){toggleMediaStreamTracks(!_this4._held,session,"receiver"),toggleMediaStreamTracks(!_this4._held,session,"sender")})).catch((function(error){var _this4$session;throw error instanceof empty.RequestPendingError&&console.error("[".concat(null===(_this4$session=_this4.session)||void 0===_this4$session?void 0:_this4$session.id,"] A mute request is already in progress.")),_this4.emit("muteerror"),error})));case 13:case"end":return _context5.stop()}}),_callee6,this)}))),function handleMuteUnmute(_x3){return _handleMuteUnmute.apply(this,arguments)})},{key:"handleHoldUnhold",value:(_handleHoldUnhold=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee7(holdState){var _this$session6,_this$session7,session,sessionDescriptionHandler,options,sessionDescriptionHandlerOptions,_this5=this;return VoIPUser_regeneratorRuntime().wrap((function _callee7$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(session=this.session,this._held!==holdState){_context6.next=3;break}return _context6.abrupt("return",Promise.resolve());case 3:if(session){_context6.next=5;break}throw new Error("Session not found");case 5:if((sessionDescriptionHandler=null===(_this$session6=this.session)||void 0===_this$session6?void 0:_this$session6.sessionDescriptionHandler)instanceof empty.SessionDescriptionHandler){_context6.next=8;break}throw new Error("Session's session description handler not instance of SessionDescriptionHandler.");case 8:if(options={requestDelegate:{onAccept:function onAccept(){_this5._held=holdState,_this5._callState=holdState?"ON_HOLD":"IN_CALL",toggleMediaStreamTracks(!_this5._held,session,"receiver"),toggleMediaStreamTracks(!_this5._held,session,"sender"),"ON_HOLD"===_this5._callState?_this5.emit("hold"):_this5.emit("unhold"),_this5.emit("stateChanged")},onReject:function onReject(){toggleMediaStreamTracks(!_this5._held,session,"receiver"),toggleMediaStreamTracks(!_this5._held,session,"sender"),_this5.emit("holderror")}}},(sessionDescriptionHandlerOptions=session.sessionDescriptionHandlerOptionsReInvite).hold=holdState,session.sessionDescriptionHandlerOptionsReInvite=sessionDescriptionHandlerOptions,sessionDescriptionHandler.peerConnection){_context6.next=15;break}throw new Error("Peer connection closed.");case 15:return _context6.abrupt("return",null===(_this$session7=this.session)||void 0===_this$session7?void 0:_this$session7.invite(options).then((function(){toggleMediaStreamTracks(!_this5._held,session,"receiver"),toggleMediaStreamTracks(!_this5._held,session,"sender")})).catch((function(error){var _this5$session;throw error instanceof empty.RequestPendingError&&console.error("[".concat(null===(_this5$session=_this5.session)||void 0===_this5$session?void 0:_this5$session.id,"] A hold request is already in progress.")),_this5.emit("holderror"),error})));case 16:case"end":return _context6.stop()}}),_callee7,this)}))),function handleHoldUnhold(_x4){return _handleHoldUnhold.apply(this,arguments)})},{key:"sendOptions",value:function sendOptions(outgoingRequestDelegate){var _this$userAgent,_this$userAgent2,uri=new empty.URI("sip",this.config.authUserName,this.config.sipRegistrarHostnameOrIP),outgoingMessage=null===(_this$userAgent=this.userAgent)||void 0===_this$userAgent?void 0:_this$userAgent.userAgentCore.makeOutgoingRequestMessage("OPTIONS",uri,uri,uri,{});outgoingMessage&&(null===(_this$userAgent2=this.userAgent)||void 0===_this$userAgent2||_this$userAgent2.userAgentCore.request(outgoingMessage,outgoingRequestDelegate))}},{key:"register",value:function register(){var _this$registerer;this._opInProgress=core_typings_dist.Operation.OP_REGISTER,null===(_this$registerer=this.registerer)||void 0===_this$registerer||_this$registerer.register({requestDelegate:{onAccept:this.onRegistrationRequestAccept.bind(this),onReject:this.onRegistrationRequestReject.bind(this)}})}},{key:"unregister",value:function unregister(){var _this$registerer2;this._opInProgress=core_typings_dist.Operation.OP_UNREGISTER,null===(_this$registerer2=this.registerer)||void 0===_this$registerer2||_this$registerer2.unregister({all:!0,requestDelegate:{onAccept:this.onRegistrationRequestAccept.bind(this),onReject:this.onRegistrationRequestReject.bind(this)}})}},{key:"acceptCall",value:(_acceptCall=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee8(mediaRenderer){var videoInvite,body,invitationAcceptOptions;return VoIPUser_regeneratorRuntime().wrap((function _callee8$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:if(mediaRenderer&&(this.mediaStreamRendered=mediaRenderer),"OFFER_RECEIVED"!==this._callState||this._opInProgress!==core_typings_dist.Operation.OP_PROCESS_INVITE){_context7.next=10;break}if(this._callState="ANSWER_SENT",this.session instanceof empty.Invitation){_context7.next=5;break}throw new Error("Session not instance of Invitation.");case 5:return videoInvite=!!this.config.enableVideo,(body=this.session.body)&&-1===body.indexOf("m=video")&&(videoInvite=!1),invitationAcceptOptions={sessionDescriptionHandlerOptions:{constraints:{audio:!0,video:!!this.config.enableVideo&&videoInvite}}},_context7.abrupt("return",this.session.accept(invitationAcceptOptions));case 10:throw new Error("Something went wrong");case 11:case"end":return _context7.stop()}}),_callee8,this)}))),function acceptCall(_x5){return _acceptCall.apply(this,arguments)})},{key:"canRejectCall",value:function canRejectCall(){return["OFFER_RECEIVED","OFFER_SENT"].includes(this._callState)}},{key:"canEndOrHoldCall",value:function canEndOrHoldCall(){return["ANSWER_SENT","ANSWER_RECEIVED","IN_CALL","ON_HOLD","OFFER_SENT"].includes(this._callState)}},{key:"rejectCall",value:function rejectCall(){if(!this.session)throw new Error("Session does not exist.");if(!this.canRejectCall())throw new Error("Incorrect call State = ".concat(this.callState));if(!(this.session instanceof empty.Invitation))throw new Error("Session not instance of Invitation.");return this.session.reject()}},{key:"endCall",value:(_endCall=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee9(){return VoIPUser_regeneratorRuntime().wrap((function _callee9$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:if(this.session){_context8.next=2;break}throw new Error("Session does not exist.");case 2:if(this.canEndOrHoldCall()){_context8.next=4;break}throw new Error("Incorrect call State = ".concat(this.callState));case 4:this.emit("stateChanged"),_context8.t0=this.session.state,_context8.next=_context8.t0===empty.SessionState.Initial?8:_context8.t0===empty.SessionState.Establishing?11:_context8.t0===empty.SessionState.Established?16:_context8.t0===empty.SessionState.Terminating?17:_context8.t0===empty.SessionState.Terminated?18:19;break;case 8:if(!(this.session instanceof empty.Invitation)){_context8.next=10;break}return _context8.abrupt("return",this.session.reject());case 10:case 15:throw new Error("Session not instance of Invitation.");case 11:if(!(this.session instanceof empty.Invitation)){_context8.next=13;break}return _context8.abrupt("return",this.session.reject());case 13:if(!(this.session instanceof empty.Inviter)){_context8.next=15;break}return _context8.abrupt("return",this.session.cancel());case 16:return _context8.abrupt("return",this.session.bye());case 17:case 18:return _context8.abrupt("break",20);case 19:throw new Error("Unknown state");case 20:case"end":return _context8.stop()}}),_callee9,this)}))),function endCall(){return _endCall.apply(this,arguments)})},{key:"muteCall",value:(_muteCall=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee10(muteState){return VoIPUser_regeneratorRuntime().wrap((function _callee10$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:if(this.session){_context9.next=2;break}throw new Error("Session does not exist.");case 2:if("IN_CALL"===this._callState){_context9.next=4;break}throw new Error("Incorrect call State = ".concat(this.callState));case 4:this.handleMuteUnmute(muteState);case 5:case"end":return _context9.stop()}}),_callee10,this)}))),function muteCall(_x6){return _muteCall.apply(this,arguments)})},{key:"holdCall",value:(_holdCall=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee11(holdState){return VoIPUser_regeneratorRuntime().wrap((function _callee11$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:if(this.session){_context10.next=2;break}throw new Error("Session does not exist.");case 2:if(this.canEndOrHoldCall()){_context10.next=4;break}throw new Error("Incorrect call State = ".concat(this.callState));case 4:this.handleHoldUnhold(holdState);case 5:case"end":return _context10.stop()}}),_callee11,this)}))),function holdCall(_x7){return _holdCall.apply(this,arguments)})},{key:"isReady",value:function isReady(){return this.state.isReady}},{key:"switchMediaRenderer",value:function switchMediaRenderer(mediaRenderer){this.remoteStream&&(this.mediaStreamRendered=mediaRenderer,this.remoteStream.init(mediaRenderer.remoteMediaElement),this.remoteStream.onTrackAdded(this.onTrackAdded.bind(this)),this.remoteStream.onTrackRemoved(this.onTrackRemoved.bind(this)),this.remoteStream.play())}},{key:"setWorkflowMode",value:function setWorkflowMode(mode){this.mode=mode,mode===core_typings_dist.WorkflowTypes.CONTACT_CENTER_USER&&(this.queueInfo=new QueueAggregator)}},{key:"setMembershipSubscription",value:function setMembershipSubscription(subscription){var _this$queueInfo;this.mode===core_typings_dist.WorkflowTypes.CONTACT_CENTER_USER&&(null===(_this$queueInfo=this.queueInfo)||void 0===_this$queueInfo||_this$queueInfo.setMembership(subscription))}},{key:"getAggregator",value:function getAggregator(){return this.queueInfo}},{key:"getRegistrarState",value:function getRegistrarState(){var _this$registerer3;return null===(_this$registerer3=this.registerer)||void 0===_this$registerer3?void 0:_this$registerer3.state.toString().toLocaleLowerCase()}},{key:"clear",value:function clear(){var _this$userAgent3,_this$registerer4;this._opInProgress=core_typings_dist.Operation.OP_CLEANUP,this.stop=!0,null===(_this$userAgent3=this.userAgent)||void 0===_this$userAgent3||_this$userAgent3.stop(),null===(_this$registerer4=this.registerer)||void 0===_this$registerer4||_this$registerer4.dispose(),this._connectionState="STOP",this.userAgent&&(this.userAgent.transport.onConnect=void 0,this.userAgent.transport.onDisconnect=void 0,window.removeEventListener("online",this.onlineNetworkHandler),window.removeEventListener("offline",this.offlineNetworkHandler))}},{key:"onNetworkEvent",value:function onNetworkEvent(event,handler){this.networkEmitter.on(event,handler)}},{key:"offNetworkEvent",value:function offNetworkEvent(event,handler){this.networkEmitter.off(event,handler)}},{key:"attemptReconnection",value:(_attemptReconnection=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee12(){var reconnectionAttempt,checkRegistration,reconnectionAttempts,reconnectionDelay,_this6=this,_args11=arguments;return VoIPUser_regeneratorRuntime().wrap((function _callee12$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:if(reconnectionAttempt=_args11.length>0&&void 0!==_args11[0]?_args11[0]:0,checkRegistration=_args11.length>1&&void 0!==_args11[1]&&_args11[1],reconnectionAttempts=this.connectionRetryCount,this._connectionState="SERVER_RECONNECTING",this.userAgent){_context11.next=6;break}return _context11.abrupt("return");case 6:if(!this.stop){_context11.next=8;break}return _context11.abrupt("return");case 8:if(!(-1!==reconnectionAttempts&&reconnectionAttempt>reconnectionAttempts)){_context11.next=11;break}return this._connectionState="ERROR",_context11.abrupt("return");case 11:reconnectionDelay=Math.pow(2,reconnectionAttempt%4),console.error("Attempting to reconnect with backoff due to network loss. Backoff time [".concat(reconnectionDelay,"]")),setTimeout((function(){var _this6$userAgent;_this6.stop||"SERVER_CONNECTED"!==_this6._connectionState&&(null===(_this6$userAgent=_this6.userAgent)||void 0===_this6$userAgent||_this6$userAgent.reconnect().then((function(){_this6._connectionState="SERVER_CONNECTED"})).catch((function(){_this6.attemptReconnection(++reconnectionAttempt,checkRegistration)})))}),1e3*reconnectionDelay);case 14:case"end":return _context11.stop()}}),_callee12,this)}))),function attemptReconnection(){return _attemptReconnection.apply(this,arguments)})},{key:"attemptPostRecoveryRoutine",value:(_attemptPostRecoveryRoutine=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee13(){var _this7=this;return VoIPUser_regeneratorRuntime().wrap((function _callee13$(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:this.sendOptions({onAccept:function onAccept(){_this7.attemptPostRecoveryRegistrationRoutine()},onReject:function onReject(error){console.error("[".concat(error,"] Failed to do options in attemptPostRecoveryRoutine()"))}});case 1:case"end":return _context12.stop()}}),_callee13,this)}))),function attemptPostRecoveryRoutine(){return _attemptPostRecoveryRoutine.apply(this,arguments)})},{key:"sendKeepAliveAndWaitForResponse",value:(_sendKeepAliveAndWaitForResponse=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee15(){var withDebounce,promise,_this8=this,_args14=arguments;return VoIPUser_regeneratorRuntime().wrap((function _callee15$(_context14){for(;;)switch(_context14.prev=_context14.next){case 0:return withDebounce=_args14.length>0&&void 0!==_args14[0]&&_args14[0],promise=new Promise((function(resolve,reject){var keepAliveAccepted=!1,responseWaitTime=_this8.optionsKeepaliveInterval/2;withDebounce&&(responseWaitTime+=_this8.optionsKeepAliveDebounceTimeInSec),_this8.sendOptions({onAccept:function onAccept(){keepAliveAccepted=!0},onReject:function onReject(_error){console.error("Failed to do options.")}}),setTimeout(VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee14(){return VoIPUser_regeneratorRuntime().wrap((function _callee14$(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:keepAliveAccepted?(_this8.attemptRegistration&&(_this8.attemptPostRecoveryRoutine(),_this8.attemptRegistration=!1),resolve(!0)):reject(!1);case 1:case"end":return _context13.stop()}}),_callee14)}))),1e3*responseWaitTime)})),_context14.abrupt("return",promise);case 3:case"end":return _context14.stop()}}),_callee15)}))),function sendKeepAliveAndWaitForResponse(){return _sendKeepAliveAndWaitForResponse.apply(this,arguments)})},{key:"startOptionsPingForUnstableNetworks",value:(_startOptionsPingForUnstableNetworks=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee17(){var _this9=this;return VoIPUser_regeneratorRuntime().wrap((function _callee17$(_context16){for(;;)switch(_context16.prev=_context16.next){case 0:setTimeout(VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee16(){var isConnected;return VoIPUser_regeneratorRuntime().wrap((function _callee16$(_context15){for(;;)switch(_context15.prev=_context15.next){case 0:if(_this9.userAgent&&!_this9.stop){_context15.next=2;break}return _context15.abrupt("return");case 2:if("SERVER_RECONNECTING"===_this9._connectionState){_context15.next=17;break}return isConnected=!1,_context15.prev=4,_context15.next=7,_this9.sendKeepAliveAndWaitForResponse();case 7:isConnected=!0,_context15.next=13;break;case 10:_context15.prev=10,_context15.t0=_context15.catch(4),console.error("[".concat(_context15.t0,"] Failed to do options ping."));case 13:return _context15.prev=13,!isConnected&&_this9.networkEmitter.emit("disconnected"),isConnected&&_this9.networkEmitter.emit("connected"),_context15.finish(13);case 17:_this9.startOptionsPingForUnstableNetworks();case 18:case"end":return _context15.stop()}}),_callee16,null,[[4,10,13,17]])}))),1e3*this.optionsKeepaliveInterval);case 1:case"end":return _context16.stop()}}),_callee17,this)}))),function startOptionsPingForUnstableNetworks(){return _startOptionsPingForUnstableNetworks.apply(this,arguments)})},{key:"attemptPostRecoveryRegistrationRoutine",value:(_attemptPostRecoveryRegistrationRoutine=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee18(){var _this$registerer5,promise,_this10=this;return VoIPUser_regeneratorRuntime().wrap((function _callee18$(_context17){for(;;)switch(_context17.prev=_context17.next){case 0:return promise=new Promise((function(_resolve,_reject){var _this10$registerer;null===(_this10$registerer=_this10.registerer)||void 0===_this10$registerer||_this10$registerer.unregister({all:!0,requestDelegate:{onAccept:function onAccept(){_resolve()},onReject:function onReject(error){console.error("[".concat(error,"] While unregistering after recovery")),_this10.emit("unregistrationerror",error),_reject("Error in Unregistering")}}})})),_context17.prev=1,_context17.next=4,promise;case 4:_context17.next=9;break;case 6:_context17.prev=6,_context17.t0=_context17.catch(1),console.error("[".concat(_context17.t0,"] While waiting for unregister promise"));case 9:null===(_this$registerer5=this.registerer)||void 0===_this$registerer5||_this$registerer5.register({requestDelegate:{onReject:function onReject(error){_this10._callState="UNREGISTERED",_this10.emit("registrationerror",error),_this10.emit("stateChanged")}}});case 10:case"end":return _context17.stop()}}),_callee18,this,[[1,6]])}))),function attemptPostRecoveryRegistrationRoutine(){return _attemptPostRecoveryRegistrationRoutine.apply(this,arguments)})},{key:"changeAudioInputDevice",value:(_changeAudioInputDevice=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee19(constraints){var _this$session8,newStream,_ref3,peerConnection;return VoIPUser_regeneratorRuntime().wrap((function _callee19$(_context18){for(;;)switch(_context18.prev=_context18.next){case 0:if(this.session){_context18.next=3;break}return console.warn("changeAudioInputDevice() : No session. Returning"),_context18.abrupt("return",!1);case 3:return _context18.next=5,LocalStream.requestNewStream(constraints,this.session);case 5:if(newStream=_context18.sent){_context18.next=9;break}return console.warn("changeAudioInputDevice() : Unable to get local stream. Returning"),_context18.abrupt("return",!1);case 9:if(_ref3=null===(_this$session8=this.session)||void 0===_this$session8?void 0:_this$session8.sessionDescriptionHandler,peerConnection=_ref3.peerConnection){_context18.next=13;break}return console.warn("changeAudioInputDevice() : No peer connection. Returning"),_context18.abrupt("return",!1);case 13:return LocalStream.replaceTrack(peerConnection,newStream,"audio"),_context18.abrupt("return",!0);case 15:case"end":return _context18.stop()}}),_callee19,this)}))),function changeAudioInputDevice(_x8){return _changeAudioInputDevice.apply(this,arguments)})},{key:"makeCallURI",value:(_makeCallURI=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee20(_callee,_mediaRenderer){return VoIPUser_regeneratorRuntime().wrap((function _callee20$(_context19){for(;;)switch(_context19.prev=_context19.next){case 0:throw new Error("Not implemented");case 1:case"end":return _context19.stop()}}),_callee20)}))),function makeCallURI(_x9,_x10){return _makeCallURI.apply(this,arguments)})},{key:"makeCall",value:(_makeCall=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee21(_calleeNumber){return VoIPUser_regeneratorRuntime().wrap((function _callee21$(_context20){for(;;)switch(_context20.prev=_context20.next){case 0:throw new Error("Not implemented");case 1:case"end":return _context20.stop()}}),_callee21)}))),function makeCall(_x11){return _makeCall.apply(this,arguments)})}],[{key:"create",value:(_create=VoIPUser_asyncToGenerator(VoIPUser_regeneratorRuntime().mark((function _callee22(config,mediaRenderer){var voip;return VoIPUser_regeneratorRuntime().wrap((function _callee22$(_context21){for(;;)switch(_context21.prev=_context21.next){case 0:return voip=new VoIPUser(config,mediaRenderer),_context21.next=3,voip.init();case 3:return _context21.abrupt("return",voip);case 4:case"end":return _context21.stop()}}),_callee22)}))),function create(_x12,_x13){return _create.apply(this,arguments)})}]),VoIPUser}(emitter_dist_index_module.v);function EEVoipClient_typeof(o){return EEVoipClient_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},EEVoipClient_typeof(o)}function EEVoipClient_regeneratorRuntime(){EEVoipClient_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==EEVoipClient_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(EEVoipClient_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function EEVoipClient_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function EEVoipClient_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function _next(n){EEVoipClient_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){EEVoipClient_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)}))}}function EEVoipClient_defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,EEVoipClient_toPropertyKey(o.key),o)}}function EEVoipClient_toPropertyKey(t){var i=function EEVoipClient_toPrimitive(t,r){if("object"!=EEVoipClient_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=EEVoipClient_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==EEVoipClient_typeof(i)?i:i+""}function EEVoipClient_setPrototypeOf(t,e){return EEVoipClient_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},EEVoipClient_setPrototypeOf(t,e)}function EEVoipClient_createSuper(t){var r=EEVoipClient_isNativeReflectConstruct();return function(){var e,o=EEVoipClient_getPrototypeOf(t);if(r){var s=EEVoipClient_getPrototypeOf(this).constructor;e=Reflect.construct(o,arguments,s)}else e=o.apply(this,arguments);return function EEVoipClient_possibleConstructorReturn(t,e){if(e&&("object"==EEVoipClient_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function EEVoipClient_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)}(this,e)}}function EEVoipClient_isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(EEVoipClient_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!t})()}function EEVoipClient_getPrototypeOf(t){return EEVoipClient_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},EEVoipClient_getPrototypeOf(t)}var EEVoipClient=function(_VoIPUser){!function EEVoipClient_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&EEVoipClient_setPrototypeOf(t,e)}(EEVoipClient,_VoIPUser);var _create,_makeCall,_makeCallURI,_super=EEVoipClient_createSuper(EEVoipClient);function EEVoipClient(config,mediaRenderer){return function EEVoipClient_classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}(this,EEVoipClient),_super.call(this,config,mediaRenderer)}return function EEVoipClient_createClass(e,r,t){return r&&EEVoipClient_defineProperties(e.prototype,r),t&&EEVoipClient_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(EEVoipClient,[{key:"makeCallURI",value:(_makeCallURI=EEVoipClient_asyncToGenerator(EEVoipClient_regeneratorRuntime().mark((function _callee(calleeURI,mediaRenderer){var target,inviterOptions,inviter,callerInfo,_this=this;return EEVoipClient_regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(mediaRenderer&&(this.mediaStreamRendered=mediaRenderer),!this.session){_context.next=3;break}throw new Error("Session exists");case 3:if(this.userAgent){_context.next=5;break}throw new Error("No User Agent.");case 5:if("REGISTERED"===this.callState){_context.next=7;break}throw new Error("Incorrect UA state");case 7:if(target=empty.UserAgent.makeURI(calleeURI)){_context.next=10;break}throw new Error("Failed to create valid URI ".concat(calleeURI));case 10:return inviterOptions={sessionDescriptionHandlerOptions:{constraints:{audio:!0,video:!1}}},inviter=new empty.Inviter(this.userAgent,target,inviterOptions),this.session=inviter,this.setupSessionEventHandlers(inviter),this._opInProgress=core_typings_dist.Operation.OP_SEND_INVITE,_context.next=18,inviter.invite({requestDelegate:{onReject:function onReject(response){response.message.reasonPhrase&&_this.emit("callfailed",response.message.reasonPhrase||"unknown")}}});case 18:this._callState="OFFER_SENT",callerInfo={callerId:inviter.remoteIdentity.uri.user?inviter.remoteIdentity.uri.user:"",callerName:inviter.remoteIdentity.displayName,host:inviter.remoteIdentity.uri.host},this._callerInfo=callerInfo,this._userState=core_typings_dist.UserState.UAC,this.emit("stateChanged");case 23:case"end":return _context.stop()}}),_callee,this)}))),function makeCallURI(_x,_x2){return _makeCallURI.apply(this,arguments)})},{key:"makeCall",value:(_makeCall=EEVoipClient_asyncToGenerator(EEVoipClient_regeneratorRuntime().mark((function _callee2(calleeNumber){var hasPlusChar,digits;return EEVoipClient_regeneratorRuntime().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:hasPlusChar=calleeNumber.includes("+"),digits=calleeNumber.replace("+",""),this.makeCallURI("sip:".concat(hasPlusChar?"*":"").concat(digits,"@").concat(this.userConfig.sipRegistrarHostnameOrIP));case 3:case"end":return _context2.stop()}}),_callee2,this)}))),function makeCall(_x3){return _makeCall.apply(this,arguments)})}],[{key:"create",value:(_create=EEVoipClient_asyncToGenerator(EEVoipClient_regeneratorRuntime().mark((function _callee3(config,mediaRenderer){var voip;return EEVoipClient_regeneratorRuntime().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return voip=new EEVoipClient(config,mediaRenderer),_context3.next=3,voip.init();case 3:return _context3.abrupt("return",voip);case 4:case"end":return _context3.stop()}}),_callee3)}))),function create(_x4,_x5){return _create.apply(this,arguments)})}]),EEVoipClient}(VoIPUser);function useDialPad_slicedToArray(r,e){return function useDialPad_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function useDialPad_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function useDialPad_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return useDialPad_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?useDialPad_arrayLikeToArray(r,a):void 0}}(r,e)||function useDialPad_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function useDialPad_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var DialPadModal_templateObject,useDialPad=function useDialPad(_ref){var _errors$PhoneInput,initialValue=_ref.initialValue,initialErrorMessage=_ref.initialErrorMessage,t=(0,dist.useTranslation)(),outboundClient=function useOutboundDialer(){var voipClient=(0,CallContext.d5)();return(0,CallContext.ZK)()&&voipClient instanceof EEVoipClient?voipClient:null}(),closeDialModal=(0,useDialModal.F)().closeDialModal,_useForm=(0,index_esm.mN)({defaultValues:{PhoneInput:initialValue||""}}),setFocus=_useForm.setFocus,register=_useForm.register,setValue=_useForm.setValue,setError=_useForm.setError,clearErrors=_useForm.clearErrors,watch=_useForm.watch,_useForm$formState=_useForm.formState,errors=_useForm$formState.errors,isDirty=_useForm$formState.isDirty,_register=register("PhoneInput"),ref=_register.ref,onChange=_register.onChange,value=watch("PhoneInput"),_useState2=useDialPad_slicedToArray((0,react.useState)(!0),2),disabled=_useState2[0],setDisabled=_useState2[1],handleBackspaceClick=(0,react.useCallback)((function(){clearErrors(),setValue("PhoneInput",value.slice(0,-1),{shouldDirty:!0})}),[clearErrors,setValue,value]),handlePadButtonClick=(0,react.useCallback)((function(digit){clearErrors(),setValue("PhoneInput",value+digit,{shouldDirty:!0})}),[clearErrors,setValue,value]),handlePadButtonLongPressed=(0,react.useCallback)((function(digit){"+"===digit&&setValue("PhoneInput",value+digit)}),[setValue,value]),handleCallButtonClick=(0,react.useCallback)((function(){if(!outboundClient)return setError("PhoneInput",{message:t("Something_went_wrong_try_again_later")});outboundClient.makeCall(value),closeDialModal()}),[outboundClient,setError,t,value,closeDialModal]),handleOnChange=(0,react.useCallback)((function(e){return onChange(e)}),[onChange]);return(0,react.useEffect)((function(){setDisabled(!value)}),[value]),(0,react.useEffect)((function(){setFocus("PhoneInput")}),[setFocus]),{inputName:"PhoneInput",inputRef:ref,inputError:isDirty?null===(_errors$PhoneInput=errors.PhoneInput)||void 0===_errors$PhoneInput?void 0:_errors$PhoneInput.message:initialErrorMessage,isButtonDisabled:disabled,handleOnChange:handleOnChange,handleBackspaceClick:handleBackspaceClick,handlePadButtonClick:handlePadButtonClick,handlePadButtonLongPressed:handlePadButtonLongPressed,handleCallButtonClick:handleCallButtonClick}};var callButtonStyle=(0,index_module.css)(DialPadModal_templateObject||(DialPadModal_templateObject=function DialPadModal_taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n\t> i {\n\t\tfont-size: 32px !important;\n\t}\n"]))),DialPadModal=function DialPadModal(_ref){var initialValue=_ref.initialValue,initialErrorMessage=_ref.errorMessage,handleClose=_ref.handleClose,_useDialPad=useDialPad({initialValue:initialValue,initialErrorMessage:initialErrorMessage}),inputName=_useDialPad.inputName,inputRef=_useDialPad.inputRef,inputError=_useDialPad.inputError,isButtonDisabled=_useDialPad.isButtonDisabled,handleOnChange=_useDialPad.handleOnChange,handleBackspaceClick=_useDialPad.handleBackspaceClick,handlePadButtonClick=_useDialPad.handlePadButtonClick,handlePadButtonLongPressed=_useDialPad.handlePadButtonLongPressed,handleCallButtonClick=_useDialPad.handleCallButtonClick;return function useEnterKey(onEnter,disabled){(0,react.useEffect)((function(){var sendOnEnter=function sendOnEnter(e){"Enter"!==e.key||disabled||(e.stopPropagation(),onEnter())};return window.addEventListener("keydown",sendOnEnter),function(){window.removeEventListener("keydown",sendOnEnter)}}),[disabled,onEnter])}(handleCallButtonClick,isButtonDisabled),react.createElement(fuselage.Modal,{width:"432px"},react.createElement(fuselage.Modal.Header,null,react.createElement(fuselage.Modal.Title,null),react.createElement(fuselage.Modal.Close,{onClick:handleClose})),react.createElement(fuselage.Modal.Content,{display:"flex",justifyContent:"center",flexDirection:"column"},react.createElement(fuselage.Field,null,react.createElement(DialInput,{ref:inputRef,inputName:inputName,inputError:inputError,handleBackspaceClick:handleBackspaceClick,isButtonDisabled:isButtonDisabled,handleOnChange:handleOnChange}),react.createElement(fuselage.FieldError,{fontSize:"12px",h:"16px",textAlign:"center"},inputError)),react.createElement(DialPad_Pad,{onClickPadButton:handlePadButtonClick,onLongPressPadButton:handlePadButtonLongPressed})),react.createElement(fuselage.Modal.Footer,{justifyContent:"center"},react.createElement(fuselage.IconButton,{className:callButtonStyle,icon:"phone",disabled:isButtonDisabled,borderRadius:"full",secondary:!0,info:!0,size:"64px",onClick:function onClick(){handleCallButtonClick(),handleClose()}})))},DialPad_DialPadModal=DialPadModal;DialPadModal.__docgenInfo={description:"",methods:[],displayName:"DialPadModal",props:{initialValue:{required:!1,tsType:{name:"string"},description:""},errorMessage:{required:!1,tsType:{name:"string"},description:""},handleClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}}}}]);