"use strict";(self.webpackChunk_rocket_chat_meteor=self.webpackChunk_rocket_chat_meteor||[]).push([[1041],{"./client/hooks/useAsyncState.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z7:function(){return _lib_asyncState__WEBPACK_IMPORTED_MODULE_2__.Z7},vl:function(){return useAsyncState}});var _rocket_chat_fuselage_hooks__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@rocket.chat/fuselage-hooks/dist/index.module.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_lib_asyncState__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./client/lib/asyncState/index.ts");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var useAsyncState=function useAsyncState(initialValue){var _useSafely2=_slicedToArray((0,_rocket_chat_fuselage_hooks__WEBPACK_IMPORTED_MODULE_0__.useSafely)((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)((function(){return void 0===initialValue?_lib_asyncState__WEBPACK_IMPORTED_MODULE_2__.es.loading():_lib_asyncState__WEBPACK_IMPORTED_MODULE_2__.es.resolved("function"==typeof initialValue?initialValue():initialValue)}))),2),state=_useSafely2[0],setState=_useSafely2[1],resolve=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(value){setState((function(state){return"function"==typeof value?_lib_asyncState__WEBPACK_IMPORTED_MODULE_2__.es.resolve(state,value(state.value)):_lib_asyncState__WEBPACK_IMPORTED_MODULE_2__.es.resolve(state,value)}))}),[setState]),reject=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(error){setState((function(state){return _lib_asyncState__WEBPACK_IMPORTED_MODULE_2__.es.reject(state,error)}))}),[setState]),update=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(){setState((function(state){return _lib_asyncState__WEBPACK_IMPORTED_MODULE_2__.es.update(state)}))}),[setState]),reset=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(){setState((function(state){return _lib_asyncState__WEBPACK_IMPORTED_MODULE_2__.es.reload(state)}))}),[setState]);return(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((function(){return _objectSpread(_objectSpread({},state),{},{resolve:resolve,reject:reject,reset:reset,update:update})}),[state,resolve,reject,reset,update])}},"./client/hooks/useEndpointAction.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{r:function(){return useEndpointAction}});var _rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),_tanstack_react_query__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/@tanstack/react-query/build/lib/index.js");function useEndpointAction(method,pathPattern){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{keys:{}},sendData=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__.useEndpoint)(method,pathPattern,options.keys),dispatchToastMessage=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__.useToastMessageDispatch)();return(0,_tanstack_react_query__WEBPACK_IMPORTED_MODULE_1__.useMutation)(sendData,{onSuccess:function onSuccess(){options.successMessage&&dispatchToastMessage({type:"success",message:options.successMessage})},onError:function onError(error){dispatchToastMessage({type:"error",message:error})}}).mutateAsync}},"./client/hooks/useEndpointData.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{t:function(){return useEndpointData}});var _rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_lib_utils_getConfig__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./client/lib/utils/getConfig.ts"),_useAsyncState__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./client/hooks/useAsyncState.ts"),_excluded=["resolve","reject","reset"];function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var deprecationWarning=function log(name){return"true"===(0,_lib_utils_getConfig__WEBPACK_IMPORTED_MODULE_2__.z)("debug")?function(){for(var _console,_len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_console=console).warn.apply(_console,[name].concat(args))}:function(){}}("useEndpointData is deprecated, use @tanstack/react-query instead"),useEndpointData=function useEndpointData(endpoint){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};deprecationWarning(_objectSpread({endpoint:endpoint},options));var _useAsyncState=(0,_useAsyncState__WEBPACK_IMPORTED_MODULE_3__.vl)(options.initialValue),resolve=_useAsyncState.resolve,reject=_useAsyncState.reject,reset=_useAsyncState.reset,state=function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)o=s[r],t.includes(o)||{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_useAsyncState,_excluded),dispatchToastMessage=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__.useToastMessageDispatch)(),getData=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__.useEndpoint)("GET",endpoint,options.keys),fetchData=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(){reset(),getData(options.params).then(resolve).catch((function(error){console.error(error),dispatchToastMessage({type:"error",message:error}),reject(error)}))}),[reset,getData,options.params,resolve,dispatchToastMessage,reject]);return(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){fetchData()}),[fetchData]),_objectSpread(_objectSpread({},state),{},{reload:fetchData})}},"./client/views/room/contextualBar/AutoTranslate/AutoTranslate.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@rocket.chat/fuselage/index.js"),_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/index.js"),_components_Contextualbar__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./client/components/Contextualbar/index.ts"),_contexts_RoomContext__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./client/views/room/contexts/RoomContext.ts"),AutoTranslate=function AutoTranslate(_ref){var language=_ref.language,languages=_ref.languages,handleSwitch=_ref.handleSwitch,translateEnable=_ref.translateEnable,handleChangeLanguage=_ref.handleChangeLanguage,handleClose=_ref.handleClose,t=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__.useTranslation)(),room=(0,_contexts_RoomContext__WEBPACK_IMPORTED_MODULE_4__.nq)();return react__WEBPACK_IMPORTED_MODULE_2__.createElement(react__WEBPACK_IMPORTED_MODULE_2__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_2__.createElement(_components_Contextualbar__WEBPACK_IMPORTED_MODULE_3__.mH,null,react__WEBPACK_IMPORTED_MODULE_2__.createElement(_components_Contextualbar__WEBPACK_IMPORTED_MODULE_3__.A4,{name:"language"}),react__WEBPACK_IMPORTED_MODULE_2__.createElement(_components_Contextualbar__WEBPACK_IMPORTED_MODULE_3__.jY,null,t("Auto_Translate")),handleClose&&react__WEBPACK_IMPORTED_MODULE_2__.createElement(_components_Contextualbar__WEBPACK_IMPORTED_MODULE_3__.pi,{onClick:handleClose})),react__WEBPACK_IMPORTED_MODULE_2__.createElement(_components_Contextualbar__WEBPACK_IMPORTED_MODULE_3__.Ib,{pbs:24},react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.FieldGroup,null,room.encrypted&&react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.Callout,{title:t("Automatic_translation_not_available"),type:"warning"},t("Automatic_translation_not_available_info")),react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.Field,null,react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.FieldRow,null,react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.FieldLabel,{htmlFor:"automatic-translation"},t("Automatic_Translation")),react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.ToggleSwitch,{id:"automatic-translation",onChange:handleSwitch,defaultChecked:translateEnable,disabled:room.encrypted&&!translateEnable}))),react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.Field,null,react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.FieldLabel,{htmlFor:"translate-to"},t("Translate_to")),react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.FieldRow,{verticalAlign:"middle"},react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.Select,{id:"language",value:language,disabled:!translateEnable,onChange:function onChange(value){return handleChangeLanguage(String(value))},options:languages}))))))};__webpack_exports__.A=AutoTranslate,AutoTranslate.__docgenInfo={description:"",methods:[],displayName:"AutoTranslate",props:{language:{required:!0,tsType:{name:"string"},description:""},languages:{required:!0,tsType:{name:"Array",elements:[{name:"SelectOption"}],raw:"SelectOption[]"},description:""},handleSwitch:{required:!0,tsType:{name:"signature",type:"function",raw:"(e: ChangeEvent<HTMLInputElement>) => void",signature:{arguments:[{type:{name:"ChangeEvent",elements:[{name:"HTMLInputElement"}],raw:"ChangeEvent<HTMLInputElement>"},name:"e"}],return:{name:"void"}}},description:""},translateEnable:{required:!0,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:""},handleChangeLanguage:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},handleClose:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}}},"./client/views/room/contextualBar/AutoTranslate/index.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return AutoTranslate_AutoTranslateWithData}});var index_module=__webpack_require__("./node_modules/@rocket.chat/fuselage-hooks/dist/index.module.js"),dist=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react=__webpack_require__("./node_modules/react/index.js"),es=__webpack_require__("./node_modules/react-i18next/dist/es/index.js"),useEndpointAction=__webpack_require__("./client/hooks/useEndpointAction.ts"),useEndpointData=__webpack_require__("./client/hooks/useEndpointData.ts"),toast=__webpack_require__("./client/lib/toast.ts"),RoomContext=__webpack_require__("./client/views/room/contexts/RoomContext.ts"),RoomToolboxContext=__webpack_require__("./client/views/room/contexts/RoomToolboxContext.ts"),AutoTranslate=__webpack_require__("./client/views/room/contextualBar/AutoTranslate/AutoTranslate.tsx");function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var AutoTranslateWithData=function AutoTranslateWithData(){var _subscription$autoTra,room=(0,RoomContext.nq)(),subscription=(0,RoomContext.Mq)(),closeTab=(0,RoomToolboxContext.W)().closeTab,userLanguage=(0,dist.useLanguage)(),_useState2=_slicedToArray((0,react.useState)(null!==(_subscription$autoTra=null==subscription?void 0:subscription.autoTranslateLanguage)&&void 0!==_subscription$autoTra?_subscription$autoTra:""),2),currentLanguage=_useState2[0],setCurrentLanguage=_useState2[1],saveSettings=(0,useEndpointAction.r)("POST","/v1/autotranslate.saveSettings"),t=(0,es.Bd)().t,translateData=(0,useEndpointData.t)("/v1/autotranslate.getSupportedLanguages",{params:(0,react.useMemo)((function(){return{targetLanguage:userLanguage}}),[userLanguage])}).value,languagesDict=translateData?Object.fromEntries(translateData.languages.map((function(lang){return[lang.language,lang.name]}))):{},handleChangeLanguage=(0,index_module.useMutableCallback)((function(value){setCurrentLanguage(value),saveSettings({roomId:room._id,field:"autoTranslateLanguage",value:value}),(0,toast.b)({type:"success",message:t("AutoTranslate_language_set_to",{language:languagesDict[value]})})})),handleSwitch=(0,index_module.useMutableCallback)((function(event){saveSettings({roomId:room._id,field:"autoTranslate",value:event.target.checked}),(0,toast.b)({type:"success",message:event.target.checked?t("AutoTranslate_Enabled_for_room",{roomName:room.name}):t("AutoTranslate_Disabled_for_room",{roomName:room.name})}),event.target.checked&&currentLanguage&&(0,toast.b)({type:"success",message:t("AutoTranslate_language_set_to",{language:languagesDict[currentLanguage]})})}));return(0,react.useEffect)((function(){null!=subscription&&subscription.autoTranslate&&(null!=subscription&&subscription.autoTranslateLanguage||handleChangeLanguage(userLanguage))}),[null==subscription?void 0:subscription.autoTranslate,null==subscription?void 0:subscription.autoTranslateLanguage,handleChangeLanguage,userLanguage]),react.createElement(AutoTranslate.A,{language:currentLanguage,languages:translateData?translateData.languages.map((function(language){return[language.language,language.name]})):[],handleSwitch:handleSwitch,handleChangeLanguage:handleChangeLanguage,translateEnable:!(null==subscription||!subscription.autoTranslate),handleClose:closeTab})},AutoTranslate_AutoTranslateWithData=(0,react.memo)(AutoTranslateWithData);AutoTranslateWithData.__docgenInfo={description:"",methods:[],displayName:"AutoTranslateWithData"}}}]);