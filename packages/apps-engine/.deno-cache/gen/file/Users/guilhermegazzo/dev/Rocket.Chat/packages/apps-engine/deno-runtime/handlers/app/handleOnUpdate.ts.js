import { AppObjectRegistry } from '../../AppObjectRegistry.ts';
import { AppAccessorsInstance } from '../../lib/accessors/mod.ts';
export default async function handleOnUpdate(params) {
  const app = AppObjectRegistry.get('app');
  if (typeof app?.onUpdate !== 'function') {
    throw new Error('App must contain an onUpdate function', {
      cause: 'invalid_app'
    });
  }
  if (!Array.isArray(params)) {
    throw new Error('Invalid params', {
      cause: 'invalid_param_type'
    });
  }
  const [context] = params;
  await app.onUpdate(context, AppAccessorsInstance.getReader(), AppAccessorsInstance.getHttp(), AppAccessorsInstance.getPersistence(), AppAccessorsInstance.getModifier());
  return true;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZpbGU6Ly8vVXNlcnMvZ3VpbGhlcm1lZ2F6em8vZGV2L1JvY2tldC5DaGF0L3BhY2thZ2VzL2FwcHMtZW5naW5lL2Rlbm8tcnVudGltZS9oYW5kbGVycy9hcHAvaGFuZGxlT25VcGRhdGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBBcHAgfSBmcm9tICdAcm9ja2V0LmNoYXQvYXBwcy1lbmdpbmUvZGVmaW5pdGlvbi9BcHAudHMnO1xyXG5cclxuaW1wb3J0IHsgQXBwT2JqZWN0UmVnaXN0cnkgfSBmcm9tICcuLi8uLi9BcHBPYmplY3RSZWdpc3RyeS50cyc7XHJcbmltcG9ydCB7IEFwcEFjY2Vzc29yc0luc3RhbmNlIH0gZnJvbSAnLi4vLi4vbGliL2FjY2Vzc29ycy9tb2QudHMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlT25VcGRhdGUocGFyYW1zOiB1bmtub3duKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgICBjb25zdCBhcHAgPSBBcHBPYmplY3RSZWdpc3RyeS5nZXQ8QXBwPignYXBwJyk7XHJcblxyXG4gICAgaWYgKHR5cGVvZiBhcHA/Lm9uVXBkYXRlICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBcHAgbXVzdCBjb250YWluIGFuIG9uVXBkYXRlIGZ1bmN0aW9uJywge1xyXG4gICAgICAgICAgICBjYXVzZTogJ2ludmFsaWRfYXBwJyxcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkocGFyYW1zKSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBwYXJhbXMnLCB7IGNhdXNlOiAnaW52YWxpZF9wYXJhbV90eXBlJyB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBbY29udGV4dF0gPSBwYXJhbXMgYXMgW1JlY29yZDxzdHJpbmcsIHVua25vd24+XTtcclxuXHJcbiAgICBhd2FpdCBhcHAub25VcGRhdGUoXHJcbiAgICAgICAgY29udGV4dCxcclxuICAgICAgICBBcHBBY2Nlc3NvcnNJbnN0YW5jZS5nZXRSZWFkZXIoKSxcclxuICAgICAgICBBcHBBY2Nlc3NvcnNJbnN0YW5jZS5nZXRIdHRwKCksXHJcbiAgICAgICAgQXBwQWNjZXNzb3JzSW5zdGFuY2UuZ2V0UGVyc2lzdGVuY2UoKSxcclxuICAgICAgICBBcHBBY2Nlc3NvcnNJbnN0YW5jZS5nZXRNb2RpZmllcigpLFxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsU0FBUyxpQkFBaUIsUUFBUSw2QkFBNkI7QUFDL0QsU0FBUyxvQkFBb0IsUUFBUSw2QkFBNkI7QUFFbEUsZUFBZSxlQUFlLGVBQWUsTUFBZTtFQUN4RCxNQUFNLE1BQU0sa0JBQWtCLEdBQUcsQ0FBTTtFQUV2QyxJQUFJLE9BQU8sS0FBSyxhQUFhLFlBQVk7SUFDckMsTUFBTSxJQUFJLE1BQU0seUNBQXlDO01BQ3JELE9BQU87SUFDWDtFQUNKO0VBRUEsSUFBSSxDQUFDLE1BQU0sT0FBTyxDQUFDLFNBQVM7SUFDeEIsTUFBTSxJQUFJLE1BQU0sa0JBQWtCO01BQUUsT0FBTztJQUFxQjtFQUNwRTtFQUVBLE1BQU0sQ0FBQyxRQUFRLEdBQUc7RUFFbEIsTUFBTSxJQUFJLFFBQVEsQ0FDZCxTQUNBLHFCQUFxQixTQUFTLElBQzlCLHFCQUFxQixPQUFPLElBQzVCLHFCQUFxQixjQUFjLElBQ25DLHFCQUFxQixXQUFXO0VBR3BDLE9BQU87QUFDWCJ9