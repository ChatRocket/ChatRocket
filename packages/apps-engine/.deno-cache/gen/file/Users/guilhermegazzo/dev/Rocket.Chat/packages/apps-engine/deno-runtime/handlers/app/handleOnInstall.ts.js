import { AppObjectRegistry } from '../../AppObjectRegistry.ts';
import { AppAccessorsInstance } from '../../lib/accessors/mod.ts';
export default async function handleOnInstall(params) {
  const app = AppObjectRegistry.get('app');
  if (typeof app?.onInstall !== 'function') {
    throw new Error('App must contain an onInstall function', {
      cause: 'invalid_app'
    });
  }
  if (!Array.isArray(params)) {
    throw new Error('Invalid params', {
      cause: 'invalid_param_type'
    });
  }
  const [context] = params;
  await app.onInstall(context, AppAccessorsInstance.getReader(), AppAccessorsInstance.getHttp(), AppAccessorsInstance.getPersistence(), AppAccessorsInstance.getModifier());
  return true;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZpbGU6Ly8vVXNlcnMvZ3VpbGhlcm1lZ2F6em8vZGV2L1JvY2tldC5DaGF0L3BhY2thZ2VzL2FwcHMtZW5naW5lL2Rlbm8tcnVudGltZS9oYW5kbGVycy9hcHAvaGFuZGxlT25JbnN0YWxsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgQXBwIH0gZnJvbSAnQHJvY2tldC5jaGF0L2FwcHMtZW5naW5lL2RlZmluaXRpb24vQXBwLnRzJztcblxuaW1wb3J0IHsgQXBwT2JqZWN0UmVnaXN0cnkgfSBmcm9tICcuLi8uLi9BcHBPYmplY3RSZWdpc3RyeS50cyc7XG5pbXBvcnQgeyBBcHBBY2Nlc3NvcnNJbnN0YW5jZSB9IGZyb20gJy4uLy4uL2xpYi9hY2Nlc3NvcnMvbW9kLnRzJztcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlT25JbnN0YWxsKHBhcmFtczogdW5rbm93bik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IGFwcCA9IEFwcE9iamVjdFJlZ2lzdHJ5LmdldDxBcHA+KCdhcHAnKTtcblxuICAgIGlmICh0eXBlb2YgYXBwPy5vbkluc3RhbGwgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBcHAgbXVzdCBjb250YWluIGFuIG9uSW5zdGFsbCBmdW5jdGlvbicsIHtcbiAgICAgICAgICAgIGNhdXNlOiAnaW52YWxpZF9hcHAnLFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoIUFycmF5LmlzQXJyYXkocGFyYW1zKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgcGFyYW1zJywgeyBjYXVzZTogJ2ludmFsaWRfcGFyYW1fdHlwZScgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgW2NvbnRleHRdID0gcGFyYW1zIGFzIFtSZWNvcmQ8c3RyaW5nLCB1bmtub3duPl07XG5cbiAgICBhd2FpdCBhcHAub25JbnN0YWxsKFxuICAgICAgICBjb250ZXh0LFxuICAgICAgICBBcHBBY2Nlc3NvcnNJbnN0YW5jZS5nZXRSZWFkZXIoKSxcbiAgICAgICAgQXBwQWNjZXNzb3JzSW5zdGFuY2UuZ2V0SHR0cCgpLFxuICAgICAgICBBcHBBY2Nlc3NvcnNJbnN0YW5jZS5nZXRQZXJzaXN0ZW5jZSgpLFxuICAgICAgICBBcHBBY2Nlc3NvcnNJbnN0YW5jZS5nZXRNb2RpZmllcigpLFxuICAgICk7XG5cbiAgICByZXR1cm4gdHJ1ZTtcbn1cbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxTQUFTLGlCQUFpQixRQUFRLDZCQUE2QjtBQUMvRCxTQUFTLG9CQUFvQixRQUFRLDZCQUE2QjtBQUVsRSxlQUFlLGVBQWUsZ0JBQWdCLE1BQWU7RUFDekQsTUFBTSxNQUFNLGtCQUFrQixHQUFHLENBQU07RUFFdkMsSUFBSSxPQUFPLEtBQUssY0FBYyxZQUFZO0lBQ3RDLE1BQU0sSUFBSSxNQUFNLDBDQUEwQztNQUN0RCxPQUFPO0lBQ1g7RUFDSjtFQUVBLElBQUksQ0FBQyxNQUFNLE9BQU8sQ0FBQyxTQUFTO0lBQ3hCLE1BQU0sSUFBSSxNQUFNLGtCQUFrQjtNQUFFLE9BQU87SUFBcUI7RUFDcEU7RUFFQSxNQUFNLENBQUMsUUFBUSxHQUFHO0VBRWxCLE1BQU0sSUFBSSxTQUFTLENBQ2YsU0FDQSxxQkFBcUIsU0FBUyxJQUM5QixxQkFBcUIsT0FBTyxJQUM1QixxQkFBcUIsY0FBYyxJQUNuQyxxQkFBcUIsV0FBVztFQUdwQyxPQUFPO0FBQ1gifQ==