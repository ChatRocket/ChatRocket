import { AppObjectRegistry } from '../../AppObjectRegistry.ts';
import { AppAccessorsInstance } from '../../lib/accessors/mod.ts';
export default async function handleOnUninstall(params) {
  const app = AppObjectRegistry.get('app');
  if (typeof app?.onUninstall !== 'function') {
    throw new Error('App must contain an onUninstall function', {
      cause: 'invalid_app'
    });
  }
  if (!Array.isArray(params)) {
    throw new Error('Invalid params', {
      cause: 'invalid_param_type'
    });
  }
  const [context] = params;
  await app.onUninstall(context, AppAccessorsInstance.getReader(), AppAccessorsInstance.getHttp(), AppAccessorsInstance.getPersistence(), AppAccessorsInstance.getModifier());
  return true;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZpbGU6Ly8vVXNlcnMvZ3VpbGhlcm1lZ2F6em8vZGV2L1JvY2tldC5DaGF0L3BhY2thZ2VzL2FwcHMtZW5naW5lL2Rlbm8tcnVudGltZS9oYW5kbGVycy9hcHAvaGFuZGxlT25Vbmluc3RhbGwudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBBcHAgfSBmcm9tICdAcm9ja2V0LmNoYXQvYXBwcy1lbmdpbmUvZGVmaW5pdGlvbi9BcHAudHMnO1xuXG5pbXBvcnQgeyBBcHBPYmplY3RSZWdpc3RyeSB9IGZyb20gJy4uLy4uL0FwcE9iamVjdFJlZ2lzdHJ5LnRzJztcbmltcG9ydCB7IEFwcEFjY2Vzc29yc0luc3RhbmNlIH0gZnJvbSAnLi4vLi4vbGliL2FjY2Vzc29ycy9tb2QudHMnO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVPblVuaW5zdGFsbChwYXJhbXM6IHVua25vd24pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCBhcHAgPSBBcHBPYmplY3RSZWdpc3RyeS5nZXQ8QXBwPignYXBwJyk7XG5cbiAgICBpZiAodHlwZW9mIGFwcD8ub25Vbmluc3RhbGwgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBcHAgbXVzdCBjb250YWluIGFuIG9uVW5pbnN0YWxsIGZ1bmN0aW9uJywge1xuICAgICAgICAgICAgY2F1c2U6ICdpbnZhbGlkX2FwcCcsXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICghQXJyYXkuaXNBcnJheShwYXJhbXMpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBwYXJhbXMnLCB7IGNhdXNlOiAnaW52YWxpZF9wYXJhbV90eXBlJyB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBbY29udGV4dF0gPSBwYXJhbXMgYXMgW1JlY29yZDxzdHJpbmcsIHVua25vd24+XTtcblxuICAgIGF3YWl0IGFwcC5vblVuaW5zdGFsbChcbiAgICAgICAgY29udGV4dCxcbiAgICAgICAgQXBwQWNjZXNzb3JzSW5zdGFuY2UuZ2V0UmVhZGVyKCksXG4gICAgICAgIEFwcEFjY2Vzc29yc0luc3RhbmNlLmdldEh0dHAoKSxcbiAgICAgICAgQXBwQWNjZXNzb3JzSW5zdGFuY2UuZ2V0UGVyc2lzdGVuY2UoKSxcbiAgICAgICAgQXBwQWNjZXNzb3JzSW5zdGFuY2UuZ2V0TW9kaWZpZXIoKSxcbiAgICApO1xuXG4gICAgcmV0dXJuIHRydWU7XG59XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsU0FBUyxpQkFBaUIsUUFBUSw2QkFBNkI7QUFDL0QsU0FBUyxvQkFBb0IsUUFBUSw2QkFBNkI7QUFFbEUsZUFBZSxlQUFlLGtCQUFrQixNQUFlO0VBQzNELE1BQU0sTUFBTSxrQkFBa0IsR0FBRyxDQUFNO0VBRXZDLElBQUksT0FBTyxLQUFLLGdCQUFnQixZQUFZO0lBQ3hDLE1BQU0sSUFBSSxNQUFNLDRDQUE0QztNQUN4RCxPQUFPO0lBQ1g7RUFDSjtFQUVBLElBQUksQ0FBQyxNQUFNLE9BQU8sQ0FBQyxTQUFTO0lBQ3hCLE1BQU0sSUFBSSxNQUFNLGtCQUFrQjtNQUFFLE9BQU87SUFBcUI7RUFDcEU7RUFFQSxNQUFNLENBQUMsUUFBUSxHQUFHO0VBRWxCLE1BQU0sSUFBSSxXQUFXLENBQ2pCLFNBQ0EscUJBQXFCLFNBQVMsSUFDOUIscUJBQXFCLE9BQU8sSUFDNUIscUJBQXFCLGNBQWMsSUFDbkMscUJBQXFCLFdBQVc7RUFHcEMsT0FBTztBQUNYIn0=