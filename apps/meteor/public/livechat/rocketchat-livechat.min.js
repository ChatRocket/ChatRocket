!function(){"use strict";var t,e,n=Symbol("once"),i=Symbol("evts"),o=function(){function o(){this[t]=new Map,this[e]=new WeakMap}return o.prototype.events=function(){return Array.from(this[i].keys())},o.prototype.has=function(t){return this[i].has(t)},o.prototype.on=function(t,e){var n,o=this,a=null!==(n=this[i].get(t))&&void 0!==n?n:[];return a.push(e),this[i].set(t,a),function(){return o.off(t,e)}},o.prototype.once=function(t,e){var i=this[n].get(e)||0;return this[n].set(e,i+1),this.on(t,e)},o.prototype.off=function(t,e){var o,a=this[i].get(t);if(a){var s=null!==(o=this[n].get(e))&&void 0!==o?o:0;s>1?this[n].set(e,s-1):this[n].delete(e),a.splice(a.findIndex((function(t){return t===e}))>>>0,1),0===a.length&&this[i].delete(t)}},o.prototype.emit=function(t){for(var e,o=this,a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];var r=a[0];(function(t,e,n){if(n||2===arguments.length)for(var i,o=0,a=e.length;o<a;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))})([],null!==(e=this[i].get(t))&&void 0!==e?e:[],!0).forEach((function(e){e(r),o[n].get(e)&&o.off(t,e)}))},o}();t=i,e=n;window.RocketChat=window.RocketChat||{_:[]};var a,s,r,c,d={},u=[],l=!1,f=!1,h=["chat-maximized","chat-minimized","chat-started","chat-ended","pre-chat-form-submit","offline-form-submit","show-widget","hide-widget","assign-agent","agent-status-change","queue-position-change","no-agent-online"],m=["uj","ul","livechat-close","livechat-started","livechat_transfer_history"],g=new o;function p(t,e){return-1!==h.indexOf(t)&&g.on(t,e)}function w(t,e){void 0!==e?g.emit(t,e):g.emit(t)}function v(t){for(var e,n,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(!l)return u.push([t,o]);if(null==(e=s)||!e.contentWindow)throw new Error("Widget is not initialized");var r={src:"rocketchat",fn:t,args:o};null==(n=s.contentWindow)||n.postMessage(r,"*")}var y=function(t){if(!s||!a)throw new Error("Widget is not initialized");var e=f&&"triggered"!==a.dataset.state;f&&t?(r=document.documentElement.scrollTop,document.body.classList.add("rc-livechat-mobile-full-screen")):(document.body.classList.remove("rc-livechat-mobile-full-screen"),f&&(document.documentElement.scrollTop=r)),t?(a.style.left=e?"0":"auto",a.style.height=e?"100%":16+c+16+54+"px",a.style.width=e?"100%":"397px"):(a.style.left="auto",a.style.width="86px",a.style.height="86px")},b=function(){if(!s||!a)throw new Error("Widget is not initialized");"opened"!==a.dataset.state&&(c=525,a.dataset.state="opened",y(!0),s.focus(),w("chat-maximized"))};function E(){if(!s||!a)throw new Error("Widget is not initialized");"closed"!==a.dataset.state&&(a.dataset.state="closed",y(!1),w("chat-minimized"))}function C(t){v("pageVisited",{change:t,location:JSON.parse(JSON.stringify(document.location)),title:document.title})}function W(t,e,n){void 0===e&&(e=""),void 0===n&&(n=!0),void 0===n&&(n=!0),t&&v("setCustomField",t,e,n)}function k(t){"left"!==(null==t?void 0:t.position)&&"right"!==(null==t?void 0:t.position)&&(null!=t&&t.position&&console.warn('Error: Position "'+(null==t?void 0:t.position)+'" is invalid. It must be "left" or "right"'),delete t.position),v("setTheme",t)}function z(t){v("setDepartment",t)}function x(t){v("setBusinessUnit",t)}function S(t){v("setGuestToken",t)}function A(t){v("setGuestName",t)}function R(t){v("setGuestEmail",t)}function M(t){v("registerGuest",t)}function G(t){v("setAgent",t)}function P(t){v("setLanguage",t)}function I(t){v("setParentUrl",t)}function U(t){if("object"!=typeof t)throw new Error("Invalid metadata");v("setGuestMetadata",t)}function L(t){if(!Array.isArray(t))throw new Error("Error: Invalid parameters. Value must be an array of strings");v("setHiddenSystemMessages",t.filter((function(t){return!!m.includes(t)||(console.warn('Error: Invalid system message "'+t+'"'),!1)})))}var O={popup:null,openWidget:b,resizeWidget:function(t){if(!a)throw new Error("Widget is not initialized");c=t,a.dataset.state="triggered",y(!0)},ready:function(){l=!0,u.length&&(u.forEach((function(t){var e=t[0],n=t[1],i=void 0===n?[]:n;v.apply(void 0,[e].concat(i))})),u=[])},minimizeWindow:function(){E()},restoreWindow:function(){O.popup&&!0!==O.popup.closed&&(O.popup.close(),O.popup=null),b()},openPopout:function(){var t;if(E(),!d.url)throw new Error("Config.url is not set!");O.popup=window.open(d.url+(d.url.lastIndexOf("?")>-1?"&":"?")+"mode=popout","livechat-popout","width=365, height="+c+", toolbars=no"),null==(t=O.popup)||t.focus()},removeWidget:function(){document.body.removeChild(a)},callback:function(t,e){w(t,e)},showWidget:function(){if(!s)throw new Error("Widget is not initialized");s.style.display="initial",w("show-widget")},hideWidget:function(){if(!s)throw new Error("Widget is not initialized");s.style.display="none",w("hide-widget")},resetDocumentStyle:function(){document.body.classList.remove("rc-livechat-mobile-full-screen")},setFullScreenDocumentMobile:function(){f&&document.body.classList.add("rc-livechat-mobile-full-screen")},setWidgetPosition:function(t){if(void 0===t&&(t="right"),!a)throw new Error("Widget is not initialized");a.style.left="left"===t?"0":"auto",a.style.right="left"!==t?"0":"auto"}},F={initialize:function(t){for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];if(null!=n)switch(e){case"customField":W.apply(void 0,n);continue;case"setCustomFields":i=n,Array.isArray(i)?i.forEach((function(t){var e=t[0],n=t[1],i=t[2];W(e,n,void 0===i||i)})):console.log("Error: Invalid parameters. Value must be an array of objects");continue;case"theme":k(n);continue;case"department":z(n);continue;case"businessUnit":x(n);continue;case"guestToken":S(n);continue;case"guestName":A(n);continue;case"guestEmail":R(n);continue;case"registerGuest":M(n);continue;case"language":P(n);continue;case"agent":G(n);continue;case"parentUrl":I(n);continue;case"setGuestMetadata":U(n);continue;case"hiddenSystemMessages":L(n);continue;default:continue}}var i},pageVisited:C,setCustomField:W,setTheme:k,setDepartment:z,clearDepartment:function(){v("clearDepartment")},setGuestToken:S,setGuestName:A,setGuestEmail:R,setAgent:G,registerGuest:M,setLanguage:P,showWidget:function(){v("showWidget"),w("show-widget")},hideWidget:function(){v("hideWidget"),w("hide-widget")},maximizeWidget:function(){v("maximizeWidget"),w("chat-maximized")},minimizeWidget:function(){v("minimizeWidget"),w("chat-minimized")},setBusinessUnit:x,clearBusinessUnit:function(){v("clearBusinessUnit")},setParentUrl:I,setGuestMetadata:U,clearAllCallbacks:function(){g.events().forEach((function(t){g.off(t,(function(){}))}))},setHiddenSystemMessages:L,transferChat:function(t){v("transferChat",t)},onChatMaximized:function(t){p("chat-maximized",t)},onChatMinimized:function(t){p("chat-minimized",t)},onChatStarted:function(t){p("chat-started",t)},onChatEnded:function(t){p("chat-ended",t)},onPrechatFormSubmit:function(t){p("pre-chat-form-submit",t)},onOfflineFormSubmit:function(t){p("offline-form-submit",t)},onWidgetShown:function(t){p("show-widget",t)},onWidgetHidden:function(t){p("hide-widget",t)},onAssignAgent:function(t){p("assign-agent",t)},onAgentStatusChange:function(t){p("agent-status-change",t)},onQueuePositionChange:function(t){p("queue-position-change",t)},onServiceOffline:function(t){p("no-agent-online",t)}},N={href:null,title:null};function T(t){if(t.source!==t.target&&t.data&&"object"==typeof t.data&&t.data.src&&"rocketchat"===t.data.src){var e=t.data,n=e.fn,i=e.args;O.hasOwnProperty(n)&&O[n].apply(O,i)}}var D=function(t){var e=t.trim();e&&(d.url=e,function(t){(a=document.createElement("div")).className="rocketchat-widget",a.style.position="fixed",a.style.width="86px",a.style.height="86px",a.style.maxHeight="100vh",a.style.bottom="0",a.style.left="0",a.style.zIndex="12345",a.dataset.state="closed";var e=document.createElement("div");e.className="rocketchat-container",e.style.width="100%",e.style.height="100%",(s=document.createElement("iframe")).id="rocketchat-iframe",s.src=t,s.style.width="100%",s.style.height="100%",s.style.border="none",s.style.backgroundColor="transparent",e.appendChild(s),a.appendChild(e),document.body.appendChild(a);var n=function(t){var e=t.matches;a&&(f=e,y("opened"===a.dataset.state),v("setExpanded",f),v("setParentUrl",window.location.href))},i=window.matchMedia("screen and (max-device-width: 480px)");i.addListener(n),n(i)}(e),window.addEventListener("message",T,!1),setInterval((function(){document.location.href!==N.href&&(C("url"),N.href=document.location.href),document.title!==N.title&&(C("title"),N.title=document.title)}),800))};void 0!==window.initRocket&&(console.warn("initRocket is now deprecated. Please update the livechat code."),D(window.initRocket[0])),void 0!==window.RocketChat.url&&D(window.RocketChat.url);var _=window.RocketChat._;window.RocketChat._.push=function(t){t.call(window.RocketChat.livechat)},window.RocketChat=window.RocketChat._.push,window.RocketChat.livechat=F,_.forEach((function(t){t.call(window.RocketChat.livechat)}))}();
//# sourceMappingURL=rocketchat-livechat.min.js.map