{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/modal/uikit/ModalBlock.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/modal/uikit/ModalBlock.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/modal/uikit/ModalBlock.tsx","inputSourceMap":{"version":3,"file":"client/views/modal/uikit/ModalBlock.tsx","sourceRoot":"","sources":["client/views/modal/uikit/ModalBlock.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Modal, AnimatedVisibility, Button, Box } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { UiKitComponent, UiKitModal, modalParser } from '@rocket.chat/fuselage-ui-kit';\nimport * as UiKit from '@rocket.chat/ui-kit';\nimport type { FormEventHandler, ReactElement } from 'react';\nimport React, { useCallback, useEffect, useMemo, useRef } from 'react';\nimport { FocusScope } from 'react-aria';\n\nimport { getURL } from '../../../../app/utils/client/getURL';\nimport { getButtonStyle } from './getButtonStyle';\n\nconst focusableElementsString = `\n\ta[href]:not([tabindex=\"-1\"]),\n\tarea[href]:not([tabindex=\"-1\"]),\n\tinput:not([disabled]):not([tabindex=\"-1\"]),\n\tselect:not([disabled]):not([tabindex=\"-1\"]),\n\ttextarea:not([disabled]):not([tabindex=\"-1\"]),\n\tbutton:not([disabled]):not([tabindex=\"-1\"]),\n\tiframe,\n\tobject,\n\tembed,\n\t[tabindex]:not([tabindex=\"-1\"]),\n\t[contenteditable]`;\n\nconst focusableElementsStringInvalid = `\n\ta[href]:not([tabindex=\"-1\"]):invalid,\n\tarea[href]:not([tabindex=\"-1\"]):invalid,\n\tinput:not([disabled]):not([tabindex=\"-1\"]):invalid,\n\tselect:not([disabled]):not([tabindex=\"-1\"]):invalid,\n\ttextarea:not([disabled]):not([tabindex=\"-1\"]):invalid,\n\tbutton:not([disabled]):not([tabindex=\"-1\"]):invalid,\n\tiframe:invalid,\n\tobject:invalid,\n\tembed:invalid,\n\t[tabindex]:not([tabindex=\"-1\"]):invalid,\n\t[contenteditable]:invalid`;\n\ntype ModalBlockParams = {\n\tview: UiKit.ModalView;\n\terrors: any;\n\tappId: string;\n\tonSubmit: FormEventHandler<HTMLElement>;\n\tonClose: () => void;\n\tonCancel: FormEventHandler<HTMLElement>;\n};\n\nconst isFocusable = (element: Element | null): element is HTMLElement =>\n\telement !== null && 'focus' in element && typeof element.focus === 'function';\n\nconst KeyboardCode = new Map<string, number>([\n\t['ENTER', 13],\n\t['ESC', 27],\n\t['TAB', 9],\n]);\n\nconst ModalBlock = ({ view, errors, onSubmit, onClose, onCancel }: ModalBlockParams): ReactElement => {\n\tconst id = `modal_id_${useUniqueId()}`;\n\tconst ref = useRef<HTMLElement>(null);\n\n\tuseEffect(() => {\n\t\tif (!ref.current) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (errors && Object.keys(errors).length) {\n\t\t\tconst element = ref.current.querySelector<HTMLElement>(focusableElementsStringInvalid);\n\t\t\telement?.focus();\n\t\t} else {\n\t\t\tconst element = ref.current.querySelector<HTMLElement>(focusableElementsString);\n\t\t\telement?.focus();\n\t\t}\n\t}, [errors]);\n\n\tconst previousFocus = useMemo(() => document.activeElement, []);\n\n\tuseEffect(\n\t\t() => () => {\n\t\t\tif (previousFocus && isFocusable(previousFocus)) {\n\t\t\t\treturn previousFocus.focus();\n\t\t\t}\n\t\t},\n\t\t[previousFocus],\n\t);\n\n\tconst handleKeyDown = useCallback(\n\t\t(event) => {\n\t\t\tswitch (event.keyCode) {\n\t\t\t\tcase KeyboardCode.get('ENTER'):\n\t\t\t\t\tif (event?.target?.nodeName !== 'TEXTAREA') {\n\t\t\t\t\t\treturn onSubmit(event);\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\tcase KeyboardCode.get('ESC'):\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tonClose();\n\t\t\t\t\treturn;\n\t\t\t\tcase KeyboardCode.get('TAB'):\n\t\t\t\t\tif (!ref.current) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst elements = Array.from(ref.current.querySelectorAll(focusableElementsString)) as HTMLElement[];\n\t\t\t\t\tconst [first] = elements;\n\t\t\t\t\tconst last = elements.pop();\n\n\t\t\t\t\tif (!ref.current.contains(document.activeElement)) {\n\t\t\t\t\t\treturn first.focus();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (event.shiftKey) {\n\t\t\t\t\t\tif (!first || first === document.activeElement) {\n\t\t\t\t\t\t\tlast?.focus();\n\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!last || last === document.activeElement) {\n\t\t\t\t\t\tfirst.focus();\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[onClose, onSubmit],\n\t);\n\n\tuseEffect(() => {\n\t\tconst element = document.querySelector('#modal-root') as HTMLElement;\n\t\tconst container = element.querySelector('.rcx-modal__content') as HTMLElement;\n\t\tconst close = (e: Event) => {\n\t\t\tif (e.target !== element) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tonClose();\n\t\t\treturn false;\n\t\t};\n\n\t\tconst ignoreIfNotContains = (e: Event) => {\n\t\t\tif (e.target !== element) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!container.contains(e.target as HTMLElement)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn handleKeyDown(e);\n\t\t};\n\n\t\tdocument.addEventListener('keydown', ignoreIfNotContains);\n\t\telement.addEventListener('click', close);\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('keydown', ignoreIfNotContains);\n\t\t\telement.removeEventListener('click', close);\n\t\t};\n\t}, [handleKeyDown, onClose]);\n\n\treturn (\n\t\t<AnimatedVisibility visibility={AnimatedVisibility.UNHIDING}>\n\t\t\t<FocusScope contain restoreFocus autoFocus>\n\t\t\t\t<Modal open id={id} ref={ref}>\n\t\t\t\t\t<Modal.Header>\n\t\t\t\t\t\t{view.showIcon ? <Modal.Thumb url={getURL(`/api/apps/${view.appId}/icon`)} /> : null}\n\t\t\t\t\t\t<Modal.Title>{modalParser.text(view.title, UiKit.BlockContext.NONE, 0)}</Modal.Title>\n\t\t\t\t\t\t<Modal.Close tabIndex={-1} onClick={onClose} />\n\t\t\t\t\t</Modal.Header>\n\t\t\t\t\t<Modal.Content>\n\t\t\t\t\t\t<Box is='form' method='post' action='#' onSubmit={onSubmit}>\n\t\t\t\t\t\t\t<UiKitComponent render={UiKitModal} blocks={view.blocks} />\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t</Modal.Content>\n\t\t\t\t\t<Modal.Footer>\n\t\t\t\t\t\t<Modal.FooterControllers>\n\t\t\t\t\t\t\t{view.close && (\n\t\t\t\t\t\t\t\t<Button danger={view.close.style === 'danger'} onClick={onCancel}>\n\t\t\t\t\t\t\t\t\t{modalParser.text(view.close.text, UiKit.BlockContext.NONE, 0)}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{view.submit && (\n\t\t\t\t\t\t\t\t<Button {...getButtonStyle(view.submit)} onClick={onSubmit}>\n\t\t\t\t\t\t\t\t\t{modalParser.text(view.submit.text, UiKit.BlockContext.NONE, 1)}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Modal.FooterControllers>\n\t\t\t\t\t</Modal.Footer>\n\t\t\t\t</Modal>\n\t\t\t</FocusScope>\n\t\t</AnimatedVisibility>\n\t);\n};\n\nexport default ModalBlock;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/modal/uikit/ModalBlock.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/modal/uikit/ModalBlock.tsx","inputSourceMap":{"version":3,"file":"client/views/modal/uikit/ModalBlock.tsx","sourceRoot":"","sources":["client/views/modal/uikit/ModalBlock.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Modal, AnimatedVisibility, Button, Box } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { UiKitComponent, UiKitModal, modalParser } from '@rocket.chat/fuselage-ui-kit';\nimport * as UiKit from '@rocket.chat/ui-kit';\nimport type { FormEventHandler, ReactElement } from 'react';\nimport React, { useCallback, useEffect, useMemo, useRef } from 'react';\nimport { FocusScope } from 'react-aria';\n\nimport { getURL } from '../../../../app/utils/client/getURL';\nimport { getButtonStyle } from './getButtonStyle';\n\nconst focusableElementsString = `\n\ta[href]:not([tabindex=\"-1\"]),\n\tarea[href]:not([tabindex=\"-1\"]),\n\tinput:not([disabled]):not([tabindex=\"-1\"]),\n\tselect:not([disabled]):not([tabindex=\"-1\"]),\n\ttextarea:not([disabled]):not([tabindex=\"-1\"]),\n\tbutton:not([disabled]):not([tabindex=\"-1\"]),\n\tiframe,\n\tobject,\n\tembed,\n\t[tabindex]:not([tabindex=\"-1\"]),\n\t[contenteditable]`;\n\nconst focusableElementsStringInvalid = `\n\ta[href]:not([tabindex=\"-1\"]):invalid,\n\tarea[href]:not([tabindex=\"-1\"]):invalid,\n\tinput:not([disabled]):not([tabindex=\"-1\"]):invalid,\n\tselect:not([disabled]):not([tabindex=\"-1\"]):invalid,\n\ttextarea:not([disabled]):not([tabindex=\"-1\"]):invalid,\n\tbutton:not([disabled]):not([tabindex=\"-1\"]):invalid,\n\tiframe:invalid,\n\tobject:invalid,\n\tembed:invalid,\n\t[tabindex]:not([tabindex=\"-1\"]):invalid,\n\t[contenteditable]:invalid`;\n\ntype ModalBlockParams = {\n\tview: UiKit.ModalView;\n\terrors: any;\n\tappId: string;\n\tonSubmit: FormEventHandler<HTMLElement>;\n\tonClose: () => void;\n\tonCancel: FormEventHandler<HTMLElement>;\n};\n\nconst isFocusable = (element: Element | null): element is HTMLElement =>\n\telement !== null && 'focus' in element && typeof element.focus === 'function';\n\nconst KeyboardCode = new Map<string, number>([\n\t['ENTER', 13],\n\t['ESC', 27],\n\t['TAB', 9],\n]);\n\nconst ModalBlock = ({ view, errors, onSubmit, onClose, onCancel }: ModalBlockParams): ReactElement => {\n\tconst id = `modal_id_${useUniqueId()}`;\n\tconst ref = useRef<HTMLElement>(null);\n\n\tuseEffect(() => {\n\t\tif (!ref.current) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (errors && Object.keys(errors).length) {\n\t\t\tconst element = ref.current.querySelector<HTMLElement>(focusableElementsStringInvalid);\n\t\t\telement?.focus();\n\t\t} else {\n\t\t\tconst element = ref.current.querySelector<HTMLElement>(focusableElementsString);\n\t\t\telement?.focus();\n\t\t}\n\t}, [errors]);\n\n\tconst previousFocus = useMemo(() => document.activeElement, []);\n\n\tuseEffect(\n\t\t() => () => {\n\t\t\tif (previousFocus && isFocusable(previousFocus)) {\n\t\t\t\treturn previousFocus.focus();\n\t\t\t}\n\t\t},\n\t\t[previousFocus],\n\t);\n\n\tconst handleKeyDown = useCallback(\n\t\t(event) => {\n\t\t\tswitch (event.keyCode) {\n\t\t\t\tcase KeyboardCode.get('ENTER'):\n\t\t\t\t\tif (event?.target?.nodeName !== 'TEXTAREA') {\n\t\t\t\t\t\treturn onSubmit(event);\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\tcase KeyboardCode.get('ESC'):\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tonClose();\n\t\t\t\t\treturn;\n\t\t\t\tcase KeyboardCode.get('TAB'):\n\t\t\t\t\tif (!ref.current) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst elements = Array.from(ref.current.querySelectorAll(focusableElementsString)) as HTMLElement[];\n\t\t\t\t\tconst [first] = elements;\n\t\t\t\t\tconst last = elements.pop();\n\n\t\t\t\t\tif (!ref.current.contains(document.activeElement)) {\n\t\t\t\t\t\treturn first.focus();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (event.shiftKey) {\n\t\t\t\t\t\tif (!first || first === document.activeElement) {\n\t\t\t\t\t\t\tlast?.focus();\n\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!last || last === document.activeElement) {\n\t\t\t\t\t\tfirst.focus();\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[onClose, onSubmit],\n\t);\n\n\tuseEffect(() => {\n\t\tconst element = document.querySelector('#modal-root') as HTMLElement;\n\t\tconst container = element.querySelector('.rcx-modal__content') as HTMLElement;\n\t\tconst close = (e: Event) => {\n\t\t\tif (e.target !== element) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tonClose();\n\t\t\treturn false;\n\t\t};\n\n\t\tconst ignoreIfNotContains = (e: Event) => {\n\t\t\tif (e.target !== element) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!container.contains(e.target as HTMLElement)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn handleKeyDown(e);\n\t\t};\n\n\t\tdocument.addEventListener('keydown', ignoreIfNotContains);\n\t\telement.addEventListener('click', close);\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('keydown', ignoreIfNotContains);\n\t\t\telement.removeEventListener('click', close);\n\t\t};\n\t}, [handleKeyDown, onClose]);\n\n\treturn (\n\t\t<AnimatedVisibility visibility={AnimatedVisibility.UNHIDING}>\n\t\t\t<FocusScope contain restoreFocus autoFocus>\n\t\t\t\t<Modal open id={id} ref={ref}>\n\t\t\t\t\t<Modal.Header>\n\t\t\t\t\t\t{view.showIcon ? <Modal.Thumb url={getURL(`/api/apps/${view.appId}/icon`)} /> : null}\n\t\t\t\t\t\t<Modal.Title>{modalParser.text(view.title, UiKit.BlockContext.NONE, 0)}</Modal.Title>\n\t\t\t\t\t\t<Modal.Close tabIndex={-1} onClick={onClose} />\n\t\t\t\t\t</Modal.Header>\n\t\t\t\t\t<Modal.Content>\n\t\t\t\t\t\t<Box is='form' method='post' action='#' onSubmit={onSubmit}>\n\t\t\t\t\t\t\t<UiKitComponent render={UiKitModal} blocks={view.blocks} />\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t</Modal.Content>\n\t\t\t\t\t<Modal.Footer>\n\t\t\t\t\t\t<Modal.FooterControllers>\n\t\t\t\t\t\t\t{view.close && (\n\t\t\t\t\t\t\t\t<Button danger={view.close.style === 'danger'} onClick={onCancel}>\n\t\t\t\t\t\t\t\t\t{modalParser.text(view.close.text, UiKit.BlockContext.NONE, 0)}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{view.submit && (\n\t\t\t\t\t\t\t\t<Button {...getButtonStyle(view.submit)} onClick={onSubmit}>\n\t\t\t\t\t\t\t\t\t{modalParser.text(view.submit.text, UiKit.BlockContext.NONE, 1)}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Modal.FooterControllers>\n\t\t\t\t\t</Modal.Footer>\n\t\t\t\t</Modal>\n\t\t\t</FocusScope>\n\t\t</AnimatedVisibility>\n\t);\n};\n\nexport default ModalBlock;\n"]}}},"code":"let _extends;\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default(v) {\n    _extends = v;\n  }\n}, 0);\nlet Modal, AnimatedVisibility, Button, Box;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Modal(v) {\n    Modal = v;\n  },\n  AnimatedVisibility(v) {\n    AnimatedVisibility = v;\n  },\n  Button(v) {\n    Button = v;\n  },\n  Box(v) {\n    Box = v;\n  }\n}, 0);\nlet useUniqueId;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useUniqueId(v) {\n    useUniqueId = v;\n  }\n}, 1);\nlet UiKitComponent, UiKitModal, modalParser;\nmodule.link(\"@rocket.chat/fuselage-ui-kit\", {\n  UiKitComponent(v) {\n    UiKitComponent = v;\n  },\n  UiKitModal(v) {\n    UiKitModal = v;\n  },\n  modalParser(v) {\n    modalParser = v;\n  }\n}, 2);\nlet UiKit;\nmodule.link(\"@rocket.chat/ui-kit\", {\n  \"*\"(v) {\n    UiKit = v;\n  }\n}, 3);\nlet React, useCallback, useEffect, useMemo, useRef;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n  useCallback(v) {\n    useCallback = v;\n  },\n  useEffect(v) {\n    useEffect = v;\n  },\n  useMemo(v) {\n    useMemo = v;\n  },\n  useRef(v) {\n    useRef = v;\n  }\n}, 4);\nlet FocusScope;\nmodule.link(\"react-aria\", {\n  FocusScope(v) {\n    FocusScope = v;\n  }\n}, 5);\nlet getURL;\nmodule.link(\"../../../../app/utils/client/getURL\", {\n  getURL(v) {\n    getURL = v;\n  }\n}, 6);\nlet getButtonStyle;\nmodule.link(\"./getButtonStyle\", {\n  getButtonStyle(v) {\n    getButtonStyle = v;\n  }\n}, 7);\nconst focusableElementsString = \"\\n\\ta[href]:not([tabindex=\\\"-1\\\"]),\\n\\tarea[href]:not([tabindex=\\\"-1\\\"]),\\n\\tinput:not([disabled]):not([tabindex=\\\"-1\\\"]),\\n\\tselect:not([disabled]):not([tabindex=\\\"-1\\\"]),\\n\\ttextarea:not([disabled]):not([tabindex=\\\"-1\\\"]),\\n\\tbutton:not([disabled]):not([tabindex=\\\"-1\\\"]),\\n\\tiframe,\\n\\tobject,\\n\\tembed,\\n\\t[tabindex]:not([tabindex=\\\"-1\\\"]),\\n\\t[contenteditable]\";\nconst focusableElementsStringInvalid = \"\\n\\ta[href]:not([tabindex=\\\"-1\\\"]):invalid,\\n\\tarea[href]:not([tabindex=\\\"-1\\\"]):invalid,\\n\\tinput:not([disabled]):not([tabindex=\\\"-1\\\"]):invalid,\\n\\tselect:not([disabled]):not([tabindex=\\\"-1\\\"]):invalid,\\n\\ttextarea:not([disabled]):not([tabindex=\\\"-1\\\"]):invalid,\\n\\tbutton:not([disabled]):not([tabindex=\\\"-1\\\"]):invalid,\\n\\tiframe:invalid,\\n\\tobject:invalid,\\n\\tembed:invalid,\\n\\t[tabindex]:not([tabindex=\\\"-1\\\"]):invalid,\\n\\t[contenteditable]:invalid\";\nconst isFocusable = element => element !== null && 'focus' in element && typeof element.focus === 'function';\nconst KeyboardCode = new Map([['ENTER', 13], ['ESC', 27], ['TAB', 9]]);\nconst ModalBlock = _ref => {\n  let {\n    view,\n    errors,\n    onSubmit,\n    onClose,\n    onCancel\n  } = _ref;\n  const id = \"modal_id_\".concat(useUniqueId());\n  const ref = useRef(null);\n  useEffect(() => {\n    if (!ref.current) {\n      return;\n    }\n    if (errors && Object.keys(errors).length) {\n      const element = ref.current.querySelector(focusableElementsStringInvalid);\n      element === null || element === void 0 ? void 0 : element.focus();\n    } else {\n      const element = ref.current.querySelector(focusableElementsString);\n      element === null || element === void 0 ? void 0 : element.focus();\n    }\n  }, [errors]);\n  const previousFocus = useMemo(() => document.activeElement, []);\n  useEffect(() => () => {\n    if (previousFocus && isFocusable(previousFocus)) {\n      return previousFocus.focus();\n    }\n  }, [previousFocus]);\n  const handleKeyDown = useCallback(event => {\n    var _event$target;\n    switch (event.keyCode) {\n      case KeyboardCode.get('ENTER'):\n        if ((event === null || event === void 0 ? void 0 : (_event$target = event.target) === null || _event$target === void 0 ? void 0 : _event$target.nodeName) !== 'TEXTAREA') {\n          return onSubmit(event);\n        }\n        return;\n      case KeyboardCode.get('ESC'):\n        event.stopPropagation();\n        event.preventDefault();\n        onClose();\n        return;\n      case KeyboardCode.get('TAB'):\n        if (!ref.current) {\n          return;\n        }\n        const elements = Array.from(ref.current.querySelectorAll(focusableElementsString));\n        const [first] = elements;\n        const last = elements.pop();\n        if (!ref.current.contains(document.activeElement)) {\n          return first.focus();\n        }\n        if (event.shiftKey) {\n          if (!first || first === document.activeElement) {\n            last === null || last === void 0 ? void 0 : last.focus();\n            event.stopPropagation();\n            event.preventDefault();\n          }\n          return;\n        }\n        if (!last || last === document.activeElement) {\n          first.focus();\n          event.stopPropagation();\n          event.preventDefault();\n        }\n    }\n  }, [onClose, onSubmit]);\n  useEffect(() => {\n    const element = document.querySelector('#modal-root');\n    const container = element.querySelector('.rcx-modal__content');\n    const close = e => {\n      if (e.target !== element) {\n        return;\n      }\n      e.preventDefault();\n      e.stopPropagation();\n      onClose();\n      return false;\n    };\n    const ignoreIfNotContains = e => {\n      if (e.target !== element) {\n        return;\n      }\n      if (!container.contains(e.target)) {\n        return;\n      }\n      return handleKeyDown(e);\n    };\n    document.addEventListener('keydown', ignoreIfNotContains);\n    element.addEventListener('click', close);\n    return () => {\n      document.removeEventListener('keydown', ignoreIfNotContains);\n      element.removeEventListener('click', close);\n    };\n  }, [handleKeyDown, onClose]);\n  return /*#__PURE__*/React.createElement(AnimatedVisibility, {\n    visibility: AnimatedVisibility.UNHIDING\n  }, /*#__PURE__*/React.createElement(FocusScope, {\n    contain: true,\n    restoreFocus: true,\n    autoFocus: true\n  }, /*#__PURE__*/React.createElement(Modal, {\n    open: true,\n    id: id,\n    ref: ref\n  }, /*#__PURE__*/React.createElement(Modal.Header, null, view.showIcon ? /*#__PURE__*/React.createElement(Modal.Thumb, {\n    url: getURL(\"/api/apps/\".concat(view.appId, \"/icon\"))\n  }) : null, /*#__PURE__*/React.createElement(Modal.Title, null, modalParser.text(view.title, UiKit.BlockContext.NONE, 0)), /*#__PURE__*/React.createElement(Modal.Close, {\n    tabIndex: -1,\n    onClick: onClose\n  })), /*#__PURE__*/React.createElement(Modal.Content, null, /*#__PURE__*/React.createElement(Box, {\n    is: \"form\",\n    method: \"post\",\n    action: \"#\",\n    onSubmit: onSubmit\n  }, /*#__PURE__*/React.createElement(UiKitComponent, {\n    render: UiKitModal,\n    blocks: view.blocks\n  }))), /*#__PURE__*/React.createElement(Modal.Footer, null, /*#__PURE__*/React.createElement(Modal.FooterControllers, null, view.close && /*#__PURE__*/React.createElement(Button, {\n    danger: view.close.style === 'danger',\n    onClick: onCancel\n  }, modalParser.text(view.close.text, UiKit.BlockContext.NONE, 0)), view.submit && /*#__PURE__*/React.createElement(Button, _extends({}, getButtonStyle(view.submit), {\n    onClick: onSubmit\n  }), modalParser.text(view.submit.text, UiKit.BlockContext.NONE, 1)))))));\n};\nmodule.exportDefault(ModalBlock);","map":{"version":3,"names":["_extends","module","link","default","v","Modal","AnimatedVisibility","Button","Box","useUniqueId","UiKitComponent","UiKitModal","modalParser","UiKit","*","React","useCallback","useEffect","useMemo","useRef","FocusScope","getURL","getButtonStyle","focusableElementsString","focusableElementsStringInvalid","isFocusable","element","focus","KeyboardCode","Map","ModalBlock","_ref","view","errors","onSubmit","onClose","onCancel","id","concat","ref","current","Object","keys","length","querySelector","previousFocus","document","activeElement","handleKeyDown","event","_event$target","keyCode","get","target","nodeName","stopPropagation","preventDefault","elements","Array","from","querySelectorAll","first","last","pop","contains","shiftKey","container","close","e","ignoreIfNotContains","addEventListener","removeEventListener","createElement","visibility","UNHIDING","contain","restoreFocus","autoFocus","open","Header","showIcon","Thumb","url","appId","Title","text","title","BlockContext","NONE","Close","tabIndex","onClick","Content","is","method","action","render","blocks","Footer","FooterControllers","danger","style","submit","exportDefault"],"sources":["client/views/modal/uikit/ModalBlock.tsx"],"sourcesContent":["import { Modal, AnimatedVisibility, Button, Box } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { UiKitComponent, UiKitModal, modalParser } from '@rocket.chat/fuselage-ui-kit';\nimport * as UiKit from '@rocket.chat/ui-kit';\nimport type { FormEventHandler, ReactElement } from 'react';\nimport React, { useCallback, useEffect, useMemo, useRef } from 'react';\nimport { FocusScope } from 'react-aria';\n\nimport { getURL } from '../../../../app/utils/client/getURL';\nimport { getButtonStyle } from './getButtonStyle';\n\nconst focusableElementsString = `\n\ta[href]:not([tabindex=\"-1\"]),\n\tarea[href]:not([tabindex=\"-1\"]),\n\tinput:not([disabled]):not([tabindex=\"-1\"]),\n\tselect:not([disabled]):not([tabindex=\"-1\"]),\n\ttextarea:not([disabled]):not([tabindex=\"-1\"]),\n\tbutton:not([disabled]):not([tabindex=\"-1\"]),\n\tiframe,\n\tobject,\n\tembed,\n\t[tabindex]:not([tabindex=\"-1\"]),\n\t[contenteditable]`;\n\nconst focusableElementsStringInvalid = `\n\ta[href]:not([tabindex=\"-1\"]):invalid,\n\tarea[href]:not([tabindex=\"-1\"]):invalid,\n\tinput:not([disabled]):not([tabindex=\"-1\"]):invalid,\n\tselect:not([disabled]):not([tabindex=\"-1\"]):invalid,\n\ttextarea:not([disabled]):not([tabindex=\"-1\"]):invalid,\n\tbutton:not([disabled]):not([tabindex=\"-1\"]):invalid,\n\tiframe:invalid,\n\tobject:invalid,\n\tembed:invalid,\n\t[tabindex]:not([tabindex=\"-1\"]):invalid,\n\t[contenteditable]:invalid`;\n\ntype ModalBlockParams = {\n\tview: UiKit.ModalView;\n\terrors: any;\n\tappId: string;\n\tonSubmit: FormEventHandler<HTMLElement>;\n\tonClose: () => void;\n\tonCancel: FormEventHandler<HTMLElement>;\n};\n\nconst isFocusable = (element: Element | null): element is HTMLElement =>\n\telement !== null && 'focus' in element && typeof element.focus === 'function';\n\nconst KeyboardCode = new Map<string, number>([\n\t['ENTER', 13],\n\t['ESC', 27],\n\t['TAB', 9],\n]);\n\nconst ModalBlock = ({ view, errors, onSubmit, onClose, onCancel }: ModalBlockParams): ReactElement => {\n\tconst id = `modal_id_${useUniqueId()}`;\n\tconst ref = useRef<HTMLElement>(null);\n\n\tuseEffect(() => {\n\t\tif (!ref.current) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (errors && Object.keys(errors).length) {\n\t\t\tconst element = ref.current.querySelector<HTMLElement>(focusableElementsStringInvalid);\n\t\t\telement?.focus();\n\t\t} else {\n\t\t\tconst element = ref.current.querySelector<HTMLElement>(focusableElementsString);\n\t\t\telement?.focus();\n\t\t}\n\t}, [errors]);\n\n\tconst previousFocus = useMemo(() => document.activeElement, []);\n\n\tuseEffect(\n\t\t() => () => {\n\t\t\tif (previousFocus && isFocusable(previousFocus)) {\n\t\t\t\treturn previousFocus.focus();\n\t\t\t}\n\t\t},\n\t\t[previousFocus],\n\t);\n\n\tconst handleKeyDown = useCallback(\n\t\t(event) => {\n\t\t\tswitch (event.keyCode) {\n\t\t\t\tcase KeyboardCode.get('ENTER'):\n\t\t\t\t\tif (event?.target?.nodeName !== 'TEXTAREA') {\n\t\t\t\t\t\treturn onSubmit(event);\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\tcase KeyboardCode.get('ESC'):\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tonClose();\n\t\t\t\t\treturn;\n\t\t\t\tcase KeyboardCode.get('TAB'):\n\t\t\t\t\tif (!ref.current) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst elements = Array.from(ref.current.querySelectorAll(focusableElementsString)) as HTMLElement[];\n\t\t\t\t\tconst [first] = elements;\n\t\t\t\t\tconst last = elements.pop();\n\n\t\t\t\t\tif (!ref.current.contains(document.activeElement)) {\n\t\t\t\t\t\treturn first.focus();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (event.shiftKey) {\n\t\t\t\t\t\tif (!first || first === document.activeElement) {\n\t\t\t\t\t\t\tlast?.focus();\n\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!last || last === document.activeElement) {\n\t\t\t\t\t\tfirst.focus();\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[onClose, onSubmit],\n\t);\n\n\tuseEffect(() => {\n\t\tconst element = document.querySelector('#modal-root') as HTMLElement;\n\t\tconst container = element.querySelector('.rcx-modal__content') as HTMLElement;\n\t\tconst close = (e: Event) => {\n\t\t\tif (e.target !== element) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tonClose();\n\t\t\treturn false;\n\t\t};\n\n\t\tconst ignoreIfNotContains = (e: Event) => {\n\t\t\tif (e.target !== element) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!container.contains(e.target as HTMLElement)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn handleKeyDown(e);\n\t\t};\n\n\t\tdocument.addEventListener('keydown', ignoreIfNotContains);\n\t\telement.addEventListener('click', close);\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('keydown', ignoreIfNotContains);\n\t\t\telement.removeEventListener('click', close);\n\t\t};\n\t}, [handleKeyDown, onClose]);\n\n\treturn (\n\t\t<AnimatedVisibility visibility={AnimatedVisibility.UNHIDING}>\n\t\t\t<FocusScope contain restoreFocus autoFocus>\n\t\t\t\t<Modal open id={id} ref={ref}>\n\t\t\t\t\t<Modal.Header>\n\t\t\t\t\t\t{view.showIcon ? <Modal.Thumb url={getURL(`/api/apps/${view.appId}/icon`)} /> : null}\n\t\t\t\t\t\t<Modal.Title>{modalParser.text(view.title, UiKit.BlockContext.NONE, 0)}</Modal.Title>\n\t\t\t\t\t\t<Modal.Close tabIndex={-1} onClick={onClose} />\n\t\t\t\t\t</Modal.Header>\n\t\t\t\t\t<Modal.Content>\n\t\t\t\t\t\t<Box is='form' method='post' action='#' onSubmit={onSubmit}>\n\t\t\t\t\t\t\t<UiKitComponent render={UiKitModal} blocks={view.blocks} />\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t</Modal.Content>\n\t\t\t\t\t<Modal.Footer>\n\t\t\t\t\t\t<Modal.FooterControllers>\n\t\t\t\t\t\t\t{view.close && (\n\t\t\t\t\t\t\t\t<Button danger={view.close.style === 'danger'} onClick={onCancel}>\n\t\t\t\t\t\t\t\t\t{modalParser.text(view.close.text, UiKit.BlockContext.NONE, 0)}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{view.submit && (\n\t\t\t\t\t\t\t\t<Button {...getButtonStyle(view.submit)} onClick={onSubmit}>\n\t\t\t\t\t\t\t\t\t{modalParser.text(view.submit.text, UiKit.BlockContext.NONE, 1)}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Modal.FooterControllers>\n\t\t\t\t\t</Modal.Footer>\n\t\t\t\t</Modal>\n\t\t\t</FocusScope>\n\t\t</AnimatedVisibility>\n\t);\n};\n\nexport default ModalBlock;\n"],"mappings":"AAAA,IAAAA,QAAS;AAAAC,MAAO,CAAAC,IAAA,iCAAuC;EAAAC,QAAAC,CAAA;IAAAJ,QAAuB,GAACI,CAAA;EAAA;AAAA;AAA/E,IAAAC,KAAS,EAAAC,kBAAO,EAAAC,MAAkB,EAAEC,GAAA;AAAAP,MAAQ,CAAGC,IAAE,wBAAM;EAAAG,KAAwBA,CAAAD,CAAA;IAAAC,KAAA,GAAAD,CAAA;EAAA;EAAAE,mBAAAF,CAAA;IAAAE,kBAAA,GAAAF,CAAA;EAAA;EAAAG,OAAAH,CAAA;IAAAG,MAAA,GAAAH,CAAA;EAAA;EAAAI,IAAAJ,CAAA;IAAAI,GAAA,GAAAJ,CAAA;EAAA;AAAA;AAAA,IAAAK,WAAA;AAAAR,MAAA,CAAAC,IAAA;EAAAO,YAAAL,CAAA;IAAAK,WAAA,GAAAL,CAAA;EAAA;AAAA;AAAA,IAAAM,cAAA,EAAAC,UAAA,EAAAC,WAAA;AAAAX,MAAA,CAAAC,IAAA;EAAAQ,eAAAN,CAAA;IAAAM,cAAA,GAAAN,CAAA;EAAA;EAAAO,WAAAP,CAAA;IAAAO,UAAA,GAAAP,CAAA;EAAA;EAAAQ,YAAAR,CAAA;IAAAQ,WAAA,GAAAR,CAAA;EAAA;AAAA;AAAA,IAAAS,KAAA;AAAAZ,MAAA,CAAAC,IAAA;EAAA,GAAAY,CAAAV,CAAA;IAAAS,KAAA,GAAAT,CAAA;EAAA;AAAA;AAAA,IAAAW,KAAA,EAAAC,WAAA,EAAAC,SAAA,EAAAC,OAAA,EAAAC,MAAA;AAAAlB,MAAA,CAAAC,IAAA;EAAAC,QAAAC,CAAA;IAAAW,KAAA,GAAAX,CAAA;EAAA;EAAAY,YAAAZ,CAAA;IAAAY,WAAA,GAAAZ,CAAA;EAAA;EAAAa,UAAAb,CAAA;IAAAa,SAAA,GAAAb,CAAA;EAAA;EAAAc,QAAAd,CAAA;IAAAc,OAAA,GAAAd,CAAA;EAAA;EAAAe,OAAAf,CAAA;IAAAe,MAAA,GAAAf,CAAA;EAAA;AAAA;AAAA,IAAAgB,UAAA;AAAAnB,MAAA,CAAAC,IAAA;EAAAkB,WAAAhB,CAAA;IAAAgB,UAAA,GAAAhB,CAAA;EAAA;AAAA;AAAA,IAAAiB,MAAA;AAAApB,MAAA,CAAAC,IAAA;EAAAmB,OAAAjB,CAAA;IAAAiB,MAAA,GAAAjB,CAAA;EAAA;AAAA;AAAA,IAAAkB,cAAA;AAAArB,MAAA,CAAAC,IAAA;EAAAoB,eAAAlB,CAAA;IAAAkB,cAAA,GAAAlB,CAAA;EAAA;AAAA;AAW/E,MAAMmB,uBAAuB,kXAWV;AAEnB,MAAMC,8BAA8B,0cAWT;AAW3B,MAAMC,WAAW,GAAIC,OAAuB,IAC3CA,OAAO,KAAK,IAAI,IAAI,OAAO,IAAIA,OAAO,IAAI,OAAOA,OAAO,CAACC,KAAK,KAAK,UAAU;AAE9E,MAAMC,YAAY,GAAG,IAAIC,GAAG,CAAiB,CAC5C,CAAC,OAAO,EAAE,EAAE,CAAC,EACb,CAAC,KAAK,EAAE,EAAE,CAAC,EACX,CAAC,KAAK,EAAE,CAAC,CAAC,CACV,CAAC;AAEF,MAAMC,UAAU,GAAGC,IAAA,IAAkF;EAAA,IAAjF;IAAEC,IAAI;IAAEC,MAAM;IAAEC,QAAQ;IAAEC,OAAO;IAAEC;EAAQ,CAAoB,GAAAL,IAAA;EAClF,MAAMM,EAAE,eAAAC,MAAA,CAAe7B,WAAW,EAAE,CAAE;EACtC,MAAM8B,GAAG,GAAGpB,MAAM,CAAc,IAAI,CAAC;EAErCF,SAAS,CAAC,MAAK;IACd,IAAI,CAACsB,GAAG,CAACC,OAAO,EAAE;MACjB;IACD;IAEA,IAAIP,MAAM,IAAIQ,MAAM,CAACC,IAAI,CAACT,MAAM,CAAC,CAACU,MAAM,EAAE;MACzC,MAAMjB,OAAO,GAAGa,GAAG,CAACC,OAAO,CAACI,aAAa,CAAcpB,8BAA8B,CAAC;MACtFE,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEC,KAAK,EAAE;IACjB,CAAC,MAAM;MACN,MAAMD,OAAO,GAAGa,GAAG,CAACC,OAAO,CAACI,aAAa,CAAcrB,uBAAuB,CAAC;MAC/EG,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEC,KAAK,EAAE;IACjB;EACD,CAAC,EAAE,CAACM,MAAM,CAAC,CAAC;EAEZ,MAAMY,aAAa,GAAG3B,OAAO,CAAC,MAAM4B,QAAQ,CAACC,aAAa,EAAE,EAAE,CAAC;EAE/D9B,SAAS,CACR,MAAM,MAAK;IACV,IAAI4B,aAAa,IAAIpB,WAAW,CAACoB,aAAa,CAAC,EAAE;MAChD,OAAOA,aAAa,CAAClB,KAAK,EAAE;IAC7B;EACD,CAAC,EACD,CAACkB,aAAa,CAAC,CACf;EAED,MAAMG,aAAa,GAAGhC,WAAW,CAC/BiC,KAAK,IAAI;IAAA,IAAAC,aAAA;IACT,QAAQD,KAAK,CAACE,OAAO;MACpB,KAAKvB,YAAY,CAACwB,GAAG,CAAC,OAAO,CAAC;QAC7B,IAAI,CAAAH,KAAK,aAALA,KAAK,wBAAAC,aAAA,GAALD,KAAK,CAAEI,MAAM,cAAAH,aAAA,uBAAbA,aAAA,CAAeI,QAAQ,MAAK,UAAU,EAAE;UAC3C,OAAOpB,QAAQ,CAACe,KAAK,CAAC;QACvB;QACA;MACD,KAAKrB,YAAY,CAACwB,GAAG,CAAC,KAAK,CAAC;QAC3BH,KAAK,CAACM,eAAe,EAAE;QACvBN,KAAK,CAACO,cAAc,EAAE;QACtBrB,OAAO,EAAE;QACT;MACD,KAAKP,YAAY,CAACwB,GAAG,CAAC,KAAK,CAAC;QAC3B,IAAI,CAACb,GAAG,CAACC,OAAO,EAAE;UACjB;QACD;QACA,MAAMiB,QAAQ,GAAGC,KAAK,CAACC,IAAI,CAACpB,GAAG,CAACC,OAAO,CAACoB,gBAAgB,CAACrC,uBAAuB,CAAC,CAAkB;QACnG,MAAM,CAACsC,KAAK,CAAC,GAAGJ,QAAQ;QACxB,MAAMK,IAAI,GAAGL,QAAQ,CAACM,GAAG,EAAE;QAE3B,IAAI,CAACxB,GAAG,CAACC,OAAO,CAACwB,QAAQ,CAAClB,QAAQ,CAACC,aAAa,CAAC,EAAE;UAClD,OAAOc,KAAK,CAAClC,KAAK,EAAE;QACrB;QAEA,IAAIsB,KAAK,CAACgB,QAAQ,EAAE;UACnB,IAAI,CAACJ,KAAK,IAAIA,KAAK,KAAKf,QAAQ,CAACC,aAAa,EAAE;YAC/Ce,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEnC,KAAK,EAAE;YACbsB,KAAK,CAACM,eAAe,EAAE;YACvBN,KAAK,CAACO,cAAc,EAAE;UACvB;UACA;QACD;QAEA,IAAI,CAACM,IAAI,IAAIA,IAAI,KAAKhB,QAAQ,CAACC,aAAa,EAAE;UAC7Cc,KAAK,CAAClC,KAAK,EAAE;UACbsB,KAAK,CAACM,eAAe,EAAE;UACvBN,KAAK,CAACO,cAAc,EAAE;QACvB;IACF;EACD,CAAC,EACD,CAACrB,OAAO,EAAED,QAAQ,CAAC,CACnB;EAEDjB,SAAS,CAAC,MAAK;IACd,MAAMS,OAAO,GAAGoB,QAAQ,CAACF,aAAa,CAAC,aAAa,CAAgB;IACpE,MAAMsB,SAAS,GAAGxC,OAAO,CAACkB,aAAa,CAAC,qBAAqB,CAAgB;IAC7E,MAAMuB,KAAK,GAAIC,CAAQ,IAAI;MAC1B,IAAIA,CAAC,CAACf,MAAM,KAAK3B,OAAO,EAAE;QACzB;MACD;MACA0C,CAAC,CAACZ,cAAc,EAAE;MAClBY,CAAC,CAACb,eAAe,EAAE;MACnBpB,OAAO,EAAE;MACT,OAAO,KAAK;IACb,CAAC;IAED,MAAMkC,mBAAmB,GAAID,CAAQ,IAAI;MACxC,IAAIA,CAAC,CAACf,MAAM,KAAK3B,OAAO,EAAE;QACzB;MACD;MAEA,IAAI,CAACwC,SAAS,CAACF,QAAQ,CAACI,CAAC,CAACf,MAAqB,CAAC,EAAE;QACjD;MACD;MACA,OAAOL,aAAa,CAACoB,CAAC,CAAC;IACxB,CAAC;IAEDtB,QAAQ,CAACwB,gBAAgB,CAAC,SAAS,EAAED,mBAAmB,CAAC;IACzD3C,OAAO,CAAC4C,gBAAgB,CAAC,OAAO,EAAEH,KAAK,CAAC;IACxC,OAAO,MAAK;MACXrB,QAAQ,CAACyB,mBAAmB,CAAC,SAAS,EAAEF,mBAAmB,CAAC;MAC5D3C,OAAO,CAAC6C,mBAAmB,CAAC,OAAO,EAAEJ,KAAK,CAAC;IAC5C,CAAC;EACF,CAAC,EAAE,CAACnB,aAAa,EAAEb,OAAO,CAAC,CAAC;EAE5B,oBACCpB,KAAA,CAAAyD,aAAA,CAAClE,kBAAkB;IAACmE,UAAU,EAAEnE,kBAAkB,CAACoE;EAAS,gBAC3D3D,KAAA,CAAAyD,aAAA,CAACpD,UAAU;IAACuD,OAAO;IAACC,YAAY;IAACC,SAAS;EAAA,gBACzC9D,KAAA,CAAAyD,aAAA,CAACnE,KAAK;IAACyE,IAAI;IAACzC,EAAE,EAAEA,EAAG;IAACE,GAAG,EAAEA;EAAI,gBAC5BxB,KAAA,CAAAyD,aAAA,CAACnE,KAAK,CAAC0E,MAAM,QACX/C,IAAI,CAACgD,QAAQ,gBAAGjE,KAAA,CAAAyD,aAAA,CAACnE,KAAK,CAAC4E,KAAK;IAACC,GAAG,EAAE7D,MAAM,cAAAiB,MAAA,CAAcN,IAAI,CAACmD,KAAK,UAAO;EAAE,EAAG,GAAG,IAAI,eACpFpE,KAAA,CAAAyD,aAAA,CAACnE,KAAK,CAAC+E,KAAK,QAAExE,WAAW,CAACyE,IAAI,CAACrD,IAAI,CAACsD,KAAK,EAAEzE,KAAK,CAAC0E,YAAY,CAACC,IAAI,EAAE,CAAC,CAAe,CACpF,eAAAzE,KAAA,CAAAyD,aAAA,CAACnE,KAAK,CAACoF,KAAK;IAACC,QAAQ,EAAE,CAAC,CAAE;IAACC,OAAO,EAAExD;EAAQ,EAC/B,CACd,eAAApB,KAAA,CAAAyD,aAAA,CAACnE,KAAK,CAACuF,OAAO,qBACb7E,KAAA,CAAAyD,aAAA,CAAChE,GAAG;IAACqF,EAAE,EAAC,MAAM;IAACC,MAAM,EAAC,MAAM;IAACC,MAAM,EAAC,GAAG;IAAC7D,QAAQ,EAAEA;EAAS,gBAC1DnB,KAAA,CAAAyD,aAAA,CAAC9D,cAAc;IAACsF,MAAM,EAAErF,UAAW;IAACsF,MAAM,EAAEjE,IAAI,CAACiE;EAAO,EACpD,CACS,CACf,eAAAlF,KAAA,CAAAyD,aAAA,CAACnE,KAAK,CAAC6F,MAAM,qBACZnF,KAAA,CAAAyD,aAAA,CAACnE,KAAK,CAAC8F,iBAAiB,QACtBnE,IAAI,CAACmC,KAAK,iBACVpD,KAAA,CAAAyD,aAAA,CAACjE,MAAM;IAAC6F,MAAM,EAAEpE,IAAI,CAACmC,KAAK,CAACkC,KAAK,KAAK,QAAS;IAACV,OAAO,EAAEvD;EAAS,GAC/DxB,WAAW,CAACyE,IAAI,CAACrD,IAAI,CAACmC,KAAK,CAACkB,IAAI,EAAExE,KAAK,CAAC0E,YAAY,CAACC,IAAI,EAAE,CAAC,CACtD,CACR,EACAxD,IAAI,CAACsE,MAAM,iBACXvF,KAAA,CAAAyD,aAAA,CAACjE,MAAM,EAAAP,QAAA,KAAKsB,cAAc,CAACU,IAAI,CAACsE,MAAM,CAAC;IAAEX,OAAO,EAAEzD;EAAS,IACzDtB,WAAW,CAACyE,IAAI,CAACrD,IAAI,CAACsE,MAAM,CAACjB,IAAI,EAAExE,KAAK,CAAC0E,YAAY,CAACC,IAAI,EAAE,CAAC,CACvD,CAEe,CACZ,CACR,CACI,CACO,CAAC;AAEvB,CAAC;AAhMDvF,MAAA,CAAOsG,aAAS,CAkMDzE,UAlMC","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"2d7fc1220b34f42134742bb554ef39494b00eba2"}
