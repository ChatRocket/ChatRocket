{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/mailer/server/api.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.arm64"},"sourceFileName":"app/mailer/server/api.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/mailer/server/api.ts","inputSourceMap":{"version":3,"file":"app/mailer/server/api.ts","sourceRoot":"","sources":["app/mailer/server/api.ts"],"names":[],"mappings":"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","sourcesContent":["import { AppEvents, Apps } from '@rocket.chat/apps';\nimport type { ISetting } from '@rocket.chat/core-typings';\nimport { Settings } from '@rocket.chat/models';\nimport { escapeHTML } from '@rocket.chat/string-helpers';\nimport juice from 'juice';\nimport { Email } from 'meteor/email';\nimport { Meteor } from 'meteor/meteor';\nimport stripHtml from 'string-strip-html';\nimport _ from 'underscore';\n\nimport { validateEmail } from '../../../lib/emailValidator';\nimport { strLeft, strRightBack } from '../../../lib/utils/stringUtils';\nimport { i18n } from '../../../server/lib/i18n';\nimport { notifyOnSettingChanged } from '../../lib/server/lib/notifyListener';\nimport { settings } from '../../settings/server';\nimport { replaceVariables } from './replaceVariables';\n\nlet contentHeader: string | undefined;\nlet contentFooter: string | undefined;\nlet body: string | undefined;\n\n// define server language for email translations\n// @TODO: change TAPi18n.__ function to use the server language by default\nlet lng = 'en';\nsettings.watch<string>('Language', (value) => {\n\tlng = value || 'en';\n});\n\nexport const replacekey = (str: string, key: string, value = ''): string =>\n\tstr.replace(new RegExp(`(\\\\[${key}\\\\]|__${key}__)`, 'igm'), value);\n\nexport const translate = (str: string): string => replaceVariables(str, (_match, key) => i18n.t(key, { lng }));\n\nexport const replace = (str: string, data: { [key: string]: unknown } = {}): string => {\n\tif (!str) {\n\t\treturn '';\n\t}\n\n\tconst options = {\n\t\tSite_Name: settings.get<string>('Site_Name'),\n\t\tSite_URL: settings.get<string>('Site_Url'),\n\t\tSite_URL_Slash: settings.get<string>('Site_Url')?.replace(/\\/?$/, '/'),\n\t\t...(data.name\n\t\t\t? {\n\t\t\t\t\tfname: strLeft(String(data.name), ' '),\n\t\t\t\t\tlname: strRightBack(String(data.name), ' '),\n\t\t\t  }\n\t\t\t: {}),\n\t\t...data,\n\t};\n\n\treturn Object.entries(options).reduce((ret, [key, value]) => replacekey(ret, key, value), translate(str));\n};\n\nconst nonEscapeKeys = ['room_path'];\n\nexport const replaceEscaped = (str: string, data: { [key: string]: unknown } = {}): string => {\n\tconst siteName = settings.get<string>('Site_Name');\n\tconst siteUrl = settings.get<string>('Site_Url');\n\n\treturn replace(str, {\n\t\tSite_Name: siteName ? escapeHTML(siteName) : undefined,\n\t\tSite_Url: siteUrl ? escapeHTML(siteUrl) : undefined,\n\t\t...Object.entries(data).reduce<{ [key: string]: string }>((ret, [key, value]) => {\n\t\t\tif (value !== undefined && value !== null) {\n\t\t\t\tret[key] = nonEscapeKeys.includes(key) ? String(value) : escapeHTML(String(value));\n\t\t\t}\n\t\t\treturn ret;\n\t\t}, {}),\n\t});\n};\n\nexport const wrap = (html: string, data: { [key: string]: unknown } = {}): string => {\n\tif (settings.get('email_plain_text_only')) {\n\t\treturn replace(html, data);\n\t}\n\n\tif (!body) {\n\t\tthrow new Error('error-email-body-not-initialized');\n\t}\n\n\treturn replaceEscaped(body.replace('{{body}}', html), data);\n};\n\nexport const inlinecss = (html: string): string => {\n\tconst css = settings.get<string>('email_style');\n\treturn css ? juice.inlineContent(html, css) : html;\n};\n\nexport const getTemplate = (template: ISetting['_id'], fn: (html: string) => void, escape = true): void => {\n\tlet html = '';\n\n\tsettings.watch<string>(template, (value) => {\n\t\thtml = value || '';\n\t\tfn(escape ? inlinecss(html) : html);\n\t});\n\n\tsettings.watch<string>('email_style', () => {\n\t\tfn(escape ? inlinecss(html) : html);\n\t});\n};\n\nexport const getTemplateWrapped = (template: ISetting['_id'], fn: (html: string) => void): void => {\n\tlet html = '';\n\tconst wrapInlineCSS = _.debounce(() => fn(wrap(inlinecss(html))), 100);\n\n\tsettings.watch<string>('Email_Header', () => html && wrapInlineCSS());\n\tsettings.watch<string>('Email_Footer', () => html && wrapInlineCSS());\n\tsettings.watch<string>('email_style', () => html && wrapInlineCSS());\n\tsettings.watch<string>(template, (value) => {\n\t\thtml = value || '';\n\t\treturn html && wrapInlineCSS();\n\t});\n};\n\nsettings.watchMultiple(['Email_Header', 'Email_Footer'], () => {\n\tgetTemplate(\n\t\t'Email_Header',\n\t\t(value) => {\n\t\t\tcontentHeader = replace(value || '');\n\t\t\tbody = inlinecss(`${contentHeader} {{body}} ${contentFooter}`);\n\t\t},\n\t\tfalse,\n\t);\n\n\tgetTemplate(\n\t\t'Email_Footer',\n\t\t(value) => {\n\t\t\tcontentFooter = replace(value || '');\n\t\t\tbody = inlinecss(`${contentHeader} {{body}} ${contentFooter}`);\n\t\t},\n\t\tfalse,\n\t);\n\n\tbody = inlinecss(`${contentHeader} {{body}} ${contentFooter}`);\n});\n\nexport const checkAddressFormat = (adresses: string | string[]): boolean =>\n\t([] as string[]).concat(adresses).every((address) => validateEmail(address));\n\nexport const sendNoWrap = async ({\n\tto,\n\tfrom,\n\treplyTo,\n\tsubject,\n\thtml,\n\ttext,\n\theaders,\n}: {\n\tto: string | string[];\n\tfrom: string;\n\treplyTo?: string;\n\tsubject: string;\n\thtml?: string;\n\ttext?: string;\n\theaders?: string;\n}) => {\n\tif (!checkAddressFormat(to)) {\n\t\tthrow new Meteor.Error('invalid email');\n\t}\n\n\tif (!text) {\n\t\ttext = html ? stripHtml(html).result : undefined;\n\t}\n\n\tif (settings.get('email_plain_text_only')) {\n\t\thtml = undefined;\n\t}\n\n\tconst { value } = await Settings.incrementValueById('Triggered_Emails_Count', 1, { returnDocument: 'after' });\n\tif (value) {\n\t\tvoid notifyOnSettingChanged(value);\n\t}\n\n\tconst email = { to, from, replyTo, subject, html, text, headers };\n\n\tconst eventResult = await Apps.self?.triggerEvent(AppEvents.IPreEmailSent, { email });\n\n\tsetImmediate(() => Email.sendAsync(eventResult || email).catch((e) => console.error(e)));\n};\n\nexport const send = async ({\n\tto,\n\tfrom,\n\treplyTo,\n\tsubject,\n\thtml,\n\ttext,\n\tdata,\n\theaders,\n}: {\n\tto: string | string[];\n\tfrom: string;\n\treplyTo?: string;\n\tsubject: string;\n\thtml?: string;\n\ttext?: string;\n\theaders?: string;\n\tdata?: { [key: string]: unknown };\n}): Promise<void> =>\n\tsendNoWrap({\n\t\tto,\n\t\tfrom,\n\t\treplyTo,\n\t\tsubject: replace(subject, data),\n\t\ttext: (text && replace(text, data)) || (html && stripHtml(replace(html, data)).result) || undefined,\n\t\thtml: html ? wrap(html, data) : undefined,\n\t\theaders,\n\t});\n\n// Needed because of https://github.com/microsoft/TypeScript/issues/36931\ntype Assert = (input: string, func: string) => asserts input;\nexport const checkAddressFormatAndThrow: Assert = (from: string, func: string): asserts from => {\n\tif (checkAddressFormat(from)) {\n\t\treturn;\n\t}\n\n\tthrow new Meteor.Error('error-invalid-from-address', 'Invalid from address', {\n\t\tfunction: func,\n\t});\n};\n\nexport const getHeader = (): string | undefined => contentHeader;\n\nexport const getFooter = (): string | undefined => contentFooter;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true,"topLevelAwait":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/mailer/server/api.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/mailer/server/api.ts","inputSourceMap":{"version":3,"file":"app/mailer/server/api.ts","sourceRoot":"","sources":["app/mailer/server/api.ts"],"names":[],"mappings":"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","sourcesContent":["import { AppEvents, Apps } from '@rocket.chat/apps';\nimport type { ISetting } from '@rocket.chat/core-typings';\nimport { Settings } from '@rocket.chat/models';\nimport { escapeHTML } from '@rocket.chat/string-helpers';\nimport juice from 'juice';\nimport { Email } from 'meteor/email';\nimport { Meteor } from 'meteor/meteor';\nimport stripHtml from 'string-strip-html';\nimport _ from 'underscore';\n\nimport { validateEmail } from '../../../lib/emailValidator';\nimport { strLeft, strRightBack } from '../../../lib/utils/stringUtils';\nimport { i18n } from '../../../server/lib/i18n';\nimport { notifyOnSettingChanged } from '../../lib/server/lib/notifyListener';\nimport { settings } from '../../settings/server';\nimport { replaceVariables } from './replaceVariables';\n\nlet contentHeader: string | undefined;\nlet contentFooter: string | undefined;\nlet body: string | undefined;\n\n// define server language for email translations\n// @TODO: change TAPi18n.__ function to use the server language by default\nlet lng = 'en';\nsettings.watch<string>('Language', (value) => {\n\tlng = value || 'en';\n});\n\nexport const replacekey = (str: string, key: string, value = ''): string =>\n\tstr.replace(new RegExp(`(\\\\[${key}\\\\]|__${key}__)`, 'igm'), value);\n\nexport const translate = (str: string): string => replaceVariables(str, (_match, key) => i18n.t(key, { lng }));\n\nexport const replace = (str: string, data: { [key: string]: unknown } = {}): string => {\n\tif (!str) {\n\t\treturn '';\n\t}\n\n\tconst options = {\n\t\tSite_Name: settings.get<string>('Site_Name'),\n\t\tSite_URL: settings.get<string>('Site_Url'),\n\t\tSite_URL_Slash: settings.get<string>('Site_Url')?.replace(/\\/?$/, '/'),\n\t\t...(data.name\n\t\t\t? {\n\t\t\t\t\tfname: strLeft(String(data.name), ' '),\n\t\t\t\t\tlname: strRightBack(String(data.name), ' '),\n\t\t\t  }\n\t\t\t: {}),\n\t\t...data,\n\t};\n\n\treturn Object.entries(options).reduce((ret, [key, value]) => replacekey(ret, key, value), translate(str));\n};\n\nconst nonEscapeKeys = ['room_path'];\n\nexport const replaceEscaped = (str: string, data: { [key: string]: unknown } = {}): string => {\n\tconst siteName = settings.get<string>('Site_Name');\n\tconst siteUrl = settings.get<string>('Site_Url');\n\n\treturn replace(str, {\n\t\tSite_Name: siteName ? escapeHTML(siteName) : undefined,\n\t\tSite_Url: siteUrl ? escapeHTML(siteUrl) : undefined,\n\t\t...Object.entries(data).reduce<{ [key: string]: string }>((ret, [key, value]) => {\n\t\t\tif (value !== undefined && value !== null) {\n\t\t\t\tret[key] = nonEscapeKeys.includes(key) ? String(value) : escapeHTML(String(value));\n\t\t\t}\n\t\t\treturn ret;\n\t\t}, {}),\n\t});\n};\n\nexport const wrap = (html: string, data: { [key: string]: unknown } = {}): string => {\n\tif (settings.get('email_plain_text_only')) {\n\t\treturn replace(html, data);\n\t}\n\n\tif (!body) {\n\t\tthrow new Error('error-email-body-not-initialized');\n\t}\n\n\treturn replaceEscaped(body.replace('{{body}}', html), data);\n};\n\nexport const inlinecss = (html: string): string => {\n\tconst css = settings.get<string>('email_style');\n\treturn css ? juice.inlineContent(html, css) : html;\n};\n\nexport const getTemplate = (template: ISetting['_id'], fn: (html: string) => void, escape = true): void => {\n\tlet html = '';\n\n\tsettings.watch<string>(template, (value) => {\n\t\thtml = value || '';\n\t\tfn(escape ? inlinecss(html) : html);\n\t});\n\n\tsettings.watch<string>('email_style', () => {\n\t\tfn(escape ? inlinecss(html) : html);\n\t});\n};\n\nexport const getTemplateWrapped = (template: ISetting['_id'], fn: (html: string) => void): void => {\n\tlet html = '';\n\tconst wrapInlineCSS = _.debounce(() => fn(wrap(inlinecss(html))), 100);\n\n\tsettings.watch<string>('Email_Header', () => html && wrapInlineCSS());\n\tsettings.watch<string>('Email_Footer', () => html && wrapInlineCSS());\n\tsettings.watch<string>('email_style', () => html && wrapInlineCSS());\n\tsettings.watch<string>(template, (value) => {\n\t\thtml = value || '';\n\t\treturn html && wrapInlineCSS();\n\t});\n};\n\nsettings.watchMultiple(['Email_Header', 'Email_Footer'], () => {\n\tgetTemplate(\n\t\t'Email_Header',\n\t\t(value) => {\n\t\t\tcontentHeader = replace(value || '');\n\t\t\tbody = inlinecss(`${contentHeader} {{body}} ${contentFooter}`);\n\t\t},\n\t\tfalse,\n\t);\n\n\tgetTemplate(\n\t\t'Email_Footer',\n\t\t(value) => {\n\t\t\tcontentFooter = replace(value || '');\n\t\t\tbody = inlinecss(`${contentHeader} {{body}} ${contentFooter}`);\n\t\t},\n\t\tfalse,\n\t);\n\n\tbody = inlinecss(`${contentHeader} {{body}} ${contentFooter}`);\n});\n\nexport const checkAddressFormat = (adresses: string | string[]): boolean =>\n\t([] as string[]).concat(adresses).every((address) => validateEmail(address));\n\nexport const sendNoWrap = async ({\n\tto,\n\tfrom,\n\treplyTo,\n\tsubject,\n\thtml,\n\ttext,\n\theaders,\n}: {\n\tto: string | string[];\n\tfrom: string;\n\treplyTo?: string;\n\tsubject: string;\n\thtml?: string;\n\ttext?: string;\n\theaders?: string;\n}) => {\n\tif (!checkAddressFormat(to)) {\n\t\tthrow new Meteor.Error('invalid email');\n\t}\n\n\tif (!text) {\n\t\ttext = html ? stripHtml(html).result : undefined;\n\t}\n\n\tif (settings.get('email_plain_text_only')) {\n\t\thtml = undefined;\n\t}\n\n\tconst { value } = await Settings.incrementValueById('Triggered_Emails_Count', 1, { returnDocument: 'after' });\n\tif (value) {\n\t\tvoid notifyOnSettingChanged(value);\n\t}\n\n\tconst email = { to, from, replyTo, subject, html, text, headers };\n\n\tconst eventResult = await Apps.self?.triggerEvent(AppEvents.IPreEmailSent, { email });\n\n\tsetImmediate(() => Email.sendAsync(eventResult || email).catch((e) => console.error(e)));\n};\n\nexport const send = async ({\n\tto,\n\tfrom,\n\treplyTo,\n\tsubject,\n\thtml,\n\ttext,\n\tdata,\n\theaders,\n}: {\n\tto: string | string[];\n\tfrom: string;\n\treplyTo?: string;\n\tsubject: string;\n\thtml?: string;\n\ttext?: string;\n\theaders?: string;\n\tdata?: { [key: string]: unknown };\n}): Promise<void> =>\n\tsendNoWrap({\n\t\tto,\n\t\tfrom,\n\t\treplyTo,\n\t\tsubject: replace(subject, data),\n\t\ttext: (text && replace(text, data)) || (html && stripHtml(replace(html, data)).result) || undefined,\n\t\thtml: html ? wrap(html, data) : undefined,\n\t\theaders,\n\t});\n\n// Needed because of https://github.com/microsoft/TypeScript/issues/36931\ntype Assert = (input: string, func: string) => asserts input;\nexport const checkAddressFormatAndThrow: Assert = (from: string, func: string): asserts from => {\n\tif (checkAddressFormat(from)) {\n\t\treturn;\n\t}\n\n\tthrow new Meteor.Error('error-invalid-from-address', 'Invalid from address', {\n\t\tfunction: func,\n\t});\n};\n\nexport const getHeader = (): string | undefined => contentHeader;\n\nexport const getFooter = (): string | undefined => contentFooter;\n"]}}},"code":"!module.wrapAsync(async function (module, __reifyWaitForDeps__, __reify_async_result__) {\n  \"use strict\";\n  try {\n    let _objectSpread;\n    module.link(\"@babel/runtime/helpers/objectSpread2\", {\n      default(v) {\n        _objectSpread = v;\n      }\n    }, 0);\n    module.export({\n      replacekey: () => replacekey,\n      translate: () => translate,\n      replace: () => replace,\n      replaceEscaped: () => replaceEscaped,\n      wrap: () => wrap,\n      inlinecss: () => inlinecss,\n      getTemplate: () => getTemplate,\n      getTemplateWrapped: () => getTemplateWrapped,\n      checkAddressFormat: () => checkAddressFormat,\n      sendNoWrap: () => sendNoWrap,\n      send: () => send,\n      checkAddressFormatAndThrow: () => checkAddressFormatAndThrow,\n      getHeader: () => getHeader,\n      getFooter: () => getFooter\n    });\n    let AppEvents, Apps;\n    module.link(\"@rocket.chat/apps\", {\n      AppEvents(v) {\n        AppEvents = v;\n      },\n      Apps(v) {\n        Apps = v;\n      }\n    }, 0);\n    let Settings;\n    module.link(\"@rocket.chat/models\", {\n      Settings(v) {\n        Settings = v;\n      }\n    }, 1);\n    let escapeHTML;\n    module.link(\"@rocket.chat/string-helpers\", {\n      escapeHTML(v) {\n        escapeHTML = v;\n      }\n    }, 2);\n    let juice;\n    module.link(\"juice\", {\n      default(v) {\n        juice = v;\n      }\n    }, 3);\n    let Email;\n    module.link(\"meteor/email\", {\n      Email(v) {\n        Email = v;\n      }\n    }, 4);\n    let Meteor;\n    module.link(\"meteor/meteor\", {\n      Meteor(v) {\n        Meteor = v;\n      }\n    }, 5);\n    let stripHtml;\n    module.link(\"string-strip-html\", {\n      default(v) {\n        stripHtml = v;\n      }\n    }, 6);\n    let _;\n    module.link(\"underscore\", {\n      default(v) {\n        _ = v;\n      }\n    }, 7);\n    let validateEmail;\n    module.link(\"../../../lib/emailValidator\", {\n      validateEmail(v) {\n        validateEmail = v;\n      }\n    }, 8);\n    let strLeft, strRightBack;\n    module.link(\"../../../lib/utils/stringUtils\", {\n      strLeft(v) {\n        strLeft = v;\n      },\n      strRightBack(v) {\n        strRightBack = v;\n      }\n    }, 9);\n    let i18n;\n    module.link(\"../../../server/lib/i18n\", {\n      i18n(v) {\n        i18n = v;\n      }\n    }, 10);\n    let notifyOnSettingChanged;\n    module.link(\"../../lib/server/lib/notifyListener\", {\n      notifyOnSettingChanged(v) {\n        notifyOnSettingChanged = v;\n      }\n    }, 11);\n    let settings;\n    module.link(\"../../settings/server\", {\n      settings(v) {\n        settings = v;\n      }\n    }, 12);\n    let replaceVariables;\n    module.link(\"./replaceVariables\", {\n      replaceVariables(v) {\n        replaceVariables = v;\n      }\n    }, 13);\n    if (__reifyWaitForDeps__()) (await __reifyWaitForDeps__())();\n    let contentHeader;\n    let contentFooter;\n    let body;\n    // define server language for email translations\n    // @TODO: change TAPi18n.__ function to use the server language by default\n    let lng = 'en';\n    settings.watch('Language', value => {\n      lng = value || 'en';\n    });\n    const replacekey = function (str, key) {\n      let value = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';\n      return str.replace(new RegExp(\"(\\\\[\".concat(key, \"\\\\]|__\").concat(key, \"__)\"), 'igm'), value);\n    };\n    const translate = str => replaceVariables(str, (_match, key) => i18n.t(key, {\n      lng\n    }));\n    const replace = function (str) {\n      var _settings$get;\n      let data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      if (!str) {\n        return '';\n      }\n      const options = _objectSpread(_objectSpread({\n        Site_Name: settings.get('Site_Name'),\n        Site_URL: settings.get('Site_Url'),\n        Site_URL_Slash: (_settings$get = settings.get('Site_Url')) === null || _settings$get === void 0 ? void 0 : _settings$get.replace(/\\/?$/, '/')\n      }, data.name ? {\n        fname: strLeft(String(data.name), ' '),\n        lname: strRightBack(String(data.name), ' ')\n      } : {}), data);\n      return Object.entries(options).reduce((ret, _ref) => {\n        let [key, value] = _ref;\n        return replacekey(ret, key, value);\n      }, translate(str));\n    };\n    const nonEscapeKeys = ['room_path'];\n    const replaceEscaped = function (str) {\n      let data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      const siteName = settings.get('Site_Name');\n      const siteUrl = settings.get('Site_Url');\n      return replace(str, _objectSpread({\n        Site_Name: siteName ? escapeHTML(siteName) : undefined,\n        Site_Url: siteUrl ? escapeHTML(siteUrl) : undefined\n      }, Object.entries(data).reduce((ret, _ref2) => {\n        let [key, value] = _ref2;\n        if (value !== undefined && value !== null) {\n          ret[key] = nonEscapeKeys.includes(key) ? String(value) : escapeHTML(String(value));\n        }\n        return ret;\n      }, {})));\n    };\n    const wrap = function (html) {\n      let data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      if (settings.get('email_plain_text_only')) {\n        return replace(html, data);\n      }\n      if (!body) {\n        throw new Error('error-email-body-not-initialized');\n      }\n      return replaceEscaped(body.replace('{{body}}', html), data);\n    };\n    const inlinecss = html => {\n      const css = settings.get('email_style');\n      return css ? juice.inlineContent(html, css) : html;\n    };\n    const getTemplate = function (template, fn) {\n      let escape = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      let html = '';\n      settings.watch(template, value => {\n        html = value || '';\n        fn(escape ? inlinecss(html) : html);\n      });\n      settings.watch('email_style', () => {\n        fn(escape ? inlinecss(html) : html);\n      });\n    };\n    const getTemplateWrapped = (template, fn) => {\n      let html = '';\n      const wrapInlineCSS = _.debounce(() => fn(wrap(inlinecss(html))), 100);\n      settings.watch('Email_Header', () => html && wrapInlineCSS());\n      settings.watch('Email_Footer', () => html && wrapInlineCSS());\n      settings.watch('email_style', () => html && wrapInlineCSS());\n      settings.watch(template, value => {\n        html = value || '';\n        return html && wrapInlineCSS();\n      });\n    };\n    settings.watchMultiple(['Email_Header', 'Email_Footer'], () => {\n      getTemplate('Email_Header', value => {\n        contentHeader = replace(value || '');\n        body = inlinecss(\"\".concat(contentHeader, \" {{body}} \").concat(contentFooter));\n      }, false);\n      getTemplate('Email_Footer', value => {\n        contentFooter = replace(value || '');\n        body = inlinecss(\"\".concat(contentHeader, \" {{body}} \").concat(contentFooter));\n      }, false);\n      body = inlinecss(\"\".concat(contentHeader, \" {{body}} \").concat(contentFooter));\n    });\n    const checkAddressFormat = adresses => [].concat(adresses).every(address => validateEmail(address));\n    const sendNoWrap = async _ref3 => {\n      var _Apps$self;\n      let {\n        to,\n        from,\n        replyTo,\n        subject,\n        html,\n        text,\n        headers\n      } = _ref3;\n      if (!checkAddressFormat(to)) {\n        throw new Meteor.Error('invalid email');\n      }\n      if (!text) {\n        text = html ? stripHtml(html).result : undefined;\n      }\n      if (settings.get('email_plain_text_only')) {\n        html = undefined;\n      }\n      const {\n        value\n      } = await Settings.incrementValueById('Triggered_Emails_Count', 1, {\n        returnDocument: 'after'\n      });\n      if (value) {\n        void notifyOnSettingChanged(value);\n      }\n      const email = {\n        to,\n        from,\n        replyTo,\n        subject,\n        html,\n        text,\n        headers\n      };\n      const eventResult = await ((_Apps$self = Apps.self) === null || _Apps$self === void 0 ? void 0 : _Apps$self.triggerEvent(AppEvents.IPreEmailSent, {\n        email\n      }));\n      setImmediate(() => Email.sendAsync(eventResult || email).catch(e => console.error(e)));\n    };\n    const send = async _ref4 => {\n      let {\n        to,\n        from,\n        replyTo,\n        subject,\n        html,\n        text,\n        data,\n        headers\n      } = _ref4;\n      return sendNoWrap({\n        to,\n        from,\n        replyTo,\n        subject: replace(subject, data),\n        text: text && replace(text, data) || html && stripHtml(replace(html, data)).result || undefined,\n        html: html ? wrap(html, data) : undefined,\n        headers\n      });\n    };\n    const checkAddressFormatAndThrow = (from, func) => {\n      if (checkAddressFormat(from)) {\n        return;\n      }\n      throw new Meteor.Error('error-invalid-from-address', 'Invalid from address', {\n        function: func\n      });\n    };\n    const getHeader = () => contentHeader;\n    const getFooter = () => contentFooter;\n    __reify_async_result__();\n  } catch (_reifyError) {\n    return __reify_async_result__(_reifyError);\n  }\n  __reify_async_result__()\n}, {\n  self: this,\n  async: false\n});","map":{"version":3,"names":["_objectSpread","module","link","default","v","export","replacekey","translate","replace","replaceEscaped","wrap","inlinecss","getTemplate","getTemplateWrapped","checkAddressFormat","sendNoWrap","send","checkAddressFormatAndThrow","getHeader","getFooter","AppEvents","Apps","Settings","escapeHTML","juice","Email","Meteor","stripHtml","_","validateEmail","strLeft","strRightBack","i18n","notifyOnSettingChanged","settings","replaceVariables","__reifyWaitForDeps__","contentHeader","contentFooter","body","lng","watch","value","str","key","arguments","length","undefined","RegExp","concat","_match","t","_settings$get","data","options","Site_Name","get","Site_URL","Site_URL_Slash","name","fname","String","lname","Object","entries","reduce","ret","_ref","nonEscapeKeys","siteName","siteUrl","Site_Url","_ref2","includes","html","Error","css","inlineContent","template","fn","escape","wrapInlineCSS","debounce","watchMultiple","adresses","every","address","_ref3","_Apps$self","to","from","replyTo","subject","text","headers","result","incrementValueById","returnDocument","email","eventResult","self","triggerEvent","IPreEmailSent","setImmediate","sendAsync","catch","e","console","error","_ref4","func","function","__reify_async_result__","_reifyError","async"],"sources":["app/mailer/server/api.ts"],"sourcesContent":["import { AppEvents, Apps } from '@rocket.chat/apps';\nimport type { ISetting } from '@rocket.chat/core-typings';\nimport { Settings } from '@rocket.chat/models';\nimport { escapeHTML } from '@rocket.chat/string-helpers';\nimport juice from 'juice';\nimport { Email } from 'meteor/email';\nimport { Meteor } from 'meteor/meteor';\nimport stripHtml from 'string-strip-html';\nimport _ from 'underscore';\n\nimport { validateEmail } from '../../../lib/emailValidator';\nimport { strLeft, strRightBack } from '../../../lib/utils/stringUtils';\nimport { i18n } from '../../../server/lib/i18n';\nimport { notifyOnSettingChanged } from '../../lib/server/lib/notifyListener';\nimport { settings } from '../../settings/server';\nimport { replaceVariables } from './replaceVariables';\n\nlet contentHeader: string | undefined;\nlet contentFooter: string | undefined;\nlet body: string | undefined;\n\n// define server language for email translations\n// @TODO: change TAPi18n.__ function to use the server language by default\nlet lng = 'en';\nsettings.watch<string>('Language', (value) => {\n\tlng = value || 'en';\n});\n\nexport const replacekey = (str: string, key: string, value = ''): string =>\n\tstr.replace(new RegExp(`(\\\\[${key}\\\\]|__${key}__)`, 'igm'), value);\n\nexport const translate = (str: string): string => replaceVariables(str, (_match, key) => i18n.t(key, { lng }));\n\nexport const replace = (str: string, data: { [key: string]: unknown } = {}): string => {\n\tif (!str) {\n\t\treturn '';\n\t}\n\n\tconst options = {\n\t\tSite_Name: settings.get<string>('Site_Name'),\n\t\tSite_URL: settings.get<string>('Site_Url'),\n\t\tSite_URL_Slash: settings.get<string>('Site_Url')?.replace(/\\/?$/, '/'),\n\t\t...(data.name\n\t\t\t? {\n\t\t\t\t\tfname: strLeft(String(data.name), ' '),\n\t\t\t\t\tlname: strRightBack(String(data.name), ' '),\n\t\t\t  }\n\t\t\t: {}),\n\t\t...data,\n\t};\n\n\treturn Object.entries(options).reduce((ret, [key, value]) => replacekey(ret, key, value), translate(str));\n};\n\nconst nonEscapeKeys = ['room_path'];\n\nexport const replaceEscaped = (str: string, data: { [key: string]: unknown } = {}): string => {\n\tconst siteName = settings.get<string>('Site_Name');\n\tconst siteUrl = settings.get<string>('Site_Url');\n\n\treturn replace(str, {\n\t\tSite_Name: siteName ? escapeHTML(siteName) : undefined,\n\t\tSite_Url: siteUrl ? escapeHTML(siteUrl) : undefined,\n\t\t...Object.entries(data).reduce<{ [key: string]: string }>((ret, [key, value]) => {\n\t\t\tif (value !== undefined && value !== null) {\n\t\t\t\tret[key] = nonEscapeKeys.includes(key) ? String(value) : escapeHTML(String(value));\n\t\t\t}\n\t\t\treturn ret;\n\t\t}, {}),\n\t});\n};\n\nexport const wrap = (html: string, data: { [key: string]: unknown } = {}): string => {\n\tif (settings.get('email_plain_text_only')) {\n\t\treturn replace(html, data);\n\t}\n\n\tif (!body) {\n\t\tthrow new Error('error-email-body-not-initialized');\n\t}\n\n\treturn replaceEscaped(body.replace('{{body}}', html), data);\n};\n\nexport const inlinecss = (html: string): string => {\n\tconst css = settings.get<string>('email_style');\n\treturn css ? juice.inlineContent(html, css) : html;\n};\n\nexport const getTemplate = (template: ISetting['_id'], fn: (html: string) => void, escape = true): void => {\n\tlet html = '';\n\n\tsettings.watch<string>(template, (value) => {\n\t\thtml = value || '';\n\t\tfn(escape ? inlinecss(html) : html);\n\t});\n\n\tsettings.watch<string>('email_style', () => {\n\t\tfn(escape ? inlinecss(html) : html);\n\t});\n};\n\nexport const getTemplateWrapped = (template: ISetting['_id'], fn: (html: string) => void): void => {\n\tlet html = '';\n\tconst wrapInlineCSS = _.debounce(() => fn(wrap(inlinecss(html))), 100);\n\n\tsettings.watch<string>('Email_Header', () => html && wrapInlineCSS());\n\tsettings.watch<string>('Email_Footer', () => html && wrapInlineCSS());\n\tsettings.watch<string>('email_style', () => html && wrapInlineCSS());\n\tsettings.watch<string>(template, (value) => {\n\t\thtml = value || '';\n\t\treturn html && wrapInlineCSS();\n\t});\n};\n\nsettings.watchMultiple(['Email_Header', 'Email_Footer'], () => {\n\tgetTemplate(\n\t\t'Email_Header',\n\t\t(value) => {\n\t\t\tcontentHeader = replace(value || '');\n\t\t\tbody = inlinecss(`${contentHeader} {{body}} ${contentFooter}`);\n\t\t},\n\t\tfalse,\n\t);\n\n\tgetTemplate(\n\t\t'Email_Footer',\n\t\t(value) => {\n\t\t\tcontentFooter = replace(value || '');\n\t\t\tbody = inlinecss(`${contentHeader} {{body}} ${contentFooter}`);\n\t\t},\n\t\tfalse,\n\t);\n\n\tbody = inlinecss(`${contentHeader} {{body}} ${contentFooter}`);\n});\n\nexport const checkAddressFormat = (adresses: string | string[]): boolean =>\n\t([] as string[]).concat(adresses).every((address) => validateEmail(address));\n\nexport const sendNoWrap = async ({\n\tto,\n\tfrom,\n\treplyTo,\n\tsubject,\n\thtml,\n\ttext,\n\theaders,\n}: {\n\tto: string | string[];\n\tfrom: string;\n\treplyTo?: string;\n\tsubject: string;\n\thtml?: string;\n\ttext?: string;\n\theaders?: string;\n}) => {\n\tif (!checkAddressFormat(to)) {\n\t\tthrow new Meteor.Error('invalid email');\n\t}\n\n\tif (!text) {\n\t\ttext = html ? stripHtml(html).result : undefined;\n\t}\n\n\tif (settings.get('email_plain_text_only')) {\n\t\thtml = undefined;\n\t}\n\n\tconst { value } = await Settings.incrementValueById('Triggered_Emails_Count', 1, { returnDocument: 'after' });\n\tif (value) {\n\t\tvoid notifyOnSettingChanged(value);\n\t}\n\n\tconst email = { to, from, replyTo, subject, html, text, headers };\n\n\tconst eventResult = await Apps.self?.triggerEvent(AppEvents.IPreEmailSent, { email });\n\n\tsetImmediate(() => Email.sendAsync(eventResult || email).catch((e) => console.error(e)));\n};\n\nexport const send = async ({\n\tto,\n\tfrom,\n\treplyTo,\n\tsubject,\n\thtml,\n\ttext,\n\tdata,\n\theaders,\n}: {\n\tto: string | string[];\n\tfrom: string;\n\treplyTo?: string;\n\tsubject: string;\n\thtml?: string;\n\ttext?: string;\n\theaders?: string;\n\tdata?: { [key: string]: unknown };\n}): Promise<void> =>\n\tsendNoWrap({\n\t\tto,\n\t\tfrom,\n\t\treplyTo,\n\t\tsubject: replace(subject, data),\n\t\ttext: (text && replace(text, data)) || (html && stripHtml(replace(html, data)).result) || undefined,\n\t\thtml: html ? wrap(html, data) : undefined,\n\t\theaders,\n\t});\n\n// Needed because of https://github.com/microsoft/TypeScript/issues/36931\ntype Assert = (input: string, func: string) => asserts input;\nexport const checkAddressFormatAndThrow: Assert = (from: string, func: string): asserts from => {\n\tif (checkAddressFormat(from)) {\n\t\treturn;\n\t}\n\n\tthrow new Meteor.Error('error-invalid-from-address', 'Invalid from address', {\n\t\tfunction: func,\n\t});\n};\n\nexport const getHeader = (): string | undefined => contentHeader;\n\nexport const getFooter = (): string | undefined => contentFooter;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"88324068798f6ca54d5187528c52ab6b1ef5ce5d"}
