{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/providers/ComposerPopupProvider.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/room/providers/ComposerPopupProvider.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/providers/ComposerPopupProvider.tsx","inputSourceMap":{"version":3,"file":"client/views/room/providers/ComposerPopupProvider.tsx","sourceRoot":"","sources":["client/views/room/providers/ComposerPopupProvider.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { isOmnichannelRoom } from '@rocket.chat/core-typings';\nimport { useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport { escapeRegExp } from '@rocket.chat/string-helpers';\nimport { useMethod, useSetting, useUserPreference } from '@rocket.chat/ui-contexts';\nimport React, { useMemo } from 'react';\nimport type { ReactNode } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { hasAtLeastOnePermission } from '../../../../app/authorization/client';\nimport { CannedResponse } from '../../../../app/canned-responses/client/collections/CannedResponse';\nimport { emoji } from '../../../../app/emoji/client';\nimport { Subscriptions } from '../../../../app/models/client';\nimport { usersFromRoomMessages } from '../../../../app/ui-message/client/popup/messagePopupConfig';\nimport { slashCommands } from '../../../../app/utils/client';\nimport ComposerBoxPopupCannedResponse from '../composer/ComposerBoxPopupCannedResponse';\nimport type { ComposerBoxPopupEmojiProps } from '../composer/ComposerBoxPopupEmoji';\nimport ComposerBoxPopupEmoji from '../composer/ComposerBoxPopupEmoji';\nimport ComposerBoxPopupRoom from '../composer/ComposerBoxPopupRoom';\nimport type { ComposerBoxPopupRoomProps } from '../composer/ComposerBoxPopupRoom';\nimport type { ComposerBoxPopupSlashCommandProps } from '../composer/ComposerBoxPopupSlashCommand';\nimport ComposerBoxPopupSlashCommand from '../composer/ComposerBoxPopupSlashCommand';\nimport ComposerBoxPopupUser from '../composer/ComposerBoxPopupUser';\nimport type { ComposerBoxPopupUserProps } from '../composer/ComposerBoxPopupUser';\nimport type { ComposerPopupContextValue } from '../contexts/ComposerPopupContext';\nimport { ComposerPopupContext, createMessageBoxPopupConfig } from '../contexts/ComposerPopupContext';\n\ntype ComposerPopupProviderProps = {\n\tchildren: ReactNode;\n\troom: IRoom;\n};\n\nconst ComposerPopupProvider = ({ children, room }: ComposerPopupProviderProps) => {\n\tconst { _id: rid, encrypted: isRoomEncrypted } = room;\n\tconst userSpotlight = useMethod('spotlight');\n\tconst suggestionsCount = useSetting<number>('Number_of_users_autocomplete_suggestions');\n\tconst cannedResponseEnabled = useSetting<boolean>('Canned_Responses_Enable');\n\tconst [recentEmojis] = useLocalStorage('emoji.recent', []);\n\tconst isOmnichannel = isOmnichannelRoom(room);\n\tconst useEmoji = useUserPreference('useEmojis');\n\tconst { t, i18n } = useTranslation();\n\tconst e2eEnabled = useSetting<boolean>('E2E_Enable');\n\tconst unencryptedMessagesAllowed = useSetting<boolean>('E2E_Allow_Unencrypted_Messages');\n\tconst encrypted = isRoomEncrypted && e2eEnabled && !unencryptedMessagesAllowed;\n\n\tconst call = useMethod('getSlashCommandPreviews');\n\tconst value: ComposerPopupContextValue = useMemo(() => {\n\t\treturn [\n\t\t\tcreateMessageBoxPopupConfig({\n\t\t\t\ttrigger: '@',\n\t\t\t\ttitle: t('People'),\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = filter && new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst items: ComposerBoxPopupUserProps[] = [];\n\n\t\t\t\t\tconst users = usersFromRoomMessages\n\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tts: { $exists: true },\n\t\t\t\t\t\t\t\t...(filter && {\n\t\t\t\t\t\t\t\t\t$or: [{ username: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\t\tsort: { ts: -1 },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t.map((u) => {\n\t\t\t\t\t\t\tu.suggestion = true;\n\t\t\t\t\t\t\treturn u;\n\t\t\t\t\t\t});\n\t\t\t\t\tif (!filterRegex || filterRegex.test('all')) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t_id: 'all',\n\t\t\t\t\t\t\tusername: 'all',\n\t\t\t\t\t\t\tsystem: true,\n\t\t\t\t\t\t\tname: t('Notify_all_in_this_room'),\n\t\t\t\t\t\t\tsort: 4,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!filterRegex || filterRegex.test('here')) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t_id: 'here',\n\t\t\t\t\t\t\tusername: 'here',\n\t\t\t\t\t\t\tsystem: true,\n\t\t\t\t\t\t\tname: t('Notify_active_in_this_room'),\n\t\t\t\t\t\t\tsort: 4,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\treturn [...users, ...items];\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = filter && new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst usernames = usersFromRoomMessages\n\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tts: { $exists: true },\n\t\t\t\t\t\t\t\t...(filter && {\n\t\t\t\t\t\t\t\t\t$or: [{ username: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\t\tsort: { ts: -1 },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t.map((u) => {\n\t\t\t\t\t\t\treturn u.username;\n\t\t\t\t\t\t});\n\t\t\t\t\tconst { users = [] } = await userSpotlight(filter, usernames, { users: true, mentions: true }, rid);\n\n\t\t\t\t\treturn users.map(({ _id, username, nickname, name, status, avatarETag, outside }) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t_id,\n\t\t\t\t\t\t\tusername,\n\t\t\t\t\t\t\tnickname,\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tstatus,\n\t\t\t\t\t\t\tavatarETag,\n\t\t\t\t\t\t\toutside,\n\t\t\t\t\t\t\tsort: 3,\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => item.username,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupUser {...item} />,\n\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupRoomProps>({\n\t\t\t\ttrigger: '#',\n\t\t\t\ttitle: t('Channels'),\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst records = Subscriptions.find(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$and: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$or: [{ fname: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$or: [{ federated: { $exists: false } }, { federated: false }],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tt: {\n\t\t\t\t\t\t\t\t$in: ['c', 'p'],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\tls: -1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t).fetch();\n\t\t\t\t\treturn records;\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async (filter: string) => {\n\t\t\t\t\tconst { rooms = [] } = await userSpotlight(filter, [], { rooms: true, mentions: true }, rid);\n\t\t\t\t\treturn rooms as unknown as ComposerBoxPopupRoomProps[];\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => `${item.name || item.fname}`,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupRoom {...item} />,\n\t\t\t}) as any,\n\t\t\tuseEmoji &&\n\t\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupEmojiProps>({\n\t\t\t\t\ttrigger: ':',\n\t\t\t\t\ttitle: t('Emoji'),\n\t\t\t\t\ttriggerLength: 2,\n\t\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\t\tconst exactFinalTone = new RegExp('^tone[1-5]:*$');\n\t\t\t\t\t\tconst colorBlind = new RegExp('tone[1-5]:*$');\n\t\t\t\t\t\tconst seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');\n\n\t\t\t\t\t\tconst emojiSort = (recents: string[]) => (a: { _id: string }, b: { _id: string }) => {\n\t\t\t\t\t\t\tconst aExact = a._id === key ? 2 : 0;\n\t\t\t\t\t\t\tconst bExact = b._id === key ? 2 : 0;\n\t\t\t\t\t\t\tconst aPartial = a._id.startsWith(key) ? 1 : 0;\n\t\t\t\t\t\t\tconst bPartial = b._id.startsWith(key) ? 1 : 0;\n\n\t\t\t\t\t\t\tlet aScore = aExact + aPartial;\n\t\t\t\t\t\t\tlet bScore = bExact + bPartial;\n\n\t\t\t\t\t\t\tif (recents.includes(a._id)) {\n\t\t\t\t\t\t\t\taScore += recents.indexOf(a._id) + 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (recents.includes(b._id)) {\n\t\t\t\t\t\t\t\tbScore += recents.indexOf(b._id) + 1;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (aScore > bScore) {\n\t\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (aScore < bScore) {\n\t\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\t\tconst key = `:${filter}`;\n\n\t\t\t\t\t\tconst recents = recentEmojis.map((item) => `:${item}:`);\n\n\t\t\t\t\t\tconst collection = emoji.list;\n\n\t\t\t\t\t\treturn Object.keys(collection)\n\t\t\t\t\t\t\t.map((_id) => {\n\t\t\t\t\t\t\t\tconst data = collection[key];\n\t\t\t\t\t\t\t\treturn { _id, data };\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t\t({ _id }) =>\n\t\t\t\t\t\t\t\t\tfilterRegex.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id)),\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.sort(emojiSort(recents))\n\t\t\t\t\t\t\t.slice(0, 10);\n\t\t\t\t\t},\n\t\t\t\t\tgetItemsFromServer: async () => {\n\t\t\t\t\t\treturn [];\n\t\t\t\t\t},\n\t\t\t\t\tgetValue: (item) => `${item._id.substring(1)}`,\n\t\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupEmoji {...item} />,\n\t\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupEmojiProps>({\n\t\t\t\ttitle: t('Emoji'),\n\t\t\t\ttrigger: '\\\\+:',\n\t\t\t\tprefix: '+',\n\t\t\t\tsuffix: ' ',\n\t\t\t\ttriggerAnywhere: false,\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst exactFinalTone = new RegExp('^tone[1-5]:*$');\n\t\t\t\t\tconst colorBlind = new RegExp('tone[1-5]:*$');\n\t\t\t\t\tconst seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');\n\n\t\t\t\t\tconst emojiSort = (recents: string[]) => (a: { _id: string }, b: { _id: string }) => {\n\t\t\t\t\t\tlet idA = a._id;\n\t\t\t\t\t\tlet idB = a._id;\n\n\t\t\t\t\t\tif (recents.includes(a._id)) {\n\t\t\t\t\t\t\tidA = recents.indexOf(a._id) + idA;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (recents.includes(b._id)) {\n\t\t\t\t\t\t\tidB = recents.indexOf(b._id) + idB;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (idA < idB) {\n\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (idA > idB) {\n\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t};\n\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst key = `:${filter}`;\n\n\t\t\t\t\tconst recents = recentEmojis.map((item) => `:${item}:`);\n\n\t\t\t\t\tconst collection = emoji.list;\n\n\t\t\t\t\treturn Object.keys(collection)\n\t\t\t\t\t\t.map((_id) => {\n\t\t\t\t\t\t\tconst data = collection[key];\n\t\t\t\t\t\t\treturn { _id, data };\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t({ _id }) =>\n\t\t\t\t\t\t\t\tfilterRegex.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id)),\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.sort(emojiSort(recents))\n\t\t\t\t\t\t.slice(0, 10);\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async () => {\n\t\t\t\t\treturn [];\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => `${item._id}`,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupEmoji {...item} />,\n\t\t\t}),\n\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupSlashCommandProps>({\n\t\t\t\ttitle: t('Commands'),\n\t\t\t\ttrigger: '/',\n\t\t\t\tsuffix: ' ',\n\t\t\t\ttriggerAnywhere: false,\n\t\t\t\tdisabled: encrypted,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupSlashCommand {...item} />,\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\treturn Object.keys(slashCommands.commands)\n\t\t\t\t\t\t.map((command) => {\n\t\t\t\t\t\t\tconst item = slashCommands.commands[command];\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t_id: command,\n\t\t\t\t\t\t\t\tparams: item.params && i18n.exists(item.params) ? t(item.params) : (item.params ?? ''),\n\t\t\t\t\t\t\t\tdescription: item.description && i18n.exists(item.description) ? t(item.description) : item.description,\n\t\t\t\t\t\t\t\tpermission: item.permission,\n\t\t\t\t\t\t\t\t...(encrypted && { disabled: encrypted }),\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.filter((command) => {\n\t\t\t\t\t\t\tconst isMatch = command._id.indexOf(filter) > -1;\n\n\t\t\t\t\t\t\tif (!isMatch) {\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!command.permission) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn hasAtLeastOnePermission(command.permission, rid);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.sort((a, b) => a._id.localeCompare(b._id))\n\t\t\t\t\t\t.slice(0, 11);\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async () => [],\n\t\t\t}),\n\t\t\tcannedResponseEnabled &&\n\t\t\t\tisOmnichannel &&\n\t\t\t\tcreateMessageBoxPopupConfig<{\n\t\t\t\t\t_id: string;\n\t\t\t\t\ttext: string;\n\t\t\t\t\tshortcut: string;\n\t\t\t\t}>({\n\t\t\t\t\ttitle: t('Canned_Responses'),\n\t\t\t\t\ttrigger: '!',\n\t\t\t\t\tprefix: '',\n\t\t\t\t\ttriggerAnywhere: true,\n\t\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupCannedResponse {...item} />,\n\t\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\t\tconst exp = new RegExp(filter, 'i');\n\t\t\t\t\t\treturn CannedResponse.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshortcut: exp,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: 12,\n\t\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\t\tshortcut: -1,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t\t.map((record) => ({\n\t\t\t\t\t\t\t\t_id: record._id,\n\t\t\t\t\t\t\t\ttext: record.text,\n\t\t\t\t\t\t\t\tshortcut: record.shortcut,\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t},\n\t\t\t\t\tgetItemsFromServer: async () => [],\n\t\t\t\t\tgetValue: (item) => {\n\t\t\t\t\t\treturn item.text;\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig({\n\t\t\t\tmatchSelectorRegex: /(?:^)(\\/[\\w\\d\\S]+ )[^]*$/,\n\t\t\t\tpreview: true,\n\t\t\t\tgetItemsFromLocal: async ({ cmd, params, tmid }: { cmd: string; params: string; tmid: string }) => {\n\t\t\t\t\tconst result = await call({ cmd, params, msg: { rid, tmid } });\n\t\t\t\t\treturn (\n\t\t\t\t\t\tresult?.items.map((item) => ({\n\t\t\t\t\t\t\t_id: item.id,\n\t\t\t\t\t\t\tvalue: item.value,\n\t\t\t\t\t\t\ttype: item.type,\n\t\t\t\t\t\t})) ?? []\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t}),\n\t\t].filter(Boolean);\n\t}, [t, i18n, cannedResponseEnabled, isOmnichannel, recentEmojis, suggestionsCount, userSpotlight, rid, call, useEmoji, encrypted]);\n\n\treturn <ComposerPopupContext.Provider value={value} children={children} />;\n};\n\nexport default ComposerPopupProvider;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/providers/ComposerPopupProvider.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/providers/ComposerPopupProvider.tsx","inputSourceMap":{"version":3,"file":"client/views/room/providers/ComposerPopupProvider.tsx","sourceRoot":"","sources":["client/views/room/providers/ComposerPopupProvider.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { isOmnichannelRoom } from '@rocket.chat/core-typings';\nimport { useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport { escapeRegExp } from '@rocket.chat/string-helpers';\nimport { useMethod, useSetting, useUserPreference } from '@rocket.chat/ui-contexts';\nimport React, { useMemo } from 'react';\nimport type { ReactNode } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { hasAtLeastOnePermission } from '../../../../app/authorization/client';\nimport { CannedResponse } from '../../../../app/canned-responses/client/collections/CannedResponse';\nimport { emoji } from '../../../../app/emoji/client';\nimport { Subscriptions } from '../../../../app/models/client';\nimport { usersFromRoomMessages } from '../../../../app/ui-message/client/popup/messagePopupConfig';\nimport { slashCommands } from '../../../../app/utils/client';\nimport ComposerBoxPopupCannedResponse from '../composer/ComposerBoxPopupCannedResponse';\nimport type { ComposerBoxPopupEmojiProps } from '../composer/ComposerBoxPopupEmoji';\nimport ComposerBoxPopupEmoji from '../composer/ComposerBoxPopupEmoji';\nimport ComposerBoxPopupRoom from '../composer/ComposerBoxPopupRoom';\nimport type { ComposerBoxPopupRoomProps } from '../composer/ComposerBoxPopupRoom';\nimport type { ComposerBoxPopupSlashCommandProps } from '../composer/ComposerBoxPopupSlashCommand';\nimport ComposerBoxPopupSlashCommand from '../composer/ComposerBoxPopupSlashCommand';\nimport ComposerBoxPopupUser from '../composer/ComposerBoxPopupUser';\nimport type { ComposerBoxPopupUserProps } from '../composer/ComposerBoxPopupUser';\nimport type { ComposerPopupContextValue } from '../contexts/ComposerPopupContext';\nimport { ComposerPopupContext, createMessageBoxPopupConfig } from '../contexts/ComposerPopupContext';\n\ntype ComposerPopupProviderProps = {\n\tchildren: ReactNode;\n\troom: IRoom;\n};\n\nconst ComposerPopupProvider = ({ children, room }: ComposerPopupProviderProps) => {\n\tconst { _id: rid, encrypted: isRoomEncrypted } = room;\n\tconst userSpotlight = useMethod('spotlight');\n\tconst suggestionsCount = useSetting<number>('Number_of_users_autocomplete_suggestions');\n\tconst cannedResponseEnabled = useSetting<boolean>('Canned_Responses_Enable');\n\tconst [recentEmojis] = useLocalStorage('emoji.recent', []);\n\tconst isOmnichannel = isOmnichannelRoom(room);\n\tconst useEmoji = useUserPreference('useEmojis');\n\tconst { t, i18n } = useTranslation();\n\tconst e2eEnabled = useSetting<boolean>('E2E_Enable');\n\tconst unencryptedMessagesAllowed = useSetting<boolean>('E2E_Allow_Unencrypted_Messages');\n\tconst encrypted = isRoomEncrypted && e2eEnabled && !unencryptedMessagesAllowed;\n\n\tconst call = useMethod('getSlashCommandPreviews');\n\tconst value: ComposerPopupContextValue = useMemo(() => {\n\t\treturn [\n\t\t\tcreateMessageBoxPopupConfig({\n\t\t\t\ttrigger: '@',\n\t\t\t\ttitle: t('People'),\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = filter && new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst items: ComposerBoxPopupUserProps[] = [];\n\n\t\t\t\t\tconst users = usersFromRoomMessages\n\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tts: { $exists: true },\n\t\t\t\t\t\t\t\t...(filter && {\n\t\t\t\t\t\t\t\t\t$or: [{ username: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\t\tsort: { ts: -1 },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t.map((u) => {\n\t\t\t\t\t\t\tu.suggestion = true;\n\t\t\t\t\t\t\treturn u;\n\t\t\t\t\t\t});\n\t\t\t\t\tif (!filterRegex || filterRegex.test('all')) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t_id: 'all',\n\t\t\t\t\t\t\tusername: 'all',\n\t\t\t\t\t\t\tsystem: true,\n\t\t\t\t\t\t\tname: t('Notify_all_in_this_room'),\n\t\t\t\t\t\t\tsort: 4,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!filterRegex || filterRegex.test('here')) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t_id: 'here',\n\t\t\t\t\t\t\tusername: 'here',\n\t\t\t\t\t\t\tsystem: true,\n\t\t\t\t\t\t\tname: t('Notify_active_in_this_room'),\n\t\t\t\t\t\t\tsort: 4,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\treturn [...users, ...items];\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = filter && new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst usernames = usersFromRoomMessages\n\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tts: { $exists: true },\n\t\t\t\t\t\t\t\t...(filter && {\n\t\t\t\t\t\t\t\t\t$or: [{ username: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\t\tsort: { ts: -1 },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t.map((u) => {\n\t\t\t\t\t\t\treturn u.username;\n\t\t\t\t\t\t});\n\t\t\t\t\tconst { users = [] } = await userSpotlight(filter, usernames, { users: true, mentions: true }, rid);\n\n\t\t\t\t\treturn users.map(({ _id, username, nickname, name, status, avatarETag, outside }) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t_id,\n\t\t\t\t\t\t\tusername,\n\t\t\t\t\t\t\tnickname,\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tstatus,\n\t\t\t\t\t\t\tavatarETag,\n\t\t\t\t\t\t\toutside,\n\t\t\t\t\t\t\tsort: 3,\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => item.username,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupUser {...item} />,\n\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupRoomProps>({\n\t\t\t\ttrigger: '#',\n\t\t\t\ttitle: t('Channels'),\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst records = Subscriptions.find(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$and: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$or: [{ fname: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$or: [{ federated: { $exists: false } }, { federated: false }],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tt: {\n\t\t\t\t\t\t\t\t$in: ['c', 'p'],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\tls: -1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t).fetch();\n\t\t\t\t\treturn records;\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async (filter: string) => {\n\t\t\t\t\tconst { rooms = [] } = await userSpotlight(filter, [], { rooms: true, mentions: true }, rid);\n\t\t\t\t\treturn rooms as unknown as ComposerBoxPopupRoomProps[];\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => `${item.name || item.fname}`,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupRoom {...item} />,\n\t\t\t}) as any,\n\t\t\tuseEmoji &&\n\t\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupEmojiProps>({\n\t\t\t\t\ttrigger: ':',\n\t\t\t\t\ttitle: t('Emoji'),\n\t\t\t\t\ttriggerLength: 2,\n\t\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\t\tconst exactFinalTone = new RegExp('^tone[1-5]:*$');\n\t\t\t\t\t\tconst colorBlind = new RegExp('tone[1-5]:*$');\n\t\t\t\t\t\tconst seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');\n\n\t\t\t\t\t\tconst emojiSort = (recents: string[]) => (a: { _id: string }, b: { _id: string }) => {\n\t\t\t\t\t\t\tconst aExact = a._id === key ? 2 : 0;\n\t\t\t\t\t\t\tconst bExact = b._id === key ? 2 : 0;\n\t\t\t\t\t\t\tconst aPartial = a._id.startsWith(key) ? 1 : 0;\n\t\t\t\t\t\t\tconst bPartial = b._id.startsWith(key) ? 1 : 0;\n\n\t\t\t\t\t\t\tlet aScore = aExact + aPartial;\n\t\t\t\t\t\t\tlet bScore = bExact + bPartial;\n\n\t\t\t\t\t\t\tif (recents.includes(a._id)) {\n\t\t\t\t\t\t\t\taScore += recents.indexOf(a._id) + 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (recents.includes(b._id)) {\n\t\t\t\t\t\t\t\tbScore += recents.indexOf(b._id) + 1;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (aScore > bScore) {\n\t\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (aScore < bScore) {\n\t\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\t\tconst key = `:${filter}`;\n\n\t\t\t\t\t\tconst recents = recentEmojis.map((item) => `:${item}:`);\n\n\t\t\t\t\t\tconst collection = emoji.list;\n\n\t\t\t\t\t\treturn Object.keys(collection)\n\t\t\t\t\t\t\t.map((_id) => {\n\t\t\t\t\t\t\t\tconst data = collection[key];\n\t\t\t\t\t\t\t\treturn { _id, data };\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t\t({ _id }) =>\n\t\t\t\t\t\t\t\t\tfilterRegex.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id)),\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.sort(emojiSort(recents))\n\t\t\t\t\t\t\t.slice(0, 10);\n\t\t\t\t\t},\n\t\t\t\t\tgetItemsFromServer: async () => {\n\t\t\t\t\t\treturn [];\n\t\t\t\t\t},\n\t\t\t\t\tgetValue: (item) => `${item._id.substring(1)}`,\n\t\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupEmoji {...item} />,\n\t\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupEmojiProps>({\n\t\t\t\ttitle: t('Emoji'),\n\t\t\t\ttrigger: '\\\\+:',\n\t\t\t\tprefix: '+',\n\t\t\t\tsuffix: ' ',\n\t\t\t\ttriggerAnywhere: false,\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst exactFinalTone = new RegExp('^tone[1-5]:*$');\n\t\t\t\t\tconst colorBlind = new RegExp('tone[1-5]:*$');\n\t\t\t\t\tconst seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');\n\n\t\t\t\t\tconst emojiSort = (recents: string[]) => (a: { _id: string }, b: { _id: string }) => {\n\t\t\t\t\t\tlet idA = a._id;\n\t\t\t\t\t\tlet idB = a._id;\n\n\t\t\t\t\t\tif (recents.includes(a._id)) {\n\t\t\t\t\t\t\tidA = recents.indexOf(a._id) + idA;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (recents.includes(b._id)) {\n\t\t\t\t\t\t\tidB = recents.indexOf(b._id) + idB;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (idA < idB) {\n\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (idA > idB) {\n\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t};\n\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst key = `:${filter}`;\n\n\t\t\t\t\tconst recents = recentEmojis.map((item) => `:${item}:`);\n\n\t\t\t\t\tconst collection = emoji.list;\n\n\t\t\t\t\treturn Object.keys(collection)\n\t\t\t\t\t\t.map((_id) => {\n\t\t\t\t\t\t\tconst data = collection[key];\n\t\t\t\t\t\t\treturn { _id, data };\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t({ _id }) =>\n\t\t\t\t\t\t\t\tfilterRegex.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id)),\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.sort(emojiSort(recents))\n\t\t\t\t\t\t.slice(0, 10);\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async () => {\n\t\t\t\t\treturn [];\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => `${item._id}`,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupEmoji {...item} />,\n\t\t\t}),\n\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupSlashCommandProps>({\n\t\t\t\ttitle: t('Commands'),\n\t\t\t\ttrigger: '/',\n\t\t\t\tsuffix: ' ',\n\t\t\t\ttriggerAnywhere: false,\n\t\t\t\tdisabled: encrypted,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupSlashCommand {...item} />,\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\treturn Object.keys(slashCommands.commands)\n\t\t\t\t\t\t.map((command) => {\n\t\t\t\t\t\t\tconst item = slashCommands.commands[command];\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t_id: command,\n\t\t\t\t\t\t\t\tparams: item.params && i18n.exists(item.params) ? t(item.params) : (item.params ?? ''),\n\t\t\t\t\t\t\t\tdescription: item.description && i18n.exists(item.description) ? t(item.description) : item.description,\n\t\t\t\t\t\t\t\tpermission: item.permission,\n\t\t\t\t\t\t\t\t...(encrypted && { disabled: encrypted }),\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.filter((command) => {\n\t\t\t\t\t\t\tconst isMatch = command._id.indexOf(filter) > -1;\n\n\t\t\t\t\t\t\tif (!isMatch) {\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!command.permission) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn hasAtLeastOnePermission(command.permission, rid);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.sort((a, b) => a._id.localeCompare(b._id))\n\t\t\t\t\t\t.slice(0, 11);\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async () => [],\n\t\t\t}),\n\t\t\tcannedResponseEnabled &&\n\t\t\t\tisOmnichannel &&\n\t\t\t\tcreateMessageBoxPopupConfig<{\n\t\t\t\t\t_id: string;\n\t\t\t\t\ttext: string;\n\t\t\t\t\tshortcut: string;\n\t\t\t\t}>({\n\t\t\t\t\ttitle: t('Canned_Responses'),\n\t\t\t\t\ttrigger: '!',\n\t\t\t\t\tprefix: '',\n\t\t\t\t\ttriggerAnywhere: true,\n\t\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupCannedResponse {...item} />,\n\t\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\t\tconst exp = new RegExp(filter, 'i');\n\t\t\t\t\t\treturn CannedResponse.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshortcut: exp,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: 12,\n\t\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\t\tshortcut: -1,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t\t.map((record) => ({\n\t\t\t\t\t\t\t\t_id: record._id,\n\t\t\t\t\t\t\t\ttext: record.text,\n\t\t\t\t\t\t\t\tshortcut: record.shortcut,\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t},\n\t\t\t\t\tgetItemsFromServer: async () => [],\n\t\t\t\t\tgetValue: (item) => {\n\t\t\t\t\t\treturn item.text;\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig({\n\t\t\t\tmatchSelectorRegex: /(?:^)(\\/[\\w\\d\\S]+ )[^]*$/,\n\t\t\t\tpreview: true,\n\t\t\t\tgetItemsFromLocal: async ({ cmd, params, tmid }: { cmd: string; params: string; tmid: string }) => {\n\t\t\t\t\tconst result = await call({ cmd, params, msg: { rid, tmid } });\n\t\t\t\t\treturn (\n\t\t\t\t\t\tresult?.items.map((item) => ({\n\t\t\t\t\t\t\t_id: item.id,\n\t\t\t\t\t\t\tvalue: item.value,\n\t\t\t\t\t\t\ttype: item.type,\n\t\t\t\t\t\t})) ?? []\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t}),\n\t\t].filter(Boolean);\n\t}, [t, i18n, cannedResponseEnabled, isOmnichannel, recentEmojis, suggestionsCount, userSpotlight, rid, call, useEmoji, encrypted]);\n\n\treturn <ComposerPopupContext.Provider value={value} children={children} />;\n};\n\nexport default ComposerPopupProvider;\n"]}}},"code":"let _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n}, 0);\nlet isOmnichannelRoom;\nmodule.link(\"@rocket.chat/core-typings\", {\n  isOmnichannelRoom(v) {\n    isOmnichannelRoom = v;\n  }\n}, 0);\nlet useLocalStorage;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useLocalStorage(v) {\n    useLocalStorage = v;\n  }\n}, 1);\nlet escapeRegExp;\nmodule.link(\"@rocket.chat/string-helpers\", {\n  escapeRegExp(v) {\n    escapeRegExp = v;\n  }\n}, 2);\nlet useMethod, useSetting, useUserPreference;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useMethod(v) {\n    useMethod = v;\n  },\n  useSetting(v) {\n    useSetting = v;\n  },\n  useUserPreference(v) {\n    useUserPreference = v;\n  }\n}, 3);\nlet React, useMemo;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n  useMemo(v) {\n    useMemo = v;\n  }\n}, 4);\nlet useTranslation;\nmodule.link(\"react-i18next\", {\n  useTranslation(v) {\n    useTranslation = v;\n  }\n}, 5);\nlet hasAtLeastOnePermission;\nmodule.link(\"../../../../app/authorization/client\", {\n  hasAtLeastOnePermission(v) {\n    hasAtLeastOnePermission = v;\n  }\n}, 6);\nlet CannedResponse;\nmodule.link(\"../../../../app/canned-responses/client/collections/CannedResponse\", {\n  CannedResponse(v) {\n    CannedResponse = v;\n  }\n}, 7);\nlet emoji;\nmodule.link(\"../../../../app/emoji/client\", {\n  emoji(v) {\n    emoji = v;\n  }\n}, 8);\nlet Subscriptions;\nmodule.link(\"../../../../app/models/client\", {\n  Subscriptions(v) {\n    Subscriptions = v;\n  }\n}, 9);\nlet usersFromRoomMessages;\nmodule.link(\"../../../../app/ui-message/client/popup/messagePopupConfig\", {\n  usersFromRoomMessages(v) {\n    usersFromRoomMessages = v;\n  }\n}, 10);\nlet slashCommands;\nmodule.link(\"../../../../app/utils/client\", {\n  slashCommands(v) {\n    slashCommands = v;\n  }\n}, 11);\nlet ComposerBoxPopupCannedResponse;\nmodule.link(\"../composer/ComposerBoxPopupCannedResponse\", {\n  default(v) {\n    ComposerBoxPopupCannedResponse = v;\n  }\n}, 12);\nlet ComposerBoxPopupEmoji;\nmodule.link(\"../composer/ComposerBoxPopupEmoji\", {\n  default(v) {\n    ComposerBoxPopupEmoji = v;\n  }\n}, 13);\nlet ComposerBoxPopupRoom;\nmodule.link(\"../composer/ComposerBoxPopupRoom\", {\n  default(v) {\n    ComposerBoxPopupRoom = v;\n  }\n}, 14);\nlet ComposerBoxPopupSlashCommand;\nmodule.link(\"../composer/ComposerBoxPopupSlashCommand\", {\n  default(v) {\n    ComposerBoxPopupSlashCommand = v;\n  }\n}, 15);\nlet ComposerBoxPopupUser;\nmodule.link(\"../composer/ComposerBoxPopupUser\", {\n  default(v) {\n    ComposerBoxPopupUser = v;\n  }\n}, 16);\nlet ComposerPopupContext, createMessageBoxPopupConfig;\nmodule.link(\"../contexts/ComposerPopupContext\", {\n  ComposerPopupContext(v) {\n    ComposerPopupContext = v;\n  },\n  createMessageBoxPopupConfig(v) {\n    createMessageBoxPopupConfig = v;\n  }\n}, 17);\nconst ComposerPopupProvider = _ref => {\n  let {\n    children,\n    room\n  } = _ref;\n  const {\n    _id: rid,\n    encrypted: isRoomEncrypted\n  } = room;\n  const userSpotlight = useMethod('spotlight');\n  const suggestionsCount = useSetting('Number_of_users_autocomplete_suggestions');\n  const cannedResponseEnabled = useSetting('Canned_Responses_Enable');\n  const [recentEmojis] = useLocalStorage('emoji.recent', []);\n  const isOmnichannel = isOmnichannelRoom(room);\n  const useEmoji = useUserPreference('useEmojis');\n  const {\n    t,\n    i18n\n  } = useTranslation();\n  const e2eEnabled = useSetting('E2E_Enable');\n  const unencryptedMessagesAllowed = useSetting('E2E_Allow_Unencrypted_Messages');\n  const encrypted = isRoomEncrypted && e2eEnabled && !unencryptedMessagesAllowed;\n  const call = useMethod('getSlashCommandPreviews');\n  const value = useMemo(() => {\n    return [createMessageBoxPopupConfig({\n      trigger: '@',\n      title: t('People'),\n      getItemsFromLocal: async filter => {\n        const filterRegex = filter && new RegExp(escapeRegExp(filter), 'i');\n        const items = [];\n        const users = usersFromRoomMessages.find(_objectSpread({\n          ts: {\n            $exists: true\n          }\n        }, filter && {\n          $or: [{\n            username: filterRegex\n          }, {\n            name: filterRegex\n          }]\n        }), {\n          limit: suggestionsCount !== null && suggestionsCount !== void 0 ? suggestionsCount : 5,\n          sort: {\n            ts: -1\n          }\n        }).fetch().map(u => {\n          u.suggestion = true;\n          return u;\n        });\n        if (!filterRegex || filterRegex.test('all')) {\n          items.push({\n            _id: 'all',\n            username: 'all',\n            system: true,\n            name: t('Notify_all_in_this_room'),\n            sort: 4\n          });\n        }\n        if (!filterRegex || filterRegex.test('here')) {\n          items.push({\n            _id: 'here',\n            username: 'here',\n            system: true,\n            name: t('Notify_active_in_this_room'),\n            sort: 4\n          });\n        }\n        return [...users, ...items];\n      },\n      getItemsFromServer: async filter => {\n        const filterRegex = filter && new RegExp(escapeRegExp(filter), 'i');\n        const usernames = usersFromRoomMessages.find(_objectSpread({\n          ts: {\n            $exists: true\n          }\n        }, filter && {\n          $or: [{\n            username: filterRegex\n          }, {\n            name: filterRegex\n          }]\n        }), {\n          limit: suggestionsCount !== null && suggestionsCount !== void 0 ? suggestionsCount : 5,\n          sort: {\n            ts: -1\n          }\n        }).fetch().map(u => {\n          return u.username;\n        });\n        const {\n          users = []\n        } = await userSpotlight(filter, usernames, {\n          users: true,\n          mentions: true\n        }, rid);\n        return users.map(_ref2 => {\n          let {\n            _id,\n            username,\n            nickname,\n            name,\n            status,\n            avatarETag,\n            outside\n          } = _ref2;\n          return {\n            _id,\n            username,\n            nickname,\n            name,\n            status,\n            avatarETag,\n            outside,\n            sort: 3\n          };\n        });\n      },\n      getValue: item => item.username,\n      renderItem: _ref3 => {\n        let {\n          item\n        } = _ref3;\n        return /*#__PURE__*/React.createElement(ComposerBoxPopupUser, item);\n      }\n    }), createMessageBoxPopupConfig({\n      trigger: '#',\n      title: t('Channels'),\n      getItemsFromLocal: async filter => {\n        const filterRegex = new RegExp(escapeRegExp(filter), 'i');\n        const records = Subscriptions.find({\n          $and: [{\n            $or: [{\n              fname: filterRegex\n            }, {\n              name: filterRegex\n            }]\n          }, {\n            $or: [{\n              federated: {\n                $exists: false\n              }\n            }, {\n              federated: false\n            }]\n          }],\n          t: {\n            $in: ['c', 'p']\n          }\n        }, {\n          limit: suggestionsCount !== null && suggestionsCount !== void 0 ? suggestionsCount : 5,\n          sort: {\n            ls: -1\n          }\n        }).fetch();\n        return records;\n      },\n      getItemsFromServer: async filter => {\n        const {\n          rooms = []\n        } = await userSpotlight(filter, [], {\n          rooms: true,\n          mentions: true\n        }, rid);\n        return rooms;\n      },\n      getValue: item => \"\".concat(item.name || item.fname),\n      renderItem: _ref4 => {\n        let {\n          item\n        } = _ref4;\n        return /*#__PURE__*/React.createElement(ComposerBoxPopupRoom, item);\n      }\n    }), useEmoji && createMessageBoxPopupConfig({\n      trigger: ':',\n      title: t('Emoji'),\n      triggerLength: 2,\n      getItemsFromLocal: async filter => {\n        const exactFinalTone = new RegExp('^tone[1-5]:*$');\n        const colorBlind = new RegExp('tone[1-5]:*$');\n        const seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');\n        const emojiSort = recents => (a, b) => {\n          const aExact = a._id === key ? 2 : 0;\n          const bExact = b._id === key ? 2 : 0;\n          const aPartial = a._id.startsWith(key) ? 1 : 0;\n          const bPartial = b._id.startsWith(key) ? 1 : 0;\n          let aScore = aExact + aPartial;\n          let bScore = bExact + bPartial;\n          if (recents.includes(a._id)) {\n            aScore += recents.indexOf(a._id) + 1;\n          }\n          if (recents.includes(b._id)) {\n            bScore += recents.indexOf(b._id) + 1;\n          }\n          if (aScore > bScore) {\n            return -1;\n          }\n          if (aScore < bScore) {\n            return 1;\n          }\n          return 0;\n        };\n        const filterRegex = new RegExp(escapeRegExp(filter), 'i');\n        const key = \":\".concat(filter);\n        const recents = recentEmojis.map(item => \":\".concat(item, \":\"));\n        const collection = emoji.list;\n        return Object.keys(collection).map(_id => {\n          const data = collection[key];\n          return {\n            _id,\n            data\n          };\n        }).filter(_ref5 => {\n          let {\n            _id\n          } = _ref5;\n          return filterRegex.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id));\n        }).sort(emojiSort(recents)).slice(0, 10);\n      },\n      getItemsFromServer: async () => {\n        return [];\n      },\n      getValue: item => \"\".concat(item._id.substring(1)),\n      renderItem: _ref6 => {\n        let {\n          item\n        } = _ref6;\n        return /*#__PURE__*/React.createElement(ComposerBoxPopupEmoji, item);\n      }\n    }), createMessageBoxPopupConfig({\n      title: t('Emoji'),\n      trigger: '\\\\+:',\n      prefix: '+',\n      suffix: ' ',\n      triggerAnywhere: false,\n      getItemsFromLocal: async filter => {\n        const exactFinalTone = new RegExp('^tone[1-5]:*$');\n        const colorBlind = new RegExp('tone[1-5]:*$');\n        const seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');\n        const emojiSort = recents => (a, b) => {\n          let idA = a._id;\n          let idB = a._id;\n          if (recents.includes(a._id)) {\n            idA = recents.indexOf(a._id) + idA;\n          }\n          if (recents.includes(b._id)) {\n            idB = recents.indexOf(b._id) + idB;\n          }\n          if (idA < idB) {\n            return -1;\n          }\n          if (idA > idB) {\n            return 1;\n          }\n          return 0;\n        };\n        const filterRegex = new RegExp(escapeRegExp(filter), 'i');\n        const key = \":\".concat(filter);\n        const recents = recentEmojis.map(item => \":\".concat(item, \":\"));\n        const collection = emoji.list;\n        return Object.keys(collection).map(_id => {\n          const data = collection[key];\n          return {\n            _id,\n            data\n          };\n        }).filter(_ref7 => {\n          let {\n            _id\n          } = _ref7;\n          return filterRegex.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id));\n        }).sort(emojiSort(recents)).slice(0, 10);\n      },\n      getItemsFromServer: async () => {\n        return [];\n      },\n      getValue: item => \"\".concat(item._id),\n      renderItem: _ref8 => {\n        let {\n          item\n        } = _ref8;\n        return /*#__PURE__*/React.createElement(ComposerBoxPopupEmoji, item);\n      }\n    }), createMessageBoxPopupConfig({\n      title: t('Commands'),\n      trigger: '/',\n      suffix: ' ',\n      triggerAnywhere: false,\n      disabled: encrypted,\n      renderItem: _ref9 => {\n        let {\n          item\n        } = _ref9;\n        return /*#__PURE__*/React.createElement(ComposerBoxPopupSlashCommand, item);\n      },\n      getItemsFromLocal: async filter => {\n        return Object.keys(slashCommands.commands).map(command => {\n          var _item$params;\n          const item = slashCommands.commands[command];\n          return _objectSpread({\n            _id: command,\n            params: item.params && i18n.exists(item.params) ? t(item.params) : (_item$params = item.params) !== null && _item$params !== void 0 ? _item$params : '',\n            description: item.description && i18n.exists(item.description) ? t(item.description) : item.description,\n            permission: item.permission\n          }, encrypted && {\n            disabled: encrypted\n          });\n        }).filter(command => {\n          const isMatch = command._id.indexOf(filter) > -1;\n          if (!isMatch) {\n            return false;\n          }\n          if (!command.permission) {\n            return true;\n          }\n          return hasAtLeastOnePermission(command.permission, rid);\n        }).sort((a, b) => a._id.localeCompare(b._id)).slice(0, 11);\n      },\n      getItemsFromServer: async () => []\n    }), cannedResponseEnabled && isOmnichannel && createMessageBoxPopupConfig({\n      title: t('Canned_Responses'),\n      trigger: '!',\n      prefix: '',\n      triggerAnywhere: true,\n      renderItem: _ref10 => {\n        let {\n          item\n        } = _ref10;\n        return /*#__PURE__*/React.createElement(ComposerBoxPopupCannedResponse, item);\n      },\n      getItemsFromLocal: async filter => {\n        const exp = new RegExp(filter, 'i');\n        return CannedResponse.find({\n          shortcut: exp\n        }, {\n          limit: 12,\n          sort: {\n            shortcut: -1\n          }\n        }).fetch().map(record => ({\n          _id: record._id,\n          text: record.text,\n          shortcut: record.shortcut\n        }));\n      },\n      getItemsFromServer: async () => [],\n      getValue: item => {\n        return item.text;\n      }\n    }), createMessageBoxPopupConfig({\n      matchSelectorRegex: /(?:^)(\\/[\\w\\d\\S]+ )[^]*$/,\n      preview: true,\n      getItemsFromLocal: async _ref11 => {\n        var _result$items$map;\n        let {\n          cmd,\n          params,\n          tmid\n        } = _ref11;\n        const result = await call({\n          cmd,\n          params,\n          msg: {\n            rid,\n            tmid\n          }\n        });\n        return (_result$items$map = result === null || result === void 0 ? void 0 : result.items.map(item => ({\n          _id: item.id,\n          value: item.value,\n          type: item.type\n        }))) !== null && _result$items$map !== void 0 ? _result$items$map : [];\n      }\n    })].filter(Boolean);\n  }, [t, i18n, cannedResponseEnabled, isOmnichannel, recentEmojis, suggestionsCount, userSpotlight, rid, call, useEmoji, encrypted]);\n  return /*#__PURE__*/React.createElement(ComposerPopupContext.Provider, {\n    value: value,\n    children: children\n  });\n};\nmodule.exportDefault(ComposerPopupProvider);","map":{"version":3,"names":["_objectSpread","module","link","default","v","isOmnichannelRoom","useLocalStorage","escapeRegExp","useMethod","useSetting","useUserPreference","React","useMemo","useTranslation","hasAtLeastOnePermission","CannedResponse","emoji","Subscriptions","usersFromRoomMessages","slashCommands","ComposerBoxPopupCannedResponse","ComposerBoxPopupEmoji","ComposerBoxPopupRoom","ComposerBoxPopupSlashCommand","ComposerBoxPopupUser","ComposerPopupContext","createMessageBoxPopupConfig","ComposerPopupProvider","_ref","children","room","_id","rid","encrypted","isRoomEncrypted","userSpotlight","suggestionsCount","cannedResponseEnabled","recentEmojis","isOmnichannel","useEmoji","t","i18n","e2eEnabled","unencryptedMessagesAllowed","call","value","trigger","title","getItemsFromLocal","filter","filterRegex","RegExp","items","users","find","ts","$exists","$or","username","name","limit","sort","fetch","map","u","suggestion","test","push","system","getItemsFromServer","usernames","mentions","_ref2","nickname","status","avatarETag","outside","getValue","item","renderItem","_ref3","createElement","records","$and","fname","federated","$in","ls","rooms","concat","_ref4","triggerLength","exactFinalTone","colorBlind","seeColor","emojiSort","recents","a","b","aExact","key","bExact","aPartial","startsWith","bPartial","aScore","bScore","includes","indexOf","collection","list","Object","keys","data","_ref5","substring","length","slice","_ref6","prefix","suffix","triggerAnywhere","idA","idB","_ref7","_ref8","disabled","_ref9","commands","command","_item$params","params","exists","description","permission","isMatch","localeCompare","_ref10","exp","shortcut","record","text","matchSelectorRegex","preview","_ref11","_result$items$map","cmd","tmid","result","msg","id","type","Boolean","Provider","exportDefault"],"sources":["client/views/room/providers/ComposerPopupProvider.tsx"],"sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { isOmnichannelRoom } from '@rocket.chat/core-typings';\nimport { useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport { escapeRegExp } from '@rocket.chat/string-helpers';\nimport { useMethod, useSetting, useUserPreference } from '@rocket.chat/ui-contexts';\nimport React, { useMemo } from 'react';\nimport type { ReactNode } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { hasAtLeastOnePermission } from '../../../../app/authorization/client';\nimport { CannedResponse } from '../../../../app/canned-responses/client/collections/CannedResponse';\nimport { emoji } from '../../../../app/emoji/client';\nimport { Subscriptions } from '../../../../app/models/client';\nimport { usersFromRoomMessages } from '../../../../app/ui-message/client/popup/messagePopupConfig';\nimport { slashCommands } from '../../../../app/utils/client';\nimport ComposerBoxPopupCannedResponse from '../composer/ComposerBoxPopupCannedResponse';\nimport type { ComposerBoxPopupEmojiProps } from '../composer/ComposerBoxPopupEmoji';\nimport ComposerBoxPopupEmoji from '../composer/ComposerBoxPopupEmoji';\nimport ComposerBoxPopupRoom from '../composer/ComposerBoxPopupRoom';\nimport type { ComposerBoxPopupRoomProps } from '../composer/ComposerBoxPopupRoom';\nimport type { ComposerBoxPopupSlashCommandProps } from '../composer/ComposerBoxPopupSlashCommand';\nimport ComposerBoxPopupSlashCommand from '../composer/ComposerBoxPopupSlashCommand';\nimport ComposerBoxPopupUser from '../composer/ComposerBoxPopupUser';\nimport type { ComposerBoxPopupUserProps } from '../composer/ComposerBoxPopupUser';\nimport type { ComposerPopupContextValue } from '../contexts/ComposerPopupContext';\nimport { ComposerPopupContext, createMessageBoxPopupConfig } from '../contexts/ComposerPopupContext';\n\ntype ComposerPopupProviderProps = {\n\tchildren: ReactNode;\n\troom: IRoom;\n};\n\nconst ComposerPopupProvider = ({ children, room }: ComposerPopupProviderProps) => {\n\tconst { _id: rid, encrypted: isRoomEncrypted } = room;\n\tconst userSpotlight = useMethod('spotlight');\n\tconst suggestionsCount = useSetting<number>('Number_of_users_autocomplete_suggestions');\n\tconst cannedResponseEnabled = useSetting<boolean>('Canned_Responses_Enable');\n\tconst [recentEmojis] = useLocalStorage('emoji.recent', []);\n\tconst isOmnichannel = isOmnichannelRoom(room);\n\tconst useEmoji = useUserPreference('useEmojis');\n\tconst { t, i18n } = useTranslation();\n\tconst e2eEnabled = useSetting<boolean>('E2E_Enable');\n\tconst unencryptedMessagesAllowed = useSetting<boolean>('E2E_Allow_Unencrypted_Messages');\n\tconst encrypted = isRoomEncrypted && e2eEnabled && !unencryptedMessagesAllowed;\n\n\tconst call = useMethod('getSlashCommandPreviews');\n\tconst value: ComposerPopupContextValue = useMemo(() => {\n\t\treturn [\n\t\t\tcreateMessageBoxPopupConfig({\n\t\t\t\ttrigger: '@',\n\t\t\t\ttitle: t('People'),\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = filter && new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst items: ComposerBoxPopupUserProps[] = [];\n\n\t\t\t\t\tconst users = usersFromRoomMessages\n\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tts: { $exists: true },\n\t\t\t\t\t\t\t\t...(filter && {\n\t\t\t\t\t\t\t\t\t$or: [{ username: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\t\tsort: { ts: -1 },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t.map((u) => {\n\t\t\t\t\t\t\tu.suggestion = true;\n\t\t\t\t\t\t\treturn u;\n\t\t\t\t\t\t});\n\t\t\t\t\tif (!filterRegex || filterRegex.test('all')) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t_id: 'all',\n\t\t\t\t\t\t\tusername: 'all',\n\t\t\t\t\t\t\tsystem: true,\n\t\t\t\t\t\t\tname: t('Notify_all_in_this_room'),\n\t\t\t\t\t\t\tsort: 4,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!filterRegex || filterRegex.test('here')) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t_id: 'here',\n\t\t\t\t\t\t\tusername: 'here',\n\t\t\t\t\t\t\tsystem: true,\n\t\t\t\t\t\t\tname: t('Notify_active_in_this_room'),\n\t\t\t\t\t\t\tsort: 4,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\treturn [...users, ...items];\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = filter && new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst usernames = usersFromRoomMessages\n\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tts: { $exists: true },\n\t\t\t\t\t\t\t\t...(filter && {\n\t\t\t\t\t\t\t\t\t$or: [{ username: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\t\tsort: { ts: -1 },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t.map((u) => {\n\t\t\t\t\t\t\treturn u.username;\n\t\t\t\t\t\t});\n\t\t\t\t\tconst { users = [] } = await userSpotlight(filter, usernames, { users: true, mentions: true }, rid);\n\n\t\t\t\t\treturn users.map(({ _id, username, nickname, name, status, avatarETag, outside }) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t_id,\n\t\t\t\t\t\t\tusername,\n\t\t\t\t\t\t\tnickname,\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tstatus,\n\t\t\t\t\t\t\tavatarETag,\n\t\t\t\t\t\t\toutside,\n\t\t\t\t\t\t\tsort: 3,\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => item.username,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupUser {...item} />,\n\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupRoomProps>({\n\t\t\t\ttrigger: '#',\n\t\t\t\ttitle: t('Channels'),\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst records = Subscriptions.find(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$and: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$or: [{ fname: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$or: [{ federated: { $exists: false } }, { federated: false }],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tt: {\n\t\t\t\t\t\t\t\t$in: ['c', 'p'],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\tls: -1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t).fetch();\n\t\t\t\t\treturn records;\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async (filter: string) => {\n\t\t\t\t\tconst { rooms = [] } = await userSpotlight(filter, [], { rooms: true, mentions: true }, rid);\n\t\t\t\t\treturn rooms as unknown as ComposerBoxPopupRoomProps[];\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => `${item.name || item.fname}`,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupRoom {...item} />,\n\t\t\t}) as any,\n\t\t\tuseEmoji &&\n\t\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupEmojiProps>({\n\t\t\t\t\ttrigger: ':',\n\t\t\t\t\ttitle: t('Emoji'),\n\t\t\t\t\ttriggerLength: 2,\n\t\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\t\tconst exactFinalTone = new RegExp('^tone[1-5]:*$');\n\t\t\t\t\t\tconst colorBlind = new RegExp('tone[1-5]:*$');\n\t\t\t\t\t\tconst seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');\n\n\t\t\t\t\t\tconst emojiSort = (recents: string[]) => (a: { _id: string }, b: { _id: string }) => {\n\t\t\t\t\t\t\tconst aExact = a._id === key ? 2 : 0;\n\t\t\t\t\t\t\tconst bExact = b._id === key ? 2 : 0;\n\t\t\t\t\t\t\tconst aPartial = a._id.startsWith(key) ? 1 : 0;\n\t\t\t\t\t\t\tconst bPartial = b._id.startsWith(key) ? 1 : 0;\n\n\t\t\t\t\t\t\tlet aScore = aExact + aPartial;\n\t\t\t\t\t\t\tlet bScore = bExact + bPartial;\n\n\t\t\t\t\t\t\tif (recents.includes(a._id)) {\n\t\t\t\t\t\t\t\taScore += recents.indexOf(a._id) + 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (recents.includes(b._id)) {\n\t\t\t\t\t\t\t\tbScore += recents.indexOf(b._id) + 1;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (aScore > bScore) {\n\t\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (aScore < bScore) {\n\t\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\t\tconst key = `:${filter}`;\n\n\t\t\t\t\t\tconst recents = recentEmojis.map((item) => `:${item}:`);\n\n\t\t\t\t\t\tconst collection = emoji.list;\n\n\t\t\t\t\t\treturn Object.keys(collection)\n\t\t\t\t\t\t\t.map((_id) => {\n\t\t\t\t\t\t\t\tconst data = collection[key];\n\t\t\t\t\t\t\t\treturn { _id, data };\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t\t({ _id }) =>\n\t\t\t\t\t\t\t\t\tfilterRegex.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id)),\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.sort(emojiSort(recents))\n\t\t\t\t\t\t\t.slice(0, 10);\n\t\t\t\t\t},\n\t\t\t\t\tgetItemsFromServer: async () => {\n\t\t\t\t\t\treturn [];\n\t\t\t\t\t},\n\t\t\t\t\tgetValue: (item) => `${item._id.substring(1)}`,\n\t\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupEmoji {...item} />,\n\t\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupEmojiProps>({\n\t\t\t\ttitle: t('Emoji'),\n\t\t\t\ttrigger: '\\\\+:',\n\t\t\t\tprefix: '+',\n\t\t\t\tsuffix: ' ',\n\t\t\t\ttriggerAnywhere: false,\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst exactFinalTone = new RegExp('^tone[1-5]:*$');\n\t\t\t\t\tconst colorBlind = new RegExp('tone[1-5]:*$');\n\t\t\t\t\tconst seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');\n\n\t\t\t\t\tconst emojiSort = (recents: string[]) => (a: { _id: string }, b: { _id: string }) => {\n\t\t\t\t\t\tlet idA = a._id;\n\t\t\t\t\t\tlet idB = a._id;\n\n\t\t\t\t\t\tif (recents.includes(a._id)) {\n\t\t\t\t\t\t\tidA = recents.indexOf(a._id) + idA;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (recents.includes(b._id)) {\n\t\t\t\t\t\t\tidB = recents.indexOf(b._id) + idB;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (idA < idB) {\n\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (idA > idB) {\n\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t};\n\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst key = `:${filter}`;\n\n\t\t\t\t\tconst recents = recentEmojis.map((item) => `:${item}:`);\n\n\t\t\t\t\tconst collection = emoji.list;\n\n\t\t\t\t\treturn Object.keys(collection)\n\t\t\t\t\t\t.map((_id) => {\n\t\t\t\t\t\t\tconst data = collection[key];\n\t\t\t\t\t\t\treturn { _id, data };\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t({ _id }) =>\n\t\t\t\t\t\t\t\tfilterRegex.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id)),\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.sort(emojiSort(recents))\n\t\t\t\t\t\t.slice(0, 10);\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async () => {\n\t\t\t\t\treturn [];\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => `${item._id}`,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupEmoji {...item} />,\n\t\t\t}),\n\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupSlashCommandProps>({\n\t\t\t\ttitle: t('Commands'),\n\t\t\t\ttrigger: '/',\n\t\t\t\tsuffix: ' ',\n\t\t\t\ttriggerAnywhere: false,\n\t\t\t\tdisabled: encrypted,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupSlashCommand {...item} />,\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\treturn Object.keys(slashCommands.commands)\n\t\t\t\t\t\t.map((command) => {\n\t\t\t\t\t\t\tconst item = slashCommands.commands[command];\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t_id: command,\n\t\t\t\t\t\t\t\tparams: item.params && i18n.exists(item.params) ? t(item.params) : (item.params ?? ''),\n\t\t\t\t\t\t\t\tdescription: item.description && i18n.exists(item.description) ? t(item.description) : item.description,\n\t\t\t\t\t\t\t\tpermission: item.permission,\n\t\t\t\t\t\t\t\t...(encrypted && { disabled: encrypted }),\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.filter((command) => {\n\t\t\t\t\t\t\tconst isMatch = command._id.indexOf(filter) > -1;\n\n\t\t\t\t\t\t\tif (!isMatch) {\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!command.permission) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn hasAtLeastOnePermission(command.permission, rid);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.sort((a, b) => a._id.localeCompare(b._id))\n\t\t\t\t\t\t.slice(0, 11);\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async () => [],\n\t\t\t}),\n\t\t\tcannedResponseEnabled &&\n\t\t\t\tisOmnichannel &&\n\t\t\t\tcreateMessageBoxPopupConfig<{\n\t\t\t\t\t_id: string;\n\t\t\t\t\ttext: string;\n\t\t\t\t\tshortcut: string;\n\t\t\t\t}>({\n\t\t\t\t\ttitle: t('Canned_Responses'),\n\t\t\t\t\ttrigger: '!',\n\t\t\t\t\tprefix: '',\n\t\t\t\t\ttriggerAnywhere: true,\n\t\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupCannedResponse {...item} />,\n\t\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\t\tconst exp = new RegExp(filter, 'i');\n\t\t\t\t\t\treturn CannedResponse.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshortcut: exp,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: 12,\n\t\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\t\tshortcut: -1,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t\t.map((record) => ({\n\t\t\t\t\t\t\t\t_id: record._id,\n\t\t\t\t\t\t\t\ttext: record.text,\n\t\t\t\t\t\t\t\tshortcut: record.shortcut,\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t},\n\t\t\t\t\tgetItemsFromServer: async () => [],\n\t\t\t\t\tgetValue: (item) => {\n\t\t\t\t\t\treturn item.text;\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig({\n\t\t\t\tmatchSelectorRegex: /(?:^)(\\/[\\w\\d\\S]+ )[^]*$/,\n\t\t\t\tpreview: true,\n\t\t\t\tgetItemsFromLocal: async ({ cmd, params, tmid }: { cmd: string; params: string; tmid: string }) => {\n\t\t\t\t\tconst result = await call({ cmd, params, msg: { rid, tmid } });\n\t\t\t\t\treturn (\n\t\t\t\t\t\tresult?.items.map((item) => ({\n\t\t\t\t\t\t\t_id: item.id,\n\t\t\t\t\t\t\tvalue: item.value,\n\t\t\t\t\t\t\ttype: item.type,\n\t\t\t\t\t\t})) ?? []\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t}),\n\t\t].filter(Boolean);\n\t}, [t, i18n, cannedResponseEnabled, isOmnichannel, recentEmojis, suggestionsCount, userSpotlight, rid, call, useEmoji, encrypted]);\n\n\treturn <ComposerPopupContext.Provider value={value} children={children} />;\n};\n\nexport default ComposerPopupProvider;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"ec0440512362f3b8c2f35650f5c95ca43cdc05a7"}
