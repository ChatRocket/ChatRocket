{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/viewLogs/ServerLogs.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/admin/viewLogs/ServerLogs.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/viewLogs/ServerLogs.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/viewLogs/ServerLogs.tsx","sourceRoot":"","sources":["client/views/admin/viewLogs/ServerLogs.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { Serialized } from '@rocket.chat/core-typings';\nimport { Box, Icon, Scrollable } from '@rocket.chat/fuselage';\nimport { useToastMessageDispatch, useEndpoint, useStream, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\n\nimport { ansispan } from './ansispan';\n\ntype StdOutLogEntry = {\n\tid: string;\n\tstring: string;\n\tts: Date;\n};\n\nconst compareEntries = (a: StdOutLogEntry, b: StdOutLogEntry): number => a.ts.getTime() - b.ts.getTime();\n\nconst unserializeEntry = ({ ts, ...entry }: Serialized<StdOutLogEntry>): StdOutLogEntry => ({\n\tts: new Date(ts),\n\t...entry,\n});\n\nconst ServerLogs = (): ReactElement => {\n\tconst [entries, setEntries] = useState<StdOutLogEntry[]>([]);\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst getStdoutQueue = useEndpoint('GET', '/v1/stdout.queue');\n\tconst subscribeToStdout = useStream('stdout');\n\n\tuseEffect(() => {\n\t\tconst fetchLines = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tconst { queue } = await getStdoutQueue(undefined);\n\t\t\t\tsetEntries(queue.map(unserializeEntry).sort(compareEntries));\n\t\t\t} catch (error: unknown) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t};\n\n\t\tfetchLines();\n\t}, [dispatchToastMessage, getStdoutQueue]);\n\n\tuseEffect(\n\t\t() =>\n\t\t\tsubscribeToStdout('stdout', (entry: StdOutLogEntry) => {\n\t\t\t\tsetEntries((entries) => [...entries, entry]);\n\t\t\t}),\n\t\t[subscribeToStdout],\n\t);\n\n\tconst t = useTranslation();\n\n\tconst wrapperRef = useRef<HTMLElement>();\n\tconst atBottomRef = useRef<boolean>(false);\n\n\tconst [newLogsVisible, setNewLogsVisible] = useState(false);\n\n\tconst isAtBottom = useCallback((scrollThreshold = 0) => {\n\t\tconst wrapper = wrapperRef.current;\n\n\t\tif (!wrapper) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (wrapper.scrollTop + scrollThreshold >= wrapper.scrollHeight - wrapper.clientHeight) {\n\t\t\tsetNewLogsVisible(false);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}, []);\n\n\tconst sendToBottom = useCallback(() => {\n\t\tconst wrapper = wrapperRef.current;\n\n\t\tif (!wrapper) {\n\t\t\treturn;\n\t\t}\n\n\t\twrapper.scrollTop = wrapper.scrollHeight - wrapper.clientHeight;\n\t\tsetNewLogsVisible(false);\n\t}, []);\n\n\tconst checkIfScrollIsAtBottom = useCallback(() => {\n\t\tatBottomRef.current = isAtBottom(100);\n\t}, [isAtBottom]);\n\n\tconst sendToBottomIfNecessary = useCallback(() => {\n\t\tif (atBottomRef.current === true && isAtBottom() !== true) {\n\t\t\tsendToBottom();\n\t\t} else if (atBottomRef.current === false) {\n\t\t\tsetNewLogsVisible(true);\n\t\t}\n\t}, [isAtBottom, sendToBottom]);\n\n\tuseEffect(() => {\n\t\tconst wrapper = wrapperRef.current;\n\n\t\tif (!wrapper) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (window.MutationObserver) {\n\t\t\tconst observer = new MutationObserver((mutations) => {\n\t\t\t\tmutations.forEach(() => {\n\t\t\t\t\tsendToBottomIfNecessary();\n\t\t\t\t});\n\t\t\t});\n\t\t\tobserver.observe(wrapper, { childList: true });\n\n\t\t\treturn (): void => {\n\t\t\t\tobserver.disconnect();\n\t\t\t};\n\t\t}\n\n\t\tconst handleSubtreeModified = (): void => {\n\t\t\tsendToBottomIfNecessary();\n\t\t};\n\t\twrapper.addEventListener('DOMSubtreeModified', handleSubtreeModified);\n\n\t\treturn (): void => {\n\t\t\twrapper.removeEventListener('DOMSubtreeModified', handleSubtreeModified);\n\t\t};\n\t}, [sendToBottomIfNecessary]);\n\n\tuseEffect(() => {\n\t\tconst handleWindowResize = (): void => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tsendToBottomIfNecessary();\n\t\t\t}, 100);\n\t\t};\n\n\t\twindow.addEventListener('resize', handleWindowResize);\n\n\t\treturn (): void => {\n\t\t\twindow.removeEventListener('resize', handleWindowResize);\n\t\t};\n\t}, [sendToBottomIfNecessary]);\n\n\tconst handleWheel = useCallback(() => {\n\t\tatBottomRef.current = false;\n\t\tsetTimeout(() => {\n\t\t\tcheckIfScrollIsAtBottom();\n\t\t}, 100);\n\t}, [checkIfScrollIsAtBottom]);\n\n\tconst handleTouchStart = (): void => {\n\t\tatBottomRef.current = false;\n\t};\n\n\tconst handleTouchEnd = useCallback(() => {\n\t\tsetTimeout(() => {\n\t\t\tcheckIfScrollIsAtBottom();\n\t\t}, 100);\n\t}, [checkIfScrollIsAtBottom]);\n\n\tconst handleScroll = useCallback(() => {\n\t\tatBottomRef.current = false;\n\t\tsetTimeout(() => {\n\t\t\tcheckIfScrollIsAtBottom();\n\t\t}, 100);\n\t}, [checkIfScrollIsAtBottom]);\n\n\tconst handleClick = useCallback(() => {\n\t\tatBottomRef.current = true;\n\t\tsendToBottomIfNecessary();\n\t}, [sendToBottomIfNecessary]);\n\n\treturn (\n\t\t<Box width='full' height='full' overflow='hidden' position='relative' display='flex' mbe={8}>\n\t\t\t<Scrollable vertical>\n\t\t\t\t<Box\n\t\t\t\t\tref={wrapperRef}\n\t\t\t\t\tdisplay='flex'\n\t\t\t\t\tflexDirection='column'\n\t\t\t\t\tpadding={8}\n\t\t\t\t\tflexGrow={1}\n\t\t\t\t\tfontFamily='mono'\n\t\t\t\t\tcolor='default'\n\t\t\t\t\tbg='neutral'\n\t\t\t\t\tstyle={{ wordBreak: 'break-all' }}\n\t\t\t\t\tonWheel={handleWheel}\n\t\t\t\t\tonTouchStart={handleTouchStart}\n\t\t\t\t\tonTouchEnd={handleTouchEnd}\n\t\t\t\t\tonScroll={handleScroll}\n\t\t\t\t\tborderRadius='x4'\n\t\t\t\t>\n\t\t\t\t\t{entries.sort(compareEntries).map(({ string }, i) => (\n\t\t\t\t\t\t<span key={i} dangerouslySetInnerHTML={{ __html: ansispan(string) }} />\n\t\t\t\t\t))}\n\t\t\t\t</Box>\n\t\t\t</Scrollable>\n\t\t\t<Box\n\t\t\t\trole='button'\n\t\t\t\tposition='absolute'\n\t\t\t\tdisplay='flex'\n\t\t\t\tjustifyContent='center'\n\t\t\t\tinsetBlockEnd={8}\n\t\t\t\tinsetInlineStart='50%'\n\t\t\t\twidth='x132'\n\t\t\t\theight='x32'\n\t\t\t\tmarginInline='neg-x64'\n\t\t\t\tpaddingBlock={8}\n\t\t\t\tfontScale='c2'\n\t\t\t\tborderRadius='full'\n\t\t\t\televation='1'\n\t\t\t\tcolor='default'\n\t\t\t\tbg='light'\n\t\t\t\tonClick={handleClick}\n\t\t\t\ttextAlign='center'\n\t\t\t\tstyle={{\n\t\t\t\t\tcursor: 'pointer',\n\t\t\t\t\ttransition: 'transform 0.3s ease-out',\n\t\t\t\t\ttransform: newLogsVisible ? 'translateY(0)' : 'translateY(150%)',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Icon name='jump' size='x16' /> {t('New_logs')}\n\t\t\t</Box>\n\t\t</Box>\n\t);\n};\n\nexport default ServerLogs;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/viewLogs/ServerLogs.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/admin/viewLogs/ServerLogs.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/viewLogs/ServerLogs.tsx","sourceRoot":"","sources":["client/views/admin/viewLogs/ServerLogs.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { Serialized } from '@rocket.chat/core-typings';\nimport { Box, Icon, Scrollable } from '@rocket.chat/fuselage';\nimport { useToastMessageDispatch, useEndpoint, useStream, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\n\nimport { ansispan } from './ansispan';\n\ntype StdOutLogEntry = {\n\tid: string;\n\tstring: string;\n\tts: Date;\n};\n\nconst compareEntries = (a: StdOutLogEntry, b: StdOutLogEntry): number => a.ts.getTime() - b.ts.getTime();\n\nconst unserializeEntry = ({ ts, ...entry }: Serialized<StdOutLogEntry>): StdOutLogEntry => ({\n\tts: new Date(ts),\n\t...entry,\n});\n\nconst ServerLogs = (): ReactElement => {\n\tconst [entries, setEntries] = useState<StdOutLogEntry[]>([]);\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst getStdoutQueue = useEndpoint('GET', '/v1/stdout.queue');\n\tconst subscribeToStdout = useStream('stdout');\n\n\tuseEffect(() => {\n\t\tconst fetchLines = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tconst { queue } = await getStdoutQueue(undefined);\n\t\t\t\tsetEntries(queue.map(unserializeEntry).sort(compareEntries));\n\t\t\t} catch (error: unknown) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t};\n\n\t\tfetchLines();\n\t}, [dispatchToastMessage, getStdoutQueue]);\n\n\tuseEffect(\n\t\t() =>\n\t\t\tsubscribeToStdout('stdout', (entry: StdOutLogEntry) => {\n\t\t\t\tsetEntries((entries) => [...entries, entry]);\n\t\t\t}),\n\t\t[subscribeToStdout],\n\t);\n\n\tconst t = useTranslation();\n\n\tconst wrapperRef = useRef<HTMLElement>();\n\tconst atBottomRef = useRef<boolean>(false);\n\n\tconst [newLogsVisible, setNewLogsVisible] = useState(false);\n\n\tconst isAtBottom = useCallback((scrollThreshold = 0) => {\n\t\tconst wrapper = wrapperRef.current;\n\n\t\tif (!wrapper) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (wrapper.scrollTop + scrollThreshold >= wrapper.scrollHeight - wrapper.clientHeight) {\n\t\t\tsetNewLogsVisible(false);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}, []);\n\n\tconst sendToBottom = useCallback(() => {\n\t\tconst wrapper = wrapperRef.current;\n\n\t\tif (!wrapper) {\n\t\t\treturn;\n\t\t}\n\n\t\twrapper.scrollTop = wrapper.scrollHeight - wrapper.clientHeight;\n\t\tsetNewLogsVisible(false);\n\t}, []);\n\n\tconst checkIfScrollIsAtBottom = useCallback(() => {\n\t\tatBottomRef.current = isAtBottom(100);\n\t}, [isAtBottom]);\n\n\tconst sendToBottomIfNecessary = useCallback(() => {\n\t\tif (atBottomRef.current === true && isAtBottom() !== true) {\n\t\t\tsendToBottom();\n\t\t} else if (atBottomRef.current === false) {\n\t\t\tsetNewLogsVisible(true);\n\t\t}\n\t}, [isAtBottom, sendToBottom]);\n\n\tuseEffect(() => {\n\t\tconst wrapper = wrapperRef.current;\n\n\t\tif (!wrapper) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (window.MutationObserver) {\n\t\t\tconst observer = new MutationObserver((mutations) => {\n\t\t\t\tmutations.forEach(() => {\n\t\t\t\t\tsendToBottomIfNecessary();\n\t\t\t\t});\n\t\t\t});\n\t\t\tobserver.observe(wrapper, { childList: true });\n\n\t\t\treturn (): void => {\n\t\t\t\tobserver.disconnect();\n\t\t\t};\n\t\t}\n\n\t\tconst handleSubtreeModified = (): void => {\n\t\t\tsendToBottomIfNecessary();\n\t\t};\n\t\twrapper.addEventListener('DOMSubtreeModified', handleSubtreeModified);\n\n\t\treturn (): void => {\n\t\t\twrapper.removeEventListener('DOMSubtreeModified', handleSubtreeModified);\n\t\t};\n\t}, [sendToBottomIfNecessary]);\n\n\tuseEffect(() => {\n\t\tconst handleWindowResize = (): void => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tsendToBottomIfNecessary();\n\t\t\t}, 100);\n\t\t};\n\n\t\twindow.addEventListener('resize', handleWindowResize);\n\n\t\treturn (): void => {\n\t\t\twindow.removeEventListener('resize', handleWindowResize);\n\t\t};\n\t}, [sendToBottomIfNecessary]);\n\n\tconst handleWheel = useCallback(() => {\n\t\tatBottomRef.current = false;\n\t\tsetTimeout(() => {\n\t\t\tcheckIfScrollIsAtBottom();\n\t\t}, 100);\n\t}, [checkIfScrollIsAtBottom]);\n\n\tconst handleTouchStart = (): void => {\n\t\tatBottomRef.current = false;\n\t};\n\n\tconst handleTouchEnd = useCallback(() => {\n\t\tsetTimeout(() => {\n\t\t\tcheckIfScrollIsAtBottom();\n\t\t}, 100);\n\t}, [checkIfScrollIsAtBottom]);\n\n\tconst handleScroll = useCallback(() => {\n\t\tatBottomRef.current = false;\n\t\tsetTimeout(() => {\n\t\t\tcheckIfScrollIsAtBottom();\n\t\t}, 100);\n\t}, [checkIfScrollIsAtBottom]);\n\n\tconst handleClick = useCallback(() => {\n\t\tatBottomRef.current = true;\n\t\tsendToBottomIfNecessary();\n\t}, [sendToBottomIfNecessary]);\n\n\treturn (\n\t\t<Box width='full' height='full' overflow='hidden' position='relative' display='flex' mbe={8}>\n\t\t\t<Scrollable vertical>\n\t\t\t\t<Box\n\t\t\t\t\tref={wrapperRef}\n\t\t\t\t\tdisplay='flex'\n\t\t\t\t\tflexDirection='column'\n\t\t\t\t\tpadding={8}\n\t\t\t\t\tflexGrow={1}\n\t\t\t\t\tfontFamily='mono'\n\t\t\t\t\tcolor='default'\n\t\t\t\t\tbg='neutral'\n\t\t\t\t\tstyle={{ wordBreak: 'break-all' }}\n\t\t\t\t\tonWheel={handleWheel}\n\t\t\t\t\tonTouchStart={handleTouchStart}\n\t\t\t\t\tonTouchEnd={handleTouchEnd}\n\t\t\t\t\tonScroll={handleScroll}\n\t\t\t\t\tborderRadius='x4'\n\t\t\t\t>\n\t\t\t\t\t{entries.sort(compareEntries).map(({ string }, i) => (\n\t\t\t\t\t\t<span key={i} dangerouslySetInnerHTML={{ __html: ansispan(string) }} />\n\t\t\t\t\t))}\n\t\t\t\t</Box>\n\t\t\t</Scrollable>\n\t\t\t<Box\n\t\t\t\trole='button'\n\t\t\t\tposition='absolute'\n\t\t\t\tdisplay='flex'\n\t\t\t\tjustifyContent='center'\n\t\t\t\tinsetBlockEnd={8}\n\t\t\t\tinsetInlineStart='50%'\n\t\t\t\twidth='x132'\n\t\t\t\theight='x32'\n\t\t\t\tmarginInline='neg-x64'\n\t\t\t\tpaddingBlock={8}\n\t\t\t\tfontScale='c2'\n\t\t\t\tborderRadius='full'\n\t\t\t\televation='1'\n\t\t\t\tcolor='default'\n\t\t\t\tbg='light'\n\t\t\t\tonClick={handleClick}\n\t\t\t\ttextAlign='center'\n\t\t\t\tstyle={{\n\t\t\t\t\tcursor: 'pointer',\n\t\t\t\t\ttransition: 'transform 0.3s ease-out',\n\t\t\t\t\ttransform: newLogsVisible ? 'translateY(0)' : 'translateY(150%)',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Icon name='jump' size='x16' /> {t('New_logs')}\n\t\t\t</Box>\n\t\t</Box>\n\t);\n};\n\nexport default ServerLogs;\n"]}}},"code":"const _excluded = [\"ts\"];\nlet _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n}, 0);\nlet _objectWithoutProperties;\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default(v) {\n    _objectWithoutProperties = v;\n  }\n}, 1);\nlet Box, Icon, Scrollable;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Box(v) {\n    Box = v;\n  },\n  Icon(v) {\n    Icon = v;\n  },\n  Scrollable(v) {\n    Scrollable = v;\n  }\n}, 0);\nlet useToastMessageDispatch, useEndpoint, useStream, useTranslation;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useToastMessageDispatch(v) {\n    useToastMessageDispatch = v;\n  },\n  useEndpoint(v) {\n    useEndpoint = v;\n  },\n  useStream(v) {\n    useStream = v;\n  },\n  useTranslation(v) {\n    useTranslation = v;\n  }\n}, 1);\nlet React, useEffect, useRef, useState, useCallback;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n  useEffect(v) {\n    useEffect = v;\n  },\n  useRef(v) {\n    useRef = v;\n  },\n  useState(v) {\n    useState = v;\n  },\n  useCallback(v) {\n    useCallback = v;\n  }\n}, 2);\nlet ansispan;\nmodule.link(\"./ansispan\", {\n  ansispan(v) {\n    ansispan = v;\n  }\n}, 3);\nconst compareEntries = (a, b) => a.ts.getTime() - b.ts.getTime();\nconst unserializeEntry = _ref => {\n  let {\n      ts\n    } = _ref,\n    entry = _objectWithoutProperties(_ref, _excluded);\n  return _objectSpread({\n    ts: new Date(ts)\n  }, entry);\n};\nconst ServerLogs = () => {\n  const [entries, setEntries] = useState([]);\n  const dispatchToastMessage = useToastMessageDispatch();\n  const getStdoutQueue = useEndpoint('GET', '/v1/stdout.queue');\n  const subscribeToStdout = useStream('stdout');\n  useEffect(() => {\n    const fetchLines = async () => {\n      try {\n        const {\n          queue\n        } = await getStdoutQueue(undefined);\n        setEntries(queue.map(unserializeEntry).sort(compareEntries));\n      } catch (error) {\n        dispatchToastMessage({\n          type: 'error',\n          message: error\n        });\n      }\n    };\n    fetchLines();\n  }, [dispatchToastMessage, getStdoutQueue]);\n  useEffect(() => subscribeToStdout('stdout', entry => {\n    setEntries(entries => [...entries, entry]);\n  }), [subscribeToStdout]);\n  const t = useTranslation();\n  const wrapperRef = useRef();\n  const atBottomRef = useRef(false);\n  const [newLogsVisible, setNewLogsVisible] = useState(false);\n  const isAtBottom = useCallback(function () {\n    let scrollThreshold = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    const wrapper = wrapperRef.current;\n    if (!wrapper) {\n      return false;\n    }\n    if (wrapper.scrollTop + scrollThreshold >= wrapper.scrollHeight - wrapper.clientHeight) {\n      setNewLogsVisible(false);\n      return true;\n    }\n    return false;\n  }, []);\n  const sendToBottom = useCallback(() => {\n    const wrapper = wrapperRef.current;\n    if (!wrapper) {\n      return;\n    }\n    wrapper.scrollTop = wrapper.scrollHeight - wrapper.clientHeight;\n    setNewLogsVisible(false);\n  }, []);\n  const checkIfScrollIsAtBottom = useCallback(() => {\n    atBottomRef.current = isAtBottom(100);\n  }, [isAtBottom]);\n  const sendToBottomIfNecessary = useCallback(() => {\n    if (atBottomRef.current === true && isAtBottom() !== true) {\n      sendToBottom();\n    } else if (atBottomRef.current === false) {\n      setNewLogsVisible(true);\n    }\n  }, [isAtBottom, sendToBottom]);\n  useEffect(() => {\n    const wrapper = wrapperRef.current;\n    if (!wrapper) {\n      return;\n    }\n    if (window.MutationObserver) {\n      const observer = new MutationObserver(mutations => {\n        mutations.forEach(() => {\n          sendToBottomIfNecessary();\n        });\n      });\n      observer.observe(wrapper, {\n        childList: true\n      });\n      return () => {\n        observer.disconnect();\n      };\n    }\n    const handleSubtreeModified = () => {\n      sendToBottomIfNecessary();\n    };\n    wrapper.addEventListener('DOMSubtreeModified', handleSubtreeModified);\n    return () => {\n      wrapper.removeEventListener('DOMSubtreeModified', handleSubtreeModified);\n    };\n  }, [sendToBottomIfNecessary]);\n  useEffect(() => {\n    const handleWindowResize = () => {\n      setTimeout(() => {\n        sendToBottomIfNecessary();\n      }, 100);\n    };\n    window.addEventListener('resize', handleWindowResize);\n    return () => {\n      window.removeEventListener('resize', handleWindowResize);\n    };\n  }, [sendToBottomIfNecessary]);\n  const handleWheel = useCallback(() => {\n    atBottomRef.current = false;\n    setTimeout(() => {\n      checkIfScrollIsAtBottom();\n    }, 100);\n  }, [checkIfScrollIsAtBottom]);\n  const handleTouchStart = () => {\n    atBottomRef.current = false;\n  };\n  const handleTouchEnd = useCallback(() => {\n    setTimeout(() => {\n      checkIfScrollIsAtBottom();\n    }, 100);\n  }, [checkIfScrollIsAtBottom]);\n  const handleScroll = useCallback(() => {\n    atBottomRef.current = false;\n    setTimeout(() => {\n      checkIfScrollIsAtBottom();\n    }, 100);\n  }, [checkIfScrollIsAtBottom]);\n  const handleClick = useCallback(() => {\n    atBottomRef.current = true;\n    sendToBottomIfNecessary();\n  }, [sendToBottomIfNecessary]);\n  return /*#__PURE__*/React.createElement(Box, {\n    width: \"full\",\n    height: \"full\",\n    overflow: \"hidden\",\n    position: \"relative\",\n    display: \"flex\",\n    mbe: 8\n  }, /*#__PURE__*/React.createElement(Scrollable, {\n    vertical: true\n  }, /*#__PURE__*/React.createElement(Box, {\n    ref: wrapperRef,\n    display: \"flex\",\n    flexDirection: \"column\",\n    padding: 8,\n    flexGrow: 1,\n    fontFamily: \"mono\",\n    color: \"default\",\n    bg: \"neutral\",\n    style: {\n      wordBreak: 'break-all'\n    },\n    onWheel: handleWheel,\n    onTouchStart: handleTouchStart,\n    onTouchEnd: handleTouchEnd,\n    onScroll: handleScroll,\n    borderRadius: \"x4\"\n  }, entries.sort(compareEntries).map((_ref2, i) => {\n    let {\n      string\n    } = _ref2;\n    return /*#__PURE__*/React.createElement(\"span\", {\n      key: i,\n      dangerouslySetInnerHTML: {\n        __html: ansispan(string)\n      }\n    });\n  }))), /*#__PURE__*/React.createElement(Box, {\n    role: \"button\",\n    position: \"absolute\",\n    display: \"flex\",\n    justifyContent: \"center\",\n    insetBlockEnd: 8,\n    insetInlineStart: \"50%\",\n    width: \"x132\",\n    height: \"x32\",\n    marginInline: \"neg-x64\",\n    paddingBlock: 8,\n    fontScale: \"c2\",\n    borderRadius: \"full\",\n    elevation: \"1\",\n    color: \"default\",\n    bg: \"light\",\n    onClick: handleClick,\n    textAlign: \"center\",\n    style: {\n      cursor: 'pointer',\n      transition: 'transform 0.3s ease-out',\n      transform: newLogsVisible ? 'translateY(0)' : 'translateY(150%)'\n    }\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"jump\",\n    size: \"x16\"\n  }), \" \", t('New_logs')));\n};\nmodule.exportDefault(ServerLogs);","map":{"version":3,"names":["_objectSpread","module","link","default","v","_objectWithoutProperties","Box","Icon","Scrollable","useToastMessageDispatch","useEndpoint","useStream","useTranslation","React","useEffect","useRef","useState","useCallback","ansispan","compareEntries","a","b","ts","getTime","unserializeEntry","_ref","entry","_excluded","Date","ServerLogs","entries","setEntries","dispatchToastMessage","getStdoutQueue","subscribeToStdout","fetchLines","queue","undefined","map","sort","error","type","message","t","wrapperRef","atBottomRef","newLogsVisible","setNewLogsVisible","isAtBottom","scrollThreshold","arguments","length","wrapper","current","scrollTop","scrollHeight","clientHeight","sendToBottom","checkIfScrollIsAtBottom","sendToBottomIfNecessary","window","MutationObserver","observer","mutations","forEach","observe","childList","disconnect","handleSubtreeModified","addEventListener","removeEventListener","handleWindowResize","setTimeout","handleWheel","handleTouchStart","handleTouchEnd","handleScroll","handleClick","createElement","width","height","overflow","position","display","mbe","vertical","ref","flexDirection","padding","flexGrow","fontFamily","color","bg","style","wordBreak","onWheel","onTouchStart","onTouchEnd","onScroll","borderRadius","_ref2","i","string","key","dangerouslySetInnerHTML","__html","role","justifyContent","insetBlockEnd","insetInlineStart","marginInline","paddingBlock","fontScale","elevation","onClick","textAlign","cursor","transition","transform","name","size","exportDefault"],"sources":["client/views/admin/viewLogs/ServerLogs.tsx"],"sourcesContent":["import type { Serialized } from '@rocket.chat/core-typings';\nimport { Box, Icon, Scrollable } from '@rocket.chat/fuselage';\nimport { useToastMessageDispatch, useEndpoint, useStream, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\n\nimport { ansispan } from './ansispan';\n\ntype StdOutLogEntry = {\n\tid: string;\n\tstring: string;\n\tts: Date;\n};\n\nconst compareEntries = (a: StdOutLogEntry, b: StdOutLogEntry): number => a.ts.getTime() - b.ts.getTime();\n\nconst unserializeEntry = ({ ts, ...entry }: Serialized<StdOutLogEntry>): StdOutLogEntry => ({\n\tts: new Date(ts),\n\t...entry,\n});\n\nconst ServerLogs = (): ReactElement => {\n\tconst [entries, setEntries] = useState<StdOutLogEntry[]>([]);\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst getStdoutQueue = useEndpoint('GET', '/v1/stdout.queue');\n\tconst subscribeToStdout = useStream('stdout');\n\n\tuseEffect(() => {\n\t\tconst fetchLines = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tconst { queue } = await getStdoutQueue(undefined);\n\t\t\t\tsetEntries(queue.map(unserializeEntry).sort(compareEntries));\n\t\t\t} catch (error: unknown) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t};\n\n\t\tfetchLines();\n\t}, [dispatchToastMessage, getStdoutQueue]);\n\n\tuseEffect(\n\t\t() =>\n\t\t\tsubscribeToStdout('stdout', (entry: StdOutLogEntry) => {\n\t\t\t\tsetEntries((entries) => [...entries, entry]);\n\t\t\t}),\n\t\t[subscribeToStdout],\n\t);\n\n\tconst t = useTranslation();\n\n\tconst wrapperRef = useRef<HTMLElement>();\n\tconst atBottomRef = useRef<boolean>(false);\n\n\tconst [newLogsVisible, setNewLogsVisible] = useState(false);\n\n\tconst isAtBottom = useCallback((scrollThreshold = 0) => {\n\t\tconst wrapper = wrapperRef.current;\n\n\t\tif (!wrapper) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (wrapper.scrollTop + scrollThreshold >= wrapper.scrollHeight - wrapper.clientHeight) {\n\t\t\tsetNewLogsVisible(false);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}, []);\n\n\tconst sendToBottom = useCallback(() => {\n\t\tconst wrapper = wrapperRef.current;\n\n\t\tif (!wrapper) {\n\t\t\treturn;\n\t\t}\n\n\t\twrapper.scrollTop = wrapper.scrollHeight - wrapper.clientHeight;\n\t\tsetNewLogsVisible(false);\n\t}, []);\n\n\tconst checkIfScrollIsAtBottom = useCallback(() => {\n\t\tatBottomRef.current = isAtBottom(100);\n\t}, [isAtBottom]);\n\n\tconst sendToBottomIfNecessary = useCallback(() => {\n\t\tif (atBottomRef.current === true && isAtBottom() !== true) {\n\t\t\tsendToBottom();\n\t\t} else if (atBottomRef.current === false) {\n\t\t\tsetNewLogsVisible(true);\n\t\t}\n\t}, [isAtBottom, sendToBottom]);\n\n\tuseEffect(() => {\n\t\tconst wrapper = wrapperRef.current;\n\n\t\tif (!wrapper) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (window.MutationObserver) {\n\t\t\tconst observer = new MutationObserver((mutations) => {\n\t\t\t\tmutations.forEach(() => {\n\t\t\t\t\tsendToBottomIfNecessary();\n\t\t\t\t});\n\t\t\t});\n\t\t\tobserver.observe(wrapper, { childList: true });\n\n\t\t\treturn (): void => {\n\t\t\t\tobserver.disconnect();\n\t\t\t};\n\t\t}\n\n\t\tconst handleSubtreeModified = (): void => {\n\t\t\tsendToBottomIfNecessary();\n\t\t};\n\t\twrapper.addEventListener('DOMSubtreeModified', handleSubtreeModified);\n\n\t\treturn (): void => {\n\t\t\twrapper.removeEventListener('DOMSubtreeModified', handleSubtreeModified);\n\t\t};\n\t}, [sendToBottomIfNecessary]);\n\n\tuseEffect(() => {\n\t\tconst handleWindowResize = (): void => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tsendToBottomIfNecessary();\n\t\t\t}, 100);\n\t\t};\n\n\t\twindow.addEventListener('resize', handleWindowResize);\n\n\t\treturn (): void => {\n\t\t\twindow.removeEventListener('resize', handleWindowResize);\n\t\t};\n\t}, [sendToBottomIfNecessary]);\n\n\tconst handleWheel = useCallback(() => {\n\t\tatBottomRef.current = false;\n\t\tsetTimeout(() => {\n\t\t\tcheckIfScrollIsAtBottom();\n\t\t}, 100);\n\t}, [checkIfScrollIsAtBottom]);\n\n\tconst handleTouchStart = (): void => {\n\t\tatBottomRef.current = false;\n\t};\n\n\tconst handleTouchEnd = useCallback(() => {\n\t\tsetTimeout(() => {\n\t\t\tcheckIfScrollIsAtBottom();\n\t\t}, 100);\n\t}, [checkIfScrollIsAtBottom]);\n\n\tconst handleScroll = useCallback(() => {\n\t\tatBottomRef.current = false;\n\t\tsetTimeout(() => {\n\t\t\tcheckIfScrollIsAtBottom();\n\t\t}, 100);\n\t}, [checkIfScrollIsAtBottom]);\n\n\tconst handleClick = useCallback(() => {\n\t\tatBottomRef.current = true;\n\t\tsendToBottomIfNecessary();\n\t}, [sendToBottomIfNecessary]);\n\n\treturn (\n\t\t<Box width='full' height='full' overflow='hidden' position='relative' display='flex' mbe={8}>\n\t\t\t<Scrollable vertical>\n\t\t\t\t<Box\n\t\t\t\t\tref={wrapperRef}\n\t\t\t\t\tdisplay='flex'\n\t\t\t\t\tflexDirection='column'\n\t\t\t\t\tpadding={8}\n\t\t\t\t\tflexGrow={1}\n\t\t\t\t\tfontFamily='mono'\n\t\t\t\t\tcolor='default'\n\t\t\t\t\tbg='neutral'\n\t\t\t\t\tstyle={{ wordBreak: 'break-all' }}\n\t\t\t\t\tonWheel={handleWheel}\n\t\t\t\t\tonTouchStart={handleTouchStart}\n\t\t\t\t\tonTouchEnd={handleTouchEnd}\n\t\t\t\t\tonScroll={handleScroll}\n\t\t\t\t\tborderRadius='x4'\n\t\t\t\t>\n\t\t\t\t\t{entries.sort(compareEntries).map(({ string }, i) => (\n\t\t\t\t\t\t<span key={i} dangerouslySetInnerHTML={{ __html: ansispan(string) }} />\n\t\t\t\t\t))}\n\t\t\t\t</Box>\n\t\t\t</Scrollable>\n\t\t\t<Box\n\t\t\t\trole='button'\n\t\t\t\tposition='absolute'\n\t\t\t\tdisplay='flex'\n\t\t\t\tjustifyContent='center'\n\t\t\t\tinsetBlockEnd={8}\n\t\t\t\tinsetInlineStart='50%'\n\t\t\t\twidth='x132'\n\t\t\t\theight='x32'\n\t\t\t\tmarginInline='neg-x64'\n\t\t\t\tpaddingBlock={8}\n\t\t\t\tfontScale='c2'\n\t\t\t\tborderRadius='full'\n\t\t\t\televation='1'\n\t\t\t\tcolor='default'\n\t\t\t\tbg='light'\n\t\t\t\tonClick={handleClick}\n\t\t\t\ttextAlign='center'\n\t\t\t\tstyle={{\n\t\t\t\t\tcursor: 'pointer',\n\t\t\t\t\ttransition: 'transform 0.3s ease-out',\n\t\t\t\t\ttransform: newLogsVisible ? 'translateY(0)' : 'translateY(150%)',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Icon name='jump' size='x16' /> {t('New_logs')}\n\t\t\t</Box>\n\t\t</Box>\n\t);\n};\n\nexport default ServerLogs;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"0e74bf3a23e38e0f942f311039220469f45c1132"}
