{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/settings/EditableSettingsProvider.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/admin/settings/EditableSettingsProvider.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/settings/EditableSettingsProvider.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/settings/EditableSettingsProvider.tsx","sourceRoot":"","sources":["client/views/admin/settings/EditableSettingsProvider.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { SettingId, GroupId, ISetting, TabId } from '@rocket.chat/core-typings';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { SettingsContextQuery } from '@rocket.chat/ui-contexts';\nimport { useSettings } from '@rocket.chat/ui-contexts';\nimport { Mongo } from 'meteor/mongo';\nimport { Tracker } from 'meteor/tracker';\nimport type { FilterOperators } from 'mongodb';\nimport type { MutableRefObject, ReactNode } from 'react';\nimport React, { useEffect, useMemo, useRef } from 'react';\n\nimport { useIsEnterprise } from '../../../hooks/useIsEnterprise';\nimport { createReactiveSubscriptionFactory } from '../../../lib/createReactiveSubscriptionFactory';\nimport type { EditableSetting, EditableSettingsContextValue } from '../EditableSettingsContext';\nimport { EditableSettingsContext } from '../EditableSettingsContext';\n\nconst defaultQuery: SettingsContextQuery = {};\n\ntype EditableSettingsProviderProps = {\n\tchildren?: ReactNode;\n\tquery?: SettingsContextQuery;\n};\n\nconst EditableSettingsProvider = ({ children, query = defaultQuery }: EditableSettingsProviderProps) => {\n\tconst settingsCollectionRef = useRef<Mongo.Collection<EditableSetting>>(null) as MutableRefObject<Mongo.Collection<EditableSetting>>;\n\tconst persistedSettings = useSettings(query);\n\n\tconst getSettingsCollection = useMutableCallback(() => {\n\t\tif (!settingsCollectionRef.current) {\n\t\t\tsettingsCollectionRef.current = new Mongo.Collection<any>(null);\n\t\t}\n\n\t\treturn settingsCollectionRef.current;\n\t}) as () => Mongo.Collection<EditableSetting>;\n\n\tuseEffect(() => {\n\t\tconst settingsCollection = getSettingsCollection();\n\n\t\tsettingsCollection.remove({ _id: { $nin: persistedSettings.map(({ _id }) => _id) } });\n\t\tfor (const { _id, ...fields } of persistedSettings) {\n\t\t\tsettingsCollection.upsert(_id, { $set: { ...fields }, $unset: { changed: true } });\n\t\t}\n\t}, [getSettingsCollection, persistedSettings]);\n\n\tconst queryEditableSetting = useMemo(() => {\n\t\tconst validateSettingQueries = (\n\t\t\tquery: undefined | string | FilterOperators<ISetting> | FilterOperators<ISetting>[],\n\t\t\tsettingsCollection: Mongo.Collection<EditableSetting>,\n\t\t): boolean => {\n\t\t\tif (!query) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst queries = [].concat(typeof query === 'string' ? JSON.parse(query) : query);\n\t\t\treturn queries.every((query) => settingsCollection.find(query).count() > 0);\n\t\t};\n\n\t\treturn createReactiveSubscriptionFactory((_id: SettingId): EditableSetting | undefined => {\n\t\t\tconst settingsCollection = getSettingsCollection();\n\t\t\tconst editableSetting = settingsCollection.findOne(_id);\n\n\t\t\tif (!editableSetting) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t...editableSetting,\n\t\t\t\tdisabled: editableSetting.blocked || !validateSettingQueries(editableSetting.enableQuery, settingsCollection),\n\t\t\t\tinvisible: !validateSettingQueries(editableSetting.displayQuery, settingsCollection),\n\t\t\t};\n\t\t});\n\t}, [getSettingsCollection]);\n\n\tconst queryEditableSettings = useMemo(\n\t\t() =>\n\t\t\tcreateReactiveSubscriptionFactory((query = {}) =>\n\t\t\t\tgetSettingsCollection()\n\t\t\t\t\t.find(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t...('_id' in query && { _id: { $in: query._id } }),\n\t\t\t\t\t\t\t...('group' in query && { group: query.group }),\n\t\t\t\t\t\t\t...('changed' in query && { changed: query.changed }),\n\t\t\t\t\t\t\t$and: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t...('section' in query &&\n\t\t\t\t\t\t\t\t\t\t(query.section\n\t\t\t\t\t\t\t\t\t\t\t? { section: query.section }\n\t\t\t\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t$or: [{ section: { $exists: false } }, { section: '' }],\n\t\t\t\t\t\t\t\t\t\t\t  })),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t...('tab' in query &&\n\t\t\t\t\t\t\t\t\t\t(query.tab\n\t\t\t\t\t\t\t\t\t\t\t? { tab: query.tab }\n\t\t\t\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t$or: [{ tab: { $exists: false } }, { tab: '' }],\n\t\t\t\t\t\t\t\t\t\t\t  })),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\tsection: 1,\n\t\t\t\t\t\t\t\tsorter: 1,\n\t\t\t\t\t\t\t\ti18nLabel: 1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t)\n\t\t\t\t\t.fetch(),\n\t\t\t),\n\t\t[getSettingsCollection],\n\t);\n\n\tconst queryGroupSections = useMemo(\n\t\t() =>\n\t\t\tcreateReactiveSubscriptionFactory((_id: GroupId, tab?: TabId) =>\n\t\t\t\tArray.from(\n\t\t\t\t\tnew Set(\n\t\t\t\t\t\tgetSettingsCollection()\n\t\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tgroup: _id,\n\t\t\t\t\t\t\t\t\t...(tab !== undefined\n\t\t\t\t\t\t\t\t\t\t? { tab }\n\t\t\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\t\t\t$or: [{ tab: { $exists: false } }, { tab: '' }],\n\t\t\t\t\t\t\t\t\t\t  }),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfields: {\n\t\t\t\t\t\t\t\t\t\tsection: 1,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\t\t\tsorter: 1,\n\t\t\t\t\t\t\t\t\t\tsection: 1,\n\t\t\t\t\t\t\t\t\t\ti18nLabel: 1,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t\t.map(({ section }) => section || ''),\n\t\t\t\t\t),\n\t\t\t\t),\n\t\t\t),\n\t\t[getSettingsCollection],\n\t);\n\n\tconst queryGroupTabs = useMemo(\n\t\t() =>\n\t\t\tcreateReactiveSubscriptionFactory((_id: GroupId) =>\n\t\t\t\tArray.from(\n\t\t\t\t\tnew Set(\n\t\t\t\t\t\tgetSettingsCollection()\n\t\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tgroup: _id,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfields: {\n\t\t\t\t\t\t\t\t\t\ttab: 1,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\t\t\tsorter: 1,\n\t\t\t\t\t\t\t\t\t\ttab: 1,\n\t\t\t\t\t\t\t\t\t\ti18nLabel: 1,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t\t.map(({ tab }) => tab || ''),\n\t\t\t\t\t),\n\t\t\t\t),\n\t\t\t),\n\t\t[getSettingsCollection],\n\t);\n\n\tconst dispatch = useMutableCallback((changes: Partial<EditableSetting>[]): void => {\n\t\tfor (const { _id, ...data } of changes) {\n\t\t\tif (!_id) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tgetSettingsCollection().update(_id, { $set: data });\n\t\t}\n\t\tTracker.flush();\n\t});\n\n\tconst { data } = useIsEnterprise();\n\n\tconst isEnterprise = data?.isEnterprise ?? false;\n\n\tconst contextValue = useMemo<EditableSettingsContextValue>(\n\t\t() => ({\n\t\t\tqueryEditableSetting,\n\t\t\tqueryEditableSettings,\n\t\t\tqueryGroupSections,\n\t\t\tqueryGroupTabs,\n\t\t\tdispatch,\n\t\t\tisEnterprise,\n\t\t}),\n\t\t[queryEditableSetting, queryEditableSettings, queryGroupSections, queryGroupTabs, dispatch, isEnterprise],\n\t);\n\n\treturn <EditableSettingsContext.Provider children={children} value={contextValue} />;\n};\n\nexport default EditableSettingsProvider;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/settings/EditableSettingsProvider.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/admin/settings/EditableSettingsProvider.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/settings/EditableSettingsProvider.tsx","sourceRoot":"","sources":["client/views/admin/settings/EditableSettingsProvider.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { SettingId, GroupId, ISetting, TabId } from '@rocket.chat/core-typings';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { SettingsContextQuery } from '@rocket.chat/ui-contexts';\nimport { useSettings } from '@rocket.chat/ui-contexts';\nimport { Mongo } from 'meteor/mongo';\nimport { Tracker } from 'meteor/tracker';\nimport type { FilterOperators } from 'mongodb';\nimport type { MutableRefObject, ReactNode } from 'react';\nimport React, { useEffect, useMemo, useRef } from 'react';\n\nimport { useIsEnterprise } from '../../../hooks/useIsEnterprise';\nimport { createReactiveSubscriptionFactory } from '../../../lib/createReactiveSubscriptionFactory';\nimport type { EditableSetting, EditableSettingsContextValue } from '../EditableSettingsContext';\nimport { EditableSettingsContext } from '../EditableSettingsContext';\n\nconst defaultQuery: SettingsContextQuery = {};\n\ntype EditableSettingsProviderProps = {\n\tchildren?: ReactNode;\n\tquery?: SettingsContextQuery;\n};\n\nconst EditableSettingsProvider = ({ children, query = defaultQuery }: EditableSettingsProviderProps) => {\n\tconst settingsCollectionRef = useRef<Mongo.Collection<EditableSetting>>(null) as MutableRefObject<Mongo.Collection<EditableSetting>>;\n\tconst persistedSettings = useSettings(query);\n\n\tconst getSettingsCollection = useMutableCallback(() => {\n\t\tif (!settingsCollectionRef.current) {\n\t\t\tsettingsCollectionRef.current = new Mongo.Collection<any>(null);\n\t\t}\n\n\t\treturn settingsCollectionRef.current;\n\t}) as () => Mongo.Collection<EditableSetting>;\n\n\tuseEffect(() => {\n\t\tconst settingsCollection = getSettingsCollection();\n\n\t\tsettingsCollection.remove({ _id: { $nin: persistedSettings.map(({ _id }) => _id) } });\n\t\tfor (const { _id, ...fields } of persistedSettings) {\n\t\t\tsettingsCollection.upsert(_id, { $set: { ...fields }, $unset: { changed: true } });\n\t\t}\n\t}, [getSettingsCollection, persistedSettings]);\n\n\tconst queryEditableSetting = useMemo(() => {\n\t\tconst validateSettingQueries = (\n\t\t\tquery: undefined | string | FilterOperators<ISetting> | FilterOperators<ISetting>[],\n\t\t\tsettingsCollection: Mongo.Collection<EditableSetting>,\n\t\t): boolean => {\n\t\t\tif (!query) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst queries = [].concat(typeof query === 'string' ? JSON.parse(query) : query);\n\t\t\treturn queries.every((query) => settingsCollection.find(query).count() > 0);\n\t\t};\n\n\t\treturn createReactiveSubscriptionFactory((_id: SettingId): EditableSetting | undefined => {\n\t\t\tconst settingsCollection = getSettingsCollection();\n\t\t\tconst editableSetting = settingsCollection.findOne(_id);\n\n\t\t\tif (!editableSetting) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t...editableSetting,\n\t\t\t\tdisabled: editableSetting.blocked || !validateSettingQueries(editableSetting.enableQuery, settingsCollection),\n\t\t\t\tinvisible: !validateSettingQueries(editableSetting.displayQuery, settingsCollection),\n\t\t\t};\n\t\t});\n\t}, [getSettingsCollection]);\n\n\tconst queryEditableSettings = useMemo(\n\t\t() =>\n\t\t\tcreateReactiveSubscriptionFactory((query = {}) =>\n\t\t\t\tgetSettingsCollection()\n\t\t\t\t\t.find(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t...('_id' in query && { _id: { $in: query._id } }),\n\t\t\t\t\t\t\t...('group' in query && { group: query.group }),\n\t\t\t\t\t\t\t...('changed' in query && { changed: query.changed }),\n\t\t\t\t\t\t\t$and: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t...('section' in query &&\n\t\t\t\t\t\t\t\t\t\t(query.section\n\t\t\t\t\t\t\t\t\t\t\t? { section: query.section }\n\t\t\t\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t$or: [{ section: { $exists: false } }, { section: '' }],\n\t\t\t\t\t\t\t\t\t\t\t  })),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t...('tab' in query &&\n\t\t\t\t\t\t\t\t\t\t(query.tab\n\t\t\t\t\t\t\t\t\t\t\t? { tab: query.tab }\n\t\t\t\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t$or: [{ tab: { $exists: false } }, { tab: '' }],\n\t\t\t\t\t\t\t\t\t\t\t  })),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\tsection: 1,\n\t\t\t\t\t\t\t\tsorter: 1,\n\t\t\t\t\t\t\t\ti18nLabel: 1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t)\n\t\t\t\t\t.fetch(),\n\t\t\t),\n\t\t[getSettingsCollection],\n\t);\n\n\tconst queryGroupSections = useMemo(\n\t\t() =>\n\t\t\tcreateReactiveSubscriptionFactory((_id: GroupId, tab?: TabId) =>\n\t\t\t\tArray.from(\n\t\t\t\t\tnew Set(\n\t\t\t\t\t\tgetSettingsCollection()\n\t\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tgroup: _id,\n\t\t\t\t\t\t\t\t\t...(tab !== undefined\n\t\t\t\t\t\t\t\t\t\t? { tab }\n\t\t\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\t\t\t$or: [{ tab: { $exists: false } }, { tab: '' }],\n\t\t\t\t\t\t\t\t\t\t  }),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfields: {\n\t\t\t\t\t\t\t\t\t\tsection: 1,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\t\t\tsorter: 1,\n\t\t\t\t\t\t\t\t\t\tsection: 1,\n\t\t\t\t\t\t\t\t\t\ti18nLabel: 1,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t\t.map(({ section }) => section || ''),\n\t\t\t\t\t),\n\t\t\t\t),\n\t\t\t),\n\t\t[getSettingsCollection],\n\t);\n\n\tconst queryGroupTabs = useMemo(\n\t\t() =>\n\t\t\tcreateReactiveSubscriptionFactory((_id: GroupId) =>\n\t\t\t\tArray.from(\n\t\t\t\t\tnew Set(\n\t\t\t\t\t\tgetSettingsCollection()\n\t\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tgroup: _id,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfields: {\n\t\t\t\t\t\t\t\t\t\ttab: 1,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\t\t\tsorter: 1,\n\t\t\t\t\t\t\t\t\t\ttab: 1,\n\t\t\t\t\t\t\t\t\t\ti18nLabel: 1,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t\t.map(({ tab }) => tab || ''),\n\t\t\t\t\t),\n\t\t\t\t),\n\t\t\t),\n\t\t[getSettingsCollection],\n\t);\n\n\tconst dispatch = useMutableCallback((changes: Partial<EditableSetting>[]): void => {\n\t\tfor (const { _id, ...data } of changes) {\n\t\t\tif (!_id) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tgetSettingsCollection().update(_id, { $set: data });\n\t\t}\n\t\tTracker.flush();\n\t});\n\n\tconst { data } = useIsEnterprise();\n\n\tconst isEnterprise = data?.isEnterprise ?? false;\n\n\tconst contextValue = useMemo<EditableSettingsContextValue>(\n\t\t() => ({\n\t\t\tqueryEditableSetting,\n\t\t\tqueryEditableSettings,\n\t\t\tqueryGroupSections,\n\t\t\tqueryGroupTabs,\n\t\t\tdispatch,\n\t\t\tisEnterprise,\n\t\t}),\n\t\t[queryEditableSetting, queryEditableSettings, queryGroupSections, queryGroupTabs, dispatch, isEnterprise],\n\t);\n\n\treturn <EditableSettingsContext.Provider children={children} value={contextValue} />;\n};\n\nexport default EditableSettingsProvider;\n"]}}},"code":"var _excluded = [\"_id\"],\n  _excluded2 = [\"_id\"];\nvar _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default: function (v) {\n    _objectSpread = v;\n  }\n}, 0);\nvar _objectWithoutProperties;\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default: function (v) {\n    _objectWithoutProperties = v;\n  }\n}, 1);\nvar _createForOfIteratorHelperLoose;\nmodule.link(\"@babel/runtime/helpers/createForOfIteratorHelperLoose\", {\n  default: function (v) {\n    _createForOfIteratorHelperLoose = v;\n  }\n}, 2);\nvar useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback: function (v) {\n    useMutableCallback = v;\n  }\n}, 0);\nvar useSettings;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useSettings: function (v) {\n    useSettings = v;\n  }\n}, 1);\nvar Mongo;\nmodule.link(\"meteor/mongo\", {\n  Mongo: function (v) {\n    Mongo = v;\n  }\n}, 2);\nvar Tracker;\nmodule.link(\"meteor/tracker\", {\n  Tracker: function (v) {\n    Tracker = v;\n  }\n}, 3);\nvar React, useEffect, useMemo, useRef;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useEffect: function (v) {\n    useEffect = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  },\n  useRef: function (v) {\n    useRef = v;\n  }\n}, 4);\nvar useIsEnterprise;\nmodule.link(\"../../../hooks/useIsEnterprise\", {\n  useIsEnterprise: function (v) {\n    useIsEnterprise = v;\n  }\n}, 5);\nvar createReactiveSubscriptionFactory;\nmodule.link(\"../../../lib/createReactiveSubscriptionFactory\", {\n  createReactiveSubscriptionFactory: function (v) {\n    createReactiveSubscriptionFactory = v;\n  }\n}, 6);\nvar EditableSettingsContext;\nmodule.link(\"../EditableSettingsContext\", {\n  EditableSettingsContext: function (v) {\n    EditableSettingsContext = v;\n  }\n}, 7);\nvar defaultQuery = {};\nvar EditableSettingsProvider = function (_ref) {\n  var _data$isEnterprise;\n  var children = _ref.children,\n    _ref$query = _ref.query,\n    query = _ref$query === void 0 ? defaultQuery : _ref$query;\n  var settingsCollectionRef = useRef(null);\n  var persistedSettings = useSettings(query);\n  var getSettingsCollection = useMutableCallback(function () {\n    if (!settingsCollectionRef.current) {\n      settingsCollectionRef.current = new Mongo.Collection(null);\n    }\n    return settingsCollectionRef.current;\n  });\n  useEffect(function () {\n    var settingsCollection = getSettingsCollection();\n    settingsCollection.remove({\n      _id: {\n        $nin: persistedSettings.map(function (_ref2) {\n          var _id = _ref2._id;\n          return _id;\n        })\n      }\n    });\n    for (var _iterator = _createForOfIteratorHelperLoose(persistedSettings), _step; !(_step = _iterator()).done;) {\n      var _ref4 = _step.value;\n      var _id = _ref4._id,\n        fields = _objectWithoutProperties(_ref4, _excluded);\n      settingsCollection.upsert(_id, {\n        $set: _objectSpread({}, fields),\n        $unset: {\n          changed: true\n        }\n      });\n    }\n  }, [getSettingsCollection, persistedSettings]);\n  var queryEditableSetting = useMemo(function () {\n    var validateSettingQueries = function (query, settingsCollection) {\n      if (!query) {\n        return true;\n      }\n      var queries = [].concat(typeof query === 'string' ? JSON.parse(query) : query);\n      return queries.every(function (query) {\n        return settingsCollection.find(query).count() > 0;\n      });\n    };\n    return createReactiveSubscriptionFactory(function (_id) {\n      var settingsCollection = getSettingsCollection();\n      var editableSetting = settingsCollection.findOne(_id);\n      if (!editableSetting) {\n        return undefined;\n      }\n      return _objectSpread(_objectSpread({}, editableSetting), {}, {\n        disabled: editableSetting.blocked || !validateSettingQueries(editableSetting.enableQuery, settingsCollection),\n        invisible: !validateSettingQueries(editableSetting.displayQuery, settingsCollection)\n      });\n    });\n  }, [getSettingsCollection]);\n  var queryEditableSettings = useMemo(function () {\n    return createReactiveSubscriptionFactory(function () {\n      var query = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return getSettingsCollection().find(_objectSpread(_objectSpread(_objectSpread(_objectSpread({}, '_id' in query && {\n        _id: {\n          $in: query._id\n        }\n      }), 'group' in query && {\n        group: query.group\n      }), 'changed' in query && {\n        changed: query.changed\n      }), {}, {\n        $and: [_objectSpread({}, 'section' in query && (query.section ? {\n          section: query.section\n        } : {\n          $or: [{\n            section: {\n              $exists: false\n            }\n          }, {\n            section: ''\n          }]\n        })), _objectSpread({}, 'tab' in query && (query.tab ? {\n          tab: query.tab\n        } : {\n          $or: [{\n            tab: {\n              $exists: false\n            }\n          }, {\n            tab: ''\n          }]\n        }))]\n      }), {\n        sort: {\n          section: 1,\n          sorter: 1,\n          i18nLabel: 1\n        }\n      }).fetch();\n    });\n  }, [getSettingsCollection]);\n  var queryGroupSections = useMemo(function () {\n    return createReactiveSubscriptionFactory(function (_id, tab) {\n      return Array.from(new Set(getSettingsCollection().find(_objectSpread({\n        group: _id\n      }, tab !== undefined ? {\n        tab: tab\n      } : {\n        $or: [{\n          tab: {\n            $exists: false\n          }\n        }, {\n          tab: ''\n        }]\n      }), {\n        fields: {\n          section: 1\n        },\n        sort: {\n          sorter: 1,\n          section: 1,\n          i18nLabel: 1\n        }\n      }).fetch().map(function (_ref5) {\n        var section = _ref5.section;\n        return section || '';\n      })));\n    });\n  }, [getSettingsCollection]);\n  var queryGroupTabs = useMemo(function () {\n    return createReactiveSubscriptionFactory(function (_id) {\n      return Array.from(new Set(getSettingsCollection().find({\n        group: _id\n      }, {\n        fields: {\n          tab: 1\n        },\n        sort: {\n          sorter: 1,\n          tab: 1,\n          i18nLabel: 1\n        }\n      }).fetch().map(function (_ref6) {\n        var tab = _ref6.tab;\n        return tab || '';\n      })));\n    });\n  }, [getSettingsCollection]);\n  var dispatch = useMutableCallback(function (changes) {\n    for (var _iterator2 = _createForOfIteratorHelperLoose(changes), _step2; !(_step2 = _iterator2()).done;) {\n      var _ref8 = _step2.value;\n      var _id = _ref8._id,\n        _data = _objectWithoutProperties(_ref8, _excluded2);\n      if (!_id) {\n        continue;\n      }\n      getSettingsCollection().update(_id, {\n        $set: _data\n      });\n    }\n    Tracker.flush();\n  });\n  var _useIsEnterprise = useIsEnterprise(),\n    data = _useIsEnterprise.data;\n  var isEnterprise = (_data$isEnterprise = data === null || data === void 0 ? void 0 : data.isEnterprise) !== null && _data$isEnterprise !== void 0 ? _data$isEnterprise : false;\n  var contextValue = useMemo(function () {\n    return {\n      queryEditableSetting: queryEditableSetting,\n      queryEditableSettings: queryEditableSettings,\n      queryGroupSections: queryGroupSections,\n      queryGroupTabs: queryGroupTabs,\n      dispatch: dispatch,\n      isEnterprise: isEnterprise\n    };\n  }, [queryEditableSetting, queryEditableSettings, queryGroupSections, queryGroupTabs, dispatch, isEnterprise]);\n  return /*#__PURE__*/React.createElement(EditableSettingsContext.Provider, {\n    children: children,\n    value: contextValue\n  });\n};\nmodule.exportDefault(EditableSettingsProvider);","map":{"version":3,"names":["_objectSpread","module","link","default","v","_objectWithoutProperties","_createForOfIteratorHelperLoose","useMutableCallback","useSettings","Mongo","Tracker","React","useEffect","useMemo","useRef","useIsEnterprise","createReactiveSubscriptionFactory","EditableSettingsContext","defaultQuery","EditableSettingsProvider","_ref","_data$isEnterprise","children","_ref$query","query","settingsCollectionRef","persistedSettings","getSettingsCollection","current","Collection","settingsCollection","remove","_id","$nin","map","_ref2","_iterator","_step","done","_ref4","value","fields","_excluded","upsert","$set","$unset","changed","queryEditableSetting","validateSettingQueries","queries","concat","JSON","parse","every","find","count","editableSetting","findOne","undefined","disabled","blocked","enableQuery","invisible","displayQuery","queryEditableSettings","arguments","length","$in","group","$and","section","$or","$exists","tab","sort","sorter","i18nLabel","fetch","queryGroupSections","Array","from","Set","_ref5","queryGroupTabs","_ref6","dispatch","changes","_iterator2","_step2","_ref8","data","_excluded2","update","flush","_useIsEnterprise","isEnterprise","contextValue","createElement","Provider","exportDefault"],"sources":["client/views/admin/settings/EditableSettingsProvider.tsx"],"sourcesContent":["import type { SettingId, GroupId, ISetting, TabId } from '@rocket.chat/core-typings';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { SettingsContextQuery } from '@rocket.chat/ui-contexts';\nimport { useSettings } from '@rocket.chat/ui-contexts';\nimport { Mongo } from 'meteor/mongo';\nimport { Tracker } from 'meteor/tracker';\nimport type { FilterOperators } from 'mongodb';\nimport type { MutableRefObject, ReactNode } from 'react';\nimport React, { useEffect, useMemo, useRef } from 'react';\n\nimport { useIsEnterprise } from '../../../hooks/useIsEnterprise';\nimport { createReactiveSubscriptionFactory } from '../../../lib/createReactiveSubscriptionFactory';\nimport type { EditableSetting, EditableSettingsContextValue } from '../EditableSettingsContext';\nimport { EditableSettingsContext } from '../EditableSettingsContext';\n\nconst defaultQuery: SettingsContextQuery = {};\n\ntype EditableSettingsProviderProps = {\n\tchildren?: ReactNode;\n\tquery?: SettingsContextQuery;\n};\n\nconst EditableSettingsProvider = ({ children, query = defaultQuery }: EditableSettingsProviderProps) => {\n\tconst settingsCollectionRef = useRef<Mongo.Collection<EditableSetting>>(null) as MutableRefObject<Mongo.Collection<EditableSetting>>;\n\tconst persistedSettings = useSettings(query);\n\n\tconst getSettingsCollection = useMutableCallback(() => {\n\t\tif (!settingsCollectionRef.current) {\n\t\t\tsettingsCollectionRef.current = new Mongo.Collection<any>(null);\n\t\t}\n\n\t\treturn settingsCollectionRef.current;\n\t}) as () => Mongo.Collection<EditableSetting>;\n\n\tuseEffect(() => {\n\t\tconst settingsCollection = getSettingsCollection();\n\n\t\tsettingsCollection.remove({ _id: { $nin: persistedSettings.map(({ _id }) => _id) } });\n\t\tfor (const { _id, ...fields } of persistedSettings) {\n\t\t\tsettingsCollection.upsert(_id, { $set: { ...fields }, $unset: { changed: true } });\n\t\t}\n\t}, [getSettingsCollection, persistedSettings]);\n\n\tconst queryEditableSetting = useMemo(() => {\n\t\tconst validateSettingQueries = (\n\t\t\tquery: undefined | string | FilterOperators<ISetting> | FilterOperators<ISetting>[],\n\t\t\tsettingsCollection: Mongo.Collection<EditableSetting>,\n\t\t): boolean => {\n\t\t\tif (!query) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst queries = [].concat(typeof query === 'string' ? JSON.parse(query) : query);\n\t\t\treturn queries.every((query) => settingsCollection.find(query).count() > 0);\n\t\t};\n\n\t\treturn createReactiveSubscriptionFactory((_id: SettingId): EditableSetting | undefined => {\n\t\t\tconst settingsCollection = getSettingsCollection();\n\t\t\tconst editableSetting = settingsCollection.findOne(_id);\n\n\t\t\tif (!editableSetting) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t...editableSetting,\n\t\t\t\tdisabled: editableSetting.blocked || !validateSettingQueries(editableSetting.enableQuery, settingsCollection),\n\t\t\t\tinvisible: !validateSettingQueries(editableSetting.displayQuery, settingsCollection),\n\t\t\t};\n\t\t});\n\t}, [getSettingsCollection]);\n\n\tconst queryEditableSettings = useMemo(\n\t\t() =>\n\t\t\tcreateReactiveSubscriptionFactory((query = {}) =>\n\t\t\t\tgetSettingsCollection()\n\t\t\t\t\t.find(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t...('_id' in query && { _id: { $in: query._id } }),\n\t\t\t\t\t\t\t...('group' in query && { group: query.group }),\n\t\t\t\t\t\t\t...('changed' in query && { changed: query.changed }),\n\t\t\t\t\t\t\t$and: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t...('section' in query &&\n\t\t\t\t\t\t\t\t\t\t(query.section\n\t\t\t\t\t\t\t\t\t\t\t? { section: query.section }\n\t\t\t\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t$or: [{ section: { $exists: false } }, { section: '' }],\n\t\t\t\t\t\t\t\t\t\t\t  })),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t...('tab' in query &&\n\t\t\t\t\t\t\t\t\t\t(query.tab\n\t\t\t\t\t\t\t\t\t\t\t? { tab: query.tab }\n\t\t\t\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t$or: [{ tab: { $exists: false } }, { tab: '' }],\n\t\t\t\t\t\t\t\t\t\t\t  })),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\tsection: 1,\n\t\t\t\t\t\t\t\tsorter: 1,\n\t\t\t\t\t\t\t\ti18nLabel: 1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t)\n\t\t\t\t\t.fetch(),\n\t\t\t),\n\t\t[getSettingsCollection],\n\t);\n\n\tconst queryGroupSections = useMemo(\n\t\t() =>\n\t\t\tcreateReactiveSubscriptionFactory((_id: GroupId, tab?: TabId) =>\n\t\t\t\tArray.from(\n\t\t\t\t\tnew Set(\n\t\t\t\t\t\tgetSettingsCollection()\n\t\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tgroup: _id,\n\t\t\t\t\t\t\t\t\t...(tab !== undefined\n\t\t\t\t\t\t\t\t\t\t? { tab }\n\t\t\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\t\t\t$or: [{ tab: { $exists: false } }, { tab: '' }],\n\t\t\t\t\t\t\t\t\t\t  }),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfields: {\n\t\t\t\t\t\t\t\t\t\tsection: 1,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\t\t\tsorter: 1,\n\t\t\t\t\t\t\t\t\t\tsection: 1,\n\t\t\t\t\t\t\t\t\t\ti18nLabel: 1,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t\t.map(({ section }) => section || ''),\n\t\t\t\t\t),\n\t\t\t\t),\n\t\t\t),\n\t\t[getSettingsCollection],\n\t);\n\n\tconst queryGroupTabs = useMemo(\n\t\t() =>\n\t\t\tcreateReactiveSubscriptionFactory((_id: GroupId) =>\n\t\t\t\tArray.from(\n\t\t\t\t\tnew Set(\n\t\t\t\t\t\tgetSettingsCollection()\n\t\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tgroup: _id,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfields: {\n\t\t\t\t\t\t\t\t\t\ttab: 1,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\t\t\tsorter: 1,\n\t\t\t\t\t\t\t\t\t\ttab: 1,\n\t\t\t\t\t\t\t\t\t\ti18nLabel: 1,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t\t.map(({ tab }) => tab || ''),\n\t\t\t\t\t),\n\t\t\t\t),\n\t\t\t),\n\t\t[getSettingsCollection],\n\t);\n\n\tconst dispatch = useMutableCallback((changes: Partial<EditableSetting>[]): void => {\n\t\tfor (const { _id, ...data } of changes) {\n\t\t\tif (!_id) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tgetSettingsCollection().update(_id, { $set: data });\n\t\t}\n\t\tTracker.flush();\n\t});\n\n\tconst { data } = useIsEnterprise();\n\n\tconst isEnterprise = data?.isEnterprise ?? false;\n\n\tconst contextValue = useMemo<EditableSettingsContextValue>(\n\t\t() => ({\n\t\t\tqueryEditableSetting,\n\t\t\tqueryEditableSettings,\n\t\t\tqueryGroupSections,\n\t\t\tqueryGroupTabs,\n\t\t\tdispatch,\n\t\t\tisEnterprise,\n\t\t}),\n\t\t[queryEditableSetting, queryEditableSettings, queryGroupSections, queryGroupTabs, dispatch, isEnterprise],\n\t);\n\n\treturn <EditableSettingsContext.Provider children={children} value={contextValue} />;\n};\n\nexport default EditableSettingsProvider;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"f2e46f8f42a09aa23a748a73782c50d22f8af967"}
