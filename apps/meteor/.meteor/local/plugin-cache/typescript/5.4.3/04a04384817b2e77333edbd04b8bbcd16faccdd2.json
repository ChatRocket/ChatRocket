{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/users/AdminUserInfoActions.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/admin/users/AdminUserInfoActions.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/users/AdminUserInfoActions.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/users/AdminUserInfoActions.tsx","sourceRoot":"","sources":["client/views/admin/users/AdminUserInfoActions.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IUser } from '@rocket.chat/core-typings';\nimport { ButtonGroup, Menu, Option } from '@rocket.chat/fuselage';\nimport { useRoute, usePermission, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useCallback, useMemo } from 'react';\n\nimport { UserInfoAction } from '../../../components/UserInfo';\nimport { useActionSpread } from '../../hooks/useActionSpread';\nimport type { AdminUsersTab } from './AdminUsersPage';\nimport { useChangeAdminStatusAction } from './hooks/useChangeAdminStatusAction';\nimport { useChangeUserStatusAction } from './hooks/useChangeUserStatusAction';\nimport { useDeleteUserAction } from './hooks/useDeleteUserAction';\nimport { useResetE2EEKeyAction } from './hooks/useResetE2EEKeyAction';\nimport { useResetTOTPAction } from './hooks/useResetTOTPAction';\n\ntype AdminUserInfoActionsProps = {\n\tusername: IUser['username'];\n\tuserId: IUser['_id'];\n\tisFederatedUser: IUser['federated'];\n\tisActive: boolean;\n\tisAdmin: boolean;\n\ttab: AdminUsersTab;\n\tonChange: () => void;\n\tonReload: () => void;\n};\n\n// TODO: Replace menu\nconst AdminUserInfoActions = ({\n\tusername,\n\tuserId,\n\tisFederatedUser,\n\tisActive,\n\tisAdmin,\n\ttab,\n\tonChange,\n\tonReload,\n}: AdminUserInfoActionsProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst directRoute = useRoute('direct');\n\tconst userRoute = useRoute('admin-users');\n\tconst canDirectMessage = usePermission('create-d');\n\tconst canEditOtherUserInfo = usePermission('edit-other-user-info');\n\n\tconst changeAdminStatusAction = useChangeAdminStatusAction(userId, isAdmin, onChange);\n\tconst changeUserStatusAction = useChangeUserStatusAction(userId, isActive, onChange);\n\tconst deleteUserAction = useDeleteUserAction(userId, onChange, onReload);\n\tconst resetTOTPAction = useResetTOTPAction(userId);\n\tconst resetE2EKeyAction = useResetE2EEKeyAction(userId);\n\n\tconst directMessageClick = useCallback(\n\t\t() =>\n\t\t\tusername &&\n\t\t\tdirectRoute.push({\n\t\t\t\trid: username,\n\t\t\t}),\n\t\t[directRoute, username],\n\t);\n\n\tconst editUserClick = useCallback(\n\t\t() =>\n\t\t\tuserRoute.push({\n\t\t\t\tcontext: 'edit',\n\t\t\t\tid: userId,\n\t\t\t}),\n\t\t[userId, userRoute],\n\t);\n\n\tconst isNotPendingDeactivatedNorFederated = tab !== 'pending' && tab !== 'deactivated' && !isFederatedUser;\n\tconst options = useMemo(\n\t\t() => ({\n\t\t\t...(canDirectMessage && {\n\t\t\t\tdirectMessage: {\n\t\t\t\t\ticon: 'balloon' as const,\n\t\t\t\t\tlabel: t('Direct_Message'),\n\t\t\t\t\ttitle: t('Direct_Message'),\n\t\t\t\t\taction: directMessageClick,\n\t\t\t\t},\n\t\t\t}),\n\t\t\t...(canEditOtherUserInfo && {\n\t\t\t\teditUser: {\n\t\t\t\t\ticon: 'edit' as const,\n\t\t\t\t\tlabel: t('Edit'),\n\t\t\t\t\ttitle: isFederatedUser ? t('Edit_Federated_User_Not_Allowed') : t('Edit'),\n\t\t\t\t\taction: editUserClick,\n\t\t\t\t\tdisabled: isFederatedUser,\n\t\t\t\t},\n\t\t\t}),\n\t\t\t...(isNotPendingDeactivatedNorFederated && changeAdminStatusAction && { makeAdmin: changeAdminStatusAction }),\n\t\t\t...(isNotPendingDeactivatedNorFederated && resetE2EKeyAction && { resetE2EKey: resetE2EKeyAction }),\n\t\t\t...(isNotPendingDeactivatedNorFederated && resetTOTPAction && { resetTOTP: resetTOTPAction }),\n\t\t\t...(changeUserStatusAction && !isFederatedUser && { changeActiveStatus: changeUserStatusAction }),\n\t\t\t...(deleteUserAction && { delete: deleteUserAction }),\n\t\t}),\n\t\t[\n\t\t\tcanDirectMessage,\n\t\t\tcanEditOtherUserInfo,\n\t\t\tchangeAdminStatusAction,\n\t\t\tchangeUserStatusAction,\n\t\t\tdeleteUserAction,\n\t\t\tdirectMessageClick,\n\t\t\teditUserClick,\n\t\t\tisFederatedUser,\n\t\t\tisNotPendingDeactivatedNorFederated,\n\t\t\tresetE2EKeyAction,\n\t\t\tresetTOTPAction,\n\t\t\tt,\n\t\t],\n\t);\n\n\tconst { actions: actionsDefinition, menu: menuOptions } = useActionSpread(options);\n\n\tconst menu = useMemo(() => {\n\t\tif (!menuOptions) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (\n\t\t\t<Menu\n\t\t\t\tmi={4}\n\t\t\t\tplacement='bottom-start'\n\t\t\t\tsmall={false}\n\t\t\t\tsecondary\n\t\t\t\tflexShrink={0}\n\t\t\t\tkey='menu'\n\t\t\t\trenderItem={({ label: { label, icon }, ...props }): ReactElement => (\n\t\t\t\t\t<Option label={label} title={label} icon={icon} variant={label === 'Delete' ? 'danger' : ''} {...props} />\n\t\t\t\t)}\n\t\t\t\toptions={menuOptions}\n\t\t\t/>\n\t\t);\n\t}, [menuOptions]);\n\n\t// TODO: sanitize Action type to avoid any\n\tconst actions = useMemo(() => {\n\t\tconst mapAction = ([key, { label, icon, action, disabled, title }]: any): ReactElement => (\n\t\t\t<UserInfoAction key={key} title={title} label={label} onClick={action} disabled={disabled} icon={icon} />\n\t\t);\n\t\treturn [...actionsDefinition.map(mapAction), menu].filter(Boolean);\n\t}, [actionsDefinition, menu]);\n\n\treturn (\n\t\t<ButtonGroup align='center' data-qa-id='UserInfoActions'>\n\t\t\t{actions}\n\t\t</ButtonGroup>\n\t);\n};\n\nexport default AdminUserInfoActions;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/users/AdminUserInfoActions.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/admin/users/AdminUserInfoActions.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/users/AdminUserInfoActions.tsx","sourceRoot":"","sources":["client/views/admin/users/AdminUserInfoActions.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IUser } from '@rocket.chat/core-typings';\nimport { ButtonGroup, Menu, Option } from '@rocket.chat/fuselage';\nimport { useRoute, usePermission, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useCallback, useMemo } from 'react';\n\nimport { UserInfoAction } from '../../../components/UserInfo';\nimport { useActionSpread } from '../../hooks/useActionSpread';\nimport type { AdminUsersTab } from './AdminUsersPage';\nimport { useChangeAdminStatusAction } from './hooks/useChangeAdminStatusAction';\nimport { useChangeUserStatusAction } from './hooks/useChangeUserStatusAction';\nimport { useDeleteUserAction } from './hooks/useDeleteUserAction';\nimport { useResetE2EEKeyAction } from './hooks/useResetE2EEKeyAction';\nimport { useResetTOTPAction } from './hooks/useResetTOTPAction';\n\ntype AdminUserInfoActionsProps = {\n\tusername: IUser['username'];\n\tuserId: IUser['_id'];\n\tisFederatedUser: IUser['federated'];\n\tisActive: boolean;\n\tisAdmin: boolean;\n\ttab: AdminUsersTab;\n\tonChange: () => void;\n\tonReload: () => void;\n};\n\n// TODO: Replace menu\nconst AdminUserInfoActions = ({\n\tusername,\n\tuserId,\n\tisFederatedUser,\n\tisActive,\n\tisAdmin,\n\ttab,\n\tonChange,\n\tonReload,\n}: AdminUserInfoActionsProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst directRoute = useRoute('direct');\n\tconst userRoute = useRoute('admin-users');\n\tconst canDirectMessage = usePermission('create-d');\n\tconst canEditOtherUserInfo = usePermission('edit-other-user-info');\n\n\tconst changeAdminStatusAction = useChangeAdminStatusAction(userId, isAdmin, onChange);\n\tconst changeUserStatusAction = useChangeUserStatusAction(userId, isActive, onChange);\n\tconst deleteUserAction = useDeleteUserAction(userId, onChange, onReload);\n\tconst resetTOTPAction = useResetTOTPAction(userId);\n\tconst resetE2EKeyAction = useResetE2EEKeyAction(userId);\n\n\tconst directMessageClick = useCallback(\n\t\t() =>\n\t\t\tusername &&\n\t\t\tdirectRoute.push({\n\t\t\t\trid: username,\n\t\t\t}),\n\t\t[directRoute, username],\n\t);\n\n\tconst editUserClick = useCallback(\n\t\t() =>\n\t\t\tuserRoute.push({\n\t\t\t\tcontext: 'edit',\n\t\t\t\tid: userId,\n\t\t\t}),\n\t\t[userId, userRoute],\n\t);\n\n\tconst isNotPendingDeactivatedNorFederated = tab !== 'pending' && tab !== 'deactivated' && !isFederatedUser;\n\tconst options = useMemo(\n\t\t() => ({\n\t\t\t...(canDirectMessage && {\n\t\t\t\tdirectMessage: {\n\t\t\t\t\ticon: 'balloon' as const,\n\t\t\t\t\tlabel: t('Direct_Message'),\n\t\t\t\t\ttitle: t('Direct_Message'),\n\t\t\t\t\taction: directMessageClick,\n\t\t\t\t},\n\t\t\t}),\n\t\t\t...(canEditOtherUserInfo && {\n\t\t\t\teditUser: {\n\t\t\t\t\ticon: 'edit' as const,\n\t\t\t\t\tlabel: t('Edit'),\n\t\t\t\t\ttitle: isFederatedUser ? t('Edit_Federated_User_Not_Allowed') : t('Edit'),\n\t\t\t\t\taction: editUserClick,\n\t\t\t\t\tdisabled: isFederatedUser,\n\t\t\t\t},\n\t\t\t}),\n\t\t\t...(isNotPendingDeactivatedNorFederated && changeAdminStatusAction && { makeAdmin: changeAdminStatusAction }),\n\t\t\t...(isNotPendingDeactivatedNorFederated && resetE2EKeyAction && { resetE2EKey: resetE2EKeyAction }),\n\t\t\t...(isNotPendingDeactivatedNorFederated && resetTOTPAction && { resetTOTP: resetTOTPAction }),\n\t\t\t...(changeUserStatusAction && !isFederatedUser && { changeActiveStatus: changeUserStatusAction }),\n\t\t\t...(deleteUserAction && { delete: deleteUserAction }),\n\t\t}),\n\t\t[\n\t\t\tcanDirectMessage,\n\t\t\tcanEditOtherUserInfo,\n\t\t\tchangeAdminStatusAction,\n\t\t\tchangeUserStatusAction,\n\t\t\tdeleteUserAction,\n\t\t\tdirectMessageClick,\n\t\t\teditUserClick,\n\t\t\tisFederatedUser,\n\t\t\tisNotPendingDeactivatedNorFederated,\n\t\t\tresetE2EKeyAction,\n\t\t\tresetTOTPAction,\n\t\t\tt,\n\t\t],\n\t);\n\n\tconst { actions: actionsDefinition, menu: menuOptions } = useActionSpread(options);\n\n\tconst menu = useMemo(() => {\n\t\tif (!menuOptions) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (\n\t\t\t<Menu\n\t\t\t\tmi={4}\n\t\t\t\tplacement='bottom-start'\n\t\t\t\tsmall={false}\n\t\t\t\tsecondary\n\t\t\t\tflexShrink={0}\n\t\t\t\tkey='menu'\n\t\t\t\trenderItem={({ label: { label, icon }, ...props }): ReactElement => (\n\t\t\t\t\t<Option label={label} title={label} icon={icon} variant={label === 'Delete' ? 'danger' : ''} {...props} />\n\t\t\t\t)}\n\t\t\t\toptions={menuOptions}\n\t\t\t/>\n\t\t);\n\t}, [menuOptions]);\n\n\t// TODO: sanitize Action type to avoid any\n\tconst actions = useMemo(() => {\n\t\tconst mapAction = ([key, { label, icon, action, disabled, title }]: any): ReactElement => (\n\t\t\t<UserInfoAction key={key} title={title} label={label} onClick={action} disabled={disabled} icon={icon} />\n\t\t);\n\t\treturn [...actionsDefinition.map(mapAction), menu].filter(Boolean);\n\t}, [actionsDefinition, menu]);\n\n\treturn (\n\t\t<ButtonGroup align='center' data-qa-id='UserInfoActions'>\n\t\t\t{actions}\n\t\t</ButtonGroup>\n\t);\n};\n\nexport default AdminUserInfoActions;\n"]}}},"code":"const _excluded = [\"label\"];\nlet _extends;\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default(v) {\n    _extends = v;\n  }\n}, 0);\nlet _objectWithoutProperties;\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default(v) {\n    _objectWithoutProperties = v;\n  }\n}, 1);\nlet _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n}, 2);\nlet ButtonGroup, Menu, Option;\nmodule.link(\"@rocket.chat/fuselage\", {\n  ButtonGroup(v) {\n    ButtonGroup = v;\n  },\n  Menu(v) {\n    Menu = v;\n  },\n  Option(v) {\n    Option = v;\n  }\n}, 0);\nlet useRoute, usePermission, useTranslation;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useRoute(v) {\n    useRoute = v;\n  },\n  usePermission(v) {\n    usePermission = v;\n  },\n  useTranslation(v) {\n    useTranslation = v;\n  }\n}, 1);\nlet React, useCallback, useMemo;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n  useCallback(v) {\n    useCallback = v;\n  },\n  useMemo(v) {\n    useMemo = v;\n  }\n}, 2);\nlet UserInfoAction;\nmodule.link(\"../../../components/UserInfo\", {\n  UserInfoAction(v) {\n    UserInfoAction = v;\n  }\n}, 3);\nlet useActionSpread;\nmodule.link(\"../../hooks/useActionSpread\", {\n  useActionSpread(v) {\n    useActionSpread = v;\n  }\n}, 4);\nlet useChangeAdminStatusAction;\nmodule.link(\"./hooks/useChangeAdminStatusAction\", {\n  useChangeAdminStatusAction(v) {\n    useChangeAdminStatusAction = v;\n  }\n}, 5);\nlet useChangeUserStatusAction;\nmodule.link(\"./hooks/useChangeUserStatusAction\", {\n  useChangeUserStatusAction(v) {\n    useChangeUserStatusAction = v;\n  }\n}, 6);\nlet useDeleteUserAction;\nmodule.link(\"./hooks/useDeleteUserAction\", {\n  useDeleteUserAction(v) {\n    useDeleteUserAction = v;\n  }\n}, 7);\nlet useResetE2EEKeyAction;\nmodule.link(\"./hooks/useResetE2EEKeyAction\", {\n  useResetE2EEKeyAction(v) {\n    useResetE2EEKeyAction = v;\n  }\n}, 8);\nlet useResetTOTPAction;\nmodule.link(\"./hooks/useResetTOTPAction\", {\n  useResetTOTPAction(v) {\n    useResetTOTPAction = v;\n  }\n}, 9);\n// TODO: Replace menu\nconst AdminUserInfoActions = _ref => {\n  let {\n    username,\n    userId,\n    isFederatedUser,\n    isActive,\n    isAdmin,\n    tab,\n    onChange,\n    onReload\n  } = _ref;\n  const t = useTranslation();\n  const directRoute = useRoute('direct');\n  const userRoute = useRoute('admin-users');\n  const canDirectMessage = usePermission('create-d');\n  const canEditOtherUserInfo = usePermission('edit-other-user-info');\n  const changeAdminStatusAction = useChangeAdminStatusAction(userId, isAdmin, onChange);\n  const changeUserStatusAction = useChangeUserStatusAction(userId, isActive, onChange);\n  const deleteUserAction = useDeleteUserAction(userId, onChange, onReload);\n  const resetTOTPAction = useResetTOTPAction(userId);\n  const resetE2EKeyAction = useResetE2EEKeyAction(userId);\n  const directMessageClick = useCallback(() => username && directRoute.push({\n    rid: username\n  }), [directRoute, username]);\n  const editUserClick = useCallback(() => userRoute.push({\n    context: 'edit',\n    id: userId\n  }), [userId, userRoute]);\n  const isNotPendingDeactivatedNorFederated = tab !== 'pending' && tab !== 'deactivated' && !isFederatedUser;\n  const options = useMemo(() => _objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({}, canDirectMessage && {\n    directMessage: {\n      icon: 'balloon',\n      label: t('Direct_Message'),\n      title: t('Direct_Message'),\n      action: directMessageClick\n    }\n  }), canEditOtherUserInfo && {\n    editUser: {\n      icon: 'edit',\n      label: t('Edit'),\n      title: isFederatedUser ? t('Edit_Federated_User_Not_Allowed') : t('Edit'),\n      action: editUserClick,\n      disabled: isFederatedUser\n    }\n  }), isNotPendingDeactivatedNorFederated && changeAdminStatusAction && {\n    makeAdmin: changeAdminStatusAction\n  }), isNotPendingDeactivatedNorFederated && resetE2EKeyAction && {\n    resetE2EKey: resetE2EKeyAction\n  }), isNotPendingDeactivatedNorFederated && resetTOTPAction && {\n    resetTOTP: resetTOTPAction\n  }), changeUserStatusAction && !isFederatedUser && {\n    changeActiveStatus: changeUserStatusAction\n  }), deleteUserAction && {\n    delete: deleteUserAction\n  }), [canDirectMessage, canEditOtherUserInfo, changeAdminStatusAction, changeUserStatusAction, deleteUserAction, directMessageClick, editUserClick, isFederatedUser, isNotPendingDeactivatedNorFederated, resetE2EKeyAction, resetTOTPAction, t]);\n  const {\n    actions: actionsDefinition,\n    menu: menuOptions\n  } = useActionSpread(options);\n  const menu = useMemo(() => {\n    if (!menuOptions) {\n      return null;\n    }\n    return /*#__PURE__*/React.createElement(Menu, {\n      mi: 4,\n      placement: \"bottom-start\",\n      small: false,\n      secondary: true,\n      flexShrink: 0,\n      key: \"menu\",\n      renderItem: _ref2 => {\n        let {\n            label: {\n              label,\n              icon\n            }\n          } = _ref2,\n          props = _objectWithoutProperties(_ref2, _excluded);\n        return /*#__PURE__*/React.createElement(Option, _extends({\n          label: label,\n          title: label,\n          icon: icon,\n          variant: label === 'Delete' ? 'danger' : ''\n        }, props));\n      },\n      options: menuOptions\n    });\n  }, [menuOptions]);\n  // TODO: sanitize Action type to avoid any\n  const actions = useMemo(() => {\n    const mapAction = _ref3 => {\n      let [key, {\n        label,\n        icon,\n        action,\n        disabled,\n        title\n      }] = _ref3;\n      return /*#__PURE__*/React.createElement(UserInfoAction, {\n        key: key,\n        title: title,\n        label: label,\n        onClick: action,\n        disabled: disabled,\n        icon: icon\n      });\n    };\n    return [...actionsDefinition.map(mapAction), menu].filter(Boolean);\n  }, [actionsDefinition, menu]);\n  return /*#__PURE__*/React.createElement(ButtonGroup, {\n    align: \"center\",\n    \"data-qa-id\": \"UserInfoActions\"\n  }, actions);\n};\nmodule.exportDefault(AdminUserInfoActions);","map":{"version":3,"names":["_extends","module","link","default","v","_objectWithoutProperties","_objectSpread","ButtonGroup","Menu","Option","useRoute","usePermission","useTranslation","React","useCallback","useMemo","UserInfoAction","useActionSpread","useChangeAdminStatusAction","useChangeUserStatusAction","useDeleteUserAction","useResetE2EEKeyAction","useResetTOTPAction","AdminUserInfoActions","_ref","username","userId","isFederatedUser","isActive","isAdmin","tab","onChange","onReload","t","directRoute","userRoute","canDirectMessage","canEditOtherUserInfo","changeAdminStatusAction","changeUserStatusAction","deleteUserAction","resetTOTPAction","resetE2EKeyAction","directMessageClick","push","rid","editUserClick","context","id","isNotPendingDeactivatedNorFederated","options","directMessage","icon","label","title","action","editUser","disabled","makeAdmin","resetE2EKey","resetTOTP","changeActiveStatus","delete","actions","actionsDefinition","menu","menuOptions","createElement","mi","placement","small","secondary","flexShrink","key","renderItem","_ref2","props","_excluded","variant","mapAction","_ref3","onClick","map","filter","Boolean","align","exportDefault"],"sources":["client/views/admin/users/AdminUserInfoActions.tsx"],"sourcesContent":["import type { IUser } from '@rocket.chat/core-typings';\nimport { ButtonGroup, Menu, Option } from '@rocket.chat/fuselage';\nimport { useRoute, usePermission, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useCallback, useMemo } from 'react';\n\nimport { UserInfoAction } from '../../../components/UserInfo';\nimport { useActionSpread } from '../../hooks/useActionSpread';\nimport type { AdminUsersTab } from './AdminUsersPage';\nimport { useChangeAdminStatusAction } from './hooks/useChangeAdminStatusAction';\nimport { useChangeUserStatusAction } from './hooks/useChangeUserStatusAction';\nimport { useDeleteUserAction } from './hooks/useDeleteUserAction';\nimport { useResetE2EEKeyAction } from './hooks/useResetE2EEKeyAction';\nimport { useResetTOTPAction } from './hooks/useResetTOTPAction';\n\ntype AdminUserInfoActionsProps = {\n\tusername: IUser['username'];\n\tuserId: IUser['_id'];\n\tisFederatedUser: IUser['federated'];\n\tisActive: boolean;\n\tisAdmin: boolean;\n\ttab: AdminUsersTab;\n\tonChange: () => void;\n\tonReload: () => void;\n};\n\n// TODO: Replace menu\nconst AdminUserInfoActions = ({\n\tusername,\n\tuserId,\n\tisFederatedUser,\n\tisActive,\n\tisAdmin,\n\ttab,\n\tonChange,\n\tonReload,\n}: AdminUserInfoActionsProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst directRoute = useRoute('direct');\n\tconst userRoute = useRoute('admin-users');\n\tconst canDirectMessage = usePermission('create-d');\n\tconst canEditOtherUserInfo = usePermission('edit-other-user-info');\n\n\tconst changeAdminStatusAction = useChangeAdminStatusAction(userId, isAdmin, onChange);\n\tconst changeUserStatusAction = useChangeUserStatusAction(userId, isActive, onChange);\n\tconst deleteUserAction = useDeleteUserAction(userId, onChange, onReload);\n\tconst resetTOTPAction = useResetTOTPAction(userId);\n\tconst resetE2EKeyAction = useResetE2EEKeyAction(userId);\n\n\tconst directMessageClick = useCallback(\n\t\t() =>\n\t\t\tusername &&\n\t\t\tdirectRoute.push({\n\t\t\t\trid: username,\n\t\t\t}),\n\t\t[directRoute, username],\n\t);\n\n\tconst editUserClick = useCallback(\n\t\t() =>\n\t\t\tuserRoute.push({\n\t\t\t\tcontext: 'edit',\n\t\t\t\tid: userId,\n\t\t\t}),\n\t\t[userId, userRoute],\n\t);\n\n\tconst isNotPendingDeactivatedNorFederated = tab !== 'pending' && tab !== 'deactivated' && !isFederatedUser;\n\tconst options = useMemo(\n\t\t() => ({\n\t\t\t...(canDirectMessage && {\n\t\t\t\tdirectMessage: {\n\t\t\t\t\ticon: 'balloon' as const,\n\t\t\t\t\tlabel: t('Direct_Message'),\n\t\t\t\t\ttitle: t('Direct_Message'),\n\t\t\t\t\taction: directMessageClick,\n\t\t\t\t},\n\t\t\t}),\n\t\t\t...(canEditOtherUserInfo && {\n\t\t\t\teditUser: {\n\t\t\t\t\ticon: 'edit' as const,\n\t\t\t\t\tlabel: t('Edit'),\n\t\t\t\t\ttitle: isFederatedUser ? t('Edit_Federated_User_Not_Allowed') : t('Edit'),\n\t\t\t\t\taction: editUserClick,\n\t\t\t\t\tdisabled: isFederatedUser,\n\t\t\t\t},\n\t\t\t}),\n\t\t\t...(isNotPendingDeactivatedNorFederated && changeAdminStatusAction && { makeAdmin: changeAdminStatusAction }),\n\t\t\t...(isNotPendingDeactivatedNorFederated && resetE2EKeyAction && { resetE2EKey: resetE2EKeyAction }),\n\t\t\t...(isNotPendingDeactivatedNorFederated && resetTOTPAction && { resetTOTP: resetTOTPAction }),\n\t\t\t...(changeUserStatusAction && !isFederatedUser && { changeActiveStatus: changeUserStatusAction }),\n\t\t\t...(deleteUserAction && { delete: deleteUserAction }),\n\t\t}),\n\t\t[\n\t\t\tcanDirectMessage,\n\t\t\tcanEditOtherUserInfo,\n\t\t\tchangeAdminStatusAction,\n\t\t\tchangeUserStatusAction,\n\t\t\tdeleteUserAction,\n\t\t\tdirectMessageClick,\n\t\t\teditUserClick,\n\t\t\tisFederatedUser,\n\t\t\tisNotPendingDeactivatedNorFederated,\n\t\t\tresetE2EKeyAction,\n\t\t\tresetTOTPAction,\n\t\t\tt,\n\t\t],\n\t);\n\n\tconst { actions: actionsDefinition, menu: menuOptions } = useActionSpread(options);\n\n\tconst menu = useMemo(() => {\n\t\tif (!menuOptions) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (\n\t\t\t<Menu\n\t\t\t\tmi={4}\n\t\t\t\tplacement='bottom-start'\n\t\t\t\tsmall={false}\n\t\t\t\tsecondary\n\t\t\t\tflexShrink={0}\n\t\t\t\tkey='menu'\n\t\t\t\trenderItem={({ label: { label, icon }, ...props }): ReactElement => (\n\t\t\t\t\t<Option label={label} title={label} icon={icon} variant={label === 'Delete' ? 'danger' : ''} {...props} />\n\t\t\t\t)}\n\t\t\t\toptions={menuOptions}\n\t\t\t/>\n\t\t);\n\t}, [menuOptions]);\n\n\t// TODO: sanitize Action type to avoid any\n\tconst actions = useMemo(() => {\n\t\tconst mapAction = ([key, { label, icon, action, disabled, title }]: any): ReactElement => (\n\t\t\t<UserInfoAction key={key} title={title} label={label} onClick={action} disabled={disabled} icon={icon} />\n\t\t);\n\t\treturn [...actionsDefinition.map(mapAction), menu].filter(Boolean);\n\t}, [actionsDefinition, menu]);\n\n\treturn (\n\t\t<ButtonGroup align='center' data-qa-id='UserInfoActions'>\n\t\t\t{actions}\n\t\t</ButtonGroup>\n\t);\n};\n\nexport default AdminUserInfoActions;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"04a04384817b2e77333edbd04b8bbcd16faccdd2"}
