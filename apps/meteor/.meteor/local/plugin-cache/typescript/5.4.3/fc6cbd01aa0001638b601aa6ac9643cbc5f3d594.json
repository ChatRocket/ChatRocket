{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/lib/server/lib/deprecationWarningLogger.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.arm64"},"sourceFileName":"app/lib/server/lib/deprecationWarningLogger.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/lib/server/lib/deprecationWarningLogger.ts","inputSourceMap":{"version":3,"file":"app/lib/server/lib/deprecationWarningLogger.ts","sourceRoot":"","sources":["app/lib/server/lib/deprecationWarningLogger.ts"],"names":[],"mappings":"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","sourcesContent":["import { Logger } from '@rocket.chat/logger';\nimport type { Response } from 'meteor/rocketchat:restivus';\nimport semver from 'semver';\n\nimport { metrics } from '../../../metrics/server';\n\nconst deprecationLogger = new Logger('DeprecationWarning');\n\ntype MessageFn<T> = (params: { parameter: string; version: string } & T) => string;\n\nconst throwErrorsForVersionsUnder = process.env.ROCKET_CHAT_DEPRECATION_THROW_ERRORS_FOR_VERSIONS_UNDER;\n\nconst writeDeprecationHeader = (res: Response | undefined, type: string, message: string, version: string) => {\n\tif (res) {\n\t\tres.setHeader('x-deprecation-type', type);\n\t\tres.setHeader('x-deprecation-message', message);\n\t\tres.setHeader('x-deprecation-version', version);\n\t}\n};\n\nconst compareVersions = (version: string, message: string) => {\n\tif (throwErrorsForVersionsUnder && semver.lte(version, throwErrorsForVersionsUnder)) {\n\t\tthrow new Error(message);\n\t}\n};\n\nexport const apiDeprecationLogger = ((logger) => {\n\treturn {\n\t\tendpoint: (endpoint: string, version: string, res: Response, info = '') => {\n\t\t\tconst message = `The endpoint \"${endpoint}\" is deprecated and will be removed on version ${version}${info ? ` (${info})` : ''}`;\n\n\t\t\tcompareVersions(version, message);\n\n\t\t\twriteDeprecationHeader(res, 'endpoint-deprecation', message, version);\n\n\t\t\tmetrics.deprecations.inc({ type: 'deprecation', kind: 'endpoint', name: endpoint });\n\n\t\t\tlogger.warn(message);\n\t\t},\n\t\tparameter: (\n\t\t\tendpoint: string,\n\t\t\tparameter: string,\n\t\t\tversion: string,\n\t\t\tres: Response,\n\t\t\tmessageGenerator?: MessageFn<{ endpoint: string }>,\n\t\t) => {\n\t\t\tconst message =\n\t\t\t\tmessageGenerator?.({\n\t\t\t\t\tparameter,\n\t\t\t\t\tendpoint,\n\t\t\t\t\tversion,\n\t\t\t\t}) ?? `The parameter \"${parameter}\" in the endpoint \"${endpoint}\" is deprecated and will be removed on version ${version}`;\n\t\t\tcompareVersions(version, message);\n\n\t\t\tmetrics.deprecations.inc({ type: 'parameter-deprecation', kind: 'endpoint', name: endpoint, params: parameter });\n\n\t\t\twriteDeprecationHeader(res, 'parameter-deprecation', message, version);\n\n\t\t\tlogger.warn(message);\n\t\t},\n\n\t\tdeprecatedParameterUsage: (\n\t\t\tendpoint: string,\n\t\t\tparameter: string,\n\t\t\tversion: string,\n\t\t\tres: Response,\n\t\t\tmessageGenerator?: MessageFn<{\n\t\t\t\tendpoint: string;\n\t\t\t}>,\n\t\t) => {\n\t\t\tconst message =\n\t\t\t\tmessageGenerator?.({\n\t\t\t\t\tparameter,\n\t\t\t\t\tendpoint,\n\t\t\t\t\tversion,\n\t\t\t\t}) ?? `The usage of the endpoint \"${endpoint}\" is deprecated and will be removed on version ${version}`;\n\t\t\tcompareVersions(version, message);\n\n\t\t\tmetrics.deprecations.inc({ type: 'invalid-usage', kind: 'endpoint', name: endpoint, params: parameter });\n\n\t\t\twriteDeprecationHeader(res, 'invalid-usage', message, version);\n\n\t\t\tlogger.warn(message);\n\t\t},\n\t};\n})(deprecationLogger.section('API'));\n\nexport const methodDeprecationLogger = ((logger) => {\n\treturn {\n\t\tmethod: (method: string, version: string, info = '') => {\n\t\t\tconst message = `The method \"${method}\" is deprecated and will be removed on version ${version}${info ? ` (${info})` : ''}`;\n\t\t\tcompareVersions(version, message);\n\t\t\tmetrics.deprecations.inc({ type: 'deprecation', name: method, kind: 'method' });\n\t\t\tlogger.warn(message);\n\t\t},\n\t\tparameter: (method: string, parameter: string, version: string) => {\n\t\t\tconst message = `The parameter \"${parameter}\" in the method \"${method}\" is deprecated and will be removed on version ${version}`;\n\n\t\t\tmetrics.deprecations.inc({ type: 'parameter-deprecation', name: method, params: parameter });\n\n\t\t\tcompareVersions(version, message);\n\t\t\tlogger.warn(message);\n\t\t},\n\t\tdeprecatedParameterUsage: (\n\t\t\tmethod: string,\n\t\t\tparameter: string,\n\t\t\tversion: string,\n\t\t\tmessageGenerator?: MessageFn<{\n\t\t\t\tmethod: string;\n\t\t\t}>,\n\t\t) => {\n\t\t\tconst message =\n\t\t\t\tmessageGenerator?.({\n\t\t\t\t\tparameter,\n\t\t\t\t\tmethod,\n\t\t\t\t\tversion,\n\t\t\t\t}) ?? `The usage of the method \"${method}\" is deprecated and will be removed on version ${version}`;\n\t\t\tcompareVersions(version, message);\n\n\t\t\tmetrics.deprecations.inc({ type: 'invalid-usage', name: method, params: parameter, kind: 'method' });\n\n\t\t\tlogger.warn(message);\n\t\t},\n\t\t/** @deprecated */\n\t\twarn: (message: string) => {\n\t\t\tcompareVersions('0.0.0', message);\n\t\t\tlogger.warn(message);\n\t\t},\n\t};\n})(deprecationLogger.section('METHOD'));\n\nexport const streamDeprecationLogger = deprecationLogger.section('STREAM');\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true,"topLevelAwait":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/lib/server/lib/deprecationWarningLogger.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/lib/server/lib/deprecationWarningLogger.ts","inputSourceMap":{"version":3,"file":"app/lib/server/lib/deprecationWarningLogger.ts","sourceRoot":"","sources":["app/lib/server/lib/deprecationWarningLogger.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,MAAM,EAAE,MAAM,qBAAqB,CAAC;AAE7C,OAAO,MAAM,MAAM,QAAQ,CAAC;AAE5B,OAAO,EAAE,OAAO,EAAE,MAAM,yBAAyB,CAAC;AAElD,MAAM,iBAAiB,GAAG,IAAI,MAAM,CAAC,oBAAoB,CAAC,CAAC;AAI3D,MAAM,2BAA2B,GAAG,OAAO,CAAC,GAAG,CAAC,uDAAuD,CAAC;AAExG,MAAM,sBAAsB,GAAG,CAAC,GAAyB,EAAE,IAAY,EAAE,OAAe,EAAE,OAAe,EAAE,EAAE;IAC5G,IAAI,GAAG,EAAE,CAAC;QACT,GAAG,CAAC,SAAS,CAAC,oBAAoB,EAAE,IAAI,CAAC,CAAC;QAC1C,GAAG,CAAC,SAAS,CAAC,uBAAuB,EAAE,OAAO,CAAC,CAAC;QAChD,GAAG,CAAC,SAAS,CAAC,uBAAuB,EAAE,OAAO,CAAC,CAAC;IACjD,CAAC;AACF,CAAC,CAAC;AAEF,MAAM,eAAe,GAAG,CAAC,OAAe,EAAE,OAAe,EAAE,EAAE;IAC5D,IAAI,2BAA2B,IAAI,MAAM,CAAC,GAAG,CAAC,OAAO,EAAE,2BAA2B,CAAC,EAAE,CAAC;QACrF,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC;IAC1B,CAAC;AACF,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,oBAAoB,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE;IAC/C,OAAO;QACN,QAAQ,EAAE,CAAC,QAAgB,EAAE,OAAe,EAAE,GAAa,EAAE,IAAI,GAAG,EAAE,EAAE,EAAE;YACzE,MAAM,OAAO,GAAG,iBAAiB,QAAQ,kDAAkD,OAAO,GAAG,IAAI,CAAC,CAAC,CAAC,KAAK,IAAI,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;YAEhI,eAAe,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;YAElC,sBAAsB,CAAC,GAAG,EAAE,sBAAsB,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;YAEtE,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,CAAC;YAEpF,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACtB,CAAC;QACD,SAAS,EAAE,CACV,QAAgB,EAChB,SAAiB,EACjB,OAAe,EACf,GAAa,EACb,gBAAkD,EACjD,EAAE;YACH,MAAM,OAAO,GACZ,gBAAgB,EAAE,CAAC;gBAClB,SAAS;gBACT,QAAQ;gBACR,OAAO;aACP,CAAC,IAAI,kBAAkB,SAAS,sBAAsB,QAAQ,kDAAkD,OAAO,EAAE,CAAC;YAC5H,eAAe,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;YAElC,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,uBAAuB,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,SAAS,EAAE,CAAC,CAAC;YAEjH,sBAAsB,CAAC,GAAG,EAAE,uBAAuB,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;YAEvE,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACtB,CAAC;QAED,wBAAwB,EAAE,CACzB,QAAgB,EAChB,SAAiB,EACjB,OAAe,EACf,GAAa,EACb,gBAEE,EACD,EAAE;YACH,MAAM,OAAO,GACZ,gBAAgB,EAAE,CAAC;gBAClB,SAAS;gBACT,QAAQ;gBACR,OAAO;aACP,CAAC,IAAI,8BAA8B,QAAQ,kDAAkD,OAAO,EAAE,CAAC;YACzG,eAAe,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;YAElC,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,eAAe,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,SAAS,EAAE,CAAC,CAAC;YAEzG,sBAAsB,CAAC,GAAG,EAAE,eAAe,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;YAE/D,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACtB,CAAC;KACD,CAAC;AACH,CAAC,CAAC,CAAC,iBAAiB,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC;AAErC,MAAM,CAAC,MAAM,uBAAuB,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE;IAClD,OAAO;QACN,MAAM,EAAE,CAAC,MAAc,EAAE,OAAe,EAAE,IAAI,GAAG,EAAE,EAAE,EAAE;YACtD,MAAM,OAAO,GAAG,eAAe,MAAM,kDAAkD,OAAO,GAAG,IAAI,CAAC,CAAC,CAAC,KAAK,IAAI,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;YAC5H,eAAe,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;YAClC,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,CAAC;YAChF,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACtB,CAAC;QACD,SAAS,EAAE,CAAC,MAAc,EAAE,SAAiB,EAAE,OAAe,EAAE,EAAE;YACjE,MAAM,OAAO,GAAG,kBAAkB,SAAS,oBAAoB,MAAM,kDAAkD,OAAO,EAAE,CAAC;YAEjI,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,uBAAuB,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,CAAC,CAAC;YAE7F,eAAe,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;YAClC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACtB,CAAC;QACD,wBAAwB,EAAE,CACzB,MAAc,EACd,SAAiB,EACjB,OAAe,EACf,gBAEE,EACD,EAAE;YACH,MAAM,OAAO,GACZ,gBAAgB,EAAE,CAAC;gBAClB,SAAS;gBACT,MAAM;gBACN,OAAO;aACP,CAAC,IAAI,4BAA4B,MAAM,kDAAkD,OAAO,EAAE,CAAC;YACrG,eAAe,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;YAElC,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,eAAe,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,CAAC;YAErG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACtB,CAAC;QACD,kBAAkB;QAClB,IAAI,EAAE,CAAC,OAAe,EAAE,EAAE;YACzB,eAAe,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;YAClC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACtB,CAAC;KACD,CAAC;AACH,CAAC,CAAC,CAAC,iBAAiB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC;AAExC,MAAM,CAAC,MAAM,uBAAuB,GAAG,iBAAiB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC","sourcesContent":["import { Logger } from '@rocket.chat/logger';\nimport type { Response } from 'meteor/rocketchat:restivus';\nimport semver from 'semver';\n\nimport { metrics } from '../../../metrics/server';\n\nconst deprecationLogger = new Logger('DeprecationWarning');\n\ntype MessageFn<T> = (params: { parameter: string; version: string } & T) => string;\n\nconst throwErrorsForVersionsUnder = process.env.ROCKET_CHAT_DEPRECATION_THROW_ERRORS_FOR_VERSIONS_UNDER;\n\nconst writeDeprecationHeader = (res: Response | undefined, type: string, message: string, version: string) => {\n\tif (res) {\n\t\tres.setHeader('x-deprecation-type', type);\n\t\tres.setHeader('x-deprecation-message', message);\n\t\tres.setHeader('x-deprecation-version', version);\n\t}\n};\n\nconst compareVersions = (version: string, message: string) => {\n\tif (throwErrorsForVersionsUnder && semver.lte(version, throwErrorsForVersionsUnder)) {\n\t\tthrow new Error(message);\n\t}\n};\n\nexport const apiDeprecationLogger = ((logger) => {\n\treturn {\n\t\tendpoint: (endpoint: string, version: string, res: Response, info = '') => {\n\t\t\tconst message = `The endpoint \"${endpoint}\" is deprecated and will be removed on version ${version}${info ? ` (${info})` : ''}`;\n\n\t\t\tcompareVersions(version, message);\n\n\t\t\twriteDeprecationHeader(res, 'endpoint-deprecation', message, version);\n\n\t\t\tmetrics.deprecations.inc({ type: 'deprecation', kind: 'endpoint', name: endpoint });\n\n\t\t\tlogger.warn(message);\n\t\t},\n\t\tparameter: (\n\t\t\tendpoint: string,\n\t\t\tparameter: string,\n\t\t\tversion: string,\n\t\t\tres: Response,\n\t\t\tmessageGenerator?: MessageFn<{ endpoint: string }>,\n\t\t) => {\n\t\t\tconst message =\n\t\t\t\tmessageGenerator?.({\n\t\t\t\t\tparameter,\n\t\t\t\t\tendpoint,\n\t\t\t\t\tversion,\n\t\t\t\t}) ?? `The parameter \"${parameter}\" in the endpoint \"${endpoint}\" is deprecated and will be removed on version ${version}`;\n\t\t\tcompareVersions(version, message);\n\n\t\t\tmetrics.deprecations.inc({ type: 'parameter-deprecation', kind: 'endpoint', name: endpoint, params: parameter });\n\n\t\t\twriteDeprecationHeader(res, 'parameter-deprecation', message, version);\n\n\t\t\tlogger.warn(message);\n\t\t},\n\n\t\tdeprecatedParameterUsage: (\n\t\t\tendpoint: string,\n\t\t\tparameter: string,\n\t\t\tversion: string,\n\t\t\tres: Response,\n\t\t\tmessageGenerator?: MessageFn<{\n\t\t\t\tendpoint: string;\n\t\t\t}>,\n\t\t) => {\n\t\t\tconst message =\n\t\t\t\tmessageGenerator?.({\n\t\t\t\t\tparameter,\n\t\t\t\t\tendpoint,\n\t\t\t\t\tversion,\n\t\t\t\t}) ?? `The usage of the endpoint \"${endpoint}\" is deprecated and will be removed on version ${version}`;\n\t\t\tcompareVersions(version, message);\n\n\t\t\tmetrics.deprecations.inc({ type: 'invalid-usage', kind: 'endpoint', name: endpoint, params: parameter });\n\n\t\t\twriteDeprecationHeader(res, 'invalid-usage', message, version);\n\n\t\t\tlogger.warn(message);\n\t\t},\n\t};\n})(deprecationLogger.section('API'));\n\nexport const methodDeprecationLogger = ((logger) => {\n\treturn {\n\t\tmethod: (method: string, version: string, info = '') => {\n\t\t\tconst message = `The method \"${method}\" is deprecated and will be removed on version ${version}${info ? ` (${info})` : ''}`;\n\t\t\tcompareVersions(version, message);\n\t\t\tmetrics.deprecations.inc({ type: 'deprecation', name: method, kind: 'method' });\n\t\t\tlogger.warn(message);\n\t\t},\n\t\tparameter: (method: string, parameter: string, version: string) => {\n\t\t\tconst message = `The parameter \"${parameter}\" in the method \"${method}\" is deprecated and will be removed on version ${version}`;\n\n\t\t\tmetrics.deprecations.inc({ type: 'parameter-deprecation', name: method, params: parameter });\n\n\t\t\tcompareVersions(version, message);\n\t\t\tlogger.warn(message);\n\t\t},\n\t\tdeprecatedParameterUsage: (\n\t\t\tmethod: string,\n\t\t\tparameter: string,\n\t\t\tversion: string,\n\t\t\tmessageGenerator?: MessageFn<{\n\t\t\t\tmethod: string;\n\t\t\t}>,\n\t\t) => {\n\t\t\tconst message =\n\t\t\t\tmessageGenerator?.({\n\t\t\t\t\tparameter,\n\t\t\t\t\tmethod,\n\t\t\t\t\tversion,\n\t\t\t\t}) ?? `The usage of the method \"${method}\" is deprecated and will be removed on version ${version}`;\n\t\t\tcompareVersions(version, message);\n\n\t\t\tmetrics.deprecations.inc({ type: 'invalid-usage', name: method, params: parameter, kind: 'method' });\n\n\t\t\tlogger.warn(message);\n\t\t},\n\t\t/** @deprecated */\n\t\twarn: (message: string) => {\n\t\t\tcompareVersions('0.0.0', message);\n\t\t\tlogger.warn(message);\n\t\t},\n\t};\n})(deprecationLogger.section('METHOD'));\n\nexport const streamDeprecationLogger = deprecationLogger.section('STREAM');\n"]}}},"code":"!module.wrapAsync(async function (module, __reifyWaitForDeps__, __reify_async_result__) {\n  \"use strict\";\n  try {\n    module.export({\n      apiDeprecationLogger: () => apiDeprecationLogger,\n      methodDeprecationLogger: () => methodDeprecationLogger,\n      streamDeprecationLogger: () => streamDeprecationLogger\n    });\n    let Logger;\n    module.link(\"@rocket.chat/logger\", {\n      Logger(v) {\n        Logger = v;\n      }\n    }, 0);\n    let semver;\n    module.link(\"semver\", {\n      default(v) {\n        semver = v;\n      }\n    }, 1);\n    let metrics;\n    module.link(\"../../../metrics/server\", {\n      metrics(v) {\n        metrics = v;\n      }\n    }, 2);\n    if (__reifyWaitForDeps__()) (await __reifyWaitForDeps__())();\n    const deprecationLogger = new Logger('DeprecationWarning');\n    const throwErrorsForVersionsUnder = process.env.ROCKET_CHAT_DEPRECATION_THROW_ERRORS_FOR_VERSIONS_UNDER;\n    const writeDeprecationHeader = (res, type, message, version) => {\n      if (res) {\n        res.setHeader('x-deprecation-type', type);\n        res.setHeader('x-deprecation-message', message);\n        res.setHeader('x-deprecation-version', version);\n      }\n    };\n    const compareVersions = (version, message) => {\n      if (throwErrorsForVersionsUnder && semver.lte(version, throwErrorsForVersionsUnder)) {\n        throw new Error(message);\n      }\n    };\n    const apiDeprecationLogger = (logger => {\n      return {\n        endpoint: function (endpoint, version, res) {\n          let info = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';\n          const message = \"The endpoint \\\"\".concat(endpoint, \"\\\" is deprecated and will be removed on version \").concat(version).concat(info ? \" (\".concat(info, \")\") : '');\n          compareVersions(version, message);\n          writeDeprecationHeader(res, 'endpoint-deprecation', message, version);\n          metrics.deprecations.inc({\n            type: 'deprecation',\n            kind: 'endpoint',\n            name: endpoint\n          });\n          logger.warn(message);\n        },\n        parameter: (endpoint, parameter, version, res, messageGenerator) => {\n          var _messageGenerator;\n          const message = (_messageGenerator = messageGenerator === null || messageGenerator === void 0 ? void 0 : messageGenerator({\n            parameter,\n            endpoint,\n            version\n          })) !== null && _messageGenerator !== void 0 ? _messageGenerator : \"The parameter \\\"\".concat(parameter, \"\\\" in the endpoint \\\"\").concat(endpoint, \"\\\" is deprecated and will be removed on version \").concat(version);\n          compareVersions(version, message);\n          metrics.deprecations.inc({\n            type: 'parameter-deprecation',\n            kind: 'endpoint',\n            name: endpoint,\n            params: parameter\n          });\n          writeDeprecationHeader(res, 'parameter-deprecation', message, version);\n          logger.warn(message);\n        },\n        deprecatedParameterUsage: (endpoint, parameter, version, res, messageGenerator) => {\n          var _messageGenerator2;\n          const message = (_messageGenerator2 = messageGenerator === null || messageGenerator === void 0 ? void 0 : messageGenerator({\n            parameter,\n            endpoint,\n            version\n          })) !== null && _messageGenerator2 !== void 0 ? _messageGenerator2 : \"The usage of the endpoint \\\"\".concat(endpoint, \"\\\" is deprecated and will be removed on version \").concat(version);\n          compareVersions(version, message);\n          metrics.deprecations.inc({\n            type: 'invalid-usage',\n            kind: 'endpoint',\n            name: endpoint,\n            params: parameter\n          });\n          writeDeprecationHeader(res, 'invalid-usage', message, version);\n          logger.warn(message);\n        }\n      };\n    })(deprecationLogger.section('API'));\n    const methodDeprecationLogger = (logger => {\n      return {\n        method: function (method, version) {\n          let info = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';\n          const message = \"The method \\\"\".concat(method, \"\\\" is deprecated and will be removed on version \").concat(version).concat(info ? \" (\".concat(info, \")\") : '');\n          compareVersions(version, message);\n          metrics.deprecations.inc({\n            type: 'deprecation',\n            name: method,\n            kind: 'method'\n          });\n          logger.warn(message);\n        },\n        parameter: (method, parameter, version) => {\n          const message = \"The parameter \\\"\".concat(parameter, \"\\\" in the method \\\"\").concat(method, \"\\\" is deprecated and will be removed on version \").concat(version);\n          metrics.deprecations.inc({\n            type: 'parameter-deprecation',\n            name: method,\n            params: parameter\n          });\n          compareVersions(version, message);\n          logger.warn(message);\n        },\n        deprecatedParameterUsage: (method, parameter, version, messageGenerator) => {\n          var _messageGenerator3;\n          const message = (_messageGenerator3 = messageGenerator === null || messageGenerator === void 0 ? void 0 : messageGenerator({\n            parameter,\n            method,\n            version\n          })) !== null && _messageGenerator3 !== void 0 ? _messageGenerator3 : \"The usage of the method \\\"\".concat(method, \"\\\" is deprecated and will be removed on version \").concat(version);\n          compareVersions(version, message);\n          metrics.deprecations.inc({\n            type: 'invalid-usage',\n            name: method,\n            params: parameter,\n            kind: 'method'\n          });\n          logger.warn(message);\n        },\n        /** @deprecated */\n        warn: message => {\n          compareVersions('0.0.0', message);\n          logger.warn(message);\n        }\n      };\n    })(deprecationLogger.section('METHOD'));\n    const streamDeprecationLogger = deprecationLogger.section('STREAM');\n    __reify_async_result__();\n  } catch (_reifyError) {\n    return __reify_async_result__(_reifyError);\n  }\n  __reify_async_result__()\n}, {\n  self: this,\n  async: false\n});","map":{"version":3,"names":["module","export","apiDeprecationLogger","methodDeprecationLogger","streamDeprecationLogger","Logger","link","v","semver","default","metrics","__reifyWaitForDeps__","deprecationLogger","throwErrorsForVersionsUnder","process","env","ROCKET_CHAT_DEPRECATION_THROW_ERRORS_FOR_VERSIONS_UNDER","writeDeprecationHeader","res","type","message","version","setHeader","compareVersions","lte","Error","logger","endpoint","info","arguments","length","undefined","concat","deprecations","inc","kind","name","warn","parameter","messageGenerator","_messageGenerator","params","deprecatedParameterUsage","_messageGenerator2","section","method","_messageGenerator3","__reify_async_result__","_reifyError","self","async"],"sources":["app/lib/server/lib/deprecationWarningLogger.ts"],"sourcesContent":["import { Logger } from '@rocket.chat/logger';\nimport type { Response } from 'meteor/rocketchat:restivus';\nimport semver from 'semver';\n\nimport { metrics } from '../../../metrics/server';\n\nconst deprecationLogger = new Logger('DeprecationWarning');\n\ntype MessageFn<T> = (params: { parameter: string; version: string } & T) => string;\n\nconst throwErrorsForVersionsUnder = process.env.ROCKET_CHAT_DEPRECATION_THROW_ERRORS_FOR_VERSIONS_UNDER;\n\nconst writeDeprecationHeader = (res: Response | undefined, type: string, message: string, version: string) => {\n\tif (res) {\n\t\tres.setHeader('x-deprecation-type', type);\n\t\tres.setHeader('x-deprecation-message', message);\n\t\tres.setHeader('x-deprecation-version', version);\n\t}\n};\n\nconst compareVersions = (version: string, message: string) => {\n\tif (throwErrorsForVersionsUnder && semver.lte(version, throwErrorsForVersionsUnder)) {\n\t\tthrow new Error(message);\n\t}\n};\n\nexport const apiDeprecationLogger = ((logger) => {\n\treturn {\n\t\tendpoint: (endpoint: string, version: string, res: Response, info = '') => {\n\t\t\tconst message = `The endpoint \"${endpoint}\" is deprecated and will be removed on version ${version}${info ? ` (${info})` : ''}`;\n\n\t\t\tcompareVersions(version, message);\n\n\t\t\twriteDeprecationHeader(res, 'endpoint-deprecation', message, version);\n\n\t\t\tmetrics.deprecations.inc({ type: 'deprecation', kind: 'endpoint', name: endpoint });\n\n\t\t\tlogger.warn(message);\n\t\t},\n\t\tparameter: (\n\t\t\tendpoint: string,\n\t\t\tparameter: string,\n\t\t\tversion: string,\n\t\t\tres: Response,\n\t\t\tmessageGenerator?: MessageFn<{ endpoint: string }>,\n\t\t) => {\n\t\t\tconst message =\n\t\t\t\tmessageGenerator?.({\n\t\t\t\t\tparameter,\n\t\t\t\t\tendpoint,\n\t\t\t\t\tversion,\n\t\t\t\t}) ?? `The parameter \"${parameter}\" in the endpoint \"${endpoint}\" is deprecated and will be removed on version ${version}`;\n\t\t\tcompareVersions(version, message);\n\n\t\t\tmetrics.deprecations.inc({ type: 'parameter-deprecation', kind: 'endpoint', name: endpoint, params: parameter });\n\n\t\t\twriteDeprecationHeader(res, 'parameter-deprecation', message, version);\n\n\t\t\tlogger.warn(message);\n\t\t},\n\n\t\tdeprecatedParameterUsage: (\n\t\t\tendpoint: string,\n\t\t\tparameter: string,\n\t\t\tversion: string,\n\t\t\tres: Response,\n\t\t\tmessageGenerator?: MessageFn<{\n\t\t\t\tendpoint: string;\n\t\t\t}>,\n\t\t) => {\n\t\t\tconst message =\n\t\t\t\tmessageGenerator?.({\n\t\t\t\t\tparameter,\n\t\t\t\t\tendpoint,\n\t\t\t\t\tversion,\n\t\t\t\t}) ?? `The usage of the endpoint \"${endpoint}\" is deprecated and will be removed on version ${version}`;\n\t\t\tcompareVersions(version, message);\n\n\t\t\tmetrics.deprecations.inc({ type: 'invalid-usage', kind: 'endpoint', name: endpoint, params: parameter });\n\n\t\t\twriteDeprecationHeader(res, 'invalid-usage', message, version);\n\n\t\t\tlogger.warn(message);\n\t\t},\n\t};\n})(deprecationLogger.section('API'));\n\nexport const methodDeprecationLogger = ((logger) => {\n\treturn {\n\t\tmethod: (method: string, version: string, info = '') => {\n\t\t\tconst message = `The method \"${method}\" is deprecated and will be removed on version ${version}${info ? ` (${info})` : ''}`;\n\t\t\tcompareVersions(version, message);\n\t\t\tmetrics.deprecations.inc({ type: 'deprecation', name: method, kind: 'method' });\n\t\t\tlogger.warn(message);\n\t\t},\n\t\tparameter: (method: string, parameter: string, version: string) => {\n\t\t\tconst message = `The parameter \"${parameter}\" in the method \"${method}\" is deprecated and will be removed on version ${version}`;\n\n\t\t\tmetrics.deprecations.inc({ type: 'parameter-deprecation', name: method, params: parameter });\n\n\t\t\tcompareVersions(version, message);\n\t\t\tlogger.warn(message);\n\t\t},\n\t\tdeprecatedParameterUsage: (\n\t\t\tmethod: string,\n\t\t\tparameter: string,\n\t\t\tversion: string,\n\t\t\tmessageGenerator?: MessageFn<{\n\t\t\t\tmethod: string;\n\t\t\t}>,\n\t\t) => {\n\t\t\tconst message =\n\t\t\t\tmessageGenerator?.({\n\t\t\t\t\tparameter,\n\t\t\t\t\tmethod,\n\t\t\t\t\tversion,\n\t\t\t\t}) ?? `The usage of the method \"${method}\" is deprecated and will be removed on version ${version}`;\n\t\t\tcompareVersions(version, message);\n\n\t\t\tmetrics.deprecations.inc({ type: 'invalid-usage', name: method, params: parameter, kind: 'method' });\n\n\t\t\tlogger.warn(message);\n\t\t},\n\t\t/** @deprecated */\n\t\twarn: (message: string) => {\n\t\t\tcompareVersions('0.0.0', message);\n\t\t\tlogger.warn(message);\n\t\t},\n\t};\n})(deprecationLogger.section('METHOD'));\n\nexport const streamDeprecationLogger = deprecationLogger.section('STREAM');\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"fc6cbd01aa0001638b601aa6ac9643cbc5f3d594"}
