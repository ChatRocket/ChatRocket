{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/analytics/client/loadScript.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"app/analytics/client/loadScript.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/analytics/client/loadScript.ts","inputSourceMap":{"version":3,"file":"app/analytics/client/loadScript.ts","sourceRoot":"","sources":["app/analytics/client/loadScript.ts"],"names":[],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { useEffect } from 'react';\n\nimport { useReactiveValue } from '../../../client/hooks/useReactiveValue';\nimport { settings } from '../../settings/client';\n\ndeclare global {\n\t// eslint-disable-next-line @typescript-eslint/naming-convention\n\tinterface Window {\n\t\t_paq?: [string, ...unknown[]][];\n\t\tGoogleAnalyticsObject: unknown;\n\t\tga?: qa;\n\t}\n\n\ttype qa = {\n\t\t(...args: unknown[]): void;\n\t\tl?: number;\n\t\tq?: unknown[];\n\t};\n}\n\nexport const useAnalytics = (): void => {\n\tconst uid = useReactiveValue(() => Meteor.userId());\n\n\tconst googleId = useReactiveValue(() => settings.get('GoogleAnalytics_enabled') && settings.get('GoogleAnalytics_ID'));\n\tconst piwikUrl = useReactiveValue(() => settings.get('PiwikAnalytics_enabled') && settings.get('PiwikAnalytics_url'));\n\n\tuseEffect(() => {\n\t\tif (uid) {\n\t\t\twindow._paq = window._paq || [];\n\t\t\twindow._paq.push(['setUserId', uid]);\n\t\t}\n\t});\n\n\tuseEffect(() => {\n\t\tif (!googleId) {\n\t\t\treturn;\n\t\t}\n\t\tif (googleId.startsWith('G-')) {\n\t\t\t// Google Analytics 4\n\t\t\tconst f = document.getElementsByTagName('script')[0];\n\t\t\tconst j = document.createElement('script');\n\t\t\tj.async = true;\n\t\t\tj.src = `//www.googletagmanager.com/gtag/js?id=${googleId}`;\n\t\t\tf.parentNode?.insertBefore(j, f);\n\n\t\t\t// injecting the dataLayer into the windows global object\n\t\t\tconst w: Window & { dataLayer?: any } = window;\n\t\t\tconst dataLayer = w.dataLayer || [];\n\t\t\tconst gtag = (key: string, value: any) => {\n\t\t\t\tdataLayer.push(key, value);\n\t\t\t};\n\t\t\tgtag('js', new Date());\n\t\t\tgtag('config', googleId);\n\t\t} else {\n\t\t\t// Google Analytics 3\n\t\t\t(function (i, s, o, g, r: 'ga', a?: any, m?: any) {\n\t\t\t\ti.GoogleAnalyticsObject = r;\n\t\t\t\t(i[r] =\n\t\t\t\t\ti[r] ||\n\t\t\t\t\tfunction (...args) {\n\t\t\t\t\t\t((i[r] as any).q = (i[r] as any).q || []).push(args);\n\t\t\t\t\t\t// eslint-disable-next-line no-sequences\n\t\t\t\t\t}),\n\t\t\t\t\t((i[r] as any).l = new Date().getTime());\n\t\t\t\t// eslint-disable-next-line no-sequences\n\t\t\t\t(a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);\n\t\t\t\ta.async = 1;\n\t\t\t\ta.src = g;\n\t\t\t\tm.parentNode.insertBefore(a, m);\n\t\t\t})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');\n\n\t\t\twindow.ga?.('create', googleId, 'auto');\n\t\t\twindow.ga?.('send', 'pageview');\n\t\t}\n\t}, [googleId, uid]);\n\n\tuseEffect(() => {\n\t\tif (!piwikUrl) {\n\t\t\tdocument.getElementById('piwik-analytics')?.remove();\n\t\t\twindow._paq = [];\n\t\t\treturn;\n\t\t}\n\n\t\tconst piwikSiteId = piwikUrl && settings.get('PiwikAnalytics_siteId');\n\t\tconst piwikPrependDomain = piwikUrl && settings.get('PiwikAnalytics_prependDomain');\n\t\tconst piwikCookieDomain = piwikUrl && settings.get('PiwikAnalytics_cookieDomain');\n\t\tconst piwikDomains = piwikUrl && settings.get('PiwikAnalytics_domains');\n\t\tconst piwikAdditionalTracker = piwikUrl && settings.get('PiwikAdditionalTrackers');\n\t\twindow._paq = window._paq || [];\n\n\t\twindow._paq.push(['trackPageView']);\n\t\twindow._paq.push(['enableLinkTracking']);\n\t\tif (piwikPrependDomain) {\n\t\t\twindow._paq.push(['setDocumentTitle', `${window.location.hostname}/${document.title}`]);\n\t\t}\n\t\tconst upperLevelDomain = `*.${window.location.hostname.split('.').slice(1).join('.')}`;\n\t\tif (piwikCookieDomain) {\n\t\t\twindow._paq.push(['setCookieDomain', upperLevelDomain]);\n\t\t}\n\t\tif (piwikDomains) {\n\t\t\t// array\n\t\t\tconst domainsArray = piwikDomains.split(/\\n/);\n\t\t\tconst domains = [];\n\t\t\tfor (let i = 0; i < domainsArray.length; i++) {\n\t\t\t\t// only push domain if it contains a non whitespace character.\n\t\t\t\tif (/\\S/.test(domainsArray[i])) {\n\t\t\t\t\tdomains.push(`*.${domainsArray[i].trim()}`);\n\t\t\t\t}\n\t\t\t}\n\t\t\twindow._paq.push(['setDomains', domains]);\n\t\t}\n\t\t(() => {\n\t\t\ttry {\n\t\t\t\tif (/\\S/.test(piwikAdditionalTracker)) {\n\t\t\t\t\t// piwikAdditionalTracker is not empty or whitespace only\n\t\t\t\t\tconst addTrackers = JSON.parse(piwikAdditionalTracker);\n\t\t\t\t\tfor (let i = 0; i < addTrackers.length; i++) {\n\t\t\t\t\t\tconst tracker = addTrackers[i];\n\t\t\t\t\t\twindow._paq.push(['addTracker', `${tracker.trackerURL}js/`, tracker.siteId]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t// parsing JSON faild\n\t\t\t\tconsole.log('Error while parsing JSON value of \"piwikAdditionalTracker\": ', e);\n\t\t\t}\n\t\t\twindow._paq.push(['setTrackerUrl', `${piwikUrl}js/`]);\n\t\t\twindow._paq.push(['setSiteId', Number.parseInt(piwikSiteId)]);\n\t\t\tconst d = document;\n\t\t\tconst g = d.createElement('script');\n\t\t\tg.setAttribute('id', 'piwik-analytics');\n\t\t\tconst s = d.getElementsByTagName('script')[0];\n\t\t\tg.type = 'text/javascript';\n\t\t\tg.async = true;\n\t\t\tg.defer = true;\n\t\t\tg.src = `${piwikUrl}js/`;\n\t\t\ts.parentNode?.insertBefore(g, s);\n\t\t})();\n\t}, [piwikUrl]);\n};\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/analytics/client/loadScript.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/analytics/client/loadScript.ts","inputSourceMap":{"version":3,"file":"app/analytics/client/loadScript.ts","sourceRoot":"","sources":["app/analytics/client/loadScript.ts"],"names":[],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { useEffect } from 'react';\n\nimport { useReactiveValue } from '../../../client/hooks/useReactiveValue';\nimport { settings } from '../../settings/client';\n\ndeclare global {\n\t// eslint-disable-next-line @typescript-eslint/naming-convention\n\tinterface Window {\n\t\t_paq?: [string, ...unknown[]][];\n\t\tGoogleAnalyticsObject: unknown;\n\t\tga?: qa;\n\t}\n\n\ttype qa = {\n\t\t(...args: unknown[]): void;\n\t\tl?: number;\n\t\tq?: unknown[];\n\t};\n}\n\nexport const useAnalytics = (): void => {\n\tconst uid = useReactiveValue(() => Meteor.userId());\n\n\tconst googleId = useReactiveValue(() => settings.get('GoogleAnalytics_enabled') && settings.get('GoogleAnalytics_ID'));\n\tconst piwikUrl = useReactiveValue(() => settings.get('PiwikAnalytics_enabled') && settings.get('PiwikAnalytics_url'));\n\n\tuseEffect(() => {\n\t\tif (uid) {\n\t\t\twindow._paq = window._paq || [];\n\t\t\twindow._paq.push(['setUserId', uid]);\n\t\t}\n\t});\n\n\tuseEffect(() => {\n\t\tif (!googleId) {\n\t\t\treturn;\n\t\t}\n\t\tif (googleId.startsWith('G-')) {\n\t\t\t// Google Analytics 4\n\t\t\tconst f = document.getElementsByTagName('script')[0];\n\t\t\tconst j = document.createElement('script');\n\t\t\tj.async = true;\n\t\t\tj.src = `//www.googletagmanager.com/gtag/js?id=${googleId}`;\n\t\t\tf.parentNode?.insertBefore(j, f);\n\n\t\t\t// injecting the dataLayer into the windows global object\n\t\t\tconst w: Window & { dataLayer?: any } = window;\n\t\t\tconst dataLayer = w.dataLayer || [];\n\t\t\tconst gtag = (key: string, value: any) => {\n\t\t\t\tdataLayer.push(key, value);\n\t\t\t};\n\t\t\tgtag('js', new Date());\n\t\t\tgtag('config', googleId);\n\t\t} else {\n\t\t\t// Google Analytics 3\n\t\t\t(function (i, s, o, g, r: 'ga', a?: any, m?: any) {\n\t\t\t\ti.GoogleAnalyticsObject = r;\n\t\t\t\t(i[r] =\n\t\t\t\t\ti[r] ||\n\t\t\t\t\tfunction (...args) {\n\t\t\t\t\t\t((i[r] as any).q = (i[r] as any).q || []).push(args);\n\t\t\t\t\t\t// eslint-disable-next-line no-sequences\n\t\t\t\t\t}),\n\t\t\t\t\t((i[r] as any).l = new Date().getTime());\n\t\t\t\t// eslint-disable-next-line no-sequences\n\t\t\t\t(a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);\n\t\t\t\ta.async = 1;\n\t\t\t\ta.src = g;\n\t\t\t\tm.parentNode.insertBefore(a, m);\n\t\t\t})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');\n\n\t\t\twindow.ga?.('create', googleId, 'auto');\n\t\t\twindow.ga?.('send', 'pageview');\n\t\t}\n\t}, [googleId, uid]);\n\n\tuseEffect(() => {\n\t\tif (!piwikUrl) {\n\t\t\tdocument.getElementById('piwik-analytics')?.remove();\n\t\t\twindow._paq = [];\n\t\t\treturn;\n\t\t}\n\n\t\tconst piwikSiteId = piwikUrl && settings.get('PiwikAnalytics_siteId');\n\t\tconst piwikPrependDomain = piwikUrl && settings.get('PiwikAnalytics_prependDomain');\n\t\tconst piwikCookieDomain = piwikUrl && settings.get('PiwikAnalytics_cookieDomain');\n\t\tconst piwikDomains = piwikUrl && settings.get('PiwikAnalytics_domains');\n\t\tconst piwikAdditionalTracker = piwikUrl && settings.get('PiwikAdditionalTrackers');\n\t\twindow._paq = window._paq || [];\n\n\t\twindow._paq.push(['trackPageView']);\n\t\twindow._paq.push(['enableLinkTracking']);\n\t\tif (piwikPrependDomain) {\n\t\t\twindow._paq.push(['setDocumentTitle', `${window.location.hostname}/${document.title}`]);\n\t\t}\n\t\tconst upperLevelDomain = `*.${window.location.hostname.split('.').slice(1).join('.')}`;\n\t\tif (piwikCookieDomain) {\n\t\t\twindow._paq.push(['setCookieDomain', upperLevelDomain]);\n\t\t}\n\t\tif (piwikDomains) {\n\t\t\t// array\n\t\t\tconst domainsArray = piwikDomains.split(/\\n/);\n\t\t\tconst domains = [];\n\t\t\tfor (let i = 0; i < domainsArray.length; i++) {\n\t\t\t\t// only push domain if it contains a non whitespace character.\n\t\t\t\tif (/\\S/.test(domainsArray[i])) {\n\t\t\t\t\tdomains.push(`*.${domainsArray[i].trim()}`);\n\t\t\t\t}\n\t\t\t}\n\t\t\twindow._paq.push(['setDomains', domains]);\n\t\t}\n\t\t(() => {\n\t\t\ttry {\n\t\t\t\tif (/\\S/.test(piwikAdditionalTracker)) {\n\t\t\t\t\t// piwikAdditionalTracker is not empty or whitespace only\n\t\t\t\t\tconst addTrackers = JSON.parse(piwikAdditionalTracker);\n\t\t\t\t\tfor (let i = 0; i < addTrackers.length; i++) {\n\t\t\t\t\t\tconst tracker = addTrackers[i];\n\t\t\t\t\t\twindow._paq.push(['addTracker', `${tracker.trackerURL}js/`, tracker.siteId]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t// parsing JSON faild\n\t\t\t\tconsole.log('Error while parsing JSON value of \"piwikAdditionalTracker\": ', e);\n\t\t\t}\n\t\t\twindow._paq.push(['setTrackerUrl', `${piwikUrl}js/`]);\n\t\t\twindow._paq.push(['setSiteId', Number.parseInt(piwikSiteId)]);\n\t\t\tconst d = document;\n\t\t\tconst g = d.createElement('script');\n\t\t\tg.setAttribute('id', 'piwik-analytics');\n\t\t\tconst s = d.getElementsByTagName('script')[0];\n\t\t\tg.type = 'text/javascript';\n\t\t\tg.async = true;\n\t\t\tg.defer = true;\n\t\t\tg.src = `${piwikUrl}js/`;\n\t\t\ts.parentNode?.insertBefore(g, s);\n\t\t})();\n\t}, [piwikUrl]);\n};\n"]}}},"code":"module.export({\n  useAnalytics: function () {\n    return useAnalytics;\n  }\n});\nvar Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar useEffect;\nmodule.link(\"react\", {\n  useEffect: function (v) {\n    useEffect = v;\n  }\n}, 1);\nvar useReactiveValue;\nmodule.link(\"../../../client/hooks/useReactiveValue\", {\n  useReactiveValue: function (v) {\n    useReactiveValue = v;\n  }\n}, 2);\nvar settings;\nmodule.link(\"../../settings/client\", {\n  settings: function (v) {\n    settings = v;\n  }\n}, 3);\nvar useAnalytics = function () {\n  var uid = useReactiveValue(function () {\n    return Meteor.userId();\n  });\n  var googleId = useReactiveValue(function () {\n    return settings.get('GoogleAnalytics_enabled') && settings.get('GoogleAnalytics_ID');\n  });\n  var piwikUrl = useReactiveValue(function () {\n    return settings.get('PiwikAnalytics_enabled') && settings.get('PiwikAnalytics_url');\n  });\n  useEffect(function () {\n    if (uid) {\n      window._paq = window._paq || [];\n      window._paq.push(['setUserId', uid]);\n    }\n  });\n  useEffect(function () {\n    if (!googleId) {\n      return;\n    }\n    if (googleId.startsWith('G-')) {\n      var _f$parentNode;\n      // Google Analytics 4\n      var f = document.getElementsByTagName('script')[0];\n      var j = document.createElement('script');\n      j.async = true;\n      j.src = \"//www.googletagmanager.com/gtag/js?id=\" + googleId;\n      (_f$parentNode = f.parentNode) === null || _f$parentNode === void 0 ? void 0 : _f$parentNode.insertBefore(j, f);\n      // injecting the dataLayer into the windows global object\n      var w = window;\n      var dataLayer = w.dataLayer || [];\n      var gtag = function (key, value) {\n        dataLayer.push(key, value);\n      };\n      gtag('js', new Date());\n      gtag('config', googleId);\n    } else {\n      var _window$ga, _window, _window$ga2, _window2;\n      // Google Analytics 3\n      (function (i, s, o, g, r, a, m) {\n        i.GoogleAnalyticsObject = r;\n        i[r] = i[r] || function () {\n          for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n          }\n          (i[r].q = i[r].q || []).push(args);\n          // eslint-disable-next-line no-sequences\n        }, i[r].l = new Date().getTime();\n        // eslint-disable-next-line no-sequences\n        a = s.createElement(o), m = s.getElementsByTagName(o)[0];\n        a.async = 1;\n        a.src = g;\n        m.parentNode.insertBefore(a, m);\n      })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');\n      (_window$ga = (_window = window).ga) === null || _window$ga === void 0 ? void 0 : _window$ga.call(_window, 'create', googleId, 'auto');\n      (_window$ga2 = (_window2 = window).ga) === null || _window$ga2 === void 0 ? void 0 : _window$ga2.call(_window2, 'send', 'pageview');\n    }\n  }, [googleId, uid]);\n  useEffect(function () {\n    if (!piwikUrl) {\n      var _document$getElementB;\n      (_document$getElementB = document.getElementById('piwik-analytics')) === null || _document$getElementB === void 0 ? void 0 : _document$getElementB.remove();\n      window._paq = [];\n      return;\n    }\n    var piwikSiteId = piwikUrl && settings.get('PiwikAnalytics_siteId');\n    var piwikPrependDomain = piwikUrl && settings.get('PiwikAnalytics_prependDomain');\n    var piwikCookieDomain = piwikUrl && settings.get('PiwikAnalytics_cookieDomain');\n    var piwikDomains = piwikUrl && settings.get('PiwikAnalytics_domains');\n    var piwikAdditionalTracker = piwikUrl && settings.get('PiwikAdditionalTrackers');\n    window._paq = window._paq || [];\n    window._paq.push(['trackPageView']);\n    window._paq.push(['enableLinkTracking']);\n    if (piwikPrependDomain) {\n      window._paq.push(['setDocumentTitle', window.location.hostname + \"/\" + document.title]);\n    }\n    var upperLevelDomain = \"*.\" + window.location.hostname.split('.').slice(1).join('.');\n    if (piwikCookieDomain) {\n      window._paq.push(['setCookieDomain', upperLevelDomain]);\n    }\n    if (piwikDomains) {\n      // array\n      var domainsArray = piwikDomains.split(/\\n/);\n      var domains = [];\n      for (var i = 0; i < domainsArray.length; i++) {\n        // only push domain if it contains a non whitespace character.\n        if (/\\S/.test(domainsArray[i])) {\n          domains.push(\"*.\" + domainsArray[i].trim());\n        }\n      }\n      window._paq.push(['setDomains', domains]);\n    }\n    (function (_s$parentNode) {\n      try {\n        if (/\\S/.test(piwikAdditionalTracker)) {\n          // piwikAdditionalTracker is not empty or whitespace only\n          var addTrackers = JSON.parse(piwikAdditionalTracker);\n          for (var _i = 0; _i < addTrackers.length; _i++) {\n            var tracker = addTrackers[_i];\n            window._paq.push(['addTracker', tracker.trackerURL + \"js/\", tracker.siteId]);\n          }\n        }\n      } catch (e) {\n        // parsing JSON faild\n        console.log('Error while parsing JSON value of \"piwikAdditionalTracker\": ', e);\n      }\n      window._paq.push(['setTrackerUrl', piwikUrl + \"js/\"]);\n      window._paq.push(['setSiteId', Number.parseInt(piwikSiteId)]);\n      var d = document;\n      var g = d.createElement('script');\n      g.setAttribute('id', 'piwik-analytics');\n      var s = d.getElementsByTagName('script')[0];\n      g.type = 'text/javascript';\n      g.async = true;\n      g.defer = true;\n      g.src = piwikUrl + \"js/\";\n      (_s$parentNode = s.parentNode) === null || _s$parentNode === void 0 ? void 0 : _s$parentNode.insertBefore(g, s);\n    })();\n  }, [piwikUrl]);\n};","map":{"version":3,"names":["module","export","useAnalytics","Meteor","link","v","useEffect","useReactiveValue","settings","uid","userId","googleId","get","piwikUrl","window","_paq","push","startsWith","_f$parentNode","f","document","getElementsByTagName","j","createElement","async","src","parentNode","insertBefore","w","dataLayer","gtag","key","value","Date","_window$ga","_window","_window$ga2","_window2","i","s","o","g","r","a","m","GoogleAnalyticsObject","_len","arguments","length","args","Array","_key","q","l","getTime","ga","call","_document$getElementB","getElementById","remove","piwikSiteId","piwikPrependDomain","piwikCookieDomain","piwikDomains","piwikAdditionalTracker","location","hostname","title","upperLevelDomain","split","slice","join","domainsArray","domains","test","trim","_s$parentNode","addTrackers","JSON","parse","tracker","trackerURL","siteId","e","console","log","Number","parseInt","d","setAttribute","type","defer"],"sources":["app/analytics/client/loadScript.ts"],"sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { useEffect } from 'react';\n\nimport { useReactiveValue } from '../../../client/hooks/useReactiveValue';\nimport { settings } from '../../settings/client';\n\ndeclare global {\n\t// eslint-disable-next-line @typescript-eslint/naming-convention\n\tinterface Window {\n\t\t_paq?: [string, ...unknown[]][];\n\t\tGoogleAnalyticsObject: unknown;\n\t\tga?: qa;\n\t}\n\n\ttype qa = {\n\t\t(...args: unknown[]): void;\n\t\tl?: number;\n\t\tq?: unknown[];\n\t};\n}\n\nexport const useAnalytics = (): void => {\n\tconst uid = useReactiveValue(() => Meteor.userId());\n\n\tconst googleId = useReactiveValue(() => settings.get('GoogleAnalytics_enabled') && settings.get('GoogleAnalytics_ID'));\n\tconst piwikUrl = useReactiveValue(() => settings.get('PiwikAnalytics_enabled') && settings.get('PiwikAnalytics_url'));\n\n\tuseEffect(() => {\n\t\tif (uid) {\n\t\t\twindow._paq = window._paq || [];\n\t\t\twindow._paq.push(['setUserId', uid]);\n\t\t}\n\t});\n\n\tuseEffect(() => {\n\t\tif (!googleId) {\n\t\t\treturn;\n\t\t}\n\t\tif (googleId.startsWith('G-')) {\n\t\t\t// Google Analytics 4\n\t\t\tconst f = document.getElementsByTagName('script')[0];\n\t\t\tconst j = document.createElement('script');\n\t\t\tj.async = true;\n\t\t\tj.src = `//www.googletagmanager.com/gtag/js?id=${googleId}`;\n\t\t\tf.parentNode?.insertBefore(j, f);\n\n\t\t\t// injecting the dataLayer into the windows global object\n\t\t\tconst w: Window & { dataLayer?: any } = window;\n\t\t\tconst dataLayer = w.dataLayer || [];\n\t\t\tconst gtag = (key: string, value: any) => {\n\t\t\t\tdataLayer.push(key, value);\n\t\t\t};\n\t\t\tgtag('js', new Date());\n\t\t\tgtag('config', googleId);\n\t\t} else {\n\t\t\t// Google Analytics 3\n\t\t\t(function (i, s, o, g, r: 'ga', a?: any, m?: any) {\n\t\t\t\ti.GoogleAnalyticsObject = r;\n\t\t\t\t(i[r] =\n\t\t\t\t\ti[r] ||\n\t\t\t\t\tfunction (...args) {\n\t\t\t\t\t\t((i[r] as any).q = (i[r] as any).q || []).push(args);\n\t\t\t\t\t\t// eslint-disable-next-line no-sequences\n\t\t\t\t\t}),\n\t\t\t\t\t((i[r] as any).l = new Date().getTime());\n\t\t\t\t// eslint-disable-next-line no-sequences\n\t\t\t\t(a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);\n\t\t\t\ta.async = 1;\n\t\t\t\ta.src = g;\n\t\t\t\tm.parentNode.insertBefore(a, m);\n\t\t\t})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');\n\n\t\t\twindow.ga?.('create', googleId, 'auto');\n\t\t\twindow.ga?.('send', 'pageview');\n\t\t}\n\t}, [googleId, uid]);\n\n\tuseEffect(() => {\n\t\tif (!piwikUrl) {\n\t\t\tdocument.getElementById('piwik-analytics')?.remove();\n\t\t\twindow._paq = [];\n\t\t\treturn;\n\t\t}\n\n\t\tconst piwikSiteId = piwikUrl && settings.get('PiwikAnalytics_siteId');\n\t\tconst piwikPrependDomain = piwikUrl && settings.get('PiwikAnalytics_prependDomain');\n\t\tconst piwikCookieDomain = piwikUrl && settings.get('PiwikAnalytics_cookieDomain');\n\t\tconst piwikDomains = piwikUrl && settings.get('PiwikAnalytics_domains');\n\t\tconst piwikAdditionalTracker = piwikUrl && settings.get('PiwikAdditionalTrackers');\n\t\twindow._paq = window._paq || [];\n\n\t\twindow._paq.push(['trackPageView']);\n\t\twindow._paq.push(['enableLinkTracking']);\n\t\tif (piwikPrependDomain) {\n\t\t\twindow._paq.push(['setDocumentTitle', `${window.location.hostname}/${document.title}`]);\n\t\t}\n\t\tconst upperLevelDomain = `*.${window.location.hostname.split('.').slice(1).join('.')}`;\n\t\tif (piwikCookieDomain) {\n\t\t\twindow._paq.push(['setCookieDomain', upperLevelDomain]);\n\t\t}\n\t\tif (piwikDomains) {\n\t\t\t// array\n\t\t\tconst domainsArray = piwikDomains.split(/\\n/);\n\t\t\tconst domains = [];\n\t\t\tfor (let i = 0; i < domainsArray.length; i++) {\n\t\t\t\t// only push domain if it contains a non whitespace character.\n\t\t\t\tif (/\\S/.test(domainsArray[i])) {\n\t\t\t\t\tdomains.push(`*.${domainsArray[i].trim()}`);\n\t\t\t\t}\n\t\t\t}\n\t\t\twindow._paq.push(['setDomains', domains]);\n\t\t}\n\t\t(() => {\n\t\t\ttry {\n\t\t\t\tif (/\\S/.test(piwikAdditionalTracker)) {\n\t\t\t\t\t// piwikAdditionalTracker is not empty or whitespace only\n\t\t\t\t\tconst addTrackers = JSON.parse(piwikAdditionalTracker);\n\t\t\t\t\tfor (let i = 0; i < addTrackers.length; i++) {\n\t\t\t\t\t\tconst tracker = addTrackers[i];\n\t\t\t\t\t\twindow._paq.push(['addTracker', `${tracker.trackerURL}js/`, tracker.siteId]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t// parsing JSON faild\n\t\t\t\tconsole.log('Error while parsing JSON value of \"piwikAdditionalTracker\": ', e);\n\t\t\t}\n\t\t\twindow._paq.push(['setTrackerUrl', `${piwikUrl}js/`]);\n\t\t\twindow._paq.push(['setSiteId', Number.parseInt(piwikSiteId)]);\n\t\t\tconst d = document;\n\t\t\tconst g = d.createElement('script');\n\t\t\tg.setAttribute('id', 'piwik-analytics');\n\t\t\tconst s = d.getElementsByTagName('script')[0];\n\t\t\tg.type = 'text/javascript';\n\t\t\tg.async = true;\n\t\t\tg.defer = true;\n\t\t\tg.src = `${piwikUrl}js/`;\n\t\t\ts.parentNode?.insertBefore(g, s);\n\t\t})();\n\t}, [piwikUrl]);\n};\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"361bd6b78c895673669ac763acb99ddc3bc336f1"}
