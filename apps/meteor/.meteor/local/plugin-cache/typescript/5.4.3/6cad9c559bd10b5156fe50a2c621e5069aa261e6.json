{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/lib/RoomManager.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/lib/RoomManager.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/lib/RoomManager.ts","inputSourceMap":{"version":3,"file":"client/lib/RoomManager.ts","sourceRoot":"","sources":["client/lib/RoomManager.ts"],"names":[],"mappings":"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","sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { Emitter } from '@rocket.chat/emitter';\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\n\nimport { getConfig } from './utils/getConfig';\nimport { RoomHistoryManager } from '../../app/ui-utils/client/lib/RoomHistoryManager';\n\nconst debug = !!(getConfig('debug') || getConfig('debug-RoomStore'));\n\nclass RoomStore extends Emitter<{\n\tchanged: undefined;\n}> {\n\tlastTime?: Date;\n\n\tscroll?: number;\n\n\tlm?: Date;\n\n\tatBottom = true;\n\n\tconstructor(readonly rid: string) {\n\t\tsuper();\n\n\t\tdebug && this.on('changed', () => console.log(`RoomStore ${this.rid} changed`, this));\n\t}\n\n\tupdate({ scroll, lastTime, atBottom }: { scroll?: number; lastTime?: Date; atBottom?: boolean }): void {\n\t\tif (scroll !== undefined) {\n\t\t\tthis.scroll = scroll;\n\t\t}\n\t\tif (lastTime !== undefined) {\n\t\t\tthis.lastTime = lastTime;\n\t\t}\n\n\t\tif (atBottom !== undefined) {\n\t\t\tthis.atBottom = atBottom;\n\t\t}\n\t\tif (scroll || lastTime) {\n\t\t\tthis.emit('changed');\n\t\t}\n\t}\n}\n\nconst debugRoomManager = !!(getConfig('debug') || getConfig('debug-RoomManager'));\nexport const RoomManager = new (class RoomManager extends Emitter<{\n\tchanged: IRoom['_id'] | undefined;\n\topened: IRoom['_id'];\n\tclosed: IRoom['_id'];\n\tback: IRoom['_id'];\n\tremoved: IRoom['_id'];\n}> {\n\tprivate rid: IRoom['_id'] | undefined;\n\n\tpublic lastRid: IRoom['_id'] | undefined;\n\n\tprivate rooms: Map<IRoom['_id'], RoomStore> = new Map();\n\n\tprivate parentRid?: IRoom['_id'] | undefined;\n\n\tconstructor() {\n\t\tsuper();\n\t\tdebugRoomManager &&\n\t\t\tthis.on('opened', (rid) => {\n\t\t\t\tconsole.log('room opened ->', rid);\n\t\t\t});\n\n\t\tdebugRoomManager &&\n\t\t\tthis.on('back', (rid) => {\n\t\t\t\tconsole.log('room moved to back ->', rid);\n\t\t\t});\n\n\t\tdebugRoomManager &&\n\t\t\tthis.on('closed', (rid) => {\n\t\t\t\tconsole.log('room close ->', rid);\n\t\t\t});\n\t}\n\n\tget lastOpened(): IRoom['_id'] | undefined {\n\t\treturn this.lastRid;\n\t}\n\n\tget opened(): IRoom['_id'] | undefined {\n\t\treturn this.parentRid ?? this.rid;\n\t}\n\n\tget openedSecondLevel(): IRoom['_id'] | undefined {\n\t\tif (!this.parentRid) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this.rid;\n\t}\n\n\tvisitedRooms(): IRoom['_id'][] {\n\t\treturn [...this.rooms.keys()];\n\t}\n\n\tback(rid: IRoom['_id']): void {\n\t\tif (rid === this.rid) {\n\t\t\tthis.lastRid = rid;\n\t\t\tthis.rid = undefined;\n\t\t\tthis.emit('back', rid);\n\t\t\tthis.emit('changed', this.rid);\n\t\t}\n\t}\n\n\tgetMore(rid: IRoom['_id']): void {\n\t\tRoomHistoryManager.getMore(rid);\n\t}\n\n\tclose(rid: IRoom['_id']): void {\n\t\tif (this.rooms.has(rid)) {\n\t\t\tthis.rooms.delete(rid);\n\t\t\tthis.emit('closed', rid);\n\t\t}\n\t\tthis.emit('changed', this.rid);\n\t}\n\n\tprivate _open(rid: IRoom['_id'], parent?: IRoom['_id']): void {\n\t\tif (rid === this.rid) {\n\t\t\treturn;\n\t\t}\n\t\tthis.back(rid);\n\t\tif (!this.rooms.has(rid)) {\n\t\t\tthis.rooms.set(rid, new RoomStore(rid));\n\t\t}\n\t\tthis.rid = rid;\n\t\tthis.parentRid = parent;\n\t\tthis.emit('opened', this.rid);\n\t\tthis.emit('changed', this.rid);\n\t}\n\n\topen(rid: IRoom['_id']): void {\n\t\tthis._open(rid);\n\t}\n\n\topenSecondLevel(parentId: IRoom['_id'], rid: IRoom['_id']): void {\n\t\tthis._open(rid, parentId);\n\t}\n\n\tgetStore(rid: IRoom['_id']): RoomStore | undefined {\n\t\treturn this.rooms.get(rid);\n\t}\n})();\n\nconst subscribeOpenedRoom = [\n\t(callback: () => void): (() => void) => RoomManager.on('changed', callback),\n\t(): IRoom['_id'] | undefined => RoomManager.opened,\n] as const;\n\nconst subscribeOpenedSecondLevelRoom = [\n\t(callback: () => void): (() => void) => RoomManager.on('changed', callback),\n\t(): IRoom['_id'] | undefined => RoomManager.openedSecondLevel,\n] as const;\n\nexport const useOpenedRoom = (): IRoom['_id'] | undefined => useSyncExternalStore(...subscribeOpenedRoom);\n\nexport const useSecondLevelOpenedRoom = (): IRoom['_id'] | undefined => useSyncExternalStore(...subscribeOpenedSecondLevelRoom);\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/lib/RoomManager.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/lib/RoomManager.ts","inputSourceMap":{"version":3,"file":"client/lib/RoomManager.ts","sourceRoot":"","sources":["client/lib/RoomManager.ts"],"names":[],"mappings":"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","sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { Emitter } from '@rocket.chat/emitter';\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\n\nimport { getConfig } from './utils/getConfig';\nimport { RoomHistoryManager } from '../../app/ui-utils/client/lib/RoomHistoryManager';\n\nconst debug = !!(getConfig('debug') || getConfig('debug-RoomStore'));\n\nclass RoomStore extends Emitter<{\n\tchanged: undefined;\n}> {\n\tlastTime?: Date;\n\n\tscroll?: number;\n\n\tlm?: Date;\n\n\tatBottom = true;\n\n\tconstructor(readonly rid: string) {\n\t\tsuper();\n\n\t\tdebug && this.on('changed', () => console.log(`RoomStore ${this.rid} changed`, this));\n\t}\n\n\tupdate({ scroll, lastTime, atBottom }: { scroll?: number; lastTime?: Date; atBottom?: boolean }): void {\n\t\tif (scroll !== undefined) {\n\t\t\tthis.scroll = scroll;\n\t\t}\n\t\tif (lastTime !== undefined) {\n\t\t\tthis.lastTime = lastTime;\n\t\t}\n\n\t\tif (atBottom !== undefined) {\n\t\t\tthis.atBottom = atBottom;\n\t\t}\n\t\tif (scroll || lastTime) {\n\t\t\tthis.emit('changed');\n\t\t}\n\t}\n}\n\nconst debugRoomManager = !!(getConfig('debug') || getConfig('debug-RoomManager'));\nexport const RoomManager = new (class RoomManager extends Emitter<{\n\tchanged: IRoom['_id'] | undefined;\n\topened: IRoom['_id'];\n\tclosed: IRoom['_id'];\n\tback: IRoom['_id'];\n\tremoved: IRoom['_id'];\n}> {\n\tprivate rid: IRoom['_id'] | undefined;\n\n\tpublic lastRid: IRoom['_id'] | undefined;\n\n\tprivate rooms: Map<IRoom['_id'], RoomStore> = new Map();\n\n\tprivate parentRid?: IRoom['_id'] | undefined;\n\n\tconstructor() {\n\t\tsuper();\n\t\tdebugRoomManager &&\n\t\t\tthis.on('opened', (rid) => {\n\t\t\t\tconsole.log('room opened ->', rid);\n\t\t\t});\n\n\t\tdebugRoomManager &&\n\t\t\tthis.on('back', (rid) => {\n\t\t\t\tconsole.log('room moved to back ->', rid);\n\t\t\t});\n\n\t\tdebugRoomManager &&\n\t\t\tthis.on('closed', (rid) => {\n\t\t\t\tconsole.log('room close ->', rid);\n\t\t\t});\n\t}\n\n\tget lastOpened(): IRoom['_id'] | undefined {\n\t\treturn this.lastRid;\n\t}\n\n\tget opened(): IRoom['_id'] | undefined {\n\t\treturn this.parentRid ?? this.rid;\n\t}\n\n\tget openedSecondLevel(): IRoom['_id'] | undefined {\n\t\tif (!this.parentRid) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this.rid;\n\t}\n\n\tvisitedRooms(): IRoom['_id'][] {\n\t\treturn [...this.rooms.keys()];\n\t}\n\n\tback(rid: IRoom['_id']): void {\n\t\tif (rid === this.rid) {\n\t\t\tthis.lastRid = rid;\n\t\t\tthis.rid = undefined;\n\t\t\tthis.emit('back', rid);\n\t\t\tthis.emit('changed', this.rid);\n\t\t}\n\t}\n\n\tgetMore(rid: IRoom['_id']): void {\n\t\tRoomHistoryManager.getMore(rid);\n\t}\n\n\tclose(rid: IRoom['_id']): void {\n\t\tif (this.rooms.has(rid)) {\n\t\t\tthis.rooms.delete(rid);\n\t\t\tthis.emit('closed', rid);\n\t\t}\n\t\tthis.emit('changed', this.rid);\n\t}\n\n\tprivate _open(rid: IRoom['_id'], parent?: IRoom['_id']): void {\n\t\tif (rid === this.rid) {\n\t\t\treturn;\n\t\t}\n\t\tthis.back(rid);\n\t\tif (!this.rooms.has(rid)) {\n\t\t\tthis.rooms.set(rid, new RoomStore(rid));\n\t\t}\n\t\tthis.rid = rid;\n\t\tthis.parentRid = parent;\n\t\tthis.emit('opened', this.rid);\n\t\tthis.emit('changed', this.rid);\n\t}\n\n\topen(rid: IRoom['_id']): void {\n\t\tthis._open(rid);\n\t}\n\n\topenSecondLevel(parentId: IRoom['_id'], rid: IRoom['_id']): void {\n\t\tthis._open(rid, parentId);\n\t}\n\n\tgetStore(rid: IRoom['_id']): RoomStore | undefined {\n\t\treturn this.rooms.get(rid);\n\t}\n})();\n\nconst subscribeOpenedRoom = [\n\t(callback: () => void): (() => void) => RoomManager.on('changed', callback),\n\t(): IRoom['_id'] | undefined => RoomManager.opened,\n] as const;\n\nconst subscribeOpenedSecondLevelRoom = [\n\t(callback: () => void): (() => void) => RoomManager.on('changed', callback),\n\t(): IRoom['_id'] | undefined => RoomManager.openedSecondLevel,\n] as const;\n\nexport const useOpenedRoom = (): IRoom['_id'] | undefined => useSyncExternalStore(...subscribeOpenedRoom);\n\nexport const useSecondLevelOpenedRoom = (): IRoom['_id'] | undefined => useSyncExternalStore(...subscribeOpenedSecondLevelRoom);\n"]}}},"code":"module.export({\n  RoomManager: () => RoomManager,\n  useOpenedRoom: () => useOpenedRoom,\n  useSecondLevelOpenedRoom: () => useSecondLevelOpenedRoom\n});\nlet Emitter;\nmodule.link(\"@rocket.chat/emitter\", {\n  Emitter(v) {\n    Emitter = v;\n  }\n}, 0);\nlet useSyncExternalStore;\nmodule.link(\"use-sync-external-store/shim\", {\n  useSyncExternalStore(v) {\n    useSyncExternalStore = v;\n  }\n}, 1);\nlet getConfig;\nmodule.link(\"./utils/getConfig\", {\n  getConfig(v) {\n    getConfig = v;\n  }\n}, 2);\nlet RoomHistoryManager;\nmodule.link(\"../../app/ui-utils/client/lib/RoomHistoryManager\", {\n  RoomHistoryManager(v) {\n    RoomHistoryManager = v;\n  }\n}, 3);\nconst debug = !!(getConfig('debug') || getConfig('debug-RoomStore'));\nclass RoomStore extends Emitter {\n  constructor(rid) {\n    super();\n    this.rid = void 0;\n    this.lastTime = void 0;\n    this.scroll = void 0;\n    this.lm = void 0;\n    this.atBottom = true;\n    this.rid = rid;\n    debug && this.on('changed', () => console.log(\"RoomStore \".concat(this.rid, \" changed\"), this));\n  }\n  update(_ref) {\n    let {\n      scroll,\n      lastTime,\n      atBottom\n    } = _ref;\n    if (scroll !== undefined) {\n      this.scroll = scroll;\n    }\n    if (lastTime !== undefined) {\n      this.lastTime = lastTime;\n    }\n    if (atBottom !== undefined) {\n      this.atBottom = atBottom;\n    }\n    if (scroll || lastTime) {\n      this.emit('changed');\n    }\n  }\n}\nconst debugRoomManager = !!(getConfig('debug') || getConfig('debug-RoomManager'));\nconst RoomManager = new class RoomManager extends Emitter {\n  constructor() {\n    super();\n    this.rid = void 0;\n    this.lastRid = void 0;\n    this.rooms = new Map();\n    this.parentRid = void 0;\n    debugRoomManager && this.on('opened', rid => {\n      console.log('room opened ->', rid);\n    });\n    debugRoomManager && this.on('back', rid => {\n      console.log('room moved to back ->', rid);\n    });\n    debugRoomManager && this.on('closed', rid => {\n      console.log('room close ->', rid);\n    });\n  }\n  get lastOpened() {\n    return this.lastRid;\n  }\n  get opened() {\n    var _this$parentRid;\n    return (_this$parentRid = this.parentRid) !== null && _this$parentRid !== void 0 ? _this$parentRid : this.rid;\n  }\n  get openedSecondLevel() {\n    if (!this.parentRid) {\n      return undefined;\n    }\n    return this.rid;\n  }\n  visitedRooms() {\n    return [...this.rooms.keys()];\n  }\n  back(rid) {\n    if (rid === this.rid) {\n      this.lastRid = rid;\n      this.rid = undefined;\n      this.emit('back', rid);\n      this.emit('changed', this.rid);\n    }\n  }\n  getMore(rid) {\n    RoomHistoryManager.getMore(rid);\n  }\n  close(rid) {\n    if (this.rooms.has(rid)) {\n      this.rooms.delete(rid);\n      this.emit('closed', rid);\n    }\n    this.emit('changed', this.rid);\n  }\n  _open(rid, parent) {\n    if (rid === this.rid) {\n      return;\n    }\n    this.back(rid);\n    if (!this.rooms.has(rid)) {\n      this.rooms.set(rid, new RoomStore(rid));\n    }\n    this.rid = rid;\n    this.parentRid = parent;\n    this.emit('opened', this.rid);\n    this.emit('changed', this.rid);\n  }\n  open(rid) {\n    this._open(rid);\n  }\n  openSecondLevel(parentId, rid) {\n    this._open(rid, parentId);\n  }\n  getStore(rid) {\n    return this.rooms.get(rid);\n  }\n}();\nconst subscribeOpenedRoom = [callback => RoomManager.on('changed', callback), () => RoomManager.opened];\nconst subscribeOpenedSecondLevelRoom = [callback => RoomManager.on('changed', callback), () => RoomManager.openedSecondLevel];\nconst useOpenedRoom = () => useSyncExternalStore(...subscribeOpenedRoom);\nconst useSecondLevelOpenedRoom = () => useSyncExternalStore(...subscribeOpenedSecondLevelRoom);","map":{"version":3,"names":["module","export","RoomManager","useOpenedRoom","useSecondLevelOpenedRoom","Emitter","link","v","useSyncExternalStore","getConfig","RoomHistoryManager","debug","RoomStore","constructor","rid","lastTime","scroll","lm","atBottom","on","console","log","concat","update","_ref","undefined","emit","debugRoomManager","lastRid","rooms","Map","parentRid","lastOpened","opened","_this$parentRid","openedSecondLevel","visitedRooms","keys","back","getMore","close","has","delete","_open","parent","set","open","openSecondLevel","parentId","getStore","get","subscribeOpenedRoom","callback","subscribeOpenedSecondLevelRoom"],"sources":["client/lib/RoomManager.ts"],"sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { Emitter } from '@rocket.chat/emitter';\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\n\nimport { getConfig } from './utils/getConfig';\nimport { RoomHistoryManager } from '../../app/ui-utils/client/lib/RoomHistoryManager';\n\nconst debug = !!(getConfig('debug') || getConfig('debug-RoomStore'));\n\nclass RoomStore extends Emitter<{\n\tchanged: undefined;\n}> {\n\tlastTime?: Date;\n\n\tscroll?: number;\n\n\tlm?: Date;\n\n\tatBottom = true;\n\n\tconstructor(readonly rid: string) {\n\t\tsuper();\n\n\t\tdebug && this.on('changed', () => console.log(`RoomStore ${this.rid} changed`, this));\n\t}\n\n\tupdate({ scroll, lastTime, atBottom }: { scroll?: number; lastTime?: Date; atBottom?: boolean }): void {\n\t\tif (scroll !== undefined) {\n\t\t\tthis.scroll = scroll;\n\t\t}\n\t\tif (lastTime !== undefined) {\n\t\t\tthis.lastTime = lastTime;\n\t\t}\n\n\t\tif (atBottom !== undefined) {\n\t\t\tthis.atBottom = atBottom;\n\t\t}\n\t\tif (scroll || lastTime) {\n\t\t\tthis.emit('changed');\n\t\t}\n\t}\n}\n\nconst debugRoomManager = !!(getConfig('debug') || getConfig('debug-RoomManager'));\nexport const RoomManager = new (class RoomManager extends Emitter<{\n\tchanged: IRoom['_id'] | undefined;\n\topened: IRoom['_id'];\n\tclosed: IRoom['_id'];\n\tback: IRoom['_id'];\n\tremoved: IRoom['_id'];\n}> {\n\tprivate rid: IRoom['_id'] | undefined;\n\n\tpublic lastRid: IRoom['_id'] | undefined;\n\n\tprivate rooms: Map<IRoom['_id'], RoomStore> = new Map();\n\n\tprivate parentRid?: IRoom['_id'] | undefined;\n\n\tconstructor() {\n\t\tsuper();\n\t\tdebugRoomManager &&\n\t\t\tthis.on('opened', (rid) => {\n\t\t\t\tconsole.log('room opened ->', rid);\n\t\t\t});\n\n\t\tdebugRoomManager &&\n\t\t\tthis.on('back', (rid) => {\n\t\t\t\tconsole.log('room moved to back ->', rid);\n\t\t\t});\n\n\t\tdebugRoomManager &&\n\t\t\tthis.on('closed', (rid) => {\n\t\t\t\tconsole.log('room close ->', rid);\n\t\t\t});\n\t}\n\n\tget lastOpened(): IRoom['_id'] | undefined {\n\t\treturn this.lastRid;\n\t}\n\n\tget opened(): IRoom['_id'] | undefined {\n\t\treturn this.parentRid ?? this.rid;\n\t}\n\n\tget openedSecondLevel(): IRoom['_id'] | undefined {\n\t\tif (!this.parentRid) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this.rid;\n\t}\n\n\tvisitedRooms(): IRoom['_id'][] {\n\t\treturn [...this.rooms.keys()];\n\t}\n\n\tback(rid: IRoom['_id']): void {\n\t\tif (rid === this.rid) {\n\t\t\tthis.lastRid = rid;\n\t\t\tthis.rid = undefined;\n\t\t\tthis.emit('back', rid);\n\t\t\tthis.emit('changed', this.rid);\n\t\t}\n\t}\n\n\tgetMore(rid: IRoom['_id']): void {\n\t\tRoomHistoryManager.getMore(rid);\n\t}\n\n\tclose(rid: IRoom['_id']): void {\n\t\tif (this.rooms.has(rid)) {\n\t\t\tthis.rooms.delete(rid);\n\t\t\tthis.emit('closed', rid);\n\t\t}\n\t\tthis.emit('changed', this.rid);\n\t}\n\n\tprivate _open(rid: IRoom['_id'], parent?: IRoom['_id']): void {\n\t\tif (rid === this.rid) {\n\t\t\treturn;\n\t\t}\n\t\tthis.back(rid);\n\t\tif (!this.rooms.has(rid)) {\n\t\t\tthis.rooms.set(rid, new RoomStore(rid));\n\t\t}\n\t\tthis.rid = rid;\n\t\tthis.parentRid = parent;\n\t\tthis.emit('opened', this.rid);\n\t\tthis.emit('changed', this.rid);\n\t}\n\n\topen(rid: IRoom['_id']): void {\n\t\tthis._open(rid);\n\t}\n\n\topenSecondLevel(parentId: IRoom['_id'], rid: IRoom['_id']): void {\n\t\tthis._open(rid, parentId);\n\t}\n\n\tgetStore(rid: IRoom['_id']): RoomStore | undefined {\n\t\treturn this.rooms.get(rid);\n\t}\n})();\n\nconst subscribeOpenedRoom = [\n\t(callback: () => void): (() => void) => RoomManager.on('changed', callback),\n\t(): IRoom['_id'] | undefined => RoomManager.opened,\n] as const;\n\nconst subscribeOpenedSecondLevelRoom = [\n\t(callback: () => void): (() => void) => RoomManager.on('changed', callback),\n\t(): IRoom['_id'] | undefined => RoomManager.openedSecondLevel,\n] as const;\n\nexport const useOpenedRoom = (): IRoom['_id'] | undefined => useSyncExternalStore(...subscribeOpenedRoom);\n\nexport const useSecondLevelOpenedRoom = (): IRoom['_id'] | undefined => useSyncExternalStore(...subscribeOpenedSecondLevelRoom);\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"6cad9c559bd10b5156fe50a2c621e5069aa261e6"}
