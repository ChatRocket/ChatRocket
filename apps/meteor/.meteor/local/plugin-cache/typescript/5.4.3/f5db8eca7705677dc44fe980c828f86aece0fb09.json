{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/lib/chats/flows/processSlashCommand.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/lib/chats/flows/processSlashCommand.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/lib/chats/flows/processSlashCommand.ts","inputSourceMap":{"version":3,"file":"client/lib/chats/flows/processSlashCommand.ts","sourceRoot":"","sources":["client/lib/chats/flows/processSlashCommand.ts"],"names":[],"mappings":"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","sourcesContent":["import type { IMessage, SlashCommand } from '@rocket.chat/core-typings';\nimport { Random } from '@rocket.chat/random';\nimport { escapeHTML } from '@rocket.chat/string-helpers';\n\nimport { hasAtLeastOnePermission } from '../../../../app/authorization/client';\nimport { settings } from '../../../../app/settings/client';\nimport { slashCommands } from '../../../../app/utils/client';\nimport { sdk } from '../../../../app/utils/client/lib/SDKClient';\nimport { t } from '../../../../app/utils/lib/i18n';\nimport type { ChatAPI } from '../ChatAPI';\n\nconst parse = (msg: string): { command: string; params: string } | { command: SlashCommand; params: string } | undefined => {\n\tconst match = msg.match(/^\\/([^\\s]+)(.*)/);\n\n\tif (!match) {\n\t\treturn undefined;\n\t}\n\n\tconst [, cmd, params] = match;\n\tconst command = slashCommands.commands[cmd];\n\n\tif (!command) {\n\t\treturn { command: cmd, params };\n\t}\n\n\treturn { command, params };\n};\n\nconst warnUnrecognizedSlashCommand = async (chat: ChatAPI, message: string): Promise<void> => {\n\tconsole.error(message);\n\n\tawait chat.data.pushEphemeralMessage({\n\t\t_id: Random.id(),\n\t\tts: new Date(),\n\t\tmsg: message,\n\t\tu: {\n\t\t\t_id: 'rocket.cat',\n\t\t\tusername: 'rocket.cat',\n\t\t\tname: 'Rocket.Cat',\n\t\t},\n\t\tprivate: true,\n\t\t_updatedAt: new Date(),\n\t});\n};\n\nexport const processSlashCommand = async (chat: ChatAPI, message: IMessage): Promise<boolean> => {\n\tconst match = parse(message.msg);\n\n\tif (!match) {\n\t\treturn false;\n\t}\n\n\tconst { command, params } = match;\n\n\tif (typeof command === 'string') {\n\t\tif (!settings.get('Message_AllowUnrecognizedSlashCommand')) {\n\t\t\tawait warnUnrecognizedSlashCommand(chat, t('No_such_command', { command: escapeHTML(command) }));\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tconst { permission, clientOnly, callback: handleOnClient, result: handleResult, appId, command: commandName } = command;\n\n\tif (permission && !hasAtLeastOnePermission(permission, message.rid)) {\n\t\tawait warnUnrecognizedSlashCommand(chat, t('You_do_not_have_permission_to_execute_this_command', { command: escapeHTML(commandName) }));\n\t\treturn true;\n\t}\n\n\tif (clientOnly && chat.uid) {\n\t\thandleOnClient?.({ command: commandName, message, params, userId: chat.uid });\n\t\treturn true;\n\t}\n\n\tawait sdk.rest.post('/v1/statistics.telemetry', {\n\t\tparams: [{ eventName: 'slashCommandsStats', timestamp: Date.now(), command: commandName }],\n\t});\n\n\tconst triggerId = chat.ActionManager.generateTriggerId(appId);\n\n\tconst data = {\n\t\tcmd: commandName,\n\t\tparams,\n\t\tmsg: message,\n\t\tuserId: chat.uid,\n\t} as const;\n\n\ttry {\n\t\tif (appId) {\n\t\t\tchat.ActionManager.notifyBusy();\n\t\t}\n\n\t\tconst result = await sdk.call('slashCommand', { cmd: commandName, params, msg: message, triggerId });\n\n\t\thandleResult?.(undefined, result, data);\n\t} catch (error: unknown) {\n\t\tawait warnUnrecognizedSlashCommand(chat, t('Something_went_wrong_while_executing_command', { command: commandName }));\n\t\thandleResult?.(error, undefined, data);\n\t}\n\n\tif (appId) {\n\t\tchat.ActionManager.notifyIdle();\n\t}\n\n\treturn true;\n};\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/lib/chats/flows/processSlashCommand.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/lib/chats/flows/processSlashCommand.ts","inputSourceMap":{"version":3,"file":"client/lib/chats/flows/processSlashCommand.ts","sourceRoot":"","sources":["client/lib/chats/flows/processSlashCommand.ts"],"names":[],"mappings":"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","sourcesContent":["import type { IMessage, SlashCommand } from '@rocket.chat/core-typings';\nimport { Random } from '@rocket.chat/random';\nimport { escapeHTML } from '@rocket.chat/string-helpers';\n\nimport { hasAtLeastOnePermission } from '../../../../app/authorization/client';\nimport { settings } from '../../../../app/settings/client';\nimport { slashCommands } from '../../../../app/utils/client';\nimport { sdk } from '../../../../app/utils/client/lib/SDKClient';\nimport { t } from '../../../../app/utils/lib/i18n';\nimport type { ChatAPI } from '../ChatAPI';\n\nconst parse = (msg: string): { command: string; params: string } | { command: SlashCommand; params: string } | undefined => {\n\tconst match = msg.match(/^\\/([^\\s]+)(.*)/);\n\n\tif (!match) {\n\t\treturn undefined;\n\t}\n\n\tconst [, cmd, params] = match;\n\tconst command = slashCommands.commands[cmd];\n\n\tif (!command) {\n\t\treturn { command: cmd, params };\n\t}\n\n\treturn { command, params };\n};\n\nconst warnUnrecognizedSlashCommand = async (chat: ChatAPI, message: string): Promise<void> => {\n\tconsole.error(message);\n\n\tawait chat.data.pushEphemeralMessage({\n\t\t_id: Random.id(),\n\t\tts: new Date(),\n\t\tmsg: message,\n\t\tu: {\n\t\t\t_id: 'rocket.cat',\n\t\t\tusername: 'rocket.cat',\n\t\t\tname: 'Rocket.Cat',\n\t\t},\n\t\tprivate: true,\n\t\t_updatedAt: new Date(),\n\t});\n};\n\nexport const processSlashCommand = async (chat: ChatAPI, message: IMessage): Promise<boolean> => {\n\tconst match = parse(message.msg);\n\n\tif (!match) {\n\t\treturn false;\n\t}\n\n\tconst { command, params } = match;\n\n\tif (typeof command === 'string') {\n\t\tif (!settings.get('Message_AllowUnrecognizedSlashCommand')) {\n\t\t\tawait warnUnrecognizedSlashCommand(chat, t('No_such_command', { command: escapeHTML(command) }));\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tconst { permission, clientOnly, callback: handleOnClient, result: handleResult, appId, command: commandName } = command;\n\n\tif (permission && !hasAtLeastOnePermission(permission, message.rid)) {\n\t\tawait warnUnrecognizedSlashCommand(chat, t('You_do_not_have_permission_to_execute_this_command', { command: escapeHTML(commandName) }));\n\t\treturn true;\n\t}\n\n\tif (clientOnly && chat.uid) {\n\t\thandleOnClient?.({ command: commandName, message, params, userId: chat.uid });\n\t\treturn true;\n\t}\n\n\tawait sdk.rest.post('/v1/statistics.telemetry', {\n\t\tparams: [{ eventName: 'slashCommandsStats', timestamp: Date.now(), command: commandName }],\n\t});\n\n\tconst triggerId = chat.ActionManager.generateTriggerId(appId);\n\n\tconst data = {\n\t\tcmd: commandName,\n\t\tparams,\n\t\tmsg: message,\n\t\tuserId: chat.uid,\n\t} as const;\n\n\ttry {\n\t\tif (appId) {\n\t\t\tchat.ActionManager.notifyBusy();\n\t\t}\n\n\t\tconst result = await sdk.call('slashCommand', { cmd: commandName, params, msg: message, triggerId });\n\n\t\thandleResult?.(undefined, result, data);\n\t} catch (error: unknown) {\n\t\tawait warnUnrecognizedSlashCommand(chat, t('Something_went_wrong_while_executing_command', { command: commandName }));\n\t\thandleResult?.(error, undefined, data);\n\t}\n\n\tif (appId) {\n\t\tchat.ActionManager.notifyIdle();\n\t}\n\n\treturn true;\n};\n"]}}},"code":"var _regeneratorRuntime;\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\nvar _slicedToArray;\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 1);\nmodule.export({\n  processSlashCommand: function () {\n    return processSlashCommand;\n  }\n});\nvar Random;\nmodule.link(\"@rocket.chat/random\", {\n  Random: function (v) {\n    Random = v;\n  }\n}, 0);\nvar escapeHTML;\nmodule.link(\"@rocket.chat/string-helpers\", {\n  escapeHTML: function (v) {\n    escapeHTML = v;\n  }\n}, 1);\nvar hasAtLeastOnePermission;\nmodule.link(\"../../../../app/authorization/client\", {\n  hasAtLeastOnePermission: function (v) {\n    hasAtLeastOnePermission = v;\n  }\n}, 2);\nvar settings;\nmodule.link(\"../../../../app/settings/client\", {\n  settings: function (v) {\n    settings = v;\n  }\n}, 3);\nvar slashCommands;\nmodule.link(\"../../../../app/utils/client\", {\n  slashCommands: function (v) {\n    slashCommands = v;\n  }\n}, 4);\nvar sdk;\nmodule.link(\"../../../../app/utils/client/lib/SDKClient\", {\n  sdk: function (v) {\n    sdk = v;\n  }\n}, 5);\nvar t;\nmodule.link(\"../../../../app/utils/lib/i18n\", {\n  t: function (v) {\n    t = v;\n  }\n}, 6);\nvar parse = function (msg) {\n  var match = msg.match(/^\\/([^\\s]+)(.*)/);\n  if (!match) {\n    return undefined;\n  }\n  var _match = _slicedToArray(match, 3),\n    cmd = _match[1],\n    params = _match[2];\n  var command = slashCommands.commands[cmd];\n  if (!command) {\n    return {\n      command: cmd,\n      params: params\n    };\n  }\n  return {\n    command: command,\n    params: params\n  };\n};\nvar warnUnrecognizedSlashCommand = function () {\n  function _callee(chat, message) {\n    return _regeneratorRuntime.async(function () {\n      function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            console.error(message);\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(chat.data.pushEphemeralMessage({\n              _id: Random.id(),\n              ts: new Date(),\n              msg: message,\n              u: {\n                _id: 'rocket.cat',\n                username: 'rocket.cat',\n                name: 'Rocket.Cat'\n              },\n              \"private\": true,\n              _updatedAt: new Date()\n            }));\n          case 3:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n      return _callee$;\n    }(), null, null, null, Promise);\n  }\n  return _callee;\n}();\nvar processSlashCommand = function () {\n  function _callee2(chat, message) {\n    var match, command, params, permission, clientOnly, handleOnClient, handleResult, appId, commandName, triggerId, data, result;\n    return _regeneratorRuntime.async(function () {\n      function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n            match = parse(message.msg);\n            if (match) {\n              _context2.next = 3;\n              break;\n            }\n            return _context2.abrupt(\"return\", false);\n          case 3:\n            command = match.command, params = match.params;\n            if (!(typeof command === 'string')) {\n              _context2.next = 10;\n              break;\n            }\n            if (settings.get('Message_AllowUnrecognizedSlashCommand')) {\n              _context2.next = 9;\n              break;\n            }\n            _context2.next = 8;\n            return _regeneratorRuntime.awrap(warnUnrecognizedSlashCommand(chat, t('No_such_command', {\n              command: escapeHTML(command)\n            })));\n          case 8:\n            return _context2.abrupt(\"return\", true);\n          case 9:\n            return _context2.abrupt(\"return\", false);\n          case 10:\n            permission = command.permission, clientOnly = command.clientOnly, handleOnClient = command.callback, handleResult = command.result, appId = command.appId, commandName = command.command;\n            if (!(permission && !hasAtLeastOnePermission(permission, message.rid))) {\n              _context2.next = 15;\n              break;\n            }\n            _context2.next = 14;\n            return _regeneratorRuntime.awrap(warnUnrecognizedSlashCommand(chat, t('You_do_not_have_permission_to_execute_this_command', {\n              command: escapeHTML(commandName)\n            })));\n          case 14:\n            return _context2.abrupt(\"return\", true);\n          case 15:\n            if (!(clientOnly && chat.uid)) {\n              _context2.next = 18;\n              break;\n            }\n            handleOnClient === null || handleOnClient === void 0 ? void 0 : handleOnClient({\n              command: commandName,\n              message: message,\n              params: params,\n              userId: chat.uid\n            });\n            return _context2.abrupt(\"return\", true);\n          case 18:\n            _context2.next = 20;\n            return _regeneratorRuntime.awrap(sdk.rest.post('/v1/statistics.telemetry', {\n              params: [{\n                eventName: 'slashCommandsStats',\n                timestamp: Date.now(),\n                command: commandName\n              }]\n            }));\n          case 20:\n            triggerId = chat.ActionManager.generateTriggerId(appId);\n            data = {\n              cmd: commandName,\n              params: params,\n              msg: message,\n              userId: chat.uid\n            };\n            _context2.prev = 22;\n            if (appId) {\n              chat.ActionManager.notifyBusy();\n            }\n            _context2.next = 26;\n            return _regeneratorRuntime.awrap(sdk.call('slashCommand', {\n              cmd: commandName,\n              params: params,\n              msg: message,\n              triggerId: triggerId\n            }));\n          case 26:\n            result = _context2.sent;\n            handleResult === null || handleResult === void 0 ? void 0 : handleResult(undefined, result, data);\n            _context2.next = 35;\n            break;\n          case 30:\n            _context2.prev = 30;\n            _context2.t0 = _context2[\"catch\"](22);\n            _context2.next = 34;\n            return _regeneratorRuntime.awrap(warnUnrecognizedSlashCommand(chat, t('Something_went_wrong_while_executing_command', {\n              command: commandName\n            })));\n          case 34:\n            handleResult === null || handleResult === void 0 ? void 0 : handleResult(_context2.t0, undefined, data);\n          case 35:\n            if (appId) {\n              chat.ActionManager.notifyIdle();\n            }\n            return _context2.abrupt(\"return\", true);\n          case 37:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n      return _callee2$;\n    }(), null, null, [[22, 30]], Promise);\n  }\n  return _callee2;\n}();","map":{"version":3,"names":["_regeneratorRuntime","module","link","default","v","_slicedToArray","export","processSlashCommand","Random","escapeHTML","hasAtLeastOnePermission","settings","slashCommands","sdk","t","parse","msg","match","undefined","_match","cmd","params","command","commands","warnUnrecognizedSlashCommand","_callee","chat","message","async","_callee$","_context","prev","next","console","error","awrap","data","pushEphemeralMessage","_id","id","ts","Date","u","username","name","_updatedAt","stop","Promise","_callee2","permission","clientOnly","handleOnClient","handleResult","appId","commandName","triggerId","result","_callee2$","_context2","abrupt","get","callback","rid","uid","userId","rest","post","eventName","timestamp","now","ActionManager","generateTriggerId","notifyBusy","call","sent","t0","notifyIdle"],"sources":["client/lib/chats/flows/processSlashCommand.ts"],"sourcesContent":["import type { IMessage, SlashCommand } from '@rocket.chat/core-typings';\nimport { Random } from '@rocket.chat/random';\nimport { escapeHTML } from '@rocket.chat/string-helpers';\n\nimport { hasAtLeastOnePermission } from '../../../../app/authorization/client';\nimport { settings } from '../../../../app/settings/client';\nimport { slashCommands } from '../../../../app/utils/client';\nimport { sdk } from '../../../../app/utils/client/lib/SDKClient';\nimport { t } from '../../../../app/utils/lib/i18n';\nimport type { ChatAPI } from '../ChatAPI';\n\nconst parse = (msg: string): { command: string; params: string } | { command: SlashCommand; params: string } | undefined => {\n\tconst match = msg.match(/^\\/([^\\s]+)(.*)/);\n\n\tif (!match) {\n\t\treturn undefined;\n\t}\n\n\tconst [, cmd, params] = match;\n\tconst command = slashCommands.commands[cmd];\n\n\tif (!command) {\n\t\treturn { command: cmd, params };\n\t}\n\n\treturn { command, params };\n};\n\nconst warnUnrecognizedSlashCommand = async (chat: ChatAPI, message: string): Promise<void> => {\n\tconsole.error(message);\n\n\tawait chat.data.pushEphemeralMessage({\n\t\t_id: Random.id(),\n\t\tts: new Date(),\n\t\tmsg: message,\n\t\tu: {\n\t\t\t_id: 'rocket.cat',\n\t\t\tusername: 'rocket.cat',\n\t\t\tname: 'Rocket.Cat',\n\t\t},\n\t\tprivate: true,\n\t\t_updatedAt: new Date(),\n\t});\n};\n\nexport const processSlashCommand = async (chat: ChatAPI, message: IMessage): Promise<boolean> => {\n\tconst match = parse(message.msg);\n\n\tif (!match) {\n\t\treturn false;\n\t}\n\n\tconst { command, params } = match;\n\n\tif (typeof command === 'string') {\n\t\tif (!settings.get('Message_AllowUnrecognizedSlashCommand')) {\n\t\t\tawait warnUnrecognizedSlashCommand(chat, t('No_such_command', { command: escapeHTML(command) }));\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tconst { permission, clientOnly, callback: handleOnClient, result: handleResult, appId, command: commandName } = command;\n\n\tif (permission && !hasAtLeastOnePermission(permission, message.rid)) {\n\t\tawait warnUnrecognizedSlashCommand(chat, t('You_do_not_have_permission_to_execute_this_command', { command: escapeHTML(commandName) }));\n\t\treturn true;\n\t}\n\n\tif (clientOnly && chat.uid) {\n\t\thandleOnClient?.({ command: commandName, message, params, userId: chat.uid });\n\t\treturn true;\n\t}\n\n\tawait sdk.rest.post('/v1/statistics.telemetry', {\n\t\tparams: [{ eventName: 'slashCommandsStats', timestamp: Date.now(), command: commandName }],\n\t});\n\n\tconst triggerId = chat.ActionManager.generateTriggerId(appId);\n\n\tconst data = {\n\t\tcmd: commandName,\n\t\tparams,\n\t\tmsg: message,\n\t\tuserId: chat.uid,\n\t} as const;\n\n\ttry {\n\t\tif (appId) {\n\t\t\tchat.ActionManager.notifyBusy();\n\t\t}\n\n\t\tconst result = await sdk.call('slashCommand', { cmd: commandName, params, msg: message, triggerId });\n\n\t\thandleResult?.(undefined, result, data);\n\t} catch (error: unknown) {\n\t\tawait warnUnrecognizedSlashCommand(chat, t('Something_went_wrong_while_executing_command', { command: commandName }));\n\t\thandleResult?.(error, undefined, data);\n\t}\n\n\tif (appId) {\n\t\tchat.ActionManager.notifyIdle();\n\t}\n\n\treturn true;\n};\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"f5db8eca7705677dc44fe980c828f86aece0fb09"}
