{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/providers/TooltipProvider.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/providers/TooltipProvider.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/providers/TooltipProvider.tsx","inputSourceMap":{"version":3,"file":"client/providers/TooltipProvider.tsx","sourceRoot":"","sources":["client/providers/TooltipProvider.tsx"],"names":[],"mappings":"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","sourcesContent":["import { useDebouncedState, useMediaQuery } from '@rocket.chat/fuselage-hooks';\nimport { TooltipComponent } from '@rocket.chat/ui-client';\nimport { TooltipContext } from '@rocket.chat/ui-contexts';\nimport type { ReactNode } from 'react';\nimport React, { useEffect, useMemo, useRef, memo, useCallback, useState } from 'react';\n\nimport TooltipPortal from '../portals/TooltipPortal';\n\ntype TooltipProviderProps = {\n\tchildren?: ReactNode;\n};\n\nconst TooltipProvider = ({ children }: TooltipProviderProps) => {\n\tconst lastAnchor = useRef<HTMLElement>();\n\tconst hasHover = !useMediaQuery('(hover: none)');\n\n\tconst [tooltip, setTooltip] = useDebouncedState<ReactNode>(null, 300);\n\n\tconst restoreTitle = useCallback((previousAnchor: HTMLElement | undefined): void => {\n\t\tsetTimeout(() => {\n\t\t\tif (previousAnchor && !previousAnchor.getAttribute('title')) {\n\t\t\t\tpreviousAnchor.setAttribute('title', previousAnchor.getAttribute('data-title') ?? '');\n\t\t\t\tpreviousAnchor.removeAttribute('data-title');\n\t\t\t}\n\t\t}, 0);\n\t}, []);\n\n\tconst contextValue = useMemo(\n\t\t() => ({\n\t\t\topen: (tooltip: ReactNode, anchor: HTMLElement): void => {\n\t\t\t\tconst previousAnchor = lastAnchor.current;\n\t\t\t\tsetTooltip(<TooltipComponent key={new Date().toISOString()} title={tooltip} anchor={anchor} />);\n\t\t\t\tlastAnchor.current = anchor;\n\t\t\t\tpreviousAnchor && restoreTitle(previousAnchor);\n\t\t\t},\n\t\t\tclose: (): void => {\n\t\t\t\tconst previousAnchor = lastAnchor.current;\n\t\t\t\tsetTooltip(null);\n\t\t\t\tsetTooltip.flush();\n\t\t\t\tlastAnchor.current = undefined;\n\t\t\t\tpreviousAnchor && restoreTitle(previousAnchor);\n\t\t\t},\n\t\t\tdismiss: (): void => {\n\t\t\t\tsetTooltip(null);\n\t\t\t\tsetTooltip.flush();\n\t\t\t},\n\t\t}),\n\t\t[setTooltip, restoreTitle],\n\t);\n\n\tuseEffect(() => {\n\t\tif (!hasHover) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst handleMouseOver = (e: MouseEvent): void => {\n\t\t\tconst target = e.target as HTMLElement;\n\t\t\tif (lastAnchor.current === target) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst anchor = target.closest('[title], [data-tooltip]') as HTMLElement;\n\n\t\t\tif (lastAnchor.current === anchor) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!anchor) {\n\t\t\t\tcontextValue.close();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst title = anchor.getAttribute('title') ?? anchor.getAttribute('data-tooltip') ?? '';\n\t\t\tif (!title) {\n\t\t\t\tcontextValue.close();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// eslint-disable-next-line react/no-multi-comp\n\t\t\tconst Handler = () => {\n\t\t\t\tconst [state, setState] = useState(title);\n\t\t\t\tuseEffect(() => {\n\t\t\t\t\tconst close = (): void => contextValue.close();\n\t\t\t\t\t// store the title in a data attribute\n\t\t\t\t\tanchor.setAttribute('data-title', title);\n\t\t\t\t\t// Removes the title attribute to prevent the browser's tooltip from showing\n\t\t\t\t\tanchor.setAttribute('title', '');\n\n\t\t\t\t\tanchor.addEventListener('mouseleave', close);\n\n\t\t\t\t\tconst observer = new MutationObserver(() => {\n\t\t\t\t\t\tconst title = anchor.getAttribute('title') ?? anchor.getAttribute('data-tooltip') ?? '';\n\n\t\t\t\t\t\tif (title === '') {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// store the title in a data attribute\n\t\t\t\t\t\tanchor.setAttribute('data-title', title);\n\t\t\t\t\t\t// Removes the title attribute to prevent the browser's tooltip from showing\n\t\t\t\t\t\tanchor.setAttribute('title', '');\n\n\t\t\t\t\t\tsetState(title);\n\t\t\t\t\t});\n\n\t\t\t\t\tobserver.observe(anchor, {\n\t\t\t\t\t\tattributes: true,\n\t\t\t\t\t\tattributeFilter: ['title', 'data-tooltip'],\n\t\t\t\t\t});\n\n\t\t\t\t\treturn () => {\n\t\t\t\t\t\tanchor.removeEventListener('mouseleave', close);\n\t\t\t\t\t\tobserver.disconnect();\n\t\t\t\t\t};\n\t\t\t\t}, []);\n\t\t\t\treturn <>{state}</>;\n\t\t\t};\n\t\t\tcontextValue.open(<Handler />, anchor);\n\t\t};\n\n\t\tconst dismissOnClick = (): void => {\n\t\t\tcontextValue.dismiss();\n\t\t};\n\n\t\tdocument.body.addEventListener('mouseover', handleMouseOver, {\n\t\t\tpassive: true,\n\t\t});\n\t\tdocument.body.addEventListener('click', dismissOnClick, { capture: true });\n\n\t\treturn (): void => {\n\t\t\tcontextValue.close();\n\t\t\tdocument.body.removeEventListener('mouseover', handleMouseOver);\n\t\t\tdocument.body.removeEventListener('click', dismissOnClick);\n\t\t};\n\t}, [contextValue, setTooltip, hasHover]);\n\n\treturn (\n\t\t<TooltipContext.Provider value={contextValue}>\n\t\t\t{children}\n\t\t\t{tooltip && <TooltipPortal>{tooltip}</TooltipPortal>}\n\t\t</TooltipContext.Provider>\n\t);\n};\n\nexport default memo<typeof TooltipProvider>(TooltipProvider);\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/providers/TooltipProvider.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/providers/TooltipProvider.tsx","inputSourceMap":{"version":3,"file":"client/providers/TooltipProvider.tsx","sourceRoot":"","sources":["client/providers/TooltipProvider.tsx"],"names":[],"mappings":"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","sourcesContent":["import { useDebouncedState, useMediaQuery } from '@rocket.chat/fuselage-hooks';\nimport { TooltipComponent } from '@rocket.chat/ui-client';\nimport { TooltipContext } from '@rocket.chat/ui-contexts';\nimport type { ReactNode } from 'react';\nimport React, { useEffect, useMemo, useRef, memo, useCallback, useState } from 'react';\n\nimport TooltipPortal from '../portals/TooltipPortal';\n\ntype TooltipProviderProps = {\n\tchildren?: ReactNode;\n};\n\nconst TooltipProvider = ({ children }: TooltipProviderProps) => {\n\tconst lastAnchor = useRef<HTMLElement>();\n\tconst hasHover = !useMediaQuery('(hover: none)');\n\n\tconst [tooltip, setTooltip] = useDebouncedState<ReactNode>(null, 300);\n\n\tconst restoreTitle = useCallback((previousAnchor: HTMLElement | undefined): void => {\n\t\tsetTimeout(() => {\n\t\t\tif (previousAnchor && !previousAnchor.getAttribute('title')) {\n\t\t\t\tpreviousAnchor.setAttribute('title', previousAnchor.getAttribute('data-title') ?? '');\n\t\t\t\tpreviousAnchor.removeAttribute('data-title');\n\t\t\t}\n\t\t}, 0);\n\t}, []);\n\n\tconst contextValue = useMemo(\n\t\t() => ({\n\t\t\topen: (tooltip: ReactNode, anchor: HTMLElement): void => {\n\t\t\t\tconst previousAnchor = lastAnchor.current;\n\t\t\t\tsetTooltip(<TooltipComponent key={new Date().toISOString()} title={tooltip} anchor={anchor} />);\n\t\t\t\tlastAnchor.current = anchor;\n\t\t\t\tpreviousAnchor && restoreTitle(previousAnchor);\n\t\t\t},\n\t\t\tclose: (): void => {\n\t\t\t\tconst previousAnchor = lastAnchor.current;\n\t\t\t\tsetTooltip(null);\n\t\t\t\tsetTooltip.flush();\n\t\t\t\tlastAnchor.current = undefined;\n\t\t\t\tpreviousAnchor && restoreTitle(previousAnchor);\n\t\t\t},\n\t\t\tdismiss: (): void => {\n\t\t\t\tsetTooltip(null);\n\t\t\t\tsetTooltip.flush();\n\t\t\t},\n\t\t}),\n\t\t[setTooltip, restoreTitle],\n\t);\n\n\tuseEffect(() => {\n\t\tif (!hasHover) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst handleMouseOver = (e: MouseEvent): void => {\n\t\t\tconst target = e.target as HTMLElement;\n\t\t\tif (lastAnchor.current === target) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst anchor = target.closest('[title], [data-tooltip]') as HTMLElement;\n\n\t\t\tif (lastAnchor.current === anchor) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!anchor) {\n\t\t\t\tcontextValue.close();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst title = anchor.getAttribute('title') ?? anchor.getAttribute('data-tooltip') ?? '';\n\t\t\tif (!title) {\n\t\t\t\tcontextValue.close();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// eslint-disable-next-line react/no-multi-comp\n\t\t\tconst Handler = () => {\n\t\t\t\tconst [state, setState] = useState(title);\n\t\t\t\tuseEffect(() => {\n\t\t\t\t\tconst close = (): void => contextValue.close();\n\t\t\t\t\t// store the title in a data attribute\n\t\t\t\t\tanchor.setAttribute('data-title', title);\n\t\t\t\t\t// Removes the title attribute to prevent the browser's tooltip from showing\n\t\t\t\t\tanchor.setAttribute('title', '');\n\n\t\t\t\t\tanchor.addEventListener('mouseleave', close);\n\n\t\t\t\t\tconst observer = new MutationObserver(() => {\n\t\t\t\t\t\tconst title = anchor.getAttribute('title') ?? anchor.getAttribute('data-tooltip') ?? '';\n\n\t\t\t\t\t\tif (title === '') {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// store the title in a data attribute\n\t\t\t\t\t\tanchor.setAttribute('data-title', title);\n\t\t\t\t\t\t// Removes the title attribute to prevent the browser's tooltip from showing\n\t\t\t\t\t\tanchor.setAttribute('title', '');\n\n\t\t\t\t\t\tsetState(title);\n\t\t\t\t\t});\n\n\t\t\t\t\tobserver.observe(anchor, {\n\t\t\t\t\t\tattributes: true,\n\t\t\t\t\t\tattributeFilter: ['title', 'data-tooltip'],\n\t\t\t\t\t});\n\n\t\t\t\t\treturn () => {\n\t\t\t\t\t\tanchor.removeEventListener('mouseleave', close);\n\t\t\t\t\t\tobserver.disconnect();\n\t\t\t\t\t};\n\t\t\t\t}, []);\n\t\t\t\treturn <>{state}</>;\n\t\t\t};\n\t\t\tcontextValue.open(<Handler />, anchor);\n\t\t};\n\n\t\tconst dismissOnClick = (): void => {\n\t\t\tcontextValue.dismiss();\n\t\t};\n\n\t\tdocument.body.addEventListener('mouseover', handleMouseOver, {\n\t\t\tpassive: true,\n\t\t});\n\t\tdocument.body.addEventListener('click', dismissOnClick, { capture: true });\n\n\t\treturn (): void => {\n\t\t\tcontextValue.close();\n\t\t\tdocument.body.removeEventListener('mouseover', handleMouseOver);\n\t\t\tdocument.body.removeEventListener('click', dismissOnClick);\n\t\t};\n\t}, [contextValue, setTooltip, hasHover]);\n\n\treturn (\n\t\t<TooltipContext.Provider value={contextValue}>\n\t\t\t{children}\n\t\t\t{tooltip && <TooltipPortal>{tooltip}</TooltipPortal>}\n\t\t</TooltipContext.Provider>\n\t);\n};\n\nexport default memo<typeof TooltipProvider>(TooltipProvider);\n"]}}},"code":"var _slicedToArray;\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 0);\nvar useDebouncedState, useMediaQuery;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useDebouncedState: function (v) {\n    useDebouncedState = v;\n  },\n  useMediaQuery: function (v) {\n    useMediaQuery = v;\n  }\n}, 0);\nvar TooltipComponent;\nmodule.link(\"@rocket.chat/ui-client\", {\n  TooltipComponent: function (v) {\n    TooltipComponent = v;\n  }\n}, 1);\nvar TooltipContext;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  TooltipContext: function (v) {\n    TooltipContext = v;\n  }\n}, 2);\nvar React, useEffect, useMemo, useRef, memo, useCallback, useState;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useEffect: function (v) {\n    useEffect = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  },\n  useRef: function (v) {\n    useRef = v;\n  },\n  memo: function (v) {\n    memo = v;\n  },\n  useCallback: function (v) {\n    useCallback = v;\n  },\n  useState: function (v) {\n    useState = v;\n  }\n}, 3);\nvar TooltipPortal;\nmodule.link(\"../portals/TooltipPortal\", {\n  \"default\": function (v) {\n    TooltipPortal = v;\n  }\n}, 4);\nvar TooltipProvider = function (_ref) {\n  var children = _ref.children;\n  var lastAnchor = useRef();\n  var hasHover = !useMediaQuery('(hover: none)');\n  var _useDebouncedState = useDebouncedState(null, 300),\n    _useDebouncedState2 = _slicedToArray(_useDebouncedState, 2),\n    tooltip = _useDebouncedState2[0],\n    setTooltip = _useDebouncedState2[1];\n  var restoreTitle = useCallback(function (previousAnchor) {\n    setTimeout(function () {\n      if (previousAnchor && !previousAnchor.getAttribute('title')) {\n        var _previousAnchor$getAt;\n        previousAnchor.setAttribute('title', (_previousAnchor$getAt = previousAnchor.getAttribute('data-title')) !== null && _previousAnchor$getAt !== void 0 ? _previousAnchor$getAt : '');\n        previousAnchor.removeAttribute('data-title');\n      }\n    }, 0);\n  }, []);\n  var contextValue = useMemo(function () {\n    return {\n      open: function (tooltip, anchor) {\n        var previousAnchor = lastAnchor.current;\n        setTooltip( /*#__PURE__*/React.createElement(TooltipComponent, {\n          key: new Date().toISOString(),\n          title: tooltip,\n          anchor: anchor\n        }));\n        lastAnchor.current = anchor;\n        previousAnchor && restoreTitle(previousAnchor);\n      },\n      close: function () {\n        var previousAnchor = lastAnchor.current;\n        setTooltip(null);\n        setTooltip.flush();\n        lastAnchor.current = undefined;\n        previousAnchor && restoreTitle(previousAnchor);\n      },\n      dismiss: function () {\n        setTooltip(null);\n        setTooltip.flush();\n      }\n    };\n  }, [setTooltip, restoreTitle]);\n  useEffect(function () {\n    if (!hasHover) {\n      return;\n    }\n    var handleMouseOver = function (e) {\n      var _ref2, _anchor$getAttribute;\n      var target = e.target;\n      if (lastAnchor.current === target) {\n        return;\n      }\n      var anchor = target.closest('[title], [data-tooltip]');\n      if (lastAnchor.current === anchor) {\n        return;\n      }\n      if (!anchor) {\n        contextValue.close();\n        return;\n      }\n      var title = (_ref2 = (_anchor$getAttribute = anchor.getAttribute('title')) !== null && _anchor$getAttribute !== void 0 ? _anchor$getAttribute : anchor.getAttribute('data-tooltip')) !== null && _ref2 !== void 0 ? _ref2 : '';\n      if (!title) {\n        contextValue.close();\n        return;\n      }\n      // eslint-disable-next-line react/no-multi-comp\n      var Handler = function () {\n        var _useState = useState(title),\n          _useState2 = _slicedToArray(_useState, 2),\n          state = _useState2[0],\n          setState = _useState2[1];\n        useEffect(function () {\n          var close = function () {\n            return contextValue.close();\n          };\n          // store the title in a data attribute\n          anchor.setAttribute('data-title', title);\n          // Removes the title attribute to prevent the browser's tooltip from showing\n          anchor.setAttribute('title', '');\n          anchor.addEventListener('mouseleave', close);\n          var observer = new MutationObserver(function () {\n            var _ref3, _anchor$getAttribute2;\n            var title = (_ref3 = (_anchor$getAttribute2 = anchor.getAttribute('title')) !== null && _anchor$getAttribute2 !== void 0 ? _anchor$getAttribute2 : anchor.getAttribute('data-tooltip')) !== null && _ref3 !== void 0 ? _ref3 : '';\n            if (title === '') {\n              return;\n            }\n            // store the title in a data attribute\n            anchor.setAttribute('data-title', title);\n            // Removes the title attribute to prevent the browser's tooltip from showing\n            anchor.setAttribute('title', '');\n            setState(title);\n          });\n          observer.observe(anchor, {\n            attributes: true,\n            attributeFilter: ['title', 'data-tooltip']\n          });\n          return function () {\n            anchor.removeEventListener('mouseleave', close);\n            observer.disconnect();\n          };\n        }, []);\n        return /*#__PURE__*/React.createElement(React.Fragment, null, state);\n      };\n      contextValue.open( /*#__PURE__*/React.createElement(Handler, null), anchor);\n    };\n    var dismissOnClick = function () {\n      contextValue.dismiss();\n    };\n    document.body.addEventListener('mouseover', handleMouseOver, {\n      passive: true\n    });\n    document.body.addEventListener('click', dismissOnClick, {\n      capture: true\n    });\n    return function () {\n      contextValue.close();\n      document.body.removeEventListener('mouseover', handleMouseOver);\n      document.body.removeEventListener('click', dismissOnClick);\n    };\n  }, [contextValue, setTooltip, hasHover]);\n  return /*#__PURE__*/React.createElement(TooltipContext.Provider, {\n    value: contextValue\n  }, children, tooltip && /*#__PURE__*/React.createElement(TooltipPortal, null, tooltip));\n};\nmodule.exportDefault( /*#__PURE__*/memo(TooltipProvider));","map":{"version":3,"names":["_slicedToArray","module","link","default","v","useDebouncedState","useMediaQuery","TooltipComponent","TooltipContext","React","useEffect","useMemo","useRef","memo","useCallback","useState","TooltipPortal","TooltipProvider","_ref","children","lastAnchor","hasHover","_useDebouncedState","_useDebouncedState2","tooltip","setTooltip","restoreTitle","previousAnchor","setTimeout","getAttribute","_previousAnchor$getAt","setAttribute","removeAttribute","contextValue","open","anchor","current","createElement","key","Date","toISOString","title","close","flush","undefined","dismiss","handleMouseOver","e","_ref2","_anchor$getAttribute","target","closest","Handler","_useState","_useState2","state","setState","addEventListener","observer","MutationObserver","_ref3","_anchor$getAttribute2","observe","attributes","attributeFilter","removeEventListener","disconnect","Fragment","dismissOnClick","document","body","passive","capture","Provider","value","exportDefault"],"sources":["client/providers/TooltipProvider.tsx"],"sourcesContent":["import { useDebouncedState, useMediaQuery } from '@rocket.chat/fuselage-hooks';\nimport { TooltipComponent } from '@rocket.chat/ui-client';\nimport { TooltipContext } from '@rocket.chat/ui-contexts';\nimport type { ReactNode } from 'react';\nimport React, { useEffect, useMemo, useRef, memo, useCallback, useState } from 'react';\n\nimport TooltipPortal from '../portals/TooltipPortal';\n\ntype TooltipProviderProps = {\n\tchildren?: ReactNode;\n};\n\nconst TooltipProvider = ({ children }: TooltipProviderProps) => {\n\tconst lastAnchor = useRef<HTMLElement>();\n\tconst hasHover = !useMediaQuery('(hover: none)');\n\n\tconst [tooltip, setTooltip] = useDebouncedState<ReactNode>(null, 300);\n\n\tconst restoreTitle = useCallback((previousAnchor: HTMLElement | undefined): void => {\n\t\tsetTimeout(() => {\n\t\t\tif (previousAnchor && !previousAnchor.getAttribute('title')) {\n\t\t\t\tpreviousAnchor.setAttribute('title', previousAnchor.getAttribute('data-title') ?? '');\n\t\t\t\tpreviousAnchor.removeAttribute('data-title');\n\t\t\t}\n\t\t}, 0);\n\t}, []);\n\n\tconst contextValue = useMemo(\n\t\t() => ({\n\t\t\topen: (tooltip: ReactNode, anchor: HTMLElement): void => {\n\t\t\t\tconst previousAnchor = lastAnchor.current;\n\t\t\t\tsetTooltip(<TooltipComponent key={new Date().toISOString()} title={tooltip} anchor={anchor} />);\n\t\t\t\tlastAnchor.current = anchor;\n\t\t\t\tpreviousAnchor && restoreTitle(previousAnchor);\n\t\t\t},\n\t\t\tclose: (): void => {\n\t\t\t\tconst previousAnchor = lastAnchor.current;\n\t\t\t\tsetTooltip(null);\n\t\t\t\tsetTooltip.flush();\n\t\t\t\tlastAnchor.current = undefined;\n\t\t\t\tpreviousAnchor && restoreTitle(previousAnchor);\n\t\t\t},\n\t\t\tdismiss: (): void => {\n\t\t\t\tsetTooltip(null);\n\t\t\t\tsetTooltip.flush();\n\t\t\t},\n\t\t}),\n\t\t[setTooltip, restoreTitle],\n\t);\n\n\tuseEffect(() => {\n\t\tif (!hasHover) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst handleMouseOver = (e: MouseEvent): void => {\n\t\t\tconst target = e.target as HTMLElement;\n\t\t\tif (lastAnchor.current === target) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst anchor = target.closest('[title], [data-tooltip]') as HTMLElement;\n\n\t\t\tif (lastAnchor.current === anchor) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!anchor) {\n\t\t\t\tcontextValue.close();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst title = anchor.getAttribute('title') ?? anchor.getAttribute('data-tooltip') ?? '';\n\t\t\tif (!title) {\n\t\t\t\tcontextValue.close();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// eslint-disable-next-line react/no-multi-comp\n\t\t\tconst Handler = () => {\n\t\t\t\tconst [state, setState] = useState(title);\n\t\t\t\tuseEffect(() => {\n\t\t\t\t\tconst close = (): void => contextValue.close();\n\t\t\t\t\t// store the title in a data attribute\n\t\t\t\t\tanchor.setAttribute('data-title', title);\n\t\t\t\t\t// Removes the title attribute to prevent the browser's tooltip from showing\n\t\t\t\t\tanchor.setAttribute('title', '');\n\n\t\t\t\t\tanchor.addEventListener('mouseleave', close);\n\n\t\t\t\t\tconst observer = new MutationObserver(() => {\n\t\t\t\t\t\tconst title = anchor.getAttribute('title') ?? anchor.getAttribute('data-tooltip') ?? '';\n\n\t\t\t\t\t\tif (title === '') {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// store the title in a data attribute\n\t\t\t\t\t\tanchor.setAttribute('data-title', title);\n\t\t\t\t\t\t// Removes the title attribute to prevent the browser's tooltip from showing\n\t\t\t\t\t\tanchor.setAttribute('title', '');\n\n\t\t\t\t\t\tsetState(title);\n\t\t\t\t\t});\n\n\t\t\t\t\tobserver.observe(anchor, {\n\t\t\t\t\t\tattributes: true,\n\t\t\t\t\t\tattributeFilter: ['title', 'data-tooltip'],\n\t\t\t\t\t});\n\n\t\t\t\t\treturn () => {\n\t\t\t\t\t\tanchor.removeEventListener('mouseleave', close);\n\t\t\t\t\t\tobserver.disconnect();\n\t\t\t\t\t};\n\t\t\t\t}, []);\n\t\t\t\treturn <>{state}</>;\n\t\t\t};\n\t\t\tcontextValue.open(<Handler />, anchor);\n\t\t};\n\n\t\tconst dismissOnClick = (): void => {\n\t\t\tcontextValue.dismiss();\n\t\t};\n\n\t\tdocument.body.addEventListener('mouseover', handleMouseOver, {\n\t\t\tpassive: true,\n\t\t});\n\t\tdocument.body.addEventListener('click', dismissOnClick, { capture: true });\n\n\t\treturn (): void => {\n\t\t\tcontextValue.close();\n\t\t\tdocument.body.removeEventListener('mouseover', handleMouseOver);\n\t\t\tdocument.body.removeEventListener('click', dismissOnClick);\n\t\t};\n\t}, [contextValue, setTooltip, hasHover]);\n\n\treturn (\n\t\t<TooltipContext.Provider value={contextValue}>\n\t\t\t{children}\n\t\t\t{tooltip && <TooltipPortal>{tooltip}</TooltipPortal>}\n\t\t</TooltipContext.Provider>\n\t);\n};\n\nexport default memo<typeof TooltipProvider>(TooltipProvider);\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"0537dea92d72734428c6e95a883c75ed1d14caa9"}
