{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/contextualBar/PruneMessages/PruneMessagesWithData.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/room/contextualBar/PruneMessages/PruneMessagesWithData.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/contextualBar/PruneMessages/PruneMessagesWithData.tsx","inputSourceMap":{"version":3,"file":"client/views/room/contextualBar/PruneMessages/PruneMessagesWithData.tsx","sourceRoot":"","sources":["client/views/room/contextualBar/PruneMessages/PruneMessagesWithData.tsx"],"names":[],"mappings":"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","sourcesContent":["import { isDirectMessageRoom } from '@rocket.chat/core-typings';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useToastMessageDispatch, useEndpoint } from '@rocket.chat/ui-contexts';\nimport moment from 'moment';\nimport type { ReactElement } from 'react';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { useForm, FormProvider } from 'react-hook-form';\nimport { useTranslation } from 'react-i18next';\n\nimport GenericModal from '../../../../components/GenericModal';\nimport { useRoom } from '../../contexts/RoomContext';\nimport { useRoomToolbox } from '../../contexts/RoomToolboxContext';\nimport PruneMessages from './PruneMessages';\n\nconst getTimeZoneOffset = (): string => {\n\tconst offset = new Date().getTimezoneOffset();\n\tconst absOffset = Math.abs(offset);\n\treturn `${offset < 0 ? '+' : '-'}${`00${Math.floor(absOffset / 60)}`.slice(-2)}:${`00${absOffset % 60}`.slice(-2)}`;\n};\n\nexport const initialValues = {\n\tnewer: {\n\t\tdate: '',\n\t\ttime: '',\n\t},\n\tolder: {\n\t\tdate: '',\n\t\ttime: '',\n\t},\n\tusers: [],\n\tinclusive: false,\n\tpinned: false,\n\tdiscussion: false,\n\tthreads: false,\n\tattached: false,\n};\n\nconst DEFAULT_PRUNE_LIMIT = 2000;\n\nconst PruneMessagesWithData = (): ReactElement => {\n\tconst { t } = useTranslation();\n\tconst room = useRoom();\n\tconst setModal = useSetModal();\n\tconst { closeTab: close } = useRoomToolbox();\n\tconst closeModal = useCallback(() => setModal(null), [setModal]);\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst pruneMessagesAction = useEndpoint('POST', '/v1/rooms.cleanHistory');\n\n\tconst [counter, setCounter] = useState(0);\n\n\tconst methods = useForm({ defaultValues: initialValues });\n\n\tconst {\n\t\tnewer: { date: newerDate, time: newerTime },\n\t\tolder: { date: olderDate, time: olderTime },\n\t\tusers,\n\t\tinclusive,\n\t\tpinned,\n\t\tdiscussion,\n\t\tthreads,\n\t\tattached,\n\t} = methods.watch();\n\n\tconst fromDate = useMemo(() => {\n\t\treturn new Date(`${newerDate || '0001-01-01'}T${newerTime || '00:00'}:00${getTimeZoneOffset()}`);\n\t}, [newerDate, newerTime]);\n\n\tconst toDate = useMemo(() => {\n\t\treturn new Date(`${olderDate || '9999-12-31'}T${olderTime || '23:59'}:59${getTimeZoneOffset()}`);\n\t}, [olderDate, olderTime]);\n\n\tconst handlePrune = useMutableCallback((): void => {\n\t\tconst handlePruneAction = async () => {\n\t\t\tconst limit = DEFAULT_PRUNE_LIMIT;\n\n\t\t\ttry {\n\t\t\t\tif (counter === limit) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst { count } = await pruneMessagesAction({\n\t\t\t\t\troomId: room._id,\n\t\t\t\t\tlatest: toDate.toISOString(),\n\t\t\t\t\toldest: fromDate.toISOString(),\n\t\t\t\t\tinclusive,\n\t\t\t\t\tlimit,\n\t\t\t\t\texcludePinned: pinned,\n\t\t\t\t\tfilesOnly: attached,\n\t\t\t\t\tignoreDiscussion: discussion,\n\t\t\t\t\tignoreThreads: threads,\n\t\t\t\t\tusers,\n\t\t\t\t});\n\n\t\t\t\tsetCounter(count);\n\n\t\t\t\tif (count < 1) {\n\t\t\t\t\tthrow new Error(t('No_messages_found_to_prune'));\n\t\t\t\t}\n\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('__count__message_pruned', { count }) });\n\t\t\t\tmethods.reset();\n\t\t\t} catch (error: unknown) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tcloseModal();\n\t\t\t}\n\t\t};\n\n\t\treturn setModal(\n\t\t\t<GenericModal\n\t\t\t\tvariant='danger'\n\t\t\t\tonClose={closeModal}\n\t\t\t\tonCancel={closeModal}\n\t\t\t\tonConfirm={handlePruneAction}\n\t\t\t\tconfirmText={t('Yes_prune_them')}\n\t\t\t>\n\t\t\t\t{t('Prune_Modal')}\n\t\t\t</GenericModal>,\n\t\t);\n\t});\n\n\tconst callOutText = useMemo(() => {\n\t\tconst name = room && ((isDirectMessageRoom(room) && room.usernames?.join(' x ')) || room.fname || room.name);\n\t\tconst exceptPinned = pinned ? ` ${t('except_pinned')}` : '';\n\t\tconst ifFrom = users.length\n\t\t\t? ` ${t('if_they_are_from', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [users.map((element) => element).join(', ')],\n\t\t\t  })}`\n\t\t\t: '';\n\t\tconst filesOrMessages = attached ? t('files') : t('messages');\n\n\t\tif (newerDate && olderDate) {\n\t\t\treturn (\n\t\t\t\tt('Prune_Warning_between', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [filesOrMessages, name, moment(fromDate).format('L LT'), moment(toDate).format('L LT')],\n\t\t\t\t}) +\n\t\t\t\texceptPinned +\n\t\t\t\tifFrom\n\t\t\t);\n\t\t}\n\n\t\tif (newerDate) {\n\t\t\treturn (\n\t\t\t\tt('Prune_Warning_after', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [filesOrMessages, name, moment(fromDate).format('L LT')],\n\t\t\t\t}) +\n\t\t\t\texceptPinned +\n\t\t\t\tifFrom\n\t\t\t);\n\t\t}\n\n\t\tif (olderDate) {\n\t\t\treturn (\n\t\t\t\tt('Prune_Warning_before', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [filesOrMessages, name, moment(toDate).format('L LT')],\n\t\t\t\t}) +\n\t\t\t\texceptPinned +\n\t\t\t\tifFrom\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\tt('Prune_Warning_all', {\n\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\tsprintf: [filesOrMessages, name],\n\t\t\t}) +\n\t\t\texceptPinned +\n\t\t\tifFrom\n\t\t);\n\t}, [attached, fromDate, newerDate, olderDate, pinned, room, t, toDate, users]);\n\n\tconst validateText = useMemo(() => {\n\t\tif (fromDate > toDate) {\n\t\t\treturn t('Newer_than_may_not_exceed_Older_than');\n\t\t}\n\n\t\tif (isNaN(fromDate.getTime()) || isNaN(toDate.getTime())) {\n\t\t\treturn t('error-invalid-date');\n\t\t}\n\n\t\treturn undefined;\n\t}, [fromDate, t, toDate]);\n\n\treturn (\n\t\t<FormProvider {...methods}>\n\t\t\t<PruneMessages callOutText={callOutText} validateText={validateText} users={users} onClickClose={close} onClickPrune={handlePrune} />\n\t\t</FormProvider>\n\t);\n};\n\nexport default PruneMessagesWithData;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/contextualBar/PruneMessages/PruneMessagesWithData.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/contextualBar/PruneMessages/PruneMessagesWithData.tsx","inputSourceMap":{"version":3,"file":"client/views/room/contextualBar/PruneMessages/PruneMessagesWithData.tsx","sourceRoot":"","sources":["client/views/room/contextualBar/PruneMessages/PruneMessagesWithData.tsx"],"names":[],"mappings":"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","sourcesContent":["import { isDirectMessageRoom } from '@rocket.chat/core-typings';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useToastMessageDispatch, useEndpoint } from '@rocket.chat/ui-contexts';\nimport moment from 'moment';\nimport type { ReactElement } from 'react';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { useForm, FormProvider } from 'react-hook-form';\nimport { useTranslation } from 'react-i18next';\n\nimport GenericModal from '../../../../components/GenericModal';\nimport { useRoom } from '../../contexts/RoomContext';\nimport { useRoomToolbox } from '../../contexts/RoomToolboxContext';\nimport PruneMessages from './PruneMessages';\n\nconst getTimeZoneOffset = (): string => {\n\tconst offset = new Date().getTimezoneOffset();\n\tconst absOffset = Math.abs(offset);\n\treturn `${offset < 0 ? '+' : '-'}${`00${Math.floor(absOffset / 60)}`.slice(-2)}:${`00${absOffset % 60}`.slice(-2)}`;\n};\n\nexport const initialValues = {\n\tnewer: {\n\t\tdate: '',\n\t\ttime: '',\n\t},\n\tolder: {\n\t\tdate: '',\n\t\ttime: '',\n\t},\n\tusers: [],\n\tinclusive: false,\n\tpinned: false,\n\tdiscussion: false,\n\tthreads: false,\n\tattached: false,\n};\n\nconst DEFAULT_PRUNE_LIMIT = 2000;\n\nconst PruneMessagesWithData = (): ReactElement => {\n\tconst { t } = useTranslation();\n\tconst room = useRoom();\n\tconst setModal = useSetModal();\n\tconst { closeTab: close } = useRoomToolbox();\n\tconst closeModal = useCallback(() => setModal(null), [setModal]);\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst pruneMessagesAction = useEndpoint('POST', '/v1/rooms.cleanHistory');\n\n\tconst [counter, setCounter] = useState(0);\n\n\tconst methods = useForm({ defaultValues: initialValues });\n\n\tconst {\n\t\tnewer: { date: newerDate, time: newerTime },\n\t\tolder: { date: olderDate, time: olderTime },\n\t\tusers,\n\t\tinclusive,\n\t\tpinned,\n\t\tdiscussion,\n\t\tthreads,\n\t\tattached,\n\t} = methods.watch();\n\n\tconst fromDate = useMemo(() => {\n\t\treturn new Date(`${newerDate || '0001-01-01'}T${newerTime || '00:00'}:00${getTimeZoneOffset()}`);\n\t}, [newerDate, newerTime]);\n\n\tconst toDate = useMemo(() => {\n\t\treturn new Date(`${olderDate || '9999-12-31'}T${olderTime || '23:59'}:59${getTimeZoneOffset()}`);\n\t}, [olderDate, olderTime]);\n\n\tconst handlePrune = useMutableCallback((): void => {\n\t\tconst handlePruneAction = async () => {\n\t\t\tconst limit = DEFAULT_PRUNE_LIMIT;\n\n\t\t\ttry {\n\t\t\t\tif (counter === limit) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst { count } = await pruneMessagesAction({\n\t\t\t\t\troomId: room._id,\n\t\t\t\t\tlatest: toDate.toISOString(),\n\t\t\t\t\toldest: fromDate.toISOString(),\n\t\t\t\t\tinclusive,\n\t\t\t\t\tlimit,\n\t\t\t\t\texcludePinned: pinned,\n\t\t\t\t\tfilesOnly: attached,\n\t\t\t\t\tignoreDiscussion: discussion,\n\t\t\t\t\tignoreThreads: threads,\n\t\t\t\t\tusers,\n\t\t\t\t});\n\n\t\t\t\tsetCounter(count);\n\n\t\t\t\tif (count < 1) {\n\t\t\t\t\tthrow new Error(t('No_messages_found_to_prune'));\n\t\t\t\t}\n\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('__count__message_pruned', { count }) });\n\t\t\t\tmethods.reset();\n\t\t\t} catch (error: unknown) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tcloseModal();\n\t\t\t}\n\t\t};\n\n\t\treturn setModal(\n\t\t\t<GenericModal\n\t\t\t\tvariant='danger'\n\t\t\t\tonClose={closeModal}\n\t\t\t\tonCancel={closeModal}\n\t\t\t\tonConfirm={handlePruneAction}\n\t\t\t\tconfirmText={t('Yes_prune_them')}\n\t\t\t>\n\t\t\t\t{t('Prune_Modal')}\n\t\t\t</GenericModal>,\n\t\t);\n\t});\n\n\tconst callOutText = useMemo(() => {\n\t\tconst name = room && ((isDirectMessageRoom(room) && room.usernames?.join(' x ')) || room.fname || room.name);\n\t\tconst exceptPinned = pinned ? ` ${t('except_pinned')}` : '';\n\t\tconst ifFrom = users.length\n\t\t\t? ` ${t('if_they_are_from', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [users.map((element) => element).join(', ')],\n\t\t\t  })}`\n\t\t\t: '';\n\t\tconst filesOrMessages = attached ? t('files') : t('messages');\n\n\t\tif (newerDate && olderDate) {\n\t\t\treturn (\n\t\t\t\tt('Prune_Warning_between', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [filesOrMessages, name, moment(fromDate).format('L LT'), moment(toDate).format('L LT')],\n\t\t\t\t}) +\n\t\t\t\texceptPinned +\n\t\t\t\tifFrom\n\t\t\t);\n\t\t}\n\n\t\tif (newerDate) {\n\t\t\treturn (\n\t\t\t\tt('Prune_Warning_after', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [filesOrMessages, name, moment(fromDate).format('L LT')],\n\t\t\t\t}) +\n\t\t\t\texceptPinned +\n\t\t\t\tifFrom\n\t\t\t);\n\t\t}\n\n\t\tif (olderDate) {\n\t\t\treturn (\n\t\t\t\tt('Prune_Warning_before', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [filesOrMessages, name, moment(toDate).format('L LT')],\n\t\t\t\t}) +\n\t\t\t\texceptPinned +\n\t\t\t\tifFrom\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\tt('Prune_Warning_all', {\n\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\tsprintf: [filesOrMessages, name],\n\t\t\t}) +\n\t\t\texceptPinned +\n\t\t\tifFrom\n\t\t);\n\t}, [attached, fromDate, newerDate, olderDate, pinned, room, t, toDate, users]);\n\n\tconst validateText = useMemo(() => {\n\t\tif (fromDate > toDate) {\n\t\t\treturn t('Newer_than_may_not_exceed_Older_than');\n\t\t}\n\n\t\tif (isNaN(fromDate.getTime()) || isNaN(toDate.getTime())) {\n\t\t\treturn t('error-invalid-date');\n\t\t}\n\n\t\treturn undefined;\n\t}, [fromDate, t, toDate]);\n\n\treturn (\n\t\t<FormProvider {...methods}>\n\t\t\t<PruneMessages callOutText={callOutText} validateText={validateText} users={users} onClickClose={close} onClickPrune={handlePrune} />\n\t\t</FormProvider>\n\t);\n};\n\nexport default PruneMessagesWithData;\n"]}}},"code":"module.export({\n  initialValues: () => initialValues\n});\nlet isDirectMessageRoom;\nmodule.link(\"@rocket.chat/core-typings\", {\n  isDirectMessageRoom(v) {\n    isDirectMessageRoom = v;\n  }\n}, 0);\nlet useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback(v) {\n    useMutableCallback = v;\n  }\n}, 1);\nlet useSetModal, useToastMessageDispatch, useEndpoint;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useSetModal(v) {\n    useSetModal = v;\n  },\n  useToastMessageDispatch(v) {\n    useToastMessageDispatch = v;\n  },\n  useEndpoint(v) {\n    useEndpoint = v;\n  }\n}, 2);\nlet moment;\nmodule.link(\"moment\", {\n  default(v) {\n    moment = v;\n  }\n}, 3);\nlet React, useCallback, useMemo, useState;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n  useCallback(v) {\n    useCallback = v;\n  },\n  useMemo(v) {\n    useMemo = v;\n  },\n  useState(v) {\n    useState = v;\n  }\n}, 4);\nlet useForm, FormProvider;\nmodule.link(\"react-hook-form\", {\n  useForm(v) {\n    useForm = v;\n  },\n  FormProvider(v) {\n    FormProvider = v;\n  }\n}, 5);\nlet useTranslation;\nmodule.link(\"react-i18next\", {\n  useTranslation(v) {\n    useTranslation = v;\n  }\n}, 6);\nlet GenericModal;\nmodule.link(\"../../../../components/GenericModal\", {\n  default(v) {\n    GenericModal = v;\n  }\n}, 7);\nlet useRoom;\nmodule.link(\"../../contexts/RoomContext\", {\n  useRoom(v) {\n    useRoom = v;\n  }\n}, 8);\nlet useRoomToolbox;\nmodule.link(\"../../contexts/RoomToolboxContext\", {\n  useRoomToolbox(v) {\n    useRoomToolbox = v;\n  }\n}, 9);\nlet PruneMessages;\nmodule.link(\"./PruneMessages\", {\n  default(v) {\n    PruneMessages = v;\n  }\n}, 10);\nconst getTimeZoneOffset = () => {\n  const offset = new Date().getTimezoneOffset();\n  const absOffset = Math.abs(offset);\n  return \"\".concat(offset < 0 ? '+' : '-').concat(\"00\".concat(Math.floor(absOffset / 60)).slice(-2), \":\").concat(\"00\".concat(absOffset % 60).slice(-2));\n};\nconst initialValues = {\n  newer: {\n    date: '',\n    time: ''\n  },\n  older: {\n    date: '',\n    time: ''\n  },\n  users: [],\n  inclusive: false,\n  pinned: false,\n  discussion: false,\n  threads: false,\n  attached: false\n};\nconst DEFAULT_PRUNE_LIMIT = 2000;\nconst PruneMessagesWithData = () => {\n  const {\n    t\n  } = useTranslation();\n  const room = useRoom();\n  const setModal = useSetModal();\n  const {\n    closeTab: close\n  } = useRoomToolbox();\n  const closeModal = useCallback(() => setModal(null), [setModal]);\n  const dispatchToastMessage = useToastMessageDispatch();\n  const pruneMessagesAction = useEndpoint('POST', '/v1/rooms.cleanHistory');\n  const [counter, setCounter] = useState(0);\n  const methods = useForm({\n    defaultValues: initialValues\n  });\n  const {\n    newer: {\n      date: newerDate,\n      time: newerTime\n    },\n    older: {\n      date: olderDate,\n      time: olderTime\n    },\n    users,\n    inclusive,\n    pinned,\n    discussion,\n    threads,\n    attached\n  } = methods.watch();\n  const fromDate = useMemo(() => {\n    return new Date(\"\".concat(newerDate || '0001-01-01', \"T\").concat(newerTime || '00:00', \":00\").concat(getTimeZoneOffset()));\n  }, [newerDate, newerTime]);\n  const toDate = useMemo(() => {\n    return new Date(\"\".concat(olderDate || '9999-12-31', \"T\").concat(olderTime || '23:59', \":59\").concat(getTimeZoneOffset()));\n  }, [olderDate, olderTime]);\n  const handlePrune = useMutableCallback(() => {\n    const handlePruneAction = async () => {\n      const limit = DEFAULT_PRUNE_LIMIT;\n      try {\n        if (counter === limit) {\n          return;\n        }\n        const {\n          count\n        } = await pruneMessagesAction({\n          roomId: room._id,\n          latest: toDate.toISOString(),\n          oldest: fromDate.toISOString(),\n          inclusive,\n          limit,\n          excludePinned: pinned,\n          filesOnly: attached,\n          ignoreDiscussion: discussion,\n          ignoreThreads: threads,\n          users\n        });\n        setCounter(count);\n        if (count < 1) {\n          throw new Error(t('No_messages_found_to_prune'));\n        }\n        dispatchToastMessage({\n          type: 'success',\n          message: t('__count__message_pruned', {\n            count\n          })\n        });\n        methods.reset();\n      } catch (error) {\n        dispatchToastMessage({\n          type: 'error',\n          message: error\n        });\n      } finally {\n        closeModal();\n      }\n    };\n    return setModal( /*#__PURE__*/React.createElement(GenericModal, {\n      variant: \"danger\",\n      onClose: closeModal,\n      onCancel: closeModal,\n      onConfirm: handlePruneAction,\n      confirmText: t('Yes_prune_them')\n    }, t('Prune_Modal')));\n  });\n  const callOutText = useMemo(() => {\n    var _room$usernames;\n    const name = room && (isDirectMessageRoom(room) && ((_room$usernames = room.usernames) === null || _room$usernames === void 0 ? void 0 : _room$usernames.join(' x ')) || room.fname || room.name);\n    const exceptPinned = pinned ? \" \".concat(t('except_pinned')) : '';\n    const ifFrom = users.length ? \" \".concat(t('if_they_are_from', {\n      postProcess: 'sprintf',\n      sprintf: [users.map(element => element).join(', ')]\n    })) : '';\n    const filesOrMessages = attached ? t('files') : t('messages');\n    if (newerDate && olderDate) {\n      return t('Prune_Warning_between', {\n        postProcess: 'sprintf',\n        sprintf: [filesOrMessages, name, moment(fromDate).format('L LT'), moment(toDate).format('L LT')]\n      }) + exceptPinned + ifFrom;\n    }\n    if (newerDate) {\n      return t('Prune_Warning_after', {\n        postProcess: 'sprintf',\n        sprintf: [filesOrMessages, name, moment(fromDate).format('L LT')]\n      }) + exceptPinned + ifFrom;\n    }\n    if (olderDate) {\n      return t('Prune_Warning_before', {\n        postProcess: 'sprintf',\n        sprintf: [filesOrMessages, name, moment(toDate).format('L LT')]\n      }) + exceptPinned + ifFrom;\n    }\n    return t('Prune_Warning_all', {\n      postProcess: 'sprintf',\n      sprintf: [filesOrMessages, name]\n    }) + exceptPinned + ifFrom;\n  }, [attached, fromDate, newerDate, olderDate, pinned, room, t, toDate, users]);\n  const validateText = useMemo(() => {\n    if (fromDate > toDate) {\n      return t('Newer_than_may_not_exceed_Older_than');\n    }\n    if (isNaN(fromDate.getTime()) || isNaN(toDate.getTime())) {\n      return t('error-invalid-date');\n    }\n    return undefined;\n  }, [fromDate, t, toDate]);\n  return /*#__PURE__*/React.createElement(FormProvider, methods, /*#__PURE__*/React.createElement(PruneMessages, {\n    callOutText: callOutText,\n    validateText: validateText,\n    users: users,\n    onClickClose: close,\n    onClickPrune: handlePrune\n  }));\n};\nmodule.exportDefault(PruneMessagesWithData);","map":{"version":3,"names":["module","export","initialValues","isDirectMessageRoom","link","v","useMutableCallback","useSetModal","useToastMessageDispatch","useEndpoint","moment","default","React","useCallback","useMemo","useState","useForm","FormProvider","useTranslation","GenericModal","useRoom","useRoomToolbox","PruneMessages","getTimeZoneOffset","offset","Date","getTimezoneOffset","absOffset","Math","abs","concat","floor","slice","newer","date","time","older","users","inclusive","pinned","discussion","threads","attached","DEFAULT_PRUNE_LIMIT","PruneMessagesWithData","t","room","setModal","closeTab","close","closeModal","dispatchToastMessage","pruneMessagesAction","counter","setCounter","methods","defaultValues","newerDate","newerTime","olderDate","olderTime","watch","fromDate","toDate","handlePrune","handlePruneAction","limit","count","roomId","_id","latest","toISOString","oldest","excludePinned","filesOnly","ignoreDiscussion","ignoreThreads","Error","type","message","reset","error","createElement","variant","onClose","onCancel","onConfirm","confirmText","callOutText","_room$usernames","name","usernames","join","fname","exceptPinned","ifFrom","length","postProcess","sprintf","map","element","filesOrMessages","format","validateText","isNaN","getTime","undefined","onClickClose","onClickPrune","exportDefault"],"sources":["client/views/room/contextualBar/PruneMessages/PruneMessagesWithData.tsx"],"sourcesContent":["import { isDirectMessageRoom } from '@rocket.chat/core-typings';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useToastMessageDispatch, useEndpoint } from '@rocket.chat/ui-contexts';\nimport moment from 'moment';\nimport type { ReactElement } from 'react';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { useForm, FormProvider } from 'react-hook-form';\nimport { useTranslation } from 'react-i18next';\n\nimport GenericModal from '../../../../components/GenericModal';\nimport { useRoom } from '../../contexts/RoomContext';\nimport { useRoomToolbox } from '../../contexts/RoomToolboxContext';\nimport PruneMessages from './PruneMessages';\n\nconst getTimeZoneOffset = (): string => {\n\tconst offset = new Date().getTimezoneOffset();\n\tconst absOffset = Math.abs(offset);\n\treturn `${offset < 0 ? '+' : '-'}${`00${Math.floor(absOffset / 60)}`.slice(-2)}:${`00${absOffset % 60}`.slice(-2)}`;\n};\n\nexport const initialValues = {\n\tnewer: {\n\t\tdate: '',\n\t\ttime: '',\n\t},\n\tolder: {\n\t\tdate: '',\n\t\ttime: '',\n\t},\n\tusers: [],\n\tinclusive: false,\n\tpinned: false,\n\tdiscussion: false,\n\tthreads: false,\n\tattached: false,\n};\n\nconst DEFAULT_PRUNE_LIMIT = 2000;\n\nconst PruneMessagesWithData = (): ReactElement => {\n\tconst { t } = useTranslation();\n\tconst room = useRoom();\n\tconst setModal = useSetModal();\n\tconst { closeTab: close } = useRoomToolbox();\n\tconst closeModal = useCallback(() => setModal(null), [setModal]);\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst pruneMessagesAction = useEndpoint('POST', '/v1/rooms.cleanHistory');\n\n\tconst [counter, setCounter] = useState(0);\n\n\tconst methods = useForm({ defaultValues: initialValues });\n\n\tconst {\n\t\tnewer: { date: newerDate, time: newerTime },\n\t\tolder: { date: olderDate, time: olderTime },\n\t\tusers,\n\t\tinclusive,\n\t\tpinned,\n\t\tdiscussion,\n\t\tthreads,\n\t\tattached,\n\t} = methods.watch();\n\n\tconst fromDate = useMemo(() => {\n\t\treturn new Date(`${newerDate || '0001-01-01'}T${newerTime || '00:00'}:00${getTimeZoneOffset()}`);\n\t}, [newerDate, newerTime]);\n\n\tconst toDate = useMemo(() => {\n\t\treturn new Date(`${olderDate || '9999-12-31'}T${olderTime || '23:59'}:59${getTimeZoneOffset()}`);\n\t}, [olderDate, olderTime]);\n\n\tconst handlePrune = useMutableCallback((): void => {\n\t\tconst handlePruneAction = async () => {\n\t\t\tconst limit = DEFAULT_PRUNE_LIMIT;\n\n\t\t\ttry {\n\t\t\t\tif (counter === limit) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst { count } = await pruneMessagesAction({\n\t\t\t\t\troomId: room._id,\n\t\t\t\t\tlatest: toDate.toISOString(),\n\t\t\t\t\toldest: fromDate.toISOString(),\n\t\t\t\t\tinclusive,\n\t\t\t\t\tlimit,\n\t\t\t\t\texcludePinned: pinned,\n\t\t\t\t\tfilesOnly: attached,\n\t\t\t\t\tignoreDiscussion: discussion,\n\t\t\t\t\tignoreThreads: threads,\n\t\t\t\t\tusers,\n\t\t\t\t});\n\n\t\t\t\tsetCounter(count);\n\n\t\t\t\tif (count < 1) {\n\t\t\t\t\tthrow new Error(t('No_messages_found_to_prune'));\n\t\t\t\t}\n\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('__count__message_pruned', { count }) });\n\t\t\t\tmethods.reset();\n\t\t\t} catch (error: unknown) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tcloseModal();\n\t\t\t}\n\t\t};\n\n\t\treturn setModal(\n\t\t\t<GenericModal\n\t\t\t\tvariant='danger'\n\t\t\t\tonClose={closeModal}\n\t\t\t\tonCancel={closeModal}\n\t\t\t\tonConfirm={handlePruneAction}\n\t\t\t\tconfirmText={t('Yes_prune_them')}\n\t\t\t>\n\t\t\t\t{t('Prune_Modal')}\n\t\t\t</GenericModal>,\n\t\t);\n\t});\n\n\tconst callOutText = useMemo(() => {\n\t\tconst name = room && ((isDirectMessageRoom(room) && room.usernames?.join(' x ')) || room.fname || room.name);\n\t\tconst exceptPinned = pinned ? ` ${t('except_pinned')}` : '';\n\t\tconst ifFrom = users.length\n\t\t\t? ` ${t('if_they_are_from', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [users.map((element) => element).join(', ')],\n\t\t\t  })}`\n\t\t\t: '';\n\t\tconst filesOrMessages = attached ? t('files') : t('messages');\n\n\t\tif (newerDate && olderDate) {\n\t\t\treturn (\n\t\t\t\tt('Prune_Warning_between', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [filesOrMessages, name, moment(fromDate).format('L LT'), moment(toDate).format('L LT')],\n\t\t\t\t}) +\n\t\t\t\texceptPinned +\n\t\t\t\tifFrom\n\t\t\t);\n\t\t}\n\n\t\tif (newerDate) {\n\t\t\treturn (\n\t\t\t\tt('Prune_Warning_after', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [filesOrMessages, name, moment(fromDate).format('L LT')],\n\t\t\t\t}) +\n\t\t\t\texceptPinned +\n\t\t\t\tifFrom\n\t\t\t);\n\t\t}\n\n\t\tif (olderDate) {\n\t\t\treturn (\n\t\t\t\tt('Prune_Warning_before', {\n\t\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\t\tsprintf: [filesOrMessages, name, moment(toDate).format('L LT')],\n\t\t\t\t}) +\n\t\t\t\texceptPinned +\n\t\t\t\tifFrom\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\tt('Prune_Warning_all', {\n\t\t\t\tpostProcess: 'sprintf',\n\t\t\t\tsprintf: [filesOrMessages, name],\n\t\t\t}) +\n\t\t\texceptPinned +\n\t\t\tifFrom\n\t\t);\n\t}, [attached, fromDate, newerDate, olderDate, pinned, room, t, toDate, users]);\n\n\tconst validateText = useMemo(() => {\n\t\tif (fromDate > toDate) {\n\t\t\treturn t('Newer_than_may_not_exceed_Older_than');\n\t\t}\n\n\t\tif (isNaN(fromDate.getTime()) || isNaN(toDate.getTime())) {\n\t\t\treturn t('error-invalid-date');\n\t\t}\n\n\t\treturn undefined;\n\t}, [fromDate, t, toDate]);\n\n\treturn (\n\t\t<FormProvider {...methods}>\n\t\t\t<PruneMessages callOutText={callOutText} validateText={validateText} users={users} onClickClose={close} onClickPrune={handlePrune} />\n\t\t</FormProvider>\n\t);\n};\n\nexport default PruneMessagesWithData;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"d70bcbb99e13a365e69eae0d9b164b50280e66fb"}
