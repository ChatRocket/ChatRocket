{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/import/PrepareImportPage.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/admin/import/PrepareImportPage.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/import/PrepareImportPage.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/import/PrepareImportPage.tsx","sourceRoot":"","sources":["client/views/admin/import/PrepareImportPage.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IImport, IImporterSelection, Serialized } from '@rocket.chat/core-typings';\nimport { Badge, Box, Button, ButtonGroup, Margins, ProgressBar, Throbber, Tabs } from '@rocket.chat/fuselage';\nimport { useDebouncedValue, useSafely } from '@rocket.chat/fuselage-hooks';\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\nimport { useEndpoint, useTranslation, useStream, useRouter } from '@rocket.chat/ui-contexts';\nimport React, { useEffect, useState, useMemo } from 'react';\n\nimport {\n\tProgressStep,\n\tImportWaitingStates,\n\tImportFileReadyStates,\n\tImportPreparingStartedStates,\n\tImportingStartedStates,\n\tImportingErrorStates,\n} from '../../../../app/importer/lib/ImporterProgressStep';\nimport { numberFormat } from '../../../../lib/utils/stringUtils';\nimport { Page, PageHeader, PageScrollableContentWithShadow } from '../../../components/Page';\nimport type { ChannelDescriptor } from './ChannelDescriptor';\nimport PrepareChannels from './PrepareChannels';\nimport PrepareUsers from './PrepareUsers';\nimport type { UserDescriptor } from './UserDescriptor';\nimport { useErrorHandler } from './useErrorHandler';\n\nconst waitFor = <T, U extends T>(fn: () => Promise<T>, predicate: (arg: T) => arg is U) =>\n\tnew Promise<U>((resolve, reject) => {\n\t\tconst callPromise = () => {\n\t\t\tfn().then((result) => {\n\t\t\t\tif (predicate(result)) {\n\t\t\t\t\tresolve(result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(callPromise, 1000);\n\t\t\t}, reject);\n\t\t};\n\n\t\tcallPromise();\n\t});\n\n// TODO: review inner logic\nfunction PrepareImportPage() {\n\tconst t = useTranslation();\n\tconst handleError = useErrorHandler();\n\n\tconst [isPreparing, setPreparing] = useSafely(useState(true));\n\tconst [progressRate, setProgressRate] = useSafely(useState<number | null>(null));\n\tconst [status, setStatus] = useSafely(useState<string | null>(null));\n\tconst [messageCount, setMessageCount] = useSafely(useState(0));\n\tconst [users, setUsers] = useState<UserDescriptor[]>([]);\n\tconst [channels, setChannels] = useState<ChannelDescriptor[]>([]);\n\tconst [isImporting, setImporting] = useSafely(useState(false));\n\n\tconst usersCount = useMemo(() => users.filter(({ do_import }) => do_import).length, [users]);\n\tconst channelsCount = useMemo(() => channels.filter(({ do_import }) => do_import).length, [channels]);\n\n\tconst router = useRouter();\n\n\tconst getImportFileData = useEndpoint('GET', '/v1/getImportFileData');\n\tconst getCurrentImportOperation = useEndpoint('GET', '/v1/getCurrentImportOperation');\n\tconst startImport = useEndpoint('POST', '/v1/startImport');\n\n\tconst streamer = useStream('importers');\n\n\tuseEffect(\n\t\t() =>\n\t\t\tstreamer('progress', (progress) => {\n\t\t\t\t// Ignore any update without the rate since we're not showing any other info anyway\n\t\t\t\tif ('rate' in progress) {\n\t\t\t\t\tsetProgressRate(progress.rate);\n\t\t\t\t}\n\t\t\t}),\n\t\t[streamer, setProgressRate],\n\t);\n\n\tuseEffect(() => {\n\t\tconst loadImportFileData = async () => {\n\t\t\ttry {\n\t\t\t\tconst data = await waitFor(\n\t\t\t\t\tgetImportFileData,\n\t\t\t\t\t(data): data is IImporterSelection => data && (!('waiting' in data) || !data.waiting),\n\t\t\t\t);\n\n\t\t\t\tif (!data) {\n\t\t\t\t\thandleError(t('Importer_not_setup'));\n\t\t\t\t\trouter.navigate('/admin/import');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tsetMessageCount(data.message_count);\n\t\t\t\tsetUsers(data.users.map((user) => ({ ...user, username: user.username ?? '', do_import: true })));\n\t\t\t\tsetChannels(data.channels.map((channel) => ({ ...channel, name: channel.name ?? '', do_import: true })));\n\t\t\t\tsetPreparing(false);\n\t\t\t\tsetProgressRate(null);\n\t\t\t} catch (error) {\n\t\t\t\thandleError(error, t('Failed_To_Load_Import_Data'));\n\t\t\t\trouter.navigate('/admin/import');\n\t\t\t}\n\t\t};\n\n\t\tconst loadCurrentOperation = async () => {\n\t\t\ttry {\n\t\t\t\tconst { operation } = await waitFor(\n\t\t\t\t\tgetCurrentImportOperation,\n\t\t\t\t\t(data): data is Serialized<{ operation: IImport }> =>\n\t\t\t\t\t\tdata.operation.valid && !ImportWaitingStates.includes(data.operation.status),\n\t\t\t\t);\n\n\t\t\t\tif (!operation.valid) {\n\t\t\t\t\trouter.navigate('/admin/import/new');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (ImportingStartedStates.includes(operation.status)) {\n\t\t\t\t\trouter.navigate('/admin/import/progress');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\toperation.status === ProgressStep.USER_SELECTION ||\n\t\t\t\t\tImportPreparingStartedStates.includes(operation.status) ||\n\t\t\t\t\tImportFileReadyStates.includes(operation.status)\n\t\t\t\t) {\n\t\t\t\t\tsetStatus(operation.status);\n\t\t\t\t\tloadImportFileData();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (ImportingErrorStates.includes(operation.status)) {\n\t\t\t\t\thandleError(t('Import_Operation_Failed'));\n\t\t\t\t\trouter.navigate('/admin/import');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (operation.status === ProgressStep.DONE) {\n\t\t\t\t\trouter.navigate('/admin/import');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\thandleError(t('Unknown_Import_State'));\n\t\t\t\trouter.navigate('/admin/import');\n\t\t\t} catch (error) {\n\t\t\t\thandleError(t('Failed_To_Load_Import_Data'));\n\t\t\t\trouter.navigate('/admin/import');\n\t\t\t}\n\t\t};\n\n\t\tloadCurrentOperation();\n\t}, [getCurrentImportOperation, getImportFileData, handleError, router, setMessageCount, setPreparing, setProgressRate, setStatus, t]);\n\n\tconst handleStartButtonClick = async () => {\n\t\tsetImporting(true);\n\n\t\ttry {\n\t\t\tawait startImport({\n\t\t\t\tinput: {\n\t\t\t\t\tusers: users.map((user) => ({ is_bot: false, is_email_taken: false, ...user })),\n\t\t\t\t\tchannels: channels.map((channel) => ({ is_private: false, is_direct: false, ...channel })),\n\t\t\t\t},\n\t\t\t});\n\t\t\trouter.navigate('/admin/import/progress');\n\t\t} catch (error) {\n\t\t\thandleError(error, t('Failed_To_Start_Import'));\n\t\t\trouter.navigate('/admin/import');\n\t\t}\n\t};\n\n\tconst [tab, setTab] = useState('users');\n\tconst handleTabClick = useMemo(() => (tab: string) => () => setTab(tab), []);\n\n\tconst statusDebounced = useDebouncedValue(status, 100);\n\n\tconst handleMinimumImportData = !!(\n\t\t(!usersCount && !channelsCount && !messageCount) ||\n\t\t(!usersCount && !channelsCount && messageCount !== 0)\n\t);\n\n\treturn (\n\t\t<Page>\n\t\t\t<PageHeader title={t('Importing_Data')} onClickBack={() => router.navigate('/admin/import')}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button primary disabled={isImporting || handleMinimumImportData} onClick={handleStartButtonClick}>\n\t\t\t\t\t\t{t('Importer_Prepare_Start_Import')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</PageHeader>\n\t\t\t<PageScrollableContentWithShadow>\n\t\t\t\t<Box marginInline='auto' marginBlock='x24' width='full' maxWidth='590px'>\n\t\t\t\t\t<Box is='h2' fontScale='p2m'>\n\t\t\t\t\t\t{statusDebounced && t(statusDebounced.replace('importer_', 'importer_status_') as TranslationKey)}\n\t\t\t\t\t</Box>\n\t\t\t\t\t{!isPreparing && (\n\t\t\t\t\t\t<Tabs flexShrink={0}>\n\t\t\t\t\t\t\t<Tabs.Item selected={tab === 'users'} onClick={handleTabClick('users')}>\n\t\t\t\t\t\t\t\t{t('Users')} <Badge>{usersCount}</Badge>\n\t\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t\t<Tabs.Item selected={tab === 'channels'} onClick={handleTabClick('channels')}>\n\t\t\t\t\t\t\t\t{t('Channels')} <Badge>{channelsCount}</Badge>\n\t\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t\t<Tabs.Item disabled>\n\t\t\t\t\t\t\t\t{t('Messages')}\n\t\t\t\t\t\t\t\t<Badge>{messageCount}</Badge>\n\t\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t</Tabs>\n\t\t\t\t\t)}\n\t\t\t\t\t<Margins block='x24'>\n\t\t\t\t\t\t{isPreparing && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{progressRate ? (\n\t\t\t\t\t\t\t\t\t<Box display='flex' justifyContent='center' fontScale='p2'>\n\t\t\t\t\t\t\t\t\t\t<ProgressBar percentage={Math.floor(progressRate)} />\n\t\t\t\t\t\t\t\t\t\t<Box is='span' mis='x24'>\n\t\t\t\t\t\t\t\t\t\t\t{numberFormat(progressRate, 0)}%\n\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<Throbber justifyContent='center' />\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{!isPreparing && tab === 'users' && <PrepareUsers usersCount={usersCount} users={users} setUsers={setUsers} />}\n\t\t\t\t\t\t{!isPreparing && tab === 'channels' && (\n\t\t\t\t\t\t\t<PrepareChannels channels={channels} channelsCount={channelsCount} setChannels={setChannels} />\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Margins>\n\t\t\t\t</Box>\n\t\t\t</PageScrollableContentWithShadow>\n\t\t</Page>\n\t);\n}\n\nexport default PrepareImportPage;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/import/PrepareImportPage.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/admin/import/PrepareImportPage.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/import/PrepareImportPage.tsx","sourceRoot":"","sources":["client/views/admin/import/PrepareImportPage.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IImport, IImporterSelection, Serialized } from '@rocket.chat/core-typings';\nimport { Badge, Box, Button, ButtonGroup, Margins, ProgressBar, Throbber, Tabs } from '@rocket.chat/fuselage';\nimport { useDebouncedValue, useSafely } from '@rocket.chat/fuselage-hooks';\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\nimport { useEndpoint, useTranslation, useStream, useRouter } from '@rocket.chat/ui-contexts';\nimport React, { useEffect, useState, useMemo } from 'react';\n\nimport {\n\tProgressStep,\n\tImportWaitingStates,\n\tImportFileReadyStates,\n\tImportPreparingStartedStates,\n\tImportingStartedStates,\n\tImportingErrorStates,\n} from '../../../../app/importer/lib/ImporterProgressStep';\nimport { numberFormat } from '../../../../lib/utils/stringUtils';\nimport { Page, PageHeader, PageScrollableContentWithShadow } from '../../../components/Page';\nimport type { ChannelDescriptor } from './ChannelDescriptor';\nimport PrepareChannels from './PrepareChannels';\nimport PrepareUsers from './PrepareUsers';\nimport type { UserDescriptor } from './UserDescriptor';\nimport { useErrorHandler } from './useErrorHandler';\n\nconst waitFor = <T, U extends T>(fn: () => Promise<T>, predicate: (arg: T) => arg is U) =>\n\tnew Promise<U>((resolve, reject) => {\n\t\tconst callPromise = () => {\n\t\t\tfn().then((result) => {\n\t\t\t\tif (predicate(result)) {\n\t\t\t\t\tresolve(result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(callPromise, 1000);\n\t\t\t}, reject);\n\t\t};\n\n\t\tcallPromise();\n\t});\n\n// TODO: review inner logic\nfunction PrepareImportPage() {\n\tconst t = useTranslation();\n\tconst handleError = useErrorHandler();\n\n\tconst [isPreparing, setPreparing] = useSafely(useState(true));\n\tconst [progressRate, setProgressRate] = useSafely(useState<number | null>(null));\n\tconst [status, setStatus] = useSafely(useState<string | null>(null));\n\tconst [messageCount, setMessageCount] = useSafely(useState(0));\n\tconst [users, setUsers] = useState<UserDescriptor[]>([]);\n\tconst [channels, setChannels] = useState<ChannelDescriptor[]>([]);\n\tconst [isImporting, setImporting] = useSafely(useState(false));\n\n\tconst usersCount = useMemo(() => users.filter(({ do_import }) => do_import).length, [users]);\n\tconst channelsCount = useMemo(() => channels.filter(({ do_import }) => do_import).length, [channels]);\n\n\tconst router = useRouter();\n\n\tconst getImportFileData = useEndpoint('GET', '/v1/getImportFileData');\n\tconst getCurrentImportOperation = useEndpoint('GET', '/v1/getCurrentImportOperation');\n\tconst startImport = useEndpoint('POST', '/v1/startImport');\n\n\tconst streamer = useStream('importers');\n\n\tuseEffect(\n\t\t() =>\n\t\t\tstreamer('progress', (progress) => {\n\t\t\t\t// Ignore any update without the rate since we're not showing any other info anyway\n\t\t\t\tif ('rate' in progress) {\n\t\t\t\t\tsetProgressRate(progress.rate);\n\t\t\t\t}\n\t\t\t}),\n\t\t[streamer, setProgressRate],\n\t);\n\n\tuseEffect(() => {\n\t\tconst loadImportFileData = async () => {\n\t\t\ttry {\n\t\t\t\tconst data = await waitFor(\n\t\t\t\t\tgetImportFileData,\n\t\t\t\t\t(data): data is IImporterSelection => data && (!('waiting' in data) || !data.waiting),\n\t\t\t\t);\n\n\t\t\t\tif (!data) {\n\t\t\t\t\thandleError(t('Importer_not_setup'));\n\t\t\t\t\trouter.navigate('/admin/import');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tsetMessageCount(data.message_count);\n\t\t\t\tsetUsers(data.users.map((user) => ({ ...user, username: user.username ?? '', do_import: true })));\n\t\t\t\tsetChannels(data.channels.map((channel) => ({ ...channel, name: channel.name ?? '', do_import: true })));\n\t\t\t\tsetPreparing(false);\n\t\t\t\tsetProgressRate(null);\n\t\t\t} catch (error) {\n\t\t\t\thandleError(error, t('Failed_To_Load_Import_Data'));\n\t\t\t\trouter.navigate('/admin/import');\n\t\t\t}\n\t\t};\n\n\t\tconst loadCurrentOperation = async () => {\n\t\t\ttry {\n\t\t\t\tconst { operation } = await waitFor(\n\t\t\t\t\tgetCurrentImportOperation,\n\t\t\t\t\t(data): data is Serialized<{ operation: IImport }> =>\n\t\t\t\t\t\tdata.operation.valid && !ImportWaitingStates.includes(data.operation.status),\n\t\t\t\t);\n\n\t\t\t\tif (!operation.valid) {\n\t\t\t\t\trouter.navigate('/admin/import/new');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (ImportingStartedStates.includes(operation.status)) {\n\t\t\t\t\trouter.navigate('/admin/import/progress');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\toperation.status === ProgressStep.USER_SELECTION ||\n\t\t\t\t\tImportPreparingStartedStates.includes(operation.status) ||\n\t\t\t\t\tImportFileReadyStates.includes(operation.status)\n\t\t\t\t) {\n\t\t\t\t\tsetStatus(operation.status);\n\t\t\t\t\tloadImportFileData();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (ImportingErrorStates.includes(operation.status)) {\n\t\t\t\t\thandleError(t('Import_Operation_Failed'));\n\t\t\t\t\trouter.navigate('/admin/import');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (operation.status === ProgressStep.DONE) {\n\t\t\t\t\trouter.navigate('/admin/import');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\thandleError(t('Unknown_Import_State'));\n\t\t\t\trouter.navigate('/admin/import');\n\t\t\t} catch (error) {\n\t\t\t\thandleError(t('Failed_To_Load_Import_Data'));\n\t\t\t\trouter.navigate('/admin/import');\n\t\t\t}\n\t\t};\n\n\t\tloadCurrentOperation();\n\t}, [getCurrentImportOperation, getImportFileData, handleError, router, setMessageCount, setPreparing, setProgressRate, setStatus, t]);\n\n\tconst handleStartButtonClick = async () => {\n\t\tsetImporting(true);\n\n\t\ttry {\n\t\t\tawait startImport({\n\t\t\t\tinput: {\n\t\t\t\t\tusers: users.map((user) => ({ is_bot: false, is_email_taken: false, ...user })),\n\t\t\t\t\tchannels: channels.map((channel) => ({ is_private: false, is_direct: false, ...channel })),\n\t\t\t\t},\n\t\t\t});\n\t\t\trouter.navigate('/admin/import/progress');\n\t\t} catch (error) {\n\t\t\thandleError(error, t('Failed_To_Start_Import'));\n\t\t\trouter.navigate('/admin/import');\n\t\t}\n\t};\n\n\tconst [tab, setTab] = useState('users');\n\tconst handleTabClick = useMemo(() => (tab: string) => () => setTab(tab), []);\n\n\tconst statusDebounced = useDebouncedValue(status, 100);\n\n\tconst handleMinimumImportData = !!(\n\t\t(!usersCount && !channelsCount && !messageCount) ||\n\t\t(!usersCount && !channelsCount && messageCount !== 0)\n\t);\n\n\treturn (\n\t\t<Page>\n\t\t\t<PageHeader title={t('Importing_Data')} onClickBack={() => router.navigate('/admin/import')}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button primary disabled={isImporting || handleMinimumImportData} onClick={handleStartButtonClick}>\n\t\t\t\t\t\t{t('Importer_Prepare_Start_Import')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</PageHeader>\n\t\t\t<PageScrollableContentWithShadow>\n\t\t\t\t<Box marginInline='auto' marginBlock='x24' width='full' maxWidth='590px'>\n\t\t\t\t\t<Box is='h2' fontScale='p2m'>\n\t\t\t\t\t\t{statusDebounced && t(statusDebounced.replace('importer_', 'importer_status_') as TranslationKey)}\n\t\t\t\t\t</Box>\n\t\t\t\t\t{!isPreparing && (\n\t\t\t\t\t\t<Tabs flexShrink={0}>\n\t\t\t\t\t\t\t<Tabs.Item selected={tab === 'users'} onClick={handleTabClick('users')}>\n\t\t\t\t\t\t\t\t{t('Users')} <Badge>{usersCount}</Badge>\n\t\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t\t<Tabs.Item selected={tab === 'channels'} onClick={handleTabClick('channels')}>\n\t\t\t\t\t\t\t\t{t('Channels')} <Badge>{channelsCount}</Badge>\n\t\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t\t<Tabs.Item disabled>\n\t\t\t\t\t\t\t\t{t('Messages')}\n\t\t\t\t\t\t\t\t<Badge>{messageCount}</Badge>\n\t\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t</Tabs>\n\t\t\t\t\t)}\n\t\t\t\t\t<Margins block='x24'>\n\t\t\t\t\t\t{isPreparing && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{progressRate ? (\n\t\t\t\t\t\t\t\t\t<Box display='flex' justifyContent='center' fontScale='p2'>\n\t\t\t\t\t\t\t\t\t\t<ProgressBar percentage={Math.floor(progressRate)} />\n\t\t\t\t\t\t\t\t\t\t<Box is='span' mis='x24'>\n\t\t\t\t\t\t\t\t\t\t\t{numberFormat(progressRate, 0)}%\n\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<Throbber justifyContent='center' />\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{!isPreparing && tab === 'users' && <PrepareUsers usersCount={usersCount} users={users} setUsers={setUsers} />}\n\t\t\t\t\t\t{!isPreparing && tab === 'channels' && (\n\t\t\t\t\t\t\t<PrepareChannels channels={channels} channelsCount={channelsCount} setChannels={setChannels} />\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Margins>\n\t\t\t\t</Box>\n\t\t\t</PageScrollableContentWithShadow>\n\t\t</Page>\n\t);\n}\n\nexport default PrepareImportPage;\n"]}}},"code":"var _regeneratorRuntime;\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\nvar _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default: function (v) {\n    _objectSpread = v;\n  }\n}, 1);\nvar _slicedToArray;\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 2);\nvar Badge, Box, Button, ButtonGroup, Margins, ProgressBar, Throbber, Tabs;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Badge: function (v) {\n    Badge = v;\n  },\n  Box: function (v) {\n    Box = v;\n  },\n  Button: function (v) {\n    Button = v;\n  },\n  ButtonGroup: function (v) {\n    ButtonGroup = v;\n  },\n  Margins: function (v) {\n    Margins = v;\n  },\n  ProgressBar: function (v) {\n    ProgressBar = v;\n  },\n  Throbber: function (v) {\n    Throbber = v;\n  },\n  Tabs: function (v) {\n    Tabs = v;\n  }\n}, 0);\nvar useDebouncedValue, useSafely;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useDebouncedValue: function (v) {\n    useDebouncedValue = v;\n  },\n  useSafely: function (v) {\n    useSafely = v;\n  }\n}, 1);\nvar useEndpoint, useTranslation, useStream, useRouter;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useEndpoint: function (v) {\n    useEndpoint = v;\n  },\n  useTranslation: function (v) {\n    useTranslation = v;\n  },\n  useStream: function (v) {\n    useStream = v;\n  },\n  useRouter: function (v) {\n    useRouter = v;\n  }\n}, 2);\nvar React, useEffect, useState, useMemo;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useEffect: function (v) {\n    useEffect = v;\n  },\n  useState: function (v) {\n    useState = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  }\n}, 3);\nvar ProgressStep, ImportWaitingStates, ImportFileReadyStates, ImportPreparingStartedStates, ImportingStartedStates, ImportingErrorStates;\nmodule.link(\"../../../../app/importer/lib/ImporterProgressStep\", {\n  ProgressStep: function (v) {\n    ProgressStep = v;\n  },\n  ImportWaitingStates: function (v) {\n    ImportWaitingStates = v;\n  },\n  ImportFileReadyStates: function (v) {\n    ImportFileReadyStates = v;\n  },\n  ImportPreparingStartedStates: function (v) {\n    ImportPreparingStartedStates = v;\n  },\n  ImportingStartedStates: function (v) {\n    ImportingStartedStates = v;\n  },\n  ImportingErrorStates: function (v) {\n    ImportingErrorStates = v;\n  }\n}, 4);\nvar numberFormat;\nmodule.link(\"../../../../lib/utils/stringUtils\", {\n  numberFormat: function (v) {\n    numberFormat = v;\n  }\n}, 5);\nvar Page, PageHeader, PageScrollableContentWithShadow;\nmodule.link(\"../../../components/Page\", {\n  Page: function (v) {\n    Page = v;\n  },\n  PageHeader: function (v) {\n    PageHeader = v;\n  },\n  PageScrollableContentWithShadow: function (v) {\n    PageScrollableContentWithShadow = v;\n  }\n}, 6);\nvar PrepareChannels;\nmodule.link(\"./PrepareChannels\", {\n  \"default\": function (v) {\n    PrepareChannels = v;\n  }\n}, 7);\nvar PrepareUsers;\nmodule.link(\"./PrepareUsers\", {\n  \"default\": function (v) {\n    PrepareUsers = v;\n  }\n}, 8);\nvar useErrorHandler;\nmodule.link(\"./useErrorHandler\", {\n  useErrorHandler: function (v) {\n    useErrorHandler = v;\n  }\n}, 9);\nvar waitFor = function (fn, predicate) {\n  return new Promise(function (resolve, reject) {\n    var callPromise = function () {\n      fn().then(function (result) {\n        if (predicate(result)) {\n          resolve(result);\n          return;\n        }\n        setTimeout(callPromise, 1000);\n      }, reject);\n    };\n    callPromise();\n  });\n};\n// TODO: review inner logic\nfunction PrepareImportPage() {\n  var t = useTranslation();\n  var handleError = useErrorHandler();\n  var _useSafely = useSafely(useState(true)),\n    _useSafely2 = _slicedToArray(_useSafely, 2),\n    isPreparing = _useSafely2[0],\n    setPreparing = _useSafely2[1];\n  var _useSafely3 = useSafely(useState(null)),\n    _useSafely4 = _slicedToArray(_useSafely3, 2),\n    progressRate = _useSafely4[0],\n    setProgressRate = _useSafely4[1];\n  var _useSafely5 = useSafely(useState(null)),\n    _useSafely6 = _slicedToArray(_useSafely5, 2),\n    status = _useSafely6[0],\n    setStatus = _useSafely6[1];\n  var _useSafely7 = useSafely(useState(0)),\n    _useSafely8 = _slicedToArray(_useSafely7, 2),\n    messageCount = _useSafely8[0],\n    setMessageCount = _useSafely8[1];\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    users = _useState2[0],\n    setUsers = _useState2[1];\n  var _useState3 = useState([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    channels = _useState4[0],\n    setChannels = _useState4[1];\n  var _useSafely9 = useSafely(useState(false)),\n    _useSafely10 = _slicedToArray(_useSafely9, 2),\n    isImporting = _useSafely10[0],\n    setImporting = _useSafely10[1];\n  var usersCount = useMemo(function () {\n    return users.filter(function (_ref) {\n      var do_import = _ref.do_import;\n      return do_import;\n    }).length;\n  }, [users]);\n  var channelsCount = useMemo(function () {\n    return channels.filter(function (_ref2) {\n      var do_import = _ref2.do_import;\n      return do_import;\n    }).length;\n  }, [channels]);\n  var router = useRouter();\n  var getImportFileData = useEndpoint('GET', '/v1/getImportFileData');\n  var getCurrentImportOperation = useEndpoint('GET', '/v1/getCurrentImportOperation');\n  var startImport = useEndpoint('POST', '/v1/startImport');\n  var streamer = useStream('importers');\n  useEffect(function () {\n    return streamer('progress', function (progress) {\n      // Ignore any update without the rate since we're not showing any other info anyway\n      if ('rate' in progress) {\n        setProgressRate(progress.rate);\n      }\n    });\n  }, [streamer, setProgressRate]);\n  useEffect(function () {\n    var loadImportFileData = function () {\n      function _callee() {\n        var data;\n        return _regeneratorRuntime.async(function () {\n          function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return _regeneratorRuntime.awrap(waitFor(getImportFileData, function (data) {\n                  return data && (!('waiting' in data) || !data.waiting);\n                }));\n              case 3:\n                data = _context.sent;\n                if (data) {\n                  _context.next = 8;\n                  break;\n                }\n                handleError(t('Importer_not_setup'));\n                router.navigate('/admin/import');\n                return _context.abrupt(\"return\");\n              case 8:\n                setMessageCount(data.message_count);\n                setUsers(data.users.map(function (user) {\n                  var _user$username;\n                  return _objectSpread(_objectSpread({}, user), {}, {\n                    username: (_user$username = user.username) !== null && _user$username !== void 0 ? _user$username : '',\n                    do_import: true\n                  });\n                }));\n                setChannels(data.channels.map(function (channel) {\n                  var _channel$name;\n                  return _objectSpread(_objectSpread({}, channel), {}, {\n                    name: (_channel$name = channel.name) !== null && _channel$name !== void 0 ? _channel$name : '',\n                    do_import: true\n                  });\n                }));\n                setPreparing(false);\n                setProgressRate(null);\n                _context.next = 19;\n                break;\n              case 15:\n                _context.prev = 15;\n                _context.t0 = _context[\"catch\"](0);\n                handleError(_context.t0, t('Failed_To_Load_Import_Data'));\n                router.navigate('/admin/import');\n              case 19:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n          return _callee$;\n        }(), null, null, [[0, 15]], Promise);\n      }\n      return _callee;\n    }();\n    var loadCurrentOperation = function () {\n      function _callee2() {\n        var _await$waitFor, operation;\n        return _regeneratorRuntime.async(function () {\n          function _callee2$(_context2) {\n            while (1) switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return _regeneratorRuntime.awrap(waitFor(getCurrentImportOperation, function (data) {\n                  return data.operation.valid && !ImportWaitingStates.includes(data.operation.status);\n                }));\n              case 3:\n                _await$waitFor = _context2.sent;\n                operation = _await$waitFor.operation;\n                if (operation.valid) {\n                  _context2.next = 8;\n                  break;\n                }\n                router.navigate('/admin/import/new');\n                return _context2.abrupt(\"return\");\n              case 8:\n                if (!ImportingStartedStates.includes(operation.status)) {\n                  _context2.next = 11;\n                  break;\n                }\n                router.navigate('/admin/import/progress');\n                return _context2.abrupt(\"return\");\n              case 11:\n                if (!(operation.status === ProgressStep.USER_SELECTION || ImportPreparingStartedStates.includes(operation.status) || ImportFileReadyStates.includes(operation.status))) {\n                  _context2.next = 15;\n                  break;\n                }\n                setStatus(operation.status);\n                loadImportFileData();\n                return _context2.abrupt(\"return\");\n              case 15:\n                if (!ImportingErrorStates.includes(operation.status)) {\n                  _context2.next = 19;\n                  break;\n                }\n                handleError(t('Import_Operation_Failed'));\n                router.navigate('/admin/import');\n                return _context2.abrupt(\"return\");\n              case 19:\n                if (!(operation.status === ProgressStep.DONE)) {\n                  _context2.next = 22;\n                  break;\n                }\n                router.navigate('/admin/import');\n                return _context2.abrupt(\"return\");\n              case 22:\n                handleError(t('Unknown_Import_State'));\n                router.navigate('/admin/import');\n                _context2.next = 30;\n                break;\n              case 26:\n                _context2.prev = 26;\n                _context2.t0 = _context2[\"catch\"](0);\n                handleError(t('Failed_To_Load_Import_Data'));\n                router.navigate('/admin/import');\n              case 30:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n          return _callee2$;\n        }(), null, null, [[0, 26]], Promise);\n      }\n      return _callee2;\n    }();\n    loadCurrentOperation();\n  }, [getCurrentImportOperation, getImportFileData, handleError, router, setMessageCount, setPreparing, setProgressRate, setStatus, t]);\n  var handleStartButtonClick = function () {\n    function _callee3() {\n      return _regeneratorRuntime.async(function () {\n        function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              setImporting(true);\n              _context3.prev = 1;\n              _context3.next = 4;\n              return _regeneratorRuntime.awrap(startImport({\n                input: {\n                  users: users.map(function (user) {\n                    return _objectSpread({\n                      is_bot: false,\n                      is_email_taken: false\n                    }, user);\n                  }),\n                  channels: channels.map(function (channel) {\n                    return _objectSpread({\n                      is_private: false,\n                      is_direct: false\n                    }, channel);\n                  })\n                }\n              }));\n            case 4:\n              router.navigate('/admin/import/progress');\n              _context3.next = 11;\n              break;\n            case 7:\n              _context3.prev = 7;\n              _context3.t0 = _context3[\"catch\"](1);\n              handleError(_context3.t0, t('Failed_To_Start_Import'));\n              router.navigate('/admin/import');\n            case 11:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n        return _callee3$;\n      }(), null, null, [[1, 7]], Promise);\n    }\n    return _callee3;\n  }();\n  var _useState5 = useState('users'),\n    _useState6 = _slicedToArray(_useState5, 2),\n    tab = _useState6[0],\n    setTab = _useState6[1];\n  var handleTabClick = useMemo(function () {\n    return function (tab) {\n      return function () {\n        return setTab(tab);\n      };\n    };\n  }, []);\n  var statusDebounced = useDebouncedValue(status, 100);\n  var handleMinimumImportData = !!(!usersCount && !channelsCount && !messageCount || !usersCount && !channelsCount && messageCount !== 0);\n  return /*#__PURE__*/React.createElement(Page, null, /*#__PURE__*/React.createElement(PageHeader, {\n    title: t('Importing_Data'),\n    onClickBack: function () {\n      return router.navigate('/admin/import');\n    }\n  }, /*#__PURE__*/React.createElement(ButtonGroup, null, /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    disabled: isImporting || handleMinimumImportData,\n    onClick: handleStartButtonClick\n  }, t('Importer_Prepare_Start_Import')))), /*#__PURE__*/React.createElement(PageScrollableContentWithShadow, null, /*#__PURE__*/React.createElement(Box, {\n    marginInline: \"auto\",\n    marginBlock: \"x24\",\n    width: \"full\",\n    maxWidth: \"590px\"\n  }, /*#__PURE__*/React.createElement(Box, {\n    is: \"h2\",\n    fontScale: \"p2m\"\n  }, statusDebounced && t(statusDebounced.replace('importer_', 'importer_status_'))), !isPreparing && /*#__PURE__*/React.createElement(Tabs, {\n    flexShrink: 0\n  }, /*#__PURE__*/React.createElement(Tabs.Item, {\n    selected: tab === 'users',\n    onClick: handleTabClick('users')\n  }, t('Users'), \" \", /*#__PURE__*/React.createElement(Badge, null, usersCount)), /*#__PURE__*/React.createElement(Tabs.Item, {\n    selected: tab === 'channels',\n    onClick: handleTabClick('channels')\n  }, t('Channels'), \" \", /*#__PURE__*/React.createElement(Badge, null, channelsCount)), /*#__PURE__*/React.createElement(Tabs.Item, {\n    disabled: true\n  }, t('Messages'), /*#__PURE__*/React.createElement(Badge, null, messageCount))), /*#__PURE__*/React.createElement(Margins, {\n    block: \"x24\"\n  }, isPreparing && /*#__PURE__*/React.createElement(React.Fragment, null, progressRate ? /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    justifyContent: \"center\",\n    fontScale: \"p2\"\n  }, /*#__PURE__*/React.createElement(ProgressBar, {\n    percentage: Math.floor(progressRate)\n  }), /*#__PURE__*/React.createElement(Box, {\n    is: \"span\",\n    mis: \"x24\"\n  }, numberFormat(progressRate, 0), \"%\")) : /*#__PURE__*/React.createElement(Throbber, {\n    justifyContent: \"center\"\n  })), !isPreparing && tab === 'users' && /*#__PURE__*/React.createElement(PrepareUsers, {\n    usersCount: usersCount,\n    users: users,\n    setUsers: setUsers\n  }), !isPreparing && tab === 'channels' && /*#__PURE__*/React.createElement(PrepareChannels, {\n    channels: channels,\n    channelsCount: channelsCount,\n    setChannels: setChannels\n  })))));\n}\nmodule.exportDefault(PrepareImportPage);","map":{"version":3,"names":["_regeneratorRuntime","module","link","default","v","_objectSpread","_slicedToArray","Badge","Box","Button","ButtonGroup","Margins","ProgressBar","Throbber","Tabs","useDebouncedValue","useSafely","useEndpoint","useTranslation","useStream","useRouter","React","useEffect","useState","useMemo","ProgressStep","ImportWaitingStates","ImportFileReadyStates","ImportPreparingStartedStates","ImportingStartedStates","ImportingErrorStates","numberFormat","Page","PageHeader","PageScrollableContentWithShadow","PrepareChannels","PrepareUsers","useErrorHandler","waitFor","fn","predicate","Promise","resolve","reject","callPromise","then","result","setTimeout","PrepareImportPage","t","handleError","_useSafely","_useSafely2","isPreparing","setPreparing","_useSafely3","_useSafely4","progressRate","setProgressRate","_useSafely5","_useSafely6","status","setStatus","_useSafely7","_useSafely8","messageCount","setMessageCount","_useState","_useState2","users","setUsers","_useState3","_useState4","channels","setChannels","_useSafely9","_useSafely10","isImporting","setImporting","usersCount","filter","_ref","do_import","length","channelsCount","_ref2","router","getImportFileData","getCurrentImportOperation","startImport","streamer","progress","rate","loadImportFileData","_callee","data","async","_callee$","_context","prev","next","awrap","waiting","sent","navigate","abrupt","message_count","map","user","_user$username","username","channel","_channel$name","name","t0","stop","loadCurrentOperation","_callee2","_await$waitFor","operation","_callee2$","_context2","valid","includes","USER_SELECTION","DONE","handleStartButtonClick","_callee3","_callee3$","_context3","input","is_bot","is_email_taken","is_private","is_direct","_useState5","_useState6","tab","setTab","handleTabClick","statusDebounced","handleMinimumImportData","createElement","title","onClickBack","primary","disabled","onClick","marginInline","marginBlock","width","maxWidth","is","fontScale","replace","flexShrink","Item","selected","block","Fragment","display","justifyContent","percentage","Math","floor","mis","exportDefault"],"sources":["client/views/admin/import/PrepareImportPage.tsx"],"sourcesContent":["import type { IImport, IImporterSelection, Serialized } from '@rocket.chat/core-typings';\nimport { Badge, Box, Button, ButtonGroup, Margins, ProgressBar, Throbber, Tabs } from '@rocket.chat/fuselage';\nimport { useDebouncedValue, useSafely } from '@rocket.chat/fuselage-hooks';\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\nimport { useEndpoint, useTranslation, useStream, useRouter } from '@rocket.chat/ui-contexts';\nimport React, { useEffect, useState, useMemo } from 'react';\n\nimport {\n\tProgressStep,\n\tImportWaitingStates,\n\tImportFileReadyStates,\n\tImportPreparingStartedStates,\n\tImportingStartedStates,\n\tImportingErrorStates,\n} from '../../../../app/importer/lib/ImporterProgressStep';\nimport { numberFormat } from '../../../../lib/utils/stringUtils';\nimport { Page, PageHeader, PageScrollableContentWithShadow } from '../../../components/Page';\nimport type { ChannelDescriptor } from './ChannelDescriptor';\nimport PrepareChannels from './PrepareChannels';\nimport PrepareUsers from './PrepareUsers';\nimport type { UserDescriptor } from './UserDescriptor';\nimport { useErrorHandler } from './useErrorHandler';\n\nconst waitFor = <T, U extends T>(fn: () => Promise<T>, predicate: (arg: T) => arg is U) =>\n\tnew Promise<U>((resolve, reject) => {\n\t\tconst callPromise = () => {\n\t\t\tfn().then((result) => {\n\t\t\t\tif (predicate(result)) {\n\t\t\t\t\tresolve(result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(callPromise, 1000);\n\t\t\t}, reject);\n\t\t};\n\n\t\tcallPromise();\n\t});\n\n// TODO: review inner logic\nfunction PrepareImportPage() {\n\tconst t = useTranslation();\n\tconst handleError = useErrorHandler();\n\n\tconst [isPreparing, setPreparing] = useSafely(useState(true));\n\tconst [progressRate, setProgressRate] = useSafely(useState<number | null>(null));\n\tconst [status, setStatus] = useSafely(useState<string | null>(null));\n\tconst [messageCount, setMessageCount] = useSafely(useState(0));\n\tconst [users, setUsers] = useState<UserDescriptor[]>([]);\n\tconst [channels, setChannels] = useState<ChannelDescriptor[]>([]);\n\tconst [isImporting, setImporting] = useSafely(useState(false));\n\n\tconst usersCount = useMemo(() => users.filter(({ do_import }) => do_import).length, [users]);\n\tconst channelsCount = useMemo(() => channels.filter(({ do_import }) => do_import).length, [channels]);\n\n\tconst router = useRouter();\n\n\tconst getImportFileData = useEndpoint('GET', '/v1/getImportFileData');\n\tconst getCurrentImportOperation = useEndpoint('GET', '/v1/getCurrentImportOperation');\n\tconst startImport = useEndpoint('POST', '/v1/startImport');\n\n\tconst streamer = useStream('importers');\n\n\tuseEffect(\n\t\t() =>\n\t\t\tstreamer('progress', (progress) => {\n\t\t\t\t// Ignore any update without the rate since we're not showing any other info anyway\n\t\t\t\tif ('rate' in progress) {\n\t\t\t\t\tsetProgressRate(progress.rate);\n\t\t\t\t}\n\t\t\t}),\n\t\t[streamer, setProgressRate],\n\t);\n\n\tuseEffect(() => {\n\t\tconst loadImportFileData = async () => {\n\t\t\ttry {\n\t\t\t\tconst data = await waitFor(\n\t\t\t\t\tgetImportFileData,\n\t\t\t\t\t(data): data is IImporterSelection => data && (!('waiting' in data) || !data.waiting),\n\t\t\t\t);\n\n\t\t\t\tif (!data) {\n\t\t\t\t\thandleError(t('Importer_not_setup'));\n\t\t\t\t\trouter.navigate('/admin/import');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tsetMessageCount(data.message_count);\n\t\t\t\tsetUsers(data.users.map((user) => ({ ...user, username: user.username ?? '', do_import: true })));\n\t\t\t\tsetChannels(data.channels.map((channel) => ({ ...channel, name: channel.name ?? '', do_import: true })));\n\t\t\t\tsetPreparing(false);\n\t\t\t\tsetProgressRate(null);\n\t\t\t} catch (error) {\n\t\t\t\thandleError(error, t('Failed_To_Load_Import_Data'));\n\t\t\t\trouter.navigate('/admin/import');\n\t\t\t}\n\t\t};\n\n\t\tconst loadCurrentOperation = async () => {\n\t\t\ttry {\n\t\t\t\tconst { operation } = await waitFor(\n\t\t\t\t\tgetCurrentImportOperation,\n\t\t\t\t\t(data): data is Serialized<{ operation: IImport }> =>\n\t\t\t\t\t\tdata.operation.valid && !ImportWaitingStates.includes(data.operation.status),\n\t\t\t\t);\n\n\t\t\t\tif (!operation.valid) {\n\t\t\t\t\trouter.navigate('/admin/import/new');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (ImportingStartedStates.includes(operation.status)) {\n\t\t\t\t\trouter.navigate('/admin/import/progress');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\toperation.status === ProgressStep.USER_SELECTION ||\n\t\t\t\t\tImportPreparingStartedStates.includes(operation.status) ||\n\t\t\t\t\tImportFileReadyStates.includes(operation.status)\n\t\t\t\t) {\n\t\t\t\t\tsetStatus(operation.status);\n\t\t\t\t\tloadImportFileData();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (ImportingErrorStates.includes(operation.status)) {\n\t\t\t\t\thandleError(t('Import_Operation_Failed'));\n\t\t\t\t\trouter.navigate('/admin/import');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (operation.status === ProgressStep.DONE) {\n\t\t\t\t\trouter.navigate('/admin/import');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\thandleError(t('Unknown_Import_State'));\n\t\t\t\trouter.navigate('/admin/import');\n\t\t\t} catch (error) {\n\t\t\t\thandleError(t('Failed_To_Load_Import_Data'));\n\t\t\t\trouter.navigate('/admin/import');\n\t\t\t}\n\t\t};\n\n\t\tloadCurrentOperation();\n\t}, [getCurrentImportOperation, getImportFileData, handleError, router, setMessageCount, setPreparing, setProgressRate, setStatus, t]);\n\n\tconst handleStartButtonClick = async () => {\n\t\tsetImporting(true);\n\n\t\ttry {\n\t\t\tawait startImport({\n\t\t\t\tinput: {\n\t\t\t\t\tusers: users.map((user) => ({ is_bot: false, is_email_taken: false, ...user })),\n\t\t\t\t\tchannels: channels.map((channel) => ({ is_private: false, is_direct: false, ...channel })),\n\t\t\t\t},\n\t\t\t});\n\t\t\trouter.navigate('/admin/import/progress');\n\t\t} catch (error) {\n\t\t\thandleError(error, t('Failed_To_Start_Import'));\n\t\t\trouter.navigate('/admin/import');\n\t\t}\n\t};\n\n\tconst [tab, setTab] = useState('users');\n\tconst handleTabClick = useMemo(() => (tab: string) => () => setTab(tab), []);\n\n\tconst statusDebounced = useDebouncedValue(status, 100);\n\n\tconst handleMinimumImportData = !!(\n\t\t(!usersCount && !channelsCount && !messageCount) ||\n\t\t(!usersCount && !channelsCount && messageCount !== 0)\n\t);\n\n\treturn (\n\t\t<Page>\n\t\t\t<PageHeader title={t('Importing_Data')} onClickBack={() => router.navigate('/admin/import')}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button primary disabled={isImporting || handleMinimumImportData} onClick={handleStartButtonClick}>\n\t\t\t\t\t\t{t('Importer_Prepare_Start_Import')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</PageHeader>\n\t\t\t<PageScrollableContentWithShadow>\n\t\t\t\t<Box marginInline='auto' marginBlock='x24' width='full' maxWidth='590px'>\n\t\t\t\t\t<Box is='h2' fontScale='p2m'>\n\t\t\t\t\t\t{statusDebounced && t(statusDebounced.replace('importer_', 'importer_status_') as TranslationKey)}\n\t\t\t\t\t</Box>\n\t\t\t\t\t{!isPreparing && (\n\t\t\t\t\t\t<Tabs flexShrink={0}>\n\t\t\t\t\t\t\t<Tabs.Item selected={tab === 'users'} onClick={handleTabClick('users')}>\n\t\t\t\t\t\t\t\t{t('Users')} <Badge>{usersCount}</Badge>\n\t\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t\t<Tabs.Item selected={tab === 'channels'} onClick={handleTabClick('channels')}>\n\t\t\t\t\t\t\t\t{t('Channels')} <Badge>{channelsCount}</Badge>\n\t\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t\t<Tabs.Item disabled>\n\t\t\t\t\t\t\t\t{t('Messages')}\n\t\t\t\t\t\t\t\t<Badge>{messageCount}</Badge>\n\t\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t</Tabs>\n\t\t\t\t\t)}\n\t\t\t\t\t<Margins block='x24'>\n\t\t\t\t\t\t{isPreparing && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{progressRate ? (\n\t\t\t\t\t\t\t\t\t<Box display='flex' justifyContent='center' fontScale='p2'>\n\t\t\t\t\t\t\t\t\t\t<ProgressBar percentage={Math.floor(progressRate)} />\n\t\t\t\t\t\t\t\t\t\t<Box is='span' mis='x24'>\n\t\t\t\t\t\t\t\t\t\t\t{numberFormat(progressRate, 0)}%\n\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<Throbber justifyContent='center' />\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{!isPreparing && tab === 'users' && <PrepareUsers usersCount={usersCount} users={users} setUsers={setUsers} />}\n\t\t\t\t\t\t{!isPreparing && tab === 'channels' && (\n\t\t\t\t\t\t\t<PrepareChannels channels={channels} channelsCount={channelsCount} setChannels={setChannels} />\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Margins>\n\t\t\t\t</Box>\n\t\t\t</PageScrollableContentWithShadow>\n\t\t</Page>\n\t);\n}\n\nexport default PrepareImportPage;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"2b86ee253383db47b0e3911f188847382cd21f11"}
