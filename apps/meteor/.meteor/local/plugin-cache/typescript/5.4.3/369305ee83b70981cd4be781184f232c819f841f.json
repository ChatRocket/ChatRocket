{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/deviceManagement/DeviceManagementAdminTable/DeviceManagementAdminTable.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/admin/deviceManagement/DeviceManagementAdminTable/DeviceManagementAdminTable.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/deviceManagement/DeviceManagementAdminTable/DeviceManagementAdminTable.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/deviceManagement/DeviceManagementAdminTable/DeviceManagementAdminTable.tsx","sourceRoot":"","sources":["client/views/admin/deviceManagement/DeviceManagementAdminTable/DeviceManagementAdminTable.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { DeviceManagementPopulatedSession, DeviceManagementSession, Serialized } from '@rocket.chat/core-typings';\nimport { useDebouncedValue, useMediaQuery } from '@rocket.chat/fuselage-hooks';\nimport type { ReactElement, MutableRefObject } from 'react';\nimport React, { useState, useMemo, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport FilterByText from '../../../../components/FilterByText';\nimport { GenericTableHeaderCell } from '../../../../components/GenericTable';\nimport { usePagination } from '../../../../components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../../components/GenericTable/hooks/useSort';\nimport DeviceManagementTable from '../../../../components/deviceManagement/DeviceManagementTable';\nimport { useEndpointData } from '../../../../hooks/useEndpointData';\nimport DeviceManagementAdminRow from './DeviceManagementAdminRow';\n\nconst sortMapping = {\n\tclient: 'device.name',\n\tusername: '_user.username',\n\tos: 'device.os.name',\n\tloginAt: 'loginAt',\n};\n\nconst isSessionPopulatedSession = (\n\tsession: Serialized<DeviceManagementPopulatedSession | DeviceManagementSession>,\n): session is Serialized<DeviceManagementPopulatedSession> => '_user' in session;\n\nconst DeviceManagementAdminTable = ({ reloadRef }: { reloadRef: MutableRefObject<() => void> }): ReactElement => {\n\tconst { t } = useTranslation();\n\tconst [text, setText] = useState('');\n\tconst { current, itemsPerPage, setCurrent, setItemsPerPage, ...paginationProps } = usePagination();\n\tconst { sortBy, sortDirection, setSort } = useSort<'client' | 'os' | 'username' | 'loginAt'>('username');\n\n\tconst query = useDebouncedValue(\n\t\tuseMemo(\n\t\t\t() => ({\n\t\t\t\tfilter: text,\n\t\t\t\tsort: JSON.stringify({ [sortMapping[sortBy]]: sortDirection === 'asc' ? 1 : -1 }),\n\t\t\t\tcount: itemsPerPage,\n\t\t\t\toffset: text ? undefined : current,\n\t\t\t}),\n\t\t\t[text, itemsPerPage, current, sortBy, sortDirection],\n\t\t),\n\t\t500,\n\t);\n\n\tconst { value: data, phase, error, reload } = useEndpointData('/v1/sessions/list.all', { params: query });\n\n\tuseEffect(() => {\n\t\treloadRef.current = reload;\n\t}, [reloadRef, reload]);\n\n\tconst mediaQuery = useMediaQuery('(min-width: 1024px)');\n\n\tconst headers = useMemo(\n\t\t() => [\n\t\t\t<GenericTableHeaderCell key='client' direction={sortDirection} active={sortBy === 'client'} onClick={setSort} sort='client'>\n\t\t\t\t{t('Client')}\n\t\t\t</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell key='rcVersion'>{t('Version')}</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell key='os' direction={sortDirection} active={sortBy === 'os'} onClick={setSort} sort='os'>\n\t\t\t\t{t('OS')}\n\t\t\t</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell key='username' direction={sortDirection} active={sortBy === 'username'} onClick={setSort} sort='username'>\n\t\t\t\t{t('User')}\n\t\t\t</GenericTableHeaderCell>,\n\t\t\tmediaQuery && (\n\t\t\t\t<GenericTableHeaderCell key='loginAt' direction={sortDirection} active={sortBy === 'loginAt'} onClick={setSort} sort='loginAt'>\n\t\t\t\t\t{t('Last_login')}\n\t\t\t\t</GenericTableHeaderCell>\n\t\t\t),\n\t\t\tmediaQuery && <GenericTableHeaderCell key='_id'>{t('Device_ID')}</GenericTableHeaderCell>,\n\t\t\tmediaQuery && <GenericTableHeaderCell key='ip'>{t('IP_Address')}</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell width='5%' key='menu' />,\n\t\t],\n\t\t[t, mediaQuery, setSort, sortDirection, sortBy],\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<FilterByText placeholder={t('Search_Devices_Users')} value={text} onChange={(event) => setText(event.target.value)} />\n\t\t\t<DeviceManagementTable\n\t\t\t\tdata={data}\n\t\t\t\tphase={phase}\n\t\t\t\terror={error}\n\t\t\t\treload={reload}\n\t\t\t\theaders={headers}\n\t\t\t\trenderRow={(session): ReactElement => (\n\t\t\t\t\t<DeviceManagementAdminRow\n\t\t\t\t\t\tkey={session._id}\n\t\t\t\t\t\t_id={session._id}\n\t\t\t\t\t\tusername={isSessionPopulatedSession(session) ? session._user?.username : ''}\n\t\t\t\t\t\tip={session.ip}\n\t\t\t\t\t\tdeviceName={session?.device?.name}\n\t\t\t\t\t\tdeviceType={session?.device?.type}\n\t\t\t\t\t\tdeviceOSName={session?.device?.os?.name}\n\t\t\t\t\t\trcVersion={session?.device?.version}\n\t\t\t\t\t\tloginAt={session.loginAt}\n\t\t\t\t\t\tonReload={reload}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\tcurrent={current}\n\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\tsetCurrent={setCurrent}\n\t\t\t\tsetItemsPerPage={setItemsPerPage}\n\t\t\t\tpaginationProps={paginationProps}\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport default DeviceManagementAdminTable;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/deviceManagement/DeviceManagementAdminTable/DeviceManagementAdminTable.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/admin/deviceManagement/DeviceManagementAdminTable/DeviceManagementAdminTable.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/deviceManagement/DeviceManagementAdminTable/DeviceManagementAdminTable.tsx","sourceRoot":"","sources":["client/views/admin/deviceManagement/DeviceManagementAdminTable/DeviceManagementAdminTable.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { DeviceManagementPopulatedSession, DeviceManagementSession, Serialized } from '@rocket.chat/core-typings';\nimport { useDebouncedValue, useMediaQuery } from '@rocket.chat/fuselage-hooks';\nimport type { ReactElement, MutableRefObject } from 'react';\nimport React, { useState, useMemo, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport FilterByText from '../../../../components/FilterByText';\nimport { GenericTableHeaderCell } from '../../../../components/GenericTable';\nimport { usePagination } from '../../../../components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../../components/GenericTable/hooks/useSort';\nimport DeviceManagementTable from '../../../../components/deviceManagement/DeviceManagementTable';\nimport { useEndpointData } from '../../../../hooks/useEndpointData';\nimport DeviceManagementAdminRow from './DeviceManagementAdminRow';\n\nconst sortMapping = {\n\tclient: 'device.name',\n\tusername: '_user.username',\n\tos: 'device.os.name',\n\tloginAt: 'loginAt',\n};\n\nconst isSessionPopulatedSession = (\n\tsession: Serialized<DeviceManagementPopulatedSession | DeviceManagementSession>,\n): session is Serialized<DeviceManagementPopulatedSession> => '_user' in session;\n\nconst DeviceManagementAdminTable = ({ reloadRef }: { reloadRef: MutableRefObject<() => void> }): ReactElement => {\n\tconst { t } = useTranslation();\n\tconst [text, setText] = useState('');\n\tconst { current, itemsPerPage, setCurrent, setItemsPerPage, ...paginationProps } = usePagination();\n\tconst { sortBy, sortDirection, setSort } = useSort<'client' | 'os' | 'username' | 'loginAt'>('username');\n\n\tconst query = useDebouncedValue(\n\t\tuseMemo(\n\t\t\t() => ({\n\t\t\t\tfilter: text,\n\t\t\t\tsort: JSON.stringify({ [sortMapping[sortBy]]: sortDirection === 'asc' ? 1 : -1 }),\n\t\t\t\tcount: itemsPerPage,\n\t\t\t\toffset: text ? undefined : current,\n\t\t\t}),\n\t\t\t[text, itemsPerPage, current, sortBy, sortDirection],\n\t\t),\n\t\t500,\n\t);\n\n\tconst { value: data, phase, error, reload } = useEndpointData('/v1/sessions/list.all', { params: query });\n\n\tuseEffect(() => {\n\t\treloadRef.current = reload;\n\t}, [reloadRef, reload]);\n\n\tconst mediaQuery = useMediaQuery('(min-width: 1024px)');\n\n\tconst headers = useMemo(\n\t\t() => [\n\t\t\t<GenericTableHeaderCell key='client' direction={sortDirection} active={sortBy === 'client'} onClick={setSort} sort='client'>\n\t\t\t\t{t('Client')}\n\t\t\t</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell key='rcVersion'>{t('Version')}</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell key='os' direction={sortDirection} active={sortBy === 'os'} onClick={setSort} sort='os'>\n\t\t\t\t{t('OS')}\n\t\t\t</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell key='username' direction={sortDirection} active={sortBy === 'username'} onClick={setSort} sort='username'>\n\t\t\t\t{t('User')}\n\t\t\t</GenericTableHeaderCell>,\n\t\t\tmediaQuery && (\n\t\t\t\t<GenericTableHeaderCell key='loginAt' direction={sortDirection} active={sortBy === 'loginAt'} onClick={setSort} sort='loginAt'>\n\t\t\t\t\t{t('Last_login')}\n\t\t\t\t</GenericTableHeaderCell>\n\t\t\t),\n\t\t\tmediaQuery && <GenericTableHeaderCell key='_id'>{t('Device_ID')}</GenericTableHeaderCell>,\n\t\t\tmediaQuery && <GenericTableHeaderCell key='ip'>{t('IP_Address')}</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell width='5%' key='menu' />,\n\t\t],\n\t\t[t, mediaQuery, setSort, sortDirection, sortBy],\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<FilterByText placeholder={t('Search_Devices_Users')} value={text} onChange={(event) => setText(event.target.value)} />\n\t\t\t<DeviceManagementTable\n\t\t\t\tdata={data}\n\t\t\t\tphase={phase}\n\t\t\t\terror={error}\n\t\t\t\treload={reload}\n\t\t\t\theaders={headers}\n\t\t\t\trenderRow={(session): ReactElement => (\n\t\t\t\t\t<DeviceManagementAdminRow\n\t\t\t\t\t\tkey={session._id}\n\t\t\t\t\t\t_id={session._id}\n\t\t\t\t\t\tusername={isSessionPopulatedSession(session) ? session._user?.username : ''}\n\t\t\t\t\t\tip={session.ip}\n\t\t\t\t\t\tdeviceName={session?.device?.name}\n\t\t\t\t\t\tdeviceType={session?.device?.type}\n\t\t\t\t\t\tdeviceOSName={session?.device?.os?.name}\n\t\t\t\t\t\trcVersion={session?.device?.version}\n\t\t\t\t\t\tloginAt={session.loginAt}\n\t\t\t\t\t\tonReload={reload}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\tcurrent={current}\n\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\tsetCurrent={setCurrent}\n\t\t\t\tsetItemsPerPage={setItemsPerPage}\n\t\t\t\tpaginationProps={paginationProps}\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport default DeviceManagementAdminTable;\n"]}}},"code":"const _excluded = [\"current\", \"itemsPerPage\", \"setCurrent\", \"setItemsPerPage\"];\nlet _objectWithoutProperties;\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default(v) {\n    _objectWithoutProperties = v;\n  }\n}, 0);\nlet useDebouncedValue, useMediaQuery;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useDebouncedValue(v) {\n    useDebouncedValue = v;\n  },\n  useMediaQuery(v) {\n    useMediaQuery = v;\n  }\n}, 0);\nlet React, useState, useMemo, useEffect;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n  useState(v) {\n    useState = v;\n  },\n  useMemo(v) {\n    useMemo = v;\n  },\n  useEffect(v) {\n    useEffect = v;\n  }\n}, 1);\nlet useTranslation;\nmodule.link(\"react-i18next\", {\n  useTranslation(v) {\n    useTranslation = v;\n  }\n}, 2);\nlet FilterByText;\nmodule.link(\"../../../../components/FilterByText\", {\n  default(v) {\n    FilterByText = v;\n  }\n}, 3);\nlet GenericTableHeaderCell;\nmodule.link(\"../../../../components/GenericTable\", {\n  GenericTableHeaderCell(v) {\n    GenericTableHeaderCell = v;\n  }\n}, 4);\nlet usePagination;\nmodule.link(\"../../../../components/GenericTable/hooks/usePagination\", {\n  usePagination(v) {\n    usePagination = v;\n  }\n}, 5);\nlet useSort;\nmodule.link(\"../../../../components/GenericTable/hooks/useSort\", {\n  useSort(v) {\n    useSort = v;\n  }\n}, 6);\nlet DeviceManagementTable;\nmodule.link(\"../../../../components/deviceManagement/DeviceManagementTable\", {\n  default(v) {\n    DeviceManagementTable = v;\n  }\n}, 7);\nlet useEndpointData;\nmodule.link(\"../../../../hooks/useEndpointData\", {\n  useEndpointData(v) {\n    useEndpointData = v;\n  }\n}, 8);\nlet DeviceManagementAdminRow;\nmodule.link(\"./DeviceManagementAdminRow\", {\n  default(v) {\n    DeviceManagementAdminRow = v;\n  }\n}, 9);\nconst sortMapping = {\n  client: 'device.name',\n  username: '_user.username',\n  os: 'device.os.name',\n  loginAt: 'loginAt'\n};\nconst isSessionPopulatedSession = session => '_user' in session;\nconst DeviceManagementAdminTable = _ref => {\n  let {\n    reloadRef\n  } = _ref;\n  const {\n    t\n  } = useTranslation();\n  const [text, setText] = useState('');\n  const _usePagination = usePagination(),\n    {\n      current,\n      itemsPerPage,\n      setCurrent,\n      setItemsPerPage\n    } = _usePagination,\n    paginationProps = _objectWithoutProperties(_usePagination, _excluded);\n  const {\n    sortBy,\n    sortDirection,\n    setSort\n  } = useSort('username');\n  const query = useDebouncedValue(useMemo(() => ({\n    filter: text,\n    sort: JSON.stringify({\n      [sortMapping[sortBy]]: sortDirection === 'asc' ? 1 : -1\n    }),\n    count: itemsPerPage,\n    offset: text ? undefined : current\n  }), [text, itemsPerPage, current, sortBy, sortDirection]), 500);\n  const {\n    value: data,\n    phase,\n    error,\n    reload\n  } = useEndpointData('/v1/sessions/list.all', {\n    params: query\n  });\n  useEffect(() => {\n    reloadRef.current = reload;\n  }, [reloadRef, reload]);\n  const mediaQuery = useMediaQuery('(min-width: 1024px)');\n  const headers = useMemo(() => [/*#__PURE__*/React.createElement(GenericTableHeaderCell, {\n    key: \"client\",\n    direction: sortDirection,\n    active: sortBy === 'client',\n    onClick: setSort,\n    sort: \"client\"\n  }, t('Client')), /*#__PURE__*/React.createElement(GenericTableHeaderCell, {\n    key: \"rcVersion\"\n  }, t('Version')), /*#__PURE__*/React.createElement(GenericTableHeaderCell, {\n    key: \"os\",\n    direction: sortDirection,\n    active: sortBy === 'os',\n    onClick: setSort,\n    sort: \"os\"\n  }, t('OS')), /*#__PURE__*/React.createElement(GenericTableHeaderCell, {\n    key: \"username\",\n    direction: sortDirection,\n    active: sortBy === 'username',\n    onClick: setSort,\n    sort: \"username\"\n  }, t('User')), mediaQuery && /*#__PURE__*/React.createElement(GenericTableHeaderCell, {\n    key: \"loginAt\",\n    direction: sortDirection,\n    active: sortBy === 'loginAt',\n    onClick: setSort,\n    sort: \"loginAt\"\n  }, t('Last_login')), mediaQuery && /*#__PURE__*/React.createElement(GenericTableHeaderCell, {\n    key: \"_id\"\n  }, t('Device_ID')), mediaQuery && /*#__PURE__*/React.createElement(GenericTableHeaderCell, {\n    key: \"ip\"\n  }, t('IP_Address')), /*#__PURE__*/React.createElement(GenericTableHeaderCell, {\n    width: \"5%\",\n    key: \"menu\"\n  })], [t, mediaQuery, setSort, sortDirection, sortBy]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(FilterByText, {\n    placeholder: t('Search_Devices_Users'),\n    value: text,\n    onChange: event => setText(event.target.value)\n  }), /*#__PURE__*/React.createElement(DeviceManagementTable, {\n    data: data,\n    phase: phase,\n    error: error,\n    reload: reload,\n    headers: headers,\n    renderRow: session => {\n      var _session$_user, _session$device, _session$device2, _session$device3, _session$device3$os, _session$device4;\n      return /*#__PURE__*/React.createElement(DeviceManagementAdminRow, {\n        key: session._id,\n        _id: session._id,\n        username: isSessionPopulatedSession(session) ? (_session$_user = session._user) === null || _session$_user === void 0 ? void 0 : _session$_user.username : '',\n        ip: session.ip,\n        deviceName: session === null || session === void 0 ? void 0 : (_session$device = session.device) === null || _session$device === void 0 ? void 0 : _session$device.name,\n        deviceType: session === null || session === void 0 ? void 0 : (_session$device2 = session.device) === null || _session$device2 === void 0 ? void 0 : _session$device2.type,\n        deviceOSName: session === null || session === void 0 ? void 0 : (_session$device3 = session.device) === null || _session$device3 === void 0 ? void 0 : (_session$device3$os = _session$device3.os) === null || _session$device3$os === void 0 ? void 0 : _session$device3$os.name,\n        rcVersion: session === null || session === void 0 ? void 0 : (_session$device4 = session.device) === null || _session$device4 === void 0 ? void 0 : _session$device4.version,\n        loginAt: session.loginAt,\n        onReload: reload\n      });\n    },\n    current: current,\n    itemsPerPage: itemsPerPage,\n    setCurrent: setCurrent,\n    setItemsPerPage: setItemsPerPage,\n    paginationProps: paginationProps\n  }));\n};\nmodule.exportDefault(DeviceManagementAdminTable);","map":{"version":3,"names":["_objectWithoutProperties","module","link","default","v","useDebouncedValue","useMediaQuery","React","useState","useMemo","useEffect","useTranslation","FilterByText","GenericTableHeaderCell","usePagination","useSort","DeviceManagementTable","useEndpointData","DeviceManagementAdminRow","sortMapping","client","username","os","loginAt","isSessionPopulatedSession","session","DeviceManagementAdminTable","_ref","reloadRef","t","text","setText","_usePagination","current","itemsPerPage","setCurrent","setItemsPerPage","paginationProps","_excluded","sortBy","sortDirection","setSort","query","filter","sort","JSON","stringify","count","offset","undefined","value","data","phase","error","reload","params","mediaQuery","headers","createElement","key","direction","active","onClick","width","Fragment","placeholder","onChange","event","target","renderRow","_session$_user","_session$device","_session$device2","_session$device3","_session$device3$os","_session$device4","_id","_user","ip","deviceName","device","name","deviceType","type","deviceOSName","rcVersion","version","onReload","exportDefault"],"sources":["client/views/admin/deviceManagement/DeviceManagementAdminTable/DeviceManagementAdminTable.tsx"],"sourcesContent":["import type { DeviceManagementPopulatedSession, DeviceManagementSession, Serialized } from '@rocket.chat/core-typings';\nimport { useDebouncedValue, useMediaQuery } from '@rocket.chat/fuselage-hooks';\nimport type { ReactElement, MutableRefObject } from 'react';\nimport React, { useState, useMemo, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport FilterByText from '../../../../components/FilterByText';\nimport { GenericTableHeaderCell } from '../../../../components/GenericTable';\nimport { usePagination } from '../../../../components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../../components/GenericTable/hooks/useSort';\nimport DeviceManagementTable from '../../../../components/deviceManagement/DeviceManagementTable';\nimport { useEndpointData } from '../../../../hooks/useEndpointData';\nimport DeviceManagementAdminRow from './DeviceManagementAdminRow';\n\nconst sortMapping = {\n\tclient: 'device.name',\n\tusername: '_user.username',\n\tos: 'device.os.name',\n\tloginAt: 'loginAt',\n};\n\nconst isSessionPopulatedSession = (\n\tsession: Serialized<DeviceManagementPopulatedSession | DeviceManagementSession>,\n): session is Serialized<DeviceManagementPopulatedSession> => '_user' in session;\n\nconst DeviceManagementAdminTable = ({ reloadRef }: { reloadRef: MutableRefObject<() => void> }): ReactElement => {\n\tconst { t } = useTranslation();\n\tconst [text, setText] = useState('');\n\tconst { current, itemsPerPage, setCurrent, setItemsPerPage, ...paginationProps } = usePagination();\n\tconst { sortBy, sortDirection, setSort } = useSort<'client' | 'os' | 'username' | 'loginAt'>('username');\n\n\tconst query = useDebouncedValue(\n\t\tuseMemo(\n\t\t\t() => ({\n\t\t\t\tfilter: text,\n\t\t\t\tsort: JSON.stringify({ [sortMapping[sortBy]]: sortDirection === 'asc' ? 1 : -1 }),\n\t\t\t\tcount: itemsPerPage,\n\t\t\t\toffset: text ? undefined : current,\n\t\t\t}),\n\t\t\t[text, itemsPerPage, current, sortBy, sortDirection],\n\t\t),\n\t\t500,\n\t);\n\n\tconst { value: data, phase, error, reload } = useEndpointData('/v1/sessions/list.all', { params: query });\n\n\tuseEffect(() => {\n\t\treloadRef.current = reload;\n\t}, [reloadRef, reload]);\n\n\tconst mediaQuery = useMediaQuery('(min-width: 1024px)');\n\n\tconst headers = useMemo(\n\t\t() => [\n\t\t\t<GenericTableHeaderCell key='client' direction={sortDirection} active={sortBy === 'client'} onClick={setSort} sort='client'>\n\t\t\t\t{t('Client')}\n\t\t\t</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell key='rcVersion'>{t('Version')}</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell key='os' direction={sortDirection} active={sortBy === 'os'} onClick={setSort} sort='os'>\n\t\t\t\t{t('OS')}\n\t\t\t</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell key='username' direction={sortDirection} active={sortBy === 'username'} onClick={setSort} sort='username'>\n\t\t\t\t{t('User')}\n\t\t\t</GenericTableHeaderCell>,\n\t\t\tmediaQuery && (\n\t\t\t\t<GenericTableHeaderCell key='loginAt' direction={sortDirection} active={sortBy === 'loginAt'} onClick={setSort} sort='loginAt'>\n\t\t\t\t\t{t('Last_login')}\n\t\t\t\t</GenericTableHeaderCell>\n\t\t\t),\n\t\t\tmediaQuery && <GenericTableHeaderCell key='_id'>{t('Device_ID')}</GenericTableHeaderCell>,\n\t\t\tmediaQuery && <GenericTableHeaderCell key='ip'>{t('IP_Address')}</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell width='5%' key='menu' />,\n\t\t],\n\t\t[t, mediaQuery, setSort, sortDirection, sortBy],\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<FilterByText placeholder={t('Search_Devices_Users')} value={text} onChange={(event) => setText(event.target.value)} />\n\t\t\t<DeviceManagementTable\n\t\t\t\tdata={data}\n\t\t\t\tphase={phase}\n\t\t\t\terror={error}\n\t\t\t\treload={reload}\n\t\t\t\theaders={headers}\n\t\t\t\trenderRow={(session): ReactElement => (\n\t\t\t\t\t<DeviceManagementAdminRow\n\t\t\t\t\t\tkey={session._id}\n\t\t\t\t\t\t_id={session._id}\n\t\t\t\t\t\tusername={isSessionPopulatedSession(session) ? session._user?.username : ''}\n\t\t\t\t\t\tip={session.ip}\n\t\t\t\t\t\tdeviceName={session?.device?.name}\n\t\t\t\t\t\tdeviceType={session?.device?.type}\n\t\t\t\t\t\tdeviceOSName={session?.device?.os?.name}\n\t\t\t\t\t\trcVersion={session?.device?.version}\n\t\t\t\t\t\tloginAt={session.loginAt}\n\t\t\t\t\t\tonReload={reload}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\tcurrent={current}\n\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\tsetCurrent={setCurrent}\n\t\t\t\tsetItemsPerPage={setItemsPerPage}\n\t\t\t\tpaginationProps={paginationProps}\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport default DeviceManagementAdminTable;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"369305ee83b70981cd4be781184f232c819f841f"}
