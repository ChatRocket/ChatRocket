{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts","inputSourceMap":{"version":3,"file":"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts","sourceRoot":"","sources":["client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,kBAAkB,EAAE,MAAM,6BAA6B,CAAC;AAEjE,OAAO,EAAE,UAAU,EAAE,MAAM,0BAA0B,CAAC;AACtD,OAAO,EAAE,SAAS,EAAE,OAAO,EAAE,MAAM,OAAO,CAAC;AAE3C,OAAO,EAAE,aAAa,EAAE,MAAM,iEAAiE,CAAC;AAChG,OAAO,EAAE,OAAO,EAAE,MAAM,kCAAkC,CAAC;AAC3D,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AACtE,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AAEtE,MAAM,CAAC,MAAM,qBAAqB,GAAG,CAAC,QAAiB,EAAwB,EAAE;IAChF,MAAM,mBAAmB,GAAG,UAAU,CAAC,oBAAoB,CAAY,CAAC;IACxE,MAAM,sBAAsB,GAAG,UAAU,CAAC,8BAA8B,CAAY,CAAC;IACrF,MAAM,4BAA4B,GAAG,UAAU,CAAC,+BAA+B,CAAW,CAAC;IAC3F,MAAM,4BAA4B,GAAG,UAAU,CAAC,+BAA+B,CAAW,CAAC;IAC3F,MAAM,CAAC,kBAAkB,EAAE,qBAAqB,CAAC,GAAG,mBAAmB,CAAC,QAAQ,CAAC,CAAC;IAElF,MAAM,SAAS,GAAG,OAAO,CACxB,GAAG,EAAE,CACJ,OAAO,CACN,CAAC,kBAAkB;QAClB,SAAS,CAAC,YAAY;QACtB,MAAM,CAAC,aAAa;QACpB,mBAAmB;QACnB,sBAAsB;QACtB,CAAC,4BAA4B,EAAE,KAAK,CAAC,wBAAwB,CAAC;QAC9D,CAAC,CAAC,4BAA4B,IAAI,4BAA4B,CAAC,KAAK,CAAC,wBAAwB,CAAC,CAAC;QAC/F,OAAO,CAAC,aAAa,CAAC,qBAAqB,EAAE,CAAC,CAC/C,EACF,CAAC,4BAA4B,EAAE,4BAA4B,EAAE,mBAAmB,EAAE,kBAAkB,EAAE,sBAAsB,CAAC,CAC7H,CAAC;IAEF,MAAM,mBAAmB,GAAG,mBAAmB,CAAC,OAAO,EAAE,kBAAkB,EAAE,mBAAmB,EAAE,sBAAsB,EAAE,SAAS,CAAC,CAAC;IAErI,MAAM,IAAI,GAAG,OAAO,EAAE,CAAC;IAEvB,MAAM,sBAAsB,GAAG,GAAG,EAAE;QACnC,IAAI,CAAC,IAAI,EAAE,QAAQ,EAAE,cAAc,CAAC,GAAG,EAAE,EAAE,CAAC;YAC3C,IAAI,EAAE,QAAQ,EAAE,iBAAiB,CAAC,IAAI,CAAC,CAAC;QACzC,CAAC;IACF,CAAC,CAAC;IAEF,MAAM,eAAe,GAAG,kBAAkB,CAAC,CAAC,QAAQ,EAAE,EAAE;QACvD,IAAI,QAAQ,EAAE,CAAC;YACd,IAAI,EAAE,QAAQ,EAAE,iBAAiB,CAAC,KAAK,CAAC,CAAC;QAC1C,CAAC;QAED,qBAAqB,CAAC,QAAQ,CAAC,CAAC;IACjC,CAAC,CAAC,CAAC;IAEH,SAAS,CAAC,GAAG,EAAE;QACd,eAAe,CAAC,kBAAkB,CAAC,CAAC;IACrC,CAAC,EAAE,CAAC,eAAe,EAAE,kBAAkB,CAAC,CAAC,CAAC;IAE1C,OAAO;QACN,EAAE,EAAE,eAAe;QACnB,OAAO,EAAE,mBAAmB;QAC5B,IAAI,EAAE,OAAO;QACb,QAAQ,EAAE,CAAC,SAAS,IAAI,OAAO,CAAC,QAAQ,CAAC;QACzC,OAAO,EAAE,sBAAsB;KAC/B,CAAC;AACH,CAAC,CAAC","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useSetting } from '@rocket.chat/ui-contexts';\nimport { useEffect, useMemo } from 'react';\n\nimport { VideoRecorder } from '../../../../../../../app/ui/client/lib/recorderjs/videoRecorder';\nimport { useChat } from '../../../../contexts/ChatContext';\nimport { useMediaActionTitle } from '../../hooks/useMediaActionTitle';\nimport { useMediaPermissions } from '../../hooks/useMediaPermissions';\n\nexport const useVideoMessageAction = (disabled: boolean): GenericMenuItemProps => {\n\tconst isFileUploadEnabled = useSetting('FileUpload_Enabled') as boolean;\n\tconst isVideoRecorderEnabled = useSetting('Message_VideoRecorderEnabled') as boolean;\n\tconst fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList') as string;\n\tconst fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList') as string;\n\tconst [isPermissionDenied, setIsPermissionDenied] = useMediaPermissions('camera');\n\n\tconst isAllowed = useMemo(\n\t\t() =>\n\t\t\tBoolean(\n\t\t\t\t!isPermissionDenied &&\n\t\t\t\t\tnavigator.mediaDevices &&\n\t\t\t\t\twindow.MediaRecorder &&\n\t\t\t\t\tisFileUploadEnabled &&\n\t\t\t\t\tisVideoRecorderEnabled &&\n\t\t\t\t\t!fileUploadMediaTypeBlackList?.match(/video\\/webm|video\\/\\*/i) &&\n\t\t\t\t\t(!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/video\\/webm|video\\/\\*/i)) &&\n\t\t\t\t\tBoolean(VideoRecorder.getSupportedMimeTypes()),\n\t\t\t),\n\t\t[fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isFileUploadEnabled, isPermissionDenied, isVideoRecorderEnabled],\n\t);\n\n\tconst getMediaActionTitle = useMediaActionTitle('video', isPermissionDenied, isFileUploadEnabled, isVideoRecorderEnabled, isAllowed);\n\n\tconst chat = useChat();\n\n\tconst handleOpenVideoMessage = () => {\n\t\tif (!chat?.composer?.recordingVideo.get()) {\n\t\t\tchat?.composer?.setRecordingVideo(true);\n\t\t}\n\t};\n\n\tconst handleDenyVideo = useMutableCallback((isDenied) => {\n\t\tif (isDenied) {\n\t\t\tchat?.composer?.setRecordingVideo(false);\n\t\t}\n\n\t\tsetIsPermissionDenied(isDenied);\n\t});\n\n\tuseEffect(() => {\n\t\thandleDenyVideo(isPermissionDenied);\n\t}, [handleDenyVideo, isPermissionDenied]);\n\n\treturn {\n\t\tid: 'video-message',\n\t\tcontent: getMediaActionTitle,\n\t\ticon: 'video',\n\t\tdisabled: !isAllowed || Boolean(disabled),\n\t\tonClick: handleOpenVideoMessage,\n\t};\n};\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts","inputSourceMap":{"version":3,"file":"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts","sourceRoot":"","sources":["client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,kBAAkB,EAAE,MAAM,6BAA6B,CAAC;AAEjE,OAAO,EAAE,UAAU,EAAE,MAAM,0BAA0B,CAAC;AACtD,OAAO,EAAE,SAAS,EAAE,OAAO,EAAE,MAAM,OAAO,CAAC;AAE3C,OAAO,EAAE,aAAa,EAAE,MAAM,iEAAiE,CAAC;AAChG,OAAO,EAAE,OAAO,EAAE,MAAM,kCAAkC,CAAC;AAC3D,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AACtE,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AAEtE,MAAM,CAAC,MAAM,qBAAqB,GAAG,CAAC,QAAiB,EAAwB,EAAE;IAChF,MAAM,mBAAmB,GAAG,UAAU,CAAC,oBAAoB,CAAY,CAAC;IACxE,MAAM,sBAAsB,GAAG,UAAU,CAAC,8BAA8B,CAAY,CAAC;IACrF,MAAM,4BAA4B,GAAG,UAAU,CAAC,+BAA+B,CAAW,CAAC;IAC3F,MAAM,4BAA4B,GAAG,UAAU,CAAC,+BAA+B,CAAW,CAAC;IAC3F,MAAM,CAAC,kBAAkB,EAAE,qBAAqB,CAAC,GAAG,mBAAmB,CAAC,QAAQ,CAAC,CAAC;IAElF,MAAM,SAAS,GAAG,OAAO,CACxB,GAAG,EAAE,CACJ,OAAO,CACN,CAAC,kBAAkB;QAClB,SAAS,CAAC,YAAY;QACtB,MAAM,CAAC,aAAa;QACpB,mBAAmB;QACnB,sBAAsB;QACtB,CAAC,4BAA4B,EAAE,KAAK,CAAC,wBAAwB,CAAC;QAC9D,CAAC,CAAC,4BAA4B,IAAI,4BAA4B,CAAC,KAAK,CAAC,wBAAwB,CAAC,CAAC;QAC/F,OAAO,CAAC,aAAa,CAAC,qBAAqB,EAAE,CAAC,CAC/C,EACF,CAAC,4BAA4B,EAAE,4BAA4B,EAAE,mBAAmB,EAAE,kBAAkB,EAAE,sBAAsB,CAAC,CAC7H,CAAC;IAEF,MAAM,mBAAmB,GAAG,mBAAmB,CAAC,OAAO,EAAE,kBAAkB,EAAE,mBAAmB,EAAE,sBAAsB,EAAE,SAAS,CAAC,CAAC;IAErI,MAAM,IAAI,GAAG,OAAO,EAAE,CAAC;IAEvB,MAAM,sBAAsB,GAAG,GAAG,EAAE;QACnC,IAAI,CAAC,IAAI,EAAE,QAAQ,EAAE,cAAc,CAAC,GAAG,EAAE,EAAE,CAAC;YAC3C,IAAI,EAAE,QAAQ,EAAE,iBAAiB,CAAC,IAAI,CAAC,CAAC;QACzC,CAAC;IACF,CAAC,CAAC;IAEF,MAAM,eAAe,GAAG,kBAAkB,CAAC,CAAC,QAAQ,EAAE,EAAE;QACvD,IAAI,QAAQ,EAAE,CAAC;YACd,IAAI,EAAE,QAAQ,EAAE,iBAAiB,CAAC,KAAK,CAAC,CAAC;QAC1C,CAAC;QAED,qBAAqB,CAAC,QAAQ,CAAC,CAAC;IACjC,CAAC,CAAC,CAAC;IAEH,SAAS,CAAC,GAAG,EAAE;QACd,eAAe,CAAC,kBAAkB,CAAC,CAAC;IACrC,CAAC,EAAE,CAAC,eAAe,EAAE,kBAAkB,CAAC,CAAC,CAAC;IAE1C,OAAO;QACN,EAAE,EAAE,eAAe;QACnB,OAAO,EAAE,mBAAmB;QAC5B,IAAI,EAAE,OAAO;QACb,QAAQ,EAAE,CAAC,SAAS,IAAI,OAAO,CAAC,QAAQ,CAAC;QACzC,OAAO,EAAE,sBAAsB;KAC/B,CAAC;AACH,CAAC,CAAC","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useSetting } from '@rocket.chat/ui-contexts';\nimport { useEffect, useMemo } from 'react';\n\nimport { VideoRecorder } from '../../../../../../../app/ui/client/lib/recorderjs/videoRecorder';\nimport { useChat } from '../../../../contexts/ChatContext';\nimport { useMediaActionTitle } from '../../hooks/useMediaActionTitle';\nimport { useMediaPermissions } from '../../hooks/useMediaPermissions';\n\nexport const useVideoMessageAction = (disabled: boolean): GenericMenuItemProps => {\n\tconst isFileUploadEnabled = useSetting('FileUpload_Enabled') as boolean;\n\tconst isVideoRecorderEnabled = useSetting('Message_VideoRecorderEnabled') as boolean;\n\tconst fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList') as string;\n\tconst fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList') as string;\n\tconst [isPermissionDenied, setIsPermissionDenied] = useMediaPermissions('camera');\n\n\tconst isAllowed = useMemo(\n\t\t() =>\n\t\t\tBoolean(\n\t\t\t\t!isPermissionDenied &&\n\t\t\t\t\tnavigator.mediaDevices &&\n\t\t\t\t\twindow.MediaRecorder &&\n\t\t\t\t\tisFileUploadEnabled &&\n\t\t\t\t\tisVideoRecorderEnabled &&\n\t\t\t\t\t!fileUploadMediaTypeBlackList?.match(/video\\/webm|video\\/\\*/i) &&\n\t\t\t\t\t(!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/video\\/webm|video\\/\\*/i)) &&\n\t\t\t\t\tBoolean(VideoRecorder.getSupportedMimeTypes()),\n\t\t\t),\n\t\t[fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isFileUploadEnabled, isPermissionDenied, isVideoRecorderEnabled],\n\t);\n\n\tconst getMediaActionTitle = useMediaActionTitle('video', isPermissionDenied, isFileUploadEnabled, isVideoRecorderEnabled, isAllowed);\n\n\tconst chat = useChat();\n\n\tconst handleOpenVideoMessage = () => {\n\t\tif (!chat?.composer?.recordingVideo.get()) {\n\t\t\tchat?.composer?.setRecordingVideo(true);\n\t\t}\n\t};\n\n\tconst handleDenyVideo = useMutableCallback((isDenied) => {\n\t\tif (isDenied) {\n\t\t\tchat?.composer?.setRecordingVideo(false);\n\t\t}\n\n\t\tsetIsPermissionDenied(isDenied);\n\t});\n\n\tuseEffect(() => {\n\t\thandleDenyVideo(isPermissionDenied);\n\t}, [handleDenyVideo, isPermissionDenied]);\n\n\treturn {\n\t\tid: 'video-message',\n\t\tcontent: getMediaActionTitle,\n\t\ticon: 'video',\n\t\tdisabled: !isAllowed || Boolean(disabled),\n\t\tonClick: handleOpenVideoMessage,\n\t};\n};\n"]}}},"code":"var _slicedToArray;\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 0);\nmodule.export({\n  useVideoMessageAction: function () {\n    return useVideoMessageAction;\n  }\n});\nvar useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback: function (v) {\n    useMutableCallback = v;\n  }\n}, 0);\nvar useSetting;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useSetting: function (v) {\n    useSetting = v;\n  }\n}, 1);\nvar useEffect, useMemo;\nmodule.link(\"react\", {\n  useEffect: function (v) {\n    useEffect = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  }\n}, 2);\nvar VideoRecorder;\nmodule.link(\"../../../../../../../app/ui/client/lib/recorderjs/videoRecorder\", {\n  VideoRecorder: function (v) {\n    VideoRecorder = v;\n  }\n}, 3);\nvar useChat;\nmodule.link(\"../../../../contexts/ChatContext\", {\n  useChat: function (v) {\n    useChat = v;\n  }\n}, 4);\nvar useMediaActionTitle;\nmodule.link(\"../../hooks/useMediaActionTitle\", {\n  useMediaActionTitle: function (v) {\n    useMediaActionTitle = v;\n  }\n}, 5);\nvar useMediaPermissions;\nmodule.link(\"../../hooks/useMediaPermissions\", {\n  useMediaPermissions: function (v) {\n    useMediaPermissions = v;\n  }\n}, 6);\nvar useVideoMessageAction = function (disabled) {\n  var isFileUploadEnabled = useSetting('FileUpload_Enabled');\n  var isVideoRecorderEnabled = useSetting('Message_VideoRecorderEnabled');\n  var fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList');\n  var fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList');\n  var _useMediaPermissions = useMediaPermissions('camera'),\n    _useMediaPermissions2 = _slicedToArray(_useMediaPermissions, 2),\n    isPermissionDenied = _useMediaPermissions2[0],\n    setIsPermissionDenied = _useMediaPermissions2[1];\n  var isAllowed = useMemo(function () {\n    return Boolean(!isPermissionDenied && navigator.mediaDevices && window.MediaRecorder && isFileUploadEnabled && isVideoRecorderEnabled && !(fileUploadMediaTypeBlackList !== null && fileUploadMediaTypeBlackList !== void 0 && fileUploadMediaTypeBlackList.match(/video\\/webm|video\\/\\*/i)) && (!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/video\\/webm|video\\/\\*/i)) && Boolean(VideoRecorder.getSupportedMimeTypes()));\n  }, [fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isFileUploadEnabled, isPermissionDenied, isVideoRecorderEnabled]);\n  var getMediaActionTitle = useMediaActionTitle('video', isPermissionDenied, isFileUploadEnabled, isVideoRecorderEnabled, isAllowed);\n  var chat = useChat();\n  var handleOpenVideoMessage = function () {\n    var _chat$composer;\n    if (!(chat !== null && chat !== void 0 && (_chat$composer = chat.composer) !== null && _chat$composer !== void 0 && _chat$composer.recordingVideo.get())) {\n      var _chat$composer2;\n      chat === null || chat === void 0 ? void 0 : (_chat$composer2 = chat.composer) === null || _chat$composer2 === void 0 ? void 0 : _chat$composer2.setRecordingVideo(true);\n    }\n  };\n  var handleDenyVideo = useMutableCallback(function (isDenied) {\n    if (isDenied) {\n      var _chat$composer3;\n      chat === null || chat === void 0 ? void 0 : (_chat$composer3 = chat.composer) === null || _chat$composer3 === void 0 ? void 0 : _chat$composer3.setRecordingVideo(false);\n    }\n    setIsPermissionDenied(isDenied);\n  });\n  useEffect(function () {\n    handleDenyVideo(isPermissionDenied);\n  }, [handleDenyVideo, isPermissionDenied]);\n  return {\n    id: 'video-message',\n    content: getMediaActionTitle,\n    icon: 'video',\n    disabled: !isAllowed || Boolean(disabled),\n    onClick: handleOpenVideoMessage\n  };\n};","map":{"version":3,"names":["_slicedToArray","module","link","default","v","export","useVideoMessageAction","useMutableCallback","useSetting","useEffect","useMemo","VideoRecorder","useChat","useMediaActionTitle","useMediaPermissions","disabled","isFileUploadEnabled","isVideoRecorderEnabled","fileUploadMediaTypeBlackList","fileUploadMediaTypeWhiteList","_useMediaPermissions","_useMediaPermissions2","isPermissionDenied","setIsPermissionDenied","isAllowed","Boolean","navigator","mediaDevices","window","MediaRecorder","match","getSupportedMimeTypes","getMediaActionTitle","chat","handleOpenVideoMessage","_chat$composer","composer","recordingVideo","get","_chat$composer2","setRecordingVideo","handleDenyVideo","isDenied","_chat$composer3","id","content","icon","onClick"],"sources":["client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts"],"sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useSetting } from '@rocket.chat/ui-contexts';\nimport { useEffect, useMemo } from 'react';\n\nimport { VideoRecorder } from '../../../../../../../app/ui/client/lib/recorderjs/videoRecorder';\nimport { useChat } from '../../../../contexts/ChatContext';\nimport { useMediaActionTitle } from '../../hooks/useMediaActionTitle';\nimport { useMediaPermissions } from '../../hooks/useMediaPermissions';\n\nexport const useVideoMessageAction = (disabled: boolean): GenericMenuItemProps => {\n\tconst isFileUploadEnabled = useSetting('FileUpload_Enabled') as boolean;\n\tconst isVideoRecorderEnabled = useSetting('Message_VideoRecorderEnabled') as boolean;\n\tconst fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList') as string;\n\tconst fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList') as string;\n\tconst [isPermissionDenied, setIsPermissionDenied] = useMediaPermissions('camera');\n\n\tconst isAllowed = useMemo(\n\t\t() =>\n\t\t\tBoolean(\n\t\t\t\t!isPermissionDenied &&\n\t\t\t\t\tnavigator.mediaDevices &&\n\t\t\t\t\twindow.MediaRecorder &&\n\t\t\t\t\tisFileUploadEnabled &&\n\t\t\t\t\tisVideoRecorderEnabled &&\n\t\t\t\t\t!fileUploadMediaTypeBlackList?.match(/video\\/webm|video\\/\\*/i) &&\n\t\t\t\t\t(!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/video\\/webm|video\\/\\*/i)) &&\n\t\t\t\t\tBoolean(VideoRecorder.getSupportedMimeTypes()),\n\t\t\t),\n\t\t[fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isFileUploadEnabled, isPermissionDenied, isVideoRecorderEnabled],\n\t);\n\n\tconst getMediaActionTitle = useMediaActionTitle('video', isPermissionDenied, isFileUploadEnabled, isVideoRecorderEnabled, isAllowed);\n\n\tconst chat = useChat();\n\n\tconst handleOpenVideoMessage = () => {\n\t\tif (!chat?.composer?.recordingVideo.get()) {\n\t\t\tchat?.composer?.setRecordingVideo(true);\n\t\t}\n\t};\n\n\tconst handleDenyVideo = useMutableCallback((isDenied) => {\n\t\tif (isDenied) {\n\t\t\tchat?.composer?.setRecordingVideo(false);\n\t\t}\n\n\t\tsetIsPermissionDenied(isDenied);\n\t});\n\n\tuseEffect(() => {\n\t\thandleDenyVideo(isPermissionDenied);\n\t}, [handleDenyVideo, isPermissionDenied]);\n\n\treturn {\n\t\tid: 'video-message',\n\t\tcontent: getMediaActionTitle,\n\t\ticon: 'video',\n\t\tdisabled: !isAllowed || Boolean(disabled),\n\t\tonClick: handleOpenVideoMessage,\n\t};\n};\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"5d0b11faf720ef18b1e1a0f8bc6a0a2c98fb486a"}
