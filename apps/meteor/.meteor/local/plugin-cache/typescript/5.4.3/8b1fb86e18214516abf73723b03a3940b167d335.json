{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBox.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/room/composer/messageBox/MessageBox.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBox.tsx","inputSourceMap":{"version":3,"file":"client/views/room/composer/messageBox/MessageBox.tsx","sourceRoot":"","sources":["client/views/room/composer/messageBox/MessageBox.tsx"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable complexity */\nimport type { IMessage, ISubscription } from '@rocket.chat/core-typings';\nimport { useContentBoxSize, useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport {\n\tMessageComposerAction,\n\tMessageComposerToolbarActions,\n\tMessageComposer,\n\tMessageComposerInput,\n\tMessageComposerToolbar,\n\tMessageComposerActionsDivider,\n\tMessageComposerToolbarSubmit,\n\tMessageComposerButton,\n} from '@rocket.chat/ui-composer';\nimport { useTranslation, useUserPreference, useLayout, useSetting } from '@rocket.chat/ui-contexts';\nimport { useMutation } from '@tanstack/react-query';\nimport type { ReactElement, MouseEventHandler, FormEvent, ClipboardEventHandler, MouseEvent } from 'react';\nimport React, { memo, useRef, useReducer, useCallback } from 'react';\nimport { useSubscription } from 'use-subscription';\n\nimport { createComposerAPI } from '../../../../../app/ui-message/client/messageBox/createComposerAPI';\nimport type { FormattingButton } from '../../../../../app/ui-message/client/messageBox/messageBoxFormatting';\nimport { formattingButtons } from '../../../../../app/ui-message/client/messageBox/messageBoxFormatting';\nimport { getImageExtensionFromMime } from '../../../../../lib/getImageExtensionFromMime';\nimport { useFormatDateAndTime } from '../../../../hooks/useFormatDateAndTime';\nimport { useReactiveValue } from '../../../../hooks/useReactiveValue';\nimport type { ComposerAPI } from '../../../../lib/chats/ChatAPI';\nimport { roomCoordinator } from '../../../../lib/rooms/roomCoordinator';\nimport { keyCodes } from '../../../../lib/utils/keyCodes';\nimport AudioMessageRecorder from '../../../composer/AudioMessageRecorder';\nimport VideoMessageRecorder from '../../../composer/VideoMessageRecorder';\nimport { useChat } from '../../contexts/ChatContext';\nimport { useComposerPopup } from '../../contexts/ComposerPopupContext';\nimport { useRoom } from '../../contexts/RoomContext';\nimport ComposerBoxPopup from '../ComposerBoxPopup';\nimport ComposerBoxPopupPreview from '../ComposerBoxPopupPreview';\nimport ComposerUserActionIndicator from '../ComposerUserActionIndicator';\nimport { useAutoGrow } from '../RoomComposer/hooks/useAutoGrow';\nimport { useComposerBoxPopup } from '../hooks/useComposerBoxPopup';\nimport { useEnablePopupPreview } from '../hooks/useEnablePopupPreview';\nimport { useMessageComposerMergedRefs } from '../hooks/useMessageComposerMergedRefs';\nimport MessageBoxActionsToolbar from './MessageBoxActionsToolbar';\nimport MessageBoxFormattingToolbar from './MessageBoxFormattingToolbar';\nimport MessageBoxHint from './MessageBoxHint';\nimport MessageBoxReplies from './MessageBoxReplies';\nimport { useMessageBoxAutoFocus } from './hooks/useMessageBoxAutoFocus';\nimport { useMessageBoxPlaceholder } from './hooks/useMessageBoxPlaceholder';\n\nconst reducer = (_: unknown, event: FormEvent<HTMLInputElement>): boolean => {\n\tconst target = event.target as HTMLInputElement;\n\n\treturn Boolean(target.value.trim());\n};\n\nconst handleFormattingShortcut = (event: KeyboardEvent, formattingButtons: FormattingButton[], composer: ComposerAPI) => {\n\tconst isMacOS = navigator.platform.indexOf('Mac') !== -1;\n\tconst isCmdOrCtrlPressed = (isMacOS && event.metaKey) || (!isMacOS && event.ctrlKey);\n\n\tif (!isCmdOrCtrlPressed) {\n\t\treturn false;\n\t}\n\n\tconst key = event.key.toLowerCase();\n\n\tconst formatter = formattingButtons.find((formatter) => 'command' in formatter && formatter.command === key);\n\n\tif (!formatter || !('pattern' in formatter)) {\n\t\treturn false;\n\t}\n\n\tcomposer.wrapSelection(formatter.pattern);\n\treturn true;\n};\n\nconst emptySubscribe = () => () => undefined;\nconst getEmptyFalse = () => false;\nconst a: any[] = [];\nconst getEmptyArray = () => a;\n\ntype MessageBoxProps = {\n\ttmid?: IMessage['_id'];\n\tonSend?: (params: { value: string; tshow?: boolean; previewUrls?: string[]; isSlashCommandAllowed?: boolean }) => Promise<void>;\n\tonJoin?: () => Promise<void>;\n\tonResize?: () => void;\n\tonTyping?: () => void;\n\tonEscape?: () => void;\n\tonNavigateToPreviousMessage?: () => void;\n\tonNavigateToNextMessage?: () => void;\n\tonUploadFiles?: (files: readonly File[]) => void;\n\ttshow?: IMessage['tshow'];\n\tpreviewUrls?: string[];\n\tsubscription?: ISubscription;\n\tshowFormattingTips: boolean;\n\tisEmbedded?: boolean;\n};\n\nconst MessageBox = ({\n\ttmid,\n\tonSend,\n\tonJoin,\n\tonNavigateToNextMessage,\n\tonNavigateToPreviousMessage,\n\tonUploadFiles,\n\tonEscape,\n\tonTyping,\n\ttshow,\n\tpreviewUrls,\n}: MessageBoxProps): ReactElement => {\n\tconst chat = useChat();\n\tconst room = useRoom();\n\tconst t = useTranslation();\n\tconst e2eEnabled = useSetting<boolean>('E2E_Enable');\n\tconst unencryptedMessagesAllowed = useSetting<boolean>('E2E_Allow_Unencrypted_Messages');\n\tconst isSlashCommandAllowed = !e2eEnabled || !room.encrypted || unencryptedMessagesAllowed;\n\tconst composerPlaceholder = useMessageBoxPlaceholder(t('Message'), room);\n\n\tconst [typing, setTyping] = useReducer(reducer, false);\n\n\tconst { isMobile } = useLayout();\n\tconst sendOnEnterBehavior = useUserPreference<'normal' | 'alternative' | 'desktop'>('sendOnEnter') || isMobile;\n\tconst sendOnEnter = sendOnEnterBehavior == null || sendOnEnterBehavior === 'normal' || (sendOnEnterBehavior === 'desktop' && !isMobile);\n\n\tif (!chat) {\n\t\tthrow new Error('Chat context not found');\n\t}\n\n\tconst textareaRef = useRef<HTMLTextAreaElement>(null);\n\tconst messageComposerRef = useRef<HTMLElement>(null);\n\tconst shadowRef = useRef<HTMLDivElement>(null);\n\n\tconst storageID = `messagebox_${room._id}${tmid ? `-${tmid}` : ''}`;\n\n\tconst callbackRef = useCallback(\n\t\t(node: HTMLTextAreaElement) => {\n\t\t\tif (node === null || chat.composer) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tchat.setComposerAPI(createComposerAPI(node, storageID));\n\t\t},\n\t\t[chat, storageID],\n\t);\n\n\tconst autofocusRef = useMessageBoxAutoFocus(!isMobile);\n\n\tconst useEmojis = useUserPreference<boolean>('useEmojis');\n\n\tconst handleOpenEmojiPicker: MouseEventHandler<HTMLElement> = useMutableCallback((e) => {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\n\t\tif (!useEmojis) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst ref = messageComposerRef.current as HTMLElement;\n\t\tchat.emojiPicker.open(ref, (emoji: string) => chat.composer?.insertText(` :${emoji}: `));\n\t});\n\n\tconst handleSendMessage = useMutableCallback(() => {\n\t\tconst text = chat.composer?.text ?? '';\n\t\tchat.composer?.clear();\n\t\tclearPopup();\n\n\t\tonSend?.({\n\t\t\tvalue: text,\n\t\t\ttshow,\n\t\t\tpreviewUrls,\n\t\t\tisSlashCommandAllowed,\n\t\t});\n\t});\n\n\tconst closeEditing = (event: KeyboardEvent | MouseEvent<HTMLElement>) => {\n\t\tif (chat.currentEditing) {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\n\t\t\tchat.currentEditing.reset().then((reset) => {\n\t\t\t\tif (!reset) {\n\t\t\t\t\tchat.currentEditing?.cancel();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\tconst handler = useMutableCallback((event: KeyboardEvent) => {\n\t\tconst { which: keyCode } = event;\n\n\t\tconst input = event.target as HTMLTextAreaElement;\n\n\t\tconst isSubmitKey = keyCode === keyCodes.CARRIAGE_RETURN || keyCode === keyCodes.NEW_LINE;\n\n\t\tif (isSubmitKey) {\n\t\t\tconst withModifier = event.shiftKey || event.ctrlKey || event.altKey || event.metaKey;\n\t\t\tconst isSending = (sendOnEnter && !withModifier) || (!sendOnEnter && withModifier);\n\n\t\t\tevent.preventDefault();\n\t\t\tif (!isSending) {\n\t\t\t\tchat.composer?.insertNewLine();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\thandleSendMessage();\n\t\t\treturn false;\n\t\t}\n\n\t\tif (chat.composer && handleFormattingShortcut(event, [...formattingButtons], chat.composer)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.shiftKey || event.ctrlKey || event.metaKey) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (event.key) {\n\t\t\tcase 'Escape': {\n\t\t\t\tcloseEditing(event);\n\t\t\t\tif (!input.value.trim()) onEscape?.();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcase 'ArrowUp': {\n\t\t\t\tif (input.selectionEnd === 0) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\n\t\t\t\t\tonNavigateToPreviousMessage?.();\n\n\t\t\t\t\tif (event.altKey) {\n\t\t\t\t\t\tinput.setSelectionRange(0, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcase 'ArrowDown': {\n\t\t\t\tif (input.selectionEnd === input.value.length) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\n\t\t\t\t\tonNavigateToNextMessage?.();\n\n\t\t\t\t\tif (event.altKey) {\n\t\t\t\t\t\tinput.setSelectionRange(input.value.length, input.value.length);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tonTyping?.();\n\t});\n\n\tconst isEditing = useSubscription({\n\t\tgetCurrentValue: chat.composer?.editing.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.editing.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecordingAudio = useSubscription({\n\t\tgetCurrentValue: chat.composer?.recording.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.recording.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isMicrophoneDenied = useSubscription({\n\t\tgetCurrentValue: chat.composer?.isMicrophoneDenied.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.isMicrophoneDenied.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecordingVideo = useSubscription({\n\t\tgetCurrentValue: chat.composer?.recordingVideo.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.recordingVideo.subscribe ?? emptySubscribe,\n\t});\n\n\tconst formatters = useSubscription({\n\t\tgetCurrentValue: chat.composer?.formatters.get ?? getEmptyArray,\n\t\tsubscribe: chat.composer?.formatters.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecording = isRecordingAudio || isRecordingVideo;\n\n\tconst { textAreaStyle, shadowStyle } = useAutoGrow(textareaRef, shadowRef, isRecordingAudio);\n\n\tconst canSend = useReactiveValue(useCallback(() => roomCoordinator.verifyCanSendMessage(room._id), [room._id]));\n\n\tconst sizes = useContentBoxSize(textareaRef);\n\n\tconst format = useFormatDateAndTime();\n\n\tconst joinMutation = useMutation(async () => onJoin?.());\n\n\tconst handlePaste: ClipboardEventHandler<HTMLTextAreaElement> = useMutableCallback((event) => {\n\t\tconst { clipboardData } = event;\n\n\t\tif (!clipboardData) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst items = Array.from(clipboardData.items);\n\n\t\tif (items.some(({ kind, type }) => kind === 'string' && type === 'text/plain')) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst files = items\n\t\t\t.filter((item) => item.kind === 'file' && item.type.indexOf('image/') !== -1)\n\t\t\t.map((item) => {\n\t\t\t\tconst fileItem = item.getAsFile();\n\n\t\t\t\tif (!fileItem) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst imageExtension = fileItem ? getImageExtensionFromMime(fileItem.type) : undefined;\n\n\t\t\t\tconst extension = imageExtension ? `.${imageExtension}` : '';\n\n\t\t\t\tObject.defineProperty(fileItem, 'name', {\n\t\t\t\t\twritable: true,\n\t\t\t\t\tvalue: `Clipboard - ${format(new Date())}${extension}`,\n\t\t\t\t});\n\t\t\t\treturn fileItem;\n\t\t\t})\n\t\t\t.filter((file): file is File => !!file);\n\n\t\tif (files.length) {\n\t\t\tevent.preventDefault();\n\t\t\tonUploadFiles?.(files);\n\t\t}\n\t});\n\n\tconst composerPopupConfig = useComposerPopup();\n\n\tconst {\n\t\tpopup,\n\t\tfocused,\n\t\titems,\n\t\tariaActiveDescendant,\n\t\tsuspended,\n\t\tselect,\n\t\tcommandsRef,\n\t\tcallbackRef: c,\n\t\tfilter,\n\t\tclearPopup,\n\t} = useComposerBoxPopup<{ _id: string; sort?: number }>({\n\t\tconfigurations: composerPopupConfig,\n\t});\n\n\tconst keyDownHandlerCallbackRef = useCallback(\n\t\t(node: HTMLTextAreaElement) => {\n\t\t\tif (node === null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tnode.addEventListener('keydown', (e: KeyboardEvent) => {\n\t\t\t\thandler(e);\n\t\t\t});\n\t\t},\n\t\t[handler],\n\t);\n\n\tconst mergedRefs = useMessageComposerMergedRefs(c, textareaRef, callbackRef, autofocusRef, keyDownHandlerCallbackRef);\n\n\tconst shouldPopupPreview = useEnablePopupPreview(filter, popup);\n\n\treturn (\n\t\t<>\n\t\t\t{chat.composer?.quotedMessages && <MessageBoxReplies />}\n\t\t\t{shouldPopupPreview && popup && (\n\t\t\t\t<ComposerBoxPopup select={select} items={items} focused={focused} title={popup.title} renderItem={popup.renderItem} />\n\t\t\t)}\n\t\t\t{/*\n\t\t\t\tSlashCommand Preview popup works in a weird way\n\t\t\t\tThere is only one trigger for all the commands: \"/\"\n\t\t\t\tAfter that we need to the slashcommand list and check if the command exists and provide the preview\n\t\t\t\tif not the query is `suspend` which means the slashcommand is not found or doesn't have a preview\n\t\t\t*/}\n\t\t\t{popup?.preview && (\n\t\t\t\t<ComposerBoxPopupPreview\n\t\t\t\t\tselect={select}\n\t\t\t\t\titems={items as any}\n\t\t\t\t\tfocused={focused as any}\n\t\t\t\t\trenderItem={popup.renderItem}\n\t\t\t\t\tref={commandsRef}\n\t\t\t\t\trid={room._id}\n\t\t\t\t\ttmid={tmid}\n\t\t\t\t\tsuspended={suspended}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t<MessageBoxHint\n\t\t\t\tisEditing={isEditing}\n\t\t\t\te2eEnabled={e2eEnabled}\n\t\t\t\tunencryptedMessagesAllowed={unencryptedMessagesAllowed}\n\t\t\t\tisMobile={isMobile}\n\t\t\t/>\n\t\t\t{isRecordingVideo && <VideoMessageRecorder reference={messageComposerRef} rid={room._id} tmid={tmid} />}\n\t\t\t<MessageComposer ref={messageComposerRef} variant={isEditing ? 'editing' : undefined}>\n\t\t\t\t{isRecordingAudio && <AudioMessageRecorder rid={room._id} isMicrophoneDenied={isMicrophoneDenied} />}\n\t\t\t\t<MessageComposerInput\n\t\t\t\t\tref={mergedRefs}\n\t\t\t\t\taria-label={composerPlaceholder}\n\t\t\t\t\tname='msg'\n\t\t\t\t\tdisabled={isRecording || !canSend}\n\t\t\t\t\tonChange={setTyping}\n\t\t\t\t\tstyle={textAreaStyle}\n\t\t\t\t\tplaceholder={composerPlaceholder}\n\t\t\t\t\tonPaste={handlePaste}\n\t\t\t\t\taria-activedescendant={ariaActiveDescendant}\n\t\t\t\t/>\n\t\t\t\t<div ref={shadowRef} style={shadowStyle} />\n\t\t\t\t<MessageComposerToolbar>\n\t\t\t\t\t<MessageComposerToolbarActions aria-label={t('Message_composer_toolbox_primary_actions')}>\n\t\t\t\t\t\t<MessageComposerAction\n\t\t\t\t\t\t\ticon='emoji'\n\t\t\t\t\t\t\tdisabled={!useEmojis || isRecording || !canSend}\n\t\t\t\t\t\t\tonClick={handleOpenEmojiPicker}\n\t\t\t\t\t\t\ttitle={t('Emoji')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<MessageComposerActionsDivider />\n\t\t\t\t\t\t{chat.composer && formatters.length > 0 && (\n\t\t\t\t\t\t\t<MessageBoxFormattingToolbar\n\t\t\t\t\t\t\t\tcomposer={chat.composer}\n\t\t\t\t\t\t\t\tvariant={sizes.inlineSize < 480 ? 'small' : 'large'}\n\t\t\t\t\t\t\t\titems={formatters}\n\t\t\t\t\t\t\t\tdisabled={isRecording || !canSend}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<MessageBoxActionsToolbar\n\t\t\t\t\t\t\tcanSend={canSend}\n\t\t\t\t\t\t\ttyping={typing}\n\t\t\t\t\t\t\tisMicrophoneDenied={isMicrophoneDenied}\n\t\t\t\t\t\t\trid={room._id}\n\t\t\t\t\t\t\ttmid={tmid}\n\t\t\t\t\t\t\tisRecording={isRecording}\n\t\t\t\t\t\t\tvariant={sizes.inlineSize < 480 ? 'small' : 'large'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</MessageComposerToolbarActions>\n\t\t\t\t\t<MessageComposerToolbarSubmit>\n\t\t\t\t\t\t{!canSend && (\n\t\t\t\t\t\t\t<MessageComposerButton primary onClick={onJoin} loading={joinMutation.isLoading}>\n\t\t\t\t\t\t\t\t{t('Join')}\n\t\t\t\t\t\t\t</MessageComposerButton>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{canSend && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{isEditing && <MessageComposerButton onClick={closeEditing}>{t('Cancel')}</MessageComposerButton>}\n\t\t\t\t\t\t\t\t<MessageComposerAction\n\t\t\t\t\t\t\t\t\taria-label={t('Send')}\n\t\t\t\t\t\t\t\t\ticon='send'\n\t\t\t\t\t\t\t\t\tdisabled={!canSend || (!typing && !isEditing)}\n\t\t\t\t\t\t\t\t\tonClick={handleSendMessage}\n\t\t\t\t\t\t\t\t\tsecondary={typing || isEditing}\n\t\t\t\t\t\t\t\t\tinfo={typing || isEditing}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</MessageComposerToolbarSubmit>\n\t\t\t\t</MessageComposerToolbar>\n\t\t\t</MessageComposer>\n\t\t\t<ComposerUserActionIndicator rid={room._id} tmid={tmid} />\n\t\t</>\n\t);\n};\n\nexport default memo(MessageBox);\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBox.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/composer/messageBox/MessageBox.tsx","inputSourceMap":{"version":3,"file":"client/views/room/composer/messageBox/MessageBox.tsx","sourceRoot":"","sources":["client/views/room/composer/messageBox/MessageBox.tsx"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable complexity */\nimport type { IMessage, ISubscription } from '@rocket.chat/core-typings';\nimport { useContentBoxSize, useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport {\n\tMessageComposerAction,\n\tMessageComposerToolbarActions,\n\tMessageComposer,\n\tMessageComposerInput,\n\tMessageComposerToolbar,\n\tMessageComposerActionsDivider,\n\tMessageComposerToolbarSubmit,\n\tMessageComposerButton,\n} from '@rocket.chat/ui-composer';\nimport { useTranslation, useUserPreference, useLayout, useSetting } from '@rocket.chat/ui-contexts';\nimport { useMutation } from '@tanstack/react-query';\nimport type { ReactElement, MouseEventHandler, FormEvent, ClipboardEventHandler, MouseEvent } from 'react';\nimport React, { memo, useRef, useReducer, useCallback } from 'react';\nimport { useSubscription } from 'use-subscription';\n\nimport { createComposerAPI } from '../../../../../app/ui-message/client/messageBox/createComposerAPI';\nimport type { FormattingButton } from '../../../../../app/ui-message/client/messageBox/messageBoxFormatting';\nimport { formattingButtons } from '../../../../../app/ui-message/client/messageBox/messageBoxFormatting';\nimport { getImageExtensionFromMime } from '../../../../../lib/getImageExtensionFromMime';\nimport { useFormatDateAndTime } from '../../../../hooks/useFormatDateAndTime';\nimport { useReactiveValue } from '../../../../hooks/useReactiveValue';\nimport type { ComposerAPI } from '../../../../lib/chats/ChatAPI';\nimport { roomCoordinator } from '../../../../lib/rooms/roomCoordinator';\nimport { keyCodes } from '../../../../lib/utils/keyCodes';\nimport AudioMessageRecorder from '../../../composer/AudioMessageRecorder';\nimport VideoMessageRecorder from '../../../composer/VideoMessageRecorder';\nimport { useChat } from '../../contexts/ChatContext';\nimport { useComposerPopup } from '../../contexts/ComposerPopupContext';\nimport { useRoom } from '../../contexts/RoomContext';\nimport ComposerBoxPopup from '../ComposerBoxPopup';\nimport ComposerBoxPopupPreview from '../ComposerBoxPopupPreview';\nimport ComposerUserActionIndicator from '../ComposerUserActionIndicator';\nimport { useAutoGrow } from '../RoomComposer/hooks/useAutoGrow';\nimport { useComposerBoxPopup } from '../hooks/useComposerBoxPopup';\nimport { useEnablePopupPreview } from '../hooks/useEnablePopupPreview';\nimport { useMessageComposerMergedRefs } from '../hooks/useMessageComposerMergedRefs';\nimport MessageBoxActionsToolbar from './MessageBoxActionsToolbar';\nimport MessageBoxFormattingToolbar from './MessageBoxFormattingToolbar';\nimport MessageBoxHint from './MessageBoxHint';\nimport MessageBoxReplies from './MessageBoxReplies';\nimport { useMessageBoxAutoFocus } from './hooks/useMessageBoxAutoFocus';\nimport { useMessageBoxPlaceholder } from './hooks/useMessageBoxPlaceholder';\n\nconst reducer = (_: unknown, event: FormEvent<HTMLInputElement>): boolean => {\n\tconst target = event.target as HTMLInputElement;\n\n\treturn Boolean(target.value.trim());\n};\n\nconst handleFormattingShortcut = (event: KeyboardEvent, formattingButtons: FormattingButton[], composer: ComposerAPI) => {\n\tconst isMacOS = navigator.platform.indexOf('Mac') !== -1;\n\tconst isCmdOrCtrlPressed = (isMacOS && event.metaKey) || (!isMacOS && event.ctrlKey);\n\n\tif (!isCmdOrCtrlPressed) {\n\t\treturn false;\n\t}\n\n\tconst key = event.key.toLowerCase();\n\n\tconst formatter = formattingButtons.find((formatter) => 'command' in formatter && formatter.command === key);\n\n\tif (!formatter || !('pattern' in formatter)) {\n\t\treturn false;\n\t}\n\n\tcomposer.wrapSelection(formatter.pattern);\n\treturn true;\n};\n\nconst emptySubscribe = () => () => undefined;\nconst getEmptyFalse = () => false;\nconst a: any[] = [];\nconst getEmptyArray = () => a;\n\ntype MessageBoxProps = {\n\ttmid?: IMessage['_id'];\n\tonSend?: (params: { value: string; tshow?: boolean; previewUrls?: string[]; isSlashCommandAllowed?: boolean }) => Promise<void>;\n\tonJoin?: () => Promise<void>;\n\tonResize?: () => void;\n\tonTyping?: () => void;\n\tonEscape?: () => void;\n\tonNavigateToPreviousMessage?: () => void;\n\tonNavigateToNextMessage?: () => void;\n\tonUploadFiles?: (files: readonly File[]) => void;\n\ttshow?: IMessage['tshow'];\n\tpreviewUrls?: string[];\n\tsubscription?: ISubscription;\n\tshowFormattingTips: boolean;\n\tisEmbedded?: boolean;\n};\n\nconst MessageBox = ({\n\ttmid,\n\tonSend,\n\tonJoin,\n\tonNavigateToNextMessage,\n\tonNavigateToPreviousMessage,\n\tonUploadFiles,\n\tonEscape,\n\tonTyping,\n\ttshow,\n\tpreviewUrls,\n}: MessageBoxProps): ReactElement => {\n\tconst chat = useChat();\n\tconst room = useRoom();\n\tconst t = useTranslation();\n\tconst e2eEnabled = useSetting<boolean>('E2E_Enable');\n\tconst unencryptedMessagesAllowed = useSetting<boolean>('E2E_Allow_Unencrypted_Messages');\n\tconst isSlashCommandAllowed = !e2eEnabled || !room.encrypted || unencryptedMessagesAllowed;\n\tconst composerPlaceholder = useMessageBoxPlaceholder(t('Message'), room);\n\n\tconst [typing, setTyping] = useReducer(reducer, false);\n\n\tconst { isMobile } = useLayout();\n\tconst sendOnEnterBehavior = useUserPreference<'normal' | 'alternative' | 'desktop'>('sendOnEnter') || isMobile;\n\tconst sendOnEnter = sendOnEnterBehavior == null || sendOnEnterBehavior === 'normal' || (sendOnEnterBehavior === 'desktop' && !isMobile);\n\n\tif (!chat) {\n\t\tthrow new Error('Chat context not found');\n\t}\n\n\tconst textareaRef = useRef<HTMLTextAreaElement>(null);\n\tconst messageComposerRef = useRef<HTMLElement>(null);\n\tconst shadowRef = useRef<HTMLDivElement>(null);\n\n\tconst storageID = `messagebox_${room._id}${tmid ? `-${tmid}` : ''}`;\n\n\tconst callbackRef = useCallback(\n\t\t(node: HTMLTextAreaElement) => {\n\t\t\tif (node === null || chat.composer) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tchat.setComposerAPI(createComposerAPI(node, storageID));\n\t\t},\n\t\t[chat, storageID],\n\t);\n\n\tconst autofocusRef = useMessageBoxAutoFocus(!isMobile);\n\n\tconst useEmojis = useUserPreference<boolean>('useEmojis');\n\n\tconst handleOpenEmojiPicker: MouseEventHandler<HTMLElement> = useMutableCallback((e) => {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\n\t\tif (!useEmojis) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst ref = messageComposerRef.current as HTMLElement;\n\t\tchat.emojiPicker.open(ref, (emoji: string) => chat.composer?.insertText(` :${emoji}: `));\n\t});\n\n\tconst handleSendMessage = useMutableCallback(() => {\n\t\tconst text = chat.composer?.text ?? '';\n\t\tchat.composer?.clear();\n\t\tclearPopup();\n\n\t\tonSend?.({\n\t\t\tvalue: text,\n\t\t\ttshow,\n\t\t\tpreviewUrls,\n\t\t\tisSlashCommandAllowed,\n\t\t});\n\t});\n\n\tconst closeEditing = (event: KeyboardEvent | MouseEvent<HTMLElement>) => {\n\t\tif (chat.currentEditing) {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\n\t\t\tchat.currentEditing.reset().then((reset) => {\n\t\t\t\tif (!reset) {\n\t\t\t\t\tchat.currentEditing?.cancel();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\tconst handler = useMutableCallback((event: KeyboardEvent) => {\n\t\tconst { which: keyCode } = event;\n\n\t\tconst input = event.target as HTMLTextAreaElement;\n\n\t\tconst isSubmitKey = keyCode === keyCodes.CARRIAGE_RETURN || keyCode === keyCodes.NEW_LINE;\n\n\t\tif (isSubmitKey) {\n\t\t\tconst withModifier = event.shiftKey || event.ctrlKey || event.altKey || event.metaKey;\n\t\t\tconst isSending = (sendOnEnter && !withModifier) || (!sendOnEnter && withModifier);\n\n\t\t\tevent.preventDefault();\n\t\t\tif (!isSending) {\n\t\t\t\tchat.composer?.insertNewLine();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\thandleSendMessage();\n\t\t\treturn false;\n\t\t}\n\n\t\tif (chat.composer && handleFormattingShortcut(event, [...formattingButtons], chat.composer)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.shiftKey || event.ctrlKey || event.metaKey) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (event.key) {\n\t\t\tcase 'Escape': {\n\t\t\t\tcloseEditing(event);\n\t\t\t\tif (!input.value.trim()) onEscape?.();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcase 'ArrowUp': {\n\t\t\t\tif (input.selectionEnd === 0) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\n\t\t\t\t\tonNavigateToPreviousMessage?.();\n\n\t\t\t\t\tif (event.altKey) {\n\t\t\t\t\t\tinput.setSelectionRange(0, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcase 'ArrowDown': {\n\t\t\t\tif (input.selectionEnd === input.value.length) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\n\t\t\t\t\tonNavigateToNextMessage?.();\n\n\t\t\t\t\tif (event.altKey) {\n\t\t\t\t\t\tinput.setSelectionRange(input.value.length, input.value.length);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tonTyping?.();\n\t});\n\n\tconst isEditing = useSubscription({\n\t\tgetCurrentValue: chat.composer?.editing.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.editing.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecordingAudio = useSubscription({\n\t\tgetCurrentValue: chat.composer?.recording.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.recording.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isMicrophoneDenied = useSubscription({\n\t\tgetCurrentValue: chat.composer?.isMicrophoneDenied.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.isMicrophoneDenied.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecordingVideo = useSubscription({\n\t\tgetCurrentValue: chat.composer?.recordingVideo.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.recordingVideo.subscribe ?? emptySubscribe,\n\t});\n\n\tconst formatters = useSubscription({\n\t\tgetCurrentValue: chat.composer?.formatters.get ?? getEmptyArray,\n\t\tsubscribe: chat.composer?.formatters.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecording = isRecordingAudio || isRecordingVideo;\n\n\tconst { textAreaStyle, shadowStyle } = useAutoGrow(textareaRef, shadowRef, isRecordingAudio);\n\n\tconst canSend = useReactiveValue(useCallback(() => roomCoordinator.verifyCanSendMessage(room._id), [room._id]));\n\n\tconst sizes = useContentBoxSize(textareaRef);\n\n\tconst format = useFormatDateAndTime();\n\n\tconst joinMutation = useMutation(async () => onJoin?.());\n\n\tconst handlePaste: ClipboardEventHandler<HTMLTextAreaElement> = useMutableCallback((event) => {\n\t\tconst { clipboardData } = event;\n\n\t\tif (!clipboardData) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst items = Array.from(clipboardData.items);\n\n\t\tif (items.some(({ kind, type }) => kind === 'string' && type === 'text/plain')) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst files = items\n\t\t\t.filter((item) => item.kind === 'file' && item.type.indexOf('image/') !== -1)\n\t\t\t.map((item) => {\n\t\t\t\tconst fileItem = item.getAsFile();\n\n\t\t\t\tif (!fileItem) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst imageExtension = fileItem ? getImageExtensionFromMime(fileItem.type) : undefined;\n\n\t\t\t\tconst extension = imageExtension ? `.${imageExtension}` : '';\n\n\t\t\t\tObject.defineProperty(fileItem, 'name', {\n\t\t\t\t\twritable: true,\n\t\t\t\t\tvalue: `Clipboard - ${format(new Date())}${extension}`,\n\t\t\t\t});\n\t\t\t\treturn fileItem;\n\t\t\t})\n\t\t\t.filter((file): file is File => !!file);\n\n\t\tif (files.length) {\n\t\t\tevent.preventDefault();\n\t\t\tonUploadFiles?.(files);\n\t\t}\n\t});\n\n\tconst composerPopupConfig = useComposerPopup();\n\n\tconst {\n\t\tpopup,\n\t\tfocused,\n\t\titems,\n\t\tariaActiveDescendant,\n\t\tsuspended,\n\t\tselect,\n\t\tcommandsRef,\n\t\tcallbackRef: c,\n\t\tfilter,\n\t\tclearPopup,\n\t} = useComposerBoxPopup<{ _id: string; sort?: number }>({\n\t\tconfigurations: composerPopupConfig,\n\t});\n\n\tconst keyDownHandlerCallbackRef = useCallback(\n\t\t(node: HTMLTextAreaElement) => {\n\t\t\tif (node === null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tnode.addEventListener('keydown', (e: KeyboardEvent) => {\n\t\t\t\thandler(e);\n\t\t\t});\n\t\t},\n\t\t[handler],\n\t);\n\n\tconst mergedRefs = useMessageComposerMergedRefs(c, textareaRef, callbackRef, autofocusRef, keyDownHandlerCallbackRef);\n\n\tconst shouldPopupPreview = useEnablePopupPreview(filter, popup);\n\n\treturn (\n\t\t<>\n\t\t\t{chat.composer?.quotedMessages && <MessageBoxReplies />}\n\t\t\t{shouldPopupPreview && popup && (\n\t\t\t\t<ComposerBoxPopup select={select} items={items} focused={focused} title={popup.title} renderItem={popup.renderItem} />\n\t\t\t)}\n\t\t\t{/*\n\t\t\t\tSlashCommand Preview popup works in a weird way\n\t\t\t\tThere is only one trigger for all the commands: \"/\"\n\t\t\t\tAfter that we need to the slashcommand list and check if the command exists and provide the preview\n\t\t\t\tif not the query is `suspend` which means the slashcommand is not found or doesn't have a preview\n\t\t\t*/}\n\t\t\t{popup?.preview && (\n\t\t\t\t<ComposerBoxPopupPreview\n\t\t\t\t\tselect={select}\n\t\t\t\t\titems={items as any}\n\t\t\t\t\tfocused={focused as any}\n\t\t\t\t\trenderItem={popup.renderItem}\n\t\t\t\t\tref={commandsRef}\n\t\t\t\t\trid={room._id}\n\t\t\t\t\ttmid={tmid}\n\t\t\t\t\tsuspended={suspended}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t<MessageBoxHint\n\t\t\t\tisEditing={isEditing}\n\t\t\t\te2eEnabled={e2eEnabled}\n\t\t\t\tunencryptedMessagesAllowed={unencryptedMessagesAllowed}\n\t\t\t\tisMobile={isMobile}\n\t\t\t/>\n\t\t\t{isRecordingVideo && <VideoMessageRecorder reference={messageComposerRef} rid={room._id} tmid={tmid} />}\n\t\t\t<MessageComposer ref={messageComposerRef} variant={isEditing ? 'editing' : undefined}>\n\t\t\t\t{isRecordingAudio && <AudioMessageRecorder rid={room._id} isMicrophoneDenied={isMicrophoneDenied} />}\n\t\t\t\t<MessageComposerInput\n\t\t\t\t\tref={mergedRefs}\n\t\t\t\t\taria-label={composerPlaceholder}\n\t\t\t\t\tname='msg'\n\t\t\t\t\tdisabled={isRecording || !canSend}\n\t\t\t\t\tonChange={setTyping}\n\t\t\t\t\tstyle={textAreaStyle}\n\t\t\t\t\tplaceholder={composerPlaceholder}\n\t\t\t\t\tonPaste={handlePaste}\n\t\t\t\t\taria-activedescendant={ariaActiveDescendant}\n\t\t\t\t/>\n\t\t\t\t<div ref={shadowRef} style={shadowStyle} />\n\t\t\t\t<MessageComposerToolbar>\n\t\t\t\t\t<MessageComposerToolbarActions aria-label={t('Message_composer_toolbox_primary_actions')}>\n\t\t\t\t\t\t<MessageComposerAction\n\t\t\t\t\t\t\ticon='emoji'\n\t\t\t\t\t\t\tdisabled={!useEmojis || isRecording || !canSend}\n\t\t\t\t\t\t\tonClick={handleOpenEmojiPicker}\n\t\t\t\t\t\t\ttitle={t('Emoji')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<MessageComposerActionsDivider />\n\t\t\t\t\t\t{chat.composer && formatters.length > 0 && (\n\t\t\t\t\t\t\t<MessageBoxFormattingToolbar\n\t\t\t\t\t\t\t\tcomposer={chat.composer}\n\t\t\t\t\t\t\t\tvariant={sizes.inlineSize < 480 ? 'small' : 'large'}\n\t\t\t\t\t\t\t\titems={formatters}\n\t\t\t\t\t\t\t\tdisabled={isRecording || !canSend}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<MessageBoxActionsToolbar\n\t\t\t\t\t\t\tcanSend={canSend}\n\t\t\t\t\t\t\ttyping={typing}\n\t\t\t\t\t\t\tisMicrophoneDenied={isMicrophoneDenied}\n\t\t\t\t\t\t\trid={room._id}\n\t\t\t\t\t\t\ttmid={tmid}\n\t\t\t\t\t\t\tisRecording={isRecording}\n\t\t\t\t\t\t\tvariant={sizes.inlineSize < 480 ? 'small' : 'large'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</MessageComposerToolbarActions>\n\t\t\t\t\t<MessageComposerToolbarSubmit>\n\t\t\t\t\t\t{!canSend && (\n\t\t\t\t\t\t\t<MessageComposerButton primary onClick={onJoin} loading={joinMutation.isLoading}>\n\t\t\t\t\t\t\t\t{t('Join')}\n\t\t\t\t\t\t\t</MessageComposerButton>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{canSend && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{isEditing && <MessageComposerButton onClick={closeEditing}>{t('Cancel')}</MessageComposerButton>}\n\t\t\t\t\t\t\t\t<MessageComposerAction\n\t\t\t\t\t\t\t\t\taria-label={t('Send')}\n\t\t\t\t\t\t\t\t\ticon='send'\n\t\t\t\t\t\t\t\t\tdisabled={!canSend || (!typing && !isEditing)}\n\t\t\t\t\t\t\t\t\tonClick={handleSendMessage}\n\t\t\t\t\t\t\t\t\tsecondary={typing || isEditing}\n\t\t\t\t\t\t\t\t\tinfo={typing || isEditing}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</MessageComposerToolbarSubmit>\n\t\t\t\t</MessageComposerToolbar>\n\t\t\t</MessageComposer>\n\t\t\t<ComposerUserActionIndicator rid={room._id} tmid={tmid} />\n\t\t</>\n\t);\n};\n\nexport default memo(MessageBox);\n"]}}},"code":"let useContentBoxSize, useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useContentBoxSize(v) {\n    useContentBoxSize = v;\n  },\n  useMutableCallback(v) {\n    useMutableCallback = v;\n  }\n}, 0);\nlet MessageComposerAction, MessageComposerToolbarActions, MessageComposer, MessageComposerInput, MessageComposerToolbar, MessageComposerActionsDivider, MessageComposerToolbarSubmit, MessageComposerButton;\nmodule.link(\"@rocket.chat/ui-composer\", {\n  MessageComposerAction(v) {\n    MessageComposerAction = v;\n  },\n  MessageComposerToolbarActions(v) {\n    MessageComposerToolbarActions = v;\n  },\n  MessageComposer(v) {\n    MessageComposer = v;\n  },\n  MessageComposerInput(v) {\n    MessageComposerInput = v;\n  },\n  MessageComposerToolbar(v) {\n    MessageComposerToolbar = v;\n  },\n  MessageComposerActionsDivider(v) {\n    MessageComposerActionsDivider = v;\n  },\n  MessageComposerToolbarSubmit(v) {\n    MessageComposerToolbarSubmit = v;\n  },\n  MessageComposerButton(v) {\n    MessageComposerButton = v;\n  }\n}, 1);\nlet useTranslation, useUserPreference, useLayout, useSetting;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useTranslation(v) {\n    useTranslation = v;\n  },\n  useUserPreference(v) {\n    useUserPreference = v;\n  },\n  useLayout(v) {\n    useLayout = v;\n  },\n  useSetting(v) {\n    useSetting = v;\n  }\n}, 2);\nlet useMutation;\nmodule.link(\"@tanstack/react-query\", {\n  useMutation(v) {\n    useMutation = v;\n  }\n}, 3);\nlet React, memo, useRef, useReducer, useCallback;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n  memo(v) {\n    memo = v;\n  },\n  useRef(v) {\n    useRef = v;\n  },\n  useReducer(v) {\n    useReducer = v;\n  },\n  useCallback(v) {\n    useCallback = v;\n  }\n}, 4);\nlet useSubscription;\nmodule.link(\"use-subscription\", {\n  useSubscription(v) {\n    useSubscription = v;\n  }\n}, 5);\nlet createComposerAPI;\nmodule.link(\"../../../../../app/ui-message/client/messageBox/createComposerAPI\", {\n  createComposerAPI(v) {\n    createComposerAPI = v;\n  }\n}, 6);\nlet formattingButtons;\nmodule.link(\"../../../../../app/ui-message/client/messageBox/messageBoxFormatting\", {\n  formattingButtons(v) {\n    formattingButtons = v;\n  }\n}, 7);\nlet getImageExtensionFromMime;\nmodule.link(\"../../../../../lib/getImageExtensionFromMime\", {\n  getImageExtensionFromMime(v) {\n    getImageExtensionFromMime = v;\n  }\n}, 8);\nlet useFormatDateAndTime;\nmodule.link(\"../../../../hooks/useFormatDateAndTime\", {\n  useFormatDateAndTime(v) {\n    useFormatDateAndTime = v;\n  }\n}, 9);\nlet useReactiveValue;\nmodule.link(\"../../../../hooks/useReactiveValue\", {\n  useReactiveValue(v) {\n    useReactiveValue = v;\n  }\n}, 10);\nlet roomCoordinator;\nmodule.link(\"../../../../lib/rooms/roomCoordinator\", {\n  roomCoordinator(v) {\n    roomCoordinator = v;\n  }\n}, 11);\nlet keyCodes;\nmodule.link(\"../../../../lib/utils/keyCodes\", {\n  keyCodes(v) {\n    keyCodes = v;\n  }\n}, 12);\nlet AudioMessageRecorder;\nmodule.link(\"../../../composer/AudioMessageRecorder\", {\n  default(v) {\n    AudioMessageRecorder = v;\n  }\n}, 13);\nlet VideoMessageRecorder;\nmodule.link(\"../../../composer/VideoMessageRecorder\", {\n  default(v) {\n    VideoMessageRecorder = v;\n  }\n}, 14);\nlet useChat;\nmodule.link(\"../../contexts/ChatContext\", {\n  useChat(v) {\n    useChat = v;\n  }\n}, 15);\nlet useComposerPopup;\nmodule.link(\"../../contexts/ComposerPopupContext\", {\n  useComposerPopup(v) {\n    useComposerPopup = v;\n  }\n}, 16);\nlet useRoom;\nmodule.link(\"../../contexts/RoomContext\", {\n  useRoom(v) {\n    useRoom = v;\n  }\n}, 17);\nlet ComposerBoxPopup;\nmodule.link(\"../ComposerBoxPopup\", {\n  default(v) {\n    ComposerBoxPopup = v;\n  }\n}, 18);\nlet ComposerBoxPopupPreview;\nmodule.link(\"../ComposerBoxPopupPreview\", {\n  default(v) {\n    ComposerBoxPopupPreview = v;\n  }\n}, 19);\nlet ComposerUserActionIndicator;\nmodule.link(\"../ComposerUserActionIndicator\", {\n  default(v) {\n    ComposerUserActionIndicator = v;\n  }\n}, 20);\nlet useAutoGrow;\nmodule.link(\"../RoomComposer/hooks/useAutoGrow\", {\n  useAutoGrow(v) {\n    useAutoGrow = v;\n  }\n}, 21);\nlet useComposerBoxPopup;\nmodule.link(\"../hooks/useComposerBoxPopup\", {\n  useComposerBoxPopup(v) {\n    useComposerBoxPopup = v;\n  }\n}, 22);\nlet useEnablePopupPreview;\nmodule.link(\"../hooks/useEnablePopupPreview\", {\n  useEnablePopupPreview(v) {\n    useEnablePopupPreview = v;\n  }\n}, 23);\nlet useMessageComposerMergedRefs;\nmodule.link(\"../hooks/useMessageComposerMergedRefs\", {\n  useMessageComposerMergedRefs(v) {\n    useMessageComposerMergedRefs = v;\n  }\n}, 24);\nlet MessageBoxActionsToolbar;\nmodule.link(\"./MessageBoxActionsToolbar\", {\n  default(v) {\n    MessageBoxActionsToolbar = v;\n  }\n}, 25);\nlet MessageBoxFormattingToolbar;\nmodule.link(\"./MessageBoxFormattingToolbar\", {\n  default(v) {\n    MessageBoxFormattingToolbar = v;\n  }\n}, 26);\nlet MessageBoxHint;\nmodule.link(\"./MessageBoxHint\", {\n  default(v) {\n    MessageBoxHint = v;\n  }\n}, 27);\nlet MessageBoxReplies;\nmodule.link(\"./MessageBoxReplies\", {\n  default(v) {\n    MessageBoxReplies = v;\n  }\n}, 28);\nlet useMessageBoxAutoFocus;\nmodule.link(\"./hooks/useMessageBoxAutoFocus\", {\n  useMessageBoxAutoFocus(v) {\n    useMessageBoxAutoFocus = v;\n  }\n}, 29);\nlet useMessageBoxPlaceholder;\nmodule.link(\"./hooks/useMessageBoxPlaceholder\", {\n  useMessageBoxPlaceholder(v) {\n    useMessageBoxPlaceholder = v;\n  }\n}, 30);\nconst reducer = (_, event) => {\n  const target = event.target;\n  return Boolean(target.value.trim());\n};\nconst handleFormattingShortcut = (event, formattingButtons, composer) => {\n  const isMacOS = navigator.platform.indexOf('Mac') !== -1;\n  const isCmdOrCtrlPressed = isMacOS && event.metaKey || !isMacOS && event.ctrlKey;\n  if (!isCmdOrCtrlPressed) {\n    return false;\n  }\n  const key = event.key.toLowerCase();\n  const formatter = formattingButtons.find(formatter => 'command' in formatter && formatter.command === key);\n  if (!formatter || !('pattern' in formatter)) {\n    return false;\n  }\n  composer.wrapSelection(formatter.pattern);\n  return true;\n};\nconst emptySubscribe = () => () => undefined;\nconst getEmptyFalse = () => false;\nconst a = [];\nconst getEmptyArray = () => a;\nconst MessageBox = _ref => {\n  var _chat$composer$editin, _chat$composer5, _chat$composer$editin2, _chat$composer6, _chat$composer$record, _chat$composer7, _chat$composer$record2, _chat$composer8, _chat$composer$isMicr, _chat$composer9, _chat$composer$isMicr2, _chat$composer10, _chat$composer$record3, _chat$composer11, _chat$composer$record4, _chat$composer12, _chat$composer$format, _chat$composer13, _chat$composer$format2, _chat$composer14, _chat$composer15;\n  let {\n    tmid,\n    onSend,\n    onJoin,\n    onNavigateToNextMessage,\n    onNavigateToPreviousMessage,\n    onUploadFiles,\n    onEscape,\n    onTyping,\n    tshow,\n    previewUrls\n  } = _ref;\n  const chat = useChat();\n  const room = useRoom();\n  const t = useTranslation();\n  const e2eEnabled = useSetting('E2E_Enable');\n  const unencryptedMessagesAllowed = useSetting('E2E_Allow_Unencrypted_Messages');\n  const isSlashCommandAllowed = !e2eEnabled || !room.encrypted || unencryptedMessagesAllowed;\n  const composerPlaceholder = useMessageBoxPlaceholder(t('Message'), room);\n  const [typing, setTyping] = useReducer(reducer, false);\n  const {\n    isMobile\n  } = useLayout();\n  const sendOnEnterBehavior = useUserPreference('sendOnEnter') || isMobile;\n  const sendOnEnter = sendOnEnterBehavior == null || sendOnEnterBehavior === 'normal' || sendOnEnterBehavior === 'desktop' && !isMobile;\n  if (!chat) {\n    throw new Error('Chat context not found');\n  }\n  const textareaRef = useRef(null);\n  const messageComposerRef = useRef(null);\n  const shadowRef = useRef(null);\n  const storageID = \"messagebox_\".concat(room._id).concat(tmid ? \"-\".concat(tmid) : '');\n  const callbackRef = useCallback(node => {\n    if (node === null || chat.composer) {\n      return;\n    }\n    chat.setComposerAPI(createComposerAPI(node, storageID));\n  }, [chat, storageID]);\n  const autofocusRef = useMessageBoxAutoFocus(!isMobile);\n  const useEmojis = useUserPreference('useEmojis');\n  const handleOpenEmojiPicker = useMutableCallback(e => {\n    e.stopPropagation();\n    e.preventDefault();\n    if (!useEmojis) {\n      return;\n    }\n    const ref = messageComposerRef.current;\n    chat.emojiPicker.open(ref, emoji => {\n      var _chat$composer;\n      return (_chat$composer = chat.composer) === null || _chat$composer === void 0 ? void 0 : _chat$composer.insertText(\" :\".concat(emoji, \": \"));\n    });\n  });\n  const handleSendMessage = useMutableCallback(() => {\n    var _chat$composer$text, _chat$composer2, _chat$composer3;\n    const text = (_chat$composer$text = (_chat$composer2 = chat.composer) === null || _chat$composer2 === void 0 ? void 0 : _chat$composer2.text) !== null && _chat$composer$text !== void 0 ? _chat$composer$text : '';\n    (_chat$composer3 = chat.composer) === null || _chat$composer3 === void 0 ? void 0 : _chat$composer3.clear();\n    clearPopup();\n    onSend === null || onSend === void 0 ? void 0 : onSend({\n      value: text,\n      tshow,\n      previewUrls,\n      isSlashCommandAllowed\n    });\n  });\n  const closeEditing = event => {\n    if (chat.currentEditing) {\n      event.preventDefault();\n      event.stopPropagation();\n      chat.currentEditing.reset().then(reset => {\n        if (!reset) {\n          var _chat$currentEditing;\n          (_chat$currentEditing = chat.currentEditing) === null || _chat$currentEditing === void 0 ? void 0 : _chat$currentEditing.cancel();\n        }\n      });\n    }\n  };\n  const handler = useMutableCallback(event => {\n    const {\n      which: keyCode\n    } = event;\n    const input = event.target;\n    const isSubmitKey = keyCode === keyCodes.CARRIAGE_RETURN || keyCode === keyCodes.NEW_LINE;\n    if (isSubmitKey) {\n      const withModifier = event.shiftKey || event.ctrlKey || event.altKey || event.metaKey;\n      const isSending = sendOnEnter && !withModifier || !sendOnEnter && withModifier;\n      event.preventDefault();\n      if (!isSending) {\n        var _chat$composer4;\n        (_chat$composer4 = chat.composer) === null || _chat$composer4 === void 0 ? void 0 : _chat$composer4.insertNewLine();\n        return false;\n      }\n      handleSendMessage();\n      return false;\n    }\n    if (chat.composer && handleFormattingShortcut(event, [...formattingButtons], chat.composer)) {\n      return;\n    }\n    if (event.shiftKey || event.ctrlKey || event.metaKey) {\n      return;\n    }\n    switch (event.key) {\n      case 'Escape':\n        {\n          closeEditing(event);\n          if (!input.value.trim()) onEscape === null || onEscape === void 0 ? void 0 : onEscape();\n          return;\n        }\n      case 'ArrowUp':\n        {\n          if (input.selectionEnd === 0) {\n            event.preventDefault();\n            event.stopPropagation();\n            onNavigateToPreviousMessage === null || onNavigateToPreviousMessage === void 0 ? void 0 : onNavigateToPreviousMessage();\n            if (event.altKey) {\n              input.setSelectionRange(0, 0);\n            }\n          }\n          return;\n        }\n      case 'ArrowDown':\n        {\n          if (input.selectionEnd === input.value.length) {\n            event.preventDefault();\n            event.stopPropagation();\n            onNavigateToNextMessage === null || onNavigateToNextMessage === void 0 ? void 0 : onNavigateToNextMessage();\n            if (event.altKey) {\n              input.setSelectionRange(input.value.length, input.value.length);\n            }\n          }\n        }\n    }\n    onTyping === null || onTyping === void 0 ? void 0 : onTyping();\n  });\n  const isEditing = useSubscription({\n    getCurrentValue: (_chat$composer$editin = (_chat$composer5 = chat.composer) === null || _chat$composer5 === void 0 ? void 0 : _chat$composer5.editing.get) !== null && _chat$composer$editin !== void 0 ? _chat$composer$editin : getEmptyFalse,\n    subscribe: (_chat$composer$editin2 = (_chat$composer6 = chat.composer) === null || _chat$composer6 === void 0 ? void 0 : _chat$composer6.editing.subscribe) !== null && _chat$composer$editin2 !== void 0 ? _chat$composer$editin2 : emptySubscribe\n  });\n  const isRecordingAudio = useSubscription({\n    getCurrentValue: (_chat$composer$record = (_chat$composer7 = chat.composer) === null || _chat$composer7 === void 0 ? void 0 : _chat$composer7.recording.get) !== null && _chat$composer$record !== void 0 ? _chat$composer$record : getEmptyFalse,\n    subscribe: (_chat$composer$record2 = (_chat$composer8 = chat.composer) === null || _chat$composer8 === void 0 ? void 0 : _chat$composer8.recording.subscribe) !== null && _chat$composer$record2 !== void 0 ? _chat$composer$record2 : emptySubscribe\n  });\n  const isMicrophoneDenied = useSubscription({\n    getCurrentValue: (_chat$composer$isMicr = (_chat$composer9 = chat.composer) === null || _chat$composer9 === void 0 ? void 0 : _chat$composer9.isMicrophoneDenied.get) !== null && _chat$composer$isMicr !== void 0 ? _chat$composer$isMicr : getEmptyFalse,\n    subscribe: (_chat$composer$isMicr2 = (_chat$composer10 = chat.composer) === null || _chat$composer10 === void 0 ? void 0 : _chat$composer10.isMicrophoneDenied.subscribe) !== null && _chat$composer$isMicr2 !== void 0 ? _chat$composer$isMicr2 : emptySubscribe\n  });\n  const isRecordingVideo = useSubscription({\n    getCurrentValue: (_chat$composer$record3 = (_chat$composer11 = chat.composer) === null || _chat$composer11 === void 0 ? void 0 : _chat$composer11.recordingVideo.get) !== null && _chat$composer$record3 !== void 0 ? _chat$composer$record3 : getEmptyFalse,\n    subscribe: (_chat$composer$record4 = (_chat$composer12 = chat.composer) === null || _chat$composer12 === void 0 ? void 0 : _chat$composer12.recordingVideo.subscribe) !== null && _chat$composer$record4 !== void 0 ? _chat$composer$record4 : emptySubscribe\n  });\n  const formatters = useSubscription({\n    getCurrentValue: (_chat$composer$format = (_chat$composer13 = chat.composer) === null || _chat$composer13 === void 0 ? void 0 : _chat$composer13.formatters.get) !== null && _chat$composer$format !== void 0 ? _chat$composer$format : getEmptyArray,\n    subscribe: (_chat$composer$format2 = (_chat$composer14 = chat.composer) === null || _chat$composer14 === void 0 ? void 0 : _chat$composer14.formatters.subscribe) !== null && _chat$composer$format2 !== void 0 ? _chat$composer$format2 : emptySubscribe\n  });\n  const isRecording = isRecordingAudio || isRecordingVideo;\n  const {\n    textAreaStyle,\n    shadowStyle\n  } = useAutoGrow(textareaRef, shadowRef, isRecordingAudio);\n  const canSend = useReactiveValue(useCallback(() => roomCoordinator.verifyCanSendMessage(room._id), [room._id]));\n  const sizes = useContentBoxSize(textareaRef);\n  const format = useFormatDateAndTime();\n  const joinMutation = useMutation(async () => onJoin === null || onJoin === void 0 ? void 0 : onJoin());\n  const handlePaste = useMutableCallback(event => {\n    const {\n      clipboardData\n    } = event;\n    if (!clipboardData) {\n      return;\n    }\n    const items = Array.from(clipboardData.items);\n    if (items.some(_ref2 => {\n      let {\n        kind,\n        type\n      } = _ref2;\n      return kind === 'string' && type === 'text/plain';\n    })) {\n      return;\n    }\n    const files = items.filter(item => item.kind === 'file' && item.type.indexOf('image/') !== -1).map(item => {\n      const fileItem = item.getAsFile();\n      if (!fileItem) {\n        return;\n      }\n      const imageExtension = fileItem ? getImageExtensionFromMime(fileItem.type) : undefined;\n      const extension = imageExtension ? \".\".concat(imageExtension) : '';\n      Object.defineProperty(fileItem, 'name', {\n        writable: true,\n        value: \"Clipboard - \".concat(format(new Date())).concat(extension)\n      });\n      return fileItem;\n    }).filter(file => !!file);\n    if (files.length) {\n      event.preventDefault();\n      onUploadFiles === null || onUploadFiles === void 0 ? void 0 : onUploadFiles(files);\n    }\n  });\n  const composerPopupConfig = useComposerPopup();\n  const {\n    popup,\n    focused,\n    items,\n    ariaActiveDescendant,\n    suspended,\n    select,\n    commandsRef,\n    callbackRef: c,\n    filter,\n    clearPopup\n  } = useComposerBoxPopup({\n    configurations: composerPopupConfig\n  });\n  const keyDownHandlerCallbackRef = useCallback(node => {\n    if (node === null) {\n      return;\n    }\n    node.addEventListener('keydown', e => {\n      handler(e);\n    });\n  }, [handler]);\n  const mergedRefs = useMessageComposerMergedRefs(c, textareaRef, callbackRef, autofocusRef, keyDownHandlerCallbackRef);\n  const shouldPopupPreview = useEnablePopupPreview(filter, popup);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, ((_chat$composer15 = chat.composer) === null || _chat$composer15 === void 0 ? void 0 : _chat$composer15.quotedMessages) && /*#__PURE__*/React.createElement(MessageBoxReplies, null), shouldPopupPreview && popup && /*#__PURE__*/React.createElement(ComposerBoxPopup, {\n    select: select,\n    items: items,\n    focused: focused,\n    title: popup.title,\n    renderItem: popup.renderItem\n  }), (popup === null || popup === void 0 ? void 0 : popup.preview) && /*#__PURE__*/React.createElement(ComposerBoxPopupPreview, {\n    select: select,\n    items: items,\n    focused: focused,\n    renderItem: popup.renderItem,\n    ref: commandsRef,\n    rid: room._id,\n    tmid: tmid,\n    suspended: suspended\n  }), /*#__PURE__*/React.createElement(MessageBoxHint, {\n    isEditing: isEditing,\n    e2eEnabled: e2eEnabled,\n    unencryptedMessagesAllowed: unencryptedMessagesAllowed,\n    isMobile: isMobile\n  }), isRecordingVideo && /*#__PURE__*/React.createElement(VideoMessageRecorder, {\n    reference: messageComposerRef,\n    rid: room._id,\n    tmid: tmid\n  }), /*#__PURE__*/React.createElement(MessageComposer, {\n    ref: messageComposerRef,\n    variant: isEditing ? 'editing' : undefined\n  }, isRecordingAudio && /*#__PURE__*/React.createElement(AudioMessageRecorder, {\n    rid: room._id,\n    isMicrophoneDenied: isMicrophoneDenied\n  }), /*#__PURE__*/React.createElement(MessageComposerInput, {\n    ref: mergedRefs,\n    \"aria-label\": composerPlaceholder,\n    name: \"msg\",\n    disabled: isRecording || !canSend,\n    onChange: setTyping,\n    style: textAreaStyle,\n    placeholder: composerPlaceholder,\n    onPaste: handlePaste,\n    \"aria-activedescendant\": ariaActiveDescendant\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    ref: shadowRef,\n    style: shadowStyle\n  }), /*#__PURE__*/React.createElement(MessageComposerToolbar, null, /*#__PURE__*/React.createElement(MessageComposerToolbarActions, {\n    \"aria-label\": t('Message_composer_toolbox_primary_actions')\n  }, /*#__PURE__*/React.createElement(MessageComposerAction, {\n    icon: \"emoji\",\n    disabled: !useEmojis || isRecording || !canSend,\n    onClick: handleOpenEmojiPicker,\n    title: t('Emoji')\n  }), /*#__PURE__*/React.createElement(MessageComposerActionsDivider, null), chat.composer && formatters.length > 0 && /*#__PURE__*/React.createElement(MessageBoxFormattingToolbar, {\n    composer: chat.composer,\n    variant: sizes.inlineSize < 480 ? 'small' : 'large',\n    items: formatters,\n    disabled: isRecording || !canSend\n  }), /*#__PURE__*/React.createElement(MessageBoxActionsToolbar, {\n    canSend: canSend,\n    typing: typing,\n    isMicrophoneDenied: isMicrophoneDenied,\n    rid: room._id,\n    tmid: tmid,\n    isRecording: isRecording,\n    variant: sizes.inlineSize < 480 ? 'small' : 'large'\n  })), /*#__PURE__*/React.createElement(MessageComposerToolbarSubmit, null, !canSend && /*#__PURE__*/React.createElement(MessageComposerButton, {\n    primary: true,\n    onClick: onJoin,\n    loading: joinMutation.isLoading\n  }, t('Join')), canSend && /*#__PURE__*/React.createElement(React.Fragment, null, isEditing && /*#__PURE__*/React.createElement(MessageComposerButton, {\n    onClick: closeEditing\n  }, t('Cancel')), /*#__PURE__*/React.createElement(MessageComposerAction, {\n    \"aria-label\": t('Send'),\n    icon: \"send\",\n    disabled: !canSend || !typing && !isEditing,\n    onClick: handleSendMessage,\n    secondary: typing || isEditing,\n    info: typing || isEditing\n  }))))), /*#__PURE__*/React.createElement(ComposerUserActionIndicator, {\n    rid: room._id,\n    tmid: tmid\n  }));\n};\nmodule.exportDefault( /*#__PURE__*/memo(MessageBox));","map":{"version":3,"names":["useContentBoxSize","useMutableCallback","module","link","v","MessageComposerAction","MessageComposerToolbarActions","MessageComposer","MessageComposerInput","MessageComposerToolbar","MessageComposerActionsDivider","MessageComposerToolbarSubmit","MessageComposerButton","useTranslation","useUserPreference","useLayout","useSetting","useMutation","React","memo","useRef","useReducer","useCallback","default","useSubscription","createComposerAPI","formattingButtons","getImageExtensionFromMime","useFormatDateAndTime","useReactiveValue","roomCoordinator","keyCodes","AudioMessageRecorder","VideoMessageRecorder","useChat","useComposerPopup","useRoom","ComposerBoxPopup","ComposerBoxPopupPreview","ComposerUserActionIndicator","useAutoGrow","useComposerBoxPopup","useEnablePopupPreview","useMessageComposerMergedRefs","MessageBoxActionsToolbar","MessageBoxFormattingToolbar","MessageBoxHint","MessageBoxReplies","useMessageBoxAutoFocus","useMessageBoxPlaceholder","reducer","_","event","target","Boolean","value","trim","handleFormattingShortcut","composer","isMacOS","navigator","platform","indexOf","isCmdOrCtrlPressed","metaKey","ctrlKey","key","toLowerCase","formatter","find","command","wrapSelection","pattern","emptySubscribe","undefined","getEmptyFalse","a","getEmptyArray","MessageBox","_ref","_chat$composer$editin","_chat$composer5","_chat$composer$editin2","_chat$composer6","_chat$composer$record","_chat$composer7","_chat$composer$record2","_chat$composer8","_chat$composer$isMicr","_chat$composer9","_chat$composer$isMicr2","_chat$composer10","_chat$composer$record3","_chat$composer11","_chat$composer$record4","_chat$composer12","_chat$composer$format","_chat$composer13","_chat$composer$format2","_chat$composer14","_chat$composer15","tmid","onSend","onJoin","onNavigateToNextMessage","onNavigateToPreviousMessage","onUploadFiles","onEscape","onTyping","tshow","previewUrls","chat","room","t","e2eEnabled","unencryptedMessagesAllowed","isSlashCommandAllowed","encrypted","composerPlaceholder","typing","setTyping","isMobile","sendOnEnterBehavior","sendOnEnter","Error","textareaRef","messageComposerRef","shadowRef","storageID","concat","_id","callbackRef","node","setComposerAPI","autofocusRef","useEmojis","handleOpenEmojiPicker","e","stopPropagation","preventDefault","ref","current","emojiPicker","open","emoji","_chat$composer","insertText","handleSendMessage","_chat$composer$text","_chat$composer2","_chat$composer3","text","clear","clearPopup","closeEditing","currentEditing","reset","then","_chat$currentEditing","cancel","handler","which","keyCode","input","isSubmitKey","CARRIAGE_RETURN","NEW_LINE","withModifier","shiftKey","altKey","isSending","_chat$composer4","insertNewLine","selectionEnd","setSelectionRange","length","isEditing","getCurrentValue","editing","get","subscribe","isRecordingAudio","recording","isMicrophoneDenied","isRecordingVideo","recordingVideo","formatters","isRecording","textAreaStyle","shadowStyle","canSend","verifyCanSendMessage","sizes","format","joinMutation","handlePaste","clipboardData","items","Array","from","some","_ref2","kind","type","files","filter","item","map","fileItem","getAsFile","imageExtension","extension","Object","defineProperty","writable","Date","file","composerPopupConfig","popup","focused","ariaActiveDescendant","suspended","select","commandsRef","c","configurations","keyDownHandlerCallbackRef","addEventListener","mergedRefs","shouldPopupPreview","createElement","Fragment","quotedMessages","title","renderItem","preview","rid","reference","variant","name","disabled","onChange","style","placeholder","onPaste","icon","onClick","inlineSize","primary","loading","isLoading","secondary","info","exportDefault"],"sources":["client/views/room/composer/messageBox/MessageBox.tsx"],"sourcesContent":["/* eslint-disable complexity */\nimport type { IMessage, ISubscription } from '@rocket.chat/core-typings';\nimport { useContentBoxSize, useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport {\n\tMessageComposerAction,\n\tMessageComposerToolbarActions,\n\tMessageComposer,\n\tMessageComposerInput,\n\tMessageComposerToolbar,\n\tMessageComposerActionsDivider,\n\tMessageComposerToolbarSubmit,\n\tMessageComposerButton,\n} from '@rocket.chat/ui-composer';\nimport { useTranslation, useUserPreference, useLayout, useSetting } from '@rocket.chat/ui-contexts';\nimport { useMutation } from '@tanstack/react-query';\nimport type { ReactElement, MouseEventHandler, FormEvent, ClipboardEventHandler, MouseEvent } from 'react';\nimport React, { memo, useRef, useReducer, useCallback } from 'react';\nimport { useSubscription } from 'use-subscription';\n\nimport { createComposerAPI } from '../../../../../app/ui-message/client/messageBox/createComposerAPI';\nimport type { FormattingButton } from '../../../../../app/ui-message/client/messageBox/messageBoxFormatting';\nimport { formattingButtons } from '../../../../../app/ui-message/client/messageBox/messageBoxFormatting';\nimport { getImageExtensionFromMime } from '../../../../../lib/getImageExtensionFromMime';\nimport { useFormatDateAndTime } from '../../../../hooks/useFormatDateAndTime';\nimport { useReactiveValue } from '../../../../hooks/useReactiveValue';\nimport type { ComposerAPI } from '../../../../lib/chats/ChatAPI';\nimport { roomCoordinator } from '../../../../lib/rooms/roomCoordinator';\nimport { keyCodes } from '../../../../lib/utils/keyCodes';\nimport AudioMessageRecorder from '../../../composer/AudioMessageRecorder';\nimport VideoMessageRecorder from '../../../composer/VideoMessageRecorder';\nimport { useChat } from '../../contexts/ChatContext';\nimport { useComposerPopup } from '../../contexts/ComposerPopupContext';\nimport { useRoom } from '../../contexts/RoomContext';\nimport ComposerBoxPopup from '../ComposerBoxPopup';\nimport ComposerBoxPopupPreview from '../ComposerBoxPopupPreview';\nimport ComposerUserActionIndicator from '../ComposerUserActionIndicator';\nimport { useAutoGrow } from '../RoomComposer/hooks/useAutoGrow';\nimport { useComposerBoxPopup } from '../hooks/useComposerBoxPopup';\nimport { useEnablePopupPreview } from '../hooks/useEnablePopupPreview';\nimport { useMessageComposerMergedRefs } from '../hooks/useMessageComposerMergedRefs';\nimport MessageBoxActionsToolbar from './MessageBoxActionsToolbar';\nimport MessageBoxFormattingToolbar from './MessageBoxFormattingToolbar';\nimport MessageBoxHint from './MessageBoxHint';\nimport MessageBoxReplies from './MessageBoxReplies';\nimport { useMessageBoxAutoFocus } from './hooks/useMessageBoxAutoFocus';\nimport { useMessageBoxPlaceholder } from './hooks/useMessageBoxPlaceholder';\n\nconst reducer = (_: unknown, event: FormEvent<HTMLInputElement>): boolean => {\n\tconst target = event.target as HTMLInputElement;\n\n\treturn Boolean(target.value.trim());\n};\n\nconst handleFormattingShortcut = (event: KeyboardEvent, formattingButtons: FormattingButton[], composer: ComposerAPI) => {\n\tconst isMacOS = navigator.platform.indexOf('Mac') !== -1;\n\tconst isCmdOrCtrlPressed = (isMacOS && event.metaKey) || (!isMacOS && event.ctrlKey);\n\n\tif (!isCmdOrCtrlPressed) {\n\t\treturn false;\n\t}\n\n\tconst key = event.key.toLowerCase();\n\n\tconst formatter = formattingButtons.find((formatter) => 'command' in formatter && formatter.command === key);\n\n\tif (!formatter || !('pattern' in formatter)) {\n\t\treturn false;\n\t}\n\n\tcomposer.wrapSelection(formatter.pattern);\n\treturn true;\n};\n\nconst emptySubscribe = () => () => undefined;\nconst getEmptyFalse = () => false;\nconst a: any[] = [];\nconst getEmptyArray = () => a;\n\ntype MessageBoxProps = {\n\ttmid?: IMessage['_id'];\n\tonSend?: (params: { value: string; tshow?: boolean; previewUrls?: string[]; isSlashCommandAllowed?: boolean }) => Promise<void>;\n\tonJoin?: () => Promise<void>;\n\tonResize?: () => void;\n\tonTyping?: () => void;\n\tonEscape?: () => void;\n\tonNavigateToPreviousMessage?: () => void;\n\tonNavigateToNextMessage?: () => void;\n\tonUploadFiles?: (files: readonly File[]) => void;\n\ttshow?: IMessage['tshow'];\n\tpreviewUrls?: string[];\n\tsubscription?: ISubscription;\n\tshowFormattingTips: boolean;\n\tisEmbedded?: boolean;\n};\n\nconst MessageBox = ({\n\ttmid,\n\tonSend,\n\tonJoin,\n\tonNavigateToNextMessage,\n\tonNavigateToPreviousMessage,\n\tonUploadFiles,\n\tonEscape,\n\tonTyping,\n\ttshow,\n\tpreviewUrls,\n}: MessageBoxProps): ReactElement => {\n\tconst chat = useChat();\n\tconst room = useRoom();\n\tconst t = useTranslation();\n\tconst e2eEnabled = useSetting<boolean>('E2E_Enable');\n\tconst unencryptedMessagesAllowed = useSetting<boolean>('E2E_Allow_Unencrypted_Messages');\n\tconst isSlashCommandAllowed = !e2eEnabled || !room.encrypted || unencryptedMessagesAllowed;\n\tconst composerPlaceholder = useMessageBoxPlaceholder(t('Message'), room);\n\n\tconst [typing, setTyping] = useReducer(reducer, false);\n\n\tconst { isMobile } = useLayout();\n\tconst sendOnEnterBehavior = useUserPreference<'normal' | 'alternative' | 'desktop'>('sendOnEnter') || isMobile;\n\tconst sendOnEnter = sendOnEnterBehavior == null || sendOnEnterBehavior === 'normal' || (sendOnEnterBehavior === 'desktop' && !isMobile);\n\n\tif (!chat) {\n\t\tthrow new Error('Chat context not found');\n\t}\n\n\tconst textareaRef = useRef<HTMLTextAreaElement>(null);\n\tconst messageComposerRef = useRef<HTMLElement>(null);\n\tconst shadowRef = useRef<HTMLDivElement>(null);\n\n\tconst storageID = `messagebox_${room._id}${tmid ? `-${tmid}` : ''}`;\n\n\tconst callbackRef = useCallback(\n\t\t(node: HTMLTextAreaElement) => {\n\t\t\tif (node === null || chat.composer) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tchat.setComposerAPI(createComposerAPI(node, storageID));\n\t\t},\n\t\t[chat, storageID],\n\t);\n\n\tconst autofocusRef = useMessageBoxAutoFocus(!isMobile);\n\n\tconst useEmojis = useUserPreference<boolean>('useEmojis');\n\n\tconst handleOpenEmojiPicker: MouseEventHandler<HTMLElement> = useMutableCallback((e) => {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\n\t\tif (!useEmojis) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst ref = messageComposerRef.current as HTMLElement;\n\t\tchat.emojiPicker.open(ref, (emoji: string) => chat.composer?.insertText(` :${emoji}: `));\n\t});\n\n\tconst handleSendMessage = useMutableCallback(() => {\n\t\tconst text = chat.composer?.text ?? '';\n\t\tchat.composer?.clear();\n\t\tclearPopup();\n\n\t\tonSend?.({\n\t\t\tvalue: text,\n\t\t\ttshow,\n\t\t\tpreviewUrls,\n\t\t\tisSlashCommandAllowed,\n\t\t});\n\t});\n\n\tconst closeEditing = (event: KeyboardEvent | MouseEvent<HTMLElement>) => {\n\t\tif (chat.currentEditing) {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\n\t\t\tchat.currentEditing.reset().then((reset) => {\n\t\t\t\tif (!reset) {\n\t\t\t\t\tchat.currentEditing?.cancel();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\tconst handler = useMutableCallback((event: KeyboardEvent) => {\n\t\tconst { which: keyCode } = event;\n\n\t\tconst input = event.target as HTMLTextAreaElement;\n\n\t\tconst isSubmitKey = keyCode === keyCodes.CARRIAGE_RETURN || keyCode === keyCodes.NEW_LINE;\n\n\t\tif (isSubmitKey) {\n\t\t\tconst withModifier = event.shiftKey || event.ctrlKey || event.altKey || event.metaKey;\n\t\t\tconst isSending = (sendOnEnter && !withModifier) || (!sendOnEnter && withModifier);\n\n\t\t\tevent.preventDefault();\n\t\t\tif (!isSending) {\n\t\t\t\tchat.composer?.insertNewLine();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\thandleSendMessage();\n\t\t\treturn false;\n\t\t}\n\n\t\tif (chat.composer && handleFormattingShortcut(event, [...formattingButtons], chat.composer)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.shiftKey || event.ctrlKey || event.metaKey) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (event.key) {\n\t\t\tcase 'Escape': {\n\t\t\t\tcloseEditing(event);\n\t\t\t\tif (!input.value.trim()) onEscape?.();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcase 'ArrowUp': {\n\t\t\t\tif (input.selectionEnd === 0) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\n\t\t\t\t\tonNavigateToPreviousMessage?.();\n\n\t\t\t\t\tif (event.altKey) {\n\t\t\t\t\t\tinput.setSelectionRange(0, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcase 'ArrowDown': {\n\t\t\t\tif (input.selectionEnd === input.value.length) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\n\t\t\t\t\tonNavigateToNextMessage?.();\n\n\t\t\t\t\tif (event.altKey) {\n\t\t\t\t\t\tinput.setSelectionRange(input.value.length, input.value.length);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tonTyping?.();\n\t});\n\n\tconst isEditing = useSubscription({\n\t\tgetCurrentValue: chat.composer?.editing.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.editing.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecordingAudio = useSubscription({\n\t\tgetCurrentValue: chat.composer?.recording.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.recording.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isMicrophoneDenied = useSubscription({\n\t\tgetCurrentValue: chat.composer?.isMicrophoneDenied.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.isMicrophoneDenied.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecordingVideo = useSubscription({\n\t\tgetCurrentValue: chat.composer?.recordingVideo.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.recordingVideo.subscribe ?? emptySubscribe,\n\t});\n\n\tconst formatters = useSubscription({\n\t\tgetCurrentValue: chat.composer?.formatters.get ?? getEmptyArray,\n\t\tsubscribe: chat.composer?.formatters.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecording = isRecordingAudio || isRecordingVideo;\n\n\tconst { textAreaStyle, shadowStyle } = useAutoGrow(textareaRef, shadowRef, isRecordingAudio);\n\n\tconst canSend = useReactiveValue(useCallback(() => roomCoordinator.verifyCanSendMessage(room._id), [room._id]));\n\n\tconst sizes = useContentBoxSize(textareaRef);\n\n\tconst format = useFormatDateAndTime();\n\n\tconst joinMutation = useMutation(async () => onJoin?.());\n\n\tconst handlePaste: ClipboardEventHandler<HTMLTextAreaElement> = useMutableCallback((event) => {\n\t\tconst { clipboardData } = event;\n\n\t\tif (!clipboardData) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst items = Array.from(clipboardData.items);\n\n\t\tif (items.some(({ kind, type }) => kind === 'string' && type === 'text/plain')) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst files = items\n\t\t\t.filter((item) => item.kind === 'file' && item.type.indexOf('image/') !== -1)\n\t\t\t.map((item) => {\n\t\t\t\tconst fileItem = item.getAsFile();\n\n\t\t\t\tif (!fileItem) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst imageExtension = fileItem ? getImageExtensionFromMime(fileItem.type) : undefined;\n\n\t\t\t\tconst extension = imageExtension ? `.${imageExtension}` : '';\n\n\t\t\t\tObject.defineProperty(fileItem, 'name', {\n\t\t\t\t\twritable: true,\n\t\t\t\t\tvalue: `Clipboard - ${format(new Date())}${extension}`,\n\t\t\t\t});\n\t\t\t\treturn fileItem;\n\t\t\t})\n\t\t\t.filter((file): file is File => !!file);\n\n\t\tif (files.length) {\n\t\t\tevent.preventDefault();\n\t\t\tonUploadFiles?.(files);\n\t\t}\n\t});\n\n\tconst composerPopupConfig = useComposerPopup();\n\n\tconst {\n\t\tpopup,\n\t\tfocused,\n\t\titems,\n\t\tariaActiveDescendant,\n\t\tsuspended,\n\t\tselect,\n\t\tcommandsRef,\n\t\tcallbackRef: c,\n\t\tfilter,\n\t\tclearPopup,\n\t} = useComposerBoxPopup<{ _id: string; sort?: number }>({\n\t\tconfigurations: composerPopupConfig,\n\t});\n\n\tconst keyDownHandlerCallbackRef = useCallback(\n\t\t(node: HTMLTextAreaElement) => {\n\t\t\tif (node === null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tnode.addEventListener('keydown', (e: KeyboardEvent) => {\n\t\t\t\thandler(e);\n\t\t\t});\n\t\t},\n\t\t[handler],\n\t);\n\n\tconst mergedRefs = useMessageComposerMergedRefs(c, textareaRef, callbackRef, autofocusRef, keyDownHandlerCallbackRef);\n\n\tconst shouldPopupPreview = useEnablePopupPreview(filter, popup);\n\n\treturn (\n\t\t<>\n\t\t\t{chat.composer?.quotedMessages && <MessageBoxReplies />}\n\t\t\t{shouldPopupPreview && popup && (\n\t\t\t\t<ComposerBoxPopup select={select} items={items} focused={focused} title={popup.title} renderItem={popup.renderItem} />\n\t\t\t)}\n\t\t\t{/*\n\t\t\t\tSlashCommand Preview popup works in a weird way\n\t\t\t\tThere is only one trigger for all the commands: \"/\"\n\t\t\t\tAfter that we need to the slashcommand list and check if the command exists and provide the preview\n\t\t\t\tif not the query is `suspend` which means the slashcommand is not found or doesn't have a preview\n\t\t\t*/}\n\t\t\t{popup?.preview && (\n\t\t\t\t<ComposerBoxPopupPreview\n\t\t\t\t\tselect={select}\n\t\t\t\t\titems={items as any}\n\t\t\t\t\tfocused={focused as any}\n\t\t\t\t\trenderItem={popup.renderItem}\n\t\t\t\t\tref={commandsRef}\n\t\t\t\t\trid={room._id}\n\t\t\t\t\ttmid={tmid}\n\t\t\t\t\tsuspended={suspended}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t<MessageBoxHint\n\t\t\t\tisEditing={isEditing}\n\t\t\t\te2eEnabled={e2eEnabled}\n\t\t\t\tunencryptedMessagesAllowed={unencryptedMessagesAllowed}\n\t\t\t\tisMobile={isMobile}\n\t\t\t/>\n\t\t\t{isRecordingVideo && <VideoMessageRecorder reference={messageComposerRef} rid={room._id} tmid={tmid} />}\n\t\t\t<MessageComposer ref={messageComposerRef} variant={isEditing ? 'editing' : undefined}>\n\t\t\t\t{isRecordingAudio && <AudioMessageRecorder rid={room._id} isMicrophoneDenied={isMicrophoneDenied} />}\n\t\t\t\t<MessageComposerInput\n\t\t\t\t\tref={mergedRefs}\n\t\t\t\t\taria-label={composerPlaceholder}\n\t\t\t\t\tname='msg'\n\t\t\t\t\tdisabled={isRecording || !canSend}\n\t\t\t\t\tonChange={setTyping}\n\t\t\t\t\tstyle={textAreaStyle}\n\t\t\t\t\tplaceholder={composerPlaceholder}\n\t\t\t\t\tonPaste={handlePaste}\n\t\t\t\t\taria-activedescendant={ariaActiveDescendant}\n\t\t\t\t/>\n\t\t\t\t<div ref={shadowRef} style={shadowStyle} />\n\t\t\t\t<MessageComposerToolbar>\n\t\t\t\t\t<MessageComposerToolbarActions aria-label={t('Message_composer_toolbox_primary_actions')}>\n\t\t\t\t\t\t<MessageComposerAction\n\t\t\t\t\t\t\ticon='emoji'\n\t\t\t\t\t\t\tdisabled={!useEmojis || isRecording || !canSend}\n\t\t\t\t\t\t\tonClick={handleOpenEmojiPicker}\n\t\t\t\t\t\t\ttitle={t('Emoji')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<MessageComposerActionsDivider />\n\t\t\t\t\t\t{chat.composer && formatters.length > 0 && (\n\t\t\t\t\t\t\t<MessageBoxFormattingToolbar\n\t\t\t\t\t\t\t\tcomposer={chat.composer}\n\t\t\t\t\t\t\t\tvariant={sizes.inlineSize < 480 ? 'small' : 'large'}\n\t\t\t\t\t\t\t\titems={formatters}\n\t\t\t\t\t\t\t\tdisabled={isRecording || !canSend}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<MessageBoxActionsToolbar\n\t\t\t\t\t\t\tcanSend={canSend}\n\t\t\t\t\t\t\ttyping={typing}\n\t\t\t\t\t\t\tisMicrophoneDenied={isMicrophoneDenied}\n\t\t\t\t\t\t\trid={room._id}\n\t\t\t\t\t\t\ttmid={tmid}\n\t\t\t\t\t\t\tisRecording={isRecording}\n\t\t\t\t\t\t\tvariant={sizes.inlineSize < 480 ? 'small' : 'large'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</MessageComposerToolbarActions>\n\t\t\t\t\t<MessageComposerToolbarSubmit>\n\t\t\t\t\t\t{!canSend && (\n\t\t\t\t\t\t\t<MessageComposerButton primary onClick={onJoin} loading={joinMutation.isLoading}>\n\t\t\t\t\t\t\t\t{t('Join')}\n\t\t\t\t\t\t\t</MessageComposerButton>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{canSend && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{isEditing && <MessageComposerButton onClick={closeEditing}>{t('Cancel')}</MessageComposerButton>}\n\t\t\t\t\t\t\t\t<MessageComposerAction\n\t\t\t\t\t\t\t\t\taria-label={t('Send')}\n\t\t\t\t\t\t\t\t\ticon='send'\n\t\t\t\t\t\t\t\t\tdisabled={!canSend || (!typing && !isEditing)}\n\t\t\t\t\t\t\t\t\tonClick={handleSendMessage}\n\t\t\t\t\t\t\t\t\tsecondary={typing || isEditing}\n\t\t\t\t\t\t\t\t\tinfo={typing || isEditing}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</MessageComposerToolbarSubmit>\n\t\t\t\t</MessageComposerToolbar>\n\t\t\t</MessageComposer>\n\t\t\t<ComposerUserActionIndicator rid={room._id} tmid={tmid} />\n\t\t</>\n\t);\n};\n\nexport default memo(MessageBox);\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"8b1fb86e18214516abf73723b03a3940b167d335"}
