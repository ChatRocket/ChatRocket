{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/hooks/useMessageListNavigation.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/room/hooks/useMessageListNavigation.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/hooks/useMessageListNavigation.ts","inputSourceMap":{"version":3,"file":"client/views/room/hooks/useMessageListNavigation.ts","sourceRoot":"","sources":["client/views/room/hooks/useMessageListNavigation.ts"],"names":[],"mappings":"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","sourcesContent":["import { createFocusManager } from '@react-aria/focus';\nimport type { RefCallback } from 'react';\nimport { useCallback } from 'react';\nimport { useFocusManager } from 'react-aria';\n\nconst isListItem = (node: EventTarget) =>\n\t(node as HTMLElement).getAttribute('role') === 'listitem' || (node as HTMLElement).getAttribute('role') === 'link';\nconst isMessageToolbarAction = (node: EventTarget) => (node as HTMLElement).parentElement?.getAttribute('role') === 'toolbar';\nconst isSystemMessage = (node: EventTarget) => (node as HTMLElement).classList.contains('rcx-message-system');\nconst isThreadMessage = (node: EventTarget) => (node as HTMLElement).classList.contains('rcx-message-thread');\n\n/**\n * Custom hook to provide the room navigation by keyboard.\n * @param ref - A ref to the message list DOM element.\n */\nexport const useMessageListNavigation = (): { messageListRef: RefCallback<HTMLElement> } => {\n\tconst roomFocusManager = useFocusManager();\n\n\tconst messageListRef = useCallback(\n\t\t(node: HTMLElement | null) => {\n\t\t\tlet lastMessageFocused: HTMLElement | null = null;\n\t\t\tlet initialFocus = true;\n\n\t\t\tif (!node) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst massageListFocusManager = createFocusManager({\n\t\t\t\tcurrent: node,\n\t\t\t});\n\n\t\t\tnode.addEventListener('keydown', (e) => {\n\t\t\t\tif (!e.target) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!isListItem(e.target)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (e.key === 'Tab') {\n\t\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\t\troomFocusManager.focusFirst({\n\t\t\t\t\t\t\tfrom: document.getElementsByClassName('rcx-room-header')[0],\n\t\t\t\t\t\t});\n\t\t\t\t\t} else if (isThreadMessage(e.target) || isSystemMessage(e.target) || isMessageToolbarAction(e.target)) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\t\troomFocusManager.focusNext({\n\t\t\t\t\t\t\taccept: (node) => node.tagName === 'TEXTAREA',\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (e.key === 'ArrowUp' || e.key === 'ArrowDown') {\n\t\t\t\t\tif (e.key === 'ArrowUp') {\n\t\t\t\t\t\tmassageListFocusManager.focusPrevious({ accept: (node) => isListItem(node) });\n\t\t\t\t\t}\n\n\t\t\t\t\tif (e.key === 'ArrowDown') {\n\t\t\t\t\t\tmassageListFocusManager.focusNext({ accept: (node) => isListItem(node) });\n\t\t\t\t\t}\n\n\t\t\t\t\tlastMessageFocused = document.activeElement as HTMLElement;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tnode.addEventListener(\n\t\t\t\t'blur',\n\t\t\t\t(e) => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t!(e.relatedTarget as HTMLElement)?.classList.contains('focus-visible') ||\n\t\t\t\t\t\t!(e.currentTarget instanceof HTMLElement && e.relatedTarget instanceof HTMLElement)\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!e.currentTarget.contains(e.relatedTarget) && !lastMessageFocused) {\n\t\t\t\t\t\tlastMessageFocused = e.target as HTMLElement;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{ capture: true },\n\t\t\t);\n\n\t\t\tnode.addEventListener(\n\t\t\t\t'focus',\n\t\t\t\t(e) => {\n\t\t\t\t\tconst triggeredByKeyboard = (e.target as HTMLElement)?.classList.contains('focus-visible');\n\t\t\t\t\tif (!triggeredByKeyboard || !(e.currentTarget instanceof HTMLElement && e.relatedTarget instanceof HTMLElement)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (initialFocus) {\n\t\t\t\t\t\tmassageListFocusManager.focusLast({ accept: (node) => isListItem(node) });\n\t\t\t\t\t\tlastMessageFocused = document.activeElement as HTMLElement;\n\t\t\t\t\t\tinitialFocus = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (lastMessageFocused && !e.currentTarget.contains(e.relatedTarget) && node.contains(e.target as HTMLElement)) {\n\t\t\t\t\t\tlastMessageFocused?.focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{ capture: true },\n\t\t\t);\n\t\t},\n\t\t[roomFocusManager],\n\t);\n\n\treturn {\n\t\tmessageListRef,\n\t};\n};\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/hooks/useMessageListNavigation.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/hooks/useMessageListNavigation.ts","inputSourceMap":{"version":3,"file":"client/views/room/hooks/useMessageListNavigation.ts","sourceRoot":"","sources":["client/views/room/hooks/useMessageListNavigation.ts"],"names":[],"mappings":"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","sourcesContent":["import { createFocusManager } from '@react-aria/focus';\nimport type { RefCallback } from 'react';\nimport { useCallback } from 'react';\nimport { useFocusManager } from 'react-aria';\n\nconst isListItem = (node: EventTarget) =>\n\t(node as HTMLElement).getAttribute('role') === 'listitem' || (node as HTMLElement).getAttribute('role') === 'link';\nconst isMessageToolbarAction = (node: EventTarget) => (node as HTMLElement).parentElement?.getAttribute('role') === 'toolbar';\nconst isSystemMessage = (node: EventTarget) => (node as HTMLElement).classList.contains('rcx-message-system');\nconst isThreadMessage = (node: EventTarget) => (node as HTMLElement).classList.contains('rcx-message-thread');\n\n/**\n * Custom hook to provide the room navigation by keyboard.\n * @param ref - A ref to the message list DOM element.\n */\nexport const useMessageListNavigation = (): { messageListRef: RefCallback<HTMLElement> } => {\n\tconst roomFocusManager = useFocusManager();\n\n\tconst messageListRef = useCallback(\n\t\t(node: HTMLElement | null) => {\n\t\t\tlet lastMessageFocused: HTMLElement | null = null;\n\t\t\tlet initialFocus = true;\n\n\t\t\tif (!node) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst massageListFocusManager = createFocusManager({\n\t\t\t\tcurrent: node,\n\t\t\t});\n\n\t\t\tnode.addEventListener('keydown', (e) => {\n\t\t\t\tif (!e.target) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!isListItem(e.target)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (e.key === 'Tab') {\n\t\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\t\troomFocusManager.focusFirst({\n\t\t\t\t\t\t\tfrom: document.getElementsByClassName('rcx-room-header')[0],\n\t\t\t\t\t\t});\n\t\t\t\t\t} else if (isThreadMessage(e.target) || isSystemMessage(e.target) || isMessageToolbarAction(e.target)) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\t\troomFocusManager.focusNext({\n\t\t\t\t\t\t\taccept: (node) => node.tagName === 'TEXTAREA',\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (e.key === 'ArrowUp' || e.key === 'ArrowDown') {\n\t\t\t\t\tif (e.key === 'ArrowUp') {\n\t\t\t\t\t\tmassageListFocusManager.focusPrevious({ accept: (node) => isListItem(node) });\n\t\t\t\t\t}\n\n\t\t\t\t\tif (e.key === 'ArrowDown') {\n\t\t\t\t\t\tmassageListFocusManager.focusNext({ accept: (node) => isListItem(node) });\n\t\t\t\t\t}\n\n\t\t\t\t\tlastMessageFocused = document.activeElement as HTMLElement;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tnode.addEventListener(\n\t\t\t\t'blur',\n\t\t\t\t(e) => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t!(e.relatedTarget as HTMLElement)?.classList.contains('focus-visible') ||\n\t\t\t\t\t\t!(e.currentTarget instanceof HTMLElement && e.relatedTarget instanceof HTMLElement)\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!e.currentTarget.contains(e.relatedTarget) && !lastMessageFocused) {\n\t\t\t\t\t\tlastMessageFocused = e.target as HTMLElement;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{ capture: true },\n\t\t\t);\n\n\t\t\tnode.addEventListener(\n\t\t\t\t'focus',\n\t\t\t\t(e) => {\n\t\t\t\t\tconst triggeredByKeyboard = (e.target as HTMLElement)?.classList.contains('focus-visible');\n\t\t\t\t\tif (!triggeredByKeyboard || !(e.currentTarget instanceof HTMLElement && e.relatedTarget instanceof HTMLElement)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (initialFocus) {\n\t\t\t\t\t\tmassageListFocusManager.focusLast({ accept: (node) => isListItem(node) });\n\t\t\t\t\t\tlastMessageFocused = document.activeElement as HTMLElement;\n\t\t\t\t\t\tinitialFocus = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (lastMessageFocused && !e.currentTarget.contains(e.relatedTarget) && node.contains(e.target as HTMLElement)) {\n\t\t\t\t\t\tlastMessageFocused?.focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{ capture: true },\n\t\t\t);\n\t\t},\n\t\t[roomFocusManager],\n\t);\n\n\treturn {\n\t\tmessageListRef,\n\t};\n};\n"]}}},"code":"module.export({\n  useMessageListNavigation: function () {\n    return useMessageListNavigation;\n  }\n});\nvar createFocusManager;\nmodule.link(\"@react-aria/focus\", {\n  createFocusManager: function (v) {\n    createFocusManager = v;\n  }\n}, 0);\nvar useCallback;\nmodule.link(\"react\", {\n  useCallback: function (v) {\n    useCallback = v;\n  }\n}, 1);\nvar useFocusManager;\nmodule.link(\"react-aria\", {\n  useFocusManager: function (v) {\n    useFocusManager = v;\n  }\n}, 2);\nvar isListItem = function (node) {\n  return node.getAttribute('role') === 'listitem' || node.getAttribute('role') === 'link';\n};\nvar isMessageToolbarAction = function (node) {\n  var _node$parentElement;\n  return ((_node$parentElement = node.parentElement) === null || _node$parentElement === void 0 ? void 0 : _node$parentElement.getAttribute('role')) === 'toolbar';\n};\nvar isSystemMessage = function (node) {\n  return node.classList.contains('rcx-message-system');\n};\nvar isThreadMessage = function (node) {\n  return node.classList.contains('rcx-message-thread');\n};\n/**\n * Custom hook to provide the room navigation by keyboard.\n * @param ref - A ref to the message list DOM element.\n */\nvar useMessageListNavigation = function () {\n  var roomFocusManager = useFocusManager();\n  var messageListRef = useCallback(function (node) {\n    var lastMessageFocused = null;\n    var initialFocus = true;\n    if (!node) {\n      return;\n    }\n    var massageListFocusManager = createFocusManager({\n      current: node\n    });\n    node.addEventListener('keydown', function (e) {\n      if (!e.target) {\n        return;\n      }\n      if (!isListItem(e.target)) {\n        return;\n      }\n      if (e.key === 'Tab') {\n        if (e.shiftKey) {\n          e.preventDefault();\n          e.stopPropagation();\n          roomFocusManager.focusFirst({\n            from: document.getElementsByClassName('rcx-room-header')[0]\n          });\n        } else if (isThreadMessage(e.target) || isSystemMessage(e.target) || isMessageToolbarAction(e.target)) {\n          e.preventDefault();\n          e.stopPropagation();\n          roomFocusManager.focusNext({\n            accept: function (node) {\n              return node.tagName === 'TEXTAREA';\n            }\n          });\n        }\n      }\n      if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {\n        if (e.key === 'ArrowUp') {\n          massageListFocusManager.focusPrevious({\n            accept: function (node) {\n              return isListItem(node);\n            }\n          });\n        }\n        if (e.key === 'ArrowDown') {\n          massageListFocusManager.focusNext({\n            accept: function (node) {\n              return isListItem(node);\n            }\n          });\n        }\n        lastMessageFocused = document.activeElement;\n      }\n    });\n    node.addEventListener('blur', function (e) {\n      var _e$relatedTarget;\n      if (!((_e$relatedTarget = e.relatedTarget) !== null && _e$relatedTarget !== void 0 && _e$relatedTarget.classList.contains('focus-visible')) || !(e.currentTarget instanceof HTMLElement && e.relatedTarget instanceof HTMLElement)) {\n        return;\n      }\n      if (!e.currentTarget.contains(e.relatedTarget) && !lastMessageFocused) {\n        lastMessageFocused = e.target;\n      }\n    }, {\n      capture: true\n    });\n    node.addEventListener('focus', function (e) {\n      var _e$target;\n      var triggeredByKeyboard = (_e$target = e.target) === null || _e$target === void 0 ? void 0 : _e$target.classList.contains('focus-visible');\n      if (!triggeredByKeyboard || !(e.currentTarget instanceof HTMLElement && e.relatedTarget instanceof HTMLElement)) {\n        return;\n      }\n      if (initialFocus) {\n        massageListFocusManager.focusLast({\n          accept: function (node) {\n            return isListItem(node);\n          }\n        });\n        lastMessageFocused = document.activeElement;\n        initialFocus = false;\n        return;\n      }\n      if (lastMessageFocused && !e.currentTarget.contains(e.relatedTarget) && node.contains(e.target)) {\n        var _lastMessageFocused;\n        (_lastMessageFocused = lastMessageFocused) === null || _lastMessageFocused === void 0 ? void 0 : _lastMessageFocused.focus();\n      }\n    }, {\n      capture: true\n    });\n  }, [roomFocusManager]);\n  return {\n    messageListRef: messageListRef\n  };\n};","map":{"version":3,"names":["module","export","useMessageListNavigation","createFocusManager","link","v","useCallback","useFocusManager","isListItem","node","getAttribute","isMessageToolbarAction","_node$parentElement","parentElement","isSystemMessage","classList","contains","isThreadMessage","roomFocusManager","messageListRef","lastMessageFocused","initialFocus","massageListFocusManager","current","addEventListener","e","target","key","shiftKey","preventDefault","stopPropagation","focusFirst","from","document","getElementsByClassName","focusNext","accept","tagName","focusPrevious","activeElement","_e$relatedTarget","relatedTarget","currentTarget","HTMLElement","capture","_e$target","triggeredByKeyboard","focusLast","_lastMessageFocused","focus"],"sources":["client/views/room/hooks/useMessageListNavigation.ts"],"sourcesContent":["import { createFocusManager } from '@react-aria/focus';\nimport type { RefCallback } from 'react';\nimport { useCallback } from 'react';\nimport { useFocusManager } from 'react-aria';\n\nconst isListItem = (node: EventTarget) =>\n\t(node as HTMLElement).getAttribute('role') === 'listitem' || (node as HTMLElement).getAttribute('role') === 'link';\nconst isMessageToolbarAction = (node: EventTarget) => (node as HTMLElement).parentElement?.getAttribute('role') === 'toolbar';\nconst isSystemMessage = (node: EventTarget) => (node as HTMLElement).classList.contains('rcx-message-system');\nconst isThreadMessage = (node: EventTarget) => (node as HTMLElement).classList.contains('rcx-message-thread');\n\n/**\n * Custom hook to provide the room navigation by keyboard.\n * @param ref - A ref to the message list DOM element.\n */\nexport const useMessageListNavigation = (): { messageListRef: RefCallback<HTMLElement> } => {\n\tconst roomFocusManager = useFocusManager();\n\n\tconst messageListRef = useCallback(\n\t\t(node: HTMLElement | null) => {\n\t\t\tlet lastMessageFocused: HTMLElement | null = null;\n\t\t\tlet initialFocus = true;\n\n\t\t\tif (!node) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst massageListFocusManager = createFocusManager({\n\t\t\t\tcurrent: node,\n\t\t\t});\n\n\t\t\tnode.addEventListener('keydown', (e) => {\n\t\t\t\tif (!e.target) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!isListItem(e.target)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (e.key === 'Tab') {\n\t\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\t\troomFocusManager.focusFirst({\n\t\t\t\t\t\t\tfrom: document.getElementsByClassName('rcx-room-header')[0],\n\t\t\t\t\t\t});\n\t\t\t\t\t} else if (isThreadMessage(e.target) || isSystemMessage(e.target) || isMessageToolbarAction(e.target)) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\t\troomFocusManager.focusNext({\n\t\t\t\t\t\t\taccept: (node) => node.tagName === 'TEXTAREA',\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (e.key === 'ArrowUp' || e.key === 'ArrowDown') {\n\t\t\t\t\tif (e.key === 'ArrowUp') {\n\t\t\t\t\t\tmassageListFocusManager.focusPrevious({ accept: (node) => isListItem(node) });\n\t\t\t\t\t}\n\n\t\t\t\t\tif (e.key === 'ArrowDown') {\n\t\t\t\t\t\tmassageListFocusManager.focusNext({ accept: (node) => isListItem(node) });\n\t\t\t\t\t}\n\n\t\t\t\t\tlastMessageFocused = document.activeElement as HTMLElement;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tnode.addEventListener(\n\t\t\t\t'blur',\n\t\t\t\t(e) => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t!(e.relatedTarget as HTMLElement)?.classList.contains('focus-visible') ||\n\t\t\t\t\t\t!(e.currentTarget instanceof HTMLElement && e.relatedTarget instanceof HTMLElement)\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!e.currentTarget.contains(e.relatedTarget) && !lastMessageFocused) {\n\t\t\t\t\t\tlastMessageFocused = e.target as HTMLElement;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{ capture: true },\n\t\t\t);\n\n\t\t\tnode.addEventListener(\n\t\t\t\t'focus',\n\t\t\t\t(e) => {\n\t\t\t\t\tconst triggeredByKeyboard = (e.target as HTMLElement)?.classList.contains('focus-visible');\n\t\t\t\t\tif (!triggeredByKeyboard || !(e.currentTarget instanceof HTMLElement && e.relatedTarget instanceof HTMLElement)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (initialFocus) {\n\t\t\t\t\t\tmassageListFocusManager.focusLast({ accept: (node) => isListItem(node) });\n\t\t\t\t\t\tlastMessageFocused = document.activeElement as HTMLElement;\n\t\t\t\t\t\tinitialFocus = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (lastMessageFocused && !e.currentTarget.contains(e.relatedTarget) && node.contains(e.target as HTMLElement)) {\n\t\t\t\t\t\tlastMessageFocused?.focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{ capture: true },\n\t\t\t);\n\t\t},\n\t\t[roomFocusManager],\n\t);\n\n\treturn {\n\t\tmessageListRef,\n\t};\n};\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"7bf78998455915455211f6382fc98b884c985bd4"}
