{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/lib/voip/QueueAggregator.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/lib/voip/QueueAggregator.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/lib/voip/QueueAggregator.ts","inputSourceMap":{"version":3,"file":"client/lib/voip/QueueAggregator.ts","sourceRoot":"","sources":["client/lib/voip/QueueAggregator.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Class representing the agent's queue information. This class stores the information\n * of all the queues that the agent is serving.\n *\n * @remarks\n * This class stores the necessary information of agent's queue stats.\n * It also maintains a history of agents queue operation history for current\n * login session. (Agent logging in to rocket-chat and logging off from rocket chat.)\n * Currently the data is stored locally but may sent back to server if such need exists.\n */\n\nimport type { IQueueMembershipSubscription, ICallerInfo, IQueueInfo } from '@rocket.chat/core-typings';\n\ninterface IQueueServingRecord {\n\tqueueInfo: IQueueInfo;\n\tcallStarted: Date | undefined;\n\tcallEnded: Date | undefined;\n\tcallerId: ICallerInfo;\n\tagentExtension: string;\n}\n/**\n * Currently this class depends on the external users to update this class.\n * But in theory, this class serves as\n */\nexport class QueueAggregator {\n\t// Maintains the history of the queue that the agent has served\n\tprivate sessionQueueCallServingHistory: IQueueServingRecord[];\n\n\tprivate currentlyServing: IQueueServingRecord;\n\n\tprivate currentQueueMembershipStatus: Record<string, IQueueInfo>;\n\n\tprivate extension: string;\n\n\tconstructor() {\n\t\tthis.sessionQueueCallServingHistory = [];\n\t\tthis.currentQueueMembershipStatus = {};\n\t}\n\n\tprivate updateQueueInfo(queueName: string, queuedCalls: number): void {\n\t\tif (!this.currentQueueMembershipStatus?.[queueName]) {\n\t\t\t// something is wrong. Queue is not found in the membership details.\n\t\t\treturn;\n\t\t}\n\t\tthis.currentQueueMembershipStatus[queueName].callsInQueue = queuedCalls;\n\t}\n\n\tsetMembership(subscription: IQueueMembershipSubscription): void {\n\t\tthis.extension = subscription.extension;\n\n\t\tsubscription.queues.forEach((queue) => {\n\t\t\tconst queueInfo: IQueueInfo = {\n\t\t\t\tqueueName: queue.name,\n\t\t\t\tcallsInQueue: 0,\n\t\t\t};\n\t\t\tthis.currentQueueMembershipStatus[queue.name] = queueInfo;\n\t\t});\n\t}\n\n\tqueueJoined(joiningDetails: { queuename: string; callerid: { id: string }; queuedcalls: string }): void {\n\t\tthis.updateQueueInfo(joiningDetails.queuename, Number(joiningDetails.queuedcalls));\n\t}\n\n\tcallPickedup(queue: { queuename: string; queuedcalls: string; waittimeinqueue: string }): void {\n\t\tthis.updateQueueInfo(queue.queuename, Number(queue.queuedcalls));\n\t}\n\n\tmemberAdded(queue: { queuename: string; queuedcalls: string }): void {\n\t\t// current user is added in the queue which has queue count |queuedcalls|\n\t\tconst queueInfo: IQueueInfo = {\n\t\t\tqueueName: queue.queuename,\n\t\t\tcallsInQueue: Number(queue.queuedcalls),\n\t\t};\n\t\tthis.currentQueueMembershipStatus[queue.queuename] = queueInfo;\n\t}\n\n\tmemberRemoved(queue: { queuename: string; queuedcalls: string }): void {\n\t\t// current user is removed from the queue which has queue count |queuedcalls|\n\t\tif (!this.currentQueueMembershipStatus?.[queue.queuename]) {\n\t\t\t// something is wrong. Queue is not found in the membership details.\n\t\t\treturn;\n\t\t}\n\t\tdelete this.currentQueueMembershipStatus[queue.queuename];\n\t}\n\n\tqueueAbandoned(queue: { queuename: string; queuedcallafterabandon: string }): void {\n\t\tthis.updateQueueInfo(queue.queuename, Number(queue.queuedcallafterabandon));\n\t}\n\n\tgetCallWaitingCount(): number {\n\t\treturn Object.entries(this.currentQueueMembershipStatus).reduce((acc, [_, value]) => acc + value.callsInQueue, 0);\n\t}\n\n\tgetCurrentQueueName(): string {\n\t\tif (this.currentlyServing?.queueInfo) {\n\t\t\treturn this.currentlyServing.queueInfo.queueName;\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tcallRinging(queueInfo: { queuename: string; callerid: { id: string; name: string } }): void {\n\t\tif (!this.currentQueueMembershipStatus?.[queueInfo.queuename]) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst queueServing: IQueueServingRecord = {\n\t\t\tqueueInfo: this.currentQueueMembershipStatus[queueInfo.queuename],\n\t\t\tcallerId: {\n\t\t\t\tcallerId: queueInfo.callerid.id,\n\t\t\t\tcallerName: queueInfo.callerid.name,\n\t\t\t},\n\t\t\tcallStarted: undefined,\n\t\t\tcallEnded: undefined,\n\t\t\tagentExtension: this.extension,\n\t\t};\n\t\tthis.currentlyServing = queueServing;\n\t}\n\n\tcallStarted(): void {\n\t\tif (this.currentlyServing) {\n\t\t\tthis.currentlyServing.callStarted = new Date();\n\t\t}\n\t}\n\n\tcallEnded(): void {\n\t\t// Latest calls are at lower index\n\t\tif (this.currentlyServing) {\n\t\t\tthis.currentlyServing.callEnded = new Date();\n\t\t\tthis.sessionQueueCallServingHistory.unshift(this.currentlyServing);\n\t\t}\n\t}\n}\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/lib/voip/QueueAggregator.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/lib/voip/QueueAggregator.ts","inputSourceMap":{"version":3,"file":"client/lib/voip/QueueAggregator.ts","sourceRoot":"","sources":["client/lib/voip/QueueAggregator.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Class representing the agent's queue information. This class stores the information\n * of all the queues that the agent is serving.\n *\n * @remarks\n * This class stores the necessary information of agent's queue stats.\n * It also maintains a history of agents queue operation history for current\n * login session. (Agent logging in to rocket-chat and logging off from rocket chat.)\n * Currently the data is stored locally but may sent back to server if such need exists.\n */\n\nimport type { IQueueMembershipSubscription, ICallerInfo, IQueueInfo } from '@rocket.chat/core-typings';\n\ninterface IQueueServingRecord {\n\tqueueInfo: IQueueInfo;\n\tcallStarted: Date | undefined;\n\tcallEnded: Date | undefined;\n\tcallerId: ICallerInfo;\n\tagentExtension: string;\n}\n/**\n * Currently this class depends on the external users to update this class.\n * But in theory, this class serves as\n */\nexport class QueueAggregator {\n\t// Maintains the history of the queue that the agent has served\n\tprivate sessionQueueCallServingHistory: IQueueServingRecord[];\n\n\tprivate currentlyServing: IQueueServingRecord;\n\n\tprivate currentQueueMembershipStatus: Record<string, IQueueInfo>;\n\n\tprivate extension: string;\n\n\tconstructor() {\n\t\tthis.sessionQueueCallServingHistory = [];\n\t\tthis.currentQueueMembershipStatus = {};\n\t}\n\n\tprivate updateQueueInfo(queueName: string, queuedCalls: number): void {\n\t\tif (!this.currentQueueMembershipStatus?.[queueName]) {\n\t\t\t// something is wrong. Queue is not found in the membership details.\n\t\t\treturn;\n\t\t}\n\t\tthis.currentQueueMembershipStatus[queueName].callsInQueue = queuedCalls;\n\t}\n\n\tsetMembership(subscription: IQueueMembershipSubscription): void {\n\t\tthis.extension = subscription.extension;\n\n\t\tsubscription.queues.forEach((queue) => {\n\t\t\tconst queueInfo: IQueueInfo = {\n\t\t\t\tqueueName: queue.name,\n\t\t\t\tcallsInQueue: 0,\n\t\t\t};\n\t\t\tthis.currentQueueMembershipStatus[queue.name] = queueInfo;\n\t\t});\n\t}\n\n\tqueueJoined(joiningDetails: { queuename: string; callerid: { id: string }; queuedcalls: string }): void {\n\t\tthis.updateQueueInfo(joiningDetails.queuename, Number(joiningDetails.queuedcalls));\n\t}\n\n\tcallPickedup(queue: { queuename: string; queuedcalls: string; waittimeinqueue: string }): void {\n\t\tthis.updateQueueInfo(queue.queuename, Number(queue.queuedcalls));\n\t}\n\n\tmemberAdded(queue: { queuename: string; queuedcalls: string }): void {\n\t\t// current user is added in the queue which has queue count |queuedcalls|\n\t\tconst queueInfo: IQueueInfo = {\n\t\t\tqueueName: queue.queuename,\n\t\t\tcallsInQueue: Number(queue.queuedcalls),\n\t\t};\n\t\tthis.currentQueueMembershipStatus[queue.queuename] = queueInfo;\n\t}\n\n\tmemberRemoved(queue: { queuename: string; queuedcalls: string }): void {\n\t\t// current user is removed from the queue which has queue count |queuedcalls|\n\t\tif (!this.currentQueueMembershipStatus?.[queue.queuename]) {\n\t\t\t// something is wrong. Queue is not found in the membership details.\n\t\t\treturn;\n\t\t}\n\t\tdelete this.currentQueueMembershipStatus[queue.queuename];\n\t}\n\n\tqueueAbandoned(queue: { queuename: string; queuedcallafterabandon: string }): void {\n\t\tthis.updateQueueInfo(queue.queuename, Number(queue.queuedcallafterabandon));\n\t}\n\n\tgetCallWaitingCount(): number {\n\t\treturn Object.entries(this.currentQueueMembershipStatus).reduce((acc, [_, value]) => acc + value.callsInQueue, 0);\n\t}\n\n\tgetCurrentQueueName(): string {\n\t\tif (this.currentlyServing?.queueInfo) {\n\t\t\treturn this.currentlyServing.queueInfo.queueName;\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tcallRinging(queueInfo: { queuename: string; callerid: { id: string; name: string } }): void {\n\t\tif (!this.currentQueueMembershipStatus?.[queueInfo.queuename]) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst queueServing: IQueueServingRecord = {\n\t\t\tqueueInfo: this.currentQueueMembershipStatus[queueInfo.queuename],\n\t\t\tcallerId: {\n\t\t\t\tcallerId: queueInfo.callerid.id,\n\t\t\t\tcallerName: queueInfo.callerid.name,\n\t\t\t},\n\t\t\tcallStarted: undefined,\n\t\t\tcallEnded: undefined,\n\t\t\tagentExtension: this.extension,\n\t\t};\n\t\tthis.currentlyServing = queueServing;\n\t}\n\n\tcallStarted(): void {\n\t\tif (this.currentlyServing) {\n\t\t\tthis.currentlyServing.callStarted = new Date();\n\t\t}\n\t}\n\n\tcallEnded(): void {\n\t\t// Latest calls are at lower index\n\t\tif (this.currentlyServing) {\n\t\t\tthis.currentlyServing.callEnded = new Date();\n\t\t\tthis.sessionQueueCallServingHistory.unshift(this.currentlyServing);\n\t\t}\n\t}\n}\n"]}}},"code":"var _slicedToArray;\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 0);\nmodule.export({\n  QueueAggregator: function () {\n    return QueueAggregator;\n  }\n});\nvar QueueAggregator = /*#__PURE__*/function () {\n  function QueueAggregator() {\n    // Maintains the history of the queue that the agent has served\n    this.sessionQueueCallServingHistory = void 0;\n    this.currentlyServing = void 0;\n    this.currentQueueMembershipStatus = void 0;\n    this.extension = void 0;\n    this.sessionQueueCallServingHistory = [];\n    this.currentQueueMembershipStatus = {};\n  }\n  var _proto = QueueAggregator.prototype;\n  _proto.updateQueueInfo = function () {\n    function updateQueueInfo(queueName, queuedCalls) {\n      var _this$currentQueueMem;\n      if (!((_this$currentQueueMem = this.currentQueueMembershipStatus) !== null && _this$currentQueueMem !== void 0 && _this$currentQueueMem[queueName])) {\n        // something is wrong. Queue is not found in the membership details.\n        return;\n      }\n      this.currentQueueMembershipStatus[queueName].callsInQueue = queuedCalls;\n    }\n    return updateQueueInfo;\n  }();\n  _proto.setMembership = function () {\n    function setMembership(subscription) {\n      var _this = this;\n      this.extension = subscription.extension;\n      subscription.queues.forEach(function (queue) {\n        var queueInfo = {\n          queueName: queue.name,\n          callsInQueue: 0\n        };\n        _this.currentQueueMembershipStatus[queue.name] = queueInfo;\n      });\n    }\n    return setMembership;\n  }();\n  _proto.queueJoined = function () {\n    function queueJoined(joiningDetails) {\n      this.updateQueueInfo(joiningDetails.queuename, Number(joiningDetails.queuedcalls));\n    }\n    return queueJoined;\n  }();\n  _proto.callPickedup = function () {\n    function callPickedup(queue) {\n      this.updateQueueInfo(queue.queuename, Number(queue.queuedcalls));\n    }\n    return callPickedup;\n  }();\n  _proto.memberAdded = function () {\n    function memberAdded(queue) {\n      // current user is added in the queue which has queue count |queuedcalls|\n      var queueInfo = {\n        queueName: queue.queuename,\n        callsInQueue: Number(queue.queuedcalls)\n      };\n      this.currentQueueMembershipStatus[queue.queuename] = queueInfo;\n    }\n    return memberAdded;\n  }();\n  _proto.memberRemoved = function () {\n    function memberRemoved(queue) {\n      var _this$currentQueueMem2;\n      // current user is removed from the queue which has queue count |queuedcalls|\n      if (!((_this$currentQueueMem2 = this.currentQueueMembershipStatus) !== null && _this$currentQueueMem2 !== void 0 && _this$currentQueueMem2[queue.queuename])) {\n        // something is wrong. Queue is not found in the membership details.\n        return;\n      }\n      delete this.currentQueueMembershipStatus[queue.queuename];\n    }\n    return memberRemoved;\n  }();\n  _proto.queueAbandoned = function () {\n    function queueAbandoned(queue) {\n      this.updateQueueInfo(queue.queuename, Number(queue.queuedcallafterabandon));\n    }\n    return queueAbandoned;\n  }();\n  _proto.getCallWaitingCount = function () {\n    function getCallWaitingCount() {\n      return Object.entries(this.currentQueueMembershipStatus).reduce(function (acc, _ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n          _ = _ref2[0],\n          value = _ref2[1];\n        return acc + value.callsInQueue;\n      }, 0);\n    }\n    return getCallWaitingCount;\n  }();\n  _proto.getCurrentQueueName = function () {\n    function getCurrentQueueName() {\n      var _this$currentlyServin;\n      if ((_this$currentlyServin = this.currentlyServing) !== null && _this$currentlyServin !== void 0 && _this$currentlyServin.queueInfo) {\n        return this.currentlyServing.queueInfo.queueName;\n      }\n      return '';\n    }\n    return getCurrentQueueName;\n  }();\n  _proto.callRinging = function () {\n    function callRinging(queueInfo) {\n      var _this$currentQueueMem3;\n      if (!((_this$currentQueueMem3 = this.currentQueueMembershipStatus) !== null && _this$currentQueueMem3 !== void 0 && _this$currentQueueMem3[queueInfo.queuename])) {\n        return;\n      }\n      var queueServing = {\n        queueInfo: this.currentQueueMembershipStatus[queueInfo.queuename],\n        callerId: {\n          callerId: queueInfo.callerid.id,\n          callerName: queueInfo.callerid.name\n        },\n        callStarted: undefined,\n        callEnded: undefined,\n        agentExtension: this.extension\n      };\n      this.currentlyServing = queueServing;\n    }\n    return callRinging;\n  }();\n  _proto.callStarted = function () {\n    function callStarted() {\n      if (this.currentlyServing) {\n        this.currentlyServing.callStarted = new Date();\n      }\n    }\n    return callStarted;\n  }();\n  _proto.callEnded = function () {\n    function callEnded() {\n      // Latest calls are at lower index\n      if (this.currentlyServing) {\n        this.currentlyServing.callEnded = new Date();\n        this.sessionQueueCallServingHistory.unshift(this.currentlyServing);\n      }\n    }\n    return callEnded;\n  }();\n  return QueueAggregator;\n}();","map":{"version":3,"names":["_slicedToArray","module","link","default","v","export","QueueAggregator","sessionQueueCallServingHistory","currentlyServing","currentQueueMembershipStatus","extension","_proto","prototype","updateQueueInfo","queueName","queuedCalls","_this$currentQueueMem","callsInQueue","setMembership","subscription","_this","queues","forEach","queue","queueInfo","name","queueJoined","joiningDetails","queuename","Number","queuedcalls","callPickedup","memberAdded","memberRemoved","_this$currentQueueMem2","queueAbandoned","queuedcallafterabandon","getCallWaitingCount","Object","entries","reduce","acc","_ref","_ref2","_","value","getCurrentQueueName","_this$currentlyServin","callRinging","_this$currentQueueMem3","queueServing","callerId","callerid","id","callerName","callStarted","undefined","callEnded","agentExtension","Date","unshift"],"sources":["client/lib/voip/QueueAggregator.ts"],"sourcesContent":["/**\n * Class representing the agent's queue information. This class stores the information\n * of all the queues that the agent is serving.\n *\n * @remarks\n * This class stores the necessary information of agent's queue stats.\n * It also maintains a history of agents queue operation history for current\n * login session. (Agent logging in to rocket-chat and logging off from rocket chat.)\n * Currently the data is stored locally but may sent back to server if such need exists.\n */\n\nimport type { IQueueMembershipSubscription, ICallerInfo, IQueueInfo } from '@rocket.chat/core-typings';\n\ninterface IQueueServingRecord {\n\tqueueInfo: IQueueInfo;\n\tcallStarted: Date | undefined;\n\tcallEnded: Date | undefined;\n\tcallerId: ICallerInfo;\n\tagentExtension: string;\n}\n/**\n * Currently this class depends on the external users to update this class.\n * But in theory, this class serves as\n */\nexport class QueueAggregator {\n\t// Maintains the history of the queue that the agent has served\n\tprivate sessionQueueCallServingHistory: IQueueServingRecord[];\n\n\tprivate currentlyServing: IQueueServingRecord;\n\n\tprivate currentQueueMembershipStatus: Record<string, IQueueInfo>;\n\n\tprivate extension: string;\n\n\tconstructor() {\n\t\tthis.sessionQueueCallServingHistory = [];\n\t\tthis.currentQueueMembershipStatus = {};\n\t}\n\n\tprivate updateQueueInfo(queueName: string, queuedCalls: number): void {\n\t\tif (!this.currentQueueMembershipStatus?.[queueName]) {\n\t\t\t// something is wrong. Queue is not found in the membership details.\n\t\t\treturn;\n\t\t}\n\t\tthis.currentQueueMembershipStatus[queueName].callsInQueue = queuedCalls;\n\t}\n\n\tsetMembership(subscription: IQueueMembershipSubscription): void {\n\t\tthis.extension = subscription.extension;\n\n\t\tsubscription.queues.forEach((queue) => {\n\t\t\tconst queueInfo: IQueueInfo = {\n\t\t\t\tqueueName: queue.name,\n\t\t\t\tcallsInQueue: 0,\n\t\t\t};\n\t\t\tthis.currentQueueMembershipStatus[queue.name] = queueInfo;\n\t\t});\n\t}\n\n\tqueueJoined(joiningDetails: { queuename: string; callerid: { id: string }; queuedcalls: string }): void {\n\t\tthis.updateQueueInfo(joiningDetails.queuename, Number(joiningDetails.queuedcalls));\n\t}\n\n\tcallPickedup(queue: { queuename: string; queuedcalls: string; waittimeinqueue: string }): void {\n\t\tthis.updateQueueInfo(queue.queuename, Number(queue.queuedcalls));\n\t}\n\n\tmemberAdded(queue: { queuename: string; queuedcalls: string }): void {\n\t\t// current user is added in the queue which has queue count |queuedcalls|\n\t\tconst queueInfo: IQueueInfo = {\n\t\t\tqueueName: queue.queuename,\n\t\t\tcallsInQueue: Number(queue.queuedcalls),\n\t\t};\n\t\tthis.currentQueueMembershipStatus[queue.queuename] = queueInfo;\n\t}\n\n\tmemberRemoved(queue: { queuename: string; queuedcalls: string }): void {\n\t\t// current user is removed from the queue which has queue count |queuedcalls|\n\t\tif (!this.currentQueueMembershipStatus?.[queue.queuename]) {\n\t\t\t// something is wrong. Queue is not found in the membership details.\n\t\t\treturn;\n\t\t}\n\t\tdelete this.currentQueueMembershipStatus[queue.queuename];\n\t}\n\n\tqueueAbandoned(queue: { queuename: string; queuedcallafterabandon: string }): void {\n\t\tthis.updateQueueInfo(queue.queuename, Number(queue.queuedcallafterabandon));\n\t}\n\n\tgetCallWaitingCount(): number {\n\t\treturn Object.entries(this.currentQueueMembershipStatus).reduce((acc, [_, value]) => acc + value.callsInQueue, 0);\n\t}\n\n\tgetCurrentQueueName(): string {\n\t\tif (this.currentlyServing?.queueInfo) {\n\t\t\treturn this.currentlyServing.queueInfo.queueName;\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tcallRinging(queueInfo: { queuename: string; callerid: { id: string; name: string } }): void {\n\t\tif (!this.currentQueueMembershipStatus?.[queueInfo.queuename]) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst queueServing: IQueueServingRecord = {\n\t\t\tqueueInfo: this.currentQueueMembershipStatus[queueInfo.queuename],\n\t\t\tcallerId: {\n\t\t\t\tcallerId: queueInfo.callerid.id,\n\t\t\t\tcallerName: queueInfo.callerid.name,\n\t\t\t},\n\t\t\tcallStarted: undefined,\n\t\t\tcallEnded: undefined,\n\t\t\tagentExtension: this.extension,\n\t\t};\n\t\tthis.currentlyServing = queueServing;\n\t}\n\n\tcallStarted(): void {\n\t\tif (this.currentlyServing) {\n\t\t\tthis.currentlyServing.callStarted = new Date();\n\t\t}\n\t}\n\n\tcallEnded(): void {\n\t\t// Latest calls are at lower index\n\t\tif (this.currentlyServing) {\n\t\t\tthis.currentlyServing.callEnded = new Date();\n\t\t\tthis.sessionQueueCallServingHistory.unshift(this.currentlyServing);\n\t\t}\n\t}\n}\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"14b4539735ed213748f36e3cb2902e5283cc7ad3"}
