{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts","inputSourceMap":{"version":3,"file":"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts","sourceRoot":"","sources":["client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,kBAAkB,EAAE,MAAM,6BAA6B,CAAC;AAEjE,OAAO,EAAE,UAAU,EAAE,MAAM,0BAA0B,CAAC;AACtD,OAAO,EAAE,SAAS,EAAE,OAAO,EAAE,MAAM,OAAO,CAAC;AAE3C,OAAO,EAAE,aAAa,EAAE,MAAM,iEAAiE,CAAC;AAChG,OAAO,EAAE,OAAO,EAAE,MAAM,kCAAkC,CAAC;AAC3D,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AACtE,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AAEtE,MAAM,aAAa,GAAG,IAAI,aAAa,EAAE,CAAC;AAE1C,MAAM,CAAC,MAAM,qBAAqB,GAAG,CAAC,QAAiB,EAAE,kBAA2B,EAAwB,EAAE;IAC7G,MAAM,mBAAmB,GAAG,UAAU,CAAC,oBAAoB,CAAY,CAAC;IACxE,MAAM,sBAAsB,GAAG,UAAU,CAAC,8BAA8B,CAAY,CAAC;IACrF,MAAM,4BAA4B,GAAG,UAAU,CAAC,+BAA+B,CAAW,CAAC;IAC3F,MAAM,4BAA4B,GAAG,UAAU,CAAC,+BAA+B,CAAW,CAAC;IAC3F,MAAM,CAAC,kBAAkB,CAAC,GAAG,mBAAmB,CAAC,YAAY,CAAC,CAAC;IAE/D,MAAM,SAAS,GAAG,OAAO,CACxB,GAAG,EAAE,CACJ,OAAO,CACN,aAAa,CAAC,WAAW,EAAE;QAC1B,CAAC,kBAAkB;QACnB,mBAAmB;QACnB,sBAAsB;QACtB,CAAC,4BAA4B,EAAE,KAAK,CAAC,uBAAuB,CAAC;QAC7D,CAAC,CAAC,4BAA4B,IAAI,4BAA4B,CAAC,KAAK,CAAC,uBAAuB,CAAC,CAAC,CAC/F,EACF,CAAC,4BAA4B,EAAE,4BAA4B,EAAE,sBAAsB,EAAE,mBAAmB,EAAE,kBAAkB,CAAC,CAC7H,CAAC;IAEF,MAAM,mBAAmB,GAAG,mBAAmB,CAAC,OAAO,EAAE,kBAAkB,EAAE,mBAAmB,EAAE,sBAAsB,EAAE,SAAS,CAAC,CAAC;IAErI,MAAM,IAAI,GAAG,OAAO,EAAE,CAAC;IAEvB,MAAM,aAAa,GAAG,kBAAkB,CAAC,GAAG,EAAE;QAC7C,IAAI,EAAE,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAE/B,IAAI,EAAE,QAAQ,EAAE,gBAAgB,CAAC,KAAK,CAAC,CAAC;IACzC,CAAC,CAAC,CAAC;IAEH,MAAM,mBAAmB,GAAG,kBAAkB,CAAC,CAAC,QAAQ,EAAE,EAAE;QAC3D,IAAI,QAAQ,EAAE,CAAC;YACd,aAAa,EAAE,CAAC;QACjB,CAAC;QAED,IAAI,EAAE,QAAQ,EAAE,qBAAqB,CAAC,QAAQ,CAAC,CAAC;IACjD,CAAC,CAAC,CAAC;IAEH,SAAS,CAAC,GAAG,EAAE;QACd,mBAAmB,CAAC,kBAAkB,CAAC,CAAC;IACzC,CAAC,EAAE,CAAC,mBAAmB,EAAE,kBAAkB,CAAC,CAAC,CAAC;IAE9C,MAAM,uBAAuB,GAAG,GAAG,EAAE,CAAC,IAAI,EAAE,QAAQ,EAAE,gBAAgB,CAAC,IAAI,CAAC,CAAC;IAE7E,OAAO;QACN,EAAE,EAAE,eAAe;QACnB,OAAO,EAAE,mBAAmB;QAC5B,IAAI,EAAE,KAAK;QACX,QAAQ,EAAE,CAAC,SAAS,IAAI,OAAO,CAAC,QAAQ,CAAC;QACzC,OAAO,EAAE,uBAAuB;KAChC,CAAC;AACH,CAAC,CAAC","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useSetting } from '@rocket.chat/ui-contexts';\nimport { useEffect, useMemo } from 'react';\n\nimport { AudioRecorder } from '../../../../../../../app/ui/client/lib/recorderjs/AudioRecorder';\nimport { useChat } from '../../../../contexts/ChatContext';\nimport { useMediaActionTitle } from '../../hooks/useMediaActionTitle';\nimport { useMediaPermissions } from '../../hooks/useMediaPermissions';\n\nconst audioRecorder = new AudioRecorder();\n\nexport const useAudioMessageAction = (disabled: boolean, isMicrophoneDenied: boolean): GenericMenuItemProps => {\n\tconst isFileUploadEnabled = useSetting('FileUpload_Enabled') as boolean;\n\tconst isAudioRecorderEnabled = useSetting('Message_AudioRecorderEnabled') as boolean;\n\tconst fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList') as string;\n\tconst fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList') as string;\n\tconst [isPermissionDenied] = useMediaPermissions('microphone');\n\n\tconst isAllowed = useMemo(\n\t\t() =>\n\t\t\tBoolean(\n\t\t\t\taudioRecorder.isSupported() &&\n\t\t\t\t\t!isMicrophoneDenied &&\n\t\t\t\t\tisFileUploadEnabled &&\n\t\t\t\t\tisAudioRecorderEnabled &&\n\t\t\t\t\t!fileUploadMediaTypeBlackList?.match(/audio\\/mp3|audio\\/\\*/i) &&\n\t\t\t\t\t(!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/audio\\/mp3|audio\\/\\*/i)),\n\t\t\t),\n\t\t[fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isAudioRecorderEnabled, isFileUploadEnabled, isMicrophoneDenied],\n\t);\n\n\tconst getMediaActionTitle = useMediaActionTitle('audio', isPermissionDenied, isFileUploadEnabled, isAudioRecorderEnabled, isAllowed);\n\n\tconst chat = useChat();\n\n\tconst stopRecording = useMutableCallback(() => {\n\t\tchat?.action.stop('recording');\n\n\t\tchat?.composer?.setRecordingMode(false);\n\t});\n\n\tconst setMicrophoneDenied = useMutableCallback((isDenied) => {\n\t\tif (isDenied) {\n\t\t\tstopRecording();\n\t\t}\n\n\t\tchat?.composer?.setIsMicrophoneDenied(isDenied);\n\t});\n\n\tuseEffect(() => {\n\t\tsetMicrophoneDenied(isPermissionDenied);\n\t}, [setMicrophoneDenied, isPermissionDenied]);\n\n\tconst handleRecordButtonClick = () => chat?.composer?.setRecordingMode(true);\n\n\treturn {\n\t\tid: 'audio-message',\n\t\tcontent: getMediaActionTitle,\n\t\ticon: 'mic',\n\t\tdisabled: !isAllowed || Boolean(disabled),\n\t\tonClick: handleRecordButtonClick,\n\t};\n};\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts","inputSourceMap":{"version":3,"file":"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts","sourceRoot":"","sources":["client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,kBAAkB,EAAE,MAAM,6BAA6B,CAAC;AAEjE,OAAO,EAAE,UAAU,EAAE,MAAM,0BAA0B,CAAC;AACtD,OAAO,EAAE,SAAS,EAAE,OAAO,EAAE,MAAM,OAAO,CAAC;AAE3C,OAAO,EAAE,aAAa,EAAE,MAAM,iEAAiE,CAAC;AAChG,OAAO,EAAE,OAAO,EAAE,MAAM,kCAAkC,CAAC;AAC3D,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AACtE,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AAEtE,MAAM,aAAa,GAAG,IAAI,aAAa,EAAE,CAAC;AAE1C,MAAM,CAAC,MAAM,qBAAqB,GAAG,CAAC,QAAiB,EAAE,kBAA2B,EAAwB,EAAE;IAC7G,MAAM,mBAAmB,GAAG,UAAU,CAAC,oBAAoB,CAAY,CAAC;IACxE,MAAM,sBAAsB,GAAG,UAAU,CAAC,8BAA8B,CAAY,CAAC;IACrF,MAAM,4BAA4B,GAAG,UAAU,CAAC,+BAA+B,CAAW,CAAC;IAC3F,MAAM,4BAA4B,GAAG,UAAU,CAAC,+BAA+B,CAAW,CAAC;IAC3F,MAAM,CAAC,kBAAkB,CAAC,GAAG,mBAAmB,CAAC,YAAY,CAAC,CAAC;IAE/D,MAAM,SAAS,GAAG,OAAO,CACxB,GAAG,EAAE,CACJ,OAAO,CACN,aAAa,CAAC,WAAW,EAAE;QAC1B,CAAC,kBAAkB;QACnB,mBAAmB;QACnB,sBAAsB;QACtB,CAAC,4BAA4B,EAAE,KAAK,CAAC,uBAAuB,CAAC;QAC7D,CAAC,CAAC,4BAA4B,IAAI,4BAA4B,CAAC,KAAK,CAAC,uBAAuB,CAAC,CAAC,CAC/F,EACF,CAAC,4BAA4B,EAAE,4BAA4B,EAAE,sBAAsB,EAAE,mBAAmB,EAAE,kBAAkB,CAAC,CAC7H,CAAC;IAEF,MAAM,mBAAmB,GAAG,mBAAmB,CAAC,OAAO,EAAE,kBAAkB,EAAE,mBAAmB,EAAE,sBAAsB,EAAE,SAAS,CAAC,CAAC;IAErI,MAAM,IAAI,GAAG,OAAO,EAAE,CAAC;IAEvB,MAAM,aAAa,GAAG,kBAAkB,CAAC,GAAG,EAAE;QAC7C,IAAI,EAAE,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAE/B,IAAI,EAAE,QAAQ,EAAE,gBAAgB,CAAC,KAAK,CAAC,CAAC;IACzC,CAAC,CAAC,CAAC;IAEH,MAAM,mBAAmB,GAAG,kBAAkB,CAAC,CAAC,QAAQ,EAAE,EAAE;QAC3D,IAAI,QAAQ,EAAE,CAAC;YACd,aAAa,EAAE,CAAC;QACjB,CAAC;QAED,IAAI,EAAE,QAAQ,EAAE,qBAAqB,CAAC,QAAQ,CAAC,CAAC;IACjD,CAAC,CAAC,CAAC;IAEH,SAAS,CAAC,GAAG,EAAE;QACd,mBAAmB,CAAC,kBAAkB,CAAC,CAAC;IACzC,CAAC,EAAE,CAAC,mBAAmB,EAAE,kBAAkB,CAAC,CAAC,CAAC;IAE9C,MAAM,uBAAuB,GAAG,GAAG,EAAE,CAAC,IAAI,EAAE,QAAQ,EAAE,gBAAgB,CAAC,IAAI,CAAC,CAAC;IAE7E,OAAO;QACN,EAAE,EAAE,eAAe;QACnB,OAAO,EAAE,mBAAmB;QAC5B,IAAI,EAAE,KAAK;QACX,QAAQ,EAAE,CAAC,SAAS,IAAI,OAAO,CAAC,QAAQ,CAAC;QACzC,OAAO,EAAE,uBAAuB;KAChC,CAAC;AACH,CAAC,CAAC","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useSetting } from '@rocket.chat/ui-contexts';\nimport { useEffect, useMemo } from 'react';\n\nimport { AudioRecorder } from '../../../../../../../app/ui/client/lib/recorderjs/AudioRecorder';\nimport { useChat } from '../../../../contexts/ChatContext';\nimport { useMediaActionTitle } from '../../hooks/useMediaActionTitle';\nimport { useMediaPermissions } from '../../hooks/useMediaPermissions';\n\nconst audioRecorder = new AudioRecorder();\n\nexport const useAudioMessageAction = (disabled: boolean, isMicrophoneDenied: boolean): GenericMenuItemProps => {\n\tconst isFileUploadEnabled = useSetting('FileUpload_Enabled') as boolean;\n\tconst isAudioRecorderEnabled = useSetting('Message_AudioRecorderEnabled') as boolean;\n\tconst fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList') as string;\n\tconst fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList') as string;\n\tconst [isPermissionDenied] = useMediaPermissions('microphone');\n\n\tconst isAllowed = useMemo(\n\t\t() =>\n\t\t\tBoolean(\n\t\t\t\taudioRecorder.isSupported() &&\n\t\t\t\t\t!isMicrophoneDenied &&\n\t\t\t\t\tisFileUploadEnabled &&\n\t\t\t\t\tisAudioRecorderEnabled &&\n\t\t\t\t\t!fileUploadMediaTypeBlackList?.match(/audio\\/mp3|audio\\/\\*/i) &&\n\t\t\t\t\t(!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/audio\\/mp3|audio\\/\\*/i)),\n\t\t\t),\n\t\t[fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isAudioRecorderEnabled, isFileUploadEnabled, isMicrophoneDenied],\n\t);\n\n\tconst getMediaActionTitle = useMediaActionTitle('audio', isPermissionDenied, isFileUploadEnabled, isAudioRecorderEnabled, isAllowed);\n\n\tconst chat = useChat();\n\n\tconst stopRecording = useMutableCallback(() => {\n\t\tchat?.action.stop('recording');\n\n\t\tchat?.composer?.setRecordingMode(false);\n\t});\n\n\tconst setMicrophoneDenied = useMutableCallback((isDenied) => {\n\t\tif (isDenied) {\n\t\t\tstopRecording();\n\t\t}\n\n\t\tchat?.composer?.setIsMicrophoneDenied(isDenied);\n\t});\n\n\tuseEffect(() => {\n\t\tsetMicrophoneDenied(isPermissionDenied);\n\t}, [setMicrophoneDenied, isPermissionDenied]);\n\n\tconst handleRecordButtonClick = () => chat?.composer?.setRecordingMode(true);\n\n\treturn {\n\t\tid: 'audio-message',\n\t\tcontent: getMediaActionTitle,\n\t\ticon: 'mic',\n\t\tdisabled: !isAllowed || Boolean(disabled),\n\t\tonClick: handleRecordButtonClick,\n\t};\n};\n"]}}},"code":"module.export({\n  useAudioMessageAction: () => useAudioMessageAction\n});\nlet useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback(v) {\n    useMutableCallback = v;\n  }\n}, 0);\nlet useSetting;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useSetting(v) {\n    useSetting = v;\n  }\n}, 1);\nlet useEffect, useMemo;\nmodule.link(\"react\", {\n  useEffect(v) {\n    useEffect = v;\n  },\n  useMemo(v) {\n    useMemo = v;\n  }\n}, 2);\nlet AudioRecorder;\nmodule.link(\"../../../../../../../app/ui/client/lib/recorderjs/AudioRecorder\", {\n  AudioRecorder(v) {\n    AudioRecorder = v;\n  }\n}, 3);\nlet useChat;\nmodule.link(\"../../../../contexts/ChatContext\", {\n  useChat(v) {\n    useChat = v;\n  }\n}, 4);\nlet useMediaActionTitle;\nmodule.link(\"../../hooks/useMediaActionTitle\", {\n  useMediaActionTitle(v) {\n    useMediaActionTitle = v;\n  }\n}, 5);\nlet useMediaPermissions;\nmodule.link(\"../../hooks/useMediaPermissions\", {\n  useMediaPermissions(v) {\n    useMediaPermissions = v;\n  }\n}, 6);\nconst audioRecorder = new AudioRecorder();\nconst useAudioMessageAction = (disabled, isMicrophoneDenied) => {\n  const isFileUploadEnabled = useSetting('FileUpload_Enabled');\n  const isAudioRecorderEnabled = useSetting('Message_AudioRecorderEnabled');\n  const fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList');\n  const fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList');\n  const [isPermissionDenied] = useMediaPermissions('microphone');\n  const isAllowed = useMemo(() => Boolean(audioRecorder.isSupported() && !isMicrophoneDenied && isFileUploadEnabled && isAudioRecorderEnabled && !(fileUploadMediaTypeBlackList !== null && fileUploadMediaTypeBlackList !== void 0 && fileUploadMediaTypeBlackList.match(/audio\\/mp3|audio\\/\\*/i)) && (!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/audio\\/mp3|audio\\/\\*/i))), [fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isAudioRecorderEnabled, isFileUploadEnabled, isMicrophoneDenied]);\n  const getMediaActionTitle = useMediaActionTitle('audio', isPermissionDenied, isFileUploadEnabled, isAudioRecorderEnabled, isAllowed);\n  const chat = useChat();\n  const stopRecording = useMutableCallback(() => {\n    var _chat$composer;\n    chat === null || chat === void 0 ? void 0 : chat.action.stop('recording');\n    chat === null || chat === void 0 ? void 0 : (_chat$composer = chat.composer) === null || _chat$composer === void 0 ? void 0 : _chat$composer.setRecordingMode(false);\n  });\n  const setMicrophoneDenied = useMutableCallback(isDenied => {\n    var _chat$composer2;\n    if (isDenied) {\n      stopRecording();\n    }\n    chat === null || chat === void 0 ? void 0 : (_chat$composer2 = chat.composer) === null || _chat$composer2 === void 0 ? void 0 : _chat$composer2.setIsMicrophoneDenied(isDenied);\n  });\n  useEffect(() => {\n    setMicrophoneDenied(isPermissionDenied);\n  }, [setMicrophoneDenied, isPermissionDenied]);\n  const handleRecordButtonClick = () => {\n    var _chat$composer3;\n    return chat === null || chat === void 0 ? void 0 : (_chat$composer3 = chat.composer) === null || _chat$composer3 === void 0 ? void 0 : _chat$composer3.setRecordingMode(true);\n  };\n  return {\n    id: 'audio-message',\n    content: getMediaActionTitle,\n    icon: 'mic',\n    disabled: !isAllowed || Boolean(disabled),\n    onClick: handleRecordButtonClick\n  };\n};","map":{"version":3,"names":["module","export","useAudioMessageAction","useMutableCallback","link","v","useSetting","useEffect","useMemo","AudioRecorder","useChat","useMediaActionTitle","useMediaPermissions","audioRecorder","disabled","isMicrophoneDenied","isFileUploadEnabled","isAudioRecorderEnabled","fileUploadMediaTypeBlackList","fileUploadMediaTypeWhiteList","isPermissionDenied","isAllowed","Boolean","isSupported","match","getMediaActionTitle","chat","stopRecording","_chat$composer","action","stop","composer","setRecordingMode","setMicrophoneDenied","isDenied","_chat$composer2","setIsMicrophoneDenied","handleRecordButtonClick","_chat$composer3","id","content","icon","onClick"],"sources":["client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts"],"sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useSetting } from '@rocket.chat/ui-contexts';\nimport { useEffect, useMemo } from 'react';\n\nimport { AudioRecorder } from '../../../../../../../app/ui/client/lib/recorderjs/AudioRecorder';\nimport { useChat } from '../../../../contexts/ChatContext';\nimport { useMediaActionTitle } from '../../hooks/useMediaActionTitle';\nimport { useMediaPermissions } from '../../hooks/useMediaPermissions';\n\nconst audioRecorder = new AudioRecorder();\n\nexport const useAudioMessageAction = (disabled: boolean, isMicrophoneDenied: boolean): GenericMenuItemProps => {\n\tconst isFileUploadEnabled = useSetting('FileUpload_Enabled') as boolean;\n\tconst isAudioRecorderEnabled = useSetting('Message_AudioRecorderEnabled') as boolean;\n\tconst fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList') as string;\n\tconst fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList') as string;\n\tconst [isPermissionDenied] = useMediaPermissions('microphone');\n\n\tconst isAllowed = useMemo(\n\t\t() =>\n\t\t\tBoolean(\n\t\t\t\taudioRecorder.isSupported() &&\n\t\t\t\t\t!isMicrophoneDenied &&\n\t\t\t\t\tisFileUploadEnabled &&\n\t\t\t\t\tisAudioRecorderEnabled &&\n\t\t\t\t\t!fileUploadMediaTypeBlackList?.match(/audio\\/mp3|audio\\/\\*/i) &&\n\t\t\t\t\t(!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/audio\\/mp3|audio\\/\\*/i)),\n\t\t\t),\n\t\t[fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isAudioRecorderEnabled, isFileUploadEnabled, isMicrophoneDenied],\n\t);\n\n\tconst getMediaActionTitle = useMediaActionTitle('audio', isPermissionDenied, isFileUploadEnabled, isAudioRecorderEnabled, isAllowed);\n\n\tconst chat = useChat();\n\n\tconst stopRecording = useMutableCallback(() => {\n\t\tchat?.action.stop('recording');\n\n\t\tchat?.composer?.setRecordingMode(false);\n\t});\n\n\tconst setMicrophoneDenied = useMutableCallback((isDenied) => {\n\t\tif (isDenied) {\n\t\t\tstopRecording();\n\t\t}\n\n\t\tchat?.composer?.setIsMicrophoneDenied(isDenied);\n\t});\n\n\tuseEffect(() => {\n\t\tsetMicrophoneDenied(isPermissionDenied);\n\t}, [setMicrophoneDenied, isPermissionDenied]);\n\n\tconst handleRecordButtonClick = () => chat?.composer?.setRecordingMode(true);\n\n\treturn {\n\t\tid: 'audio-message',\n\t\tcontent: getMediaActionTitle,\n\t\ticon: 'mic',\n\t\tdisabled: !isAllowed || Boolean(disabled),\n\t\tonClick: handleRecordButtonClick,\n\t};\n};\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"99552936bdd5ae6f554464fcc5959dbb3fafb757"}
