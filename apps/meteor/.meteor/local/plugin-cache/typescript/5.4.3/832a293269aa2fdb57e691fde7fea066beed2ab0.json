{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/composer/EmojiPicker/EmojiPicker.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/composer/EmojiPicker/EmojiPicker.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/composer/EmojiPicker/EmojiPicker.tsx","inputSourceMap":{"version":3,"file":"client/views/composer/EmojiPicker/EmojiPicker.tsx","sourceRoot":"","sources":["client/views/composer/EmojiPicker/EmojiPicker.tsx"],"names":[],"mappings":"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","sourcesContent":["import { TextInput, Icon, Button, Divider } from '@rocket.chat/fuselage';\nimport { useMediaQuery, useMergedRefs, useOutsideClick } from '@rocket.chat/fuselage-hooks';\nimport {\n\tEmojiPickerCategoryHeader,\n\tEmojiPickerContainer,\n\tEmojiPickerFooter,\n\tEmojiPickerPreviewArea,\n\tEmojiPickerHeader,\n\tEmojiPickerListArea,\n\tEmojiPickerPreview,\n} from '@rocket.chat/ui-client';\nimport { useTranslation, usePermission, useRoute } from '@rocket.chat/ui-contexts';\nimport type { ChangeEvent, KeyboardEvent, MouseEvent, RefObject } from 'react';\nimport React, { useLayoutEffect, useState, useEffect, useRef } from 'react';\nimport type { VirtuosoHandle } from 'react-virtuoso';\n\nimport CategoriesResult from './CategoriesResult';\nimport EmojiPickerCategoryItem from './EmojiPickerCategoryItem';\nimport EmojiPickerDropdown from './EmojiPickerDropDown';\nimport SearchingResult from './SearchingResult';\nimport ToneSelector from './ToneSelector';\nimport ToneSelectorWrapper from './ToneSelector/ToneSelectorWrapper';\nimport { emoji, getCategoriesList, getEmojisBySearchTerm } from '../../../../app/emoji/client';\nimport type { EmojiItem, EmojiCategoryPosition } from '../../../../app/emoji/client';\nimport { usePreviewEmoji, useEmojiPickerData } from '../../../contexts/EmojiPickerContext';\nimport { useIsVisible } from '../../room/hooks/useIsVisible';\n\ntype EmojiPickerProps = {\n\treference: Element;\n\tonClose: () => void;\n\tonPickEmoji: (emoji: string) => void;\n};\n\nconst EmojiPicker = ({ reference, onClose, onPickEmoji }: EmojiPickerProps) => {\n\tconst t = useTranslation();\n\n\tconst ref = useRef<Element | null>(reference);\n\tconst categoriesPosition = useRef<EmojiCategoryPosition[]>([]);\n\tconst virtuosoRef = useRef<VirtuosoHandle>(null);\n\tconst emojiContainerRef = useRef<HTMLDivElement>(null);\n\n\tconst [isVisibleRef, isInputVisible] = useIsVisible();\n\tconst textInputRef = useRef<HTMLInputElement>();\n\n\tconst mergedTextInputRef = useMergedRefs(isVisibleRef, textInputRef);\n\n\tconst emojiCategories = getCategoriesList();\n\n\tconst canManageEmoji = usePermission('manage-emoji');\n\tconst customEmojiRoute = useRoute('emoji-custom');\n\n\tconst [searching, setSearching] = useState(false);\n\tconst [searchTerm, setSearchTerm] = useState('');\n\tconst [searchResults, setSearchResults] = useState<EmojiItem[]>([]);\n\n\tconst { emojiToPreview, handleRemovePreview } = usePreviewEmoji();\n\tconst {\n\t\trecentEmojis,\n\t\tsetCurrentCategory,\n\t\taddRecentEmoji,\n\t\tsetRecentEmojis,\n\t\tactualTone,\n\t\tcurrentCategory,\n\t\tgetEmojiListsByCategory,\n\t\tcustomItemsLimit,\n\t\tsetActualTone,\n\t\tsetCustomItemsLimit,\n\t} = useEmojiPickerData();\n\n\tuseEffect(() => () => handleRemovePreview(), [handleRemovePreview]);\n\n\tconst scrollCategories = useMediaQuery('(width < 340px)');\n\n\tuseOutsideClick([emojiContainerRef], onClose);\n\n\tuseLayoutEffect(() => {\n\t\tif (!reference) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst resizeObserver = new ResizeObserver(() => {\n\t\t\tconst anchorRect = reference.getBoundingClientRect();\n\t\t\tif (anchorRect.width === 0 && anchorRect.height === 0) {\n\t\t\t\t// The element is hidden, skip it\n\t\t\t\tref.current = null;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tref.current = reference;\n\t\t});\n\n\t\tresizeObserver.observe(reference);\n\n\t\treturn () => {\n\t\t\tresizeObserver.disconnect();\n\t\t};\n\t}, [reference]);\n\n\tuseEffect(() => {\n\t\tif (textInputRef.current && isInputVisible) {\n\t\t\ttextInputRef.current.focus();\n\t\t}\n\t}, [isInputVisible]);\n\n\tconst handleSelectEmoji = (event: MouseEvent<HTMLElement>) => {\n\t\tevent.stopPropagation();\n\n\t\tconst _emoji = event.currentTarget.dataset?.emoji;\n\n\t\tif (!_emoji) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet tone = '';\n\n\t\tfor (const emojiPackage in emoji.packages) {\n\t\t\tif (emoji.packages.hasOwnProperty(emojiPackage)) {\n\t\t\t\tif (actualTone > 0 && emoji.packages[emojiPackage].toneList.hasOwnProperty(_emoji)) {\n\t\t\t\t\ttone = `_tone${actualTone}`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tsetSearchTerm('');\n\n\t\tonPickEmoji(_emoji + tone);\n\t\taddRecentEmoji(_emoji + tone);\n\t\tonClose();\n\t};\n\n\tuseEffect(() => {\n\t\tif (recentEmojis.length === 0 && currentCategory === 'recent') {\n\t\t\tconst customEmojiList = getEmojiListsByCategory().filter(({ key }) => key === 'rocket');\n\t\t\thandleGoToCategory(customEmojiList.length > 0 ? 0 : 1);\n\t\t}\n\t}, [actualTone, recentEmojis, getEmojiListsByCategory, currentCategory, setRecentEmojis]);\n\n\tconst handleSearch = (e: ChangeEvent<HTMLInputElement>) => {\n\t\tsetSearchTerm(e.target.value);\n\t\tsetCurrentCategory('');\n\t\tsetSearching(e.target.value !== '');\n\n\t\tconst emojisResult = getEmojisBySearchTerm(e.target.value, actualTone, recentEmojis, setRecentEmojis);\n\n\t\tif (emojisResult.filter((emoji) => emoji.image).length === 0) {\n\t\t\tsetCurrentCategory('no-results');\n\t\t}\n\t\tsetSearchResults(emojisResult as EmojiItem[]);\n\t};\n\n\tconst handleKeyDown = (e: KeyboardEvent<HTMLInputElement>) => {\n\t\tif (e.key === 'Escape') {\n\t\t\tonClose();\n\t\t}\n\t};\n\n\tconst handleLoadMore = () => {\n\t\tsetCustomItemsLimit(customItemsLimit + 90);\n\t};\n\n\t// FIXME: not able to type the event scroll yet due the virtuoso version\n\tconst handleScroll = (event: any) => {\n\t\tconst scrollTop = event?.scrollTop;\n\t\tconst last = categoriesPosition.current?.filter((pos) => pos.top <= scrollTop).pop();\n\n\t\tif (!last) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { el } = last;\n\t\tconst category = el.id.replace('emoji-list-category-', '');\n\n\t\tsetCurrentCategory(category);\n\t};\n\n\tconst handleGoToCategory = (categoryIndex: number) => {\n\t\tsetSearching(false);\n\t\tvirtuosoRef.current?.scrollToIndex({ index: categoryIndex });\n\t};\n\n\tconst handleGoToAddCustom = () => {\n\t\tcustomEmojiRoute.push();\n\t\tonClose();\n\t};\n\n\treturn (\n\t\t<EmojiPickerDropdown reference={ref as RefObject<HTMLElement>} ref={emojiContainerRef}>\n\t\t\t<EmojiPickerContainer role='dialog' aria-label={t('Emoji_picker')} onKeyDown={handleKeyDown}>\n\t\t\t\t<EmojiPickerHeader>\n\t\t\t\t\t<TextInput\n\t\t\t\t\t\t// FIXME: remove autoFocus prop when rewriting the emojiPicker dropdown\n\t\t\t\t\t\tautoFocus\n\t\t\t\t\t\tref={mergedTextInputRef}\n\t\t\t\t\t\tvalue={searchTerm}\n\t\t\t\t\t\tonChange={handleSearch}\n\t\t\t\t\t\taddon={<Icon name='magnifier' size='x20' />}\n\t\t\t\t\t\tplaceholder={t('Search')}\n\t\t\t\t\t\taria-label={t('Search')}\n\t\t\t\t\t/>\n\t\t\t\t</EmojiPickerHeader>\n\t\t\t\t<EmojiPickerCategoryHeader role='tablist' {...(scrollCategories && { style: { overflowX: 'scroll' } })}>\n\t\t\t\t\t{emojiCategories.map((category, index) => (\n\t\t\t\t\t\t<EmojiPickerCategoryItem\n\t\t\t\t\t\t\tkey={category.key}\n\t\t\t\t\t\t\tindex={index}\n\t\t\t\t\t\t\tcategory={category}\n\t\t\t\t\t\t\tactive={category.key === currentCategory}\n\t\t\t\t\t\t\thandleGoToCategory={handleGoToCategory}\n\t\t\t\t\t\t/>\n\t\t\t\t\t))}\n\t\t\t\t</EmojiPickerCategoryHeader>\n\t\t\t\t<Divider mb={12} />\n\t\t\t\t<EmojiPickerListArea role='tabpanel'>\n\t\t\t\t\t{searching && <SearchingResult searchResults={searchResults} handleSelectEmoji={handleSelectEmoji} />}\n\t\t\t\t\t{!searching && (\n\t\t\t\t\t\t<CategoriesResult\n\t\t\t\t\t\t\tref={virtuosoRef}\n\t\t\t\t\t\t\temojiListByCategory={getEmojiListsByCategory()}\n\t\t\t\t\t\t\tcategoriesPosition={categoriesPosition}\n\t\t\t\t\t\t\tcustomItemsLimit={customItemsLimit}\n\t\t\t\t\t\t\thandleLoadMore={handleLoadMore}\n\t\t\t\t\t\t\thandleSelectEmoji={handleSelectEmoji}\n\t\t\t\t\t\t\thandleScroll={handleScroll}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</EmojiPickerListArea>\n\t\t\t\t<EmojiPickerPreviewArea>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{emojiToPreview && <EmojiPickerPreview emoji={emojiToPreview.emoji} name={emojiToPreview.name} />}\n\t\t\t\t\t\t{canManageEmoji && emojiToPreview === null && (\n\t\t\t\t\t\t\t<Button small onClick={handleGoToAddCustom}>\n\t\t\t\t\t\t\t\t{t('Add_emoji')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<ToneSelectorWrapper caption={t('Skin_tone')}>\n\t\t\t\t\t\t<ToneSelector tone={actualTone} setTone={setActualTone} />\n\t\t\t\t\t</ToneSelectorWrapper>\n\t\t\t\t</EmojiPickerPreviewArea>\n\t\t\t\t<EmojiPickerFooter>{t('Powered_by_JoyPixels')}</EmojiPickerFooter>\n\t\t\t</EmojiPickerContainer>\n\t\t</EmojiPickerDropdown>\n\t);\n};\n\nexport default EmojiPicker;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/composer/EmojiPicker/EmojiPicker.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/composer/EmojiPicker/EmojiPicker.tsx","inputSourceMap":{"version":3,"file":"client/views/composer/EmojiPicker/EmojiPicker.tsx","sourceRoot":"","sources":["client/views/composer/EmojiPicker/EmojiPicker.tsx"],"names":[],"mappings":"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","sourcesContent":["import { TextInput, Icon, Button, Divider } from '@rocket.chat/fuselage';\nimport { useMediaQuery, useMergedRefs, useOutsideClick } from '@rocket.chat/fuselage-hooks';\nimport {\n\tEmojiPickerCategoryHeader,\n\tEmojiPickerContainer,\n\tEmojiPickerFooter,\n\tEmojiPickerPreviewArea,\n\tEmojiPickerHeader,\n\tEmojiPickerListArea,\n\tEmojiPickerPreview,\n} from '@rocket.chat/ui-client';\nimport { useTranslation, usePermission, useRoute } from '@rocket.chat/ui-contexts';\nimport type { ChangeEvent, KeyboardEvent, MouseEvent, RefObject } from 'react';\nimport React, { useLayoutEffect, useState, useEffect, useRef } from 'react';\nimport type { VirtuosoHandle } from 'react-virtuoso';\n\nimport CategoriesResult from './CategoriesResult';\nimport EmojiPickerCategoryItem from './EmojiPickerCategoryItem';\nimport EmojiPickerDropdown from './EmojiPickerDropDown';\nimport SearchingResult from './SearchingResult';\nimport ToneSelector from './ToneSelector';\nimport ToneSelectorWrapper from './ToneSelector/ToneSelectorWrapper';\nimport { emoji, getCategoriesList, getEmojisBySearchTerm } from '../../../../app/emoji/client';\nimport type { EmojiItem, EmojiCategoryPosition } from '../../../../app/emoji/client';\nimport { usePreviewEmoji, useEmojiPickerData } from '../../../contexts/EmojiPickerContext';\nimport { useIsVisible } from '../../room/hooks/useIsVisible';\n\ntype EmojiPickerProps = {\n\treference: Element;\n\tonClose: () => void;\n\tonPickEmoji: (emoji: string) => void;\n};\n\nconst EmojiPicker = ({ reference, onClose, onPickEmoji }: EmojiPickerProps) => {\n\tconst t = useTranslation();\n\n\tconst ref = useRef<Element | null>(reference);\n\tconst categoriesPosition = useRef<EmojiCategoryPosition[]>([]);\n\tconst virtuosoRef = useRef<VirtuosoHandle>(null);\n\tconst emojiContainerRef = useRef<HTMLDivElement>(null);\n\n\tconst [isVisibleRef, isInputVisible] = useIsVisible();\n\tconst textInputRef = useRef<HTMLInputElement>();\n\n\tconst mergedTextInputRef = useMergedRefs(isVisibleRef, textInputRef);\n\n\tconst emojiCategories = getCategoriesList();\n\n\tconst canManageEmoji = usePermission('manage-emoji');\n\tconst customEmojiRoute = useRoute('emoji-custom');\n\n\tconst [searching, setSearching] = useState(false);\n\tconst [searchTerm, setSearchTerm] = useState('');\n\tconst [searchResults, setSearchResults] = useState<EmojiItem[]>([]);\n\n\tconst { emojiToPreview, handleRemovePreview } = usePreviewEmoji();\n\tconst {\n\t\trecentEmojis,\n\t\tsetCurrentCategory,\n\t\taddRecentEmoji,\n\t\tsetRecentEmojis,\n\t\tactualTone,\n\t\tcurrentCategory,\n\t\tgetEmojiListsByCategory,\n\t\tcustomItemsLimit,\n\t\tsetActualTone,\n\t\tsetCustomItemsLimit,\n\t} = useEmojiPickerData();\n\n\tuseEffect(() => () => handleRemovePreview(), [handleRemovePreview]);\n\n\tconst scrollCategories = useMediaQuery('(width < 340px)');\n\n\tuseOutsideClick([emojiContainerRef], onClose);\n\n\tuseLayoutEffect(() => {\n\t\tif (!reference) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst resizeObserver = new ResizeObserver(() => {\n\t\t\tconst anchorRect = reference.getBoundingClientRect();\n\t\t\tif (anchorRect.width === 0 && anchorRect.height === 0) {\n\t\t\t\t// The element is hidden, skip it\n\t\t\t\tref.current = null;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tref.current = reference;\n\t\t});\n\n\t\tresizeObserver.observe(reference);\n\n\t\treturn () => {\n\t\t\tresizeObserver.disconnect();\n\t\t};\n\t}, [reference]);\n\n\tuseEffect(() => {\n\t\tif (textInputRef.current && isInputVisible) {\n\t\t\ttextInputRef.current.focus();\n\t\t}\n\t}, [isInputVisible]);\n\n\tconst handleSelectEmoji = (event: MouseEvent<HTMLElement>) => {\n\t\tevent.stopPropagation();\n\n\t\tconst _emoji = event.currentTarget.dataset?.emoji;\n\n\t\tif (!_emoji) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet tone = '';\n\n\t\tfor (const emojiPackage in emoji.packages) {\n\t\t\tif (emoji.packages.hasOwnProperty(emojiPackage)) {\n\t\t\t\tif (actualTone > 0 && emoji.packages[emojiPackage].toneList.hasOwnProperty(_emoji)) {\n\t\t\t\t\ttone = `_tone${actualTone}`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tsetSearchTerm('');\n\n\t\tonPickEmoji(_emoji + tone);\n\t\taddRecentEmoji(_emoji + tone);\n\t\tonClose();\n\t};\n\n\tuseEffect(() => {\n\t\tif (recentEmojis.length === 0 && currentCategory === 'recent') {\n\t\t\tconst customEmojiList = getEmojiListsByCategory().filter(({ key }) => key === 'rocket');\n\t\t\thandleGoToCategory(customEmojiList.length > 0 ? 0 : 1);\n\t\t}\n\t}, [actualTone, recentEmojis, getEmojiListsByCategory, currentCategory, setRecentEmojis]);\n\n\tconst handleSearch = (e: ChangeEvent<HTMLInputElement>) => {\n\t\tsetSearchTerm(e.target.value);\n\t\tsetCurrentCategory('');\n\t\tsetSearching(e.target.value !== '');\n\n\t\tconst emojisResult = getEmojisBySearchTerm(e.target.value, actualTone, recentEmojis, setRecentEmojis);\n\n\t\tif (emojisResult.filter((emoji) => emoji.image).length === 0) {\n\t\t\tsetCurrentCategory('no-results');\n\t\t}\n\t\tsetSearchResults(emojisResult as EmojiItem[]);\n\t};\n\n\tconst handleKeyDown = (e: KeyboardEvent<HTMLInputElement>) => {\n\t\tif (e.key === 'Escape') {\n\t\t\tonClose();\n\t\t}\n\t};\n\n\tconst handleLoadMore = () => {\n\t\tsetCustomItemsLimit(customItemsLimit + 90);\n\t};\n\n\t// FIXME: not able to type the event scroll yet due the virtuoso version\n\tconst handleScroll = (event: any) => {\n\t\tconst scrollTop = event?.scrollTop;\n\t\tconst last = categoriesPosition.current?.filter((pos) => pos.top <= scrollTop).pop();\n\n\t\tif (!last) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { el } = last;\n\t\tconst category = el.id.replace('emoji-list-category-', '');\n\n\t\tsetCurrentCategory(category);\n\t};\n\n\tconst handleGoToCategory = (categoryIndex: number) => {\n\t\tsetSearching(false);\n\t\tvirtuosoRef.current?.scrollToIndex({ index: categoryIndex });\n\t};\n\n\tconst handleGoToAddCustom = () => {\n\t\tcustomEmojiRoute.push();\n\t\tonClose();\n\t};\n\n\treturn (\n\t\t<EmojiPickerDropdown reference={ref as RefObject<HTMLElement>} ref={emojiContainerRef}>\n\t\t\t<EmojiPickerContainer role='dialog' aria-label={t('Emoji_picker')} onKeyDown={handleKeyDown}>\n\t\t\t\t<EmojiPickerHeader>\n\t\t\t\t\t<TextInput\n\t\t\t\t\t\t// FIXME: remove autoFocus prop when rewriting the emojiPicker dropdown\n\t\t\t\t\t\tautoFocus\n\t\t\t\t\t\tref={mergedTextInputRef}\n\t\t\t\t\t\tvalue={searchTerm}\n\t\t\t\t\t\tonChange={handleSearch}\n\t\t\t\t\t\taddon={<Icon name='magnifier' size='x20' />}\n\t\t\t\t\t\tplaceholder={t('Search')}\n\t\t\t\t\t\taria-label={t('Search')}\n\t\t\t\t\t/>\n\t\t\t\t</EmojiPickerHeader>\n\t\t\t\t<EmojiPickerCategoryHeader role='tablist' {...(scrollCategories && { style: { overflowX: 'scroll' } })}>\n\t\t\t\t\t{emojiCategories.map((category, index) => (\n\t\t\t\t\t\t<EmojiPickerCategoryItem\n\t\t\t\t\t\t\tkey={category.key}\n\t\t\t\t\t\t\tindex={index}\n\t\t\t\t\t\t\tcategory={category}\n\t\t\t\t\t\t\tactive={category.key === currentCategory}\n\t\t\t\t\t\t\thandleGoToCategory={handleGoToCategory}\n\t\t\t\t\t\t/>\n\t\t\t\t\t))}\n\t\t\t\t</EmojiPickerCategoryHeader>\n\t\t\t\t<Divider mb={12} />\n\t\t\t\t<EmojiPickerListArea role='tabpanel'>\n\t\t\t\t\t{searching && <SearchingResult searchResults={searchResults} handleSelectEmoji={handleSelectEmoji} />}\n\t\t\t\t\t{!searching && (\n\t\t\t\t\t\t<CategoriesResult\n\t\t\t\t\t\t\tref={virtuosoRef}\n\t\t\t\t\t\t\temojiListByCategory={getEmojiListsByCategory()}\n\t\t\t\t\t\t\tcategoriesPosition={categoriesPosition}\n\t\t\t\t\t\t\tcustomItemsLimit={customItemsLimit}\n\t\t\t\t\t\t\thandleLoadMore={handleLoadMore}\n\t\t\t\t\t\t\thandleSelectEmoji={handleSelectEmoji}\n\t\t\t\t\t\t\thandleScroll={handleScroll}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</EmojiPickerListArea>\n\t\t\t\t<EmojiPickerPreviewArea>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{emojiToPreview && <EmojiPickerPreview emoji={emojiToPreview.emoji} name={emojiToPreview.name} />}\n\t\t\t\t\t\t{canManageEmoji && emojiToPreview === null && (\n\t\t\t\t\t\t\t<Button small onClick={handleGoToAddCustom}>\n\t\t\t\t\t\t\t\t{t('Add_emoji')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<ToneSelectorWrapper caption={t('Skin_tone')}>\n\t\t\t\t\t\t<ToneSelector tone={actualTone} setTone={setActualTone} />\n\t\t\t\t\t</ToneSelectorWrapper>\n\t\t\t\t</EmojiPickerPreviewArea>\n\t\t\t\t<EmojiPickerFooter>{t('Powered_by_JoyPixels')}</EmojiPickerFooter>\n\t\t\t</EmojiPickerContainer>\n\t\t</EmojiPickerDropdown>\n\t);\n};\n\nexport default EmojiPicker;\n"]}}},"code":"let _extends;\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default(v) {\n    _extends = v;\n  }\n}, 0);\nlet TextInput, Icon, Button, Divider;\nmodule.link(\"@rocket.chat/fuselage\", {\n  TextInput(v) {\n    TextInput = v;\n  },\n  Icon(v) {\n    Icon = v;\n  },\n  Button(v) {\n    Button = v;\n  },\n  Divider(v) {\n    Divider = v;\n  }\n}, 0);\nlet useMediaQuery, useMergedRefs, useOutsideClick;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMediaQuery(v) {\n    useMediaQuery = v;\n  },\n  useMergedRefs(v) {\n    useMergedRefs = v;\n  },\n  useOutsideClick(v) {\n    useOutsideClick = v;\n  }\n}, 1);\nlet EmojiPickerCategoryHeader, EmojiPickerContainer, EmojiPickerFooter, EmojiPickerPreviewArea, EmojiPickerHeader, EmojiPickerListArea, EmojiPickerPreview;\nmodule.link(\"@rocket.chat/ui-client\", {\n  EmojiPickerCategoryHeader(v) {\n    EmojiPickerCategoryHeader = v;\n  },\n  EmojiPickerContainer(v) {\n    EmojiPickerContainer = v;\n  },\n  EmojiPickerFooter(v) {\n    EmojiPickerFooter = v;\n  },\n  EmojiPickerPreviewArea(v) {\n    EmojiPickerPreviewArea = v;\n  },\n  EmojiPickerHeader(v) {\n    EmojiPickerHeader = v;\n  },\n  EmojiPickerListArea(v) {\n    EmojiPickerListArea = v;\n  },\n  EmojiPickerPreview(v) {\n    EmojiPickerPreview = v;\n  }\n}, 2);\nlet useTranslation, usePermission, useRoute;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useTranslation(v) {\n    useTranslation = v;\n  },\n  usePermission(v) {\n    usePermission = v;\n  },\n  useRoute(v) {\n    useRoute = v;\n  }\n}, 3);\nlet React, useLayoutEffect, useState, useEffect, useRef;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n  useLayoutEffect(v) {\n    useLayoutEffect = v;\n  },\n  useState(v) {\n    useState = v;\n  },\n  useEffect(v) {\n    useEffect = v;\n  },\n  useRef(v) {\n    useRef = v;\n  }\n}, 4);\nlet CategoriesResult;\nmodule.link(\"./CategoriesResult\", {\n  default(v) {\n    CategoriesResult = v;\n  }\n}, 5);\nlet EmojiPickerCategoryItem;\nmodule.link(\"./EmojiPickerCategoryItem\", {\n  default(v) {\n    EmojiPickerCategoryItem = v;\n  }\n}, 6);\nlet EmojiPickerDropdown;\nmodule.link(\"./EmojiPickerDropDown\", {\n  default(v) {\n    EmojiPickerDropdown = v;\n  }\n}, 7);\nlet SearchingResult;\nmodule.link(\"./SearchingResult\", {\n  default(v) {\n    SearchingResult = v;\n  }\n}, 8);\nlet ToneSelector;\nmodule.link(\"./ToneSelector\", {\n  default(v) {\n    ToneSelector = v;\n  }\n}, 9);\nlet ToneSelectorWrapper;\nmodule.link(\"./ToneSelector/ToneSelectorWrapper\", {\n  default(v) {\n    ToneSelectorWrapper = v;\n  }\n}, 10);\nlet emoji, getCategoriesList, getEmojisBySearchTerm;\nmodule.link(\"../../../../app/emoji/client\", {\n  emoji(v) {\n    emoji = v;\n  },\n  getCategoriesList(v) {\n    getCategoriesList = v;\n  },\n  getEmojisBySearchTerm(v) {\n    getEmojisBySearchTerm = v;\n  }\n}, 11);\nlet usePreviewEmoji, useEmojiPickerData;\nmodule.link(\"../../../contexts/EmojiPickerContext\", {\n  usePreviewEmoji(v) {\n    usePreviewEmoji = v;\n  },\n  useEmojiPickerData(v) {\n    useEmojiPickerData = v;\n  }\n}, 12);\nlet useIsVisible;\nmodule.link(\"../../room/hooks/useIsVisible\", {\n  useIsVisible(v) {\n    useIsVisible = v;\n  }\n}, 13);\nconst EmojiPicker = _ref => {\n  let {\n    reference,\n    onClose,\n    onPickEmoji\n  } = _ref;\n  const t = useTranslation();\n  const ref = useRef(reference);\n  const categoriesPosition = useRef([]);\n  const virtuosoRef = useRef(null);\n  const emojiContainerRef = useRef(null);\n  const [isVisibleRef, isInputVisible] = useIsVisible();\n  const textInputRef = useRef();\n  const mergedTextInputRef = useMergedRefs(isVisibleRef, textInputRef);\n  const emojiCategories = getCategoriesList();\n  const canManageEmoji = usePermission('manage-emoji');\n  const customEmojiRoute = useRoute('emoji-custom');\n  const [searching, setSearching] = useState(false);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [searchResults, setSearchResults] = useState([]);\n  const {\n    emojiToPreview,\n    handleRemovePreview\n  } = usePreviewEmoji();\n  const {\n    recentEmojis,\n    setCurrentCategory,\n    addRecentEmoji,\n    setRecentEmojis,\n    actualTone,\n    currentCategory,\n    getEmojiListsByCategory,\n    customItemsLimit,\n    setActualTone,\n    setCustomItemsLimit\n  } = useEmojiPickerData();\n  useEffect(() => () => handleRemovePreview(), [handleRemovePreview]);\n  const scrollCategories = useMediaQuery('(width < 340px)');\n  useOutsideClick([emojiContainerRef], onClose);\n  useLayoutEffect(() => {\n    if (!reference) {\n      return;\n    }\n    const resizeObserver = new ResizeObserver(() => {\n      const anchorRect = reference.getBoundingClientRect();\n      if (anchorRect.width === 0 && anchorRect.height === 0) {\n        // The element is hidden, skip it\n        ref.current = null;\n        return;\n      }\n      ref.current = reference;\n    });\n    resizeObserver.observe(reference);\n    return () => {\n      resizeObserver.disconnect();\n    };\n  }, [reference]);\n  useEffect(() => {\n    if (textInputRef.current && isInputVisible) {\n      textInputRef.current.focus();\n    }\n  }, [isInputVisible]);\n  const handleSelectEmoji = event => {\n    var _event$currentTarget$;\n    event.stopPropagation();\n    const _emoji = (_event$currentTarget$ = event.currentTarget.dataset) === null || _event$currentTarget$ === void 0 ? void 0 : _event$currentTarget$.emoji;\n    if (!_emoji) {\n      return;\n    }\n    let tone = '';\n    for (const emojiPackage in emoji.packages) {\n      if (emoji.packages.hasOwnProperty(emojiPackage)) {\n        if (actualTone > 0 && emoji.packages[emojiPackage].toneList.hasOwnProperty(_emoji)) {\n          tone = \"_tone\".concat(actualTone);\n        }\n      }\n    }\n    setSearchTerm('');\n    onPickEmoji(_emoji + tone);\n    addRecentEmoji(_emoji + tone);\n    onClose();\n  };\n  useEffect(() => {\n    if (recentEmojis.length === 0 && currentCategory === 'recent') {\n      const customEmojiList = getEmojiListsByCategory().filter(_ref2 => {\n        let {\n          key\n        } = _ref2;\n        return key === 'rocket';\n      });\n      handleGoToCategory(customEmojiList.length > 0 ? 0 : 1);\n    }\n  }, [actualTone, recentEmojis, getEmojiListsByCategory, currentCategory, setRecentEmojis]);\n  const handleSearch = e => {\n    setSearchTerm(e.target.value);\n    setCurrentCategory('');\n    setSearching(e.target.value !== '');\n    const emojisResult = getEmojisBySearchTerm(e.target.value, actualTone, recentEmojis, setRecentEmojis);\n    if (emojisResult.filter(emoji => emoji.image).length === 0) {\n      setCurrentCategory('no-results');\n    }\n    setSearchResults(emojisResult);\n  };\n  const handleKeyDown = e => {\n    if (e.key === 'Escape') {\n      onClose();\n    }\n  };\n  const handleLoadMore = () => {\n    setCustomItemsLimit(customItemsLimit + 90);\n  };\n  // FIXME: not able to type the event scroll yet due the virtuoso version\n  const handleScroll = event => {\n    var _categoriesPosition$c;\n    const scrollTop = event === null || event === void 0 ? void 0 : event.scrollTop;\n    const last = (_categoriesPosition$c = categoriesPosition.current) === null || _categoriesPosition$c === void 0 ? void 0 : _categoriesPosition$c.filter(pos => pos.top <= scrollTop).pop();\n    if (!last) {\n      return;\n    }\n    const {\n      el\n    } = last;\n    const category = el.id.replace('emoji-list-category-', '');\n    setCurrentCategory(category);\n  };\n  const handleGoToCategory = categoryIndex => {\n    var _virtuosoRef$current;\n    setSearching(false);\n    (_virtuosoRef$current = virtuosoRef.current) === null || _virtuosoRef$current === void 0 ? void 0 : _virtuosoRef$current.scrollToIndex({\n      index: categoryIndex\n    });\n  };\n  const handleGoToAddCustom = () => {\n    customEmojiRoute.push();\n    onClose();\n  };\n  return /*#__PURE__*/React.createElement(EmojiPickerDropdown, {\n    reference: ref,\n    ref: emojiContainerRef\n  }, /*#__PURE__*/React.createElement(EmojiPickerContainer, {\n    role: \"dialog\",\n    \"aria-label\": t('Emoji_picker'),\n    onKeyDown: handleKeyDown\n  }, /*#__PURE__*/React.createElement(EmojiPickerHeader, null, /*#__PURE__*/React.createElement(TextInput\n  // FIXME: remove autoFocus prop when rewriting the emojiPicker dropdown\n  , {\n    autoFocus: true,\n    ref: mergedTextInputRef,\n    value: searchTerm,\n    onChange: handleSearch,\n    addon: /*#__PURE__*/React.createElement(Icon, {\n      name: \"magnifier\",\n      size: \"x20\"\n    }),\n    placeholder: t('Search'),\n    \"aria-label\": t('Search')\n  })), /*#__PURE__*/React.createElement(EmojiPickerCategoryHeader, _extends({\n    role: \"tablist\"\n  }, scrollCategories && {\n    style: {\n      overflowX: 'scroll'\n    }\n  }), emojiCategories.map((category, index) => /*#__PURE__*/React.createElement(EmojiPickerCategoryItem, {\n    key: category.key,\n    index: index,\n    category: category,\n    active: category.key === currentCategory,\n    handleGoToCategory: handleGoToCategory\n  }))), /*#__PURE__*/React.createElement(Divider, {\n    mb: 12\n  }), /*#__PURE__*/React.createElement(EmojiPickerListArea, {\n    role: \"tabpanel\"\n  }, searching && /*#__PURE__*/React.createElement(SearchingResult, {\n    searchResults: searchResults,\n    handleSelectEmoji: handleSelectEmoji\n  }), !searching && /*#__PURE__*/React.createElement(CategoriesResult, {\n    ref: virtuosoRef,\n    emojiListByCategory: getEmojiListsByCategory(),\n    categoriesPosition: categoriesPosition,\n    customItemsLimit: customItemsLimit,\n    handleLoadMore: handleLoadMore,\n    handleSelectEmoji: handleSelectEmoji,\n    handleScroll: handleScroll\n  })), /*#__PURE__*/React.createElement(EmojiPickerPreviewArea, null, /*#__PURE__*/React.createElement(\"div\", null, emojiToPreview && /*#__PURE__*/React.createElement(EmojiPickerPreview, {\n    emoji: emojiToPreview.emoji,\n    name: emojiToPreview.name\n  }), canManageEmoji && emojiToPreview === null && /*#__PURE__*/React.createElement(Button, {\n    small: true,\n    onClick: handleGoToAddCustom\n  }, t('Add_emoji'))), /*#__PURE__*/React.createElement(ToneSelectorWrapper, {\n    caption: t('Skin_tone')\n  }, /*#__PURE__*/React.createElement(ToneSelector, {\n    tone: actualTone,\n    setTone: setActualTone\n  }))), /*#__PURE__*/React.createElement(EmojiPickerFooter, null, t('Powered_by_JoyPixels'))));\n};\nmodule.exportDefault(EmojiPicker);","map":{"version":3,"names":["_extends","module","link","default","v","TextInput","Icon","Button","Divider","useMediaQuery","useMergedRefs","useOutsideClick","EmojiPickerCategoryHeader","EmojiPickerContainer","EmojiPickerFooter","EmojiPickerPreviewArea","EmojiPickerHeader","EmojiPickerListArea","EmojiPickerPreview","useTranslation","usePermission","useRoute","React","useLayoutEffect","useState","useEffect","useRef","CategoriesResult","EmojiPickerCategoryItem","EmojiPickerDropdown","SearchingResult","ToneSelector","ToneSelectorWrapper","emoji","getCategoriesList","getEmojisBySearchTerm","usePreviewEmoji","useEmojiPickerData","useIsVisible","EmojiPicker","_ref","reference","onClose","onPickEmoji","t","ref","categoriesPosition","virtuosoRef","emojiContainerRef","isVisibleRef","isInputVisible","textInputRef","mergedTextInputRef","emojiCategories","canManageEmoji","customEmojiRoute","searching","setSearching","searchTerm","setSearchTerm","searchResults","setSearchResults","emojiToPreview","handleRemovePreview","recentEmojis","setCurrentCategory","addRecentEmoji","setRecentEmojis","actualTone","currentCategory","getEmojiListsByCategory","customItemsLimit","setActualTone","setCustomItemsLimit","scrollCategories","resizeObserver","ResizeObserver","anchorRect","getBoundingClientRect","width","height","current","observe","disconnect","focus","handleSelectEmoji","event","_event$currentTarget$","stopPropagation","_emoji","currentTarget","dataset","tone","emojiPackage","packages","hasOwnProperty","toneList","concat","length","customEmojiList","filter","_ref2","key","handleGoToCategory","handleSearch","e","target","value","emojisResult","image","handleKeyDown","handleLoadMore","handleScroll","_categoriesPosition$c","scrollTop","last","pos","top","pop","el","category","id","replace","categoryIndex","_virtuosoRef$current","scrollToIndex","index","handleGoToAddCustom","push","createElement","role","onKeyDown","autoFocus","onChange","addon","name","size","placeholder","style","overflowX","map","active","mb","emojiListByCategory","small","onClick","caption","setTone","exportDefault"],"sources":["client/views/composer/EmojiPicker/EmojiPicker.tsx"],"sourcesContent":["import { TextInput, Icon, Button, Divider } from '@rocket.chat/fuselage';\nimport { useMediaQuery, useMergedRefs, useOutsideClick } from '@rocket.chat/fuselage-hooks';\nimport {\n\tEmojiPickerCategoryHeader,\n\tEmojiPickerContainer,\n\tEmojiPickerFooter,\n\tEmojiPickerPreviewArea,\n\tEmojiPickerHeader,\n\tEmojiPickerListArea,\n\tEmojiPickerPreview,\n} from '@rocket.chat/ui-client';\nimport { useTranslation, usePermission, useRoute } from '@rocket.chat/ui-contexts';\nimport type { ChangeEvent, KeyboardEvent, MouseEvent, RefObject } from 'react';\nimport React, { useLayoutEffect, useState, useEffect, useRef } from 'react';\nimport type { VirtuosoHandle } from 'react-virtuoso';\n\nimport CategoriesResult from './CategoriesResult';\nimport EmojiPickerCategoryItem from './EmojiPickerCategoryItem';\nimport EmojiPickerDropdown from './EmojiPickerDropDown';\nimport SearchingResult from './SearchingResult';\nimport ToneSelector from './ToneSelector';\nimport ToneSelectorWrapper from './ToneSelector/ToneSelectorWrapper';\nimport { emoji, getCategoriesList, getEmojisBySearchTerm } from '../../../../app/emoji/client';\nimport type { EmojiItem, EmojiCategoryPosition } from '../../../../app/emoji/client';\nimport { usePreviewEmoji, useEmojiPickerData } from '../../../contexts/EmojiPickerContext';\nimport { useIsVisible } from '../../room/hooks/useIsVisible';\n\ntype EmojiPickerProps = {\n\treference: Element;\n\tonClose: () => void;\n\tonPickEmoji: (emoji: string) => void;\n};\n\nconst EmojiPicker = ({ reference, onClose, onPickEmoji }: EmojiPickerProps) => {\n\tconst t = useTranslation();\n\n\tconst ref = useRef<Element | null>(reference);\n\tconst categoriesPosition = useRef<EmojiCategoryPosition[]>([]);\n\tconst virtuosoRef = useRef<VirtuosoHandle>(null);\n\tconst emojiContainerRef = useRef<HTMLDivElement>(null);\n\n\tconst [isVisibleRef, isInputVisible] = useIsVisible();\n\tconst textInputRef = useRef<HTMLInputElement>();\n\n\tconst mergedTextInputRef = useMergedRefs(isVisibleRef, textInputRef);\n\n\tconst emojiCategories = getCategoriesList();\n\n\tconst canManageEmoji = usePermission('manage-emoji');\n\tconst customEmojiRoute = useRoute('emoji-custom');\n\n\tconst [searching, setSearching] = useState(false);\n\tconst [searchTerm, setSearchTerm] = useState('');\n\tconst [searchResults, setSearchResults] = useState<EmojiItem[]>([]);\n\n\tconst { emojiToPreview, handleRemovePreview } = usePreviewEmoji();\n\tconst {\n\t\trecentEmojis,\n\t\tsetCurrentCategory,\n\t\taddRecentEmoji,\n\t\tsetRecentEmojis,\n\t\tactualTone,\n\t\tcurrentCategory,\n\t\tgetEmojiListsByCategory,\n\t\tcustomItemsLimit,\n\t\tsetActualTone,\n\t\tsetCustomItemsLimit,\n\t} = useEmojiPickerData();\n\n\tuseEffect(() => () => handleRemovePreview(), [handleRemovePreview]);\n\n\tconst scrollCategories = useMediaQuery('(width < 340px)');\n\n\tuseOutsideClick([emojiContainerRef], onClose);\n\n\tuseLayoutEffect(() => {\n\t\tif (!reference) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst resizeObserver = new ResizeObserver(() => {\n\t\t\tconst anchorRect = reference.getBoundingClientRect();\n\t\t\tif (anchorRect.width === 0 && anchorRect.height === 0) {\n\t\t\t\t// The element is hidden, skip it\n\t\t\t\tref.current = null;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tref.current = reference;\n\t\t});\n\n\t\tresizeObserver.observe(reference);\n\n\t\treturn () => {\n\t\t\tresizeObserver.disconnect();\n\t\t};\n\t}, [reference]);\n\n\tuseEffect(() => {\n\t\tif (textInputRef.current && isInputVisible) {\n\t\t\ttextInputRef.current.focus();\n\t\t}\n\t}, [isInputVisible]);\n\n\tconst handleSelectEmoji = (event: MouseEvent<HTMLElement>) => {\n\t\tevent.stopPropagation();\n\n\t\tconst _emoji = event.currentTarget.dataset?.emoji;\n\n\t\tif (!_emoji) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet tone = '';\n\n\t\tfor (const emojiPackage in emoji.packages) {\n\t\t\tif (emoji.packages.hasOwnProperty(emojiPackage)) {\n\t\t\t\tif (actualTone > 0 && emoji.packages[emojiPackage].toneList.hasOwnProperty(_emoji)) {\n\t\t\t\t\ttone = `_tone${actualTone}`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tsetSearchTerm('');\n\n\t\tonPickEmoji(_emoji + tone);\n\t\taddRecentEmoji(_emoji + tone);\n\t\tonClose();\n\t};\n\n\tuseEffect(() => {\n\t\tif (recentEmojis.length === 0 && currentCategory === 'recent') {\n\t\t\tconst customEmojiList = getEmojiListsByCategory().filter(({ key }) => key === 'rocket');\n\t\t\thandleGoToCategory(customEmojiList.length > 0 ? 0 : 1);\n\t\t}\n\t}, [actualTone, recentEmojis, getEmojiListsByCategory, currentCategory, setRecentEmojis]);\n\n\tconst handleSearch = (e: ChangeEvent<HTMLInputElement>) => {\n\t\tsetSearchTerm(e.target.value);\n\t\tsetCurrentCategory('');\n\t\tsetSearching(e.target.value !== '');\n\n\t\tconst emojisResult = getEmojisBySearchTerm(e.target.value, actualTone, recentEmojis, setRecentEmojis);\n\n\t\tif (emojisResult.filter((emoji) => emoji.image).length === 0) {\n\t\t\tsetCurrentCategory('no-results');\n\t\t}\n\t\tsetSearchResults(emojisResult as EmojiItem[]);\n\t};\n\n\tconst handleKeyDown = (e: KeyboardEvent<HTMLInputElement>) => {\n\t\tif (e.key === 'Escape') {\n\t\t\tonClose();\n\t\t}\n\t};\n\n\tconst handleLoadMore = () => {\n\t\tsetCustomItemsLimit(customItemsLimit + 90);\n\t};\n\n\t// FIXME: not able to type the event scroll yet due the virtuoso version\n\tconst handleScroll = (event: any) => {\n\t\tconst scrollTop = event?.scrollTop;\n\t\tconst last = categoriesPosition.current?.filter((pos) => pos.top <= scrollTop).pop();\n\n\t\tif (!last) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { el } = last;\n\t\tconst category = el.id.replace('emoji-list-category-', '');\n\n\t\tsetCurrentCategory(category);\n\t};\n\n\tconst handleGoToCategory = (categoryIndex: number) => {\n\t\tsetSearching(false);\n\t\tvirtuosoRef.current?.scrollToIndex({ index: categoryIndex });\n\t};\n\n\tconst handleGoToAddCustom = () => {\n\t\tcustomEmojiRoute.push();\n\t\tonClose();\n\t};\n\n\treturn (\n\t\t<EmojiPickerDropdown reference={ref as RefObject<HTMLElement>} ref={emojiContainerRef}>\n\t\t\t<EmojiPickerContainer role='dialog' aria-label={t('Emoji_picker')} onKeyDown={handleKeyDown}>\n\t\t\t\t<EmojiPickerHeader>\n\t\t\t\t\t<TextInput\n\t\t\t\t\t\t// FIXME: remove autoFocus prop when rewriting the emojiPicker dropdown\n\t\t\t\t\t\tautoFocus\n\t\t\t\t\t\tref={mergedTextInputRef}\n\t\t\t\t\t\tvalue={searchTerm}\n\t\t\t\t\t\tonChange={handleSearch}\n\t\t\t\t\t\taddon={<Icon name='magnifier' size='x20' />}\n\t\t\t\t\t\tplaceholder={t('Search')}\n\t\t\t\t\t\taria-label={t('Search')}\n\t\t\t\t\t/>\n\t\t\t\t</EmojiPickerHeader>\n\t\t\t\t<EmojiPickerCategoryHeader role='tablist' {...(scrollCategories && { style: { overflowX: 'scroll' } })}>\n\t\t\t\t\t{emojiCategories.map((category, index) => (\n\t\t\t\t\t\t<EmojiPickerCategoryItem\n\t\t\t\t\t\t\tkey={category.key}\n\t\t\t\t\t\t\tindex={index}\n\t\t\t\t\t\t\tcategory={category}\n\t\t\t\t\t\t\tactive={category.key === currentCategory}\n\t\t\t\t\t\t\thandleGoToCategory={handleGoToCategory}\n\t\t\t\t\t\t/>\n\t\t\t\t\t))}\n\t\t\t\t</EmojiPickerCategoryHeader>\n\t\t\t\t<Divider mb={12} />\n\t\t\t\t<EmojiPickerListArea role='tabpanel'>\n\t\t\t\t\t{searching && <SearchingResult searchResults={searchResults} handleSelectEmoji={handleSelectEmoji} />}\n\t\t\t\t\t{!searching && (\n\t\t\t\t\t\t<CategoriesResult\n\t\t\t\t\t\t\tref={virtuosoRef}\n\t\t\t\t\t\t\temojiListByCategory={getEmojiListsByCategory()}\n\t\t\t\t\t\t\tcategoriesPosition={categoriesPosition}\n\t\t\t\t\t\t\tcustomItemsLimit={customItemsLimit}\n\t\t\t\t\t\t\thandleLoadMore={handleLoadMore}\n\t\t\t\t\t\t\thandleSelectEmoji={handleSelectEmoji}\n\t\t\t\t\t\t\thandleScroll={handleScroll}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</EmojiPickerListArea>\n\t\t\t\t<EmojiPickerPreviewArea>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{emojiToPreview && <EmojiPickerPreview emoji={emojiToPreview.emoji} name={emojiToPreview.name} />}\n\t\t\t\t\t\t{canManageEmoji && emojiToPreview === null && (\n\t\t\t\t\t\t\t<Button small onClick={handleGoToAddCustom}>\n\t\t\t\t\t\t\t\t{t('Add_emoji')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<ToneSelectorWrapper caption={t('Skin_tone')}>\n\t\t\t\t\t\t<ToneSelector tone={actualTone} setTone={setActualTone} />\n\t\t\t\t\t</ToneSelectorWrapper>\n\t\t\t\t</EmojiPickerPreviewArea>\n\t\t\t\t<EmojiPickerFooter>{t('Powered_by_JoyPixels')}</EmojiPickerFooter>\n\t\t\t</EmojiPickerContainer>\n\t\t</EmojiPickerDropdown>\n\t);\n};\n\nexport default EmojiPicker;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"832a293269aa2fdb57e691fde7fea066beed2ab0"}
