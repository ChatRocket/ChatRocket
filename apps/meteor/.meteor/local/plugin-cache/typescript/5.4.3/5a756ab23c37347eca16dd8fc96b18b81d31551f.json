{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/hooks/useAppActionButtons.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/hooks/useAppActionButtons.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/hooks/useAppActionButtons.ts","inputSourceMap":{"version":3,"file":"client/hooks/useAppActionButtons.ts","sourceRoot":"","sources":["client/hooks/useAppActionButtons.ts"],"names":[],"mappings":"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","sourcesContent":["import { type IUIActionButton, type UIActionButtonContext } from '@rocket.chat/apps-engine/definition/ui';\nimport { useDebouncedCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useEndpoint, useStream, useToastMessageDispatch, useUserId } from '@rocket.chat/ui-contexts';\nimport type { UseQueryResult } from '@tanstack/react-query';\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\nimport { useEffect, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { UiKitTriggerTimeoutError } from '../../app/ui-message/client/UiKitTriggerTimeoutError';\nimport type { MessageActionConfig, MessageActionContext } from '../../app/ui-utils/client/lib/MessageAction';\nimport type { MessageBoxAction } from '../../app/ui-utils/client/lib/messageBox';\nimport { Utilities } from '../../ee/lib/misc/Utilities';\nimport { useUiKitActionManager } from '../uikit/hooks/useUiKitActionManager';\nimport { useApplyButtonFilters, useApplyButtonAuthFilter } from './useApplyButtonFilters';\nimport { useFilterActionsByContext } from './useFilterActions';\n\nconst getIdForActionButton = ({ appId, actionId }: IUIActionButton): string => `${appId}/${actionId}`;\n\nexport const useAppActionButtons = <TContext extends `${UIActionButtonContext}`>(context?: TContext) => {\n\tconst queryClient = useQueryClient();\n\n\tconst apps = useStream('apps');\n\tconst uid = useUserId();\n\n\tconst getActionButtons = useEndpoint('GET', '/apps/actionButtons');\n\n\tconst result = useQuery(['apps', 'actionButtons'], () => getActionButtons(), {\n\t\t...(context && {\n\t\t\tselect: (data) =>\n\t\t\t\tdata.filter(\n\t\t\t\t\t(\n\t\t\t\t\t\tbutton,\n\t\t\t\t\t): button is IUIActionButton & {\n\t\t\t\t\t\tcontext: UIActionButtonContext extends infer X ? (X extends TContext ? X : never) : never;\n\t\t\t\t\t} => button.context === context,\n\t\t\t\t),\n\t\t}),\n\t\tstaleTime: Infinity,\n\t});\n\n\tconst invalidate = useDebouncedCallback(\n\t\t() => {\n\t\t\tqueryClient.invalidateQueries(['apps', 'actionButtons']);\n\t\t},\n\t\t100,\n\t\t[],\n\t);\n\n\tuseEffect(() => {\n\t\tif (!uid) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn apps('apps', ([key]) => {\n\t\t\tif (['actions/changed'].includes(key)) {\n\t\t\t\tinvalidate();\n\t\t\t}\n\t\t});\n\t}, [uid, apps, invalidate]);\n\n\treturn result;\n};\n\nexport const useMessageboxAppsActionButtons = () => {\n\tconst result = useAppActionButtons('messageBoxAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\n\tconst applyButtonFilters = useApplyButtonFilters();\n\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\tconst item: Omit<MessageBoxAction, 'icon'> = {\n\t\t\t\t\t\tid: getIdForActionButton(action),\n\t\t\t\t\t\tlabel: Utilities.getI18nKeyForApp(action.labelI18n, action.appId),\n\t\t\t\t\t\taction: (params) => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\trid: params.rid,\n\t\t\t\t\t\t\t\t\ttmid: params.tmid,\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context, message: params.chat.composer?.text ?? '' },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\treturn item;\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<MessageBoxAction[]>;\n};\n\nexport const useUserDropdownAppsActionButtons = () => {\n\tconst result = useAppActionButtons('userDropdownAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\n\tconst applyButtonFilters = useApplyButtonAuthFilter();\n\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: `${action.appId}_${action.actionId}`,\n\t\t\t\t\t\t// icon: action.icon as GenericMenuItemProps['icon'],\n\t\t\t\t\t\tcontent: action.labelI18n,\n\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<GenericMenuItemProps[]>;\n};\n\nexport const useMessageActionAppsActionButtons = (context?: MessageActionContext, category?: string) => {\n\tconst result = useAppActionButtons('messageAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst applyButtonFilters = useApplyButtonFilters(category);\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\tconst filterActionsByContext = useFilterActionsByContext(context);\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\tif (!filterActionsByContext(action)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\tconst item: MessageActionConfig = {\n\t\t\t\t\t\ticon: undefined as any,\n\t\t\t\t\t\tid: getIdForActionButton(action),\n\t\t\t\t\t\tlabel: Utilities.getI18nKeyForApp(action.labelI18n, action.appId),\n\t\t\t\t\t\torder: 7,\n\t\t\t\t\t\ttype: 'apps',\n\t\t\t\t\t\tvariant: action.variant,\n\t\t\t\t\t\taction: (_, params) => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\trid: params.message.rid,\n\t\t\t\t\t\t\t\t\ttmid: params.message.tmid,\n\t\t\t\t\t\t\t\t\tmid: params.message._id,\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\treturn item;\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, filterActionsByContext, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<MessageActionConfig[]>;\n};\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/hooks/useAppActionButtons.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/hooks/useAppActionButtons.ts","inputSourceMap":{"version":3,"file":"client/hooks/useAppActionButtons.ts","sourceRoot":"","sources":["client/hooks/useAppActionButtons.ts"],"names":[],"mappings":"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","sourcesContent":["import { type IUIActionButton, type UIActionButtonContext } from '@rocket.chat/apps-engine/definition/ui';\nimport { useDebouncedCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useEndpoint, useStream, useToastMessageDispatch, useUserId } from '@rocket.chat/ui-contexts';\nimport type { UseQueryResult } from '@tanstack/react-query';\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\nimport { useEffect, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { UiKitTriggerTimeoutError } from '../../app/ui-message/client/UiKitTriggerTimeoutError';\nimport type { MessageActionConfig, MessageActionContext } from '../../app/ui-utils/client/lib/MessageAction';\nimport type { MessageBoxAction } from '../../app/ui-utils/client/lib/messageBox';\nimport { Utilities } from '../../ee/lib/misc/Utilities';\nimport { useUiKitActionManager } from '../uikit/hooks/useUiKitActionManager';\nimport { useApplyButtonFilters, useApplyButtonAuthFilter } from './useApplyButtonFilters';\nimport { useFilterActionsByContext } from './useFilterActions';\n\nconst getIdForActionButton = ({ appId, actionId }: IUIActionButton): string => `${appId}/${actionId}`;\n\nexport const useAppActionButtons = <TContext extends `${UIActionButtonContext}`>(context?: TContext) => {\n\tconst queryClient = useQueryClient();\n\n\tconst apps = useStream('apps');\n\tconst uid = useUserId();\n\n\tconst getActionButtons = useEndpoint('GET', '/apps/actionButtons');\n\n\tconst result = useQuery(['apps', 'actionButtons'], () => getActionButtons(), {\n\t\t...(context && {\n\t\t\tselect: (data) =>\n\t\t\t\tdata.filter(\n\t\t\t\t\t(\n\t\t\t\t\t\tbutton,\n\t\t\t\t\t): button is IUIActionButton & {\n\t\t\t\t\t\tcontext: UIActionButtonContext extends infer X ? (X extends TContext ? X : never) : never;\n\t\t\t\t\t} => button.context === context,\n\t\t\t\t),\n\t\t}),\n\t\tstaleTime: Infinity,\n\t});\n\n\tconst invalidate = useDebouncedCallback(\n\t\t() => {\n\t\t\tqueryClient.invalidateQueries(['apps', 'actionButtons']);\n\t\t},\n\t\t100,\n\t\t[],\n\t);\n\n\tuseEffect(() => {\n\t\tif (!uid) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn apps('apps', ([key]) => {\n\t\t\tif (['actions/changed'].includes(key)) {\n\t\t\t\tinvalidate();\n\t\t\t}\n\t\t});\n\t}, [uid, apps, invalidate]);\n\n\treturn result;\n};\n\nexport const useMessageboxAppsActionButtons = () => {\n\tconst result = useAppActionButtons('messageBoxAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\n\tconst applyButtonFilters = useApplyButtonFilters();\n\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\tconst item: Omit<MessageBoxAction, 'icon'> = {\n\t\t\t\t\t\tid: getIdForActionButton(action),\n\t\t\t\t\t\tlabel: Utilities.getI18nKeyForApp(action.labelI18n, action.appId),\n\t\t\t\t\t\taction: (params) => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\trid: params.rid,\n\t\t\t\t\t\t\t\t\ttmid: params.tmid,\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context, message: params.chat.composer?.text ?? '' },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\treturn item;\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<MessageBoxAction[]>;\n};\n\nexport const useUserDropdownAppsActionButtons = () => {\n\tconst result = useAppActionButtons('userDropdownAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\n\tconst applyButtonFilters = useApplyButtonAuthFilter();\n\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: `${action.appId}_${action.actionId}`,\n\t\t\t\t\t\t// icon: action.icon as GenericMenuItemProps['icon'],\n\t\t\t\t\t\tcontent: action.labelI18n,\n\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<GenericMenuItemProps[]>;\n};\n\nexport const useMessageActionAppsActionButtons = (context?: MessageActionContext, category?: string) => {\n\tconst result = useAppActionButtons('messageAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst applyButtonFilters = useApplyButtonFilters(category);\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\tconst filterActionsByContext = useFilterActionsByContext(context);\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\tif (!filterActionsByContext(action)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\tconst item: MessageActionConfig = {\n\t\t\t\t\t\ticon: undefined as any,\n\t\t\t\t\t\tid: getIdForActionButton(action),\n\t\t\t\t\t\tlabel: Utilities.getI18nKeyForApp(action.labelI18n, action.appId),\n\t\t\t\t\t\torder: 7,\n\t\t\t\t\t\ttype: 'apps',\n\t\t\t\t\t\tvariant: action.variant,\n\t\t\t\t\t\taction: (_, params) => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\trid: params.message.rid,\n\t\t\t\t\t\t\t\t\ttmid: params.message.tmid,\n\t\t\t\t\t\t\t\t\tmid: params.message._id,\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\treturn item;\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, filterActionsByContext, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<MessageActionConfig[]>;\n};\n"]}}},"code":"var _regeneratorRuntime;\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\nvar _slicedToArray;\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 1);\nvar _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default: function (v) {\n    _objectSpread = v;\n  }\n}, 2);\nmodule.export({\n  useAppActionButtons: function () {\n    return useAppActionButtons;\n  },\n  useMessageboxAppsActionButtons: function () {\n    return useMessageboxAppsActionButtons;\n  },\n  useUserDropdownAppsActionButtons: function () {\n    return useUserDropdownAppsActionButtons;\n  },\n  useMessageActionAppsActionButtons: function () {\n    return useMessageActionAppsActionButtons;\n  }\n});\nvar useDebouncedCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useDebouncedCallback: function (v) {\n    useDebouncedCallback = v;\n  }\n}, 0);\nvar useEndpoint, useStream, useToastMessageDispatch, useUserId;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useEndpoint: function (v) {\n    useEndpoint = v;\n  },\n  useStream: function (v) {\n    useStream = v;\n  },\n  useToastMessageDispatch: function (v) {\n    useToastMessageDispatch = v;\n  },\n  useUserId: function (v) {\n    useUserId = v;\n  }\n}, 1);\nvar useQuery, useQueryClient;\nmodule.link(\"@tanstack/react-query\", {\n  useQuery: function (v) {\n    useQuery = v;\n  },\n  useQueryClient: function (v) {\n    useQueryClient = v;\n  }\n}, 2);\nvar useEffect, useMemo;\nmodule.link(\"react\", {\n  useEffect: function (v) {\n    useEffect = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  }\n}, 3);\nvar useTranslation;\nmodule.link(\"react-i18next\", {\n  useTranslation: function (v) {\n    useTranslation = v;\n  }\n}, 4);\nvar UiKitTriggerTimeoutError;\nmodule.link(\"../../app/ui-message/client/UiKitTriggerTimeoutError\", {\n  UiKitTriggerTimeoutError: function (v) {\n    UiKitTriggerTimeoutError = v;\n  }\n}, 5);\nvar Utilities;\nmodule.link(\"../../ee/lib/misc/Utilities\", {\n  Utilities: function (v) {\n    Utilities = v;\n  }\n}, 6);\nvar useUiKitActionManager;\nmodule.link(\"../uikit/hooks/useUiKitActionManager\", {\n  useUiKitActionManager: function (v) {\n    useUiKitActionManager = v;\n  }\n}, 7);\nvar useApplyButtonFilters, useApplyButtonAuthFilter;\nmodule.link(\"./useApplyButtonFilters\", {\n  useApplyButtonFilters: function (v) {\n    useApplyButtonFilters = v;\n  },\n  useApplyButtonAuthFilter: function (v) {\n    useApplyButtonAuthFilter = v;\n  }\n}, 8);\nvar useFilterActionsByContext;\nmodule.link(\"./useFilterActions\", {\n  useFilterActionsByContext: function (v) {\n    useFilterActionsByContext = v;\n  }\n}, 9);\nvar getIdForActionButton = function (_ref) {\n  var appId = _ref.appId,\n    actionId = _ref.actionId;\n  return appId + \"/\" + actionId;\n};\nvar useAppActionButtons = function (context) {\n  var queryClient = useQueryClient();\n  var apps = useStream('apps');\n  var uid = useUserId();\n  var getActionButtons = useEndpoint('GET', '/apps/actionButtons');\n  var result = useQuery(['apps', 'actionButtons'], function () {\n    return getActionButtons();\n  }, _objectSpread(_objectSpread({}, context && {\n    select: function (data) {\n      return data.filter(function (button) {\n        return button.context === context;\n      });\n    }\n  }), {}, {\n    staleTime: Infinity\n  }));\n  var invalidate = useDebouncedCallback(function () {\n    queryClient.invalidateQueries(['apps', 'actionButtons']);\n  }, 100, []);\n  useEffect(function () {\n    if (!uid) {\n      return;\n    }\n    return apps('apps', function (_ref2) {\n      var _ref3 = _slicedToArray(_ref2, 1),\n        key = _ref3[0];\n      if (['actions/changed'].includes(key)) {\n        invalidate();\n      }\n    });\n  }, [uid, apps, invalidate]);\n  return result;\n};\nvar useMessageboxAppsActionButtons = function () {\n  var result = useAppActionButtons('messageBoxAction');\n  var actionManager = useUiKitActionManager();\n  var dispatchToastMessage = useToastMessageDispatch();\n  var _useTranslation = useTranslation(),\n    t = _useTranslation.t;\n  var applyButtonFilters = useApplyButtonFilters();\n  var data = useMemo(function () {\n    var _result$data;\n    return (_result$data = result.data) === null || _result$data === void 0 ? void 0 : _result$data.filter(function (action) {\n      return applyButtonFilters(action);\n    }).map(function (action) {\n      var item = {\n        id: getIdForActionButton(action),\n        label: Utilities.getI18nKeyForApp(action.labelI18n, action.appId),\n        action: function (params) {\n          var _params$chat$composer, _params$chat$composer2;\n          void actionManager.emitInteraction(action.appId, {\n            type: 'actionButton',\n            rid: params.rid,\n            tmid: params.tmid,\n            actionId: action.actionId,\n            payload: {\n              context: action.context,\n              message: (_params$chat$composer = (_params$chat$composer2 = params.chat.composer) === null || _params$chat$composer2 === void 0 ? void 0 : _params$chat$composer2.text) !== null && _params$chat$composer !== void 0 ? _params$chat$composer : ''\n            }\n          }).catch(function () {\n            function _callee(reason) {\n              return _regeneratorRuntime.async(function () {\n                function _callee$(_context) {\n                  while (1) switch (_context.prev = _context.next) {\n                    case 0:\n                      if (!(reason instanceof UiKitTriggerTimeoutError)) {\n                        _context.next = 3;\n                        break;\n                      }\n                      dispatchToastMessage({\n                        type: 'error',\n                        message: t('UIKit_Interaction_Timeout')\n                      });\n                      return _context.abrupt(\"return\");\n                    case 3:\n                      return _context.abrupt(\"return\", reason);\n                    case 4:\n                    case \"end\":\n                      return _context.stop();\n                  }\n                }\n                return _callee$;\n              }(), null, null, null, Promise);\n            }\n            return _callee;\n          }());\n        }\n      };\n      return item;\n    });\n  }, [actionManager, applyButtonFilters, dispatchToastMessage, result.data, t]);\n  return _objectSpread(_objectSpread({}, result), {}, {\n    data: data\n  });\n};\nvar useUserDropdownAppsActionButtons = function () {\n  var result = useAppActionButtons('userDropdownAction');\n  var actionManager = useUiKitActionManager();\n  var dispatchToastMessage = useToastMessageDispatch();\n  var _useTranslation2 = useTranslation(),\n    t = _useTranslation2.t;\n  var applyButtonFilters = useApplyButtonAuthFilter();\n  var data = useMemo(function () {\n    var _result$data2;\n    return (_result$data2 = result.data) === null || _result$data2 === void 0 ? void 0 : _result$data2.filter(function (action) {\n      return applyButtonFilters(action);\n    }).map(function (action) {\n      return {\n        id: action.appId + \"_\" + action.actionId,\n        // icon: action.icon as GenericMenuItemProps['icon'],\n        content: action.labelI18n,\n        onClick: function () {\n          void actionManager.emitInteraction(action.appId, {\n            type: 'actionButton',\n            actionId: action.actionId,\n            payload: {\n              context: action.context\n            }\n          }).catch(function () {\n            function _callee2(reason) {\n              return _regeneratorRuntime.async(function () {\n                function _callee2$(_context2) {\n                  while (1) switch (_context2.prev = _context2.next) {\n                    case 0:\n                      if (!(reason instanceof UiKitTriggerTimeoutError)) {\n                        _context2.next = 3;\n                        break;\n                      }\n                      dispatchToastMessage({\n                        type: 'error',\n                        message: t('UIKit_Interaction_Timeout')\n                      });\n                      return _context2.abrupt(\"return\");\n                    case 3:\n                      return _context2.abrupt(\"return\", reason);\n                    case 4:\n                    case \"end\":\n                      return _context2.stop();\n                  }\n                }\n                return _callee2$;\n              }(), null, null, null, Promise);\n            }\n            return _callee2;\n          }());\n        }\n      };\n    });\n  }, [actionManager, applyButtonFilters, dispatchToastMessage, result.data, t]);\n  return _objectSpread(_objectSpread({}, result), {}, {\n    data: data\n  });\n};\nvar useMessageActionAppsActionButtons = function (context, category) {\n  var result = useAppActionButtons('messageAction');\n  var actionManager = useUiKitActionManager();\n  var applyButtonFilters = useApplyButtonFilters(category);\n  var dispatchToastMessage = useToastMessageDispatch();\n  var _useTranslation3 = useTranslation(),\n    t = _useTranslation3.t;\n  var filterActionsByContext = useFilterActionsByContext(context);\n  var data = useMemo(function () {\n    var _result$data3;\n    return (_result$data3 = result.data) === null || _result$data3 === void 0 ? void 0 : _result$data3.filter(function (action) {\n      if (!filterActionsByContext(action)) {\n        return false;\n      }\n      return applyButtonFilters(action);\n    }).map(function (action) {\n      var item = {\n        icon: undefined,\n        id: getIdForActionButton(action),\n        label: Utilities.getI18nKeyForApp(action.labelI18n, action.appId),\n        order: 7,\n        type: 'apps',\n        variant: action.variant,\n        action: function (_, params) {\n          void actionManager.emitInteraction(action.appId, {\n            type: 'actionButton',\n            rid: params.message.rid,\n            tmid: params.message.tmid,\n            mid: params.message._id,\n            actionId: action.actionId,\n            payload: {\n              context: action.context\n            }\n          }).catch(function () {\n            function _callee3(reason) {\n              return _regeneratorRuntime.async(function () {\n                function _callee3$(_context3) {\n                  while (1) switch (_context3.prev = _context3.next) {\n                    case 0:\n                      if (!(reason instanceof UiKitTriggerTimeoutError)) {\n                        _context3.next = 3;\n                        break;\n                      }\n                      dispatchToastMessage({\n                        type: 'error',\n                        message: t('UIKit_Interaction_Timeout')\n                      });\n                      return _context3.abrupt(\"return\");\n                    case 3:\n                      return _context3.abrupt(\"return\", reason);\n                    case 4:\n                    case \"end\":\n                      return _context3.stop();\n                  }\n                }\n                return _callee3$;\n              }(), null, null, null, Promise);\n            }\n            return _callee3;\n          }());\n        }\n      };\n      return item;\n    });\n  }, [actionManager, applyButtonFilters, dispatchToastMessage, filterActionsByContext, result.data, t]);\n  return _objectSpread(_objectSpread({}, result), {}, {\n    data: data\n  });\n};","map":{"version":3,"names":["_regeneratorRuntime","module","link","default","v","_slicedToArray","_objectSpread","export","useAppActionButtons","useMessageboxAppsActionButtons","useUserDropdownAppsActionButtons","useMessageActionAppsActionButtons","useDebouncedCallback","useEndpoint","useStream","useToastMessageDispatch","useUserId","useQuery","useQueryClient","useEffect","useMemo","useTranslation","UiKitTriggerTimeoutError","Utilities","useUiKitActionManager","useApplyButtonFilters","useApplyButtonAuthFilter","useFilterActionsByContext","getIdForActionButton","_ref","appId","actionId","context","queryClient","apps","uid","getActionButtons","result","select","data","filter","button","staleTime","Infinity","invalidate","invalidateQueries","_ref2","_ref3","key","includes","actionManager","dispatchToastMessage","_useTranslation","t","applyButtonFilters","_result$data","action","map","item","id","label","getI18nKeyForApp","labelI18n","params","_params$chat$composer","_params$chat$composer2","emitInteraction","type","rid","tmid","payload","message","chat","composer","text","catch","_callee","reason","async","_callee$","_context","prev","next","abrupt","stop","Promise","_useTranslation2","_result$data2","content","onClick","_callee2","_callee2$","_context2","category","_useTranslation3","filterActionsByContext","_result$data3","icon","undefined","order","variant","_","mid","_id","_callee3","_callee3$","_context3"],"sources":["client/hooks/useAppActionButtons.ts"],"sourcesContent":["import { type IUIActionButton, type UIActionButtonContext } from '@rocket.chat/apps-engine/definition/ui';\nimport { useDebouncedCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useEndpoint, useStream, useToastMessageDispatch, useUserId } from '@rocket.chat/ui-contexts';\nimport type { UseQueryResult } from '@tanstack/react-query';\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\nimport { useEffect, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { UiKitTriggerTimeoutError } from '../../app/ui-message/client/UiKitTriggerTimeoutError';\nimport type { MessageActionConfig, MessageActionContext } from '../../app/ui-utils/client/lib/MessageAction';\nimport type { MessageBoxAction } from '../../app/ui-utils/client/lib/messageBox';\nimport { Utilities } from '../../ee/lib/misc/Utilities';\nimport { useUiKitActionManager } from '../uikit/hooks/useUiKitActionManager';\nimport { useApplyButtonFilters, useApplyButtonAuthFilter } from './useApplyButtonFilters';\nimport { useFilterActionsByContext } from './useFilterActions';\n\nconst getIdForActionButton = ({ appId, actionId }: IUIActionButton): string => `${appId}/${actionId}`;\n\nexport const useAppActionButtons = <TContext extends `${UIActionButtonContext}`>(context?: TContext) => {\n\tconst queryClient = useQueryClient();\n\n\tconst apps = useStream('apps');\n\tconst uid = useUserId();\n\n\tconst getActionButtons = useEndpoint('GET', '/apps/actionButtons');\n\n\tconst result = useQuery(['apps', 'actionButtons'], () => getActionButtons(), {\n\t\t...(context && {\n\t\t\tselect: (data) =>\n\t\t\t\tdata.filter(\n\t\t\t\t\t(\n\t\t\t\t\t\tbutton,\n\t\t\t\t\t): button is IUIActionButton & {\n\t\t\t\t\t\tcontext: UIActionButtonContext extends infer X ? (X extends TContext ? X : never) : never;\n\t\t\t\t\t} => button.context === context,\n\t\t\t\t),\n\t\t}),\n\t\tstaleTime: Infinity,\n\t});\n\n\tconst invalidate = useDebouncedCallback(\n\t\t() => {\n\t\t\tqueryClient.invalidateQueries(['apps', 'actionButtons']);\n\t\t},\n\t\t100,\n\t\t[],\n\t);\n\n\tuseEffect(() => {\n\t\tif (!uid) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn apps('apps', ([key]) => {\n\t\t\tif (['actions/changed'].includes(key)) {\n\t\t\t\tinvalidate();\n\t\t\t}\n\t\t});\n\t}, [uid, apps, invalidate]);\n\n\treturn result;\n};\n\nexport const useMessageboxAppsActionButtons = () => {\n\tconst result = useAppActionButtons('messageBoxAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\n\tconst applyButtonFilters = useApplyButtonFilters();\n\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\tconst item: Omit<MessageBoxAction, 'icon'> = {\n\t\t\t\t\t\tid: getIdForActionButton(action),\n\t\t\t\t\t\tlabel: Utilities.getI18nKeyForApp(action.labelI18n, action.appId),\n\t\t\t\t\t\taction: (params) => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\trid: params.rid,\n\t\t\t\t\t\t\t\t\ttmid: params.tmid,\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context, message: params.chat.composer?.text ?? '' },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\treturn item;\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<MessageBoxAction[]>;\n};\n\nexport const useUserDropdownAppsActionButtons = () => {\n\tconst result = useAppActionButtons('userDropdownAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\n\tconst applyButtonFilters = useApplyButtonAuthFilter();\n\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: `${action.appId}_${action.actionId}`,\n\t\t\t\t\t\t// icon: action.icon as GenericMenuItemProps['icon'],\n\t\t\t\t\t\tcontent: action.labelI18n,\n\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<GenericMenuItemProps[]>;\n};\n\nexport const useMessageActionAppsActionButtons = (context?: MessageActionContext, category?: string) => {\n\tconst result = useAppActionButtons('messageAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst applyButtonFilters = useApplyButtonFilters(category);\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\tconst filterActionsByContext = useFilterActionsByContext(context);\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\tif (!filterActionsByContext(action)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\tconst item: MessageActionConfig = {\n\t\t\t\t\t\ticon: undefined as any,\n\t\t\t\t\t\tid: getIdForActionButton(action),\n\t\t\t\t\t\tlabel: Utilities.getI18nKeyForApp(action.labelI18n, action.appId),\n\t\t\t\t\t\torder: 7,\n\t\t\t\t\t\ttype: 'apps',\n\t\t\t\t\t\tvariant: action.variant,\n\t\t\t\t\t\taction: (_, params) => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\trid: params.message.rid,\n\t\t\t\t\t\t\t\t\ttmid: params.message.tmid,\n\t\t\t\t\t\t\t\t\tmid: params.message._id,\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\treturn item;\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, filterActionsByContext, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<MessageActionConfig[]>;\n};\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"5a756ab23c37347eca16dd8fc96b18b81d31551f"}
