{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx","sourceRoot":"","sources":["client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx"],"names":[],"mappings":"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","sourcesContent":["import { ResponsiveLine } from '@nivo/line';\nimport { Box, Flex, Skeleton, Tile } from '@rocket.chat/fuselage';\nimport colors from '@rocket.chat/fuselage-tokens/colors.json';\nimport moment from 'moment';\nimport type { ReactElement } from 'react';\nimport React, { useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport DownloadDataButton from '../../../../components/dashboards/DownloadDataButton';\nimport CounterSet from '../../../../components/dataView/CounterSet';\nimport { useFormatDate } from '../../../../hooks/useFormatDate';\nimport EngagementDashboardCardFilter from '../EngagementDashboardCardFilter';\nimport LegendSymbol from '../dataView/LegendSymbol';\nimport { useActiveUsers } from './useActiveUsers';\n\ntype ActiveUsersSectionProps = {\n\ttimezone: 'utc' | 'local';\n};\n\nconst ActiveUsersSection = ({ timezone }: ActiveUsersSectionProps): ReactElement => {\n\tconst utc = timezone === 'utc';\n\tconst { data } = useActiveUsers({ utc });\n\n\tconst [\n\t\tcountDailyActiveUsers,\n\t\tdiffDailyActiveUsers,\n\t\tcountWeeklyActiveUsers,\n\t\tdiffWeeklyActiveUsers,\n\t\tcountMonthlyActiveUsers,\n\t\tdiffMonthlyActiveUsers,\n\t\tdauValues = [],\n\t\twauValues = [],\n\t\tmauValues = [],\n\t] = useMemo(() => {\n\t\tif (!data) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst createPoint = (i: number): { x: Date; y: number } => ({\n\t\t\tx: moment(data.start).add(i, 'days').startOf('day').toDate(),\n\t\t\ty: 0,\n\t\t});\n\n\t\tconst createPoints = (): { x: Date; y: number }[] =>\n\t\t\tArray.from({ length: moment(data.end).diff(data.start, 'days') }, (_, i) => createPoint(i));\n\n\t\tconst dauValuesLocal = createPoints();\n\t\tconst prevDauValue = createPoint(-1);\n\t\tconst wauValuesLocal = createPoints();\n\t\tconst prevWauValue = createPoint(-1);\n\t\tconst mauValuesLocal = createPoints();\n\t\tconst prevMauValue = createPoint(-1);\n\n\t\tconst usersListsMap = data.month.reduce<{ [x: number]: string[] }>((map, dayData) => {\n\t\t\tconst date = utc\n\t\t\t\t? moment.utc({ year: dayData.year, month: dayData.month - 1, day: dayData.day }).endOf('day')\n\t\t\t\t: moment({ year: dayData.year, month: dayData.month - 1, day: dayData.day }).endOf('day');\n\t\t\tconst dateOffset = date.diff(data.start, 'days');\n\t\t\tif (dateOffset >= 0 && dauValuesLocal[dateOffset]) {\n\t\t\t\tmap[dateOffset] = dayData.usersList;\n\t\t\t\tdauValuesLocal[dateOffset].y = dayData.users;\n\t\t\t}\n\t\t\treturn map;\n\t\t}, {});\n\n\t\tconst distributeValueOverPoints = (\n\t\t\tusersListsMap: { [x: number]: string[] },\n\t\t\tdateOffset: number,\n\t\t\tcount: number,\n\t\t\tarray: { x: Date; y: number }[],\n\t\t): void => {\n\t\t\tconst usersSet = new Set();\n\t\t\tfor (let k = dateOffset; count > 0; k--, count--) {\n\t\t\t\tif (usersListsMap[k]) {\n\t\t\t\t\tusersListsMap[k].map((userId) => usersSet.add(userId));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tarray[dateOffset].y = usersSet.size;\n\t\t};\n\n\t\tfor (let i = 0; i < dauValuesLocal.length; i++) {\n\t\t\tdistributeValueOverPoints(usersListsMap, i, 7, wauValuesLocal);\n\t\t\tdistributeValueOverPoints(usersListsMap, i, 30, mauValuesLocal);\n\t\t}\n\t\tprevWauValue.y = wauValuesLocal[dauValuesLocal.length - 2].y;\n\t\tprevMauValue.y = mauValuesLocal[dauValuesLocal.length - 2].y;\n\t\tprevDauValue.y = dauValuesLocal[dauValuesLocal.length - 2].y;\n\n\t\treturn [\n\t\t\tdauValuesLocal[dauValuesLocal.length - 1].y,\n\t\t\tdauValuesLocal[dauValuesLocal.length - 1].y - prevDauValue.y,\n\t\t\twauValuesLocal[wauValuesLocal.length - 1].y,\n\t\t\twauValuesLocal[wauValuesLocal.length - 1].y - prevWauValue.y,\n\t\t\tmauValuesLocal[mauValuesLocal.length - 1].y,\n\t\t\tmauValuesLocal[mauValuesLocal.length - 1].y - prevMauValue.y,\n\t\t\tdauValuesLocal,\n\t\t\twauValuesLocal,\n\t\t\tmauValuesLocal,\n\t\t];\n\t}, [data, utc]);\n\n\tconst formatDate = useFormatDate();\n\tconst { t } = useTranslation();\n\n\treturn (\n\t\t<>\n\t\t\t<EngagementDashboardCardFilter>\n\t\t\t\t<DownloadDataButton\n\t\t\t\t\tattachmentName={`ActiveUsersSection_start_${data?.start}_end_${moment(data?.end).subtract(1, 'day')}`}\n\t\t\t\t\theaders={['Date', 'DAU', 'WAU', 'MAU']}\n\t\t\t\t\tdataAvailable={!!data}\n\t\t\t\t\tdataExtractor={(): unknown[][] | undefined => {\n\t\t\t\t\t\tconst values = [];\n\n\t\t\t\t\t\tfor (let i = 0; i < 30; i++) {\n\t\t\t\t\t\t\tvalues.push([dauValues[i].x.toISOString(), dauValues[i].y, wauValues[i].y, mauValues[i].y]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn values;\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</EngagementDashboardCardFilter>\n\t\t\t<CounterSet\n\t\t\t\tcounters={[\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countDailyActiveUsers ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: diffDailyActiveUsers ?? 0,\n\t\t\t\t\t\tdescription: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<LegendSymbol color={colors.b200} /> {t('Daily_Active_Users')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countWeeklyActiveUsers ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: diffWeeklyActiveUsers ?? 0,\n\t\t\t\t\t\tdescription: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<LegendSymbol color={colors.b300} /> {t('Weekly_Active_Users')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countMonthlyActiveUsers ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: diffMonthlyActiveUsers ?? 0,\n\t\t\t\t\t\tdescription: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<LegendSymbol color={colors.p500} /> {t('Monthly_Active_Users')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t]}\n\t\t\t/>\n\t\t\t<Flex.Container>\n\t\t\t\t{data ? (\n\t\t\t\t\t<Box style={{ height: 240 }}>\n\t\t\t\t\t\t<Flex.Item align='stretch' grow={1} shrink={0}>\n\t\t\t\t\t\t\t<Box style={{ position: 'relative' }}>\n\t\t\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\t\t\t\theight: '100%',\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<ResponsiveLine\n\t\t\t\t\t\t\t\t\t\tdata={[\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tid: 'dau',\n\t\t\t\t\t\t\t\t\t\t\t\tdata: dauValues,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tid: 'wau',\n\t\t\t\t\t\t\t\t\t\t\t\tdata: wauValues,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tid: 'mau',\n\t\t\t\t\t\t\t\t\t\t\t\tdata: mauValues,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t\txScale={{\n\t\t\t\t\t\t\t\t\t\t\ttype: 'time',\n\t\t\t\t\t\t\t\t\t\t\tformat: 'native',\n\t\t\t\t\t\t\t\t\t\t\tprecision: 'day',\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\txFormat='time:%Y-%m-%d'\n\t\t\t\t\t\t\t\t\t\tyScale={{\n\t\t\t\t\t\t\t\t\t\t\ttype: 'linear',\n\t\t\t\t\t\t\t\t\t\t\tstacked: true,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tenableGridX={false}\n\t\t\t\t\t\t\t\t\t\tenableGridY={false}\n\t\t\t\t\t\t\t\t\t\tenablePoints={false}\n\t\t\t\t\t\t\t\t\t\tuseMesh\n\t\t\t\t\t\t\t\t\t\tenableArea\n\t\t\t\t\t\t\t\t\t\tareaOpacity={1}\n\t\t\t\t\t\t\t\t\t\tenableCrosshair\n\t\t\t\t\t\t\t\t\t\tcrosshairType='bottom'\n\t\t\t\t\t\t\t\t\t\tmargin={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\t\t\t\t\tbottom: 20,\n\t\t\t\t\t\t\t\t\t\t\tright: 0,\n\t\t\t\t\t\t\t\t\t\t\tleft: 40,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tcolors={[colors.b200, colors.b300, colors.b500]}\n\t\t\t\t\t\t\t\t\t\taxisLeft={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\ttickSize: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickPadding: 4,\n\t\t\t\t\t\t\t\t\t\t\ttickRotation: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickValues: 3,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\taxisBottom={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\ttickSize: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickPadding: 4,\n\t\t\t\t\t\t\t\t\t\t\ttickRotation: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickValues: 'every 3 days',\n\t\t\t\t\t\t\t\t\t\t\tformat: (date): string => moment(date).format('DD/MM'),\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tanimate={true}\n\t\t\t\t\t\t\t\t\t\tmotionConfig='stiff'\n\t\t\t\t\t\t\t\t\t\ttheme={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\taxis: {\n\t\t\t\t\t\t\t\t\t\t\t\tticks: {\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill: '#9EA2A8',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontFamily:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Inter, -apple-system, system-ui, \"Segoe UI\", Roboto, Oxygen, Ubuntu, Cantarell, \"Helvetica Neue\", \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Meiryo UI\", Arial, sans-serif',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: '10px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontStyle: 'normal',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontWeight: 600,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tletterSpacing: '0.2px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlineHeight: '12px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\ttooltip: {\n\t\t\t\t\t\t\t\t\t\t\t\tcontainer: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: '#1F2329',\n\t\t\t\t\t\t\t\t\t\t\t\t\tboxShadow: '0px 0px 12px rgba(47, 52, 61, 0.12), 0px 0px 2px rgba(47, 52, 61, 0.08)',\n\t\t\t\t\t\t\t\t\t\t\t\t\tborderRadius: 2,\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tenableSlices='x'\n\t\t\t\t\t\t\t\t\t\tsliceTooltip={({ slice: { points } }): ReactElement => (\n\t\t\t\t\t\t\t\t\t\t\t<Tile elevation='2'>\n\t\t\t\t\t\t\t\t\t\t\t\t<Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Box>{formatDate(points[0].data.x)}</Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{points.map(({ serieId, data: { y: activeUsers } }) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Box key={serieId} fontScale='p1m'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(serieId === 'dau' && t('DAU_value', { value: activeUsers })) ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(serieId === 'wau' && t('WAU_value', { value: activeUsers })) ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(serieId === 'mau' && t('MAU_value', { value: activeUsers }))}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t\t</Tile>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Flex.Item>\n\t\t\t\t\t</Box>\n\t\t\t\t) : (\n\t\t\t\t\t<Skeleton variant='rect' height={240} />\n\t\t\t\t)}\n\t\t\t</Flex.Container>\n\t\t</>\n\t);\n};\n\nexport default ActiveUsersSection;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx","sourceRoot":"","sources":["client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx"],"names":[],"mappings":"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","sourcesContent":["import { ResponsiveLine } from '@nivo/line';\nimport { Box, Flex, Skeleton, Tile } from '@rocket.chat/fuselage';\nimport colors from '@rocket.chat/fuselage-tokens/colors.json';\nimport moment from 'moment';\nimport type { ReactElement } from 'react';\nimport React, { useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport DownloadDataButton from '../../../../components/dashboards/DownloadDataButton';\nimport CounterSet from '../../../../components/dataView/CounterSet';\nimport { useFormatDate } from '../../../../hooks/useFormatDate';\nimport EngagementDashboardCardFilter from '../EngagementDashboardCardFilter';\nimport LegendSymbol from '../dataView/LegendSymbol';\nimport { useActiveUsers } from './useActiveUsers';\n\ntype ActiveUsersSectionProps = {\n\ttimezone: 'utc' | 'local';\n};\n\nconst ActiveUsersSection = ({ timezone }: ActiveUsersSectionProps): ReactElement => {\n\tconst utc = timezone === 'utc';\n\tconst { data } = useActiveUsers({ utc });\n\n\tconst [\n\t\tcountDailyActiveUsers,\n\t\tdiffDailyActiveUsers,\n\t\tcountWeeklyActiveUsers,\n\t\tdiffWeeklyActiveUsers,\n\t\tcountMonthlyActiveUsers,\n\t\tdiffMonthlyActiveUsers,\n\t\tdauValues = [],\n\t\twauValues = [],\n\t\tmauValues = [],\n\t] = useMemo(() => {\n\t\tif (!data) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst createPoint = (i: number): { x: Date; y: number } => ({\n\t\t\tx: moment(data.start).add(i, 'days').startOf('day').toDate(),\n\t\t\ty: 0,\n\t\t});\n\n\t\tconst createPoints = (): { x: Date; y: number }[] =>\n\t\t\tArray.from({ length: moment(data.end).diff(data.start, 'days') }, (_, i) => createPoint(i));\n\n\t\tconst dauValuesLocal = createPoints();\n\t\tconst prevDauValue = createPoint(-1);\n\t\tconst wauValuesLocal = createPoints();\n\t\tconst prevWauValue = createPoint(-1);\n\t\tconst mauValuesLocal = createPoints();\n\t\tconst prevMauValue = createPoint(-1);\n\n\t\tconst usersListsMap = data.month.reduce<{ [x: number]: string[] }>((map, dayData) => {\n\t\t\tconst date = utc\n\t\t\t\t? moment.utc({ year: dayData.year, month: dayData.month - 1, day: dayData.day }).endOf('day')\n\t\t\t\t: moment({ year: dayData.year, month: dayData.month - 1, day: dayData.day }).endOf('day');\n\t\t\tconst dateOffset = date.diff(data.start, 'days');\n\t\t\tif (dateOffset >= 0 && dauValuesLocal[dateOffset]) {\n\t\t\t\tmap[dateOffset] = dayData.usersList;\n\t\t\t\tdauValuesLocal[dateOffset].y = dayData.users;\n\t\t\t}\n\t\t\treturn map;\n\t\t}, {});\n\n\t\tconst distributeValueOverPoints = (\n\t\t\tusersListsMap: { [x: number]: string[] },\n\t\t\tdateOffset: number,\n\t\t\tcount: number,\n\t\t\tarray: { x: Date; y: number }[],\n\t\t): void => {\n\t\t\tconst usersSet = new Set();\n\t\t\tfor (let k = dateOffset; count > 0; k--, count--) {\n\t\t\t\tif (usersListsMap[k]) {\n\t\t\t\t\tusersListsMap[k].map((userId) => usersSet.add(userId));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tarray[dateOffset].y = usersSet.size;\n\t\t};\n\n\t\tfor (let i = 0; i < dauValuesLocal.length; i++) {\n\t\t\tdistributeValueOverPoints(usersListsMap, i, 7, wauValuesLocal);\n\t\t\tdistributeValueOverPoints(usersListsMap, i, 30, mauValuesLocal);\n\t\t}\n\t\tprevWauValue.y = wauValuesLocal[dauValuesLocal.length - 2].y;\n\t\tprevMauValue.y = mauValuesLocal[dauValuesLocal.length - 2].y;\n\t\tprevDauValue.y = dauValuesLocal[dauValuesLocal.length - 2].y;\n\n\t\treturn [\n\t\t\tdauValuesLocal[dauValuesLocal.length - 1].y,\n\t\t\tdauValuesLocal[dauValuesLocal.length - 1].y - prevDauValue.y,\n\t\t\twauValuesLocal[wauValuesLocal.length - 1].y,\n\t\t\twauValuesLocal[wauValuesLocal.length - 1].y - prevWauValue.y,\n\t\t\tmauValuesLocal[mauValuesLocal.length - 1].y,\n\t\t\tmauValuesLocal[mauValuesLocal.length - 1].y - prevMauValue.y,\n\t\t\tdauValuesLocal,\n\t\t\twauValuesLocal,\n\t\t\tmauValuesLocal,\n\t\t];\n\t}, [data, utc]);\n\n\tconst formatDate = useFormatDate();\n\tconst { t } = useTranslation();\n\n\treturn (\n\t\t<>\n\t\t\t<EngagementDashboardCardFilter>\n\t\t\t\t<DownloadDataButton\n\t\t\t\t\tattachmentName={`ActiveUsersSection_start_${data?.start}_end_${moment(data?.end).subtract(1, 'day')}`}\n\t\t\t\t\theaders={['Date', 'DAU', 'WAU', 'MAU']}\n\t\t\t\t\tdataAvailable={!!data}\n\t\t\t\t\tdataExtractor={(): unknown[][] | undefined => {\n\t\t\t\t\t\tconst values = [];\n\n\t\t\t\t\t\tfor (let i = 0; i < 30; i++) {\n\t\t\t\t\t\t\tvalues.push([dauValues[i].x.toISOString(), dauValues[i].y, wauValues[i].y, mauValues[i].y]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn values;\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</EngagementDashboardCardFilter>\n\t\t\t<CounterSet\n\t\t\t\tcounters={[\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countDailyActiveUsers ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: diffDailyActiveUsers ?? 0,\n\t\t\t\t\t\tdescription: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<LegendSymbol color={colors.b200} /> {t('Daily_Active_Users')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countWeeklyActiveUsers ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: diffWeeklyActiveUsers ?? 0,\n\t\t\t\t\t\tdescription: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<LegendSymbol color={colors.b300} /> {t('Weekly_Active_Users')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countMonthlyActiveUsers ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: diffMonthlyActiveUsers ?? 0,\n\t\t\t\t\t\tdescription: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<LegendSymbol color={colors.p500} /> {t('Monthly_Active_Users')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t]}\n\t\t\t/>\n\t\t\t<Flex.Container>\n\t\t\t\t{data ? (\n\t\t\t\t\t<Box style={{ height: 240 }}>\n\t\t\t\t\t\t<Flex.Item align='stretch' grow={1} shrink={0}>\n\t\t\t\t\t\t\t<Box style={{ position: 'relative' }}>\n\t\t\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\t\t\t\theight: '100%',\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<ResponsiveLine\n\t\t\t\t\t\t\t\t\t\tdata={[\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tid: 'dau',\n\t\t\t\t\t\t\t\t\t\t\t\tdata: dauValues,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tid: 'wau',\n\t\t\t\t\t\t\t\t\t\t\t\tdata: wauValues,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tid: 'mau',\n\t\t\t\t\t\t\t\t\t\t\t\tdata: mauValues,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t\txScale={{\n\t\t\t\t\t\t\t\t\t\t\ttype: 'time',\n\t\t\t\t\t\t\t\t\t\t\tformat: 'native',\n\t\t\t\t\t\t\t\t\t\t\tprecision: 'day',\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\txFormat='time:%Y-%m-%d'\n\t\t\t\t\t\t\t\t\t\tyScale={{\n\t\t\t\t\t\t\t\t\t\t\ttype: 'linear',\n\t\t\t\t\t\t\t\t\t\t\tstacked: true,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tenableGridX={false}\n\t\t\t\t\t\t\t\t\t\tenableGridY={false}\n\t\t\t\t\t\t\t\t\t\tenablePoints={false}\n\t\t\t\t\t\t\t\t\t\tuseMesh\n\t\t\t\t\t\t\t\t\t\tenableArea\n\t\t\t\t\t\t\t\t\t\tareaOpacity={1}\n\t\t\t\t\t\t\t\t\t\tenableCrosshair\n\t\t\t\t\t\t\t\t\t\tcrosshairType='bottom'\n\t\t\t\t\t\t\t\t\t\tmargin={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\t\t\t\t\tbottom: 20,\n\t\t\t\t\t\t\t\t\t\t\tright: 0,\n\t\t\t\t\t\t\t\t\t\t\tleft: 40,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tcolors={[colors.b200, colors.b300, colors.b500]}\n\t\t\t\t\t\t\t\t\t\taxisLeft={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\ttickSize: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickPadding: 4,\n\t\t\t\t\t\t\t\t\t\t\ttickRotation: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickValues: 3,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\taxisBottom={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\ttickSize: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickPadding: 4,\n\t\t\t\t\t\t\t\t\t\t\ttickRotation: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickValues: 'every 3 days',\n\t\t\t\t\t\t\t\t\t\t\tformat: (date): string => moment(date).format('DD/MM'),\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tanimate={true}\n\t\t\t\t\t\t\t\t\t\tmotionConfig='stiff'\n\t\t\t\t\t\t\t\t\t\ttheme={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\taxis: {\n\t\t\t\t\t\t\t\t\t\t\t\tticks: {\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill: '#9EA2A8',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontFamily:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Inter, -apple-system, system-ui, \"Segoe UI\", Roboto, Oxygen, Ubuntu, Cantarell, \"Helvetica Neue\", \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Meiryo UI\", Arial, sans-serif',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: '10px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontStyle: 'normal',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontWeight: 600,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tletterSpacing: '0.2px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlineHeight: '12px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\ttooltip: {\n\t\t\t\t\t\t\t\t\t\t\t\tcontainer: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: '#1F2329',\n\t\t\t\t\t\t\t\t\t\t\t\t\tboxShadow: '0px 0px 12px rgba(47, 52, 61, 0.12), 0px 0px 2px rgba(47, 52, 61, 0.08)',\n\t\t\t\t\t\t\t\t\t\t\t\t\tborderRadius: 2,\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tenableSlices='x'\n\t\t\t\t\t\t\t\t\t\tsliceTooltip={({ slice: { points } }): ReactElement => (\n\t\t\t\t\t\t\t\t\t\t\t<Tile elevation='2'>\n\t\t\t\t\t\t\t\t\t\t\t\t<Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Box>{formatDate(points[0].data.x)}</Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{points.map(({ serieId, data: { y: activeUsers } }) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Box key={serieId} fontScale='p1m'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(serieId === 'dau' && t('DAU_value', { value: activeUsers })) ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(serieId === 'wau' && t('WAU_value', { value: activeUsers })) ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(serieId === 'mau' && t('MAU_value', { value: activeUsers }))}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t\t</Tile>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Flex.Item>\n\t\t\t\t\t</Box>\n\t\t\t\t) : (\n\t\t\t\t\t<Skeleton variant='rect' height={240} />\n\t\t\t\t)}\n\t\t\t</Flex.Container>\n\t\t</>\n\t);\n};\n\nexport default ActiveUsersSection;\n"]}}},"code":"let ResponsiveLine;\nmodule.link(\"@nivo/line\", {\n  ResponsiveLine(v) {\n    ResponsiveLine = v;\n  }\n}, 0);\nlet Box, Flex, Skeleton, Tile;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Box(v) {\n    Box = v;\n  },\n  Flex(v) {\n    Flex = v;\n  },\n  Skeleton(v) {\n    Skeleton = v;\n  },\n  Tile(v) {\n    Tile = v;\n  }\n}, 1);\nlet colors;\nmodule.link(\"@rocket.chat/fuselage-tokens/colors.json\", {\n  default(v) {\n    colors = v;\n  }\n}, 2);\nlet moment;\nmodule.link(\"moment\", {\n  default(v) {\n    moment = v;\n  }\n}, 3);\nlet React, useMemo;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n  useMemo(v) {\n    useMemo = v;\n  }\n}, 4);\nlet useTranslation;\nmodule.link(\"react-i18next\", {\n  useTranslation(v) {\n    useTranslation = v;\n  }\n}, 5);\nlet DownloadDataButton;\nmodule.link(\"../../../../components/dashboards/DownloadDataButton\", {\n  default(v) {\n    DownloadDataButton = v;\n  }\n}, 6);\nlet CounterSet;\nmodule.link(\"../../../../components/dataView/CounterSet\", {\n  default(v) {\n    CounterSet = v;\n  }\n}, 7);\nlet useFormatDate;\nmodule.link(\"../../../../hooks/useFormatDate\", {\n  useFormatDate(v) {\n    useFormatDate = v;\n  }\n}, 8);\nlet EngagementDashboardCardFilter;\nmodule.link(\"../EngagementDashboardCardFilter\", {\n  default(v) {\n    EngagementDashboardCardFilter = v;\n  }\n}, 9);\nlet LegendSymbol;\nmodule.link(\"../dataView/LegendSymbol\", {\n  default(v) {\n    LegendSymbol = v;\n  }\n}, 10);\nlet useActiveUsers;\nmodule.link(\"./useActiveUsers\", {\n  useActiveUsers(v) {\n    useActiveUsers = v;\n  }\n}, 11);\nconst ActiveUsersSection = _ref => {\n  let {\n    timezone\n  } = _ref;\n  const utc = timezone === 'utc';\n  const {\n    data\n  } = useActiveUsers({\n    utc\n  });\n  const [countDailyActiveUsers, diffDailyActiveUsers, countWeeklyActiveUsers, diffWeeklyActiveUsers, countMonthlyActiveUsers, diffMonthlyActiveUsers, dauValues = [], wauValues = [], mauValues = []] = useMemo(() => {\n    if (!data) {\n      return [];\n    }\n    const createPoint = i => ({\n      x: moment(data.start).add(i, 'days').startOf('day').toDate(),\n      y: 0\n    });\n    const createPoints = () => Array.from({\n      length: moment(data.end).diff(data.start, 'days')\n    }, (_, i) => createPoint(i));\n    const dauValuesLocal = createPoints();\n    const prevDauValue = createPoint(-1);\n    const wauValuesLocal = createPoints();\n    const prevWauValue = createPoint(-1);\n    const mauValuesLocal = createPoints();\n    const prevMauValue = createPoint(-1);\n    const usersListsMap = data.month.reduce((map, dayData) => {\n      const date = utc ? moment.utc({\n        year: dayData.year,\n        month: dayData.month - 1,\n        day: dayData.day\n      }).endOf('day') : moment({\n        year: dayData.year,\n        month: dayData.month - 1,\n        day: dayData.day\n      }).endOf('day');\n      const dateOffset = date.diff(data.start, 'days');\n      if (dateOffset >= 0 && dauValuesLocal[dateOffset]) {\n        map[dateOffset] = dayData.usersList;\n        dauValuesLocal[dateOffset].y = dayData.users;\n      }\n      return map;\n    }, {});\n    const distributeValueOverPoints = (usersListsMap, dateOffset, count, array) => {\n      const usersSet = new Set();\n      for (let k = dateOffset; count > 0; k--, count--) {\n        if (usersListsMap[k]) {\n          usersListsMap[k].map(userId => usersSet.add(userId));\n        }\n      }\n      array[dateOffset].y = usersSet.size;\n    };\n    for (let i = 0; i < dauValuesLocal.length; i++) {\n      distributeValueOverPoints(usersListsMap, i, 7, wauValuesLocal);\n      distributeValueOverPoints(usersListsMap, i, 30, mauValuesLocal);\n    }\n    prevWauValue.y = wauValuesLocal[dauValuesLocal.length - 2].y;\n    prevMauValue.y = mauValuesLocal[dauValuesLocal.length - 2].y;\n    prevDauValue.y = dauValuesLocal[dauValuesLocal.length - 2].y;\n    return [dauValuesLocal[dauValuesLocal.length - 1].y, dauValuesLocal[dauValuesLocal.length - 1].y - prevDauValue.y, wauValuesLocal[wauValuesLocal.length - 1].y, wauValuesLocal[wauValuesLocal.length - 1].y - prevWauValue.y, mauValuesLocal[mauValuesLocal.length - 1].y, mauValuesLocal[mauValuesLocal.length - 1].y - prevMauValue.y, dauValuesLocal, wauValuesLocal, mauValuesLocal];\n  }, [data, utc]);\n  const formatDate = useFormatDate();\n  const {\n    t\n  } = useTranslation();\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EngagementDashboardCardFilter, null, /*#__PURE__*/React.createElement(DownloadDataButton, {\n    attachmentName: \"ActiveUsersSection_start_\".concat(data === null || data === void 0 ? void 0 : data.start, \"_end_\").concat(moment(data === null || data === void 0 ? void 0 : data.end).subtract(1, 'day')),\n    headers: ['Date', 'DAU', 'WAU', 'MAU'],\n    dataAvailable: !!data,\n    dataExtractor: () => {\n      const values = [];\n      for (let i = 0; i < 30; i++) {\n        values.push([dauValues[i].x.toISOString(), dauValues[i].y, wauValues[i].y, mauValues[i].y]);\n      }\n      return values;\n    }\n  })), /*#__PURE__*/React.createElement(CounterSet, {\n    counters: [{\n      count: countDailyActiveUsers !== null && countDailyActiveUsers !== void 0 ? countDailyActiveUsers : /*#__PURE__*/React.createElement(Skeleton, {\n        variant: \"rect\",\n        width: \"3ex\",\n        height: \"1em\"\n      }),\n      variation: diffDailyActiveUsers !== null && diffDailyActiveUsers !== void 0 ? diffDailyActiveUsers : 0,\n      description: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(LegendSymbol, {\n        color: colors.b200\n      }), \" \", t('Daily_Active_Users'))\n    }, {\n      count: countWeeklyActiveUsers !== null && countWeeklyActiveUsers !== void 0 ? countWeeklyActiveUsers : /*#__PURE__*/React.createElement(Skeleton, {\n        variant: \"rect\",\n        width: \"3ex\",\n        height: \"1em\"\n      }),\n      variation: diffWeeklyActiveUsers !== null && diffWeeklyActiveUsers !== void 0 ? diffWeeklyActiveUsers : 0,\n      description: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(LegendSymbol, {\n        color: colors.b300\n      }), \" \", t('Weekly_Active_Users'))\n    }, {\n      count: countMonthlyActiveUsers !== null && countMonthlyActiveUsers !== void 0 ? countMonthlyActiveUsers : /*#__PURE__*/React.createElement(Skeleton, {\n        variant: \"rect\",\n        width: \"3ex\",\n        height: \"1em\"\n      }),\n      variation: diffMonthlyActiveUsers !== null && diffMonthlyActiveUsers !== void 0 ? diffMonthlyActiveUsers : 0,\n      description: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(LegendSymbol, {\n        color: colors.p500\n      }), \" \", t('Monthly_Active_Users'))\n    }]\n  }), /*#__PURE__*/React.createElement(Flex.Container, null, data ? /*#__PURE__*/React.createElement(Box, {\n    style: {\n      height: 240\n    }\n  }, /*#__PURE__*/React.createElement(Flex.Item, {\n    align: \"stretch\",\n    grow: 1,\n    shrink: 0\n  }, /*#__PURE__*/React.createElement(Box, {\n    style: {\n      position: 'relative'\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    style: {\n      position: 'absolute',\n      width: '100%',\n      height: '100%'\n    }\n  }, /*#__PURE__*/React.createElement(ResponsiveLine, {\n    data: [{\n      id: 'dau',\n      data: dauValues\n    }, {\n      id: 'wau',\n      data: wauValues\n    }, {\n      id: 'mau',\n      data: mauValues\n    }],\n    xScale: {\n      type: 'time',\n      format: 'native',\n      precision: 'day'\n    },\n    xFormat: \"time:%Y-%m-%d\",\n    yScale: {\n      type: 'linear',\n      stacked: true\n    },\n    enableGridX: false,\n    enableGridY: false,\n    enablePoints: false,\n    useMesh: true,\n    enableArea: true,\n    areaOpacity: 1,\n    enableCrosshair: true,\n    crosshairType: \"bottom\",\n    margin: {\n      // TODO: Get it from theme\n      top: 0,\n      bottom: 20,\n      right: 0,\n      left: 40\n    },\n    colors: [colors.b200, colors.b300, colors.b500],\n    axisLeft: {\n      // TODO: Get it from theme\n      tickSize: 0,\n      tickPadding: 4,\n      tickRotation: 0,\n      tickValues: 3\n    },\n    axisBottom: {\n      // TODO: Get it from theme\n      tickSize: 0,\n      tickPadding: 4,\n      tickRotation: 0,\n      tickValues: 'every 3 days',\n      format: date => moment(date).format('DD/MM')\n    },\n    animate: true,\n    motionConfig: \"stiff\",\n    theme: {\n      // TODO: Get it from theme\n      axis: {\n        ticks: {\n          text: {\n            fill: '#9EA2A8',\n            fontFamily: 'Inter, -apple-system, system-ui, \"Segoe UI\", Roboto, Oxygen, Ubuntu, Cantarell, \"Helvetica Neue\", \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Meiryo UI\", Arial, sans-serif',\n            fontSize: '10px',\n            fontStyle: 'normal',\n            fontWeight: 600,\n            letterSpacing: '0.2px',\n            lineHeight: '12px'\n          }\n        }\n      },\n      tooltip: {\n        container: {\n          backgroundColor: '#1F2329',\n          boxShadow: '0px 0px 12px rgba(47, 52, 61, 0.12), 0px 0px 2px rgba(47, 52, 61, 0.08)',\n          borderRadius: 2\n        }\n      }\n    },\n    enableSlices: \"x\",\n    sliceTooltip: _ref2 => {\n      let {\n        slice: {\n          points\n        }\n      } = _ref2;\n      return /*#__PURE__*/React.createElement(Tile, {\n        elevation: \"2\"\n      }, /*#__PURE__*/React.createElement(Box, null, /*#__PURE__*/React.createElement(Box, null, formatDate(points[0].data.x)), points.map(_ref3 => {\n        let {\n          serieId,\n          data: {\n            y: activeUsers\n          }\n        } = _ref3;\n        return /*#__PURE__*/React.createElement(Box, {\n          key: serieId,\n          fontScale: \"p1m\"\n        }, /*#__PURE__*/React.createElement(Box, null, serieId === 'dau' && t('DAU_value', {\n          value: activeUsers\n        }) || serieId === 'wau' && t('WAU_value', {\n          value: activeUsers\n        }) || serieId === 'mau' && t('MAU_value', {\n          value: activeUsers\n        })));\n      })));\n    }\n  }))))) : /*#__PURE__*/React.createElement(Skeleton, {\n    variant: \"rect\",\n    height: 240\n  })));\n};\nmodule.exportDefault(ActiveUsersSection);","map":{"version":3,"names":["ResponsiveLine","module","link","v","Box","Flex","Skeleton","Tile","colors","default","moment","React","useMemo","useTranslation","DownloadDataButton","CounterSet","useFormatDate","EngagementDashboardCardFilter","LegendSymbol","useActiveUsers","ActiveUsersSection","_ref","timezone","utc","data","countDailyActiveUsers","diffDailyActiveUsers","countWeeklyActiveUsers","diffWeeklyActiveUsers","countMonthlyActiveUsers","diffMonthlyActiveUsers","dauValues","wauValues","mauValues","createPoint","i","x","start","add","startOf","toDate","y","createPoints","Array","from","length","end","diff","_","dauValuesLocal","prevDauValue","wauValuesLocal","prevWauValue","mauValuesLocal","prevMauValue","usersListsMap","month","reduce","map","dayData","date","year","day","endOf","dateOffset","usersList","users","distributeValueOverPoints","count","array","usersSet","Set","k","userId","size","formatDate","t","createElement","Fragment","attachmentName","concat","subtract","headers","dataAvailable","dataExtractor","values","push","toISOString","counters","variant","width","height","variation","description","color","b200","b300","p500","Container","style","Item","align","grow","shrink","position","id","xScale","type","format","precision","xFormat","yScale","stacked","enableGridX","enableGridY","enablePoints","useMesh","enableArea","areaOpacity","enableCrosshair","crosshairType","margin","top","bottom","right","left","b500","axisLeft","tickSize","tickPadding","tickRotation","tickValues","axisBottom","animate","motionConfig","theme","axis","ticks","text","fill","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","tooltip","container","backgroundColor","boxShadow","borderRadius","enableSlices","sliceTooltip","_ref2","slice","points","elevation","_ref3","serieId","activeUsers","key","fontScale","value","exportDefault"],"sources":["client/views/admin/engagementDashboard/users/ActiveUsersSection.tsx"],"sourcesContent":["import { ResponsiveLine } from '@nivo/line';\nimport { Box, Flex, Skeleton, Tile } from '@rocket.chat/fuselage';\nimport colors from '@rocket.chat/fuselage-tokens/colors.json';\nimport moment from 'moment';\nimport type { ReactElement } from 'react';\nimport React, { useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport DownloadDataButton from '../../../../components/dashboards/DownloadDataButton';\nimport CounterSet from '../../../../components/dataView/CounterSet';\nimport { useFormatDate } from '../../../../hooks/useFormatDate';\nimport EngagementDashboardCardFilter from '../EngagementDashboardCardFilter';\nimport LegendSymbol from '../dataView/LegendSymbol';\nimport { useActiveUsers } from './useActiveUsers';\n\ntype ActiveUsersSectionProps = {\n\ttimezone: 'utc' | 'local';\n};\n\nconst ActiveUsersSection = ({ timezone }: ActiveUsersSectionProps): ReactElement => {\n\tconst utc = timezone === 'utc';\n\tconst { data } = useActiveUsers({ utc });\n\n\tconst [\n\t\tcountDailyActiveUsers,\n\t\tdiffDailyActiveUsers,\n\t\tcountWeeklyActiveUsers,\n\t\tdiffWeeklyActiveUsers,\n\t\tcountMonthlyActiveUsers,\n\t\tdiffMonthlyActiveUsers,\n\t\tdauValues = [],\n\t\twauValues = [],\n\t\tmauValues = [],\n\t] = useMemo(() => {\n\t\tif (!data) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst createPoint = (i: number): { x: Date; y: number } => ({\n\t\t\tx: moment(data.start).add(i, 'days').startOf('day').toDate(),\n\t\t\ty: 0,\n\t\t});\n\n\t\tconst createPoints = (): { x: Date; y: number }[] =>\n\t\t\tArray.from({ length: moment(data.end).diff(data.start, 'days') }, (_, i) => createPoint(i));\n\n\t\tconst dauValuesLocal = createPoints();\n\t\tconst prevDauValue = createPoint(-1);\n\t\tconst wauValuesLocal = createPoints();\n\t\tconst prevWauValue = createPoint(-1);\n\t\tconst mauValuesLocal = createPoints();\n\t\tconst prevMauValue = createPoint(-1);\n\n\t\tconst usersListsMap = data.month.reduce<{ [x: number]: string[] }>((map, dayData) => {\n\t\t\tconst date = utc\n\t\t\t\t? moment.utc({ year: dayData.year, month: dayData.month - 1, day: dayData.day }).endOf('day')\n\t\t\t\t: moment({ year: dayData.year, month: dayData.month - 1, day: dayData.day }).endOf('day');\n\t\t\tconst dateOffset = date.diff(data.start, 'days');\n\t\t\tif (dateOffset >= 0 && dauValuesLocal[dateOffset]) {\n\t\t\t\tmap[dateOffset] = dayData.usersList;\n\t\t\t\tdauValuesLocal[dateOffset].y = dayData.users;\n\t\t\t}\n\t\t\treturn map;\n\t\t}, {});\n\n\t\tconst distributeValueOverPoints = (\n\t\t\tusersListsMap: { [x: number]: string[] },\n\t\t\tdateOffset: number,\n\t\t\tcount: number,\n\t\t\tarray: { x: Date; y: number }[],\n\t\t): void => {\n\t\t\tconst usersSet = new Set();\n\t\t\tfor (let k = dateOffset; count > 0; k--, count--) {\n\t\t\t\tif (usersListsMap[k]) {\n\t\t\t\t\tusersListsMap[k].map((userId) => usersSet.add(userId));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tarray[dateOffset].y = usersSet.size;\n\t\t};\n\n\t\tfor (let i = 0; i < dauValuesLocal.length; i++) {\n\t\t\tdistributeValueOverPoints(usersListsMap, i, 7, wauValuesLocal);\n\t\t\tdistributeValueOverPoints(usersListsMap, i, 30, mauValuesLocal);\n\t\t}\n\t\tprevWauValue.y = wauValuesLocal[dauValuesLocal.length - 2].y;\n\t\tprevMauValue.y = mauValuesLocal[dauValuesLocal.length - 2].y;\n\t\tprevDauValue.y = dauValuesLocal[dauValuesLocal.length - 2].y;\n\n\t\treturn [\n\t\t\tdauValuesLocal[dauValuesLocal.length - 1].y,\n\t\t\tdauValuesLocal[dauValuesLocal.length - 1].y - prevDauValue.y,\n\t\t\twauValuesLocal[wauValuesLocal.length - 1].y,\n\t\t\twauValuesLocal[wauValuesLocal.length - 1].y - prevWauValue.y,\n\t\t\tmauValuesLocal[mauValuesLocal.length - 1].y,\n\t\t\tmauValuesLocal[mauValuesLocal.length - 1].y - prevMauValue.y,\n\t\t\tdauValuesLocal,\n\t\t\twauValuesLocal,\n\t\t\tmauValuesLocal,\n\t\t];\n\t}, [data, utc]);\n\n\tconst formatDate = useFormatDate();\n\tconst { t } = useTranslation();\n\n\treturn (\n\t\t<>\n\t\t\t<EngagementDashboardCardFilter>\n\t\t\t\t<DownloadDataButton\n\t\t\t\t\tattachmentName={`ActiveUsersSection_start_${data?.start}_end_${moment(data?.end).subtract(1, 'day')}`}\n\t\t\t\t\theaders={['Date', 'DAU', 'WAU', 'MAU']}\n\t\t\t\t\tdataAvailable={!!data}\n\t\t\t\t\tdataExtractor={(): unknown[][] | undefined => {\n\t\t\t\t\t\tconst values = [];\n\n\t\t\t\t\t\tfor (let i = 0; i < 30; i++) {\n\t\t\t\t\t\t\tvalues.push([dauValues[i].x.toISOString(), dauValues[i].y, wauValues[i].y, mauValues[i].y]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn values;\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</EngagementDashboardCardFilter>\n\t\t\t<CounterSet\n\t\t\t\tcounters={[\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countDailyActiveUsers ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: diffDailyActiveUsers ?? 0,\n\t\t\t\t\t\tdescription: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<LegendSymbol color={colors.b200} /> {t('Daily_Active_Users')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countWeeklyActiveUsers ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: diffWeeklyActiveUsers ?? 0,\n\t\t\t\t\t\tdescription: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<LegendSymbol color={colors.b300} /> {t('Weekly_Active_Users')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countMonthlyActiveUsers ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: diffMonthlyActiveUsers ?? 0,\n\t\t\t\t\t\tdescription: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<LegendSymbol color={colors.p500} /> {t('Monthly_Active_Users')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t]}\n\t\t\t/>\n\t\t\t<Flex.Container>\n\t\t\t\t{data ? (\n\t\t\t\t\t<Box style={{ height: 240 }}>\n\t\t\t\t\t\t<Flex.Item align='stretch' grow={1} shrink={0}>\n\t\t\t\t\t\t\t<Box style={{ position: 'relative' }}>\n\t\t\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\t\t\t\theight: '100%',\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<ResponsiveLine\n\t\t\t\t\t\t\t\t\t\tdata={[\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tid: 'dau',\n\t\t\t\t\t\t\t\t\t\t\t\tdata: dauValues,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tid: 'wau',\n\t\t\t\t\t\t\t\t\t\t\t\tdata: wauValues,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tid: 'mau',\n\t\t\t\t\t\t\t\t\t\t\t\tdata: mauValues,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t\txScale={{\n\t\t\t\t\t\t\t\t\t\t\ttype: 'time',\n\t\t\t\t\t\t\t\t\t\t\tformat: 'native',\n\t\t\t\t\t\t\t\t\t\t\tprecision: 'day',\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\txFormat='time:%Y-%m-%d'\n\t\t\t\t\t\t\t\t\t\tyScale={{\n\t\t\t\t\t\t\t\t\t\t\ttype: 'linear',\n\t\t\t\t\t\t\t\t\t\t\tstacked: true,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tenableGridX={false}\n\t\t\t\t\t\t\t\t\t\tenableGridY={false}\n\t\t\t\t\t\t\t\t\t\tenablePoints={false}\n\t\t\t\t\t\t\t\t\t\tuseMesh\n\t\t\t\t\t\t\t\t\t\tenableArea\n\t\t\t\t\t\t\t\t\t\tareaOpacity={1}\n\t\t\t\t\t\t\t\t\t\tenableCrosshair\n\t\t\t\t\t\t\t\t\t\tcrosshairType='bottom'\n\t\t\t\t\t\t\t\t\t\tmargin={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\t\t\t\t\tbottom: 20,\n\t\t\t\t\t\t\t\t\t\t\tright: 0,\n\t\t\t\t\t\t\t\t\t\t\tleft: 40,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tcolors={[colors.b200, colors.b300, colors.b500]}\n\t\t\t\t\t\t\t\t\t\taxisLeft={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\ttickSize: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickPadding: 4,\n\t\t\t\t\t\t\t\t\t\t\ttickRotation: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickValues: 3,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\taxisBottom={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\ttickSize: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickPadding: 4,\n\t\t\t\t\t\t\t\t\t\t\ttickRotation: 0,\n\t\t\t\t\t\t\t\t\t\t\ttickValues: 'every 3 days',\n\t\t\t\t\t\t\t\t\t\t\tformat: (date): string => moment(date).format('DD/MM'),\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tanimate={true}\n\t\t\t\t\t\t\t\t\t\tmotionConfig='stiff'\n\t\t\t\t\t\t\t\t\t\ttheme={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\taxis: {\n\t\t\t\t\t\t\t\t\t\t\t\tticks: {\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill: '#9EA2A8',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontFamily:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Inter, -apple-system, system-ui, \"Segoe UI\", Roboto, Oxygen, Ubuntu, Cantarell, \"Helvetica Neue\", \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Meiryo UI\", Arial, sans-serif',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: '10px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontStyle: 'normal',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontWeight: 600,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tletterSpacing: '0.2px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlineHeight: '12px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\ttooltip: {\n\t\t\t\t\t\t\t\t\t\t\t\tcontainer: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: '#1F2329',\n\t\t\t\t\t\t\t\t\t\t\t\t\tboxShadow: '0px 0px 12px rgba(47, 52, 61, 0.12), 0px 0px 2px rgba(47, 52, 61, 0.08)',\n\t\t\t\t\t\t\t\t\t\t\t\t\tborderRadius: 2,\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tenableSlices='x'\n\t\t\t\t\t\t\t\t\t\tsliceTooltip={({ slice: { points } }): ReactElement => (\n\t\t\t\t\t\t\t\t\t\t\t<Tile elevation='2'>\n\t\t\t\t\t\t\t\t\t\t\t\t<Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Box>{formatDate(points[0].data.x)}</Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{points.map(({ serieId, data: { y: activeUsers } }) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Box key={serieId} fontScale='p1m'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(serieId === 'dau' && t('DAU_value', { value: activeUsers })) ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(serieId === 'wau' && t('WAU_value', { value: activeUsers })) ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(serieId === 'mau' && t('MAU_value', { value: activeUsers }))}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t\t</Tile>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Flex.Item>\n\t\t\t\t\t</Box>\n\t\t\t\t) : (\n\t\t\t\t\t<Skeleton variant='rect' height={240} />\n\t\t\t\t)}\n\t\t\t</Flex.Container>\n\t\t</>\n\t);\n};\n\nexport default ActiveUsersSection;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"e8889fa8640dd08acfd32c07c46807e39954229c"}
