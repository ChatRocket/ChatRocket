{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/body/DropTargetOverlay.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/room/body/DropTargetOverlay.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/body/DropTargetOverlay.tsx","inputSourceMap":{"version":3,"file":"client/views/room/body/DropTargetOverlay.tsx","sourceRoot":"","sources":["client/views/room/body/DropTargetOverlay.tsx"],"names":[],"mappings":"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","sourcesContent":["import { css } from '@rocket.chat/css-in-js';\nimport { Box } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { DragEvent, ReactElement, ReactNode } from 'react';\nimport React, { memo } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { useFormatDateAndTime } from '../../../hooks/useFormatDateAndTime';\n\ntype DropTargetOverlayProps = {\n\tenabled: boolean;\n\treason?: ReactNode;\n\tonFileDrop?: (files: File[]) => void;\n\tvisible?: boolean;\n\tonDismiss?: () => void;\n};\n\nfunction DropTargetOverlay({ enabled, reason, onFileDrop, visible = true, onDismiss }: DropTargetOverlayProps): ReactElement | null {\n\tconst { t } = useTranslation();\n\n\tconst handleDragLeave = useMutableCallback((event: DragEvent) => {\n\t\tevent.stopPropagation();\n\t\tonDismiss?.();\n\t});\n\n\tconst handleDragOver = useMutableCallback((event: DragEvent) => {\n\t\tevent.stopPropagation();\n\n\t\tevent.preventDefault();\n\t\tevent.dataTransfer.dropEffect = ['move', 'linkMove'].includes(event.dataTransfer.effectAllowed) ? 'move' : 'copy';\n\t});\n\n\tconst formatDateAndTime = useFormatDateAndTime();\n\n\tconst handleDrop = useMutableCallback(async (event: DragEvent) => {\n\t\tevent.stopPropagation();\n\t\tonDismiss?.();\n\n\t\tevent.preventDefault();\n\n\t\tconst files = Array.from(event.dataTransfer.files);\n\n\t\tif (event.dataTransfer.types.includes('text/uri-list') && event.dataTransfer.types.includes('text/html')) {\n\t\t\tconst fragment = document.createRange().createContextualFragment(event.dataTransfer.getData('text/html'));\n\t\t\tfor await (const { src } of Array.from(fragment.querySelectorAll('img'))) {\n\t\t\t\ttry {\n\t\t\t\t\tconst response = await fetch(src);\n\t\t\t\t\tconst data = await response.blob();\n\t\t\t\t\tconst extension = (await import('../../../../app/utils/lib/mimeTypes')).mime.extension(data.type);\n\t\t\t\t\tconst filename = `File - ${formatDateAndTime(new Date())}.${extension}`;\n\t\t\t\t\tconst file = new File([data], filename, { type: data.type });\n\t\t\t\t\tfiles.push(file);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.warn(error);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tonFileDrop?.(files);\n\t});\n\n\tif (!visible) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<Box\n\t\t\trole='dialog'\n\t\t\tdata-qa='DropTargetOverlay'\n\t\t\tposition='absolute'\n\t\t\tzIndex={1_000_000}\n\t\t\tinset={0}\n\t\t\tdisplay='flex'\n\t\t\talignItems='center'\n\t\t\tjustifyContent='center'\n\t\t\tfontScale='hero'\n\t\t\ttextAlign='center'\n\t\t\tbackgroundColor='rgba(255, 255, 255, 0.8)'\n\t\t\tborderWidth={4}\n\t\t\tborderStyle='dashed'\n\t\t\tborderColor='currentColor'\n\t\t\tcolor={enabled ? 'primary' : 'danger'}\n\t\t\tclassName={css`\n\t\t\t\tanimation-name: zoom-in;\n\t\t\t\tanimation-duration: 0.1s;\n\t\t\t`}\n\t\t\tonDragLeave={handleDragLeave}\n\t\t\tonDragOver={handleDragOver}\n\t\t\tonDrop={handleDrop}\n\t\t>\n\t\t\t{enabled ? t('Drop_to_upload_file') : reason}\n\t\t</Box>\n\t);\n}\n\nexport default memo(DropTargetOverlay);\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/body/DropTargetOverlay.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/body/DropTargetOverlay.tsx","inputSourceMap":{"version":3,"file":"client/views/room/body/DropTargetOverlay.tsx","sourceRoot":"","sources":["client/views/room/body/DropTargetOverlay.tsx"],"names":[],"mappings":"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","sourcesContent":["import { css } from '@rocket.chat/css-in-js';\nimport { Box } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { DragEvent, ReactElement, ReactNode } from 'react';\nimport React, { memo } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { useFormatDateAndTime } from '../../../hooks/useFormatDateAndTime';\n\ntype DropTargetOverlayProps = {\n\tenabled: boolean;\n\treason?: ReactNode;\n\tonFileDrop?: (files: File[]) => void;\n\tvisible?: boolean;\n\tonDismiss?: () => void;\n};\n\nfunction DropTargetOverlay({ enabled, reason, onFileDrop, visible = true, onDismiss }: DropTargetOverlayProps): ReactElement | null {\n\tconst { t } = useTranslation();\n\n\tconst handleDragLeave = useMutableCallback((event: DragEvent) => {\n\t\tevent.stopPropagation();\n\t\tonDismiss?.();\n\t});\n\n\tconst handleDragOver = useMutableCallback((event: DragEvent) => {\n\t\tevent.stopPropagation();\n\n\t\tevent.preventDefault();\n\t\tevent.dataTransfer.dropEffect = ['move', 'linkMove'].includes(event.dataTransfer.effectAllowed) ? 'move' : 'copy';\n\t});\n\n\tconst formatDateAndTime = useFormatDateAndTime();\n\n\tconst handleDrop = useMutableCallback(async (event: DragEvent) => {\n\t\tevent.stopPropagation();\n\t\tonDismiss?.();\n\n\t\tevent.preventDefault();\n\n\t\tconst files = Array.from(event.dataTransfer.files);\n\n\t\tif (event.dataTransfer.types.includes('text/uri-list') && event.dataTransfer.types.includes('text/html')) {\n\t\t\tconst fragment = document.createRange().createContextualFragment(event.dataTransfer.getData('text/html'));\n\t\t\tfor await (const { src } of Array.from(fragment.querySelectorAll('img'))) {\n\t\t\t\ttry {\n\t\t\t\t\tconst response = await fetch(src);\n\t\t\t\t\tconst data = await response.blob();\n\t\t\t\t\tconst extension = (await import('../../../../app/utils/lib/mimeTypes')).mime.extension(data.type);\n\t\t\t\t\tconst filename = `File - ${formatDateAndTime(new Date())}.${extension}`;\n\t\t\t\t\tconst file = new File([data], filename, { type: data.type });\n\t\t\t\t\tfiles.push(file);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.warn(error);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tonFileDrop?.(files);\n\t});\n\n\tif (!visible) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<Box\n\t\t\trole='dialog'\n\t\t\tdata-qa='DropTargetOverlay'\n\t\t\tposition='absolute'\n\t\t\tzIndex={1_000_000}\n\t\t\tinset={0}\n\t\t\tdisplay='flex'\n\t\t\talignItems='center'\n\t\t\tjustifyContent='center'\n\t\t\tfontScale='hero'\n\t\t\ttextAlign='center'\n\t\t\tbackgroundColor='rgba(255, 255, 255, 0.8)'\n\t\t\tborderWidth={4}\n\t\t\tborderStyle='dashed'\n\t\t\tborderColor='currentColor'\n\t\t\tcolor={enabled ? 'primary' : 'danger'}\n\t\t\tclassName={css`\n\t\t\t\tanimation-name: zoom-in;\n\t\t\t\tanimation-duration: 0.1s;\n\t\t\t`}\n\t\t\tonDragLeave={handleDragLeave}\n\t\t\tonDragOver={handleDragOver}\n\t\t\tonDrop={handleDrop}\n\t\t>\n\t\t\t{enabled ? t('Drop_to_upload_file') : reason}\n\t\t</Box>\n\t);\n}\n\nexport default memo(DropTargetOverlay);\n"]}}},"code":"var _templateObject;\nlet _taggedTemplateLiteral;\nmodule.link(\"@babel/runtime/helpers/taggedTemplateLiteral\", {\n  default(v) {\n    _taggedTemplateLiteral = v;\n  }\n}, 0);\nlet _asyncIterator;\nmodule.link(\"@babel/runtime/helpers/asyncIterator\", {\n  default(v) {\n    _asyncIterator = v;\n  }\n}, 1);\nlet css;\nmodule.link(\"@rocket.chat/css-in-js\", {\n  css(v) {\n    css = v;\n  }\n}, 0);\nlet Box;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Box(v) {\n    Box = v;\n  }\n}, 1);\nlet useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback(v) {\n    useMutableCallback = v;\n  }\n}, 2);\nlet React, memo;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n  memo(v) {\n    memo = v;\n  }\n}, 3);\nlet useTranslation;\nmodule.link(\"react-i18next\", {\n  useTranslation(v) {\n    useTranslation = v;\n  }\n}, 4);\nlet useFormatDateAndTime;\nmodule.link(\"../../../hooks/useFormatDateAndTime\", {\n  useFormatDateAndTime(v) {\n    useFormatDateAndTime = v;\n  }\n}, 5);\nfunction DropTargetOverlay(_ref) {\n  let {\n    enabled,\n    reason,\n    onFileDrop,\n    visible = true,\n    onDismiss\n  } = _ref;\n  const {\n    t\n  } = useTranslation();\n  const handleDragLeave = useMutableCallback(event => {\n    event.stopPropagation();\n    onDismiss === null || onDismiss === void 0 ? void 0 : onDismiss();\n  });\n  const handleDragOver = useMutableCallback(event => {\n    event.stopPropagation();\n    event.preventDefault();\n    event.dataTransfer.dropEffect = ['move', 'linkMove'].includes(event.dataTransfer.effectAllowed) ? 'move' : 'copy';\n  });\n  const formatDateAndTime = useFormatDateAndTime();\n  const handleDrop = useMutableCallback(async event => {\n    event.stopPropagation();\n    onDismiss === null || onDismiss === void 0 ? void 0 : onDismiss();\n    event.preventDefault();\n    const files = Array.from(event.dataTransfer.files);\n    if (event.dataTransfer.types.includes('text/uri-list') && event.dataTransfer.types.includes('text/html')) {\n      const fragment = document.createRange().createContextualFragment(event.dataTransfer.getData('text/html'));\n      var _iteratorAbruptCompletion = false;\n      var _didIteratorError = false;\n      var _iteratorError;\n      try {\n        for (var _iterator = _asyncIterator(Array.from(fragment.querySelectorAll('img'))), _step; _iteratorAbruptCompletion = !(_step = await _iterator.next()).done; _iteratorAbruptCompletion = false) {\n          const {\n            src\n          } = _step.value;\n          {\n            try {\n              const response = await fetch(src);\n              const data = await response.blob();\n              const extension = (await module.dynamicImport('../../../../app/utils/lib/mimeTypes')).mime.extension(data.type);\n              const filename = \"File - \".concat(formatDateAndTime(new Date()), \".\").concat(extension);\n              const file = new File([data], filename, {\n                type: data.type\n              });\n              files.push(file);\n            } catch (error) {\n              console.warn(error);\n            }\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (_iteratorAbruptCompletion && _iterator.return != null) {\n            await _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n    }\n    onFileDrop === null || onFileDrop === void 0 ? void 0 : onFileDrop(files);\n  });\n  if (!visible) {\n    return null;\n  }\n  return /*#__PURE__*/React.createElement(Box, {\n    role: \"dialog\",\n    \"data-qa\": \"DropTargetOverlay\",\n    position: \"absolute\",\n    zIndex: 1_000_000,\n    inset: 0,\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    fontScale: \"hero\",\n    textAlign: \"center\",\n    backgroundColor: \"rgba(255, 255, 255, 0.8)\",\n    borderWidth: 4,\n    borderStyle: \"dashed\",\n    borderColor: \"currentColor\",\n    color: enabled ? 'primary' : 'danger',\n    className: css(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n\\t\\t\\t\\tanimation-name: zoom-in;\\n\\t\\t\\t\\tanimation-duration: 0.1s;\\n\\t\\t\\t\"]))),\n    onDragLeave: handleDragLeave,\n    onDragOver: handleDragOver,\n    onDrop: handleDrop\n  }, enabled ? t('Drop_to_upload_file') : reason);\n}\nmodule.exportDefault( /*#__PURE__*/memo(DropTargetOverlay));","map":{"version":3,"names":["_taggedTemplateLiteral","module","link","default","v","_asyncIterator","css","Box","useMutableCallback","React","memo","useTranslation","useFormatDateAndTime","DropTargetOverlay","_ref","enabled","reason","onFileDrop","visible","onDismiss","t","handleDragLeave","event","stopPropagation","handleDragOver","preventDefault","dataTransfer","dropEffect","includes","effectAllowed","formatDateAndTime","handleDrop","files","Array","from","types","fragment","document","createRange","createContextualFragment","getData","_iteratorAbruptCompletion","_didIteratorError","_iteratorError","_iterator","querySelectorAll","_step","next","done","src","value","response","fetch","data","blob","extension","dynamicImport","mime","type","filename","concat","Date","file","File","push","error","console","warn","err","return","createElement","role","position","zIndex","inset","display","alignItems","justifyContent","fontScale","textAlign","backgroundColor","borderWidth","borderStyle","borderColor","color","className","_templateObject","onDragLeave","onDragOver","onDrop","exportDefault"],"sources":["client/views/room/body/DropTargetOverlay.tsx"],"sourcesContent":["import { css } from '@rocket.chat/css-in-js';\nimport { Box } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { DragEvent, ReactElement, ReactNode } from 'react';\nimport React, { memo } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { useFormatDateAndTime } from '../../../hooks/useFormatDateAndTime';\n\ntype DropTargetOverlayProps = {\n\tenabled: boolean;\n\treason?: ReactNode;\n\tonFileDrop?: (files: File[]) => void;\n\tvisible?: boolean;\n\tonDismiss?: () => void;\n};\n\nfunction DropTargetOverlay({ enabled, reason, onFileDrop, visible = true, onDismiss }: DropTargetOverlayProps): ReactElement | null {\n\tconst { t } = useTranslation();\n\n\tconst handleDragLeave = useMutableCallback((event: DragEvent) => {\n\t\tevent.stopPropagation();\n\t\tonDismiss?.();\n\t});\n\n\tconst handleDragOver = useMutableCallback((event: DragEvent) => {\n\t\tevent.stopPropagation();\n\n\t\tevent.preventDefault();\n\t\tevent.dataTransfer.dropEffect = ['move', 'linkMove'].includes(event.dataTransfer.effectAllowed) ? 'move' : 'copy';\n\t});\n\n\tconst formatDateAndTime = useFormatDateAndTime();\n\n\tconst handleDrop = useMutableCallback(async (event: DragEvent) => {\n\t\tevent.stopPropagation();\n\t\tonDismiss?.();\n\n\t\tevent.preventDefault();\n\n\t\tconst files = Array.from(event.dataTransfer.files);\n\n\t\tif (event.dataTransfer.types.includes('text/uri-list') && event.dataTransfer.types.includes('text/html')) {\n\t\t\tconst fragment = document.createRange().createContextualFragment(event.dataTransfer.getData('text/html'));\n\t\t\tfor await (const { src } of Array.from(fragment.querySelectorAll('img'))) {\n\t\t\t\ttry {\n\t\t\t\t\tconst response = await fetch(src);\n\t\t\t\t\tconst data = await response.blob();\n\t\t\t\t\tconst extension = (await import('../../../../app/utils/lib/mimeTypes')).mime.extension(data.type);\n\t\t\t\t\tconst filename = `File - ${formatDateAndTime(new Date())}.${extension}`;\n\t\t\t\t\tconst file = new File([data], filename, { type: data.type });\n\t\t\t\t\tfiles.push(file);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.warn(error);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tonFileDrop?.(files);\n\t});\n\n\tif (!visible) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<Box\n\t\t\trole='dialog'\n\t\t\tdata-qa='DropTargetOverlay'\n\t\t\tposition='absolute'\n\t\t\tzIndex={1_000_000}\n\t\t\tinset={0}\n\t\t\tdisplay='flex'\n\t\t\talignItems='center'\n\t\t\tjustifyContent='center'\n\t\t\tfontScale='hero'\n\t\t\ttextAlign='center'\n\t\t\tbackgroundColor='rgba(255, 255, 255, 0.8)'\n\t\t\tborderWidth={4}\n\t\t\tborderStyle='dashed'\n\t\t\tborderColor='currentColor'\n\t\t\tcolor={enabled ? 'primary' : 'danger'}\n\t\t\tclassName={css`\n\t\t\t\tanimation-name: zoom-in;\n\t\t\t\tanimation-duration: 0.1s;\n\t\t\t`}\n\t\t\tonDragLeave={handleDragLeave}\n\t\t\tonDragOver={handleDragOver}\n\t\t\tonDrop={handleDrop}\n\t\t>\n\t\t\t{enabled ? t('Drop_to_upload_file') : reason}\n\t\t</Box>\n\t);\n}\n\nexport default memo(DropTargetOverlay);\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"825eaa97c97f8b9eda8b383190458a57c11b0722"}
