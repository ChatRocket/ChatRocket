{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/permissions/EditRolePage.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/admin/permissions/EditRolePage.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/permissions/EditRolePage.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/permissions/EditRolePage.tsx","sourceRoot":"","sources":["client/views/admin/permissions/EditRolePage.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IRole } from '@rocket.chat/core-typings';\nimport { Box, ButtonGroup, Button, Margins } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useToastMessageDispatch, useRoute, useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React from 'react';\nimport { FormProvider, useForm } from 'react-hook-form';\n\nimport { ContextualbarFooter, ContextualbarScrollableContent } from '../../../components/Contextualbar';\nimport GenericModal from '../../../components/GenericModal';\nimport RoleForm from './RoleForm';\n\nconst EditRolePage = ({ role, isEnterprise }: { role?: IRole; isEnterprise: boolean }): ReactElement => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setModal = useSetModal();\n\tconst usersInRoleRouter = useRoute('admin-permissions');\n\tconst router = useRoute('admin-permissions');\n\n\tconst createRole = useEndpoint('POST', '/v1/roles.create');\n\tconst updateRole = useEndpoint('POST', '/v1/roles.update');\n\tconst deleteRole = useEndpoint('POST', '/v1/roles.delete');\n\n\tconst methods = useForm({\n\t\tdefaultValues: {\n\t\t\troleId: role?._id,\n\t\t\tname: role?.name,\n\t\t\tdescription: role?.description,\n\t\t\tscope: role?.scope || 'Users',\n\t\t\tmandatory2fa: !!role?.mandatory2fa,\n\t\t},\n\t});\n\n\tconst handleManageUsers = useMutableCallback(() => {\n\t\tif (role?._id) {\n\t\t\tusersInRoleRouter.push({\n\t\t\t\tcontext: 'users-in-role',\n\t\t\t\t_id: role._id,\n\t\t\t});\n\t\t}\n\t});\n\n\tconst handleSave = useMutableCallback(async (data) => {\n\t\ttry {\n\t\t\tif (data.roleId) {\n\t\t\t\tawait updateRole(data);\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\t\treturn router.push({});\n\t\t\t}\n\n\t\t\tawait createRole(data);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleDelete = useMutableCallback(async () => {\n\t\tif (!role?._id) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst deleteRoleAction = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tawait deleteRole({ roleId: role._id });\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Role_removed') });\n\t\t\t\tsetModal();\n\n\t\t\t\trouter.push({});\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\tsetModal();\n\t\t\t}\n\t\t};\n\n\t\tconst deleteRoleMessage = isEnterprise ? t('Delete_Role_Warning') : t('Delete_Role_Warning_Not_Enterprise');\n\n\t\tsetModal(\n\t\t\t<GenericModal\n\t\t\t\tvariant='danger'\n\t\t\t\tonConfirm={deleteRoleAction}\n\t\t\t\tonClose={(): void => setModal()}\n\t\t\t\tonCancel={(): void => setModal()}\n\t\t\t\tconfirmText={t('Delete')}\n\t\t\t>\n\t\t\t\t{deleteRoleMessage}\n\t\t\t</GenericModal>,\n\t\t);\n\t});\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarScrollableContent>\n\t\t\t\t<Box w='full' alignSelf='center' mb='neg-x8'>\n\t\t\t\t\t<Margins block={8}>\n\t\t\t\t\t\t<FormProvider {...methods}>\n\t\t\t\t\t\t\t<RoleForm editing={Boolean(role?._id)} isProtected={role?.protected} isDisabled={!isEnterprise} />\n\t\t\t\t\t\t</FormProvider>\n\t\t\t\t\t</Margins>\n\t\t\t\t</Box>\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup vertical stretch>\n\t\t\t\t\t<Button primary disabled={!methods.formState.isDirty || !isEnterprise} onClick={methods.handleSubmit(handleSave)}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t{!role?.protected && role?._id && (\n\t\t\t\t\t\t<Button secondary danger onClick={handleDelete}>\n\t\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t{role?._id && <Button onClick={handleManageUsers}>{t('Users_in_role')}</Button>}\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</>\n\t);\n};\n\nexport default EditRolePage;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/permissions/EditRolePage.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/admin/permissions/EditRolePage.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/permissions/EditRolePage.tsx","sourceRoot":"","sources":["client/views/admin/permissions/EditRolePage.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IRole } from '@rocket.chat/core-typings';\nimport { Box, ButtonGroup, Button, Margins } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useToastMessageDispatch, useRoute, useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React from 'react';\nimport { FormProvider, useForm } from 'react-hook-form';\n\nimport { ContextualbarFooter, ContextualbarScrollableContent } from '../../../components/Contextualbar';\nimport GenericModal from '../../../components/GenericModal';\nimport RoleForm from './RoleForm';\n\nconst EditRolePage = ({ role, isEnterprise }: { role?: IRole; isEnterprise: boolean }): ReactElement => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setModal = useSetModal();\n\tconst usersInRoleRouter = useRoute('admin-permissions');\n\tconst router = useRoute('admin-permissions');\n\n\tconst createRole = useEndpoint('POST', '/v1/roles.create');\n\tconst updateRole = useEndpoint('POST', '/v1/roles.update');\n\tconst deleteRole = useEndpoint('POST', '/v1/roles.delete');\n\n\tconst methods = useForm({\n\t\tdefaultValues: {\n\t\t\troleId: role?._id,\n\t\t\tname: role?.name,\n\t\t\tdescription: role?.description,\n\t\t\tscope: role?.scope || 'Users',\n\t\t\tmandatory2fa: !!role?.mandatory2fa,\n\t\t},\n\t});\n\n\tconst handleManageUsers = useMutableCallback(() => {\n\t\tif (role?._id) {\n\t\t\tusersInRoleRouter.push({\n\t\t\t\tcontext: 'users-in-role',\n\t\t\t\t_id: role._id,\n\t\t\t});\n\t\t}\n\t});\n\n\tconst handleSave = useMutableCallback(async (data) => {\n\t\ttry {\n\t\t\tif (data.roleId) {\n\t\t\t\tawait updateRole(data);\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\t\treturn router.push({});\n\t\t\t}\n\n\t\t\tawait createRole(data);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleDelete = useMutableCallback(async () => {\n\t\tif (!role?._id) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst deleteRoleAction = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tawait deleteRole({ roleId: role._id });\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Role_removed') });\n\t\t\t\tsetModal();\n\n\t\t\t\trouter.push({});\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\tsetModal();\n\t\t\t}\n\t\t};\n\n\t\tconst deleteRoleMessage = isEnterprise ? t('Delete_Role_Warning') : t('Delete_Role_Warning_Not_Enterprise');\n\n\t\tsetModal(\n\t\t\t<GenericModal\n\t\t\t\tvariant='danger'\n\t\t\t\tonConfirm={deleteRoleAction}\n\t\t\t\tonClose={(): void => setModal()}\n\t\t\t\tonCancel={(): void => setModal()}\n\t\t\t\tconfirmText={t('Delete')}\n\t\t\t>\n\t\t\t\t{deleteRoleMessage}\n\t\t\t</GenericModal>,\n\t\t);\n\t});\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarScrollableContent>\n\t\t\t\t<Box w='full' alignSelf='center' mb='neg-x8'>\n\t\t\t\t\t<Margins block={8}>\n\t\t\t\t\t\t<FormProvider {...methods}>\n\t\t\t\t\t\t\t<RoleForm editing={Boolean(role?._id)} isProtected={role?.protected} isDisabled={!isEnterprise} />\n\t\t\t\t\t\t</FormProvider>\n\t\t\t\t\t</Margins>\n\t\t\t\t</Box>\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup vertical stretch>\n\t\t\t\t\t<Button primary disabled={!methods.formState.isDirty || !isEnterprise} onClick={methods.handleSubmit(handleSave)}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t{!role?.protected && role?._id && (\n\t\t\t\t\t\t<Button secondary danger onClick={handleDelete}>\n\t\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t{role?._id && <Button onClick={handleManageUsers}>{t('Users_in_role')}</Button>}\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</>\n\t);\n};\n\nexport default EditRolePage;\n"]}}},"code":"var _regeneratorRuntime;\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\nvar Box, ButtonGroup, Button, Margins;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Box: function (v) {\n    Box = v;\n  },\n  ButtonGroup: function (v) {\n    ButtonGroup = v;\n  },\n  Button: function (v) {\n    Button = v;\n  },\n  Margins: function (v) {\n    Margins = v;\n  }\n}, 0);\nvar useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback: function (v) {\n    useMutableCallback = v;\n  }\n}, 1);\nvar useSetModal, useToastMessageDispatch, useRoute, useEndpoint, useTranslation;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useSetModal: function (v) {\n    useSetModal = v;\n  },\n  useToastMessageDispatch: function (v) {\n    useToastMessageDispatch = v;\n  },\n  useRoute: function (v) {\n    useRoute = v;\n  },\n  useEndpoint: function (v) {\n    useEndpoint = v;\n  },\n  useTranslation: function (v) {\n    useTranslation = v;\n  }\n}, 2);\nvar React;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  }\n}, 3);\nvar FormProvider, useForm;\nmodule.link(\"react-hook-form\", {\n  FormProvider: function (v) {\n    FormProvider = v;\n  },\n  useForm: function (v) {\n    useForm = v;\n  }\n}, 4);\nvar ContextualbarFooter, ContextualbarScrollableContent;\nmodule.link(\"../../../components/Contextualbar\", {\n  ContextualbarFooter: function (v) {\n    ContextualbarFooter = v;\n  },\n  ContextualbarScrollableContent: function (v) {\n    ContextualbarScrollableContent = v;\n  }\n}, 5);\nvar GenericModal;\nmodule.link(\"../../../components/GenericModal\", {\n  \"default\": function (v) {\n    GenericModal = v;\n  }\n}, 6);\nvar RoleForm;\nmodule.link(\"./RoleForm\", {\n  \"default\": function (v) {\n    RoleForm = v;\n  }\n}, 7);\nvar EditRolePage = function (_ref) {\n  var role = _ref.role,\n    isEnterprise = _ref.isEnterprise;\n  var t = useTranslation();\n  var dispatchToastMessage = useToastMessageDispatch();\n  var setModal = useSetModal();\n  var usersInRoleRouter = useRoute('admin-permissions');\n  var router = useRoute('admin-permissions');\n  var createRole = useEndpoint('POST', '/v1/roles.create');\n  var updateRole = useEndpoint('POST', '/v1/roles.update');\n  var deleteRole = useEndpoint('POST', '/v1/roles.delete');\n  var methods = useForm({\n    defaultValues: {\n      roleId: role === null || role === void 0 ? void 0 : role._id,\n      name: role === null || role === void 0 ? void 0 : role.name,\n      description: role === null || role === void 0 ? void 0 : role.description,\n      scope: (role === null || role === void 0 ? void 0 : role.scope) || 'Users',\n      mandatory2fa: !!(role !== null && role !== void 0 && role.mandatory2fa)\n    }\n  });\n  var handleManageUsers = useMutableCallback(function () {\n    if (role !== null && role !== void 0 && role._id) {\n      usersInRoleRouter.push({\n        context: 'users-in-role',\n        _id: role._id\n      });\n    }\n  });\n  var handleSave = useMutableCallback(function () {\n    function _callee(data) {\n      return _regeneratorRuntime.async(function () {\n        function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              if (!data.roleId) {\n                _context.next = 6;\n                break;\n              }\n              _context.next = 4;\n              return _regeneratorRuntime.awrap(updateRole(data));\n            case 4:\n              dispatchToastMessage({\n                type: 'success',\n                message: t('Saved')\n              });\n              return _context.abrupt(\"return\", router.push({}));\n            case 6:\n              _context.next = 8;\n              return _regeneratorRuntime.awrap(createRole(data));\n            case 8:\n              dispatchToastMessage({\n                type: 'success',\n                message: t('Saved')\n              });\n              router.push({});\n              _context.next = 15;\n              break;\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](0);\n              dispatchToastMessage({\n                type: 'error',\n                message: _context.t0\n              });\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n        return _callee$;\n      }(), null, null, [[0, 12]], Promise);\n    }\n    return _callee;\n  }());\n  var handleDelete = useMutableCallback(function () {\n    function _callee3() {\n      var deleteRoleAction, deleteRoleMessage;\n      return _regeneratorRuntime.async(function () {\n        function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              if (role !== null && role !== void 0 && role._id) {\n                _context3.next = 2;\n                break;\n              }\n              return _context3.abrupt(\"return\");\n            case 2:\n              deleteRoleAction = function () {\n                function _callee2() {\n                  return _regeneratorRuntime.async(function () {\n                    function _callee2$(_context2) {\n                      while (1) switch (_context2.prev = _context2.next) {\n                        case 0:\n                          _context2.prev = 0;\n                          _context2.next = 3;\n                          return _regeneratorRuntime.awrap(deleteRole({\n                            roleId: role._id\n                          }));\n                        case 3:\n                          dispatchToastMessage({\n                            type: 'success',\n                            message: t('Role_removed')\n                          });\n                          setModal();\n                          router.push({});\n                          _context2.next = 12;\n                          break;\n                        case 8:\n                          _context2.prev = 8;\n                          _context2.t0 = _context2[\"catch\"](0);\n                          dispatchToastMessage({\n                            type: 'error',\n                            message: _context2.t0\n                          });\n                          setModal();\n                        case 12:\n                        case \"end\":\n                          return _context2.stop();\n                      }\n                    }\n                    return _callee2$;\n                  }(), null, null, [[0, 8]], Promise);\n                }\n                return _callee2;\n              }();\n              deleteRoleMessage = isEnterprise ? t('Delete_Role_Warning') : t('Delete_Role_Warning_Not_Enterprise');\n              setModal( /*#__PURE__*/React.createElement(GenericModal, {\n                variant: \"danger\",\n                onConfirm: deleteRoleAction,\n                onClose: function () {\n                  return setModal();\n                },\n                onCancel: function () {\n                  return setModal();\n                },\n                confirmText: t('Delete')\n              }, deleteRoleMessage));\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n        return _callee3$;\n      }(), null, null, null, Promise);\n    }\n    return _callee3;\n  }());\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ContextualbarScrollableContent, null, /*#__PURE__*/React.createElement(Box, {\n    w: \"full\",\n    alignSelf: \"center\",\n    mb: \"neg-x8\"\n  }, /*#__PURE__*/React.createElement(Margins, {\n    block: 8\n  }, /*#__PURE__*/React.createElement(FormProvider, methods, /*#__PURE__*/React.createElement(RoleForm, {\n    editing: Boolean(role === null || role === void 0 ? void 0 : role._id),\n    isProtected: role === null || role === void 0 ? void 0 : role.protected,\n    isDisabled: !isEnterprise\n  }))))), /*#__PURE__*/React.createElement(ContextualbarFooter, null, /*#__PURE__*/React.createElement(ButtonGroup, {\n    vertical: true,\n    stretch: true\n  }, /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    disabled: !methods.formState.isDirty || !isEnterprise,\n    onClick: methods.handleSubmit(handleSave)\n  }, t('Save')), !(role !== null && role !== void 0 && role.protected) && (role === null || role === void 0 ? void 0 : role._id) && /*#__PURE__*/React.createElement(Button, {\n    secondary: true,\n    danger: true,\n    onClick: handleDelete\n  }, t('Delete')), (role === null || role === void 0 ? void 0 : role._id) && /*#__PURE__*/React.createElement(Button, {\n    onClick: handleManageUsers\n  }, t('Users_in_role')))));\n};\nmodule.exportDefault(EditRolePage);","map":{"version":3,"names":["_regeneratorRuntime","module","link","default","v","Box","ButtonGroup","Button","Margins","useMutableCallback","useSetModal","useToastMessageDispatch","useRoute","useEndpoint","useTranslation","React","FormProvider","useForm","ContextualbarFooter","ContextualbarScrollableContent","GenericModal","RoleForm","EditRolePage","_ref","role","isEnterprise","t","dispatchToastMessage","setModal","usersInRoleRouter","router","createRole","updateRole","deleteRole","methods","defaultValues","roleId","_id","name","description","scope","mandatory2fa","handleManageUsers","push","context","handleSave","_callee","data","async","_callee$","_context","prev","next","awrap","type","message","abrupt","t0","stop","Promise","handleDelete","_callee3","deleteRoleAction","deleteRoleMessage","_callee3$","_context3","_callee2","_callee2$","_context2","createElement","variant","onConfirm","onClose","onCancel","confirmText","Fragment","w","alignSelf","mb","block","editing","Boolean","isProtected","protected","isDisabled","vertical","stretch","primary","disabled","formState","isDirty","onClick","handleSubmit","secondary","danger","exportDefault"],"sources":["client/views/admin/permissions/EditRolePage.tsx"],"sourcesContent":["import type { IRole } from '@rocket.chat/core-typings';\nimport { Box, ButtonGroup, Button, Margins } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useToastMessageDispatch, useRoute, useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React from 'react';\nimport { FormProvider, useForm } from 'react-hook-form';\n\nimport { ContextualbarFooter, ContextualbarScrollableContent } from '../../../components/Contextualbar';\nimport GenericModal from '../../../components/GenericModal';\nimport RoleForm from './RoleForm';\n\nconst EditRolePage = ({ role, isEnterprise }: { role?: IRole; isEnterprise: boolean }): ReactElement => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setModal = useSetModal();\n\tconst usersInRoleRouter = useRoute('admin-permissions');\n\tconst router = useRoute('admin-permissions');\n\n\tconst createRole = useEndpoint('POST', '/v1/roles.create');\n\tconst updateRole = useEndpoint('POST', '/v1/roles.update');\n\tconst deleteRole = useEndpoint('POST', '/v1/roles.delete');\n\n\tconst methods = useForm({\n\t\tdefaultValues: {\n\t\t\troleId: role?._id,\n\t\t\tname: role?.name,\n\t\t\tdescription: role?.description,\n\t\t\tscope: role?.scope || 'Users',\n\t\t\tmandatory2fa: !!role?.mandatory2fa,\n\t\t},\n\t});\n\n\tconst handleManageUsers = useMutableCallback(() => {\n\t\tif (role?._id) {\n\t\t\tusersInRoleRouter.push({\n\t\t\t\tcontext: 'users-in-role',\n\t\t\t\t_id: role._id,\n\t\t\t});\n\t\t}\n\t});\n\n\tconst handleSave = useMutableCallback(async (data) => {\n\t\ttry {\n\t\t\tif (data.roleId) {\n\t\t\t\tawait updateRole(data);\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\t\treturn router.push({});\n\t\t\t}\n\n\t\t\tawait createRole(data);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleDelete = useMutableCallback(async () => {\n\t\tif (!role?._id) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst deleteRoleAction = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tawait deleteRole({ roleId: role._id });\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Role_removed') });\n\t\t\t\tsetModal();\n\n\t\t\t\trouter.push({});\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\tsetModal();\n\t\t\t}\n\t\t};\n\n\t\tconst deleteRoleMessage = isEnterprise ? t('Delete_Role_Warning') : t('Delete_Role_Warning_Not_Enterprise');\n\n\t\tsetModal(\n\t\t\t<GenericModal\n\t\t\t\tvariant='danger'\n\t\t\t\tonConfirm={deleteRoleAction}\n\t\t\t\tonClose={(): void => setModal()}\n\t\t\t\tonCancel={(): void => setModal()}\n\t\t\t\tconfirmText={t('Delete')}\n\t\t\t>\n\t\t\t\t{deleteRoleMessage}\n\t\t\t</GenericModal>,\n\t\t);\n\t});\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarScrollableContent>\n\t\t\t\t<Box w='full' alignSelf='center' mb='neg-x8'>\n\t\t\t\t\t<Margins block={8}>\n\t\t\t\t\t\t<FormProvider {...methods}>\n\t\t\t\t\t\t\t<RoleForm editing={Boolean(role?._id)} isProtected={role?.protected} isDisabled={!isEnterprise} />\n\t\t\t\t\t\t</FormProvider>\n\t\t\t\t\t</Margins>\n\t\t\t\t</Box>\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup vertical stretch>\n\t\t\t\t\t<Button primary disabled={!methods.formState.isDirty || !isEnterprise} onClick={methods.handleSubmit(handleSave)}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t{!role?.protected && role?._id && (\n\t\t\t\t\t\t<Button secondary danger onClick={handleDelete}>\n\t\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t{role?._id && <Button onClick={handleManageUsers}>{t('Users_in_role')}</Button>}\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</>\n\t);\n};\n\nexport default EditRolePage;\n"],"mappings":"AACA,IAAAA,mBAAc;AAAAC,MAAa,CAAAC,IAAQ,6BAAe;EAAAC,OAAuB,EAAC,SAAAA,CAAAC,CAAA;IAAAJ,mBAAA,GAAAI,CAAA;EAAA;AAAA;AAA1E,IAAAC,GAAO,EAAAC,WAAO,EAAAC,MAAW,EAAEC,OAAM;AAAEP,MAAA,CAAOC,IAAE,wBAAM;EAAAG,GAAwB,WAAAA,CAAAD,CAAA;IAAAC,GAAA,GAAAD,CAAA;EAAA;EAAAE,WAAA,WAAAA,CAAAF,CAAA;IAAAE,WAAA,GAAAF,CAAA;EAAA;EAAAG,MAAA,WAAAA,CAAAH,CAAA;IAAAG,MAAA,GAAAH,CAAA;EAAA;EAAAI,OAAA,WAAAA,CAAAJ,CAAA;IAAAI,OAAA,GAAAJ,CAAA;EAAA;AAAA;AAAA,IAAAK,kBAAA;AAAAR,MAAA,CAAAC,IAAA;EAAAO,kBAAA,WAAAA,CAAAL,CAAA;IAAAK,kBAAA,GAAAL,CAAA;EAAA;AAAA;AAAA,IAAAM,WAAA,EAAAC,uBAAA,EAAAC,QAAA,EAAAC,WAAA,EAAAC,cAAA;AAAAb,MAAA,CAAAC,IAAA;EAAAQ,WAAA,WAAAA,CAAAN,CAAA;IAAAM,WAAA,GAAAN,CAAA;EAAA;EAAAO,uBAAA,WAAAA,CAAAP,CAAA;IAAAO,uBAAA,GAAAP,CAAA;EAAA;EAAAQ,QAAA,WAAAA,CAAAR,CAAA;IAAAQ,QAAA,GAAAR,CAAA;EAAA;EAAAS,WAAA,WAAAA,CAAAT,CAAA;IAAAS,WAAA,GAAAT,CAAA;EAAA;EAAAU,cAAA,WAAAA,CAAAV,CAAA;IAAAU,cAAA,GAAAV,CAAA;EAAA;AAAA;AAAA,IAAAW,KAAA;AAAAd,MAAA,CAAAC,IAAA;EAAA,oBAAAC,CAAAC,CAAA;IAAAW,KAAA,GAAAX,CAAA;EAAA;AAAA;AAAA,IAAAY,YAAA,EAAAC,OAAA;AAAAhB,MAAA,CAAAC,IAAA;EAAAc,YAAA,WAAAA,CAAAZ,CAAA;IAAAY,YAAA,GAAAZ,CAAA;EAAA;EAAAa,OAAA,WAAAA,CAAAb,CAAA;IAAAa,OAAA,GAAAb,CAAA;EAAA;AAAA;AAAA,IAAAc,mBAAA,EAAAC,8BAAA;AAAAlB,MAAA,CAAAC,IAAA;EAAAgB,mBAAA,WAAAA,CAAAd,CAAA;IAAAc,mBAAA,GAAAd,CAAA;EAAA;EAAAe,8BAAA,WAAAA,CAAAf,CAAA;IAAAe,8BAAA,GAAAf,CAAA;EAAA;AAAA;AAAA,IAAAgB,YAAA;AAAAnB,MAAA,CAAAC,IAAA;EAAA,oBAAAC,CAAAC,CAAA;IAAAgB,YAAA,GAAAhB,CAAA;EAAA;AAAA;AAAA,IAAAiB,QAAA;AAAApB,MAAA,CAAAC,IAAA;EAAA,oBAAAC,CAAAC,CAAA;IAAAiB,QAAA,GAAAjB,CAAA;EAAA;AAAA;AAW1E,IAAMkB,YAAY,GAAG,SAAAA,CAAAC,IAAA,EAAkF;EAAA,IAA/EC,IAAI,GAAAD,IAAA,CAAJC,IAAI;IAAEC,YAAY,GAAAF,IAAA,CAAZE,YAAY;EACzC,IAAMC,CAAC,GAAGZ,cAAc,EAAE;EAC1B,IAAMa,oBAAoB,GAAGhB,uBAAuB,EAAE;EACtD,IAAMiB,QAAQ,GAAGlB,WAAW,EAAE;EAC9B,IAAMmB,iBAAiB,GAAGjB,QAAQ,CAAC,mBAAmB,CAAC;EACvD,IAAMkB,MAAM,GAAGlB,QAAQ,CAAC,mBAAmB,CAAC;EAE5C,IAAMmB,UAAU,GAAGlB,WAAW,CAAC,MAAM,EAAE,kBAAkB,CAAC;EAC1D,IAAMmB,UAAU,GAAGnB,WAAW,CAAC,MAAM,EAAE,kBAAkB,CAAC;EAC1D,IAAMoB,UAAU,GAAGpB,WAAW,CAAC,MAAM,EAAE,kBAAkB,CAAC;EAE1D,IAAMqB,OAAO,GAAGjB,OAAO,CAAC;IACvBkB,aAAa,EAAE;MACdC,MAAM,EAAEZ,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEa,GAAG;MACjBC,IAAI,EAAEd,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEc,IAAI;MAChBC,WAAW,EAAEf,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEe,WAAW;MAC9BC,KAAK,EAAE,CAAAhB,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEgB,KAAK,KAAI,OAAO;MAC7BC,YAAY,EAAE,CAAC,EAACjB,IAAI,aAAJA,IAAI,eAAJA,IAAI,CAAEiB,YAAY;;GAEnC,CAAC;EAEF,IAAMC,iBAAiB,GAAGjC,kBAAkB,CAAC,YAAK;IACjD,IAAIe,IAAI,aAAJA,IAAI,eAAJA,IAAI,CAAEa,GAAG,EAAE;MACdR,iBAAiB,CAACc,IAAI,CAAC;QACtBC,OAAO,EAAE,eAAe;QACxBP,GAAG,EAAEb,IAAI,CAACa;OACV,CAAC;IACH;EACD,CAAC,CAAC;EAEF,IAAMQ,UAAU,GAAGpC,kBAAkB;IAAC,SAAAqC,QAAOC,IAAI;MAAA,OAAA/C,mBAAA,CAAAgD,KAAA;QAAA,SAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAA,KAE3CJ,IAAI,CAACX,MAAM;gBAAAc,QAAA,CAAAE,IAAA;gBAAA;cAAA;cAAAF,QAAA,CAAAE,IAAA;cAAA,OAAApD,mBAAA,CAAAqD,KAAA,CACRrB,UAAU,CAACe,IAAI,CAAC;YAAA;cACtBpB,oBAAoB,CAAC;gBAAE2B,IAAI,EAAE,SAAS;gBAAEC,OAAO,EAAE7B,CAAC,CAAC,OAAO;cAAC,CAAE,CAAC;cAAC,OAAAwB,QAAA,CAAAM,MAAA,WACxD1B,MAAM,CAACa,IAAI,CAAC,EAAE,CAAC;YAAA;cAAAO,QAAA,CAAAE,IAAA;cAAA,OAAApD,mBAAA,CAAAqD,KAAA,CAGjBtB,UAAU,CAACgB,IAAI,CAAC;YAAA;cACtBpB,oBAAoB,CAAC;gBAAE2B,IAAI,EAAE,SAAS;gBAAEC,OAAO,EAAE7B,CAAC,CAAC,OAAO;cAAC,CAAE,CAAC;cAC9DI,MAAM,CAACa,IAAI,CAAC,EAAE,CAAC;cAACO,QAAA,CAAAE,IAAA;cAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAO,EAAA,GAAAP,QAAA;cAEhBvB,oBAAoB,CAAC;gBAAE2B,IAAI,EAAE,OAAO;gBAAEC,OAAO,EAAAL,QAAA,CAAAO;cAAO,CAAE,CAAC;YAAC;YAAA;cAAA,OAAAP,QAAA,CAAAQ,IAAA;UAAA;QAAA;QAAA,OAAAT,QAAA;MAAA,4BAAAU,OAAA;IAAA;IAEzD,OAAAb,OAAA;EAAA,IAAC;EAEF,IAAMc,YAAY,GAAGnD,kBAAkB;IAAC,SAAAoD,SAAA;MAAA,IAAAC,gBAAA,EAAAC,iBAAA;MAAA,OAAA/D,mBAAA,CAAAgD,KAAA;QAAA,SAAAgB,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAAd,IAAA,GAAAc,SAAA,CAAAb,IAAA;YAAA;cAAA,IAClC5B,IAAI,aAAJA,IAAI,eAAJA,IAAI,CAAEa,GAAG;gBAAA4B,SAAA,CAAAb,IAAA;gBAAA;cAAA;cAAA,OAAAa,SAAA,CAAAT,MAAA;YAAA;cAIRM,gBAAgB;gBAAG,SAAAI,SAAA;kBAAA,OAAAlE,mBAAA,CAAAgD,KAAA;oBAAA,SAAAmB,UAAAC,SAAA;sBAAA,kBAAAA,SAAA,CAAAjB,IAAA,GAAAiB,SAAA,CAAAhB,IAAA;wBAAA;0BAAAgB,SAAA,CAAAjB,IAAA;0BAAAiB,SAAA,CAAAhB,IAAA;0BAAA,OAAApD,mBAAA,CAAAqD,KAAA,CAEjBpB,UAAU,CAAC;4BAAEG,MAAM,EAAEZ,IAAI,CAACa;0BAAG,CAAE,CAAC;wBAAA;0BACtCV,oBAAoB,CAAC;4BAAE2B,IAAI,EAAE,SAAS;4BAAEC,OAAO,EAAE7B,CAAC,CAAC,cAAc;0BAAC,CAAE,CAAC;0BACrEE,QAAQ,EAAE;0BAEVE,MAAM,CAACa,IAAI,CAAC,EAAE,CAAC;0BAACyB,SAAA,CAAAhB,IAAA;0BAAA;wBAAA;0BAAAgB,SAAA,CAAAjB,IAAA;0BAAAiB,SAAA,CAAAX,EAAA,GAAAW,SAAA;0BAEhBzC,oBAAoB,CAAC;4BAAE2B,IAAI,EAAE,OAAO;4BAAEC,OAAO,EAAAa,SAAA,CAAAX;0BAAO,CAAE,CAAC;0BACvD7B,QAAQ,EAAE;wBAAC;wBAAA;0BAAA,OAAAwC,SAAA,CAAAV,IAAA;sBAAA;oBAAA;oBAAA,OAAAS,SAAA;kBAAA,2BAAAR,OAAA;gBAAA;gBAEZ,OAAAO,QAAA;cAAA;cAEKH,iBAAiB,GAAGtC,YAAY,GAAGC,CAAC,CAAC,qBAAqB,CAAC,GAAGA,CAAC,CAAC,oCAAoC,CAAC;cAE3GE,QAAQ,eACPb,KAAA,CAAAsD,aAAA,CAACjD,YAAY;gBACZkD,OAAO,EAAC,QAAQ;gBAChBC,SAAS,EAAET,gBAAiB;gBAC5BU,OAAO,EAAE,SAAAA,CAAA;kBAAA,OAAY5C,QAAQ,EAAE;gBAAA,CAAC;gBAChC6C,QAAQ,EAAE,SAAAA,CAAA;kBAAA,OAAY7C,QAAQ,EAAE;gBAAA,CAAC;gBACjC8C,WAAW,EAAEhD,CAAC,CAAC,QAAQ;cAAE,GAExBqC,iBACY,CAAC,CACf;YAAC;YAAA;cAAA,OAAAE,SAAA,CAAAP,IAAA;UAAA;QAAA;QAAA,OAAAM,SAAA;MAAA,uBAAAL,OAAA;IAAA;IACF,OAAAE,QAAA;EAAA,IAAC;EAEF,oBACC9C,KAAA,CAAAsD,aAAA,CAAAtD,KAAA,CAAA4D,QAAA,qBACC5D,KAAA,CAAAsD,aAAA,CAAClD,8BAA8B,qBAC9BJ,KAAA,CAAAsD,aAAA,CAAChE,GAAG;IAACuE,CAAC,EAAC,MAAM;IAACC,SAAS,EAAC,QAAQ;IAACC,EAAE,EAAC;EAAQ,gBAC3C/D,KAAA,CAAAsD,aAAA,CAAC7D,OAAO;IAACuE,KAAK,EAAE;EAAE,gBACjBhE,KAAA,CAAAsD,aAAA,CAACrD,YAAY,EAAKkB,OAAO,eACxBnB,KAAA,CAAAsD,aAAA,CAAChD,QAAQ;IAAC2D,OAAO,EAAEC,OAAO,CAACzD,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEa,GAAG,CAAE;IAAC6C,WAAW,EAAE1D,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAE2D,SAAU;IAACC,UAAU,EAAE,CAAC3D;EAAa,EAClF,CACN,CACL,CAC0B,CAChC,eAAAV,KAAA,CAAAsD,aAAA,CAACnD,mBAAmB,qBACnBH,KAAA,CAAAsD,aAAA,CAAC/D,WAAW;IAAC+E,QAAQ;IAACC,OAAO;EAAA,gBAC5BvE,KAAA,CAAAsD,aAAA,CAAC9D,MAAM;IAACgF,OAAO;IAACC,QAAQ,EAAE,CAACtD,OAAO,CAACuD,SAAS,CAACC,OAAO,IAAI,CAACjE,YAAa;IAACkE,OAAO,EAAEzD,OAAO,CAAC0D,YAAY,CAAC/C,UAAU;EAAE,GAC/GnB,CAAC,CAAC,MAAM,CACF,CACR,EAAC,EAACF,IAAI,aAAJA,IAAI,eAAJA,IAAI,CAAE2D,SAAS,MAAI3D,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEa,GAAG,kBAC7BtB,KAAA,CAAAsD,aAAA,CAAC9D,MAAM;IAACsF,SAAS;IAACC,MAAM;IAACH,OAAO,EAAE/B;EAAa,GAC7ClC,CAAC,CAAC,QAAQ,CACJ,CACR,EACA,CAAAF,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEa,GAAG,kBAAItB,KAAA,CAAAsD,aAAA,CAAC9D,MAAM;IAACoF,OAAO,EAAEjD;EAAkB,GAAEhB,CAAC,CAAC,eAAe,CAAU,CAClE,CACO,CACtB,CAAG;AAEL,CAAC;AApHDzB,MAAA,CAAO8F,aAAO,CAsHCzE,YAtHD,CAAW","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"be81f4360b325ffd26c973fefd6d481340b9c947"}
