{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/hooks/useAppActionButtons.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/hooks/useAppActionButtons.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/hooks/useAppActionButtons.ts","inputSourceMap":{"version":3,"file":"client/hooks/useAppActionButtons.ts","sourceRoot":"","sources":["client/hooks/useAppActionButtons.ts"],"names":[],"mappings":"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","sourcesContent":["import { type IUIActionButton, type UIActionButtonContext } from '@rocket.chat/apps-engine/definition/ui';\nimport { useDebouncedCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useEndpoint, useStream, useToastMessageDispatch, useUserId } from '@rocket.chat/ui-contexts';\nimport type { UseQueryResult } from '@tanstack/react-query';\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\nimport { useEffect, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { UiKitTriggerTimeoutError } from '../../app/ui-message/client/UiKitTriggerTimeoutError';\nimport type { MessageActionConfig, MessageActionContext } from '../../app/ui-utils/client/lib/MessageAction';\nimport type { MessageBoxAction } from '../../app/ui-utils/client/lib/messageBox';\nimport { Utilities } from '../../ee/lib/misc/Utilities';\nimport { useUiKitActionManager } from '../uikit/hooks/useUiKitActionManager';\nimport { useApplyButtonFilters, useApplyButtonAuthFilter } from './useApplyButtonFilters';\nimport { useFilterActionsByContext } from './useFilterActions';\n\nconst getIdForActionButton = ({ appId, actionId }: IUIActionButton): string => `${appId}/${actionId}`;\n\nexport const useAppActionButtons = <TContext extends `${UIActionButtonContext}`>(context?: TContext) => {\n\tconst queryClient = useQueryClient();\n\n\tconst apps = useStream('apps');\n\tconst uid = useUserId();\n\n\tconst getActionButtons = useEndpoint('GET', '/apps/actionButtons');\n\n\tconst result = useQuery(['apps', 'actionButtons'], () => getActionButtons(), {\n\t\t...(context && {\n\t\t\tselect: (data) =>\n\t\t\t\tdata.filter(\n\t\t\t\t\t(\n\t\t\t\t\t\tbutton,\n\t\t\t\t\t): button is IUIActionButton & {\n\t\t\t\t\t\tcontext: UIActionButtonContext extends infer X ? (X extends TContext ? X : never) : never;\n\t\t\t\t\t} => button.context === context,\n\t\t\t\t),\n\t\t}),\n\t\tstaleTime: Infinity,\n\t});\n\n\tconst invalidate = useDebouncedCallback(\n\t\t() => {\n\t\t\tqueryClient.invalidateQueries(['apps', 'actionButtons']);\n\t\t},\n\t\t100,\n\t\t[],\n\t);\n\n\tuseEffect(() => {\n\t\tif (!uid) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn apps('apps', ([key]) => {\n\t\t\tif (['actions/changed'].includes(key)) {\n\t\t\t\tinvalidate();\n\t\t\t}\n\t\t});\n\t}, [uid, apps, invalidate]);\n\n\treturn result;\n};\n\nexport const useMessageboxAppsActionButtons = () => {\n\tconst result = useAppActionButtons('messageBoxAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\n\tconst applyButtonFilters = useApplyButtonFilters();\n\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\tconst item: Omit<MessageBoxAction, 'icon'> = {\n\t\t\t\t\t\tid: getIdForActionButton(action),\n\t\t\t\t\t\tlabel: Utilities.getI18nKeyForApp(action.labelI18n, action.appId),\n\t\t\t\t\t\taction: (params) => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\trid: params.rid,\n\t\t\t\t\t\t\t\t\ttmid: params.tmid,\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context, message: params.chat.composer?.text ?? '' },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\treturn item;\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<MessageBoxAction[]>;\n};\n\nexport const useUserDropdownAppsActionButtons = () => {\n\tconst result = useAppActionButtons('userDropdownAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\n\tconst applyButtonFilters = useApplyButtonAuthFilter();\n\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: `${action.appId}_${action.actionId}`,\n\t\t\t\t\t\t// icon: action.icon as GenericMenuItemProps['icon'],\n\t\t\t\t\t\tcontent: action.labelI18n,\n\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<GenericMenuItemProps[]>;\n};\n\nexport const useMessageActionAppsActionButtons = (context?: MessageActionContext, category?: string) => {\n\tconst result = useAppActionButtons('messageAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst applyButtonFilters = useApplyButtonFilters(category);\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\tconst filterActionsByContext = useFilterActionsByContext(context);\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\tif (!filterActionsByContext(action)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\tconst item: MessageActionConfig = {\n\t\t\t\t\t\ticon: undefined as any,\n\t\t\t\t\t\tid: getIdForActionButton(action),\n\t\t\t\t\t\tlabel: Utilities.getI18nKeyForApp(action.labelI18n, action.appId),\n\t\t\t\t\t\torder: 7,\n\t\t\t\t\t\ttype: 'apps',\n\t\t\t\t\t\tvariant: action.variant,\n\t\t\t\t\t\taction: (_, params) => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\trid: params.message.rid,\n\t\t\t\t\t\t\t\t\ttmid: params.message.tmid,\n\t\t\t\t\t\t\t\t\tmid: params.message._id,\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\treturn item;\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, filterActionsByContext, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<MessageActionConfig[]>;\n};\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/hooks/useAppActionButtons.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/hooks/useAppActionButtons.ts","inputSourceMap":{"version":3,"file":"client/hooks/useAppActionButtons.ts","sourceRoot":"","sources":["client/hooks/useAppActionButtons.ts"],"names":[],"mappings":"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","sourcesContent":["import { type IUIActionButton, type UIActionButtonContext } from '@rocket.chat/apps-engine/definition/ui';\nimport { useDebouncedCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useEndpoint, useStream, useToastMessageDispatch, useUserId } from '@rocket.chat/ui-contexts';\nimport type { UseQueryResult } from '@tanstack/react-query';\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\nimport { useEffect, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { UiKitTriggerTimeoutError } from '../../app/ui-message/client/UiKitTriggerTimeoutError';\nimport type { MessageActionConfig, MessageActionContext } from '../../app/ui-utils/client/lib/MessageAction';\nimport type { MessageBoxAction } from '../../app/ui-utils/client/lib/messageBox';\nimport { Utilities } from '../../ee/lib/misc/Utilities';\nimport { useUiKitActionManager } from '../uikit/hooks/useUiKitActionManager';\nimport { useApplyButtonFilters, useApplyButtonAuthFilter } from './useApplyButtonFilters';\nimport { useFilterActionsByContext } from './useFilterActions';\n\nconst getIdForActionButton = ({ appId, actionId }: IUIActionButton): string => `${appId}/${actionId}`;\n\nexport const useAppActionButtons = <TContext extends `${UIActionButtonContext}`>(context?: TContext) => {\n\tconst queryClient = useQueryClient();\n\n\tconst apps = useStream('apps');\n\tconst uid = useUserId();\n\n\tconst getActionButtons = useEndpoint('GET', '/apps/actionButtons');\n\n\tconst result = useQuery(['apps', 'actionButtons'], () => getActionButtons(), {\n\t\t...(context && {\n\t\t\tselect: (data) =>\n\t\t\t\tdata.filter(\n\t\t\t\t\t(\n\t\t\t\t\t\tbutton,\n\t\t\t\t\t): button is IUIActionButton & {\n\t\t\t\t\t\tcontext: UIActionButtonContext extends infer X ? (X extends TContext ? X : never) : never;\n\t\t\t\t\t} => button.context === context,\n\t\t\t\t),\n\t\t}),\n\t\tstaleTime: Infinity,\n\t});\n\n\tconst invalidate = useDebouncedCallback(\n\t\t() => {\n\t\t\tqueryClient.invalidateQueries(['apps', 'actionButtons']);\n\t\t},\n\t\t100,\n\t\t[],\n\t);\n\n\tuseEffect(() => {\n\t\tif (!uid) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn apps('apps', ([key]) => {\n\t\t\tif (['actions/changed'].includes(key)) {\n\t\t\t\tinvalidate();\n\t\t\t}\n\t\t});\n\t}, [uid, apps, invalidate]);\n\n\treturn result;\n};\n\nexport const useMessageboxAppsActionButtons = () => {\n\tconst result = useAppActionButtons('messageBoxAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\n\tconst applyButtonFilters = useApplyButtonFilters();\n\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\tconst item: Omit<MessageBoxAction, 'icon'> = {\n\t\t\t\t\t\tid: getIdForActionButton(action),\n\t\t\t\t\t\tlabel: Utilities.getI18nKeyForApp(action.labelI18n, action.appId),\n\t\t\t\t\t\taction: (params) => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\trid: params.rid,\n\t\t\t\t\t\t\t\t\ttmid: params.tmid,\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context, message: params.chat.composer?.text ?? '' },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\treturn item;\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<MessageBoxAction[]>;\n};\n\nexport const useUserDropdownAppsActionButtons = () => {\n\tconst result = useAppActionButtons('userDropdownAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\n\tconst applyButtonFilters = useApplyButtonAuthFilter();\n\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: `${action.appId}_${action.actionId}`,\n\t\t\t\t\t\t// icon: action.icon as GenericMenuItemProps['icon'],\n\t\t\t\t\t\tcontent: action.labelI18n,\n\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<GenericMenuItemProps[]>;\n};\n\nexport const useMessageActionAppsActionButtons = (context?: MessageActionContext, category?: string) => {\n\tconst result = useAppActionButtons('messageAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst applyButtonFilters = useApplyButtonFilters(category);\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\tconst filterActionsByContext = useFilterActionsByContext(context);\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\tif (!filterActionsByContext(action)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\tconst item: MessageActionConfig = {\n\t\t\t\t\t\ticon: undefined as any,\n\t\t\t\t\t\tid: getIdForActionButton(action),\n\t\t\t\t\t\tlabel: Utilities.getI18nKeyForApp(action.labelI18n, action.appId),\n\t\t\t\t\t\torder: 7,\n\t\t\t\t\t\ttype: 'apps',\n\t\t\t\t\t\tvariant: action.variant,\n\t\t\t\t\t\taction: (_, params) => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\trid: params.message.rid,\n\t\t\t\t\t\t\t\t\ttmid: params.message.tmid,\n\t\t\t\t\t\t\t\t\tmid: params.message._id,\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\treturn item;\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, filterActionsByContext, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<MessageActionConfig[]>;\n};\n"]}}},"code":"let _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n}, 0);\nmodule.export({\n  useAppActionButtons: () => useAppActionButtons,\n  useMessageboxAppsActionButtons: () => useMessageboxAppsActionButtons,\n  useUserDropdownAppsActionButtons: () => useUserDropdownAppsActionButtons,\n  useMessageActionAppsActionButtons: () => useMessageActionAppsActionButtons\n});\nlet useDebouncedCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useDebouncedCallback(v) {\n    useDebouncedCallback = v;\n  }\n}, 0);\nlet useEndpoint, useStream, useToastMessageDispatch, useUserId;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useEndpoint(v) {\n    useEndpoint = v;\n  },\n  useStream(v) {\n    useStream = v;\n  },\n  useToastMessageDispatch(v) {\n    useToastMessageDispatch = v;\n  },\n  useUserId(v) {\n    useUserId = v;\n  }\n}, 1);\nlet useQuery, useQueryClient;\nmodule.link(\"@tanstack/react-query\", {\n  useQuery(v) {\n    useQuery = v;\n  },\n  useQueryClient(v) {\n    useQueryClient = v;\n  }\n}, 2);\nlet useEffect, useMemo;\nmodule.link(\"react\", {\n  useEffect(v) {\n    useEffect = v;\n  },\n  useMemo(v) {\n    useMemo = v;\n  }\n}, 3);\nlet useTranslation;\nmodule.link(\"react-i18next\", {\n  useTranslation(v) {\n    useTranslation = v;\n  }\n}, 4);\nlet UiKitTriggerTimeoutError;\nmodule.link(\"../../app/ui-message/client/UiKitTriggerTimeoutError\", {\n  UiKitTriggerTimeoutError(v) {\n    UiKitTriggerTimeoutError = v;\n  }\n}, 5);\nlet Utilities;\nmodule.link(\"../../ee/lib/misc/Utilities\", {\n  Utilities(v) {\n    Utilities = v;\n  }\n}, 6);\nlet useUiKitActionManager;\nmodule.link(\"../uikit/hooks/useUiKitActionManager\", {\n  useUiKitActionManager(v) {\n    useUiKitActionManager = v;\n  }\n}, 7);\nlet useApplyButtonFilters, useApplyButtonAuthFilter;\nmodule.link(\"./useApplyButtonFilters\", {\n  useApplyButtonFilters(v) {\n    useApplyButtonFilters = v;\n  },\n  useApplyButtonAuthFilter(v) {\n    useApplyButtonAuthFilter = v;\n  }\n}, 8);\nlet useFilterActionsByContext;\nmodule.link(\"./useFilterActions\", {\n  useFilterActionsByContext(v) {\n    useFilterActionsByContext = v;\n  }\n}, 9);\nconst getIdForActionButton = _ref => {\n  let {\n    appId,\n    actionId\n  } = _ref;\n  return \"\".concat(appId, \"/\").concat(actionId);\n};\nconst useAppActionButtons = context => {\n  const queryClient = useQueryClient();\n  const apps = useStream('apps');\n  const uid = useUserId();\n  const getActionButtons = useEndpoint('GET', '/apps/actionButtons');\n  const result = useQuery(['apps', 'actionButtons'], () => getActionButtons(), _objectSpread(_objectSpread({}, context && {\n    select: data => data.filter(button => button.context === context)\n  }), {}, {\n    staleTime: Infinity\n  }));\n  const invalidate = useDebouncedCallback(() => {\n    queryClient.invalidateQueries(['apps', 'actionButtons']);\n  }, 100, []);\n  useEffect(() => {\n    if (!uid) {\n      return;\n    }\n    return apps('apps', _ref2 => {\n      let [key] = _ref2;\n      if (['actions/changed'].includes(key)) {\n        invalidate();\n      }\n    });\n  }, [uid, apps, invalidate]);\n  return result;\n};\nconst useMessageboxAppsActionButtons = () => {\n  const result = useAppActionButtons('messageBoxAction');\n  const actionManager = useUiKitActionManager();\n  const dispatchToastMessage = useToastMessageDispatch();\n  const {\n    t\n  } = useTranslation();\n  const applyButtonFilters = useApplyButtonFilters();\n  const data = useMemo(() => {\n    var _result$data;\n    return (_result$data = result.data) === null || _result$data === void 0 ? void 0 : _result$data.filter(action => {\n      return applyButtonFilters(action);\n    }).map(action => {\n      const item = {\n        id: getIdForActionButton(action),\n        label: Utilities.getI18nKeyForApp(action.labelI18n, action.appId),\n        action: params => {\n          var _params$chat$composer, _params$chat$composer2;\n          void actionManager.emitInteraction(action.appId, {\n            type: 'actionButton',\n            rid: params.rid,\n            tmid: params.tmid,\n            actionId: action.actionId,\n            payload: {\n              context: action.context,\n              message: (_params$chat$composer = (_params$chat$composer2 = params.chat.composer) === null || _params$chat$composer2 === void 0 ? void 0 : _params$chat$composer2.text) !== null && _params$chat$composer !== void 0 ? _params$chat$composer : ''\n            }\n          }).catch(async reason => {\n            if (reason instanceof UiKitTriggerTimeoutError) {\n              dispatchToastMessage({\n                type: 'error',\n                message: t('UIKit_Interaction_Timeout')\n              });\n              return;\n            }\n            return reason;\n          });\n        }\n      };\n      return item;\n    });\n  }, [actionManager, applyButtonFilters, dispatchToastMessage, result.data, t]);\n  return _objectSpread(_objectSpread({}, result), {}, {\n    data\n  });\n};\nconst useUserDropdownAppsActionButtons = () => {\n  const result = useAppActionButtons('userDropdownAction');\n  const actionManager = useUiKitActionManager();\n  const dispatchToastMessage = useToastMessageDispatch();\n  const {\n    t\n  } = useTranslation();\n  const applyButtonFilters = useApplyButtonAuthFilter();\n  const data = useMemo(() => {\n    var _result$data2;\n    return (_result$data2 = result.data) === null || _result$data2 === void 0 ? void 0 : _result$data2.filter(action => {\n      return applyButtonFilters(action);\n    }).map(action => {\n      return {\n        id: \"\".concat(action.appId, \"_\").concat(action.actionId),\n        // icon: action.icon as GenericMenuItemProps['icon'],\n        content: action.labelI18n,\n        onClick: () => {\n          void actionManager.emitInteraction(action.appId, {\n            type: 'actionButton',\n            actionId: action.actionId,\n            payload: {\n              context: action.context\n            }\n          }).catch(async reason => {\n            if (reason instanceof UiKitTriggerTimeoutError) {\n              dispatchToastMessage({\n                type: 'error',\n                message: t('UIKit_Interaction_Timeout')\n              });\n              return;\n            }\n            return reason;\n          });\n        }\n      };\n    });\n  }, [actionManager, applyButtonFilters, dispatchToastMessage, result.data, t]);\n  return _objectSpread(_objectSpread({}, result), {}, {\n    data\n  });\n};\nconst useMessageActionAppsActionButtons = (context, category) => {\n  const result = useAppActionButtons('messageAction');\n  const actionManager = useUiKitActionManager();\n  const applyButtonFilters = useApplyButtonFilters(category);\n  const dispatchToastMessage = useToastMessageDispatch();\n  const {\n    t\n  } = useTranslation();\n  const filterActionsByContext = useFilterActionsByContext(context);\n  const data = useMemo(() => {\n    var _result$data3;\n    return (_result$data3 = result.data) === null || _result$data3 === void 0 ? void 0 : _result$data3.filter(action => {\n      if (!filterActionsByContext(action)) {\n        return false;\n      }\n      return applyButtonFilters(action);\n    }).map(action => {\n      const item = {\n        icon: undefined,\n        id: getIdForActionButton(action),\n        label: Utilities.getI18nKeyForApp(action.labelI18n, action.appId),\n        order: 7,\n        type: 'apps',\n        variant: action.variant,\n        action: (_, params) => {\n          void actionManager.emitInteraction(action.appId, {\n            type: 'actionButton',\n            rid: params.message.rid,\n            tmid: params.message.tmid,\n            mid: params.message._id,\n            actionId: action.actionId,\n            payload: {\n              context: action.context\n            }\n          }).catch(async reason => {\n            if (reason instanceof UiKitTriggerTimeoutError) {\n              dispatchToastMessage({\n                type: 'error',\n                message: t('UIKit_Interaction_Timeout')\n              });\n              return;\n            }\n            return reason;\n          });\n        }\n      };\n      return item;\n    });\n  }, [actionManager, applyButtonFilters, dispatchToastMessage, filterActionsByContext, result.data, t]);\n  return _objectSpread(_objectSpread({}, result), {}, {\n    data\n  });\n};","map":{"version":3,"names":["_objectSpread","module","link","default","v","export","useAppActionButtons","useMessageboxAppsActionButtons","useUserDropdownAppsActionButtons","useMessageActionAppsActionButtons","useDebouncedCallback","useEndpoint","useStream","useToastMessageDispatch","useUserId","useQuery","useQueryClient","useEffect","useMemo","useTranslation","UiKitTriggerTimeoutError","Utilities","useUiKitActionManager","useApplyButtonFilters","useApplyButtonAuthFilter","useFilterActionsByContext","getIdForActionButton","_ref","appId","actionId","concat","context","queryClient","apps","uid","getActionButtons","result","select","data","filter","button","staleTime","Infinity","invalidate","invalidateQueries","_ref2","key","includes","actionManager","dispatchToastMessage","t","applyButtonFilters","_result$data","action","map","item","id","label","getI18nKeyForApp","labelI18n","params","_params$chat$composer","_params$chat$composer2","emitInteraction","type","rid","tmid","payload","message","chat","composer","text","catch","reason","_result$data2","content","onClick","category","filterActionsByContext","_result$data3","icon","undefined","order","variant","_","mid","_id"],"sources":["client/hooks/useAppActionButtons.ts"],"sourcesContent":["import { type IUIActionButton, type UIActionButtonContext } from '@rocket.chat/apps-engine/definition/ui';\nimport { useDebouncedCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useEndpoint, useStream, useToastMessageDispatch, useUserId } from '@rocket.chat/ui-contexts';\nimport type { UseQueryResult } from '@tanstack/react-query';\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\nimport { useEffect, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { UiKitTriggerTimeoutError } from '../../app/ui-message/client/UiKitTriggerTimeoutError';\nimport type { MessageActionConfig, MessageActionContext } from '../../app/ui-utils/client/lib/MessageAction';\nimport type { MessageBoxAction } from '../../app/ui-utils/client/lib/messageBox';\nimport { Utilities } from '../../ee/lib/misc/Utilities';\nimport { useUiKitActionManager } from '../uikit/hooks/useUiKitActionManager';\nimport { useApplyButtonFilters, useApplyButtonAuthFilter } from './useApplyButtonFilters';\nimport { useFilterActionsByContext } from './useFilterActions';\n\nconst getIdForActionButton = ({ appId, actionId }: IUIActionButton): string => `${appId}/${actionId}`;\n\nexport const useAppActionButtons = <TContext extends `${UIActionButtonContext}`>(context?: TContext) => {\n\tconst queryClient = useQueryClient();\n\n\tconst apps = useStream('apps');\n\tconst uid = useUserId();\n\n\tconst getActionButtons = useEndpoint('GET', '/apps/actionButtons');\n\n\tconst result = useQuery(['apps', 'actionButtons'], () => getActionButtons(), {\n\t\t...(context && {\n\t\t\tselect: (data) =>\n\t\t\t\tdata.filter(\n\t\t\t\t\t(\n\t\t\t\t\t\tbutton,\n\t\t\t\t\t): button is IUIActionButton & {\n\t\t\t\t\t\tcontext: UIActionButtonContext extends infer X ? (X extends TContext ? X : never) : never;\n\t\t\t\t\t} => button.context === context,\n\t\t\t\t),\n\t\t}),\n\t\tstaleTime: Infinity,\n\t});\n\n\tconst invalidate = useDebouncedCallback(\n\t\t() => {\n\t\t\tqueryClient.invalidateQueries(['apps', 'actionButtons']);\n\t\t},\n\t\t100,\n\t\t[],\n\t);\n\n\tuseEffect(() => {\n\t\tif (!uid) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn apps('apps', ([key]) => {\n\t\t\tif (['actions/changed'].includes(key)) {\n\t\t\t\tinvalidate();\n\t\t\t}\n\t\t});\n\t}, [uid, apps, invalidate]);\n\n\treturn result;\n};\n\nexport const useMessageboxAppsActionButtons = () => {\n\tconst result = useAppActionButtons('messageBoxAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\n\tconst applyButtonFilters = useApplyButtonFilters();\n\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\tconst item: Omit<MessageBoxAction, 'icon'> = {\n\t\t\t\t\t\tid: getIdForActionButton(action),\n\t\t\t\t\t\tlabel: Utilities.getI18nKeyForApp(action.labelI18n, action.appId),\n\t\t\t\t\t\taction: (params) => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\trid: params.rid,\n\t\t\t\t\t\t\t\t\ttmid: params.tmid,\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context, message: params.chat.composer?.text ?? '' },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\treturn item;\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<MessageBoxAction[]>;\n};\n\nexport const useUserDropdownAppsActionButtons = () => {\n\tconst result = useAppActionButtons('userDropdownAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\n\tconst applyButtonFilters = useApplyButtonAuthFilter();\n\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: `${action.appId}_${action.actionId}`,\n\t\t\t\t\t\t// icon: action.icon as GenericMenuItemProps['icon'],\n\t\t\t\t\t\tcontent: action.labelI18n,\n\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<GenericMenuItemProps[]>;\n};\n\nexport const useMessageActionAppsActionButtons = (context?: MessageActionContext, category?: string) => {\n\tconst result = useAppActionButtons('messageAction');\n\tconst actionManager = useUiKitActionManager();\n\tconst applyButtonFilters = useApplyButtonFilters(category);\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\tconst filterActionsByContext = useFilterActionsByContext(context);\n\tconst data = useMemo(\n\t\t() =>\n\t\t\tresult.data\n\t\t\t\t?.filter((action) => {\n\t\t\t\t\tif (!filterActionsByContext(action)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\treturn applyButtonFilters(action);\n\t\t\t\t})\n\t\t\t\t.map((action) => {\n\t\t\t\t\tconst item: MessageActionConfig = {\n\t\t\t\t\t\ticon: undefined as any,\n\t\t\t\t\t\tid: getIdForActionButton(action),\n\t\t\t\t\t\tlabel: Utilities.getI18nKeyForApp(action.labelI18n, action.appId),\n\t\t\t\t\t\torder: 7,\n\t\t\t\t\t\ttype: 'apps',\n\t\t\t\t\t\tvariant: action.variant,\n\t\t\t\t\t\taction: (_, params) => {\n\t\t\t\t\t\t\tvoid actionManager\n\t\t\t\t\t\t\t\t.emitInteraction(action.appId, {\n\t\t\t\t\t\t\t\t\ttype: 'actionButton',\n\t\t\t\t\t\t\t\t\trid: params.message.rid,\n\t\t\t\t\t\t\t\t\ttmid: params.message.tmid,\n\t\t\t\t\t\t\t\t\tmid: params.message._id,\n\t\t\t\t\t\t\t\t\tactionId: action.actionId,\n\t\t\t\t\t\t\t\t\tpayload: { context: action.context },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(async (reason) => {\n\t\t\t\t\t\t\t\t\tif (reason instanceof UiKitTriggerTimeoutError) {\n\t\t\t\t\t\t\t\t\t\tdispatchToastMessage({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: t('UIKit_Interaction_Timeout'),\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn reason;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\treturn item;\n\t\t\t\t}),\n\t\t[actionManager, applyButtonFilters, dispatchToastMessage, filterActionsByContext, result.data, t],\n\t);\n\treturn {\n\t\t...result,\n\t\tdata,\n\t} as UseQueryResult<MessageActionConfig[]>;\n};\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"892c37415a3d281aceb7d0cd2096949389f33f25"}
