{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/omnichannel/slaPolicies/SlaEdit.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/omnichannel/slaPolicies/SlaEdit.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/omnichannel/slaPolicies/SlaEdit.tsx","inputSourceMap":{"version":3,"file":"client/omnichannel/slaPolicies/SlaEdit.tsx","sourceRoot":"","sources":["client/omnichannel/slaPolicies/SlaEdit.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IOmnichannelServiceLevelAgreements, Serialized } from '@rocket.chat/core-typings';\nimport { Field, FieldLabel, FieldRow, FieldError, TextInput, Button, Margins, Box, NumberInput } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useRoute, useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React from 'react';\nimport { useController, useForm } from 'react-hook-form';\n\nimport { ContextualbarScrollableContent } from '../../components/Contextualbar';\n\ntype SlaEditProps = {\n\tisNew?: boolean;\n\tslaId?: string;\n\treload: () => void;\n\tdata?: Serialized<IOmnichannelServiceLevelAgreements>;\n};\n\nfunction SlaEdit({ data, isNew, slaId, reload, ...props }: SlaEditProps): ReactElement {\n\tconst slasRoute = useRoute('omnichannel-sla-policies');\n\tconst saveSLA = useEndpoint('POST', '/v1/livechat/sla');\n\tconst updateSLA = useEndpoint('PUT', `/v1/livechat/sla/:slaId`, { slaId: slaId || '' });\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst t = useTranslation();\n\n\tconst { name, description, dueTimeInMinutes } = data || {};\n\n\tconst {\n\t\tcontrol,\n\t\tgetValues,\n\t\tformState: { errors, isValid, isDirty },\n\t\treset,\n\t} = useForm({\n\t\tmode: 'onChange',\n\t\tdefaultValues: { name, description, dueTimeInMinutes },\n\t});\n\n\tconst { field: nameField } = useController({\n\t\tcontrol,\n\t\tname: 'name',\n\t\trules: { required: t('Required_field', { field: t('Name') }) },\n\t});\n\n\tconst { field: dueTimeField } = useController({\n\t\tcontrol,\n\t\tname: 'dueTimeInMinutes',\n\t\trules: {\n\t\t\tvalidate(value) {\n\t\t\t\treturn Number(value || 0) <= 0 ? t('Required_field', { field: t('Estimated_wait_time_in_minutes') }) : true;\n\t\t\t},\n\t\t},\n\t});\n\n\tconst { field: descField } = useController({ control, name: 'description' });\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\tconst { name, description, dueTimeInMinutes } = getValues();\n\n\t\tif (!isValid || !name || dueTimeInMinutes === undefined) {\n\t\t\treturn dispatchToastMessage({ type: 'error', message: t('Required_field') });\n\t\t}\n\n\t\ttry {\n\t\t\tconst payload = { name, description, dueTimeInMinutes: Number(dueTimeInMinutes) };\n\t\t\tif (slaId) {\n\t\t\t\tawait updateSLA(payload);\n\t\t\t} else {\n\t\t\t\tawait saveSLA(payload);\n\t\t\t}\n\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\treload();\n\t\t\tslasRoute.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\treturn (\n\t\t<ContextualbarScrollableContent is='form' {...props}>\n\t\t\t<Field>\n\t\t\t\t<FieldLabel>{t('Name')}*</FieldLabel>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<TextInput placeholder={t('Name')} flexGrow={1} {...nameField} error={errors.name?.message} />\n\t\t\t\t</FieldRow>\n\t\t\t\t<FieldError>{errors.name?.message}</FieldError>\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<FieldLabel>{t('Description')}</FieldLabel>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<TextInput placeholder={t('Description')} flexGrow={1} {...descField} />\n\t\t\t\t</FieldRow>\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<FieldLabel>{t('Estimated_wait_time_in_minutes')}*</FieldLabel>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<NumberInput\n\t\t\t\t\t\tplaceholder={t('Estimated_wait_time_in_minutes')}\n\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t{...dueTimeField}\n\t\t\t\t\t\terror={errors.dueTimeInMinutes?.message}\n\t\t\t\t\t/>\n\t\t\t\t</FieldRow>\n\t\t\t\t<FieldError>{errors.dueTimeInMinutes?.message}</FieldError>\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<Box display='flex' flexDirection='row' justifyContent='space-between' w='full'>\n\t\t\t\t\t\t<Margins inlineEnd={4}>\n\t\t\t\t\t\t\t{!isNew && (\n\t\t\t\t\t\t\t\t<Button flexGrow={1} type='reset' disabled={!isDirty} onClick={(): void => reset()}>\n\t\t\t\t\t\t\t\t\t{t('Reset')}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<Button primary mie='none' flexGrow={1} disabled={!isDirty || !isValid} onClick={handleSave}>\n\t\t\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Margins>\n\t\t\t\t\t</Box>\n\t\t\t\t</FieldRow>\n\t\t\t</Field>\n\t\t</ContextualbarScrollableContent>\n\t);\n}\n\nexport default SlaEdit;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/omnichannel/slaPolicies/SlaEdit.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/omnichannel/slaPolicies/SlaEdit.tsx","inputSourceMap":{"version":3,"file":"client/omnichannel/slaPolicies/SlaEdit.tsx","sourceRoot":"","sources":["client/omnichannel/slaPolicies/SlaEdit.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IOmnichannelServiceLevelAgreements, Serialized } from '@rocket.chat/core-typings';\nimport { Field, FieldLabel, FieldRow, FieldError, TextInput, Button, Margins, Box, NumberInput } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useRoute, useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React from 'react';\nimport { useController, useForm } from 'react-hook-form';\n\nimport { ContextualbarScrollableContent } from '../../components/Contextualbar';\n\ntype SlaEditProps = {\n\tisNew?: boolean;\n\tslaId?: string;\n\treload: () => void;\n\tdata?: Serialized<IOmnichannelServiceLevelAgreements>;\n};\n\nfunction SlaEdit({ data, isNew, slaId, reload, ...props }: SlaEditProps): ReactElement {\n\tconst slasRoute = useRoute('omnichannel-sla-policies');\n\tconst saveSLA = useEndpoint('POST', '/v1/livechat/sla');\n\tconst updateSLA = useEndpoint('PUT', `/v1/livechat/sla/:slaId`, { slaId: slaId || '' });\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst t = useTranslation();\n\n\tconst { name, description, dueTimeInMinutes } = data || {};\n\n\tconst {\n\t\tcontrol,\n\t\tgetValues,\n\t\tformState: { errors, isValid, isDirty },\n\t\treset,\n\t} = useForm({\n\t\tmode: 'onChange',\n\t\tdefaultValues: { name, description, dueTimeInMinutes },\n\t});\n\n\tconst { field: nameField } = useController({\n\t\tcontrol,\n\t\tname: 'name',\n\t\trules: { required: t('Required_field', { field: t('Name') }) },\n\t});\n\n\tconst { field: dueTimeField } = useController({\n\t\tcontrol,\n\t\tname: 'dueTimeInMinutes',\n\t\trules: {\n\t\t\tvalidate(value) {\n\t\t\t\treturn Number(value || 0) <= 0 ? t('Required_field', { field: t('Estimated_wait_time_in_minutes') }) : true;\n\t\t\t},\n\t\t},\n\t});\n\n\tconst { field: descField } = useController({ control, name: 'description' });\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\tconst { name, description, dueTimeInMinutes } = getValues();\n\n\t\tif (!isValid || !name || dueTimeInMinutes === undefined) {\n\t\t\treturn dispatchToastMessage({ type: 'error', message: t('Required_field') });\n\t\t}\n\n\t\ttry {\n\t\t\tconst payload = { name, description, dueTimeInMinutes: Number(dueTimeInMinutes) };\n\t\t\tif (slaId) {\n\t\t\t\tawait updateSLA(payload);\n\t\t\t} else {\n\t\t\t\tawait saveSLA(payload);\n\t\t\t}\n\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\treload();\n\t\t\tslasRoute.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\treturn (\n\t\t<ContextualbarScrollableContent is='form' {...props}>\n\t\t\t<Field>\n\t\t\t\t<FieldLabel>{t('Name')}*</FieldLabel>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<TextInput placeholder={t('Name')} flexGrow={1} {...nameField} error={errors.name?.message} />\n\t\t\t\t</FieldRow>\n\t\t\t\t<FieldError>{errors.name?.message}</FieldError>\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<FieldLabel>{t('Description')}</FieldLabel>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<TextInput placeholder={t('Description')} flexGrow={1} {...descField} />\n\t\t\t\t</FieldRow>\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<FieldLabel>{t('Estimated_wait_time_in_minutes')}*</FieldLabel>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<NumberInput\n\t\t\t\t\t\tplaceholder={t('Estimated_wait_time_in_minutes')}\n\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t{...dueTimeField}\n\t\t\t\t\t\terror={errors.dueTimeInMinutes?.message}\n\t\t\t\t\t/>\n\t\t\t\t</FieldRow>\n\t\t\t\t<FieldError>{errors.dueTimeInMinutes?.message}</FieldError>\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<Box display='flex' flexDirection='row' justifyContent='space-between' w='full'>\n\t\t\t\t\t\t<Margins inlineEnd={4}>\n\t\t\t\t\t\t\t{!isNew && (\n\t\t\t\t\t\t\t\t<Button flexGrow={1} type='reset' disabled={!isDirty} onClick={(): void => reset()}>\n\t\t\t\t\t\t\t\t\t{t('Reset')}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<Button primary mie='none' flexGrow={1} disabled={!isDirty || !isValid} onClick={handleSave}>\n\t\t\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Margins>\n\t\t\t\t\t</Box>\n\t\t\t\t</FieldRow>\n\t\t\t</Field>\n\t\t</ContextualbarScrollableContent>\n\t);\n}\n\nexport default SlaEdit;\n"]}}},"code":"const _excluded = [\"data\", \"isNew\", \"slaId\", \"reload\"];\nlet _extends;\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default(v) {\n    _extends = v;\n  }\n}, 0);\nlet _objectWithoutProperties;\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default(v) {\n    _objectWithoutProperties = v;\n  }\n}, 1);\nlet Field, FieldLabel, FieldRow, FieldError, TextInput, Button, Margins, Box, NumberInput;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Field(v) {\n    Field = v;\n  },\n  FieldLabel(v) {\n    FieldLabel = v;\n  },\n  FieldRow(v) {\n    FieldRow = v;\n  },\n  FieldError(v) {\n    FieldError = v;\n  },\n  TextInput(v) {\n    TextInput = v;\n  },\n  Button(v) {\n    Button = v;\n  },\n  Margins(v) {\n    Margins = v;\n  },\n  Box(v) {\n    Box = v;\n  },\n  NumberInput(v) {\n    NumberInput = v;\n  }\n}, 0);\nlet useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback(v) {\n    useMutableCallback = v;\n  }\n}, 1);\nlet useToastMessageDispatch, useRoute, useTranslation, useEndpoint;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useToastMessageDispatch(v) {\n    useToastMessageDispatch = v;\n  },\n  useRoute(v) {\n    useRoute = v;\n  },\n  useTranslation(v) {\n    useTranslation = v;\n  },\n  useEndpoint(v) {\n    useEndpoint = v;\n  }\n}, 2);\nlet React;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  }\n}, 3);\nlet useController, useForm;\nmodule.link(\"react-hook-form\", {\n  useController(v) {\n    useController = v;\n  },\n  useForm(v) {\n    useForm = v;\n  }\n}, 4);\nlet ContextualbarScrollableContent;\nmodule.link(\"../../components/Contextualbar\", {\n  ContextualbarScrollableContent(v) {\n    ContextualbarScrollableContent = v;\n  }\n}, 5);\nfunction SlaEdit(_ref) {\n  var _errors$name, _errors$name2, _errors$dueTimeInMinu, _errors$dueTimeInMinu2;\n  let {\n      data,\n      isNew,\n      slaId,\n      reload\n    } = _ref,\n    props = _objectWithoutProperties(_ref, _excluded);\n  const slasRoute = useRoute('omnichannel-sla-policies');\n  const saveSLA = useEndpoint('POST', '/v1/livechat/sla');\n  const updateSLA = useEndpoint('PUT', \"/v1/livechat/sla/:slaId\", {\n    slaId: slaId || ''\n  });\n  const dispatchToastMessage = useToastMessageDispatch();\n  const t = useTranslation();\n  const {\n    name,\n    description,\n    dueTimeInMinutes\n  } = data || {};\n  const {\n    control,\n    getValues,\n    formState: {\n      errors,\n      isValid,\n      isDirty\n    },\n    reset\n  } = useForm({\n    mode: 'onChange',\n    defaultValues: {\n      name,\n      description,\n      dueTimeInMinutes\n    }\n  });\n  const {\n    field: nameField\n  } = useController({\n    control,\n    name: 'name',\n    rules: {\n      required: t('Required_field', {\n        field: t('Name')\n      })\n    }\n  });\n  const {\n    field: dueTimeField\n  } = useController({\n    control,\n    name: 'dueTimeInMinutes',\n    rules: {\n      validate(value) {\n        return Number(value || 0) <= 0 ? t('Required_field', {\n          field: t('Estimated_wait_time_in_minutes')\n        }) : true;\n      }\n    }\n  });\n  const {\n    field: descField\n  } = useController({\n    control,\n    name: 'description'\n  });\n  const handleSave = useMutableCallback(async () => {\n    const {\n      name,\n      description,\n      dueTimeInMinutes\n    } = getValues();\n    if (!isValid || !name || dueTimeInMinutes === undefined) {\n      return dispatchToastMessage({\n        type: 'error',\n        message: t('Required_field')\n      });\n    }\n    try {\n      const payload = {\n        name,\n        description,\n        dueTimeInMinutes: Number(dueTimeInMinutes)\n      };\n      if (slaId) {\n        await updateSLA(payload);\n      } else {\n        await saveSLA(payload);\n      }\n      dispatchToastMessage({\n        type: 'success',\n        message: t('Saved')\n      });\n      reload();\n      slasRoute.push({});\n    } catch (error) {\n      dispatchToastMessage({\n        type: 'error',\n        message: error\n      });\n    }\n  });\n  return /*#__PURE__*/React.createElement(ContextualbarScrollableContent, _extends({\n    is: \"form\"\n  }, props), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(FieldLabel, null, t('Name'), \"*\"), /*#__PURE__*/React.createElement(FieldRow, null, /*#__PURE__*/React.createElement(TextInput, _extends({\n    placeholder: t('Name'),\n    flexGrow: 1\n  }, nameField, {\n    error: (_errors$name = errors.name) === null || _errors$name === void 0 ? void 0 : _errors$name.message\n  }))), /*#__PURE__*/React.createElement(FieldError, null, (_errors$name2 = errors.name) === null || _errors$name2 === void 0 ? void 0 : _errors$name2.message)), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(FieldLabel, null, t('Description')), /*#__PURE__*/React.createElement(FieldRow, null, /*#__PURE__*/React.createElement(TextInput, _extends({\n    placeholder: t('Description'),\n    flexGrow: 1\n  }, descField)))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(FieldLabel, null, t('Estimated_wait_time_in_minutes'), \"*\"), /*#__PURE__*/React.createElement(FieldRow, null, /*#__PURE__*/React.createElement(NumberInput, _extends({\n    placeholder: t('Estimated_wait_time_in_minutes'),\n    flexGrow: 1\n  }, dueTimeField, {\n    error: (_errors$dueTimeInMinu = errors.dueTimeInMinutes) === null || _errors$dueTimeInMinu === void 0 ? void 0 : _errors$dueTimeInMinu.message\n  }))), /*#__PURE__*/React.createElement(FieldError, null, (_errors$dueTimeInMinu2 = errors.dueTimeInMinutes) === null || _errors$dueTimeInMinu2 === void 0 ? void 0 : _errors$dueTimeInMinu2.message)), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(FieldRow, null, /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    w: \"full\"\n  }, /*#__PURE__*/React.createElement(Margins, {\n    inlineEnd: 4\n  }, !isNew && /*#__PURE__*/React.createElement(Button, {\n    flexGrow: 1,\n    type: \"reset\",\n    disabled: !isDirty,\n    onClick: () => reset()\n  }, t('Reset')), /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    mie: \"none\",\n    flexGrow: 1,\n    disabled: !isDirty || !isValid,\n    onClick: handleSave\n  }, t('Save')))))));\n}\nmodule.exportDefault(SlaEdit);","map":{"version":3,"names":["_extends","module","link","default","v","_objectWithoutProperties","Field","FieldLabel","FieldRow","FieldError","TextInput","Button","Margins","Box","NumberInput","useMutableCallback","useToastMessageDispatch","useRoute","useTranslation","useEndpoint","React","useController","useForm","ContextualbarScrollableContent","SlaEdit","_ref","_errors$name","_errors$name2","_errors$dueTimeInMinu","_errors$dueTimeInMinu2","data","isNew","slaId","reload","props","_excluded","slasRoute","saveSLA","updateSLA","dispatchToastMessage","t","name","description","dueTimeInMinutes","control","getValues","formState","errors","isValid","isDirty","reset","mode","defaultValues","field","nameField","rules","required","dueTimeField","validate","value","Number","descField","handleSave","undefined","type","message","payload","push","error","createElement","is","placeholder","flexGrow","display","flexDirection","justifyContent","w","inlineEnd","disabled","onClick","primary","mie","exportDefault"],"sources":["client/omnichannel/slaPolicies/SlaEdit.tsx"],"sourcesContent":["import type { IOmnichannelServiceLevelAgreements, Serialized } from '@rocket.chat/core-typings';\nimport { Field, FieldLabel, FieldRow, FieldError, TextInput, Button, Margins, Box, NumberInput } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useRoute, useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React from 'react';\nimport { useController, useForm } from 'react-hook-form';\n\nimport { ContextualbarScrollableContent } from '../../components/Contextualbar';\n\ntype SlaEditProps = {\n\tisNew?: boolean;\n\tslaId?: string;\n\treload: () => void;\n\tdata?: Serialized<IOmnichannelServiceLevelAgreements>;\n};\n\nfunction SlaEdit({ data, isNew, slaId, reload, ...props }: SlaEditProps): ReactElement {\n\tconst slasRoute = useRoute('omnichannel-sla-policies');\n\tconst saveSLA = useEndpoint('POST', '/v1/livechat/sla');\n\tconst updateSLA = useEndpoint('PUT', `/v1/livechat/sla/:slaId`, { slaId: slaId || '' });\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst t = useTranslation();\n\n\tconst { name, description, dueTimeInMinutes } = data || {};\n\n\tconst {\n\t\tcontrol,\n\t\tgetValues,\n\t\tformState: { errors, isValid, isDirty },\n\t\treset,\n\t} = useForm({\n\t\tmode: 'onChange',\n\t\tdefaultValues: { name, description, dueTimeInMinutes },\n\t});\n\n\tconst { field: nameField } = useController({\n\t\tcontrol,\n\t\tname: 'name',\n\t\trules: { required: t('Required_field', { field: t('Name') }) },\n\t});\n\n\tconst { field: dueTimeField } = useController({\n\t\tcontrol,\n\t\tname: 'dueTimeInMinutes',\n\t\trules: {\n\t\t\tvalidate(value) {\n\t\t\t\treturn Number(value || 0) <= 0 ? t('Required_field', { field: t('Estimated_wait_time_in_minutes') }) : true;\n\t\t\t},\n\t\t},\n\t});\n\n\tconst { field: descField } = useController({ control, name: 'description' });\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\tconst { name, description, dueTimeInMinutes } = getValues();\n\n\t\tif (!isValid || !name || dueTimeInMinutes === undefined) {\n\t\t\treturn dispatchToastMessage({ type: 'error', message: t('Required_field') });\n\t\t}\n\n\t\ttry {\n\t\t\tconst payload = { name, description, dueTimeInMinutes: Number(dueTimeInMinutes) };\n\t\t\tif (slaId) {\n\t\t\t\tawait updateSLA(payload);\n\t\t\t} else {\n\t\t\t\tawait saveSLA(payload);\n\t\t\t}\n\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\treload();\n\t\t\tslasRoute.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\treturn (\n\t\t<ContextualbarScrollableContent is='form' {...props}>\n\t\t\t<Field>\n\t\t\t\t<FieldLabel>{t('Name')}*</FieldLabel>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<TextInput placeholder={t('Name')} flexGrow={1} {...nameField} error={errors.name?.message} />\n\t\t\t\t</FieldRow>\n\t\t\t\t<FieldError>{errors.name?.message}</FieldError>\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<FieldLabel>{t('Description')}</FieldLabel>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<TextInput placeholder={t('Description')} flexGrow={1} {...descField} />\n\t\t\t\t</FieldRow>\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<FieldLabel>{t('Estimated_wait_time_in_minutes')}*</FieldLabel>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<NumberInput\n\t\t\t\t\t\tplaceholder={t('Estimated_wait_time_in_minutes')}\n\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t{...dueTimeField}\n\t\t\t\t\t\terror={errors.dueTimeInMinutes?.message}\n\t\t\t\t\t/>\n\t\t\t\t</FieldRow>\n\t\t\t\t<FieldError>{errors.dueTimeInMinutes?.message}</FieldError>\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<Box display='flex' flexDirection='row' justifyContent='space-between' w='full'>\n\t\t\t\t\t\t<Margins inlineEnd={4}>\n\t\t\t\t\t\t\t{!isNew && (\n\t\t\t\t\t\t\t\t<Button flexGrow={1} type='reset' disabled={!isDirty} onClick={(): void => reset()}>\n\t\t\t\t\t\t\t\t\t{t('Reset')}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<Button primary mie='none' flexGrow={1} disabled={!isDirty || !isValid} onClick={handleSave}>\n\t\t\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Margins>\n\t\t\t\t\t</Box>\n\t\t\t\t</FieldRow>\n\t\t\t</Field>\n\t\t</ContextualbarScrollableContent>\n\t);\n}\n\nexport default SlaEdit;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"a1e6ac46aea2fe564ce32ceb36808b631ed898d2"}
