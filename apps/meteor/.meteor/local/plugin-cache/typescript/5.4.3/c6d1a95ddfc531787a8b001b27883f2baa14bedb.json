{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts","inputSourceMap":{"version":3,"file":"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts","sourceRoot":"","sources":["client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,kBAAkB,EAAE,MAAM,6BAA6B,CAAC;AAEjE,OAAO,EAAE,UAAU,EAAE,MAAM,0BAA0B,CAAC;AACtD,OAAO,EAAE,SAAS,EAAE,OAAO,EAAE,MAAM,OAAO,CAAC;AAE3C,OAAO,EAAE,aAAa,EAAE,MAAM,iEAAiE,CAAC;AAChG,OAAO,EAAE,OAAO,EAAE,MAAM,kCAAkC,CAAC;AAC3D,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AACtE,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AAEtE,MAAM,CAAC,MAAM,qBAAqB,GAAG,CAAC,QAAiB,EAAwB,EAAE;IAChF,MAAM,mBAAmB,GAAG,UAAU,CAAC,oBAAoB,CAAY,CAAC;IACxE,MAAM,sBAAsB,GAAG,UAAU,CAAC,8BAA8B,CAAY,CAAC;IACrF,MAAM,4BAA4B,GAAG,UAAU,CAAC,+BAA+B,CAAW,CAAC;IAC3F,MAAM,4BAA4B,GAAG,UAAU,CAAC,+BAA+B,CAAW,CAAC;IAC3F,MAAM,CAAC,kBAAkB,EAAE,qBAAqB,CAAC,GAAG,mBAAmB,CAAC,QAAQ,CAAC,CAAC;IAElF,MAAM,SAAS,GAAG,OAAO,CACxB,GAAG,EAAE,CACJ,OAAO,CACN,CAAC,kBAAkB;QAClB,SAAS,CAAC,YAAY;QACtB,MAAM,CAAC,aAAa;QACpB,mBAAmB;QACnB,sBAAsB;QACtB,CAAC,4BAA4B,EAAE,KAAK,CAAC,wBAAwB,CAAC;QAC9D,CAAC,CAAC,4BAA4B,IAAI,4BAA4B,CAAC,KAAK,CAAC,wBAAwB,CAAC,CAAC;QAC/F,OAAO,CAAC,aAAa,CAAC,qBAAqB,EAAE,CAAC,CAC/C,EACF,CAAC,4BAA4B,EAAE,4BAA4B,EAAE,mBAAmB,EAAE,kBAAkB,EAAE,sBAAsB,CAAC,CAC7H,CAAC;IAEF,MAAM,mBAAmB,GAAG,mBAAmB,CAAC,OAAO,EAAE,kBAAkB,EAAE,mBAAmB,EAAE,sBAAsB,EAAE,SAAS,CAAC,CAAC;IAErI,MAAM,IAAI,GAAG,OAAO,EAAE,CAAC;IAEvB,MAAM,sBAAsB,GAAG,GAAG,EAAE;QACnC,IAAI,CAAC,IAAI,EAAE,QAAQ,EAAE,cAAc,CAAC,GAAG,EAAE,EAAE,CAAC;YAC3C,IAAI,EAAE,QAAQ,EAAE,iBAAiB,CAAC,IAAI,CAAC,CAAC;QACzC,CAAC;IACF,CAAC,CAAC;IAEF,MAAM,eAAe,GAAG,kBAAkB,CAAC,CAAC,QAAQ,EAAE,EAAE;QACvD,IAAI,QAAQ,EAAE,CAAC;YACd,IAAI,EAAE,QAAQ,EAAE,iBAAiB,CAAC,KAAK,CAAC,CAAC;QAC1C,CAAC;QAED,qBAAqB,CAAC,QAAQ,CAAC,CAAC;IACjC,CAAC,CAAC,CAAC;IAEH,SAAS,CAAC,GAAG,EAAE;QACd,eAAe,CAAC,kBAAkB,CAAC,CAAC;IACrC,CAAC,EAAE,CAAC,eAAe,EAAE,kBAAkB,CAAC,CAAC,CAAC;IAE1C,OAAO;QACN,EAAE,EAAE,eAAe;QACnB,OAAO,EAAE,mBAAmB;QAC5B,IAAI,EAAE,OAAO;QACb,QAAQ,EAAE,CAAC,SAAS,IAAI,OAAO,CAAC,QAAQ,CAAC;QACzC,OAAO,EAAE,sBAAsB;KAC/B,CAAC;AACH,CAAC,CAAC","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useSetting } from '@rocket.chat/ui-contexts';\nimport { useEffect, useMemo } from 'react';\n\nimport { VideoRecorder } from '../../../../../../../app/ui/client/lib/recorderjs/videoRecorder';\nimport { useChat } from '../../../../contexts/ChatContext';\nimport { useMediaActionTitle } from '../../hooks/useMediaActionTitle';\nimport { useMediaPermissions } from '../../hooks/useMediaPermissions';\n\nexport const useVideoMessageAction = (disabled: boolean): GenericMenuItemProps => {\n\tconst isFileUploadEnabled = useSetting('FileUpload_Enabled') as boolean;\n\tconst isVideoRecorderEnabled = useSetting('Message_VideoRecorderEnabled') as boolean;\n\tconst fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList') as string;\n\tconst fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList') as string;\n\tconst [isPermissionDenied, setIsPermissionDenied] = useMediaPermissions('camera');\n\n\tconst isAllowed = useMemo(\n\t\t() =>\n\t\t\tBoolean(\n\t\t\t\t!isPermissionDenied &&\n\t\t\t\t\tnavigator.mediaDevices &&\n\t\t\t\t\twindow.MediaRecorder &&\n\t\t\t\t\tisFileUploadEnabled &&\n\t\t\t\t\tisVideoRecorderEnabled &&\n\t\t\t\t\t!fileUploadMediaTypeBlackList?.match(/video\\/webm|video\\/\\*/i) &&\n\t\t\t\t\t(!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/video\\/webm|video\\/\\*/i)) &&\n\t\t\t\t\tBoolean(VideoRecorder.getSupportedMimeTypes()),\n\t\t\t),\n\t\t[fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isFileUploadEnabled, isPermissionDenied, isVideoRecorderEnabled],\n\t);\n\n\tconst getMediaActionTitle = useMediaActionTitle('video', isPermissionDenied, isFileUploadEnabled, isVideoRecorderEnabled, isAllowed);\n\n\tconst chat = useChat();\n\n\tconst handleOpenVideoMessage = () => {\n\t\tif (!chat?.composer?.recordingVideo.get()) {\n\t\t\tchat?.composer?.setRecordingVideo(true);\n\t\t}\n\t};\n\n\tconst handleDenyVideo = useMutableCallback((isDenied) => {\n\t\tif (isDenied) {\n\t\t\tchat?.composer?.setRecordingVideo(false);\n\t\t}\n\n\t\tsetIsPermissionDenied(isDenied);\n\t});\n\n\tuseEffect(() => {\n\t\thandleDenyVideo(isPermissionDenied);\n\t}, [handleDenyVideo, isPermissionDenied]);\n\n\treturn {\n\t\tid: 'video-message',\n\t\tcontent: getMediaActionTitle,\n\t\ticon: 'video',\n\t\tdisabled: !isAllowed || Boolean(disabled),\n\t\tonClick: handleOpenVideoMessage,\n\t};\n};\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts","inputSourceMap":{"version":3,"file":"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts","sourceRoot":"","sources":["client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,kBAAkB,EAAE,MAAM,6BAA6B,CAAC;AAEjE,OAAO,EAAE,UAAU,EAAE,MAAM,0BAA0B,CAAC;AACtD,OAAO,EAAE,SAAS,EAAE,OAAO,EAAE,MAAM,OAAO,CAAC;AAE3C,OAAO,EAAE,aAAa,EAAE,MAAM,iEAAiE,CAAC;AAChG,OAAO,EAAE,OAAO,EAAE,MAAM,kCAAkC,CAAC;AAC3D,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AACtE,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AAEtE,MAAM,CAAC,MAAM,qBAAqB,GAAG,CAAC,QAAiB,EAAwB,EAAE;IAChF,MAAM,mBAAmB,GAAG,UAAU,CAAC,oBAAoB,CAAY,CAAC;IACxE,MAAM,sBAAsB,GAAG,UAAU,CAAC,8BAA8B,CAAY,CAAC;IACrF,MAAM,4BAA4B,GAAG,UAAU,CAAC,+BAA+B,CAAW,CAAC;IAC3F,MAAM,4BAA4B,GAAG,UAAU,CAAC,+BAA+B,CAAW,CAAC;IAC3F,MAAM,CAAC,kBAAkB,EAAE,qBAAqB,CAAC,GAAG,mBAAmB,CAAC,QAAQ,CAAC,CAAC;IAElF,MAAM,SAAS,GAAG,OAAO,CACxB,GAAG,EAAE,CACJ,OAAO,CACN,CAAC,kBAAkB;QAClB,SAAS,CAAC,YAAY;QACtB,MAAM,CAAC,aAAa;QACpB,mBAAmB;QACnB,sBAAsB;QACtB,CAAC,4BAA4B,EAAE,KAAK,CAAC,wBAAwB,CAAC;QAC9D,CAAC,CAAC,4BAA4B,IAAI,4BAA4B,CAAC,KAAK,CAAC,wBAAwB,CAAC,CAAC;QAC/F,OAAO,CAAC,aAAa,CAAC,qBAAqB,EAAE,CAAC,CAC/C,EACF,CAAC,4BAA4B,EAAE,4BAA4B,EAAE,mBAAmB,EAAE,kBAAkB,EAAE,sBAAsB,CAAC,CAC7H,CAAC;IAEF,MAAM,mBAAmB,GAAG,mBAAmB,CAAC,OAAO,EAAE,kBAAkB,EAAE,mBAAmB,EAAE,sBAAsB,EAAE,SAAS,CAAC,CAAC;IAErI,MAAM,IAAI,GAAG,OAAO,EAAE,CAAC;IAEvB,MAAM,sBAAsB,GAAG,GAAG,EAAE;QACnC,IAAI,CAAC,IAAI,EAAE,QAAQ,EAAE,cAAc,CAAC,GAAG,EAAE,EAAE,CAAC;YAC3C,IAAI,EAAE,QAAQ,EAAE,iBAAiB,CAAC,IAAI,CAAC,CAAC;QACzC,CAAC;IACF,CAAC,CAAC;IAEF,MAAM,eAAe,GAAG,kBAAkB,CAAC,CAAC,QAAQ,EAAE,EAAE;QACvD,IAAI,QAAQ,EAAE,CAAC;YACd,IAAI,EAAE,QAAQ,EAAE,iBAAiB,CAAC,KAAK,CAAC,CAAC;QAC1C,CAAC;QAED,qBAAqB,CAAC,QAAQ,CAAC,CAAC;IACjC,CAAC,CAAC,CAAC;IAEH,SAAS,CAAC,GAAG,EAAE;QACd,eAAe,CAAC,kBAAkB,CAAC,CAAC;IACrC,CAAC,EAAE,CAAC,eAAe,EAAE,kBAAkB,CAAC,CAAC,CAAC;IAE1C,OAAO;QACN,EAAE,EAAE,eAAe;QACnB,OAAO,EAAE,mBAAmB;QAC5B,IAAI,EAAE,OAAO;QACb,QAAQ,EAAE,CAAC,SAAS,IAAI,OAAO,CAAC,QAAQ,CAAC;QACzC,OAAO,EAAE,sBAAsB;KAC/B,CAAC;AACH,CAAC,CAAC","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useSetting } from '@rocket.chat/ui-contexts';\nimport { useEffect, useMemo } from 'react';\n\nimport { VideoRecorder } from '../../../../../../../app/ui/client/lib/recorderjs/videoRecorder';\nimport { useChat } from '../../../../contexts/ChatContext';\nimport { useMediaActionTitle } from '../../hooks/useMediaActionTitle';\nimport { useMediaPermissions } from '../../hooks/useMediaPermissions';\n\nexport const useVideoMessageAction = (disabled: boolean): GenericMenuItemProps => {\n\tconst isFileUploadEnabled = useSetting('FileUpload_Enabled') as boolean;\n\tconst isVideoRecorderEnabled = useSetting('Message_VideoRecorderEnabled') as boolean;\n\tconst fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList') as string;\n\tconst fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList') as string;\n\tconst [isPermissionDenied, setIsPermissionDenied] = useMediaPermissions('camera');\n\n\tconst isAllowed = useMemo(\n\t\t() =>\n\t\t\tBoolean(\n\t\t\t\t!isPermissionDenied &&\n\t\t\t\t\tnavigator.mediaDevices &&\n\t\t\t\t\twindow.MediaRecorder &&\n\t\t\t\t\tisFileUploadEnabled &&\n\t\t\t\t\tisVideoRecorderEnabled &&\n\t\t\t\t\t!fileUploadMediaTypeBlackList?.match(/video\\/webm|video\\/\\*/i) &&\n\t\t\t\t\t(!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/video\\/webm|video\\/\\*/i)) &&\n\t\t\t\t\tBoolean(VideoRecorder.getSupportedMimeTypes()),\n\t\t\t),\n\t\t[fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isFileUploadEnabled, isPermissionDenied, isVideoRecorderEnabled],\n\t);\n\n\tconst getMediaActionTitle = useMediaActionTitle('video', isPermissionDenied, isFileUploadEnabled, isVideoRecorderEnabled, isAllowed);\n\n\tconst chat = useChat();\n\n\tconst handleOpenVideoMessage = () => {\n\t\tif (!chat?.composer?.recordingVideo.get()) {\n\t\t\tchat?.composer?.setRecordingVideo(true);\n\t\t}\n\t};\n\n\tconst handleDenyVideo = useMutableCallback((isDenied) => {\n\t\tif (isDenied) {\n\t\t\tchat?.composer?.setRecordingVideo(false);\n\t\t}\n\n\t\tsetIsPermissionDenied(isDenied);\n\t});\n\n\tuseEffect(() => {\n\t\thandleDenyVideo(isPermissionDenied);\n\t}, [handleDenyVideo, isPermissionDenied]);\n\n\treturn {\n\t\tid: 'video-message',\n\t\tcontent: getMediaActionTitle,\n\t\ticon: 'video',\n\t\tdisabled: !isAllowed || Boolean(disabled),\n\t\tonClick: handleOpenVideoMessage,\n\t};\n};\n"]}}},"code":"module.export({\n  useVideoMessageAction: () => useVideoMessageAction\n});\nlet useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback(v) {\n    useMutableCallback = v;\n  }\n}, 0);\nlet useSetting;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useSetting(v) {\n    useSetting = v;\n  }\n}, 1);\nlet useEffect, useMemo;\nmodule.link(\"react\", {\n  useEffect(v) {\n    useEffect = v;\n  },\n  useMemo(v) {\n    useMemo = v;\n  }\n}, 2);\nlet VideoRecorder;\nmodule.link(\"../../../../../../../app/ui/client/lib/recorderjs/videoRecorder\", {\n  VideoRecorder(v) {\n    VideoRecorder = v;\n  }\n}, 3);\nlet useChat;\nmodule.link(\"../../../../contexts/ChatContext\", {\n  useChat(v) {\n    useChat = v;\n  }\n}, 4);\nlet useMediaActionTitle;\nmodule.link(\"../../hooks/useMediaActionTitle\", {\n  useMediaActionTitle(v) {\n    useMediaActionTitle = v;\n  }\n}, 5);\nlet useMediaPermissions;\nmodule.link(\"../../hooks/useMediaPermissions\", {\n  useMediaPermissions(v) {\n    useMediaPermissions = v;\n  }\n}, 6);\nconst useVideoMessageAction = disabled => {\n  const isFileUploadEnabled = useSetting('FileUpload_Enabled');\n  const isVideoRecorderEnabled = useSetting('Message_VideoRecorderEnabled');\n  const fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList');\n  const fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList');\n  const [isPermissionDenied, setIsPermissionDenied] = useMediaPermissions('camera');\n  const isAllowed = useMemo(() => Boolean(!isPermissionDenied && navigator.mediaDevices && window.MediaRecorder && isFileUploadEnabled && isVideoRecorderEnabled && !(fileUploadMediaTypeBlackList !== null && fileUploadMediaTypeBlackList !== void 0 && fileUploadMediaTypeBlackList.match(/video\\/webm|video\\/\\*/i)) && (!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/video\\/webm|video\\/\\*/i)) && Boolean(VideoRecorder.getSupportedMimeTypes())), [fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isFileUploadEnabled, isPermissionDenied, isVideoRecorderEnabled]);\n  const getMediaActionTitle = useMediaActionTitle('video', isPermissionDenied, isFileUploadEnabled, isVideoRecorderEnabled, isAllowed);\n  const chat = useChat();\n  const handleOpenVideoMessage = () => {\n    var _chat$composer;\n    if (!(chat !== null && chat !== void 0 && (_chat$composer = chat.composer) !== null && _chat$composer !== void 0 && _chat$composer.recordingVideo.get())) {\n      var _chat$composer2;\n      chat === null || chat === void 0 ? void 0 : (_chat$composer2 = chat.composer) === null || _chat$composer2 === void 0 ? void 0 : _chat$composer2.setRecordingVideo(true);\n    }\n  };\n  const handleDenyVideo = useMutableCallback(isDenied => {\n    if (isDenied) {\n      var _chat$composer3;\n      chat === null || chat === void 0 ? void 0 : (_chat$composer3 = chat.composer) === null || _chat$composer3 === void 0 ? void 0 : _chat$composer3.setRecordingVideo(false);\n    }\n    setIsPermissionDenied(isDenied);\n  });\n  useEffect(() => {\n    handleDenyVideo(isPermissionDenied);\n  }, [handleDenyVideo, isPermissionDenied]);\n  return {\n    id: 'video-message',\n    content: getMediaActionTitle,\n    icon: 'video',\n    disabled: !isAllowed || Boolean(disabled),\n    onClick: handleOpenVideoMessage\n  };\n};","map":{"version":3,"names":["module","export","useVideoMessageAction","useMutableCallback","link","v","useSetting","useEffect","useMemo","VideoRecorder","useChat","useMediaActionTitle","useMediaPermissions","disabled","isFileUploadEnabled","isVideoRecorderEnabled","fileUploadMediaTypeBlackList","fileUploadMediaTypeWhiteList","isPermissionDenied","setIsPermissionDenied","isAllowed","Boolean","navigator","mediaDevices","window","MediaRecorder","match","getSupportedMimeTypes","getMediaActionTitle","chat","handleOpenVideoMessage","_chat$composer","composer","recordingVideo","get","_chat$composer2","setRecordingVideo","handleDenyVideo","isDenied","_chat$composer3","id","content","icon","onClick"],"sources":["client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts"],"sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useSetting } from '@rocket.chat/ui-contexts';\nimport { useEffect, useMemo } from 'react';\n\nimport { VideoRecorder } from '../../../../../../../app/ui/client/lib/recorderjs/videoRecorder';\nimport { useChat } from '../../../../contexts/ChatContext';\nimport { useMediaActionTitle } from '../../hooks/useMediaActionTitle';\nimport { useMediaPermissions } from '../../hooks/useMediaPermissions';\n\nexport const useVideoMessageAction = (disabled: boolean): GenericMenuItemProps => {\n\tconst isFileUploadEnabled = useSetting('FileUpload_Enabled') as boolean;\n\tconst isVideoRecorderEnabled = useSetting('Message_VideoRecorderEnabled') as boolean;\n\tconst fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList') as string;\n\tconst fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList') as string;\n\tconst [isPermissionDenied, setIsPermissionDenied] = useMediaPermissions('camera');\n\n\tconst isAllowed = useMemo(\n\t\t() =>\n\t\t\tBoolean(\n\t\t\t\t!isPermissionDenied &&\n\t\t\t\t\tnavigator.mediaDevices &&\n\t\t\t\t\twindow.MediaRecorder &&\n\t\t\t\t\tisFileUploadEnabled &&\n\t\t\t\t\tisVideoRecorderEnabled &&\n\t\t\t\t\t!fileUploadMediaTypeBlackList?.match(/video\\/webm|video\\/\\*/i) &&\n\t\t\t\t\t(!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/video\\/webm|video\\/\\*/i)) &&\n\t\t\t\t\tBoolean(VideoRecorder.getSupportedMimeTypes()),\n\t\t\t),\n\t\t[fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isFileUploadEnabled, isPermissionDenied, isVideoRecorderEnabled],\n\t);\n\n\tconst getMediaActionTitle = useMediaActionTitle('video', isPermissionDenied, isFileUploadEnabled, isVideoRecorderEnabled, isAllowed);\n\n\tconst chat = useChat();\n\n\tconst handleOpenVideoMessage = () => {\n\t\tif (!chat?.composer?.recordingVideo.get()) {\n\t\t\tchat?.composer?.setRecordingVideo(true);\n\t\t}\n\t};\n\n\tconst handleDenyVideo = useMutableCallback((isDenied) => {\n\t\tif (isDenied) {\n\t\t\tchat?.composer?.setRecordingVideo(false);\n\t\t}\n\n\t\tsetIsPermissionDenied(isDenied);\n\t});\n\n\tuseEffect(() => {\n\t\thandleDenyVideo(isPermissionDenied);\n\t}, [handleDenyVideo, isPermissionDenied]);\n\n\treturn {\n\t\tid: 'video-message',\n\t\tcontent: getMediaActionTitle,\n\t\ticon: 'video',\n\t\tdisabled: !isAllowed || Boolean(disabled),\n\t\tonClick: handleOpenVideoMessage,\n\t};\n};\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"c6d1a95ddfc531787a8b001b27883f2baa14bedb"}
