{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/ui-master/server/inject.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.arm64"},"sourceFileName":"app/ui-master/server/inject.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/ui-master/server/inject.ts","inputSourceMap":{"version":3,"file":"app/ui-master/server/inject.ts","sourceRoot":"","sources":["app/ui-master/server/inject.ts"],"names":[],"mappings":"AAAA,OAAO,MAAM,MAAM,QAAQ,CAAC;AAG5B,OAAO,EAAE,MAAM,EAAE,MAAM,mCAAmC,CAAC;AAC3D,OAAO,EAAE,YAAY,EAAE,MAAM,sBAAsB,CAAC;AACpD,OAAO,EAAE,MAAM,EAAE,MAAM,eAAe,CAAC;AACvC,OAAO,YAAY,MAAM,UAAU,CAAC;AAEpC,OAAO,EAAE,MAAM,EAAE,MAAM,2BAA2B,CAAC;AAUnD,MAAM,CAAC,MAAM,cAAc,GAAG,IAAI,YAAY,EAAE,CAAC;AAEjD,MAAM,QAAQ,GAAuB,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,EAAE;IACvD,IAAI,GAAG,CAAC,MAAM,KAAK,KAAK,IAAI,GAAG,CAAC,MAAM,KAAK,MAAM,IAAI,GAAG,CAAC,MAAM,KAAK,SAAS,EAAE,CAAC;QAC/E,IAAI,EAAE,CAAC;QACP,OAAO;IACR,CAAC;IACD,IAAI,CAAC;QACJ,MAAM,OAAO,GAAG,YAAY,CAAC,GAAG,CAAC,CAAC;QAClC,MAAM,QAAQ,GAAG,OAAO,EAAE,QAAQ,IAAI,kBAAkB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;QAE3E,IAAI,CAAC,QAAQ,EAAE,CAAC;YACf,IAAI,EAAE,CAAC;YACP,OAAO;QACR,CAAC;QAED,MAAM,SAAS,GAAG,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAA0B,CAAC;QAEzG,IAAI,CAAC,SAAS,IAAI,OAAO,SAAS,KAAK,QAAQ,EAAE,CAAC;YACjD,IAAI,EAAE,CAAC;YACP,OAAO;QACR,CAAC;QAED,MAAM,KAAK,GACV,CAAC,WAAmB,EAAE,EAAE,CACxB,CAAC,OAAe,EAAE,YAAY,GAAG,0BAA0B,EAAQ,EAAE;YACpE,GAAG,CAAC,SAAS,CAAC,GAAG,EAAE;gBAClB,cAAc,EAAE,WAAW;gBAC3B,eAAe,EAAE,YAAY;gBAC7B,gBAAgB,EAAE,OAAO,CAAC,MAAM;aAChC,CAAC,CAAC;YACH,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;YACnB,GAAG,CAAC,GAAG,EAAE,CAAC;QACX,CAAC,CAAC;QAEH,MAAM,aAAa,GAAG,KAAK,CAAC,uCAAuC,CAAC,CAAC;QACrE,MAAM,cAAc,GAAG,KAAK,CAAC,yBAAyB,CAAC,CAAC;QAExD,IAAI,SAAS,CAAC,IAAI,KAAK,IAAI,EAAE,CAAC;YAC7B,aAAa,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;YACjC,OAAO;QACR,CAAC;QAED,IAAI,SAAS,CAAC,IAAI,KAAK,KAAK,EAAE,CAAC;YAC9B,cAAc,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;YAClC,OAAO;QACR,CAAC;QACD,IAAI,EAAE,CAAC;IACR,CAAC;IAAC,OAAO,CAAC,EAAE,CAAC;QACZ,IAAI,EAAE,CAAC;IACR,CAAC;AACF,CAAC,CAAC;AAEF,MAAM,CAAC,eAAe,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;AAErC,MAAM,CAAC,MAAM,cAAc,GAAG,CAAC,GAAW,EAAE,KAAgB,EAAQ,EAAE;IACrE,cAAc,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;AAChC,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,SAAS,GAAG,CAAC,GAAW,EAAE,OAAe,EAAQ,EAAE;IAC/D,IAAI,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC;QACnB,MAAM,IAAI,KAAK,CAAC,6DAA6D,CAAC,CAAC;IAChF,CAAC;IAED,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC;QACrB,cAAc,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;QACxB,OAAO;IACR,CAAC;IACD,MAAM,WAAW,GAAG,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;IAE5E,cAAc,CAAC,GAAG,EAAE;QACnB,IAAI,EAAE,IAAI;QACV,GAAG,EAAE,eAAe,GAAG,iCAAiC,GAAG,MAAM,CAAC,GAAG,CAAC,IAAI,WAAW,KAAK,aAAa;QACvG,OAAO;KACP,CAAC,CAAC;AACJ,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAC,GAAW,EAAE,OAAe,EAAQ,EAAE;IAC9D,IAAI,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC;QACnB,MAAM,IAAI,KAAK,CAAC,4DAA4D,CAAC,CAAC;IAC/E,CAAC;IAED,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC;QACrB,cAAc,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;QACxB,OAAO;IACR,CAAC;IACD,MAAM,WAAW,GAAG,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;IAE5E,cAAc,CAAC,GAAG,EAAE;QACnB,IAAI,EAAE,KAAK;QACX,GAAG,EAAE,aAAa,GAAG,4CAA4C,GAAG,MAAM,CAAC,GAAG,CAAC,IAAI,WAAW,MAAM,IAAI;QACxG,OAAO;KACP,CAAC,CAAC;AACJ,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,cAAc,GAAG,CAAC,GAAW,EAAE,KAAa,EAAQ,EAAE;IAClE,MAAM,CAAC,OAAO,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;AAC5B,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,mBAAmB,GAAG,CAAC,UAAuB,EAA8B,EAAE;IAC1F,IAAI,UAAU,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;QAC7B,OAAO,CAAC,IAAY,EAAU,EAAE,CAAC,IAAI,CAAC;IACvC,CAAC;IAED,MAAM,eAAe,GAAG,GAAG,UAAU;SACnC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE;QACV,IAAI,OAAO,CAAC,KAAK,QAAQ,EAAE,CAAC;YAC3B,OAAO,CAAC,CAAC;QACV,CAAC;QACD,OAAO,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC;IACjD,CAAC,CAAC;SACD,IAAI,CAAC,IAAI,CAAC;SACV,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC,WAAW,CAAC;IAEpC,OAAO,CAAC,IAAY,EAAU,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,eAAe,CAAC,CAAC;AAC3E,CAAC,CAAC","sourcesContent":["import crypto from 'crypto';\n\nimport type { NextHandleFunction } from 'connect';\nimport { Inject } from 'meteor/meteorhacks:inject-initial';\nimport { ReactiveDict } from 'meteor/reactive-dict';\nimport { WebApp } from 'meteor/webapp';\nimport parseRequest from 'parseurl';\n\nimport { getURL } from '../../utils/server/getURL';\n\ntype Injection =\n\t| string\n\t| {\n\t\t\tcontent: string;\n\t\t\ttype: 'JS' | 'CSS';\n\t\t\ttag: string;\n\t  };\n\nexport const headInjections = new ReactiveDict();\n\nconst callback: NextHandleFunction = (req, res, next) => {\n\tif (req.method !== 'GET' && req.method !== 'HEAD' && req.method !== 'OPTIONS') {\n\t\tnext();\n\t\treturn;\n\t}\n\ttry {\n\t\tconst rawPath = parseRequest(req);\n\t\tconst pathname = rawPath?.pathname && decodeURIComponent(rawPath.pathname);\n\n\t\tif (!pathname) {\n\t\t\tnext();\n\t\t\treturn;\n\t\t}\n\n\t\tconst injection = headInjections.get(pathname.replace(/^\\//, '').split('_')[0]) as Injection | undefined;\n\n\t\tif (!injection || typeof injection === 'string') {\n\t\t\tnext();\n\t\t\treturn;\n\t\t}\n\n\t\tconst serve =\n\t\t\t(contentType: string) =>\n\t\t\t(content: string, cacheControl = 'public, max-age=31536000'): void => {\n\t\t\t\tres.writeHead(200, {\n\t\t\t\t\t'Content-type': contentType,\n\t\t\t\t\t'cache-control': cacheControl,\n\t\t\t\t\t'Content-Length': content.length,\n\t\t\t\t});\n\t\t\t\tres.write(content);\n\t\t\t\tres.end();\n\t\t\t};\n\n\t\tconst serveStaticJS = serve('application/javascript; charset=UTF-8');\n\t\tconst serveStaticCSS = serve('text/css; charset=UTF-8');\n\n\t\tif (injection.type === 'JS') {\n\t\t\tserveStaticJS(injection.content);\n\t\t\treturn;\n\t\t}\n\n\t\tif (injection.type === 'CSS') {\n\t\t\tserveStaticCSS(injection.content);\n\t\t\treturn;\n\t\t}\n\t\tnext();\n\t} catch (e) {\n\t\tnext();\n\t}\n};\n\nWebApp.connectHandlers.use(callback);\n\nexport const injectIntoHead = (key: string, value: Injection): void => {\n\theadInjections.set(key, value);\n};\n\nexport const addScript = (key: string, content: string): void => {\n\tif (/_/.test(key)) {\n\t\tthrow new Error('inject.js > addScript - key cannot contain \"_\" (underscore)');\n\t}\n\n\tif (!content.trim()) {\n\t\tinjectIntoHead(key, '');\n\t\treturn;\n\t}\n\tconst currentHash = crypto.createHash('sha1').update(content).digest('hex');\n\n\tinjectIntoHead(key, {\n\t\ttype: 'JS',\n\t\ttag: `<script id=\"${key}\" type=\"text/javascript\" src=\"${`${getURL(key)}_${currentHash}.js`}\"></script>`,\n\t\tcontent,\n\t});\n};\n\nexport const addStyle = (key: string, content: string): void => {\n\tif (/_/.test(key)) {\n\t\tthrow new Error('inject.js > addStyle - key cannot contain \"_\" (underscore)');\n\t}\n\n\tif (!content.trim()) {\n\t\tinjectIntoHead(key, '');\n\t\treturn;\n\t}\n\tconst currentHash = crypto.createHash('sha1').update(content).digest('hex');\n\n\tinjectIntoHead(key, {\n\t\ttype: 'CSS',\n\t\ttag: `<link id=\"${key}\" rel=\"stylesheet\" type=\"text/css\" href=\"${`${getURL(key)}_${currentHash}.css`}\">`,\n\t\tcontent,\n\t});\n};\n\nexport const injectIntoBody = (key: string, value: string): void => {\n\tInject.rawBody(key, value);\n};\n\nexport const applyHeadInjections = (injections: Injection[]): ((html: string) => string) => {\n\tif (injections.length === 0) {\n\t\treturn (html: string): string => html;\n\t}\n\n\tconst replacementHtml = `${injections\n\t\t.map((i) => {\n\t\t\tif (typeof i === 'string') {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t\treturn i.content.trim().length > 0 ? i.tag : '';\n\t\t})\n\t\t.join('\\n')\n\t\t.replace(/\\$/g, '$$$$')}\\n</head>`;\n\n\treturn (html: string): string => html.replace('</head>', replacementHtml);\n};\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true,"topLevelAwait":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/ui-master/server/inject.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/ui-master/server/inject.ts","inputSourceMap":{"version":3,"file":"app/ui-master/server/inject.ts","sourceRoot":"","sources":["app/ui-master/server/inject.ts"],"names":[],"mappings":"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","sourcesContent":["import crypto from 'crypto';\n\nimport type { NextHandleFunction } from 'connect';\nimport { Inject } from 'meteor/meteorhacks:inject-initial';\nimport { ReactiveDict } from 'meteor/reactive-dict';\nimport { WebApp } from 'meteor/webapp';\nimport parseRequest from 'parseurl';\n\nimport { getURL } from '../../utils/server/getURL';\n\ntype Injection =\n\t| string\n\t| {\n\t\t\tcontent: string;\n\t\t\ttype: 'JS' | 'CSS';\n\t\t\ttag: string;\n\t  };\n\nexport const headInjections = new ReactiveDict();\n\nconst callback: NextHandleFunction = (req, res, next) => {\n\tif (req.method !== 'GET' && req.method !== 'HEAD' && req.method !== 'OPTIONS') {\n\t\tnext();\n\t\treturn;\n\t}\n\ttry {\n\t\tconst rawPath = parseRequest(req);\n\t\tconst pathname = rawPath?.pathname && decodeURIComponent(rawPath.pathname);\n\n\t\tif (!pathname) {\n\t\t\tnext();\n\t\t\treturn;\n\t\t}\n\n\t\tconst injection = headInjections.get(pathname.replace(/^\\//, '').split('_')[0]) as Injection | undefined;\n\n\t\tif (!injection || typeof injection === 'string') {\n\t\t\tnext();\n\t\t\treturn;\n\t\t}\n\n\t\tconst serve =\n\t\t\t(contentType: string) =>\n\t\t\t(content: string, cacheControl = 'public, max-age=31536000'): void => {\n\t\t\t\tres.writeHead(200, {\n\t\t\t\t\t'Content-type': contentType,\n\t\t\t\t\t'cache-control': cacheControl,\n\t\t\t\t\t'Content-Length': content.length,\n\t\t\t\t});\n\t\t\t\tres.write(content);\n\t\t\t\tres.end();\n\t\t\t};\n\n\t\tconst serveStaticJS = serve('application/javascript; charset=UTF-8');\n\t\tconst serveStaticCSS = serve('text/css; charset=UTF-8');\n\n\t\tif (injection.type === 'JS') {\n\t\t\tserveStaticJS(injection.content);\n\t\t\treturn;\n\t\t}\n\n\t\tif (injection.type === 'CSS') {\n\t\t\tserveStaticCSS(injection.content);\n\t\t\treturn;\n\t\t}\n\t\tnext();\n\t} catch (e) {\n\t\tnext();\n\t}\n};\n\nWebApp.connectHandlers.use(callback);\n\nexport const injectIntoHead = (key: string, value: Injection): void => {\n\theadInjections.set(key, value);\n};\n\nexport const addScript = (key: string, content: string): void => {\n\tif (/_/.test(key)) {\n\t\tthrow new Error('inject.js > addScript - key cannot contain \"_\" (underscore)');\n\t}\n\n\tif (!content.trim()) {\n\t\tinjectIntoHead(key, '');\n\t\treturn;\n\t}\n\tconst currentHash = crypto.createHash('sha1').update(content).digest('hex');\n\n\tinjectIntoHead(key, {\n\t\ttype: 'JS',\n\t\ttag: `<script id=\"${key}\" type=\"text/javascript\" src=\"${`${getURL(key)}_${currentHash}.js`}\"></script>`,\n\t\tcontent,\n\t});\n};\n\nexport const addStyle = (key: string, content: string): void => {\n\tif (/_/.test(key)) {\n\t\tthrow new Error('inject.js > addStyle - key cannot contain \"_\" (underscore)');\n\t}\n\n\tif (!content.trim()) {\n\t\tinjectIntoHead(key, '');\n\t\treturn;\n\t}\n\tconst currentHash = crypto.createHash('sha1').update(content).digest('hex');\n\n\tinjectIntoHead(key, {\n\t\ttype: 'CSS',\n\t\ttag: `<link id=\"${key}\" rel=\"stylesheet\" type=\"text/css\" href=\"${`${getURL(key)}_${currentHash}.css`}\">`,\n\t\tcontent,\n\t});\n};\n\nexport const injectIntoBody = (key: string, value: string): void => {\n\tInject.rawBody(key, value);\n};\n\nexport const applyHeadInjections = (injections: Injection[]): ((html: string) => string) => {\n\tif (injections.length === 0) {\n\t\treturn (html: string): string => html;\n\t}\n\n\tconst replacementHtml = `${injections\n\t\t.map((i) => {\n\t\t\tif (typeof i === 'string') {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t\treturn i.content.trim().length > 0 ? i.tag : '';\n\t\t})\n\t\t.join('\\n')\n\t\t.replace(/\\$/g, '$$$$')}\\n</head>`;\n\n\treturn (html: string): string => html.replace('</head>', replacementHtml);\n};\n"]}}},"code":"!module.wrapAsync(async function (module, __reifyWaitForDeps__, __reify_async_result__) {\n  \"use strict\";\n  try {\n    module.export({\n      headInjections: () => headInjections,\n      injectIntoHead: () => injectIntoHead,\n      addScript: () => addScript,\n      addStyle: () => addStyle,\n      injectIntoBody: () => injectIntoBody,\n      applyHeadInjections: () => applyHeadInjections\n    });\n    let crypto;\n    module.link(\"crypto\", {\n      default(v) {\n        crypto = v;\n      }\n    }, 0);\n    let Inject;\n    module.link(\"meteor/meteorhacks:inject-initial\", {\n      Inject(v) {\n        Inject = v;\n      }\n    }, 1);\n    let ReactiveDict;\n    module.link(\"meteor/reactive-dict\", {\n      ReactiveDict(v) {\n        ReactiveDict = v;\n      }\n    }, 2);\n    let WebApp;\n    module.link(\"meteor/webapp\", {\n      WebApp(v) {\n        WebApp = v;\n      }\n    }, 3);\n    let parseRequest;\n    module.link(\"parseurl\", {\n      default(v) {\n        parseRequest = v;\n      }\n    }, 4);\n    let getURL;\n    module.link(\"../../utils/server/getURL\", {\n      getURL(v) {\n        getURL = v;\n      }\n    }, 5);\n    if (__reifyWaitForDeps__()) (await __reifyWaitForDeps__())();\n    const headInjections = new ReactiveDict();\n    const callback = (req, res, next) => {\n      if (req.method !== 'GET' && req.method !== 'HEAD' && req.method !== 'OPTIONS') {\n        next();\n        return;\n      }\n      try {\n        const rawPath = parseRequest(req);\n        const pathname = (rawPath === null || rawPath === void 0 ? void 0 : rawPath.pathname) && decodeURIComponent(rawPath.pathname);\n        if (!pathname) {\n          next();\n          return;\n        }\n        const injection = headInjections.get(pathname.replace(/^\\//, '').split('_')[0]);\n        if (!injection || typeof injection === 'string') {\n          next();\n          return;\n        }\n        const serve = contentType => function (content) {\n          let cacheControl = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'public, max-age=31536000';\n          res.writeHead(200, {\n            'Content-type': contentType,\n            'cache-control': cacheControl,\n            'Content-Length': content.length\n          });\n          res.write(content);\n          res.end();\n        };\n        const serveStaticJS = serve('application/javascript; charset=UTF-8');\n        const serveStaticCSS = serve('text/css; charset=UTF-8');\n        if (injection.type === 'JS') {\n          serveStaticJS(injection.content);\n          return;\n        }\n        if (injection.type === 'CSS') {\n          serveStaticCSS(injection.content);\n          return;\n        }\n        next();\n      } catch (e) {\n        next();\n      }\n    };\n    WebApp.connectHandlers.use(callback);\n    const injectIntoHead = (key, value) => {\n      headInjections.set(key, value);\n    };\n    const addScript = (key, content) => {\n      if (/_/.test(key)) {\n        throw new Error('inject.js > addScript - key cannot contain \"_\" (underscore)');\n      }\n      if (!content.trim()) {\n        injectIntoHead(key, '');\n        return;\n      }\n      const currentHash = crypto.createHash('sha1').update(content).digest('hex');\n      injectIntoHead(key, {\n        type: 'JS',\n        tag: \"<script id=\\\"\".concat(key, \"\\\" type=\\\"text/javascript\\\" src=\\\"\", \"\".concat(getURL(key), \"_\").concat(currentHash, \".js\"), \"\\\"></script>\"),\n        content\n      });\n    };\n    const addStyle = (key, content) => {\n      if (/_/.test(key)) {\n        throw new Error('inject.js > addStyle - key cannot contain \"_\" (underscore)');\n      }\n      if (!content.trim()) {\n        injectIntoHead(key, '');\n        return;\n      }\n      const currentHash = crypto.createHash('sha1').update(content).digest('hex');\n      injectIntoHead(key, {\n        type: 'CSS',\n        tag: \"<link id=\\\"\".concat(key, \"\\\" rel=\\\"stylesheet\\\" type=\\\"text/css\\\" href=\\\"\", \"\".concat(getURL(key), \"_\").concat(currentHash, \".css\"), \"\\\">\"),\n        content\n      });\n    };\n    const injectIntoBody = (key, value) => {\n      Inject.rawBody(key, value);\n    };\n    const applyHeadInjections = injections => {\n      if (injections.length === 0) {\n        return html => html;\n      }\n      const replacementHtml = \"\".concat(injections.map(i => {\n        if (typeof i === 'string') {\n          return i;\n        }\n        return i.content.trim().length > 0 ? i.tag : '';\n      }).join('\\n').replace(/\\$/g, '$$$$'), \"\\n</head>\");\n      return html => html.replace('</head>', replacementHtml);\n    };\n    __reify_async_result__();\n  } catch (_reifyError) {\n    return __reify_async_result__(_reifyError);\n  }\n  __reify_async_result__()\n}, {\n  self: this,\n  async: false\n});","map":{"version":3,"names":["module","export","headInjections","injectIntoHead","addScript","addStyle","injectIntoBody","applyHeadInjections","crypto","link","default","v","Inject","ReactiveDict","WebApp","parseRequest","getURL","__reifyWaitForDeps__","callback","req","res","next","method","rawPath","pathname","decodeURIComponent","injection","get","replace","split","serve","contentType","content","cacheControl","arguments","length","undefined","writeHead","write","end","serveStaticJS","serveStaticCSS","type","e","connectHandlers","use","key","value","set","test","Error","trim","currentHash","createHash","update","digest","tag","concat","rawBody","injections","html","replacementHtml","map","i","join","__reify_async_result__","_reifyError","self","async"],"sources":["app/ui-master/server/inject.ts"],"sourcesContent":["import crypto from 'crypto';\n\nimport type { NextHandleFunction } from 'connect';\nimport { Inject } from 'meteor/meteorhacks:inject-initial';\nimport { ReactiveDict } from 'meteor/reactive-dict';\nimport { WebApp } from 'meteor/webapp';\nimport parseRequest from 'parseurl';\n\nimport { getURL } from '../../utils/server/getURL';\n\ntype Injection =\n\t| string\n\t| {\n\t\t\tcontent: string;\n\t\t\ttype: 'JS' | 'CSS';\n\t\t\ttag: string;\n\t  };\n\nexport const headInjections = new ReactiveDict();\n\nconst callback: NextHandleFunction = (req, res, next) => {\n\tif (req.method !== 'GET' && req.method !== 'HEAD' && req.method !== 'OPTIONS') {\n\t\tnext();\n\t\treturn;\n\t}\n\ttry {\n\t\tconst rawPath = parseRequest(req);\n\t\tconst pathname = rawPath?.pathname && decodeURIComponent(rawPath.pathname);\n\n\t\tif (!pathname) {\n\t\t\tnext();\n\t\t\treturn;\n\t\t}\n\n\t\tconst injection = headInjections.get(pathname.replace(/^\\//, '').split('_')[0]) as Injection | undefined;\n\n\t\tif (!injection || typeof injection === 'string') {\n\t\t\tnext();\n\t\t\treturn;\n\t\t}\n\n\t\tconst serve =\n\t\t\t(contentType: string) =>\n\t\t\t(content: string, cacheControl = 'public, max-age=31536000'): void => {\n\t\t\t\tres.writeHead(200, {\n\t\t\t\t\t'Content-type': contentType,\n\t\t\t\t\t'cache-control': cacheControl,\n\t\t\t\t\t'Content-Length': content.length,\n\t\t\t\t});\n\t\t\t\tres.write(content);\n\t\t\t\tres.end();\n\t\t\t};\n\n\t\tconst serveStaticJS = serve('application/javascript; charset=UTF-8');\n\t\tconst serveStaticCSS = serve('text/css; charset=UTF-8');\n\n\t\tif (injection.type === 'JS') {\n\t\t\tserveStaticJS(injection.content);\n\t\t\treturn;\n\t\t}\n\n\t\tif (injection.type === 'CSS') {\n\t\t\tserveStaticCSS(injection.content);\n\t\t\treturn;\n\t\t}\n\t\tnext();\n\t} catch (e) {\n\t\tnext();\n\t}\n};\n\nWebApp.connectHandlers.use(callback);\n\nexport const injectIntoHead = (key: string, value: Injection): void => {\n\theadInjections.set(key, value);\n};\n\nexport const addScript = (key: string, content: string): void => {\n\tif (/_/.test(key)) {\n\t\tthrow new Error('inject.js > addScript - key cannot contain \"_\" (underscore)');\n\t}\n\n\tif (!content.trim()) {\n\t\tinjectIntoHead(key, '');\n\t\treturn;\n\t}\n\tconst currentHash = crypto.createHash('sha1').update(content).digest('hex');\n\n\tinjectIntoHead(key, {\n\t\ttype: 'JS',\n\t\ttag: `<script id=\"${key}\" type=\"text/javascript\" src=\"${`${getURL(key)}_${currentHash}.js`}\"></script>`,\n\t\tcontent,\n\t});\n};\n\nexport const addStyle = (key: string, content: string): void => {\n\tif (/_/.test(key)) {\n\t\tthrow new Error('inject.js > addStyle - key cannot contain \"_\" (underscore)');\n\t}\n\n\tif (!content.trim()) {\n\t\tinjectIntoHead(key, '');\n\t\treturn;\n\t}\n\tconst currentHash = crypto.createHash('sha1').update(content).digest('hex');\n\n\tinjectIntoHead(key, {\n\t\ttype: 'CSS',\n\t\ttag: `<link id=\"${key}\" rel=\"stylesheet\" type=\"text/css\" href=\"${`${getURL(key)}_${currentHash}.css`}\">`,\n\t\tcontent,\n\t});\n};\n\nexport const injectIntoBody = (key: string, value: string): void => {\n\tInject.rawBody(key, value);\n};\n\nexport const applyHeadInjections = (injections: Injection[]): ((html: string) => string) => {\n\tif (injections.length === 0) {\n\t\treturn (html: string): string => html;\n\t}\n\n\tconst replacementHtml = `${injections\n\t\t.map((i) => {\n\t\t\tif (typeof i === 'string') {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t\treturn i.content.trim().length > 0 ? i.tag : '';\n\t\t})\n\t\t.join('\\n')\n\t\t.replace(/\\$/g, '$$$$')}\\n</head>`;\n\n\treturn (html: string): string => html.replace('</head>', replacementHtml);\n};\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"2c7e09c3c4aab7514ecb036079f05c3e36bd5739"}
