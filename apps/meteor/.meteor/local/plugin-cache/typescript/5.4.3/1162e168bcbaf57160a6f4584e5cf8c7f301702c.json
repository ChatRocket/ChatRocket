{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBox.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/room/composer/messageBox/MessageBox.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBox.tsx","inputSourceMap":{"version":3,"file":"client/views/room/composer/messageBox/MessageBox.tsx","sourceRoot":"","sources":["client/views/room/composer/messageBox/MessageBox.tsx"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable complexity */\nimport type { IMessage, ISubscription } from '@rocket.chat/core-typings';\nimport { useContentBoxSize, useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport {\n\tMessageComposerAction,\n\tMessageComposerToolbarActions,\n\tMessageComposer,\n\tMessageComposerInput,\n\tMessageComposerToolbar,\n\tMessageComposerActionsDivider,\n\tMessageComposerToolbarSubmit,\n\tMessageComposerButton,\n} from '@rocket.chat/ui-composer';\nimport { useTranslation, useUserPreference, useLayout, useSetting } from '@rocket.chat/ui-contexts';\nimport { useMutation } from '@tanstack/react-query';\nimport type { ReactElement, MouseEventHandler, FormEvent, ClipboardEventHandler, MouseEvent } from 'react';\nimport React, { memo, useRef, useReducer, useCallback } from 'react';\nimport { useSubscription } from 'use-subscription';\n\nimport { createComposerAPI } from '../../../../../app/ui-message/client/messageBox/createComposerAPI';\nimport type { FormattingButton } from '../../../../../app/ui-message/client/messageBox/messageBoxFormatting';\nimport { formattingButtons } from '../../../../../app/ui-message/client/messageBox/messageBoxFormatting';\nimport { getImageExtensionFromMime } from '../../../../../lib/getImageExtensionFromMime';\nimport { useFormatDateAndTime } from '../../../../hooks/useFormatDateAndTime';\nimport { useReactiveValue } from '../../../../hooks/useReactiveValue';\nimport type { ComposerAPI } from '../../../../lib/chats/ChatAPI';\nimport { roomCoordinator } from '../../../../lib/rooms/roomCoordinator';\nimport { keyCodes } from '../../../../lib/utils/keyCodes';\nimport AudioMessageRecorder from '../../../composer/AudioMessageRecorder';\nimport VideoMessageRecorder from '../../../composer/VideoMessageRecorder';\nimport { useChat } from '../../contexts/ChatContext';\nimport { useComposerPopup } from '../../contexts/ComposerPopupContext';\nimport { useRoom } from '../../contexts/RoomContext';\nimport ComposerBoxPopup from '../ComposerBoxPopup';\nimport ComposerBoxPopupPreview from '../ComposerBoxPopupPreview';\nimport ComposerUserActionIndicator from '../ComposerUserActionIndicator';\nimport { useAutoGrow } from '../RoomComposer/hooks/useAutoGrow';\nimport { useComposerBoxPopup } from '../hooks/useComposerBoxPopup';\nimport { useEnablePopupPreview } from '../hooks/useEnablePopupPreview';\nimport { useMessageComposerMergedRefs } from '../hooks/useMessageComposerMergedRefs';\nimport MessageBoxActionsToolbar from './MessageBoxActionsToolbar';\nimport MessageBoxFormattingToolbar from './MessageBoxFormattingToolbar';\nimport MessageBoxHint from './MessageBoxHint';\nimport MessageBoxReplies from './MessageBoxReplies';\nimport { useMessageBoxAutoFocus } from './hooks/useMessageBoxAutoFocus';\nimport { useMessageBoxPlaceholder } from './hooks/useMessageBoxPlaceholder';\n\nconst reducer = (_: unknown, event: FormEvent<HTMLInputElement>): boolean => {\n\tconst target = event.target as HTMLInputElement;\n\n\treturn Boolean(target.value.trim());\n};\n\nconst handleFormattingShortcut = (event: KeyboardEvent, formattingButtons: FormattingButton[], composer: ComposerAPI) => {\n\tconst isMacOS = navigator.platform.indexOf('Mac') !== -1;\n\tconst isCmdOrCtrlPressed = (isMacOS && event.metaKey) || (!isMacOS && event.ctrlKey);\n\n\tif (!isCmdOrCtrlPressed) {\n\t\treturn false;\n\t}\n\n\tconst key = event.key.toLowerCase();\n\n\tconst formatter = formattingButtons.find((formatter) => 'command' in formatter && formatter.command === key);\n\n\tif (!formatter || !('pattern' in formatter)) {\n\t\treturn false;\n\t}\n\n\tcomposer.wrapSelection(formatter.pattern);\n\treturn true;\n};\n\nconst emptySubscribe = () => () => undefined;\nconst getEmptyFalse = () => false;\nconst a: any[] = [];\nconst getEmptyArray = () => a;\n\ntype MessageBoxProps = {\n\ttmid?: IMessage['_id'];\n\tonSend?: (params: { value: string; tshow?: boolean; previewUrls?: string[]; isSlashCommandAllowed?: boolean }) => Promise<void>;\n\tonJoin?: () => Promise<void>;\n\tonResize?: () => void;\n\tonTyping?: () => void;\n\tonEscape?: () => void;\n\tonNavigateToPreviousMessage?: () => void;\n\tonNavigateToNextMessage?: () => void;\n\tonUploadFiles?: (files: readonly File[]) => void;\n\ttshow?: IMessage['tshow'];\n\tpreviewUrls?: string[];\n\tsubscription?: ISubscription;\n\tshowFormattingTips: boolean;\n\tisEmbedded?: boolean;\n};\n\nconst MessageBox = ({\n\ttmid,\n\tonSend,\n\tonJoin,\n\tonNavigateToNextMessage,\n\tonNavigateToPreviousMessage,\n\tonUploadFiles,\n\tonEscape,\n\tonTyping,\n\ttshow,\n\tpreviewUrls,\n}: MessageBoxProps): ReactElement => {\n\tconst chat = useChat();\n\tconst room = useRoom();\n\tconst t = useTranslation();\n\tconst e2eEnabled = useSetting<boolean>('E2E_Enable');\n\tconst unencryptedMessagesAllowed = useSetting<boolean>('E2E_Allow_Unencrypted_Messages');\n\tconst isSlashCommandAllowed = !e2eEnabled || !room.encrypted || unencryptedMessagesAllowed;\n\tconst composerPlaceholder = useMessageBoxPlaceholder(t('Message'), room);\n\n\tconst [typing, setTyping] = useReducer(reducer, false);\n\n\tconst { isMobile } = useLayout();\n\tconst sendOnEnterBehavior = useUserPreference<'normal' | 'alternative' | 'desktop'>('sendOnEnter') || isMobile;\n\tconst sendOnEnter = sendOnEnterBehavior == null || sendOnEnterBehavior === 'normal' || (sendOnEnterBehavior === 'desktop' && !isMobile);\n\n\tif (!chat) {\n\t\tthrow new Error('Chat context not found');\n\t}\n\n\tconst textareaRef = useRef<HTMLTextAreaElement>(null);\n\tconst messageComposerRef = useRef<HTMLElement>(null);\n\tconst shadowRef = useRef<HTMLDivElement>(null);\n\n\tconst storageID = `messagebox_${room._id}${tmid ? `-${tmid}` : ''}`;\n\n\tconst callbackRef = useCallback(\n\t\t(node: HTMLTextAreaElement) => {\n\t\t\tif (node === null || chat.composer) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tchat.setComposerAPI(createComposerAPI(node, storageID));\n\t\t},\n\t\t[chat, storageID],\n\t);\n\n\tconst autofocusRef = useMessageBoxAutoFocus(!isMobile);\n\n\tconst useEmojis = useUserPreference<boolean>('useEmojis');\n\n\tconst handleOpenEmojiPicker: MouseEventHandler<HTMLElement> = useMutableCallback((e) => {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\n\t\tif (!useEmojis) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst ref = messageComposerRef.current as HTMLElement;\n\t\tchat.emojiPicker.open(ref, (emoji: string) => chat.composer?.insertText(` :${emoji}: `));\n\t});\n\n\tconst handleSendMessage = useMutableCallback(() => {\n\t\tconst text = chat.composer?.text ?? '';\n\t\tchat.composer?.clear();\n\t\tclearPopup();\n\n\t\tonSend?.({\n\t\t\tvalue: text,\n\t\t\ttshow,\n\t\t\tpreviewUrls,\n\t\t\tisSlashCommandAllowed,\n\t\t});\n\t});\n\n\tconst closeEditing = (event: KeyboardEvent | MouseEvent<HTMLElement>) => {\n\t\tif (chat.currentEditing) {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\n\t\t\tchat.currentEditing.reset().then((reset) => {\n\t\t\t\tif (!reset) {\n\t\t\t\t\tchat.currentEditing?.cancel();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\tconst handler = useMutableCallback((event: KeyboardEvent) => {\n\t\tconst { which: keyCode } = event;\n\n\t\tconst input = event.target as HTMLTextAreaElement;\n\n\t\tconst isSubmitKey = keyCode === keyCodes.CARRIAGE_RETURN || keyCode === keyCodes.NEW_LINE;\n\n\t\tif (isSubmitKey) {\n\t\t\tconst withModifier = event.shiftKey || event.ctrlKey || event.altKey || event.metaKey;\n\t\t\tconst isSending = (sendOnEnter && !withModifier) || (!sendOnEnter && withModifier);\n\n\t\t\tevent.preventDefault();\n\t\t\tif (!isSending) {\n\t\t\t\tchat.composer?.insertNewLine();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\thandleSendMessage();\n\t\t\treturn false;\n\t\t}\n\n\t\tif (chat.composer && handleFormattingShortcut(event, [...formattingButtons], chat.composer)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.shiftKey || event.ctrlKey || event.metaKey) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (event.key) {\n\t\t\tcase 'Escape': {\n\t\t\t\tcloseEditing(event);\n\t\t\t\tif (!input.value.trim()) onEscape?.();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcase 'ArrowUp': {\n\t\t\t\tif (input.selectionEnd === 0) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\n\t\t\t\t\tonNavigateToPreviousMessage?.();\n\n\t\t\t\t\tif (event.altKey) {\n\t\t\t\t\t\tinput.setSelectionRange(0, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcase 'ArrowDown': {\n\t\t\t\tif (input.selectionEnd === input.value.length) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\n\t\t\t\t\tonNavigateToNextMessage?.();\n\n\t\t\t\t\tif (event.altKey) {\n\t\t\t\t\t\tinput.setSelectionRange(input.value.length, input.value.length);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tonTyping?.();\n\t});\n\n\tconst isEditing = useSubscription({\n\t\tgetCurrentValue: chat.composer?.editing.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.editing.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecordingAudio = useSubscription({\n\t\tgetCurrentValue: chat.composer?.recording.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.recording.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isMicrophoneDenied = useSubscription({\n\t\tgetCurrentValue: chat.composer?.isMicrophoneDenied.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.isMicrophoneDenied.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecordingVideo = useSubscription({\n\t\tgetCurrentValue: chat.composer?.recordingVideo.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.recordingVideo.subscribe ?? emptySubscribe,\n\t});\n\n\tconst formatters = useSubscription({\n\t\tgetCurrentValue: chat.composer?.formatters.get ?? getEmptyArray,\n\t\tsubscribe: chat.composer?.formatters.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecording = isRecordingAudio || isRecordingVideo;\n\n\tconst { textAreaStyle, shadowStyle } = useAutoGrow(textareaRef, shadowRef, isRecordingAudio);\n\n\tconst canSend = useReactiveValue(useCallback(() => roomCoordinator.verifyCanSendMessage(room._id), [room._id]));\n\n\tconst sizes = useContentBoxSize(textareaRef);\n\n\tconst format = useFormatDateAndTime();\n\n\tconst joinMutation = useMutation(async () => onJoin?.());\n\n\tconst handlePaste: ClipboardEventHandler<HTMLTextAreaElement> = useMutableCallback((event) => {\n\t\tconst { clipboardData } = event;\n\n\t\tif (!clipboardData) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst items = Array.from(clipboardData.items);\n\n\t\tif (items.some(({ kind, type }) => kind === 'string' && type === 'text/plain')) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst files = items\n\t\t\t.filter((item) => item.kind === 'file' && item.type.indexOf('image/') !== -1)\n\t\t\t.map((item) => {\n\t\t\t\tconst fileItem = item.getAsFile();\n\n\t\t\t\tif (!fileItem) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst imageExtension = fileItem ? getImageExtensionFromMime(fileItem.type) : undefined;\n\n\t\t\t\tconst extension = imageExtension ? `.${imageExtension}` : '';\n\n\t\t\t\tObject.defineProperty(fileItem, 'name', {\n\t\t\t\t\twritable: true,\n\t\t\t\t\tvalue: `Clipboard - ${format(new Date())}${extension}`,\n\t\t\t\t});\n\t\t\t\treturn fileItem;\n\t\t\t})\n\t\t\t.filter((file): file is File => !!file);\n\n\t\tif (files.length) {\n\t\t\tevent.preventDefault();\n\t\t\tonUploadFiles?.(files);\n\t\t}\n\t});\n\n\tconst composerPopupConfig = useComposerPopup();\n\n\tconst {\n\t\tpopup,\n\t\tfocused,\n\t\titems,\n\t\tariaActiveDescendant,\n\t\tsuspended,\n\t\tselect,\n\t\tcommandsRef,\n\t\tcallbackRef: c,\n\t\tfilter,\n\t\tclearPopup,\n\t} = useComposerBoxPopup<{ _id: string; sort?: number }>({\n\t\tconfigurations: composerPopupConfig,\n\t});\n\n\tconst keyDownHandlerCallbackRef = useCallback(\n\t\t(node: HTMLTextAreaElement) => {\n\t\t\tif (node === null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tnode.addEventListener('keydown', (e: KeyboardEvent) => {\n\t\t\t\thandler(e);\n\t\t\t});\n\t\t},\n\t\t[handler],\n\t);\n\n\tconst mergedRefs = useMessageComposerMergedRefs(c, textareaRef, callbackRef, autofocusRef, keyDownHandlerCallbackRef);\n\n\tconst shouldPopupPreview = useEnablePopupPreview(filter, popup);\n\n\treturn (\n\t\t<>\n\t\t\t{chat.composer?.quotedMessages && <MessageBoxReplies />}\n\t\t\t{shouldPopupPreview && popup && (\n\t\t\t\t<ComposerBoxPopup select={select} items={items} focused={focused} title={popup.title} renderItem={popup.renderItem} />\n\t\t\t)}\n\t\t\t{/*\n\t\t\t\tSlashCommand Preview popup works in a weird way\n\t\t\t\tThere is only one trigger for all the commands: \"/\"\n\t\t\t\tAfter that we need to the slashcommand list and check if the command exists and provide the preview\n\t\t\t\tif not the query is `suspend` which means the slashcommand is not found or doesn't have a preview\n\t\t\t*/}\n\t\t\t{popup?.preview && (\n\t\t\t\t<ComposerBoxPopupPreview\n\t\t\t\t\tselect={select}\n\t\t\t\t\titems={items as any}\n\t\t\t\t\tfocused={focused as any}\n\t\t\t\t\trenderItem={popup.renderItem}\n\t\t\t\t\tref={commandsRef}\n\t\t\t\t\trid={room._id}\n\t\t\t\t\ttmid={tmid}\n\t\t\t\t\tsuspended={suspended}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t<MessageBoxHint\n\t\t\t\tisEditing={isEditing}\n\t\t\t\te2eEnabled={e2eEnabled}\n\t\t\t\tunencryptedMessagesAllowed={unencryptedMessagesAllowed}\n\t\t\t\tisMobile={isMobile}\n\t\t\t/>\n\t\t\t{isRecordingVideo && <VideoMessageRecorder reference={messageComposerRef} rid={room._id} tmid={tmid} />}\n\t\t\t<MessageComposer ref={messageComposerRef} variant={isEditing ? 'editing' : undefined}>\n\t\t\t\t{isRecordingAudio && <AudioMessageRecorder rid={room._id} isMicrophoneDenied={isMicrophoneDenied} />}\n\t\t\t\t<MessageComposerInput\n\t\t\t\t\tref={mergedRefs}\n\t\t\t\t\taria-label={composerPlaceholder}\n\t\t\t\t\tname='msg'\n\t\t\t\t\tdisabled={isRecording || !canSend}\n\t\t\t\t\tonChange={setTyping}\n\t\t\t\t\tstyle={textAreaStyle}\n\t\t\t\t\tplaceholder={composerPlaceholder}\n\t\t\t\t\tonPaste={handlePaste}\n\t\t\t\t\taria-activedescendant={ariaActiveDescendant}\n\t\t\t\t/>\n\t\t\t\t<div ref={shadowRef} style={shadowStyle} />\n\t\t\t\t<MessageComposerToolbar>\n\t\t\t\t\t<MessageComposerToolbarActions aria-label={t('Message_composer_toolbox_primary_actions')}>\n\t\t\t\t\t\t<MessageComposerAction\n\t\t\t\t\t\t\ticon='emoji'\n\t\t\t\t\t\t\tdisabled={!useEmojis || isRecording || !canSend}\n\t\t\t\t\t\t\tonClick={handleOpenEmojiPicker}\n\t\t\t\t\t\t\ttitle={t('Emoji')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<MessageComposerActionsDivider />\n\t\t\t\t\t\t{chat.composer && formatters.length > 0 && (\n\t\t\t\t\t\t\t<MessageBoxFormattingToolbar\n\t\t\t\t\t\t\t\tcomposer={chat.composer}\n\t\t\t\t\t\t\t\tvariant={sizes.inlineSize < 480 ? 'small' : 'large'}\n\t\t\t\t\t\t\t\titems={formatters}\n\t\t\t\t\t\t\t\tdisabled={isRecording || !canSend}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<MessageBoxActionsToolbar\n\t\t\t\t\t\t\tcanSend={canSend}\n\t\t\t\t\t\t\ttyping={typing}\n\t\t\t\t\t\t\tisMicrophoneDenied={isMicrophoneDenied}\n\t\t\t\t\t\t\trid={room._id}\n\t\t\t\t\t\t\ttmid={tmid}\n\t\t\t\t\t\t\tisRecording={isRecording}\n\t\t\t\t\t\t\tvariant={sizes.inlineSize < 480 ? 'small' : 'large'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</MessageComposerToolbarActions>\n\t\t\t\t\t<MessageComposerToolbarSubmit>\n\t\t\t\t\t\t{!canSend && (\n\t\t\t\t\t\t\t<MessageComposerButton primary onClick={onJoin} loading={joinMutation.isLoading}>\n\t\t\t\t\t\t\t\t{t('Join')}\n\t\t\t\t\t\t\t</MessageComposerButton>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{canSend && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{isEditing && <MessageComposerButton onClick={closeEditing}>{t('Cancel')}</MessageComposerButton>}\n\t\t\t\t\t\t\t\t<MessageComposerAction\n\t\t\t\t\t\t\t\t\taria-label={t('Send')}\n\t\t\t\t\t\t\t\t\ticon='send'\n\t\t\t\t\t\t\t\t\tdisabled={!canSend || (!typing && !isEditing)}\n\t\t\t\t\t\t\t\t\tonClick={handleSendMessage}\n\t\t\t\t\t\t\t\t\tsecondary={typing || isEditing}\n\t\t\t\t\t\t\t\t\tinfo={typing || isEditing}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</MessageComposerToolbarSubmit>\n\t\t\t\t</MessageComposerToolbar>\n\t\t\t</MessageComposer>\n\t\t\t<ComposerUserActionIndicator rid={room._id} tmid={tmid} />\n\t\t</>\n\t);\n};\n\nexport default memo(MessageBox);\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBox.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/composer/messageBox/MessageBox.tsx","inputSourceMap":{"version":3,"file":"client/views/room/composer/messageBox/MessageBox.tsx","sourceRoot":"","sources":["client/views/room/composer/messageBox/MessageBox.tsx"],"names":[],"mappings":"AAEA,OAAO,EAAE,iBAAiB,EAAE,kBAAkB,EAAE,MAAM,6BAA6B,CAAC;AACpF,OAAO,EACN,qBAAqB,EACrB,6BAA6B,EAC7B,eAAe,EACf,oBAAoB,EACpB,sBAAsB,EACtB,6BAA6B,EAC7B,4BAA4B,EAC5B,qBAAqB,GACrB,MAAM,0BAA0B,CAAC;AAClC,OAAO,EAAE,cAAc,EAAE,iBAAiB,EAAE,SAAS,EAAE,UAAU,EAAE,MAAM,0BAA0B,CAAC;AACpG,OAAO,EAAE,WAAW,EAAE,MAAM,uBAAuB,CAAC;AAEpD,OAAO,KAAK,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,UAAU,EAAE,WAAW,EAAE,MAAM,OAAO,CAAC;AACrE,OAAO,EAAE,eAAe,EAAE,MAAM,kBAAkB,CAAC;AAEnD,OAAO,EAAE,iBAAiB,EAAE,MAAM,mEAAmE,CAAC;AAEtG,OAAO,EAAE,iBAAiB,EAAE,MAAM,sEAAsE,CAAC;AACzG,OAAO,EAAE,yBAAyB,EAAE,MAAM,8CAA8C,CAAC;AACzF,OAAO,EAAE,oBAAoB,EAAE,MAAM,wCAAwC,CAAC;AAC9E,OAAO,EAAE,gBAAgB,EAAE,MAAM,oCAAoC,CAAC;AAEtE,OAAO,EAAE,eAAe,EAAE,MAAM,uCAAuC,CAAC;AACxE,OAAO,EAAE,QAAQ,EAAE,MAAM,gCAAgC,CAAC;AAC1D,OAAO,oBAAoB,MAAM,wCAAwC,CAAC;AAC1E,OAAO,oBAAoB,MAAM,wCAAwC,CAAC;AAC1E,OAAO,EAAE,OAAO,EAAE,MAAM,4BAA4B,CAAC;AACrD,OAAO,EAAE,gBAAgB,EAAE,MAAM,qCAAqC,CAAC;AACvE,OAAO,EAAE,OAAO,EAAE,MAAM,4BAA4B,CAAC;AACrD,OAAO,gBAAgB,MAAM,qBAAqB,CAAC;AACnD,OAAO,uBAAuB,MAAM,4BAA4B,CAAC;AACjE,OAAO,2BAA2B,MAAM,gCAAgC,CAAC;AACzE,OAAO,EAAE,WAAW,EAAE,MAAM,mCAAmC,CAAC;AAChE,OAAO,EAAE,mBAAmB,EAAE,MAAM,8BAA8B,CAAC;AACnE,OAAO,EAAE,qBAAqB,EAAE,MAAM,gCAAgC,CAAC;AACvE,OAAO,EAAE,4BAA4B,EAAE,MAAM,uCAAuC,CAAC;AACrF,OAAO,wBAAwB,MAAM,4BAA4B,CAAC;AAClE,OAAO,2BAA2B,MAAM,+BAA+B,CAAC;AACxE,OAAO,cAAc,MAAM,kBAAkB,CAAC;AAC9C,OAAO,iBAAiB,MAAM,qBAAqB,CAAC;AACpD,OAAO,EAAE,sBAAsB,EAAE,MAAM,gCAAgC,CAAC;AACxE,OAAO,EAAE,wBAAwB,EAAE,MAAM,kCAAkC,CAAC;AAE5E,MAAM,OAAO,GAAG,CAAC,CAAU,EAAE,KAAkC,EAAW,EAAE;IAC3E,MAAM,MAAM,GAAG,KAAK,CAAC,MAA0B,CAAC;IAEhD,OAAO,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC;AACrC,CAAC,CAAC;AAEF,MAAM,wBAAwB,GAAG,CAAC,KAAoB,EAAE,iBAAqC,EAAE,QAAqB,EAAE,EAAE;IACvH,MAAM,OAAO,GAAG,SAAS,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC;IACzD,MAAM,kBAAkB,GAAG,CAAC,OAAO,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,OAAO,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC;IAErF,IAAI,CAAC,kBAAkB,EAAE,CAAC;QACzB,OAAO,KAAK,CAAC;IACd,CAAC;IAED,MAAM,GAAG,GAAG,KAAK,CAAC,GAAG,CAAC,WAAW,EAAE,CAAC;IAEpC,MAAM,SAAS,GAAG,iBAAiB,CAAC,IAAI,CAAC,CAAC,SAAS,EAAE,EAAE,CAAC,SAAS,IAAI,SAAS,IAAI,SAAS,CAAC,OAAO,KAAK,GAAG,CAAC,CAAC;IAE7G,IAAI,CAAC,SAAS,IAAI,CAAC,CAAC,SAAS,IAAI,SAAS,CAAC,EAAE,CAAC;QAC7C,OAAO,KAAK,CAAC;IACd,CAAC;IAED,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;IAC1C,OAAO,IAAI,CAAC;AACb,CAAC,CAAC;AAEF,MAAM,cAAc,GAAG,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,SAAS,CAAC;AAC7C,MAAM,aAAa,GAAG,GAAG,EAAE,CAAC,KAAK,CAAC;AAClC,MAAM,CAAC,GAAU,EAAE,CAAC;AACpB,MAAM,aAAa,GAAG,GAAG,EAAE,CAAC,CAAC,CAAC;AAmB9B,MAAM,UAAU,GAAG,CAAC,EACnB,IAAI,EACJ,MAAM,EACN,MAAM,EACN,uBAAuB,EACvB,2BAA2B,EAC3B,aAAa,EACb,QAAQ,EACR,QAAQ,EACR,KAAK,EACL,WAAW,GACM,EAAgB,EAAE;IACnC,MAAM,IAAI,GAAG,OAAO,EAAE,CAAC;IACvB,MAAM,IAAI,GAAG,OAAO,EAAE,CAAC;IACvB,MAAM,CAAC,GAAG,cAAc,EAAE,CAAC;IAC3B,MAAM,UAAU,GAAG,UAAU,CAAU,YAAY,CAAC,CAAC;IACrD,MAAM,0BAA0B,GAAG,UAAU,CAAU,gCAAgC,CAAC,CAAC;IACzF,MAAM,qBAAqB,GAAG,CAAC,UAAU,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI,0BAA0B,CAAC;IAC3F,MAAM,mBAAmB,GAAG,wBAAwB,CAAC,CAAC,CAAC,SAAS,CAAC,EAAE,IAAI,CAAC,CAAC;IAEzE,MAAM,CAAC,MAAM,EAAE,SAAS,CAAC,GAAG,UAAU,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;IAEvD,MAAM,EAAE,QAAQ,EAAE,GAAG,SAAS,EAAE,CAAC;IACjC,MAAM,mBAAmB,GAAG,iBAAiB,CAAuC,aAAa,CAAC,IAAI,QAAQ,CAAC;IAC/G,MAAM,WAAW,GAAG,mBAAmB,IAAI,IAAI,IAAI,mBAAmB,KAAK,QAAQ,IAAI,CAAC,mBAAmB,KAAK,SAAS,IAAI,CAAC,QAAQ,CAAC,CAAC;IAExI,IAAI,CAAC,IAAI,EAAE,CAAC;QACX,MAAM,IAAI,KAAK,CAAC,wBAAwB,CAAC,CAAC;IAC3C,CAAC;IAED,MAAM,WAAW,GAAG,MAAM,CAAsB,IAAI,CAAC,CAAC;IACtD,MAAM,kBAAkB,GAAG,MAAM,CAAc,IAAI,CAAC,CAAC;IACrD,MAAM,SAAS,GAAG,MAAM,CAAiB,IAAI,CAAC,CAAC;IAE/C,MAAM,SAAS,GAAG,cAAc,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;IAEpE,MAAM,WAAW,GAAG,WAAW,CAC9B,CAAC,IAAyB,EAAE,EAAE;QAC7B,IAAI,IAAI,KAAK,IAAI,IAAI,IAAI,CAAC,QAAQ,EAAE,CAAC;YACpC,OAAO;QACR,CAAC;QACD,IAAI,CAAC,cAAc,CAAC,iBAAiB,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC,CAAC;IACzD,CAAC,EACD,CAAC,IAAI,EAAE,SAAS,CAAC,CACjB,CAAC;IAEF,MAAM,YAAY,GAAG,sBAAsB,CAAC,CAAC,QAAQ,CAAC,CAAC;IAEvD,MAAM,SAAS,GAAG,iBAAiB,CAAU,WAAW,CAAC,CAAC;IAE1D,MAAM,qBAAqB,GAAmC,kBAAkB,CAAC,CAAC,CAAC,EAAE,EAAE;QACtF,CAAC,CAAC,eAAe,EAAE,CAAC;QACpB,CAAC,CAAC,cAAc,EAAE,CAAC;QAEnB,IAAI,CAAC,SAAS,EAAE,CAAC;YAChB,OAAO;QACR,CAAC;QAED,MAAM,GAAG,GAAG,kBAAkB,CAAC,OAAsB,CAAC;QACtD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,KAAa,EAAE,EAAE,CAAC,IAAI,CAAC,QAAQ,EAAE,UAAU,CAAC,KAAK,KAAK,IAAI,CAAC,CAAC,CAAC;IAC1F,CAAC,CAAC,CAAC;IAEH,MAAM,iBAAiB,GAAG,kBAAkB,CAAC,GAAG,EAAE;QACjD,MAAM,IAAI,GAAG,IAAI,CAAC,QAAQ,EAAE,IAAI,IAAI,EAAE,CAAC;QACvC,IAAI,CAAC,QAAQ,EAAE,KAAK,EAAE,CAAC;QACvB,UAAU,EAAE,CAAC;QAEb,MAAM,EAAE,CAAC;YACR,KAAK,EAAE,IAAI;YACX,KAAK;YACL,WAAW;YACX,qBAAqB;SACrB,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;IAEH,MAAM,YAAY,GAAG,CAAC,KAA8C,EAAE,EAAE;QACvE,IAAI,IAAI,CAAC,cAAc,EAAE,CAAC;YACzB,KAAK,CAAC,cAAc,EAAE,CAAC;YACvB,KAAK,CAAC,eAAe,EAAE,CAAC;YAExB,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,EAAE;gBAC1C,IAAI,CAAC,KAAK,EAAE,CAAC;oBACZ,IAAI,CAAC,cAAc,EAAE,MAAM,EAAE,CAAC;gBAC/B,CAAC;YACF,CAAC,CAAC,CAAC;QACJ,CAAC;IACF,CAAC,CAAC;IAEF,MAAM,OAAO,GAAG,kBAAkB,CAAC,CAAC,KAAoB,EAAE,EAAE;QAC3D,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,GAAG,KAAK,CAAC;QAEjC,MAAM,KAAK,GAAG,KAAK,CAAC,MAA6B,CAAC;QAElD,MAAM,WAAW,GAAG,OAAO,KAAK,QAAQ,CAAC,eAAe,IAAI,OAAO,KAAK,QAAQ,CAAC,QAAQ,CAAC;QAE1F,IAAI,WAAW,EAAE,CAAC;YACjB,MAAM,YAAY,GAAG,KAAK,CAAC,QAAQ,IAAI,KAAK,CAAC,OAAO,IAAI,KAAK,CAAC,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC;YACtF,MAAM,SAAS,GAAG,CAAC,WAAW,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,WAAW,IAAI,YAAY,CAAC,CAAC;YAEnF,KAAK,CAAC,cAAc,EAAE,CAAC;YACvB,IAAI,CAAC,SAAS,EAAE,CAAC;gBAChB,IAAI,CAAC,QAAQ,EAAE,aAAa,EAAE,CAAC;gBAC/B,OAAO,KAAK,CAAC;YACd,CAAC;YACD,iBAAiB,EAAE,CAAC;YACpB,OAAO,KAAK,CAAC;QACd,CAAC;QAED,IAAI,IAAI,CAAC,QAAQ,IAAI,wBAAwB,CAAC,KAAK,EAAE,CAAC,GAAG,iBAAiB,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC;YAC7F,OAAO;QACR,CAAC;QAED,IAAI,KAAK,CAAC,QAAQ,IAAI,KAAK,CAAC,OAAO,IAAI,KAAK,CAAC,OAAO,EAAE,CAAC;YACtD,OAAO;QACR,CAAC;QAED,QAAQ,KAAK,CAAC,GAAG,EAAE,CAAC;YACnB,KAAK,QAAQ,CAAC,CAAC,CAAC;gBACf,YAAY,CAAC,KAAK,CAAC,CAAC;gBACpB,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,EAAE;oBAAE,QAAQ,EAAE,EAAE,CAAC;gBACtC,OAAO;YACR,CAAC;YAED,KAAK,SAAS,CAAC,CAAC,CAAC;gBAChB,IAAI,KAAK,CAAC,YAAY,KAAK,CAAC,EAAE,CAAC;oBAC9B,KAAK,CAAC,cAAc,EAAE,CAAC;oBACvB,KAAK,CAAC,eAAe,EAAE,CAAC;oBAExB,2BAA2B,EAAE,EAAE,CAAC;oBAEhC,IAAI,KAAK,CAAC,MAAM,EAAE,CAAC;wBAClB,KAAK,CAAC,iBAAiB,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;oBAC/B,CAAC;gBACF,CAAC;gBAED,OAAO;YACR,CAAC;YAED,KAAK,WAAW,CAAC,CAAC,CAAC;gBAClB,IAAI,KAAK,CAAC,YAAY,KAAK,KAAK,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC;oBAC/C,KAAK,CAAC,cAAc,EAAE,CAAC;oBACvB,KAAK,CAAC,eAAe,EAAE,CAAC;oBAExB,uBAAuB,EAAE,EAAE,CAAC;oBAE5B,IAAI,KAAK,CAAC,MAAM,EAAE,CAAC;wBAClB,KAAK,CAAC,iBAAiB,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;oBACjE,CAAC;gBACF,CAAC;YACF,CAAC;QACF,CAAC;QAED,QAAQ,EAAE,EAAE,CAAC;IACd,CAAC,CAAC,CAAC;IAEH,MAAM,SAAS,GAAG,eAAe,CAAC;QACjC,eAAe,EAAE,IAAI,CAAC,QAAQ,EAAE,OAAO,CAAC,GAAG,IAAI,aAAa;QAC5D,SAAS,EAAE,IAAI,CAAC,QAAQ,EAAE,OAAO,CAAC,SAAS,IAAI,cAAc;KAC7D,CAAC,CAAC;IAEH,MAAM,gBAAgB,GAAG,eAAe,CAAC;QACxC,eAAe,EAAE,IAAI,CAAC,QAAQ,EAAE,SAAS,CAAC,GAAG,IAAI,aAAa;QAC9D,SAAS,EAAE,IAAI,CAAC,QAAQ,EAAE,SAAS,CAAC,SAAS,IAAI,cAAc;KAC/D,CAAC,CAAC;IAEH,MAAM,kBAAkB,GAAG,eAAe,CAAC;QAC1C,eAAe,EAAE,IAAI,CAAC,QAAQ,EAAE,kBAAkB,CAAC,GAAG,IAAI,aAAa;QACvE,SAAS,EAAE,IAAI,CAAC,QAAQ,EAAE,kBAAkB,CAAC,SAAS,IAAI,cAAc;KACxE,CAAC,CAAC;IAEH,MAAM,gBAAgB,GAAG,eAAe,CAAC;QACxC,eAAe,EAAE,IAAI,CAAC,QAAQ,EAAE,cAAc,CAAC,GAAG,IAAI,aAAa;QACnE,SAAS,EAAE,IAAI,CAAC,QAAQ,EAAE,cAAc,CAAC,SAAS,IAAI,cAAc;KACpE,CAAC,CAAC;IAEH,MAAM,UAAU,GAAG,eAAe,CAAC;QAClC,eAAe,EAAE,IAAI,CAAC,QAAQ,EAAE,UAAU,CAAC,GAAG,IAAI,aAAa;QAC/D,SAAS,EAAE,IAAI,CAAC,QAAQ,EAAE,UAAU,CAAC,SAAS,IAAI,cAAc;KAChE,CAAC,CAAC;IAEH,MAAM,WAAW,GAAG,gBAAgB,IAAI,gBAAgB,CAAC;IAEzD,MAAM,EAAE,aAAa,EAAE,WAAW,EAAE,GAAG,WAAW,CAAC,WAAW,EAAE,SAAS,EAAE,gBAAgB,CAAC,CAAC;IAE7F,MAAM,OAAO,GAAG,gBAAgB,CAAC,WAAW,CAAC,GAAG,EAAE,CAAC,eAAe,CAAC,oBAAoB,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IAEhH,MAAM,KAAK,GAAG,iBAAiB,CAAC,WAAW,CAAC,CAAC;IAE7C,MAAM,MAAM,GAAG,oBAAoB,EAAE,CAAC;IAEtC,MAAM,YAAY,GAAG,WAAW,CAAC,KAAK,IAAI,EAAE,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;IAEzD,MAAM,WAAW,GAA+C,kBAAkB,CAAC,CAAC,KAAK,EAAE,EAAE;QAC5F,MAAM,EAAE,aAAa,EAAE,GAAG,KAAK,CAAC;QAEhC,IAAI,CAAC,aAAa,EAAE,CAAC;YACpB,OAAO;QACR,CAAC;QAED,MAAM,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAE9C,IAAI,KAAK,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC,IAAI,KAAK,QAAQ,IAAI,IAAI,KAAK,YAAY,CAAC,EAAE,CAAC;YAChF,OAAO;QACR,CAAC;QAED,MAAM,KAAK,GAAG,KAAK;aACjB,MAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,IAAI,KAAK,MAAM,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;aAC5E,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE;YACb,MAAM,QAAQ,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;YAElC,IAAI,CAAC,QAAQ,EAAE,CAAC;gBACf,OAAO;YACR,CAAC;YAED,MAAM,cAAc,GAAG,QAAQ,CAAC,CAAC,CAAC,yBAAyB,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC;YAEvF,MAAM,SAAS,GAAG,cAAc,CAAC,CAAC,CAAC,IAAI,cAAc,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;YAE7D,MAAM,CAAC,cAAc,CAAC,QAAQ,EAAE,MAAM,EAAE;gBACvC,QAAQ,EAAE,IAAI;gBACd,KAAK,EAAE,eAAe,MAAM,CAAC,IAAI,IAAI,EAAE,CAAC,GAAG,SAAS,EAAE;aACtD,CAAC,CAAC;YACH,OAAO,QAAQ,CAAC;QACjB,CAAC,CAAC;aACD,MAAM,CAAC,CAAC,IAAI,EAAgB,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;QAEzC,IAAI,KAAK,CAAC,MAAM,EAAE,CAAC;YAClB,KAAK,CAAC,cAAc,EAAE,CAAC;YACvB,aAAa,EAAE,CAAC,KAAK,CAAC,CAAC;QACxB,CAAC;IACF,CAAC,CAAC,CAAC;IAEH,MAAM,mBAAmB,GAAG,gBAAgB,EAAE,CAAC;IAE/C,MAAM,EACL,KAAK,EACL,OAAO,EACP,KAAK,EACL,oBAAoB,EACpB,SAAS,EACT,MAAM,EACN,WAAW,EACX,WAAW,EAAE,CAAC,EACd,MAAM,EACN,UAAU,GACV,GAAG,mBAAmB,CAAiC;QACvD,cAAc,EAAE,mBAAmB;KACnC,CAAC,CAAC;IAEH,MAAM,yBAAyB,GAAG,WAAW,CAC5C,CAAC,IAAyB,EAAE,EAAE;QAC7B,IAAI,IAAI,KAAK,IAAI,EAAE,CAAC;YACnB,OAAO;QACR,CAAC;QACD,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,CAAC,CAAgB,EAAE,EAAE;YACrD,OAAO,CAAC,CAAC,CAAC,CAAC;QACZ,CAAC,CAAC,CAAC;IACJ,CAAC,EACD,CAAC,OAAO,CAAC,CACT,CAAC;IAEF,MAAM,UAAU,GAAG,4BAA4B,CAAC,CAAC,EAAE,WAAW,EAAE,WAAW,EAAE,YAAY,EAAE,yBAAyB,CAAC,CAAC;IAEtH,MAAM,kBAAkB,GAAG,qBAAqB,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;IAEhE,OAAO,CACN,EACC;GAAA,CAAC,IAAI,CAAC,QAAQ,EAAE,cAAc,IAAI,CAAC,iBAAiB,CAAC,AAAD,EAAG,CACvD;GAAA,CAAC,kBAAkB,IAAI,KAAK,IAAI,CAC/B,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,UAAU,CAAC,EAAG,CACtH,CACD;GAAA,CAAC;;;;;UAKC,CACF;GAAA,CAAC,KAAK,EAAE,OAAO,IAAI,CAClB,CAAC,uBAAuB,CACvB,MAAM,CAAC,CAAC,MAAM,CAAC,CACf,KAAK,CAAC,CAAC,KAAY,CAAC,CACpB,OAAO,CAAC,CAAC,OAAc,CAAC,CACxB,UAAU,CAAC,CAAC,KAAK,CAAC,UAAU,CAAC,CAC7B,GAAG,CAAC,CAAC,WAAW,CAAC,CACjB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CACd,IAAI,CAAC,CAAC,IAAI,CAAC,CACX,SAAS,CAAC,CAAC,SAAS,CAAC,EACpB,CACF,CACD;GAAA,CAAC,cAAc,CACd,SAAS,CAAC,CAAC,SAAS,CAAC,CACrB,UAAU,CAAC,CAAC,UAAU,CAAC,CACvB,0BAA0B,CAAC,CAAC,0BAA0B,CAAC,CACvD,QAAQ,CAAC,CAAC,QAAQ,CAAC,EAEpB;GAAA,CAAC,gBAAgB,IAAI,CAAC,oBAAoB,CAAC,SAAS,CAAC,CAAC,kBAAkB,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,EAAG,CACvG;GAAA,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC,kBAAkB,CAAC,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,CACpF;IAAA,CAAC,gBAAgB,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,kBAAkB,CAAC,CAAC,kBAAkB,CAAC,EAAG,CACpG;IAAA,CAAC,oBAAoB,CACpB,GAAG,CAAC,CAAC,UAAU,CAAC,CAChB,UAAU,CAAC,CAAC,mBAAmB,CAAC,CAChC,IAAI,CAAC,KAAK,CACV,QAAQ,CAAC,CAAC,WAAW,IAAI,CAAC,OAAO,CAAC,CAClC,QAAQ,CAAC,CAAC,SAAS,CAAC,CACpB,KAAK,CAAC,CAAC,aAAa,CAAC,CACrB,WAAW,CAAC,CAAC,mBAAmB,CAAC,CACjC,OAAO,CAAC,CAAC,WAAW,CAAC,CACrB,qBAAqB,CAAC,CAAC,oBAAoB,CAAC,EAE7C;IAAA,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC,KAAK,CAAC,CAAC,WAAW,CAAC,EACxC;IAAA,CAAC,sBAAsB,CACtB;KAAA,CAAC,6BAA6B,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,0CAA0C,CAAC,CAAC,CACxF;MAAA,CAAC,qBAAqB,CACrB,IAAI,CAAC,OAAO,CACZ,QAAQ,CAAC,CAAC,CAAC,SAAS,IAAI,WAAW,IAAI,CAAC,OAAO,CAAC,CAChD,OAAO,CAAC,CAAC,qBAAqB,CAAC,CAC/B,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,EAEnB;MAAA,CAAC,6BAA6B,CAAC,AAAD,EAC9B;MAAA,CAAC,IAAI,CAAC,QAAQ,IAAI,UAAU,CAAC,MAAM,GAAG,CAAC,IAAI,CAC1C,CAAC,2BAA2B,CAC3B,QAAQ,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CACxB,OAAO,CAAC,CAAC,KAAK,CAAC,UAAU,GAAG,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,CACpD,KAAK,CAAC,CAAC,UAAU,CAAC,CAClB,QAAQ,CAAC,CAAC,WAAW,IAAI,CAAC,OAAO,CAAC,EACjC,CACF,CACD;MAAA,CAAC,wBAAwB,CACxB,OAAO,CAAC,CAAC,OAAO,CAAC,CACjB,MAAM,CAAC,CAAC,MAAM,CAAC,CACf,kBAAkB,CAAC,CAAC,kBAAkB,CAAC,CACvC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CACd,IAAI,CAAC,CAAC,IAAI,CAAC,CACX,WAAW,CAAC,CAAC,WAAW,CAAC,CACzB,OAAO,CAAC,CAAC,KAAK,CAAC,UAAU,GAAG,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,EAEtD;KAAA,EAAE,6BAA6B,CAC/B;KAAA,CAAC,4BAA4B,CAC5B;MAAA,CAAC,CAAC,OAAO,IAAI,CACZ,CAAC,qBAAqB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC,SAAS,CAAC,CAC/E;QAAA,CAAC,CAAC,CAAC,MAAM,CAAC,CACX;OAAA,EAAE,qBAAqB,CAAC,CACxB,CACD;MAAA,CAAC,OAAO,IAAI,CACX,EACC;QAAA,CAAC,SAAS,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,qBAAqB,CAAC,CACjG;QAAA,CAAC,qBAAqB,CACrB,UAAU,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CACtB,IAAI,CAAC,MAAM,CACX,QAAQ,CAAC,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,MAAM,IAAI,CAAC,SAAS,CAAC,CAAC,CAC9C,OAAO,CAAC,CAAC,iBAAiB,CAAC,CAC3B,SAAS,CAAC,CAAC,MAAM,IAAI,SAAS,CAAC,CAC/B,IAAI,CAAC,CAAC,MAAM,IAAI,SAAS,CAAC,EAE5B;OAAA,GAAG,CACH,CACF;KAAA,EAAE,4BAA4B,CAC/B;IAAA,EAAE,sBAAsB,CACzB;GAAA,EAAE,eAAe,CACjB;GAAA,CAAC,2BAA2B,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,EACxD;EAAA,GAAG,CACH,CAAC;AACH,CAAC,CAAC;AAEF,eAAe,IAAI,CAAC,UAAU,CAAC,CAAC","sourcesContent":["/* eslint-disable complexity */\nimport type { IMessage, ISubscription } from '@rocket.chat/core-typings';\nimport { useContentBoxSize, useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport {\n\tMessageComposerAction,\n\tMessageComposerToolbarActions,\n\tMessageComposer,\n\tMessageComposerInput,\n\tMessageComposerToolbar,\n\tMessageComposerActionsDivider,\n\tMessageComposerToolbarSubmit,\n\tMessageComposerButton,\n} from '@rocket.chat/ui-composer';\nimport { useTranslation, useUserPreference, useLayout, useSetting } from '@rocket.chat/ui-contexts';\nimport { useMutation } from '@tanstack/react-query';\nimport type { ReactElement, MouseEventHandler, FormEvent, ClipboardEventHandler, MouseEvent } from 'react';\nimport React, { memo, useRef, useReducer, useCallback } from 'react';\nimport { useSubscription } from 'use-subscription';\n\nimport { createComposerAPI } from '../../../../../app/ui-message/client/messageBox/createComposerAPI';\nimport type { FormattingButton } from '../../../../../app/ui-message/client/messageBox/messageBoxFormatting';\nimport { formattingButtons } from '../../../../../app/ui-message/client/messageBox/messageBoxFormatting';\nimport { getImageExtensionFromMime } from '../../../../../lib/getImageExtensionFromMime';\nimport { useFormatDateAndTime } from '../../../../hooks/useFormatDateAndTime';\nimport { useReactiveValue } from '../../../../hooks/useReactiveValue';\nimport type { ComposerAPI } from '../../../../lib/chats/ChatAPI';\nimport { roomCoordinator } from '../../../../lib/rooms/roomCoordinator';\nimport { keyCodes } from '../../../../lib/utils/keyCodes';\nimport AudioMessageRecorder from '../../../composer/AudioMessageRecorder';\nimport VideoMessageRecorder from '../../../composer/VideoMessageRecorder';\nimport { useChat } from '../../contexts/ChatContext';\nimport { useComposerPopup } from '../../contexts/ComposerPopupContext';\nimport { useRoom } from '../../contexts/RoomContext';\nimport ComposerBoxPopup from '../ComposerBoxPopup';\nimport ComposerBoxPopupPreview from '../ComposerBoxPopupPreview';\nimport ComposerUserActionIndicator from '../ComposerUserActionIndicator';\nimport { useAutoGrow } from '../RoomComposer/hooks/useAutoGrow';\nimport { useComposerBoxPopup } from '../hooks/useComposerBoxPopup';\nimport { useEnablePopupPreview } from '../hooks/useEnablePopupPreview';\nimport { useMessageComposerMergedRefs } from '../hooks/useMessageComposerMergedRefs';\nimport MessageBoxActionsToolbar from './MessageBoxActionsToolbar';\nimport MessageBoxFormattingToolbar from './MessageBoxFormattingToolbar';\nimport MessageBoxHint from './MessageBoxHint';\nimport MessageBoxReplies from './MessageBoxReplies';\nimport { useMessageBoxAutoFocus } from './hooks/useMessageBoxAutoFocus';\nimport { useMessageBoxPlaceholder } from './hooks/useMessageBoxPlaceholder';\n\nconst reducer = (_: unknown, event: FormEvent<HTMLInputElement>): boolean => {\n\tconst target = event.target as HTMLInputElement;\n\n\treturn Boolean(target.value.trim());\n};\n\nconst handleFormattingShortcut = (event: KeyboardEvent, formattingButtons: FormattingButton[], composer: ComposerAPI) => {\n\tconst isMacOS = navigator.platform.indexOf('Mac') !== -1;\n\tconst isCmdOrCtrlPressed = (isMacOS && event.metaKey) || (!isMacOS && event.ctrlKey);\n\n\tif (!isCmdOrCtrlPressed) {\n\t\treturn false;\n\t}\n\n\tconst key = event.key.toLowerCase();\n\n\tconst formatter = formattingButtons.find((formatter) => 'command' in formatter && formatter.command === key);\n\n\tif (!formatter || !('pattern' in formatter)) {\n\t\treturn false;\n\t}\n\n\tcomposer.wrapSelection(formatter.pattern);\n\treturn true;\n};\n\nconst emptySubscribe = () => () => undefined;\nconst getEmptyFalse = () => false;\nconst a: any[] = [];\nconst getEmptyArray = () => a;\n\ntype MessageBoxProps = {\n\ttmid?: IMessage['_id'];\n\tonSend?: (params: { value: string; tshow?: boolean; previewUrls?: string[]; isSlashCommandAllowed?: boolean }) => Promise<void>;\n\tonJoin?: () => Promise<void>;\n\tonResize?: () => void;\n\tonTyping?: () => void;\n\tonEscape?: () => void;\n\tonNavigateToPreviousMessage?: () => void;\n\tonNavigateToNextMessage?: () => void;\n\tonUploadFiles?: (files: readonly File[]) => void;\n\ttshow?: IMessage['tshow'];\n\tpreviewUrls?: string[];\n\tsubscription?: ISubscription;\n\tshowFormattingTips: boolean;\n\tisEmbedded?: boolean;\n};\n\nconst MessageBox = ({\n\ttmid,\n\tonSend,\n\tonJoin,\n\tonNavigateToNextMessage,\n\tonNavigateToPreviousMessage,\n\tonUploadFiles,\n\tonEscape,\n\tonTyping,\n\ttshow,\n\tpreviewUrls,\n}: MessageBoxProps): ReactElement => {\n\tconst chat = useChat();\n\tconst room = useRoom();\n\tconst t = useTranslation();\n\tconst e2eEnabled = useSetting<boolean>('E2E_Enable');\n\tconst unencryptedMessagesAllowed = useSetting<boolean>('E2E_Allow_Unencrypted_Messages');\n\tconst isSlashCommandAllowed = !e2eEnabled || !room.encrypted || unencryptedMessagesAllowed;\n\tconst composerPlaceholder = useMessageBoxPlaceholder(t('Message'), room);\n\n\tconst [typing, setTyping] = useReducer(reducer, false);\n\n\tconst { isMobile } = useLayout();\n\tconst sendOnEnterBehavior = useUserPreference<'normal' | 'alternative' | 'desktop'>('sendOnEnter') || isMobile;\n\tconst sendOnEnter = sendOnEnterBehavior == null || sendOnEnterBehavior === 'normal' || (sendOnEnterBehavior === 'desktop' && !isMobile);\n\n\tif (!chat) {\n\t\tthrow new Error('Chat context not found');\n\t}\n\n\tconst textareaRef = useRef<HTMLTextAreaElement>(null);\n\tconst messageComposerRef = useRef<HTMLElement>(null);\n\tconst shadowRef = useRef<HTMLDivElement>(null);\n\n\tconst storageID = `messagebox_${room._id}${tmid ? `-${tmid}` : ''}`;\n\n\tconst callbackRef = useCallback(\n\t\t(node: HTMLTextAreaElement) => {\n\t\t\tif (node === null || chat.composer) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tchat.setComposerAPI(createComposerAPI(node, storageID));\n\t\t},\n\t\t[chat, storageID],\n\t);\n\n\tconst autofocusRef = useMessageBoxAutoFocus(!isMobile);\n\n\tconst useEmojis = useUserPreference<boolean>('useEmojis');\n\n\tconst handleOpenEmojiPicker: MouseEventHandler<HTMLElement> = useMutableCallback((e) => {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\n\t\tif (!useEmojis) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst ref = messageComposerRef.current as HTMLElement;\n\t\tchat.emojiPicker.open(ref, (emoji: string) => chat.composer?.insertText(` :${emoji}: `));\n\t});\n\n\tconst handleSendMessage = useMutableCallback(() => {\n\t\tconst text = chat.composer?.text ?? '';\n\t\tchat.composer?.clear();\n\t\tclearPopup();\n\n\t\tonSend?.({\n\t\t\tvalue: text,\n\t\t\ttshow,\n\t\t\tpreviewUrls,\n\t\t\tisSlashCommandAllowed,\n\t\t});\n\t});\n\n\tconst closeEditing = (event: KeyboardEvent | MouseEvent<HTMLElement>) => {\n\t\tif (chat.currentEditing) {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\n\t\t\tchat.currentEditing.reset().then((reset) => {\n\t\t\t\tif (!reset) {\n\t\t\t\t\tchat.currentEditing?.cancel();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\tconst handler = useMutableCallback((event: KeyboardEvent) => {\n\t\tconst { which: keyCode } = event;\n\n\t\tconst input = event.target as HTMLTextAreaElement;\n\n\t\tconst isSubmitKey = keyCode === keyCodes.CARRIAGE_RETURN || keyCode === keyCodes.NEW_LINE;\n\n\t\tif (isSubmitKey) {\n\t\t\tconst withModifier = event.shiftKey || event.ctrlKey || event.altKey || event.metaKey;\n\t\t\tconst isSending = (sendOnEnter && !withModifier) || (!sendOnEnter && withModifier);\n\n\t\t\tevent.preventDefault();\n\t\t\tif (!isSending) {\n\t\t\t\tchat.composer?.insertNewLine();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\thandleSendMessage();\n\t\t\treturn false;\n\t\t}\n\n\t\tif (chat.composer && handleFormattingShortcut(event, [...formattingButtons], chat.composer)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.shiftKey || event.ctrlKey || event.metaKey) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (event.key) {\n\t\t\tcase 'Escape': {\n\t\t\t\tcloseEditing(event);\n\t\t\t\tif (!input.value.trim()) onEscape?.();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcase 'ArrowUp': {\n\t\t\t\tif (input.selectionEnd === 0) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\n\t\t\t\t\tonNavigateToPreviousMessage?.();\n\n\t\t\t\t\tif (event.altKey) {\n\t\t\t\t\t\tinput.setSelectionRange(0, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcase 'ArrowDown': {\n\t\t\t\tif (input.selectionEnd === input.value.length) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\n\t\t\t\t\tonNavigateToNextMessage?.();\n\n\t\t\t\t\tif (event.altKey) {\n\t\t\t\t\t\tinput.setSelectionRange(input.value.length, input.value.length);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tonTyping?.();\n\t});\n\n\tconst isEditing = useSubscription({\n\t\tgetCurrentValue: chat.composer?.editing.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.editing.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecordingAudio = useSubscription({\n\t\tgetCurrentValue: chat.composer?.recording.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.recording.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isMicrophoneDenied = useSubscription({\n\t\tgetCurrentValue: chat.composer?.isMicrophoneDenied.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.isMicrophoneDenied.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecordingVideo = useSubscription({\n\t\tgetCurrentValue: chat.composer?.recordingVideo.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.recordingVideo.subscribe ?? emptySubscribe,\n\t});\n\n\tconst formatters = useSubscription({\n\t\tgetCurrentValue: chat.composer?.formatters.get ?? getEmptyArray,\n\t\tsubscribe: chat.composer?.formatters.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecording = isRecordingAudio || isRecordingVideo;\n\n\tconst { textAreaStyle, shadowStyle } = useAutoGrow(textareaRef, shadowRef, isRecordingAudio);\n\n\tconst canSend = useReactiveValue(useCallback(() => roomCoordinator.verifyCanSendMessage(room._id), [room._id]));\n\n\tconst sizes = useContentBoxSize(textareaRef);\n\n\tconst format = useFormatDateAndTime();\n\n\tconst joinMutation = useMutation(async () => onJoin?.());\n\n\tconst handlePaste: ClipboardEventHandler<HTMLTextAreaElement> = useMutableCallback((event) => {\n\t\tconst { clipboardData } = event;\n\n\t\tif (!clipboardData) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst items = Array.from(clipboardData.items);\n\n\t\tif (items.some(({ kind, type }) => kind === 'string' && type === 'text/plain')) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst files = items\n\t\t\t.filter((item) => item.kind === 'file' && item.type.indexOf('image/') !== -1)\n\t\t\t.map((item) => {\n\t\t\t\tconst fileItem = item.getAsFile();\n\n\t\t\t\tif (!fileItem) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst imageExtension = fileItem ? getImageExtensionFromMime(fileItem.type) : undefined;\n\n\t\t\t\tconst extension = imageExtension ? `.${imageExtension}` : '';\n\n\t\t\t\tObject.defineProperty(fileItem, 'name', {\n\t\t\t\t\twritable: true,\n\t\t\t\t\tvalue: `Clipboard - ${format(new Date())}${extension}`,\n\t\t\t\t});\n\t\t\t\treturn fileItem;\n\t\t\t})\n\t\t\t.filter((file): file is File => !!file);\n\n\t\tif (files.length) {\n\t\t\tevent.preventDefault();\n\t\t\tonUploadFiles?.(files);\n\t\t}\n\t});\n\n\tconst composerPopupConfig = useComposerPopup();\n\n\tconst {\n\t\tpopup,\n\t\tfocused,\n\t\titems,\n\t\tariaActiveDescendant,\n\t\tsuspended,\n\t\tselect,\n\t\tcommandsRef,\n\t\tcallbackRef: c,\n\t\tfilter,\n\t\tclearPopup,\n\t} = useComposerBoxPopup<{ _id: string; sort?: number }>({\n\t\tconfigurations: composerPopupConfig,\n\t});\n\n\tconst keyDownHandlerCallbackRef = useCallback(\n\t\t(node: HTMLTextAreaElement) => {\n\t\t\tif (node === null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tnode.addEventListener('keydown', (e: KeyboardEvent) => {\n\t\t\t\thandler(e);\n\t\t\t});\n\t\t},\n\t\t[handler],\n\t);\n\n\tconst mergedRefs = useMessageComposerMergedRefs(c, textareaRef, callbackRef, autofocusRef, keyDownHandlerCallbackRef);\n\n\tconst shouldPopupPreview = useEnablePopupPreview(filter, popup);\n\n\treturn (\n\t\t<>\n\t\t\t{chat.composer?.quotedMessages && <MessageBoxReplies />}\n\t\t\t{shouldPopupPreview && popup && (\n\t\t\t\t<ComposerBoxPopup select={select} items={items} focused={focused} title={popup.title} renderItem={popup.renderItem} />\n\t\t\t)}\n\t\t\t{/*\n\t\t\t\tSlashCommand Preview popup works in a weird way\n\t\t\t\tThere is only one trigger for all the commands: \"/\"\n\t\t\t\tAfter that we need to the slashcommand list and check if the command exists and provide the preview\n\t\t\t\tif not the query is `suspend` which means the slashcommand is not found or doesn't have a preview\n\t\t\t*/}\n\t\t\t{popup?.preview && (\n\t\t\t\t<ComposerBoxPopupPreview\n\t\t\t\t\tselect={select}\n\t\t\t\t\titems={items as any}\n\t\t\t\t\tfocused={focused as any}\n\t\t\t\t\trenderItem={popup.renderItem}\n\t\t\t\t\tref={commandsRef}\n\t\t\t\t\trid={room._id}\n\t\t\t\t\ttmid={tmid}\n\t\t\t\t\tsuspended={suspended}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t<MessageBoxHint\n\t\t\t\tisEditing={isEditing}\n\t\t\t\te2eEnabled={e2eEnabled}\n\t\t\t\tunencryptedMessagesAllowed={unencryptedMessagesAllowed}\n\t\t\t\tisMobile={isMobile}\n\t\t\t/>\n\t\t\t{isRecordingVideo && <VideoMessageRecorder reference={messageComposerRef} rid={room._id} tmid={tmid} />}\n\t\t\t<MessageComposer ref={messageComposerRef} variant={isEditing ? 'editing' : undefined}>\n\t\t\t\t{isRecordingAudio && <AudioMessageRecorder rid={room._id} isMicrophoneDenied={isMicrophoneDenied} />}\n\t\t\t\t<MessageComposerInput\n\t\t\t\t\tref={mergedRefs}\n\t\t\t\t\taria-label={composerPlaceholder}\n\t\t\t\t\tname='msg'\n\t\t\t\t\tdisabled={isRecording || !canSend}\n\t\t\t\t\tonChange={setTyping}\n\t\t\t\t\tstyle={textAreaStyle}\n\t\t\t\t\tplaceholder={composerPlaceholder}\n\t\t\t\t\tonPaste={handlePaste}\n\t\t\t\t\taria-activedescendant={ariaActiveDescendant}\n\t\t\t\t/>\n\t\t\t\t<div ref={shadowRef} style={shadowStyle} />\n\t\t\t\t<MessageComposerToolbar>\n\t\t\t\t\t<MessageComposerToolbarActions aria-label={t('Message_composer_toolbox_primary_actions')}>\n\t\t\t\t\t\t<MessageComposerAction\n\t\t\t\t\t\t\ticon='emoji'\n\t\t\t\t\t\t\tdisabled={!useEmojis || isRecording || !canSend}\n\t\t\t\t\t\t\tonClick={handleOpenEmojiPicker}\n\t\t\t\t\t\t\ttitle={t('Emoji')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<MessageComposerActionsDivider />\n\t\t\t\t\t\t{chat.composer && formatters.length > 0 && (\n\t\t\t\t\t\t\t<MessageBoxFormattingToolbar\n\t\t\t\t\t\t\t\tcomposer={chat.composer}\n\t\t\t\t\t\t\t\tvariant={sizes.inlineSize < 480 ? 'small' : 'large'}\n\t\t\t\t\t\t\t\titems={formatters}\n\t\t\t\t\t\t\t\tdisabled={isRecording || !canSend}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<MessageBoxActionsToolbar\n\t\t\t\t\t\t\tcanSend={canSend}\n\t\t\t\t\t\t\ttyping={typing}\n\t\t\t\t\t\t\tisMicrophoneDenied={isMicrophoneDenied}\n\t\t\t\t\t\t\trid={room._id}\n\t\t\t\t\t\t\ttmid={tmid}\n\t\t\t\t\t\t\tisRecording={isRecording}\n\t\t\t\t\t\t\tvariant={sizes.inlineSize < 480 ? 'small' : 'large'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</MessageComposerToolbarActions>\n\t\t\t\t\t<MessageComposerToolbarSubmit>\n\t\t\t\t\t\t{!canSend && (\n\t\t\t\t\t\t\t<MessageComposerButton primary onClick={onJoin} loading={joinMutation.isLoading}>\n\t\t\t\t\t\t\t\t{t('Join')}\n\t\t\t\t\t\t\t</MessageComposerButton>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{canSend && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{isEditing && <MessageComposerButton onClick={closeEditing}>{t('Cancel')}</MessageComposerButton>}\n\t\t\t\t\t\t\t\t<MessageComposerAction\n\t\t\t\t\t\t\t\t\taria-label={t('Send')}\n\t\t\t\t\t\t\t\t\ticon='send'\n\t\t\t\t\t\t\t\t\tdisabled={!canSend || (!typing && !isEditing)}\n\t\t\t\t\t\t\t\t\tonClick={handleSendMessage}\n\t\t\t\t\t\t\t\t\tsecondary={typing || isEditing}\n\t\t\t\t\t\t\t\t\tinfo={typing || isEditing}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</MessageComposerToolbarSubmit>\n\t\t\t\t</MessageComposerToolbar>\n\t\t\t</MessageComposer>\n\t\t\t<ComposerUserActionIndicator rid={room._id} tmid={tmid} />\n\t\t</>\n\t);\n};\n\nexport default memo(MessageBox);\n"]}}},"code":"var _regeneratorRuntime;\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\nvar _toConsumableArray;\nmodule.link(\"@babel/runtime/helpers/toConsumableArray\", {\n  default: function (v) {\n    _toConsumableArray = v;\n  }\n}, 1);\nvar _slicedToArray;\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 2);\nvar useContentBoxSize, useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useContentBoxSize: function (v) {\n    useContentBoxSize = v;\n  },\n  useMutableCallback: function (v) {\n    useMutableCallback = v;\n  }\n}, 0);\nvar MessageComposerAction, MessageComposerToolbarActions, MessageComposer, MessageComposerInput, MessageComposerToolbar, MessageComposerActionsDivider, MessageComposerToolbarSubmit, MessageComposerButton;\nmodule.link(\"@rocket.chat/ui-composer\", {\n  MessageComposerAction: function (v) {\n    MessageComposerAction = v;\n  },\n  MessageComposerToolbarActions: function (v) {\n    MessageComposerToolbarActions = v;\n  },\n  MessageComposer: function (v) {\n    MessageComposer = v;\n  },\n  MessageComposerInput: function (v) {\n    MessageComposerInput = v;\n  },\n  MessageComposerToolbar: function (v) {\n    MessageComposerToolbar = v;\n  },\n  MessageComposerActionsDivider: function (v) {\n    MessageComposerActionsDivider = v;\n  },\n  MessageComposerToolbarSubmit: function (v) {\n    MessageComposerToolbarSubmit = v;\n  },\n  MessageComposerButton: function (v) {\n    MessageComposerButton = v;\n  }\n}, 1);\nvar useTranslation, useUserPreference, useLayout, useSetting;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useTranslation: function (v) {\n    useTranslation = v;\n  },\n  useUserPreference: function (v) {\n    useUserPreference = v;\n  },\n  useLayout: function (v) {\n    useLayout = v;\n  },\n  useSetting: function (v) {\n    useSetting = v;\n  }\n}, 2);\nvar useMutation;\nmodule.link(\"@tanstack/react-query\", {\n  useMutation: function (v) {\n    useMutation = v;\n  }\n}, 3);\nvar React, memo, useRef, useReducer, useCallback;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  memo: function (v) {\n    memo = v;\n  },\n  useRef: function (v) {\n    useRef = v;\n  },\n  useReducer: function (v) {\n    useReducer = v;\n  },\n  useCallback: function (v) {\n    useCallback = v;\n  }\n}, 4);\nvar useSubscription;\nmodule.link(\"use-subscription\", {\n  useSubscription: function (v) {\n    useSubscription = v;\n  }\n}, 5);\nvar createComposerAPI;\nmodule.link(\"../../../../../app/ui-message/client/messageBox/createComposerAPI\", {\n  createComposerAPI: function (v) {\n    createComposerAPI = v;\n  }\n}, 6);\nvar formattingButtons;\nmodule.link(\"../../../../../app/ui-message/client/messageBox/messageBoxFormatting\", {\n  formattingButtons: function (v) {\n    formattingButtons = v;\n  }\n}, 7);\nvar getImageExtensionFromMime;\nmodule.link(\"../../../../../lib/getImageExtensionFromMime\", {\n  getImageExtensionFromMime: function (v) {\n    getImageExtensionFromMime = v;\n  }\n}, 8);\nvar useFormatDateAndTime;\nmodule.link(\"../../../../hooks/useFormatDateAndTime\", {\n  useFormatDateAndTime: function (v) {\n    useFormatDateAndTime = v;\n  }\n}, 9);\nvar useReactiveValue;\nmodule.link(\"../../../../hooks/useReactiveValue\", {\n  useReactiveValue: function (v) {\n    useReactiveValue = v;\n  }\n}, 10);\nvar roomCoordinator;\nmodule.link(\"../../../../lib/rooms/roomCoordinator\", {\n  roomCoordinator: function (v) {\n    roomCoordinator = v;\n  }\n}, 11);\nvar keyCodes;\nmodule.link(\"../../../../lib/utils/keyCodes\", {\n  keyCodes: function (v) {\n    keyCodes = v;\n  }\n}, 12);\nvar AudioMessageRecorder;\nmodule.link(\"../../../composer/AudioMessageRecorder\", {\n  \"default\": function (v) {\n    AudioMessageRecorder = v;\n  }\n}, 13);\nvar VideoMessageRecorder;\nmodule.link(\"../../../composer/VideoMessageRecorder\", {\n  \"default\": function (v) {\n    VideoMessageRecorder = v;\n  }\n}, 14);\nvar useChat;\nmodule.link(\"../../contexts/ChatContext\", {\n  useChat: function (v) {\n    useChat = v;\n  }\n}, 15);\nvar useComposerPopup;\nmodule.link(\"../../contexts/ComposerPopupContext\", {\n  useComposerPopup: function (v) {\n    useComposerPopup = v;\n  }\n}, 16);\nvar useRoom;\nmodule.link(\"../../contexts/RoomContext\", {\n  useRoom: function (v) {\n    useRoom = v;\n  }\n}, 17);\nvar ComposerBoxPopup;\nmodule.link(\"../ComposerBoxPopup\", {\n  \"default\": function (v) {\n    ComposerBoxPopup = v;\n  }\n}, 18);\nvar ComposerBoxPopupPreview;\nmodule.link(\"../ComposerBoxPopupPreview\", {\n  \"default\": function (v) {\n    ComposerBoxPopupPreview = v;\n  }\n}, 19);\nvar ComposerUserActionIndicator;\nmodule.link(\"../ComposerUserActionIndicator\", {\n  \"default\": function (v) {\n    ComposerUserActionIndicator = v;\n  }\n}, 20);\nvar useAutoGrow;\nmodule.link(\"../RoomComposer/hooks/useAutoGrow\", {\n  useAutoGrow: function (v) {\n    useAutoGrow = v;\n  }\n}, 21);\nvar useComposerBoxPopup;\nmodule.link(\"../hooks/useComposerBoxPopup\", {\n  useComposerBoxPopup: function (v) {\n    useComposerBoxPopup = v;\n  }\n}, 22);\nvar useEnablePopupPreview;\nmodule.link(\"../hooks/useEnablePopupPreview\", {\n  useEnablePopupPreview: function (v) {\n    useEnablePopupPreview = v;\n  }\n}, 23);\nvar useMessageComposerMergedRefs;\nmodule.link(\"../hooks/useMessageComposerMergedRefs\", {\n  useMessageComposerMergedRefs: function (v) {\n    useMessageComposerMergedRefs = v;\n  }\n}, 24);\nvar MessageBoxActionsToolbar;\nmodule.link(\"./MessageBoxActionsToolbar\", {\n  \"default\": function (v) {\n    MessageBoxActionsToolbar = v;\n  }\n}, 25);\nvar MessageBoxFormattingToolbar;\nmodule.link(\"./MessageBoxFormattingToolbar\", {\n  \"default\": function (v) {\n    MessageBoxFormattingToolbar = v;\n  }\n}, 26);\nvar MessageBoxHint;\nmodule.link(\"./MessageBoxHint\", {\n  \"default\": function (v) {\n    MessageBoxHint = v;\n  }\n}, 27);\nvar MessageBoxReplies;\nmodule.link(\"./MessageBoxReplies\", {\n  \"default\": function (v) {\n    MessageBoxReplies = v;\n  }\n}, 28);\nvar useMessageBoxAutoFocus;\nmodule.link(\"./hooks/useMessageBoxAutoFocus\", {\n  useMessageBoxAutoFocus: function (v) {\n    useMessageBoxAutoFocus = v;\n  }\n}, 29);\nvar useMessageBoxPlaceholder;\nmodule.link(\"./hooks/useMessageBoxPlaceholder\", {\n  useMessageBoxPlaceholder: function (v) {\n    useMessageBoxPlaceholder = v;\n  }\n}, 30);\nvar reducer = function (_, event) {\n  var target = event.target;\n  return Boolean(target.value.trim());\n};\nvar handleFormattingShortcut = function (event, formattingButtons, composer) {\n  var isMacOS = navigator.platform.indexOf('Mac') !== -1;\n  var isCmdOrCtrlPressed = isMacOS && event.metaKey || !isMacOS && event.ctrlKey;\n  if (!isCmdOrCtrlPressed) {\n    return false;\n  }\n  var key = event.key.toLowerCase();\n  var formatter = formattingButtons.find(function (formatter) {\n    return 'command' in formatter && formatter.command === key;\n  });\n  if (!formatter || !('pattern' in formatter)) {\n    return false;\n  }\n  composer.wrapSelection(formatter.pattern);\n  return true;\n};\nvar emptySubscribe = function () {\n  return function () {\n    return undefined;\n  };\n};\nvar getEmptyFalse = function () {\n  return false;\n};\nvar a = [];\nvar getEmptyArray = function () {\n  return a;\n};\nvar MessageBox = function (_ref) {\n  var _chat$composer$editin, _chat$composer5, _chat$composer$editin2, _chat$composer6, _chat$composer$record, _chat$composer7, _chat$composer$record2, _chat$composer8, _chat$composer$isMicr, _chat$composer9, _chat$composer$isMicr2, _chat$composer10, _chat$composer$record3, _chat$composer11, _chat$composer$record4, _chat$composer12, _chat$composer$format, _chat$composer13, _chat$composer$format2, _chat$composer14, _chat$composer15;\n  var tmid = _ref.tmid,\n    onSend = _ref.onSend,\n    onJoin = _ref.onJoin,\n    onNavigateToNextMessage = _ref.onNavigateToNextMessage,\n    onNavigateToPreviousMessage = _ref.onNavigateToPreviousMessage,\n    onUploadFiles = _ref.onUploadFiles,\n    onEscape = _ref.onEscape,\n    onTyping = _ref.onTyping,\n    tshow = _ref.tshow,\n    previewUrls = _ref.previewUrls;\n  var chat = useChat();\n  var room = useRoom();\n  var t = useTranslation();\n  var e2eEnabled = useSetting('E2E_Enable');\n  var unencryptedMessagesAllowed = useSetting('E2E_Allow_Unencrypted_Messages');\n  var isSlashCommandAllowed = !e2eEnabled || !room.encrypted || unencryptedMessagesAllowed;\n  var composerPlaceholder = useMessageBoxPlaceholder(t('Message'), room);\n  var _useReducer = useReducer(reducer, false),\n    _useReducer2 = _slicedToArray(_useReducer, 2),\n    typing = _useReducer2[0],\n    setTyping = _useReducer2[1];\n  var _useLayout = useLayout(),\n    isMobile = _useLayout.isMobile;\n  var sendOnEnterBehavior = useUserPreference('sendOnEnter') || isMobile;\n  var sendOnEnter = sendOnEnterBehavior == null || sendOnEnterBehavior === 'normal' || sendOnEnterBehavior === 'desktop' && !isMobile;\n  if (!chat) {\n    throw new Error('Chat context not found');\n  }\n  var textareaRef = useRef(null);\n  var messageComposerRef = useRef(null);\n  var shadowRef = useRef(null);\n  var storageID = \"messagebox_\" + room._id + (tmid ? \"-\" + tmid : '');\n  var callbackRef = useCallback(function (node) {\n    if (node === null || chat.composer) {\n      return;\n    }\n    chat.setComposerAPI(createComposerAPI(node, storageID));\n  }, [chat, storageID]);\n  var autofocusRef = useMessageBoxAutoFocus(!isMobile);\n  var useEmojis = useUserPreference('useEmojis');\n  var handleOpenEmojiPicker = useMutableCallback(function (e) {\n    e.stopPropagation();\n    e.preventDefault();\n    if (!useEmojis) {\n      return;\n    }\n    var ref = messageComposerRef.current;\n    chat.emojiPicker.open(ref, function (emoji) {\n      var _chat$composer;\n      return (_chat$composer = chat.composer) === null || _chat$composer === void 0 ? void 0 : _chat$composer.insertText(\" :\" + emoji + \": \");\n    });\n  });\n  var handleSendMessage = useMutableCallback(function () {\n    var _chat$composer$text, _chat$composer2, _chat$composer3;\n    var text = (_chat$composer$text = (_chat$composer2 = chat.composer) === null || _chat$composer2 === void 0 ? void 0 : _chat$composer2.text) !== null && _chat$composer$text !== void 0 ? _chat$composer$text : '';\n    (_chat$composer3 = chat.composer) === null || _chat$composer3 === void 0 ? void 0 : _chat$composer3.clear();\n    clearPopup();\n    onSend === null || onSend === void 0 ? void 0 : onSend({\n      value: text,\n      tshow: tshow,\n      previewUrls: previewUrls,\n      isSlashCommandAllowed: isSlashCommandAllowed\n    });\n  });\n  var closeEditing = function (event) {\n    if (chat.currentEditing) {\n      event.preventDefault();\n      event.stopPropagation();\n      chat.currentEditing.reset().then(function (reset) {\n        if (!reset) {\n          var _chat$currentEditing;\n          (_chat$currentEditing = chat.currentEditing) === null || _chat$currentEditing === void 0 ? void 0 : _chat$currentEditing.cancel();\n        }\n      });\n    }\n  };\n  var handler = useMutableCallback(function (event) {\n    var keyCode = event.which;\n    var input = event.target;\n    var isSubmitKey = keyCode === keyCodes.CARRIAGE_RETURN || keyCode === keyCodes.NEW_LINE;\n    if (isSubmitKey) {\n      var withModifier = event.shiftKey || event.ctrlKey || event.altKey || event.metaKey;\n      var isSending = sendOnEnter && !withModifier || !sendOnEnter && withModifier;\n      event.preventDefault();\n      if (!isSending) {\n        var _chat$composer4;\n        (_chat$composer4 = chat.composer) === null || _chat$composer4 === void 0 ? void 0 : _chat$composer4.insertNewLine();\n        return false;\n      }\n      handleSendMessage();\n      return false;\n    }\n    if (chat.composer && handleFormattingShortcut(event, _toConsumableArray(formattingButtons), chat.composer)) {\n      return;\n    }\n    if (event.shiftKey || event.ctrlKey || event.metaKey) {\n      return;\n    }\n    switch (event.key) {\n      case 'Escape':\n        {\n          closeEditing(event);\n          if (!input.value.trim()) onEscape === null || onEscape === void 0 ? void 0 : onEscape();\n          return;\n        }\n      case 'ArrowUp':\n        {\n          if (input.selectionEnd === 0) {\n            event.preventDefault();\n            event.stopPropagation();\n            onNavigateToPreviousMessage === null || onNavigateToPreviousMessage === void 0 ? void 0 : onNavigateToPreviousMessage();\n            if (event.altKey) {\n              input.setSelectionRange(0, 0);\n            }\n          }\n          return;\n        }\n      case 'ArrowDown':\n        {\n          if (input.selectionEnd === input.value.length) {\n            event.preventDefault();\n            event.stopPropagation();\n            onNavigateToNextMessage === null || onNavigateToNextMessage === void 0 ? void 0 : onNavigateToNextMessage();\n            if (event.altKey) {\n              input.setSelectionRange(input.value.length, input.value.length);\n            }\n          }\n        }\n    }\n    onTyping === null || onTyping === void 0 ? void 0 : onTyping();\n  });\n  var isEditing = useSubscription({\n    getCurrentValue: (_chat$composer$editin = (_chat$composer5 = chat.composer) === null || _chat$composer5 === void 0 ? void 0 : _chat$composer5.editing.get) !== null && _chat$composer$editin !== void 0 ? _chat$composer$editin : getEmptyFalse,\n    subscribe: (_chat$composer$editin2 = (_chat$composer6 = chat.composer) === null || _chat$composer6 === void 0 ? void 0 : _chat$composer6.editing.subscribe) !== null && _chat$composer$editin2 !== void 0 ? _chat$composer$editin2 : emptySubscribe\n  });\n  var isRecordingAudio = useSubscription({\n    getCurrentValue: (_chat$composer$record = (_chat$composer7 = chat.composer) === null || _chat$composer7 === void 0 ? void 0 : _chat$composer7.recording.get) !== null && _chat$composer$record !== void 0 ? _chat$composer$record : getEmptyFalse,\n    subscribe: (_chat$composer$record2 = (_chat$composer8 = chat.composer) === null || _chat$composer8 === void 0 ? void 0 : _chat$composer8.recording.subscribe) !== null && _chat$composer$record2 !== void 0 ? _chat$composer$record2 : emptySubscribe\n  });\n  var isMicrophoneDenied = useSubscription({\n    getCurrentValue: (_chat$composer$isMicr = (_chat$composer9 = chat.composer) === null || _chat$composer9 === void 0 ? void 0 : _chat$composer9.isMicrophoneDenied.get) !== null && _chat$composer$isMicr !== void 0 ? _chat$composer$isMicr : getEmptyFalse,\n    subscribe: (_chat$composer$isMicr2 = (_chat$composer10 = chat.composer) === null || _chat$composer10 === void 0 ? void 0 : _chat$composer10.isMicrophoneDenied.subscribe) !== null && _chat$composer$isMicr2 !== void 0 ? _chat$composer$isMicr2 : emptySubscribe\n  });\n  var isRecordingVideo = useSubscription({\n    getCurrentValue: (_chat$composer$record3 = (_chat$composer11 = chat.composer) === null || _chat$composer11 === void 0 ? void 0 : _chat$composer11.recordingVideo.get) !== null && _chat$composer$record3 !== void 0 ? _chat$composer$record3 : getEmptyFalse,\n    subscribe: (_chat$composer$record4 = (_chat$composer12 = chat.composer) === null || _chat$composer12 === void 0 ? void 0 : _chat$composer12.recordingVideo.subscribe) !== null && _chat$composer$record4 !== void 0 ? _chat$composer$record4 : emptySubscribe\n  });\n  var formatters = useSubscription({\n    getCurrentValue: (_chat$composer$format = (_chat$composer13 = chat.composer) === null || _chat$composer13 === void 0 ? void 0 : _chat$composer13.formatters.get) !== null && _chat$composer$format !== void 0 ? _chat$composer$format : getEmptyArray,\n    subscribe: (_chat$composer$format2 = (_chat$composer14 = chat.composer) === null || _chat$composer14 === void 0 ? void 0 : _chat$composer14.formatters.subscribe) !== null && _chat$composer$format2 !== void 0 ? _chat$composer$format2 : emptySubscribe\n  });\n  var isRecording = isRecordingAudio || isRecordingVideo;\n  var _useAutoGrow = useAutoGrow(textareaRef, shadowRef, isRecordingAudio),\n    textAreaStyle = _useAutoGrow.textAreaStyle,\n    shadowStyle = _useAutoGrow.shadowStyle;\n  var canSend = useReactiveValue(useCallback(function () {\n    return roomCoordinator.verifyCanSendMessage(room._id);\n  }, [room._id]));\n  var sizes = useContentBoxSize(textareaRef);\n  var format = useFormatDateAndTime();\n  var joinMutation = useMutation(function () {\n    function _callee() {\n      return _regeneratorRuntime.async(function () {\n        function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              return _context.abrupt(\"return\", onJoin === null || onJoin === void 0 ? void 0 : onJoin());\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n        return _callee$;\n      }(), null, null, null, Promise);\n    }\n    return _callee;\n  }());\n  var handlePaste = useMutableCallback(function (event) {\n    var clipboardData = event.clipboardData;\n    if (!clipboardData) {\n      return;\n    }\n    var items = Array.from(clipboardData.items);\n    if (items.some(function (_ref2) {\n      var kind = _ref2.kind,\n        type = _ref2.type;\n      return kind === 'string' && type === 'text/plain';\n    })) {\n      return;\n    }\n    var files = items.filter(function (item) {\n      return item.kind === 'file' && item.type.indexOf('image/') !== -1;\n    }).map(function (item) {\n      var fileItem = item.getAsFile();\n      if (!fileItem) {\n        return;\n      }\n      var imageExtension = fileItem ? getImageExtensionFromMime(fileItem.type) : undefined;\n      var extension = imageExtension ? \".\" + imageExtension : '';\n      Object.defineProperty(fileItem, 'name', {\n        writable: true,\n        value: \"Clipboard - \" + format(new Date()) + extension\n      });\n      return fileItem;\n    }).filter(function (file) {\n      return !!file;\n    });\n    if (files.length) {\n      event.preventDefault();\n      onUploadFiles === null || onUploadFiles === void 0 ? void 0 : onUploadFiles(files);\n    }\n  });\n  var composerPopupConfig = useComposerPopup();\n  var _useComposerBoxPopup = useComposerBoxPopup({\n      configurations: composerPopupConfig\n    }),\n    popup = _useComposerBoxPopup.popup,\n    focused = _useComposerBoxPopup.focused,\n    items = _useComposerBoxPopup.items,\n    ariaActiveDescendant = _useComposerBoxPopup.ariaActiveDescendant,\n    suspended = _useComposerBoxPopup.suspended,\n    select = _useComposerBoxPopup.select,\n    commandsRef = _useComposerBoxPopup.commandsRef,\n    c = _useComposerBoxPopup.callbackRef,\n    filter = _useComposerBoxPopup.filter,\n    clearPopup = _useComposerBoxPopup.clearPopup;\n  var keyDownHandlerCallbackRef = useCallback(function (node) {\n    if (node === null) {\n      return;\n    }\n    node.addEventListener('keydown', function (e) {\n      handler(e);\n    });\n  }, [handler]);\n  var mergedRefs = useMessageComposerMergedRefs(c, textareaRef, callbackRef, autofocusRef, keyDownHandlerCallbackRef);\n  var shouldPopupPreview = useEnablePopupPreview(filter, popup);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, ((_chat$composer15 = chat.composer) === null || _chat$composer15 === void 0 ? void 0 : _chat$composer15.quotedMessages) && /*#__PURE__*/React.createElement(MessageBoxReplies, null), shouldPopupPreview && popup && /*#__PURE__*/React.createElement(ComposerBoxPopup, {\n    select: select,\n    items: items,\n    focused: focused,\n    title: popup.title,\n    renderItem: popup.renderItem\n  }), (popup === null || popup === void 0 ? void 0 : popup.preview) && /*#__PURE__*/React.createElement(ComposerBoxPopupPreview, {\n    select: select,\n    items: items,\n    focused: focused,\n    renderItem: popup.renderItem,\n    ref: commandsRef,\n    rid: room._id,\n    tmid: tmid,\n    suspended: suspended\n  }), /*#__PURE__*/React.createElement(MessageBoxHint, {\n    isEditing: isEditing,\n    e2eEnabled: e2eEnabled,\n    unencryptedMessagesAllowed: unencryptedMessagesAllowed,\n    isMobile: isMobile\n  }), isRecordingVideo && /*#__PURE__*/React.createElement(VideoMessageRecorder, {\n    reference: messageComposerRef,\n    rid: room._id,\n    tmid: tmid\n  }), /*#__PURE__*/React.createElement(MessageComposer, {\n    ref: messageComposerRef,\n    variant: isEditing ? 'editing' : undefined\n  }, isRecordingAudio && /*#__PURE__*/React.createElement(AudioMessageRecorder, {\n    rid: room._id,\n    isMicrophoneDenied: isMicrophoneDenied\n  }), /*#__PURE__*/React.createElement(MessageComposerInput, {\n    ref: mergedRefs,\n    \"aria-label\": composerPlaceholder,\n    name: \"msg\",\n    disabled: isRecording || !canSend,\n    onChange: setTyping,\n    style: textAreaStyle,\n    placeholder: composerPlaceholder,\n    onPaste: handlePaste,\n    \"aria-activedescendant\": ariaActiveDescendant\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    ref: shadowRef,\n    style: shadowStyle\n  }), /*#__PURE__*/React.createElement(MessageComposerToolbar, null, /*#__PURE__*/React.createElement(MessageComposerToolbarActions, {\n    \"aria-label\": t('Message_composer_toolbox_primary_actions')\n  }, /*#__PURE__*/React.createElement(MessageComposerAction, {\n    icon: \"emoji\",\n    disabled: !useEmojis || isRecording || !canSend,\n    onClick: handleOpenEmojiPicker,\n    title: t('Emoji')\n  }), /*#__PURE__*/React.createElement(MessageComposerActionsDivider, null), chat.composer && formatters.length > 0 && /*#__PURE__*/React.createElement(MessageBoxFormattingToolbar, {\n    composer: chat.composer,\n    variant: sizes.inlineSize < 480 ? 'small' : 'large',\n    items: formatters,\n    disabled: isRecording || !canSend\n  }), /*#__PURE__*/React.createElement(MessageBoxActionsToolbar, {\n    canSend: canSend,\n    typing: typing,\n    isMicrophoneDenied: isMicrophoneDenied,\n    rid: room._id,\n    tmid: tmid,\n    isRecording: isRecording,\n    variant: sizes.inlineSize < 480 ? 'small' : 'large'\n  })), /*#__PURE__*/React.createElement(MessageComposerToolbarSubmit, null, !canSend && /*#__PURE__*/React.createElement(MessageComposerButton, {\n    primary: true,\n    onClick: onJoin,\n    loading: joinMutation.isLoading\n  }, t('Join')), canSend && /*#__PURE__*/React.createElement(React.Fragment, null, isEditing && /*#__PURE__*/React.createElement(MessageComposerButton, {\n    onClick: closeEditing\n  }, t('Cancel')), /*#__PURE__*/React.createElement(MessageComposerAction, {\n    \"aria-label\": t('Send'),\n    icon: \"send\",\n    disabled: !canSend || !typing && !isEditing,\n    onClick: handleSendMessage,\n    secondary: typing || isEditing,\n    info: typing || isEditing\n  }))))), /*#__PURE__*/React.createElement(ComposerUserActionIndicator, {\n    rid: room._id,\n    tmid: tmid\n  }));\n};\nmodule.exportDefault( /*#__PURE__*/memo(MessageBox));","map":{"version":3,"names":["_regeneratorRuntime","module","link","default","v","_toConsumableArray","_slicedToArray","useContentBoxSize","useMutableCallback","MessageComposerAction","MessageComposerToolbarActions","MessageComposer","MessageComposerInput","MessageComposerToolbar","MessageComposerActionsDivider","MessageComposerToolbarSubmit","MessageComposerButton","useTranslation","useUserPreference","useLayout","useSetting","useMutation","React","memo","useRef","useReducer","useCallback","useSubscription","createComposerAPI","formattingButtons","getImageExtensionFromMime","useFormatDateAndTime","useReactiveValue","roomCoordinator","keyCodes","AudioMessageRecorder","VideoMessageRecorder","useChat","useComposerPopup","useRoom","ComposerBoxPopup","ComposerBoxPopupPreview","ComposerUserActionIndicator","useAutoGrow","useComposerBoxPopup","useEnablePopupPreview","useMessageComposerMergedRefs","MessageBoxActionsToolbar","MessageBoxFormattingToolbar","MessageBoxHint","MessageBoxReplies","useMessageBoxAutoFocus","useMessageBoxPlaceholder","reducer","_","event","target","Boolean","value","trim","handleFormattingShortcut","composer","isMacOS","navigator","platform","indexOf","isCmdOrCtrlPressed","metaKey","ctrlKey","key","toLowerCase","formatter","find","command","wrapSelection","pattern","emptySubscribe","undefined","getEmptyFalse","a","getEmptyArray","MessageBox","_ref","_chat$composer$editin","_chat$composer5","_chat$composer$editin2","_chat$composer6","_chat$composer$record","_chat$composer7","_chat$composer$record2","_chat$composer8","_chat$composer$isMicr","_chat$composer9","_chat$composer$isMicr2","_chat$composer10","_chat$composer$record3","_chat$composer11","_chat$composer$record4","_chat$composer12","_chat$composer$format","_chat$composer13","_chat$composer$format2","_chat$composer14","_chat$composer15","tmid","onSend","onJoin","onNavigateToNextMessage","onNavigateToPreviousMessage","onUploadFiles","onEscape","onTyping","tshow","previewUrls","chat","room","t","e2eEnabled","unencryptedMessagesAllowed","isSlashCommandAllowed","encrypted","composerPlaceholder","_useReducer","_useReducer2","typing","setTyping","_useLayout","isMobile","sendOnEnterBehavior","sendOnEnter","Error","textareaRef","messageComposerRef","shadowRef","storageID","_id","callbackRef","node","setComposerAPI","autofocusRef","useEmojis","handleOpenEmojiPicker","e","stopPropagation","preventDefault","ref","current","emojiPicker","open","emoji","_chat$composer","insertText","handleSendMessage","_chat$composer$text","_chat$composer2","_chat$composer3","text","clear","clearPopup","closeEditing","currentEditing","reset","then","_chat$currentEditing","cancel","handler","keyCode","which","input","isSubmitKey","CARRIAGE_RETURN","NEW_LINE","withModifier","shiftKey","altKey","isSending","_chat$composer4","insertNewLine","selectionEnd","setSelectionRange","length","isEditing","getCurrentValue","editing","get","subscribe","isRecordingAudio","recording","isMicrophoneDenied","isRecordingVideo","recordingVideo","formatters","isRecording","_useAutoGrow","textAreaStyle","shadowStyle","canSend","verifyCanSendMessage","sizes","format","joinMutation","_callee","async","_callee$","_context","prev","next","abrupt","stop","Promise","handlePaste","clipboardData","items","Array","from","some","_ref2","kind","type","files","filter","item","map","fileItem","getAsFile","imageExtension","extension","Object","defineProperty","writable","Date","file","composerPopupConfig","_useComposerBoxPopup","configurations","popup","focused","ariaActiveDescendant","suspended","select","commandsRef","c","keyDownHandlerCallbackRef","addEventListener","mergedRefs","shouldPopupPreview","createElement","Fragment","quotedMessages","title","renderItem","preview","rid","reference","variant","name","disabled","onChange","style","placeholder","onPaste","icon","onClick","inlineSize","primary","loading","isLoading","secondary","info","exportDefault"],"sources":["client/views/room/composer/messageBox/MessageBox.tsx"],"sourcesContent":["/* eslint-disable complexity */\nimport type { IMessage, ISubscription } from '@rocket.chat/core-typings';\nimport { useContentBoxSize, useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport {\n\tMessageComposerAction,\n\tMessageComposerToolbarActions,\n\tMessageComposer,\n\tMessageComposerInput,\n\tMessageComposerToolbar,\n\tMessageComposerActionsDivider,\n\tMessageComposerToolbarSubmit,\n\tMessageComposerButton,\n} from '@rocket.chat/ui-composer';\nimport { useTranslation, useUserPreference, useLayout, useSetting } from '@rocket.chat/ui-contexts';\nimport { useMutation } from '@tanstack/react-query';\nimport type { ReactElement, MouseEventHandler, FormEvent, ClipboardEventHandler, MouseEvent } from 'react';\nimport React, { memo, useRef, useReducer, useCallback } from 'react';\nimport { useSubscription } from 'use-subscription';\n\nimport { createComposerAPI } from '../../../../../app/ui-message/client/messageBox/createComposerAPI';\nimport type { FormattingButton } from '../../../../../app/ui-message/client/messageBox/messageBoxFormatting';\nimport { formattingButtons } from '../../../../../app/ui-message/client/messageBox/messageBoxFormatting';\nimport { getImageExtensionFromMime } from '../../../../../lib/getImageExtensionFromMime';\nimport { useFormatDateAndTime } from '../../../../hooks/useFormatDateAndTime';\nimport { useReactiveValue } from '../../../../hooks/useReactiveValue';\nimport type { ComposerAPI } from '../../../../lib/chats/ChatAPI';\nimport { roomCoordinator } from '../../../../lib/rooms/roomCoordinator';\nimport { keyCodes } from '../../../../lib/utils/keyCodes';\nimport AudioMessageRecorder from '../../../composer/AudioMessageRecorder';\nimport VideoMessageRecorder from '../../../composer/VideoMessageRecorder';\nimport { useChat } from '../../contexts/ChatContext';\nimport { useComposerPopup } from '../../contexts/ComposerPopupContext';\nimport { useRoom } from '../../contexts/RoomContext';\nimport ComposerBoxPopup from '../ComposerBoxPopup';\nimport ComposerBoxPopupPreview from '../ComposerBoxPopupPreview';\nimport ComposerUserActionIndicator from '../ComposerUserActionIndicator';\nimport { useAutoGrow } from '../RoomComposer/hooks/useAutoGrow';\nimport { useComposerBoxPopup } from '../hooks/useComposerBoxPopup';\nimport { useEnablePopupPreview } from '../hooks/useEnablePopupPreview';\nimport { useMessageComposerMergedRefs } from '../hooks/useMessageComposerMergedRefs';\nimport MessageBoxActionsToolbar from './MessageBoxActionsToolbar';\nimport MessageBoxFormattingToolbar from './MessageBoxFormattingToolbar';\nimport MessageBoxHint from './MessageBoxHint';\nimport MessageBoxReplies from './MessageBoxReplies';\nimport { useMessageBoxAutoFocus } from './hooks/useMessageBoxAutoFocus';\nimport { useMessageBoxPlaceholder } from './hooks/useMessageBoxPlaceholder';\n\nconst reducer = (_: unknown, event: FormEvent<HTMLInputElement>): boolean => {\n\tconst target = event.target as HTMLInputElement;\n\n\treturn Boolean(target.value.trim());\n};\n\nconst handleFormattingShortcut = (event: KeyboardEvent, formattingButtons: FormattingButton[], composer: ComposerAPI) => {\n\tconst isMacOS = navigator.platform.indexOf('Mac') !== -1;\n\tconst isCmdOrCtrlPressed = (isMacOS && event.metaKey) || (!isMacOS && event.ctrlKey);\n\n\tif (!isCmdOrCtrlPressed) {\n\t\treturn false;\n\t}\n\n\tconst key = event.key.toLowerCase();\n\n\tconst formatter = formattingButtons.find((formatter) => 'command' in formatter && formatter.command === key);\n\n\tif (!formatter || !('pattern' in formatter)) {\n\t\treturn false;\n\t}\n\n\tcomposer.wrapSelection(formatter.pattern);\n\treturn true;\n};\n\nconst emptySubscribe = () => () => undefined;\nconst getEmptyFalse = () => false;\nconst a: any[] = [];\nconst getEmptyArray = () => a;\n\ntype MessageBoxProps = {\n\ttmid?: IMessage['_id'];\n\tonSend?: (params: { value: string; tshow?: boolean; previewUrls?: string[]; isSlashCommandAllowed?: boolean }) => Promise<void>;\n\tonJoin?: () => Promise<void>;\n\tonResize?: () => void;\n\tonTyping?: () => void;\n\tonEscape?: () => void;\n\tonNavigateToPreviousMessage?: () => void;\n\tonNavigateToNextMessage?: () => void;\n\tonUploadFiles?: (files: readonly File[]) => void;\n\ttshow?: IMessage['tshow'];\n\tpreviewUrls?: string[];\n\tsubscription?: ISubscription;\n\tshowFormattingTips: boolean;\n\tisEmbedded?: boolean;\n};\n\nconst MessageBox = ({\n\ttmid,\n\tonSend,\n\tonJoin,\n\tonNavigateToNextMessage,\n\tonNavigateToPreviousMessage,\n\tonUploadFiles,\n\tonEscape,\n\tonTyping,\n\ttshow,\n\tpreviewUrls,\n}: MessageBoxProps): ReactElement => {\n\tconst chat = useChat();\n\tconst room = useRoom();\n\tconst t = useTranslation();\n\tconst e2eEnabled = useSetting<boolean>('E2E_Enable');\n\tconst unencryptedMessagesAllowed = useSetting<boolean>('E2E_Allow_Unencrypted_Messages');\n\tconst isSlashCommandAllowed = !e2eEnabled || !room.encrypted || unencryptedMessagesAllowed;\n\tconst composerPlaceholder = useMessageBoxPlaceholder(t('Message'), room);\n\n\tconst [typing, setTyping] = useReducer(reducer, false);\n\n\tconst { isMobile } = useLayout();\n\tconst sendOnEnterBehavior = useUserPreference<'normal' | 'alternative' | 'desktop'>('sendOnEnter') || isMobile;\n\tconst sendOnEnter = sendOnEnterBehavior == null || sendOnEnterBehavior === 'normal' || (sendOnEnterBehavior === 'desktop' && !isMobile);\n\n\tif (!chat) {\n\t\tthrow new Error('Chat context not found');\n\t}\n\n\tconst textareaRef = useRef<HTMLTextAreaElement>(null);\n\tconst messageComposerRef = useRef<HTMLElement>(null);\n\tconst shadowRef = useRef<HTMLDivElement>(null);\n\n\tconst storageID = `messagebox_${room._id}${tmid ? `-${tmid}` : ''}`;\n\n\tconst callbackRef = useCallback(\n\t\t(node: HTMLTextAreaElement) => {\n\t\t\tif (node === null || chat.composer) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tchat.setComposerAPI(createComposerAPI(node, storageID));\n\t\t},\n\t\t[chat, storageID],\n\t);\n\n\tconst autofocusRef = useMessageBoxAutoFocus(!isMobile);\n\n\tconst useEmojis = useUserPreference<boolean>('useEmojis');\n\n\tconst handleOpenEmojiPicker: MouseEventHandler<HTMLElement> = useMutableCallback((e) => {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\n\t\tif (!useEmojis) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst ref = messageComposerRef.current as HTMLElement;\n\t\tchat.emojiPicker.open(ref, (emoji: string) => chat.composer?.insertText(` :${emoji}: `));\n\t});\n\n\tconst handleSendMessage = useMutableCallback(() => {\n\t\tconst text = chat.composer?.text ?? '';\n\t\tchat.composer?.clear();\n\t\tclearPopup();\n\n\t\tonSend?.({\n\t\t\tvalue: text,\n\t\t\ttshow,\n\t\t\tpreviewUrls,\n\t\t\tisSlashCommandAllowed,\n\t\t});\n\t});\n\n\tconst closeEditing = (event: KeyboardEvent | MouseEvent<HTMLElement>) => {\n\t\tif (chat.currentEditing) {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\n\t\t\tchat.currentEditing.reset().then((reset) => {\n\t\t\t\tif (!reset) {\n\t\t\t\t\tchat.currentEditing?.cancel();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\tconst handler = useMutableCallback((event: KeyboardEvent) => {\n\t\tconst { which: keyCode } = event;\n\n\t\tconst input = event.target as HTMLTextAreaElement;\n\n\t\tconst isSubmitKey = keyCode === keyCodes.CARRIAGE_RETURN || keyCode === keyCodes.NEW_LINE;\n\n\t\tif (isSubmitKey) {\n\t\t\tconst withModifier = event.shiftKey || event.ctrlKey || event.altKey || event.metaKey;\n\t\t\tconst isSending = (sendOnEnter && !withModifier) || (!sendOnEnter && withModifier);\n\n\t\t\tevent.preventDefault();\n\t\t\tif (!isSending) {\n\t\t\t\tchat.composer?.insertNewLine();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\thandleSendMessage();\n\t\t\treturn false;\n\t\t}\n\n\t\tif (chat.composer && handleFormattingShortcut(event, [...formattingButtons], chat.composer)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.shiftKey || event.ctrlKey || event.metaKey) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (event.key) {\n\t\t\tcase 'Escape': {\n\t\t\t\tcloseEditing(event);\n\t\t\t\tif (!input.value.trim()) onEscape?.();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcase 'ArrowUp': {\n\t\t\t\tif (input.selectionEnd === 0) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\n\t\t\t\t\tonNavigateToPreviousMessage?.();\n\n\t\t\t\t\tif (event.altKey) {\n\t\t\t\t\t\tinput.setSelectionRange(0, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcase 'ArrowDown': {\n\t\t\t\tif (input.selectionEnd === input.value.length) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\n\t\t\t\t\tonNavigateToNextMessage?.();\n\n\t\t\t\t\tif (event.altKey) {\n\t\t\t\t\t\tinput.setSelectionRange(input.value.length, input.value.length);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tonTyping?.();\n\t});\n\n\tconst isEditing = useSubscription({\n\t\tgetCurrentValue: chat.composer?.editing.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.editing.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecordingAudio = useSubscription({\n\t\tgetCurrentValue: chat.composer?.recording.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.recording.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isMicrophoneDenied = useSubscription({\n\t\tgetCurrentValue: chat.composer?.isMicrophoneDenied.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.isMicrophoneDenied.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecordingVideo = useSubscription({\n\t\tgetCurrentValue: chat.composer?.recordingVideo.get ?? getEmptyFalse,\n\t\tsubscribe: chat.composer?.recordingVideo.subscribe ?? emptySubscribe,\n\t});\n\n\tconst formatters = useSubscription({\n\t\tgetCurrentValue: chat.composer?.formatters.get ?? getEmptyArray,\n\t\tsubscribe: chat.composer?.formatters.subscribe ?? emptySubscribe,\n\t});\n\n\tconst isRecording = isRecordingAudio || isRecordingVideo;\n\n\tconst { textAreaStyle, shadowStyle } = useAutoGrow(textareaRef, shadowRef, isRecordingAudio);\n\n\tconst canSend = useReactiveValue(useCallback(() => roomCoordinator.verifyCanSendMessage(room._id), [room._id]));\n\n\tconst sizes = useContentBoxSize(textareaRef);\n\n\tconst format = useFormatDateAndTime();\n\n\tconst joinMutation = useMutation(async () => onJoin?.());\n\n\tconst handlePaste: ClipboardEventHandler<HTMLTextAreaElement> = useMutableCallback((event) => {\n\t\tconst { clipboardData } = event;\n\n\t\tif (!clipboardData) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst items = Array.from(clipboardData.items);\n\n\t\tif (items.some(({ kind, type }) => kind === 'string' && type === 'text/plain')) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst files = items\n\t\t\t.filter((item) => item.kind === 'file' && item.type.indexOf('image/') !== -1)\n\t\t\t.map((item) => {\n\t\t\t\tconst fileItem = item.getAsFile();\n\n\t\t\t\tif (!fileItem) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst imageExtension = fileItem ? getImageExtensionFromMime(fileItem.type) : undefined;\n\n\t\t\t\tconst extension = imageExtension ? `.${imageExtension}` : '';\n\n\t\t\t\tObject.defineProperty(fileItem, 'name', {\n\t\t\t\t\twritable: true,\n\t\t\t\t\tvalue: `Clipboard - ${format(new Date())}${extension}`,\n\t\t\t\t});\n\t\t\t\treturn fileItem;\n\t\t\t})\n\t\t\t.filter((file): file is File => !!file);\n\n\t\tif (files.length) {\n\t\t\tevent.preventDefault();\n\t\t\tonUploadFiles?.(files);\n\t\t}\n\t});\n\n\tconst composerPopupConfig = useComposerPopup();\n\n\tconst {\n\t\tpopup,\n\t\tfocused,\n\t\titems,\n\t\tariaActiveDescendant,\n\t\tsuspended,\n\t\tselect,\n\t\tcommandsRef,\n\t\tcallbackRef: c,\n\t\tfilter,\n\t\tclearPopup,\n\t} = useComposerBoxPopup<{ _id: string; sort?: number }>({\n\t\tconfigurations: composerPopupConfig,\n\t});\n\n\tconst keyDownHandlerCallbackRef = useCallback(\n\t\t(node: HTMLTextAreaElement) => {\n\t\t\tif (node === null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tnode.addEventListener('keydown', (e: KeyboardEvent) => {\n\t\t\t\thandler(e);\n\t\t\t});\n\t\t},\n\t\t[handler],\n\t);\n\n\tconst mergedRefs = useMessageComposerMergedRefs(c, textareaRef, callbackRef, autofocusRef, keyDownHandlerCallbackRef);\n\n\tconst shouldPopupPreview = useEnablePopupPreview(filter, popup);\n\n\treturn (\n\t\t<>\n\t\t\t{chat.composer?.quotedMessages && <MessageBoxReplies />}\n\t\t\t{shouldPopupPreview && popup && (\n\t\t\t\t<ComposerBoxPopup select={select} items={items} focused={focused} title={popup.title} renderItem={popup.renderItem} />\n\t\t\t)}\n\t\t\t{/*\n\t\t\t\tSlashCommand Preview popup works in a weird way\n\t\t\t\tThere is only one trigger for all the commands: \"/\"\n\t\t\t\tAfter that we need to the slashcommand list and check if the command exists and provide the preview\n\t\t\t\tif not the query is `suspend` which means the slashcommand is not found or doesn't have a preview\n\t\t\t*/}\n\t\t\t{popup?.preview && (\n\t\t\t\t<ComposerBoxPopupPreview\n\t\t\t\t\tselect={select}\n\t\t\t\t\titems={items as any}\n\t\t\t\t\tfocused={focused as any}\n\t\t\t\t\trenderItem={popup.renderItem}\n\t\t\t\t\tref={commandsRef}\n\t\t\t\t\trid={room._id}\n\t\t\t\t\ttmid={tmid}\n\t\t\t\t\tsuspended={suspended}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t<MessageBoxHint\n\t\t\t\tisEditing={isEditing}\n\t\t\t\te2eEnabled={e2eEnabled}\n\t\t\t\tunencryptedMessagesAllowed={unencryptedMessagesAllowed}\n\t\t\t\tisMobile={isMobile}\n\t\t\t/>\n\t\t\t{isRecordingVideo && <VideoMessageRecorder reference={messageComposerRef} rid={room._id} tmid={tmid} />}\n\t\t\t<MessageComposer ref={messageComposerRef} variant={isEditing ? 'editing' : undefined}>\n\t\t\t\t{isRecordingAudio && <AudioMessageRecorder rid={room._id} isMicrophoneDenied={isMicrophoneDenied} />}\n\t\t\t\t<MessageComposerInput\n\t\t\t\t\tref={mergedRefs}\n\t\t\t\t\taria-label={composerPlaceholder}\n\t\t\t\t\tname='msg'\n\t\t\t\t\tdisabled={isRecording || !canSend}\n\t\t\t\t\tonChange={setTyping}\n\t\t\t\t\tstyle={textAreaStyle}\n\t\t\t\t\tplaceholder={composerPlaceholder}\n\t\t\t\t\tonPaste={handlePaste}\n\t\t\t\t\taria-activedescendant={ariaActiveDescendant}\n\t\t\t\t/>\n\t\t\t\t<div ref={shadowRef} style={shadowStyle} />\n\t\t\t\t<MessageComposerToolbar>\n\t\t\t\t\t<MessageComposerToolbarActions aria-label={t('Message_composer_toolbox_primary_actions')}>\n\t\t\t\t\t\t<MessageComposerAction\n\t\t\t\t\t\t\ticon='emoji'\n\t\t\t\t\t\t\tdisabled={!useEmojis || isRecording || !canSend}\n\t\t\t\t\t\t\tonClick={handleOpenEmojiPicker}\n\t\t\t\t\t\t\ttitle={t('Emoji')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<MessageComposerActionsDivider />\n\t\t\t\t\t\t{chat.composer && formatters.length > 0 && (\n\t\t\t\t\t\t\t<MessageBoxFormattingToolbar\n\t\t\t\t\t\t\t\tcomposer={chat.composer}\n\t\t\t\t\t\t\t\tvariant={sizes.inlineSize < 480 ? 'small' : 'large'}\n\t\t\t\t\t\t\t\titems={formatters}\n\t\t\t\t\t\t\t\tdisabled={isRecording || !canSend}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<MessageBoxActionsToolbar\n\t\t\t\t\t\t\tcanSend={canSend}\n\t\t\t\t\t\t\ttyping={typing}\n\t\t\t\t\t\t\tisMicrophoneDenied={isMicrophoneDenied}\n\t\t\t\t\t\t\trid={room._id}\n\t\t\t\t\t\t\ttmid={tmid}\n\t\t\t\t\t\t\tisRecording={isRecording}\n\t\t\t\t\t\t\tvariant={sizes.inlineSize < 480 ? 'small' : 'large'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</MessageComposerToolbarActions>\n\t\t\t\t\t<MessageComposerToolbarSubmit>\n\t\t\t\t\t\t{!canSend && (\n\t\t\t\t\t\t\t<MessageComposerButton primary onClick={onJoin} loading={joinMutation.isLoading}>\n\t\t\t\t\t\t\t\t{t('Join')}\n\t\t\t\t\t\t\t</MessageComposerButton>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{canSend && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{isEditing && <MessageComposerButton onClick={closeEditing}>{t('Cancel')}</MessageComposerButton>}\n\t\t\t\t\t\t\t\t<MessageComposerAction\n\t\t\t\t\t\t\t\t\taria-label={t('Send')}\n\t\t\t\t\t\t\t\t\ticon='send'\n\t\t\t\t\t\t\t\t\tdisabled={!canSend || (!typing && !isEditing)}\n\t\t\t\t\t\t\t\t\tonClick={handleSendMessage}\n\t\t\t\t\t\t\t\t\tsecondary={typing || isEditing}\n\t\t\t\t\t\t\t\t\tinfo={typing || isEditing}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</MessageComposerToolbarSubmit>\n\t\t\t\t</MessageComposerToolbar>\n\t\t\t</MessageComposer>\n\t\t\t<ComposerUserActionIndicator rid={room._id} tmid={tmid} />\n\t\t</>\n\t);\n};\n\nexport default memo(MessageBox);\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"1162e168bcbaf57160a6f4584e5cf8c7f301702c"}
