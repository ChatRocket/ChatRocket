{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/providers/TranslationProvider.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/providers/TranslationProvider.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/providers/TranslationProvider.tsx","inputSourceMap":{"version":3,"file":"client/providers/TranslationProvider.tsx","sourceRoot":"","sources":["client/providers/TranslationProvider.tsx"],"names":[],"mappings":"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","sourcesContent":["import { useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport languages from '@rocket.chat/i18n/dist/languages';\nimport en from '@rocket.chat/i18n/src/locales/en.i18n.json';\nimport { normalizeLanguage } from '@rocket.chat/tools';\nimport type { TranslationContextValue } from '@rocket.chat/ui-contexts';\nimport { useMethod, useSetting, TranslationContext } from '@rocket.chat/ui-contexts';\nimport type i18next from 'i18next';\nimport I18NextHttpBackend from 'i18next-http-backend';\nimport moment from 'moment';\nimport type { ReactElement, ReactNode } from 'react';\nimport React, { useEffect, useMemo } from 'react';\nimport { I18nextProvider, initReactI18next, useTranslation } from 'react-i18next';\n\nimport { getURL } from '../../app/utils/client';\nimport {\n\ti18n,\n\taddSprinfToI18n,\n\textractTranslationKeys,\n\tapplyCustomTranslations,\n\tavailableTranslationNamespaces,\n\tdefaultTranslationNamespace,\n\textractTranslationNamespaces,\n} from '../../app/utils/lib/i18n';\nimport { AppClientOrchestratorInstance } from '../apps/orchestrator';\nimport { onLoggedIn } from '../lib/loggedIn';\nimport { isRTLScriptLanguage } from '../lib/utils/isRTLScriptLanguage';\n\ni18n.use(I18NextHttpBackend).use(initReactI18next);\n\nconst useCustomTranslations = (i18n: typeof i18next) => {\n\tconst customTranslations = useSetting('Custom_Translations');\n\n\tconst parsedCustomTranslations = useMemo((): Record<string, Record<string, string>> | undefined => {\n\t\tif (!customTranslations || typeof customTranslations !== 'string') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\ttry {\n\t\t\treturn JSON.parse(customTranslations);\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t\treturn undefined;\n\t\t}\n\t}, [customTranslations]);\n\n\tuseEffect(() => {\n\t\tif (!parsedCustomTranslations) {\n\t\t\treturn;\n\t\t}\n\n\t\tapplyCustomTranslations(i18n, parsedCustomTranslations);\n\n\t\tconst handleLanguageChanged = (): void => {\n\t\t\tapplyCustomTranslations(i18n, parsedCustomTranslations);\n\t\t};\n\n\t\ti18n.on('languageChanged', handleLanguageChanged);\n\n\t\treturn () => {\n\t\t\ti18n.off('languageChanged', handleLanguageChanged);\n\t\t};\n\t}, [i18n, parsedCustomTranslations]);\n};\n\nconst localeCache = new Map<string, Promise<string>>();\nlet isI18nInitialized = false;\n\nconst useI18next = (lng: string): typeof i18next => {\n\t// i18n.init is async, so there's a chance a race condition happens and it is initialized twice\n\t// This breaks translations because it loads `lng` in the first init but not the second.\n\tif (!isI18nInitialized) {\n\t\tisI18nInitialized = true;\n\t\ti18n.init({\n\t\t\tlng,\n\t\t\tfallbackLng: 'en',\n\t\t\tns: availableTranslationNamespaces,\n\t\t\tdefaultNS: defaultTranslationNamespace,\n\t\t\tnsSeparator: '.',\n\t\t\tresources: {\n\t\t\t\ten: extractTranslationNamespaces(en),\n\t\t\t},\n\t\t\tpartialBundledLanguages: true,\n\t\t\tbackend: {\n\t\t\t\tloadPath: 'i18n/{{lng}}.json',\n\t\t\t\tparse: (data: string, _lngs?: string | string[], namespaces: string | string[] = []) =>\n\t\t\t\t\textractTranslationKeys(JSON.parse(data), namespaces),\n\t\t\t\trequest: (_options: unknown, url: string, _payload: unknown, callback: (error: unknown, data: unknown) => void) => {\n\t\t\t\t\tconst params = url.split('/');\n\n\t\t\t\t\tconst lng = params[params.length - 1];\n\n\t\t\t\t\tlet promise = localeCache.get(lng);\n\n\t\t\t\t\tif (!promise) {\n\t\t\t\t\t\tpromise = fetch(getURL(url)).then((res) => res.text());\n\t\t\t\t\t\tlocaleCache.set(lng, promise);\n\t\t\t\t\t}\n\n\t\t\t\t\tpromise.then(\n\t\t\t\t\t\t(res) => callback(null, { data: res, status: 200 }),\n\t\t\t\t\t\t() => callback(null, { data: '', status: 500 }),\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t},\n\t\t\treact: {\n\t\t\t\tuseSuspense: true,\n\t\t\t\tbindI18n: 'languageChanged loaded',\n\t\t\t\tbindI18nStore: 'added removed',\n\t\t\t},\n\t\t\tinterpolation: {\n\t\t\t\tescapeValue: false,\n\t\t\t},\n\t\t});\n\t}\n\n\tuseEffect(() => {\n\t\ti18n.changeLanguage(lng);\n\t}, [lng]);\n\n\treturn i18n;\n};\n\nconst useAutoLanguage = () => {\n\tconst serverLanguage = useSetting('Language', '');\n\tconst browserLanguage = normalizeLanguage(window.navigator.userLanguage ?? window.navigator.language);\n\tconst defaultUserLanguage = browserLanguage || serverLanguage || 'en';\n\n\t// if the language is supported, if not remove the region\n\tconst suggestedLanguage = languages.includes(defaultUserLanguage)\n\t\t? defaultUserLanguage\n\t\t: (defaultUserLanguage.split('-').shift() ?? 'en');\n\n\t// usually that value is set based on the user's config language\n\tconst [language] = useLocalStorage('userLanguage', suggestedLanguage);\n\n\tdocument.documentElement.classList[isRTLScriptLanguage(language) ? 'add' : 'remove']('rtl');\n\tdocument.documentElement.setAttribute('dir', isRTLScriptLanguage(language) ? 'rtl' : 'ltr');\n\tdocument.documentElement.lang = language;\n\n\t// if user has no language set, we should set it to the default language\n\treturn language || suggestedLanguage;\n};\n\nconst getLanguageName = (code: string, lng: string): string => {\n\ttry {\n\t\tconst lang = new Intl.DisplayNames([lng], { type: 'language' });\n\t\treturn lang.of(code) ?? code;\n\t} catch (e) {\n\t\treturn code;\n\t}\n};\n\ntype TranslationProviderProps = {\n\tchildren: ReactNode;\n};\n\nconst TranslationProvider = ({ children }: TranslationProviderProps): ReactElement => {\n\tconst loadLocale = useMethod('loadLocale');\n\n\tconst language = useAutoLanguage();\n\tconst i18nextInstance = useI18next(language);\n\tuseCustomTranslations(i18nextInstance);\n\n\tconst availableLanguages = useMemo(\n\t\t() => [\n\t\t\t{\n\t\t\t\ten: 'Default',\n\t\t\t\tname: i18nextInstance.t('Default'),\n\t\t\t\togName: i18nextInstance.t('Default'),\n\t\t\t\tkey: '',\n\t\t\t},\n\t\t\t...[...new Set([...i18nextInstance.languages, ...languages])].map((key) => ({\n\t\t\t\ten: key,\n\t\t\t\tname: getLanguageName(key, language),\n\t\t\t\togName: getLanguageName(key, key),\n\t\t\t\tkey,\n\t\t\t})),\n\t\t],\n\t\t[language, i18nextInstance],\n\t);\n\n\tuseEffect(() => {\n\t\tif (moment.locales().includes(language.toLowerCase())) {\n\t\t\tmoment.locale(language);\n\t\t\treturn;\n\t\t}\n\n\t\tconst locale = !availableLanguages.find((lng) => lng.key === language) ? language.split('-').shift() : language;\n\n\t\tloadLocale(locale ?? language)\n\t\t\t.then((localeSrc) => {\n\t\t\t\tlocaleSrc && Function(localeSrc).call({ moment });\n\t\t\t\tmoment.locale(language);\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tmoment.locale('en');\n\t\t\t\tconsole.error('Error loading moment locale:', error);\n\t\t\t});\n\t}, [language, loadLocale, availableLanguages]);\n\n\tuseEffect(\n\t\t() =>\n\t\t\tonLoggedIn(() => {\n\t\t\t\tAppClientOrchestratorInstance.getAppClientManager().initialize();\n\t\t\t\tAppClientOrchestratorInstance.load();\n\t\t\t}),\n\t\t[],\n\t);\n\n\treturn (\n\t\t<I18nextProvider i18n={i18nextInstance}>\n\t\t\t<TranslationProviderInner children={children} availableLanguages={availableLanguages} />\n\t\t</I18nextProvider>\n\t);\n};\n\n/**\n * I was forced to create this component to keep the api useTranslation from rocketchat\n * rocketchat useTranslation invalidates the provider content, triggering all the places that use it\n * i18next triggers a re-render inside useTranslation, since now we are using 100% of the i18next\n * the only way to invalidate after changing the language in a safe way is using the useTranslation from i8next\n * and invalidating the provider content\n */\n// eslint-disable-next-line react/no-multi-comp\nconst TranslationProviderInner = ({\n\tchildren,\n\tavailableLanguages,\n}: {\n\tchildren: ReactNode;\n\tavailableLanguages: {\n\t\ten: string;\n\t\tname: string;\n\t\togName: string;\n\t\tkey: string;\n\t}[];\n}): ReactElement => {\n\tconst { t, i18n } = useTranslation();\n\n\tconst value: TranslationContextValue = useMemo(\n\t\t() => ({\n\t\t\tlanguage: i18n.language,\n\t\t\tlanguages: availableLanguages,\n\t\t\tloadLanguage: async (language: string) => {\n\t\t\t\ti18n.changeLanguage(language);\n\t\t\t},\n\t\t\ttranslate: Object.assign(addSprinfToI18n(t), {\n\t\t\t\thas: ((key, options) => key && i18n.exists(key, options)) as TranslationContextValue['translate']['has'],\n\t\t\t}),\n\t\t}),\n\t\t[availableLanguages, i18n, t],\n\t);\n\n\treturn <TranslationContext.Provider children={children} value={value} />;\n};\n\nexport default TranslationProvider;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/providers/TranslationProvider.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/providers/TranslationProvider.tsx","inputSourceMap":{"version":3,"file":"client/providers/TranslationProvider.tsx","sourceRoot":"","sources":["client/providers/TranslationProvider.tsx"],"names":[],"mappings":"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","sourcesContent":["import { useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport languages from '@rocket.chat/i18n/dist/languages';\nimport en from '@rocket.chat/i18n/src/locales/en.i18n.json';\nimport { normalizeLanguage } from '@rocket.chat/tools';\nimport type { TranslationContextValue } from '@rocket.chat/ui-contexts';\nimport { useMethod, useSetting, TranslationContext } from '@rocket.chat/ui-contexts';\nimport type i18next from 'i18next';\nimport I18NextHttpBackend from 'i18next-http-backend';\nimport moment from 'moment';\nimport type { ReactElement, ReactNode } from 'react';\nimport React, { useEffect, useMemo } from 'react';\nimport { I18nextProvider, initReactI18next, useTranslation } from 'react-i18next';\n\nimport { getURL } from '../../app/utils/client';\nimport {\n\ti18n,\n\taddSprinfToI18n,\n\textractTranslationKeys,\n\tapplyCustomTranslations,\n\tavailableTranslationNamespaces,\n\tdefaultTranslationNamespace,\n\textractTranslationNamespaces,\n} from '../../app/utils/lib/i18n';\nimport { AppClientOrchestratorInstance } from '../apps/orchestrator';\nimport { onLoggedIn } from '../lib/loggedIn';\nimport { isRTLScriptLanguage } from '../lib/utils/isRTLScriptLanguage';\n\ni18n.use(I18NextHttpBackend).use(initReactI18next);\n\nconst useCustomTranslations = (i18n: typeof i18next) => {\n\tconst customTranslations = useSetting('Custom_Translations');\n\n\tconst parsedCustomTranslations = useMemo((): Record<string, Record<string, string>> | undefined => {\n\t\tif (!customTranslations || typeof customTranslations !== 'string') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\ttry {\n\t\t\treturn JSON.parse(customTranslations);\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t\treturn undefined;\n\t\t}\n\t}, [customTranslations]);\n\n\tuseEffect(() => {\n\t\tif (!parsedCustomTranslations) {\n\t\t\treturn;\n\t\t}\n\n\t\tapplyCustomTranslations(i18n, parsedCustomTranslations);\n\n\t\tconst handleLanguageChanged = (): void => {\n\t\t\tapplyCustomTranslations(i18n, parsedCustomTranslations);\n\t\t};\n\n\t\ti18n.on('languageChanged', handleLanguageChanged);\n\n\t\treturn () => {\n\t\t\ti18n.off('languageChanged', handleLanguageChanged);\n\t\t};\n\t}, [i18n, parsedCustomTranslations]);\n};\n\nconst localeCache = new Map<string, Promise<string>>();\nlet isI18nInitialized = false;\n\nconst useI18next = (lng: string): typeof i18next => {\n\t// i18n.init is async, so there's a chance a race condition happens and it is initialized twice\n\t// This breaks translations because it loads `lng` in the first init but not the second.\n\tif (!isI18nInitialized) {\n\t\tisI18nInitialized = true;\n\t\ti18n.init({\n\t\t\tlng,\n\t\t\tfallbackLng: 'en',\n\t\t\tns: availableTranslationNamespaces,\n\t\t\tdefaultNS: defaultTranslationNamespace,\n\t\t\tnsSeparator: '.',\n\t\t\tresources: {\n\t\t\t\ten: extractTranslationNamespaces(en),\n\t\t\t},\n\t\t\tpartialBundledLanguages: true,\n\t\t\tbackend: {\n\t\t\t\tloadPath: 'i18n/{{lng}}.json',\n\t\t\t\tparse: (data: string, _lngs?: string | string[], namespaces: string | string[] = []) =>\n\t\t\t\t\textractTranslationKeys(JSON.parse(data), namespaces),\n\t\t\t\trequest: (_options: unknown, url: string, _payload: unknown, callback: (error: unknown, data: unknown) => void) => {\n\t\t\t\t\tconst params = url.split('/');\n\n\t\t\t\t\tconst lng = params[params.length - 1];\n\n\t\t\t\t\tlet promise = localeCache.get(lng);\n\n\t\t\t\t\tif (!promise) {\n\t\t\t\t\t\tpromise = fetch(getURL(url)).then((res) => res.text());\n\t\t\t\t\t\tlocaleCache.set(lng, promise);\n\t\t\t\t\t}\n\n\t\t\t\t\tpromise.then(\n\t\t\t\t\t\t(res) => callback(null, { data: res, status: 200 }),\n\t\t\t\t\t\t() => callback(null, { data: '', status: 500 }),\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t},\n\t\t\treact: {\n\t\t\t\tuseSuspense: true,\n\t\t\t\tbindI18n: 'languageChanged loaded',\n\t\t\t\tbindI18nStore: 'added removed',\n\t\t\t},\n\t\t\tinterpolation: {\n\t\t\t\tescapeValue: false,\n\t\t\t},\n\t\t});\n\t}\n\n\tuseEffect(() => {\n\t\ti18n.changeLanguage(lng);\n\t}, [lng]);\n\n\treturn i18n;\n};\n\nconst useAutoLanguage = () => {\n\tconst serverLanguage = useSetting('Language', '');\n\tconst browserLanguage = normalizeLanguage(window.navigator.userLanguage ?? window.navigator.language);\n\tconst defaultUserLanguage = browserLanguage || serverLanguage || 'en';\n\n\t// if the language is supported, if not remove the region\n\tconst suggestedLanguage = languages.includes(defaultUserLanguage)\n\t\t? defaultUserLanguage\n\t\t: (defaultUserLanguage.split('-').shift() ?? 'en');\n\n\t// usually that value is set based on the user's config language\n\tconst [language] = useLocalStorage('userLanguage', suggestedLanguage);\n\n\tdocument.documentElement.classList[isRTLScriptLanguage(language) ? 'add' : 'remove']('rtl');\n\tdocument.documentElement.setAttribute('dir', isRTLScriptLanguage(language) ? 'rtl' : 'ltr');\n\tdocument.documentElement.lang = language;\n\n\t// if user has no language set, we should set it to the default language\n\treturn language || suggestedLanguage;\n};\n\nconst getLanguageName = (code: string, lng: string): string => {\n\ttry {\n\t\tconst lang = new Intl.DisplayNames([lng], { type: 'language' });\n\t\treturn lang.of(code) ?? code;\n\t} catch (e) {\n\t\treturn code;\n\t}\n};\n\ntype TranslationProviderProps = {\n\tchildren: ReactNode;\n};\n\nconst TranslationProvider = ({ children }: TranslationProviderProps): ReactElement => {\n\tconst loadLocale = useMethod('loadLocale');\n\n\tconst language = useAutoLanguage();\n\tconst i18nextInstance = useI18next(language);\n\tuseCustomTranslations(i18nextInstance);\n\n\tconst availableLanguages = useMemo(\n\t\t() => [\n\t\t\t{\n\t\t\t\ten: 'Default',\n\t\t\t\tname: i18nextInstance.t('Default'),\n\t\t\t\togName: i18nextInstance.t('Default'),\n\t\t\t\tkey: '',\n\t\t\t},\n\t\t\t...[...new Set([...i18nextInstance.languages, ...languages])].map((key) => ({\n\t\t\t\ten: key,\n\t\t\t\tname: getLanguageName(key, language),\n\t\t\t\togName: getLanguageName(key, key),\n\t\t\t\tkey,\n\t\t\t})),\n\t\t],\n\t\t[language, i18nextInstance],\n\t);\n\n\tuseEffect(() => {\n\t\tif (moment.locales().includes(language.toLowerCase())) {\n\t\t\tmoment.locale(language);\n\t\t\treturn;\n\t\t}\n\n\t\tconst locale = !availableLanguages.find((lng) => lng.key === language) ? language.split('-').shift() : language;\n\n\t\tloadLocale(locale ?? language)\n\t\t\t.then((localeSrc) => {\n\t\t\t\tlocaleSrc && Function(localeSrc).call({ moment });\n\t\t\t\tmoment.locale(language);\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tmoment.locale('en');\n\t\t\t\tconsole.error('Error loading moment locale:', error);\n\t\t\t});\n\t}, [language, loadLocale, availableLanguages]);\n\n\tuseEffect(\n\t\t() =>\n\t\t\tonLoggedIn(() => {\n\t\t\t\tAppClientOrchestratorInstance.getAppClientManager().initialize();\n\t\t\t\tAppClientOrchestratorInstance.load();\n\t\t\t}),\n\t\t[],\n\t);\n\n\treturn (\n\t\t<I18nextProvider i18n={i18nextInstance}>\n\t\t\t<TranslationProviderInner children={children} availableLanguages={availableLanguages} />\n\t\t</I18nextProvider>\n\t);\n};\n\n/**\n * I was forced to create this component to keep the api useTranslation from rocketchat\n * rocketchat useTranslation invalidates the provider content, triggering all the places that use it\n * i18next triggers a re-render inside useTranslation, since now we are using 100% of the i18next\n * the only way to invalidate after changing the language in a safe way is using the useTranslation from i8next\n * and invalidating the provider content\n */\n// eslint-disable-next-line react/no-multi-comp\nconst TranslationProviderInner = ({\n\tchildren,\n\tavailableLanguages,\n}: {\n\tchildren: ReactNode;\n\tavailableLanguages: {\n\t\ten: string;\n\t\tname: string;\n\t\togName: string;\n\t\tkey: string;\n\t}[];\n}): ReactElement => {\n\tconst { t, i18n } = useTranslation();\n\n\tconst value: TranslationContextValue = useMemo(\n\t\t() => ({\n\t\t\tlanguage: i18n.language,\n\t\t\tlanguages: availableLanguages,\n\t\t\tloadLanguage: async (language: string) => {\n\t\t\t\ti18n.changeLanguage(language);\n\t\t\t},\n\t\t\ttranslate: Object.assign(addSprinfToI18n(t), {\n\t\t\t\thas: ((key, options) => key && i18n.exists(key, options)) as TranslationContextValue['translate']['has'],\n\t\t\t}),\n\t\t}),\n\t\t[availableLanguages, i18n, t],\n\t);\n\n\treturn <TranslationContext.Provider children={children} value={value} />;\n};\n\nexport default TranslationProvider;\n"]}}},"code":"let useLocalStorage;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useLocalStorage(v) {\n    useLocalStorage = v;\n  }\n}, 0);\nlet languages;\nmodule.link(\"@rocket.chat/i18n/dist/languages\", {\n  default(v) {\n    languages = v;\n  }\n}, 1);\nlet en;\nmodule.link(\"@rocket.chat/i18n/src/locales/en.i18n.json\", {\n  default(v) {\n    en = v;\n  }\n}, 2);\nlet normalizeLanguage;\nmodule.link(\"@rocket.chat/tools\", {\n  normalizeLanguage(v) {\n    normalizeLanguage = v;\n  }\n}, 3);\nlet useMethod, useSetting, TranslationContext;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useMethod(v) {\n    useMethod = v;\n  },\n  useSetting(v) {\n    useSetting = v;\n  },\n  TranslationContext(v) {\n    TranslationContext = v;\n  }\n}, 4);\nlet I18NextHttpBackend;\nmodule.link(\"i18next-http-backend\", {\n  default(v) {\n    I18NextHttpBackend = v;\n  }\n}, 5);\nlet moment;\nmodule.link(\"moment\", {\n  default(v) {\n    moment = v;\n  }\n}, 6);\nlet React, useEffect, useMemo;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n  useEffect(v) {\n    useEffect = v;\n  },\n  useMemo(v) {\n    useMemo = v;\n  }\n}, 7);\nlet I18nextProvider, initReactI18next, useTranslation;\nmodule.link(\"react-i18next\", {\n  I18nextProvider(v) {\n    I18nextProvider = v;\n  },\n  initReactI18next(v) {\n    initReactI18next = v;\n  },\n  useTranslation(v) {\n    useTranslation = v;\n  }\n}, 8);\nlet getURL;\nmodule.link(\"../../app/utils/client\", {\n  getURL(v) {\n    getURL = v;\n  }\n}, 9);\nlet i18n, addSprinfToI18n, extractTranslationKeys, applyCustomTranslations, availableTranslationNamespaces, defaultTranslationNamespace, extractTranslationNamespaces;\nmodule.link(\"../../app/utils/lib/i18n\", {\n  i18n(v) {\n    i18n = v;\n  },\n  addSprinfToI18n(v) {\n    addSprinfToI18n = v;\n  },\n  extractTranslationKeys(v) {\n    extractTranslationKeys = v;\n  },\n  applyCustomTranslations(v) {\n    applyCustomTranslations = v;\n  },\n  availableTranslationNamespaces(v) {\n    availableTranslationNamespaces = v;\n  },\n  defaultTranslationNamespace(v) {\n    defaultTranslationNamespace = v;\n  },\n  extractTranslationNamespaces(v) {\n    extractTranslationNamespaces = v;\n  }\n}, 10);\nlet AppClientOrchestratorInstance;\nmodule.link(\"../apps/orchestrator\", {\n  AppClientOrchestratorInstance(v) {\n    AppClientOrchestratorInstance = v;\n  }\n}, 11);\nlet onLoggedIn;\nmodule.link(\"../lib/loggedIn\", {\n  onLoggedIn(v) {\n    onLoggedIn = v;\n  }\n}, 12);\nlet isRTLScriptLanguage;\nmodule.link(\"../lib/utils/isRTLScriptLanguage\", {\n  isRTLScriptLanguage(v) {\n    isRTLScriptLanguage = v;\n  }\n}, 13);\ni18n.use(I18NextHttpBackend).use(initReactI18next);\nconst useCustomTranslations = i18n => {\n  const customTranslations = useSetting('Custom_Translations');\n  const parsedCustomTranslations = useMemo(() => {\n    if (!customTranslations || typeof customTranslations !== 'string') {\n      return undefined;\n    }\n    try {\n      return JSON.parse(customTranslations);\n    } catch (e) {\n      console.error(e);\n      return undefined;\n    }\n  }, [customTranslations]);\n  useEffect(() => {\n    if (!parsedCustomTranslations) {\n      return;\n    }\n    applyCustomTranslations(i18n, parsedCustomTranslations);\n    const handleLanguageChanged = () => {\n      applyCustomTranslations(i18n, parsedCustomTranslations);\n    };\n    i18n.on('languageChanged', handleLanguageChanged);\n    return () => {\n      i18n.off('languageChanged', handleLanguageChanged);\n    };\n  }, [i18n, parsedCustomTranslations]);\n};\nconst localeCache = new Map();\nlet isI18nInitialized = false;\nconst useI18next = lng => {\n  // i18n.init is async, so there's a chance a race condition happens and it is initialized twice\n  // This breaks translations because it loads `lng` in the first init but not the second.\n  if (!isI18nInitialized) {\n    isI18nInitialized = true;\n    i18n.init({\n      lng,\n      fallbackLng: 'en',\n      ns: availableTranslationNamespaces,\n      defaultNS: defaultTranslationNamespace,\n      nsSeparator: '.',\n      resources: {\n        en: extractTranslationNamespaces(en)\n      },\n      partialBundledLanguages: true,\n      backend: {\n        loadPath: 'i18n/{{lng}}.json',\n        parse: function (data, _lngs) {\n          let namespaces = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n          return extractTranslationKeys(JSON.parse(data), namespaces);\n        },\n        request: (_options, url, _payload, callback) => {\n          const params = url.split('/');\n          const lng = params[params.length - 1];\n          let promise = localeCache.get(lng);\n          if (!promise) {\n            promise = fetch(getURL(url)).then(res => res.text());\n            localeCache.set(lng, promise);\n          }\n          promise.then(res => callback(null, {\n            data: res,\n            status: 200\n          }), () => callback(null, {\n            data: '',\n            status: 500\n          }));\n        }\n      },\n      react: {\n        useSuspense: true,\n        bindI18n: 'languageChanged loaded',\n        bindI18nStore: 'added removed'\n      },\n      interpolation: {\n        escapeValue: false\n      }\n    });\n  }\n  useEffect(() => {\n    i18n.changeLanguage(lng);\n  }, [lng]);\n  return i18n;\n};\nconst useAutoLanguage = () => {\n  var _window$navigator$use, _defaultUserLanguage$;\n  const serverLanguage = useSetting('Language', '');\n  const browserLanguage = normalizeLanguage((_window$navigator$use = window.navigator.userLanguage) !== null && _window$navigator$use !== void 0 ? _window$navigator$use : window.navigator.language);\n  const defaultUserLanguage = browserLanguage || serverLanguage || 'en';\n  // if the language is supported, if not remove the region\n  const suggestedLanguage = languages.includes(defaultUserLanguage) ? defaultUserLanguage : (_defaultUserLanguage$ = defaultUserLanguage.split('-').shift()) !== null && _defaultUserLanguage$ !== void 0 ? _defaultUserLanguage$ : 'en';\n  // usually that value is set based on the user's config language\n  const [language] = useLocalStorage('userLanguage', suggestedLanguage);\n  document.documentElement.classList[isRTLScriptLanguage(language) ? 'add' : 'remove']('rtl');\n  document.documentElement.setAttribute('dir', isRTLScriptLanguage(language) ? 'rtl' : 'ltr');\n  document.documentElement.lang = language;\n  // if user has no language set, we should set it to the default language\n  return language || suggestedLanguage;\n};\nconst getLanguageName = (code, lng) => {\n  try {\n    var _lang$of;\n    const lang = new Intl.DisplayNames([lng], {\n      type: 'language'\n    });\n    return (_lang$of = lang.of(code)) !== null && _lang$of !== void 0 ? _lang$of : code;\n  } catch (e) {\n    return code;\n  }\n};\nconst TranslationProvider = _ref => {\n  let {\n    children\n  } = _ref;\n  const loadLocale = useMethod('loadLocale');\n  const language = useAutoLanguage();\n  const i18nextInstance = useI18next(language);\n  useCustomTranslations(i18nextInstance);\n  const availableLanguages = useMemo(() => [{\n    en: 'Default',\n    name: i18nextInstance.t('Default'),\n    ogName: i18nextInstance.t('Default'),\n    key: ''\n  }, ...[...new Set([...i18nextInstance.languages, ...languages])].map(key => ({\n    en: key,\n    name: getLanguageName(key, language),\n    ogName: getLanguageName(key, key),\n    key\n  }))], [language, i18nextInstance]);\n  useEffect(() => {\n    if (moment.locales().includes(language.toLowerCase())) {\n      moment.locale(language);\n      return;\n    }\n    const locale = !availableLanguages.find(lng => lng.key === language) ? language.split('-').shift() : language;\n    loadLocale(locale !== null && locale !== void 0 ? locale : language).then(localeSrc => {\n      localeSrc && Function(localeSrc).call({\n        moment\n      });\n      moment.locale(language);\n    }).catch(error => {\n      moment.locale('en');\n      console.error('Error loading moment locale:', error);\n    });\n  }, [language, loadLocale, availableLanguages]);\n  useEffect(() => onLoggedIn(() => {\n    AppClientOrchestratorInstance.getAppClientManager().initialize();\n    AppClientOrchestratorInstance.load();\n  }), []);\n  return /*#__PURE__*/React.createElement(I18nextProvider, {\n    i18n: i18nextInstance\n  }, /*#__PURE__*/React.createElement(TranslationProviderInner, {\n    children: children,\n    availableLanguages: availableLanguages\n  }));\n};\n/**\n * I was forced to create this component to keep the api useTranslation from rocketchat\n * rocketchat useTranslation invalidates the provider content, triggering all the places that use it\n * i18next triggers a re-render inside useTranslation, since now we are using 100% of the i18next\n * the only way to invalidate after changing the language in a safe way is using the useTranslation from i8next\n * and invalidating the provider content\n */\n// eslint-disable-next-line react/no-multi-comp\nconst TranslationProviderInner = _ref2 => {\n  let {\n    children,\n    availableLanguages\n  } = _ref2;\n  const {\n    t,\n    i18n\n  } = useTranslation();\n  const value = useMemo(() => ({\n    language: i18n.language,\n    languages: availableLanguages,\n    loadLanguage: async language => {\n      i18n.changeLanguage(language);\n    },\n    translate: Object.assign(addSprinfToI18n(t), {\n      has: (key, options) => key && i18n.exists(key, options)\n    })\n  }), [availableLanguages, i18n, t]);\n  return /*#__PURE__*/React.createElement(TranslationContext.Provider, {\n    children: children,\n    value: value\n  });\n};\nmodule.exportDefault(TranslationProvider);","map":{"version":3,"names":["useLocalStorage","module","link","v","languages","default","en","normalizeLanguage","useMethod","useSetting","TranslationContext","I18NextHttpBackend","moment","React","useEffect","useMemo","I18nextProvider","initReactI18next","useTranslation","getURL","i18n","addSprinfToI18n","extractTranslationKeys","applyCustomTranslations","availableTranslationNamespaces","defaultTranslationNamespace","extractTranslationNamespaces","AppClientOrchestratorInstance","onLoggedIn","isRTLScriptLanguage","use","useCustomTranslations","customTranslations","parsedCustomTranslations","undefined","JSON","parse","e","console","error","handleLanguageChanged","on","off","localeCache","Map","isI18nInitialized","useI18next","lng","init","fallbackLng","ns","defaultNS","nsSeparator","resources","partialBundledLanguages","backend","loadPath","data","_lngs","namespaces","arguments","length","request","_options","url","_payload","callback","params","split","promise","get","fetch","then","res","text","set","status","react","useSuspense","bindI18n","bindI18nStore","interpolation","escapeValue","changeLanguage","useAutoLanguage","_window$navigator$use","_defaultUserLanguage$","serverLanguage","browserLanguage","window","navigator","userLanguage","language","defaultUserLanguage","suggestedLanguage","includes","shift","document","documentElement","classList","setAttribute","lang","getLanguageName","code","_lang$of","Intl","DisplayNames","type","of","TranslationProvider","_ref","children","loadLocale","i18nextInstance","availableLanguages","name","t","ogName","key","Set","map","locales","toLowerCase","locale","find","localeSrc","Function","call","catch","getAppClientManager","initialize","load","createElement","TranslationProviderInner","_ref2","value","loadLanguage","translate","Object","assign","has","options","exists","Provider","exportDefault"],"sources":["client/providers/TranslationProvider.tsx"],"sourcesContent":["import { useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport languages from '@rocket.chat/i18n/dist/languages';\nimport en from '@rocket.chat/i18n/src/locales/en.i18n.json';\nimport { normalizeLanguage } from '@rocket.chat/tools';\nimport type { TranslationContextValue } from '@rocket.chat/ui-contexts';\nimport { useMethod, useSetting, TranslationContext } from '@rocket.chat/ui-contexts';\nimport type i18next from 'i18next';\nimport I18NextHttpBackend from 'i18next-http-backend';\nimport moment from 'moment';\nimport type { ReactElement, ReactNode } from 'react';\nimport React, { useEffect, useMemo } from 'react';\nimport { I18nextProvider, initReactI18next, useTranslation } from 'react-i18next';\n\nimport { getURL } from '../../app/utils/client';\nimport {\n\ti18n,\n\taddSprinfToI18n,\n\textractTranslationKeys,\n\tapplyCustomTranslations,\n\tavailableTranslationNamespaces,\n\tdefaultTranslationNamespace,\n\textractTranslationNamespaces,\n} from '../../app/utils/lib/i18n';\nimport { AppClientOrchestratorInstance } from '../apps/orchestrator';\nimport { onLoggedIn } from '../lib/loggedIn';\nimport { isRTLScriptLanguage } from '../lib/utils/isRTLScriptLanguage';\n\ni18n.use(I18NextHttpBackend).use(initReactI18next);\n\nconst useCustomTranslations = (i18n: typeof i18next) => {\n\tconst customTranslations = useSetting('Custom_Translations');\n\n\tconst parsedCustomTranslations = useMemo((): Record<string, Record<string, string>> | undefined => {\n\t\tif (!customTranslations || typeof customTranslations !== 'string') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\ttry {\n\t\t\treturn JSON.parse(customTranslations);\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t\treturn undefined;\n\t\t}\n\t}, [customTranslations]);\n\n\tuseEffect(() => {\n\t\tif (!parsedCustomTranslations) {\n\t\t\treturn;\n\t\t}\n\n\t\tapplyCustomTranslations(i18n, parsedCustomTranslations);\n\n\t\tconst handleLanguageChanged = (): void => {\n\t\t\tapplyCustomTranslations(i18n, parsedCustomTranslations);\n\t\t};\n\n\t\ti18n.on('languageChanged', handleLanguageChanged);\n\n\t\treturn () => {\n\t\t\ti18n.off('languageChanged', handleLanguageChanged);\n\t\t};\n\t}, [i18n, parsedCustomTranslations]);\n};\n\nconst localeCache = new Map<string, Promise<string>>();\nlet isI18nInitialized = false;\n\nconst useI18next = (lng: string): typeof i18next => {\n\t// i18n.init is async, so there's a chance a race condition happens and it is initialized twice\n\t// This breaks translations because it loads `lng` in the first init but not the second.\n\tif (!isI18nInitialized) {\n\t\tisI18nInitialized = true;\n\t\ti18n.init({\n\t\t\tlng,\n\t\t\tfallbackLng: 'en',\n\t\t\tns: availableTranslationNamespaces,\n\t\t\tdefaultNS: defaultTranslationNamespace,\n\t\t\tnsSeparator: '.',\n\t\t\tresources: {\n\t\t\t\ten: extractTranslationNamespaces(en),\n\t\t\t},\n\t\t\tpartialBundledLanguages: true,\n\t\t\tbackend: {\n\t\t\t\tloadPath: 'i18n/{{lng}}.json',\n\t\t\t\tparse: (data: string, _lngs?: string | string[], namespaces: string | string[] = []) =>\n\t\t\t\t\textractTranslationKeys(JSON.parse(data), namespaces),\n\t\t\t\trequest: (_options: unknown, url: string, _payload: unknown, callback: (error: unknown, data: unknown) => void) => {\n\t\t\t\t\tconst params = url.split('/');\n\n\t\t\t\t\tconst lng = params[params.length - 1];\n\n\t\t\t\t\tlet promise = localeCache.get(lng);\n\n\t\t\t\t\tif (!promise) {\n\t\t\t\t\t\tpromise = fetch(getURL(url)).then((res) => res.text());\n\t\t\t\t\t\tlocaleCache.set(lng, promise);\n\t\t\t\t\t}\n\n\t\t\t\t\tpromise.then(\n\t\t\t\t\t\t(res) => callback(null, { data: res, status: 200 }),\n\t\t\t\t\t\t() => callback(null, { data: '', status: 500 }),\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t},\n\t\t\treact: {\n\t\t\t\tuseSuspense: true,\n\t\t\t\tbindI18n: 'languageChanged loaded',\n\t\t\t\tbindI18nStore: 'added removed',\n\t\t\t},\n\t\t\tinterpolation: {\n\t\t\t\tescapeValue: false,\n\t\t\t},\n\t\t});\n\t}\n\n\tuseEffect(() => {\n\t\ti18n.changeLanguage(lng);\n\t}, [lng]);\n\n\treturn i18n;\n};\n\nconst useAutoLanguage = () => {\n\tconst serverLanguage = useSetting('Language', '');\n\tconst browserLanguage = normalizeLanguage(window.navigator.userLanguage ?? window.navigator.language);\n\tconst defaultUserLanguage = browserLanguage || serverLanguage || 'en';\n\n\t// if the language is supported, if not remove the region\n\tconst suggestedLanguage = languages.includes(defaultUserLanguage)\n\t\t? defaultUserLanguage\n\t\t: (defaultUserLanguage.split('-').shift() ?? 'en');\n\n\t// usually that value is set based on the user's config language\n\tconst [language] = useLocalStorage('userLanguage', suggestedLanguage);\n\n\tdocument.documentElement.classList[isRTLScriptLanguage(language) ? 'add' : 'remove']('rtl');\n\tdocument.documentElement.setAttribute('dir', isRTLScriptLanguage(language) ? 'rtl' : 'ltr');\n\tdocument.documentElement.lang = language;\n\n\t// if user has no language set, we should set it to the default language\n\treturn language || suggestedLanguage;\n};\n\nconst getLanguageName = (code: string, lng: string): string => {\n\ttry {\n\t\tconst lang = new Intl.DisplayNames([lng], { type: 'language' });\n\t\treturn lang.of(code) ?? code;\n\t} catch (e) {\n\t\treturn code;\n\t}\n};\n\ntype TranslationProviderProps = {\n\tchildren: ReactNode;\n};\n\nconst TranslationProvider = ({ children }: TranslationProviderProps): ReactElement => {\n\tconst loadLocale = useMethod('loadLocale');\n\n\tconst language = useAutoLanguage();\n\tconst i18nextInstance = useI18next(language);\n\tuseCustomTranslations(i18nextInstance);\n\n\tconst availableLanguages = useMemo(\n\t\t() => [\n\t\t\t{\n\t\t\t\ten: 'Default',\n\t\t\t\tname: i18nextInstance.t('Default'),\n\t\t\t\togName: i18nextInstance.t('Default'),\n\t\t\t\tkey: '',\n\t\t\t},\n\t\t\t...[...new Set([...i18nextInstance.languages, ...languages])].map((key) => ({\n\t\t\t\ten: key,\n\t\t\t\tname: getLanguageName(key, language),\n\t\t\t\togName: getLanguageName(key, key),\n\t\t\t\tkey,\n\t\t\t})),\n\t\t],\n\t\t[language, i18nextInstance],\n\t);\n\n\tuseEffect(() => {\n\t\tif (moment.locales().includes(language.toLowerCase())) {\n\t\t\tmoment.locale(language);\n\t\t\treturn;\n\t\t}\n\n\t\tconst locale = !availableLanguages.find((lng) => lng.key === language) ? language.split('-').shift() : language;\n\n\t\tloadLocale(locale ?? language)\n\t\t\t.then((localeSrc) => {\n\t\t\t\tlocaleSrc && Function(localeSrc).call({ moment });\n\t\t\t\tmoment.locale(language);\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tmoment.locale('en');\n\t\t\t\tconsole.error('Error loading moment locale:', error);\n\t\t\t});\n\t}, [language, loadLocale, availableLanguages]);\n\n\tuseEffect(\n\t\t() =>\n\t\t\tonLoggedIn(() => {\n\t\t\t\tAppClientOrchestratorInstance.getAppClientManager().initialize();\n\t\t\t\tAppClientOrchestratorInstance.load();\n\t\t\t}),\n\t\t[],\n\t);\n\n\treturn (\n\t\t<I18nextProvider i18n={i18nextInstance}>\n\t\t\t<TranslationProviderInner children={children} availableLanguages={availableLanguages} />\n\t\t</I18nextProvider>\n\t);\n};\n\n/**\n * I was forced to create this component to keep the api useTranslation from rocketchat\n * rocketchat useTranslation invalidates the provider content, triggering all the places that use it\n * i18next triggers a re-render inside useTranslation, since now we are using 100% of the i18next\n * the only way to invalidate after changing the language in a safe way is using the useTranslation from i8next\n * and invalidating the provider content\n */\n// eslint-disable-next-line react/no-multi-comp\nconst TranslationProviderInner = ({\n\tchildren,\n\tavailableLanguages,\n}: {\n\tchildren: ReactNode;\n\tavailableLanguages: {\n\t\ten: string;\n\t\tname: string;\n\t\togName: string;\n\t\tkey: string;\n\t}[];\n}): ReactElement => {\n\tconst { t, i18n } = useTranslation();\n\n\tconst value: TranslationContextValue = useMemo(\n\t\t() => ({\n\t\t\tlanguage: i18n.language,\n\t\t\tlanguages: availableLanguages,\n\t\t\tloadLanguage: async (language: string) => {\n\t\t\t\ti18n.changeLanguage(language);\n\t\t\t},\n\t\t\ttranslate: Object.assign(addSprinfToI18n(t), {\n\t\t\t\thas: ((key, options) => key && i18n.exists(key, options)) as TranslationContextValue['translate']['has'],\n\t\t\t}),\n\t\t}),\n\t\t[availableLanguages, i18n, t],\n\t);\n\n\treturn <TranslationContext.Provider children={children} value={value} />;\n};\n\nexport default TranslationProvider;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"e93d0f5b2b35776c4f328385dadfee61eb0dc773"}
