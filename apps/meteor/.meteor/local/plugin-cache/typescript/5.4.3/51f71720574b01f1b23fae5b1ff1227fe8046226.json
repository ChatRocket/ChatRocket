{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/providers/TranslationProvider.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/providers/TranslationProvider.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/providers/TranslationProvider.tsx","inputSourceMap":{"version":3,"file":"client/providers/TranslationProvider.tsx","sourceRoot":"","sources":["client/providers/TranslationProvider.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,eAAe,EAAE,MAAM,6BAA6B,CAAC;AAC9D,OAAO,SAAS,MAAM,kCAAkC,CAAC;AACzD,OAAO,EAAE,MAAM,4CAA4C,CAAC;AAC5D,OAAO,EAAE,iBAAiB,EAAE,MAAM,oBAAoB,CAAC;AAEvD,OAAO,EAAE,SAAS,EAAE,UAAU,EAAE,kBAAkB,EAAE,MAAM,0BAA0B,CAAC;AAErF,OAAO,kBAAkB,MAAM,sBAAsB,CAAC;AACtD,OAAO,MAAM,MAAM,QAAQ,CAAC;AAE5B,OAAO,KAAK,EAAE,EAAE,SAAS,EAAE,OAAO,EAAE,MAAM,OAAO,CAAC;AAClD,OAAO,EAAE,eAAe,EAAE,gBAAgB,EAAE,cAAc,EAAE,MAAM,eAAe,CAAC;AAElF,OAAO,EAAE,uBAAuB,EAAE,MAAM,uCAAuC,CAAC;AAChF,OAAO,EAAE,MAAM,EAAE,MAAM,wBAAwB,CAAC;AAChD,OAAO,EACN,IAAI,EACJ,eAAe,EACf,sBAAsB,EACtB,uBAAuB,EACvB,8BAA8B,EAC9B,2BAA2B,EAC3B,4BAA4B,GAC5B,MAAM,0BAA0B,CAAC;AAClC,OAAO,EAAE,6BAA6B,EAAE,MAAM,sBAAsB,CAAC;AACrE,OAAO,EAAE,mBAAmB,EAAE,MAAM,kCAAkC,CAAC;AAEvE,IAAI,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;AAEnD,MAAM,qBAAqB,GAAG,CAAC,IAAoB,EAAE,EAAE;IACtD,MAAM,kBAAkB,GAAG,UAAU,CAAC,qBAAqB,CAAC,CAAC;IAE7D,MAAM,wBAAwB,GAAG,OAAO,CAAC,GAAuD,EAAE;QACjG,IAAI,CAAC,kBAAkB,IAAI,OAAO,kBAAkB,KAAK,QAAQ,EAAE,CAAC;YACnE,OAAO,SAAS,CAAC;QAClB,CAAC;QAED,IAAI,CAAC;YACJ,OAAO,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC;QACvC,CAAC;QAAC,OAAO,CAAC,EAAE,CAAC;YACZ,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YACjB,OAAO,SAAS,CAAC;QAClB,CAAC;IACF,CAAC,EAAE,CAAC,kBAAkB,CAAC,CAAC,CAAC;IAEzB,SAAS,CAAC,GAAG,EAAE;QACd,IAAI,CAAC,wBAAwB,EAAE,CAAC;YAC/B,OAAO;QACR,CAAC;QAED,uBAAuB,CAAC,IAAI,EAAE,wBAAwB,CAAC,CAAC;QAExD,MAAM,qBAAqB,GAAG,GAAS,EAAE;YACxC,uBAAuB,CAAC,IAAI,EAAE,wBAAwB,CAAC,CAAC;QACzD,CAAC,CAAC;QAEF,IAAI,CAAC,EAAE,CAAC,iBAAiB,EAAE,qBAAqB,CAAC,CAAC;QAElD,OAAO,GAAG,EAAE;YACX,IAAI,CAAC,GAAG,CAAC,iBAAiB,EAAE,qBAAqB,CAAC,CAAC;QACpD,CAAC,CAAC;IACH,CAAC,EAAE,CAAC,IAAI,EAAE,wBAAwB,CAAC,CAAC,CAAC;AACtC,CAAC,CAAC;AAEF,MAAM,WAAW,GAAG,IAAI,GAAG,EAA2B,CAAC;AACvD,IAAI,iBAAiB,GAAG,KAAK,CAAC;AAE9B,MAAM,UAAU,GAAG,CAAC,GAAW,EAAkB,EAAE;IAClD,+FAA+F;IAC/F,wFAAwF;IACxF,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACxB,iBAAiB,GAAG,IAAI,CAAC;QACzB,IAAI,CAAC,IAAI,CAAC;YACT,GAAG;YACH,WAAW,EAAE,IAAI;YACjB,EAAE,EAAE,8BAA8B;YAClC,SAAS,EAAE,2BAA2B;YACtC,WAAW,EAAE,GAAG;YAChB,SAAS,EAAE;gBACV,EAAE,EAAE,4BAA4B,CAAC,EAAE,CAAC;aACpC;YACD,uBAAuB,EAAE,IAAI;YAC7B,OAAO,EAAE;gBACR,QAAQ,EAAE,mBAAmB;gBAC7B,KAAK,EAAE,CAAC,IAAY,EAAE,KAAyB,EAAE,aAAgC,EAAE,EAAE,EAAE,CACtF,sBAAsB,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,UAAU,CAAC;gBACrD,OAAO,EAAE,CAAC,QAAiB,EAAE,GAAW,EAAE,QAAiB,EAAE,QAAiD,EAAE,EAAE;oBACjH,MAAM,MAAM,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;oBAE9B,MAAM,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;oBAEtC,IAAI,OAAO,GAAG,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;oBAEnC,IAAI,CAAC,OAAO,EAAE,CAAC;wBACd,OAAO,GAAG,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC;wBACvD,WAAW,CAAC,GAAG,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;oBAC/B,CAAC;oBAED,OAAO,CAAC,IAAI,CACX,CAAC,GAAG,EAAE,EAAE,CAAC,QAAQ,CAAC,IAAI,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,EACnD,GAAG,EAAE,CAAC,QAAQ,CAAC,IAAI,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,CAC/C,CAAC;gBACH,CAAC;aACD;YACD,KAAK,EAAE;gBACN,WAAW,EAAE,IAAI;gBACjB,QAAQ,EAAE,wBAAwB;gBAClC,aAAa,EAAE,eAAe;aAC9B;YACD,aAAa,EAAE;gBACd,WAAW,EAAE,KAAK;aAClB;SACD,CAAC,CAAC;IACJ,CAAC;IAED,SAAS,CAAC,GAAG,EAAE;QACd,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC;IAC1B,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;IAEV,OAAO,IAAI,CAAC;AACb,CAAC,CAAC;AAEF,MAAM,eAAe,GAAG,GAAG,EAAE;IAC5B,MAAM,cAAc,GAAG,UAAU,CAAS,UAAU,CAAC,CAAC;IACtD,MAAM,eAAe,GAAG,iBAAiB,CAAC,MAAM,CAAC,SAAS,CAAC,YAAY,IAAI,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;IACtG,MAAM,mBAAmB,GAAG,eAAe,IAAI,cAAc,IAAI,IAAI,CAAC;IAEtE,yDAAyD;IACzD,MAAM,iBAAiB,GAAG,SAAS,CAAC,QAAQ,CAAC,mBAAmB,CAAC,CAAC,CAAC,CAAC,mBAAmB,CAAC,CAAC,CAAC,mBAAmB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,KAAK,EAAE,IAAI,IAAI,CAAC;IAEzI,gEAAgE;IAChE,MAAM,CAAC,QAAQ,CAAC,GAAG,eAAe,CAAC,cAAc,EAAE,iBAAiB,CAAC,CAAC;IAEtE,QAAQ,CAAC,eAAe,CAAC,SAAS,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,CAAC;IAC5F,QAAQ,CAAC,eAAe,CAAC,YAAY,CAAC,KAAK,EAAE,mBAAmB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;IAC5F,QAAQ,CAAC,eAAe,CAAC,IAAI,GAAG,QAAQ,CAAC;IAEzC,wEAAwE;IACxE,OAAO,QAAQ,IAAI,iBAAiB,CAAC;AACtC,CAAC,CAAC;AAEF,MAAM,eAAe,GAAG,CAAC,IAAY,EAAE,GAAW,EAAU,EAAE;IAC7D,IAAI,CAAC;QACJ,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC,YAAY,CAAC,CAAC,GAAG,CAAC,EAAE,EAAE,IAAI,EAAE,UAAU,EAAE,CAAC,CAAC;QAChE,OAAO,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC;IAC9B,CAAC;IAAC,OAAO,CAAC,EAAE,CAAC;QACZ,OAAO,IAAI,CAAC;IACb,CAAC;AACF,CAAC,CAAC;AAMF,MAAM,mBAAmB,GAAG,CAAC,EAAE,QAAQ,EAA4B,EAAgB,EAAE;IACpF,MAAM,UAAU,GAAG,SAAS,CAAC,YAAY,CAAC,CAAC;IAE3C,MAAM,QAAQ,GAAG,eAAe,EAAE,CAAC;IACnC,MAAM,eAAe,GAAG,UAAU,CAAC,QAAQ,CAAC,CAAC;IAC7C,qBAAqB,CAAC,eAAe,CAAC,CAAC;IAEvC,MAAM,kBAAkB,GAAG,OAAO,CACjC,GAAG,EAAE,CAAC;QACL;YACC,EAAE,EAAE,SAAS;YACb,IAAI,EAAE,eAAe,CAAC,CAAC,CAAC,SAAS,CAAC;YAClC,MAAM,EAAE,eAAe,CAAC,CAAC,CAAC,SAAS,CAAC;YACpC,GAAG,EAAE,EAAE;SACP;QACD,GAAG,CAAC,GAAG,IAAI,GAAG,CAAC,CAAC,GAAG,eAAe,CAAC,SAAS,EAAE,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;YAC3E,EAAE,EAAE,GAAG;YACP,IAAI,EAAE,eAAe,CAAC,GAAG,EAAE,QAAQ,CAAC;YACpC,MAAM,EAAE,eAAe,CAAC,GAAG,EAAE,GAAG,CAAC;YACjC,GAAG;SACH,CAAC,CAAC;KACH,EACD,CAAC,QAAQ,EAAE,eAAe,CAAC,CAC3B,CAAC;IAEF,SAAS,CAAC,GAAG,EAAE;QACd,IAAI,MAAM,CAAC,OAAO,EAAE,CAAC,QAAQ,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,EAAE,CAAC;YACvD,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;YACxB,OAAO;QACR,CAAC;QAED,MAAM,MAAM,GAAG,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,GAAG,KAAK,QAAQ,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC;QAEhH,UAAU,CAAC,MAAM,IAAI,QAAQ,CAAC;aAC5B,IAAI,CAAC,CAAC,SAAS,EAAE,EAAE;YACnB,SAAS,IAAI,QAAQ,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,CAAC,CAAC;YAClD,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QACzB,CAAC,CAAC;aACD,KAAK,CAAC,CAAC,KAAK,EAAE,EAAE;YAChB,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YACpB,OAAO,CAAC,KAAK,CAAC,8BAA8B,EAAE,KAAK,CAAC,CAAC;QACtD,CAAC,CAAC,CAAC;IACL,CAAC,EAAE,CAAC,QAAQ,EAAE,UAAU,EAAE,kBAAkB,CAAC,CAAC,CAAC;IAE/C,SAAS,CAAC,GAAG,EAAE;QACd,MAAM,EAAE,GAAG,GAAG,EAAE;YACf,6BAA6B,CAAC,mBAAmB,EAAE,CAAC,UAAU,EAAE,CAAC;YACjE,6BAA6B,CAAC,IAAI,EAAE,CAAC;QACtC,CAAC,CAAC;QACF,uBAAuB,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;QACpC,OAAO,GAAG,EAAE,CAAC,uBAAuB,CAAC,GAAG,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;IACvD,CAAC,EAAE,EAAE,CAAC,CAAC;IAEP,OAAO,CACN,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,eAAe,CAAC,CACtC;GAAA,CAAC,wBAAwB,CAAC,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC,kBAAkB,CAAC,CAAC,kBAAkB,CAAC,EACtF;EAAA,EAAE,eAAe,CAAC,CAClB,CAAC;AACH,CAAC,CAAC;AAEF;;;;;;GAMG;AACH,+CAA+C;AAC/C,MAAM,wBAAwB,GAAG,CAAC,EACjC,QAAQ,EACR,kBAAkB,GASlB,EAAgB,EAAE;IAClB,MAAM,EAAE,CAAC,EAAE,IAAI,EAAE,GAAG,cAAc,EAAE,CAAC;IAErC,MAAM,KAAK,GAA4B,OAAO,CAC7C,GAAG,EAAE,CAAC,CAAC;QACN,QAAQ,EAAE,IAAI,CAAC,QAAQ;QACvB,SAAS,EAAE,kBAAkB;QAC7B,YAAY,EAAE,KAAK,EAAE,QAAgB,EAAE,EAAE;YACxC,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;QAC/B,CAAC;QACD,SAAS,EAAE,MAAM,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC,EAAE;YAC5C,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,OAAO,EAAE,EAAE,CAAC,GAAG,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,EAAE,OAAO,CAAC,CAAgD;SACxG,CAAC;KACF,CAAC,EACF,CAAC,kBAAkB,EAAE,IAAI,EAAE,CAAC,CAAC,CAC7B,CAAC;IAEF,OAAO,CAAC,kBAAkB,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,EAAG,CAAC;AAC1E,CAAC,CAAC;AAEF,eAAe,mBAAmB,CAAC","sourcesContent":["import { useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport languages from '@rocket.chat/i18n/dist/languages';\nimport en from '@rocket.chat/i18n/src/locales/en.i18n.json';\nimport { normalizeLanguage } from '@rocket.chat/tools';\nimport type { TranslationContextValue } from '@rocket.chat/ui-contexts';\nimport { useMethod, useSetting, TranslationContext } from '@rocket.chat/ui-contexts';\nimport type i18next from 'i18next';\nimport I18NextHttpBackend from 'i18next-http-backend';\nimport moment from 'moment';\nimport type { ReactElement, ReactNode } from 'react';\nimport React, { useEffect, useMemo } from 'react';\nimport { I18nextProvider, initReactI18next, useTranslation } from 'react-i18next';\n\nimport { CachedCollectionManager } from '../../app/ui-cached-collection/client';\nimport { getURL } from '../../app/utils/client';\nimport {\n\ti18n,\n\taddSprinfToI18n,\n\textractTranslationKeys,\n\tapplyCustomTranslations,\n\tavailableTranslationNamespaces,\n\tdefaultTranslationNamespace,\n\textractTranslationNamespaces,\n} from '../../app/utils/lib/i18n';\nimport { AppClientOrchestratorInstance } from '../apps/orchestrator';\nimport { isRTLScriptLanguage } from '../lib/utils/isRTLScriptLanguage';\n\ni18n.use(I18NextHttpBackend).use(initReactI18next);\n\nconst useCustomTranslations = (i18n: typeof i18next) => {\n\tconst customTranslations = useSetting('Custom_Translations');\n\n\tconst parsedCustomTranslations = useMemo((): Record<string, Record<string, string>> | undefined => {\n\t\tif (!customTranslations || typeof customTranslations !== 'string') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\ttry {\n\t\t\treturn JSON.parse(customTranslations);\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t\treturn undefined;\n\t\t}\n\t}, [customTranslations]);\n\n\tuseEffect(() => {\n\t\tif (!parsedCustomTranslations) {\n\t\t\treturn;\n\t\t}\n\n\t\tapplyCustomTranslations(i18n, parsedCustomTranslations);\n\n\t\tconst handleLanguageChanged = (): void => {\n\t\t\tapplyCustomTranslations(i18n, parsedCustomTranslations);\n\t\t};\n\n\t\ti18n.on('languageChanged', handleLanguageChanged);\n\n\t\treturn () => {\n\t\t\ti18n.off('languageChanged', handleLanguageChanged);\n\t\t};\n\t}, [i18n, parsedCustomTranslations]);\n};\n\nconst localeCache = new Map<string, Promise<string>>();\nlet isI18nInitialized = false;\n\nconst useI18next = (lng: string): typeof i18next => {\n\t// i18n.init is async, so there's a chance a race condition happens and it is initialized twice\n\t// This breaks translations because it loads `lng` in the first init but not the second.\n\tif (!isI18nInitialized) {\n\t\tisI18nInitialized = true;\n\t\ti18n.init({\n\t\t\tlng,\n\t\t\tfallbackLng: 'en',\n\t\t\tns: availableTranslationNamespaces,\n\t\t\tdefaultNS: defaultTranslationNamespace,\n\t\t\tnsSeparator: '.',\n\t\t\tresources: {\n\t\t\t\ten: extractTranslationNamespaces(en),\n\t\t\t},\n\t\t\tpartialBundledLanguages: true,\n\t\t\tbackend: {\n\t\t\t\tloadPath: 'i18n/{{lng}}.json',\n\t\t\t\tparse: (data: string, _lngs?: string | string[], namespaces: string | string[] = []) =>\n\t\t\t\t\textractTranslationKeys(JSON.parse(data), namespaces),\n\t\t\t\trequest: (_options: unknown, url: string, _payload: unknown, callback: (error: unknown, data: unknown) => void) => {\n\t\t\t\t\tconst params = url.split('/');\n\n\t\t\t\t\tconst lng = params[params.length - 1];\n\n\t\t\t\t\tlet promise = localeCache.get(lng);\n\n\t\t\t\t\tif (!promise) {\n\t\t\t\t\t\tpromise = fetch(getURL(url)).then((res) => res.text());\n\t\t\t\t\t\tlocaleCache.set(lng, promise);\n\t\t\t\t\t}\n\n\t\t\t\t\tpromise.then(\n\t\t\t\t\t\t(res) => callback(null, { data: res, status: 200 }),\n\t\t\t\t\t\t() => callback(null, { data: '', status: 500 }),\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t},\n\t\t\treact: {\n\t\t\t\tuseSuspense: true,\n\t\t\t\tbindI18n: 'languageChanged loaded',\n\t\t\t\tbindI18nStore: 'added removed',\n\t\t\t},\n\t\t\tinterpolation: {\n\t\t\t\tescapeValue: false,\n\t\t\t},\n\t\t});\n\t}\n\n\tuseEffect(() => {\n\t\ti18n.changeLanguage(lng);\n\t}, [lng]);\n\n\treturn i18n;\n};\n\nconst useAutoLanguage = () => {\n\tconst serverLanguage = useSetting<string>('Language');\n\tconst browserLanguage = normalizeLanguage(window.navigator.userLanguage ?? window.navigator.language);\n\tconst defaultUserLanguage = browserLanguage || serverLanguage || 'en';\n\n\t// if the language is supported, if not remove the region\n\tconst suggestedLanguage = languages.includes(defaultUserLanguage) ? defaultUserLanguage : defaultUserLanguage.split('-').shift() ?? 'en';\n\n\t// usually that value is set based on the user's config language\n\tconst [language] = useLocalStorage('userLanguage', suggestedLanguage);\n\n\tdocument.documentElement.classList[isRTLScriptLanguage(language) ? 'add' : 'remove']('rtl');\n\tdocument.documentElement.setAttribute('dir', isRTLScriptLanguage(language) ? 'rtl' : 'ltr');\n\tdocument.documentElement.lang = language;\n\n\t// if user has no language set, we should set it to the default language\n\treturn language || suggestedLanguage;\n};\n\nconst getLanguageName = (code: string, lng: string): string => {\n\ttry {\n\t\tconst lang = new Intl.DisplayNames([lng], { type: 'language' });\n\t\treturn lang.of(code) ?? code;\n\t} catch (e) {\n\t\treturn code;\n\t}\n};\n\ntype TranslationProviderProps = {\n\tchildren: ReactNode;\n};\n\nconst TranslationProvider = ({ children }: TranslationProviderProps): ReactElement => {\n\tconst loadLocale = useMethod('loadLocale');\n\n\tconst language = useAutoLanguage();\n\tconst i18nextInstance = useI18next(language);\n\tuseCustomTranslations(i18nextInstance);\n\n\tconst availableLanguages = useMemo(\n\t\t() => [\n\t\t\t{\n\t\t\t\ten: 'Default',\n\t\t\t\tname: i18nextInstance.t('Default'),\n\t\t\t\togName: i18nextInstance.t('Default'),\n\t\t\t\tkey: '',\n\t\t\t},\n\t\t\t...[...new Set([...i18nextInstance.languages, ...languages])].map((key) => ({\n\t\t\t\ten: key,\n\t\t\t\tname: getLanguageName(key, language),\n\t\t\t\togName: getLanguageName(key, key),\n\t\t\t\tkey,\n\t\t\t})),\n\t\t],\n\t\t[language, i18nextInstance],\n\t);\n\n\tuseEffect(() => {\n\t\tif (moment.locales().includes(language.toLowerCase())) {\n\t\t\tmoment.locale(language);\n\t\t\treturn;\n\t\t}\n\n\t\tconst locale = !availableLanguages.find((lng) => lng.key === language) ? language.split('-').shift() : language;\n\n\t\tloadLocale(locale ?? language)\n\t\t\t.then((localeSrc) => {\n\t\t\t\tlocaleSrc && Function(localeSrc).call({ moment });\n\t\t\t\tmoment.locale(language);\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tmoment.locale('en');\n\t\t\t\tconsole.error('Error loading moment locale:', error);\n\t\t\t});\n\t}, [language, loadLocale, availableLanguages]);\n\n\tuseEffect(() => {\n\t\tconst cb = () => {\n\t\t\tAppClientOrchestratorInstance.getAppClientManager().initialize();\n\t\t\tAppClientOrchestratorInstance.load();\n\t\t};\n\t\tCachedCollectionManager.onLogin(cb);\n\t\treturn () => CachedCollectionManager.off('login', cb);\n\t}, []);\n\n\treturn (\n\t\t<I18nextProvider i18n={i18nextInstance}>\n\t\t\t<TranslationProviderInner children={children} availableLanguages={availableLanguages} />\n\t\t</I18nextProvider>\n\t);\n};\n\n/**\n * I was forced to create this component to keep the api useTranslation from rocketchat\n * rocketchat useTranslation invalidates the provider content, triggering all the places that use it\n * i18next triggers a re-render inside useTranslation, since now we are using 100% of the i18next\n * the only way to invalidate after changing the language in a safe way is using the useTranslation from i8next\n * and invalidating the provider content\n */\n// eslint-disable-next-line react/no-multi-comp\nconst TranslationProviderInner = ({\n\tchildren,\n\tavailableLanguages,\n}: {\n\tchildren: ReactNode;\n\tavailableLanguages: {\n\t\ten: string;\n\t\tname: string;\n\t\togName: string;\n\t\tkey: string;\n\t}[];\n}): ReactElement => {\n\tconst { t, i18n } = useTranslation();\n\n\tconst value: TranslationContextValue = useMemo(\n\t\t() => ({\n\t\t\tlanguage: i18n.language,\n\t\t\tlanguages: availableLanguages,\n\t\t\tloadLanguage: async (language: string) => {\n\t\t\t\ti18n.changeLanguage(language);\n\t\t\t},\n\t\t\ttranslate: Object.assign(addSprinfToI18n(t), {\n\t\t\t\thas: ((key, options) => key && i18n.exists(key, options)) as TranslationContextValue['translate']['has'],\n\t\t\t}),\n\t\t}),\n\t\t[availableLanguages, i18n, t],\n\t);\n\n\treturn <TranslationContext.Provider children={children} value={value} />;\n};\n\nexport default TranslationProvider;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/providers/TranslationProvider.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/providers/TranslationProvider.tsx","inputSourceMap":{"version":3,"file":"client/providers/TranslationProvider.tsx","sourceRoot":"","sources":["client/providers/TranslationProvider.tsx"],"names":[],"mappings":"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","sourcesContent":["import { useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport languages from '@rocket.chat/i18n/dist/languages';\nimport en from '@rocket.chat/i18n/src/locales/en.i18n.json';\nimport { normalizeLanguage } from '@rocket.chat/tools';\nimport type { TranslationContextValue } from '@rocket.chat/ui-contexts';\nimport { useMethod, useSetting, TranslationContext } from '@rocket.chat/ui-contexts';\nimport type i18next from 'i18next';\nimport I18NextHttpBackend from 'i18next-http-backend';\nimport moment from 'moment';\nimport type { ReactElement, ReactNode } from 'react';\nimport React, { useEffect, useMemo } from 'react';\nimport { I18nextProvider, initReactI18next, useTranslation } from 'react-i18next';\n\nimport { CachedCollectionManager } from '../../app/ui-cached-collection/client';\nimport { getURL } from '../../app/utils/client';\nimport {\n\ti18n,\n\taddSprinfToI18n,\n\textractTranslationKeys,\n\tapplyCustomTranslations,\n\tavailableTranslationNamespaces,\n\tdefaultTranslationNamespace,\n\textractTranslationNamespaces,\n} from '../../app/utils/lib/i18n';\nimport { AppClientOrchestratorInstance } from '../apps/orchestrator';\nimport { isRTLScriptLanguage } from '../lib/utils/isRTLScriptLanguage';\n\ni18n.use(I18NextHttpBackend).use(initReactI18next);\n\nconst useCustomTranslations = (i18n: typeof i18next) => {\n\tconst customTranslations = useSetting('Custom_Translations');\n\n\tconst parsedCustomTranslations = useMemo((): Record<string, Record<string, string>> | undefined => {\n\t\tif (!customTranslations || typeof customTranslations !== 'string') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\ttry {\n\t\t\treturn JSON.parse(customTranslations);\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t\treturn undefined;\n\t\t}\n\t}, [customTranslations]);\n\n\tuseEffect(() => {\n\t\tif (!parsedCustomTranslations) {\n\t\t\treturn;\n\t\t}\n\n\t\tapplyCustomTranslations(i18n, parsedCustomTranslations);\n\n\t\tconst handleLanguageChanged = (): void => {\n\t\t\tapplyCustomTranslations(i18n, parsedCustomTranslations);\n\t\t};\n\n\t\ti18n.on('languageChanged', handleLanguageChanged);\n\n\t\treturn () => {\n\t\t\ti18n.off('languageChanged', handleLanguageChanged);\n\t\t};\n\t}, [i18n, parsedCustomTranslations]);\n};\n\nconst localeCache = new Map<string, Promise<string>>();\nlet isI18nInitialized = false;\n\nconst useI18next = (lng: string): typeof i18next => {\n\t// i18n.init is async, so there's a chance a race condition happens and it is initialized twice\n\t// This breaks translations because it loads `lng` in the first init but not the second.\n\tif (!isI18nInitialized) {\n\t\tisI18nInitialized = true;\n\t\ti18n.init({\n\t\t\tlng,\n\t\t\tfallbackLng: 'en',\n\t\t\tns: availableTranslationNamespaces,\n\t\t\tdefaultNS: defaultTranslationNamespace,\n\t\t\tnsSeparator: '.',\n\t\t\tresources: {\n\t\t\t\ten: extractTranslationNamespaces(en),\n\t\t\t},\n\t\t\tpartialBundledLanguages: true,\n\t\t\tbackend: {\n\t\t\t\tloadPath: 'i18n/{{lng}}.json',\n\t\t\t\tparse: (data: string, _lngs?: string | string[], namespaces: string | string[] = []) =>\n\t\t\t\t\textractTranslationKeys(JSON.parse(data), namespaces),\n\t\t\t\trequest: (_options: unknown, url: string, _payload: unknown, callback: (error: unknown, data: unknown) => void) => {\n\t\t\t\t\tconst params = url.split('/');\n\n\t\t\t\t\tconst lng = params[params.length - 1];\n\n\t\t\t\t\tlet promise = localeCache.get(lng);\n\n\t\t\t\t\tif (!promise) {\n\t\t\t\t\t\tpromise = fetch(getURL(url)).then((res) => res.text());\n\t\t\t\t\t\tlocaleCache.set(lng, promise);\n\t\t\t\t\t}\n\n\t\t\t\t\tpromise.then(\n\t\t\t\t\t\t(res) => callback(null, { data: res, status: 200 }),\n\t\t\t\t\t\t() => callback(null, { data: '', status: 500 }),\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t},\n\t\t\treact: {\n\t\t\t\tuseSuspense: true,\n\t\t\t\tbindI18n: 'languageChanged loaded',\n\t\t\t\tbindI18nStore: 'added removed',\n\t\t\t},\n\t\t\tinterpolation: {\n\t\t\t\tescapeValue: false,\n\t\t\t},\n\t\t});\n\t}\n\n\tuseEffect(() => {\n\t\ti18n.changeLanguage(lng);\n\t}, [lng]);\n\n\treturn i18n;\n};\n\nconst useAutoLanguage = () => {\n\tconst serverLanguage = useSetting<string>('Language');\n\tconst browserLanguage = normalizeLanguage(window.navigator.userLanguage ?? window.navigator.language);\n\tconst defaultUserLanguage = browserLanguage || serverLanguage || 'en';\n\n\t// if the language is supported, if not remove the region\n\tconst suggestedLanguage = languages.includes(defaultUserLanguage) ? defaultUserLanguage : defaultUserLanguage.split('-').shift() ?? 'en';\n\n\t// usually that value is set based on the user's config language\n\tconst [language] = useLocalStorage('userLanguage', suggestedLanguage);\n\n\tdocument.documentElement.classList[isRTLScriptLanguage(language) ? 'add' : 'remove']('rtl');\n\tdocument.documentElement.setAttribute('dir', isRTLScriptLanguage(language) ? 'rtl' : 'ltr');\n\tdocument.documentElement.lang = language;\n\n\t// if user has no language set, we should set it to the default language\n\treturn language || suggestedLanguage;\n};\n\nconst getLanguageName = (code: string, lng: string): string => {\n\ttry {\n\t\tconst lang = new Intl.DisplayNames([lng], { type: 'language' });\n\t\treturn lang.of(code) ?? code;\n\t} catch (e) {\n\t\treturn code;\n\t}\n};\n\ntype TranslationProviderProps = {\n\tchildren: ReactNode;\n};\n\nconst TranslationProvider = ({ children }: TranslationProviderProps): ReactElement => {\n\tconst loadLocale = useMethod('loadLocale');\n\n\tconst language = useAutoLanguage();\n\tconst i18nextInstance = useI18next(language);\n\tuseCustomTranslations(i18nextInstance);\n\n\tconst availableLanguages = useMemo(\n\t\t() => [\n\t\t\t{\n\t\t\t\ten: 'Default',\n\t\t\t\tname: i18nextInstance.t('Default'),\n\t\t\t\togName: i18nextInstance.t('Default'),\n\t\t\t\tkey: '',\n\t\t\t},\n\t\t\t...[...new Set([...i18nextInstance.languages, ...languages])].map((key) => ({\n\t\t\t\ten: key,\n\t\t\t\tname: getLanguageName(key, language),\n\t\t\t\togName: getLanguageName(key, key),\n\t\t\t\tkey,\n\t\t\t})),\n\t\t],\n\t\t[language, i18nextInstance],\n\t);\n\n\tuseEffect(() => {\n\t\tif (moment.locales().includes(language.toLowerCase())) {\n\t\t\tmoment.locale(language);\n\t\t\treturn;\n\t\t}\n\n\t\tconst locale = !availableLanguages.find((lng) => lng.key === language) ? language.split('-').shift() : language;\n\n\t\tloadLocale(locale ?? language)\n\t\t\t.then((localeSrc) => {\n\t\t\t\tlocaleSrc && Function(localeSrc).call({ moment });\n\t\t\t\tmoment.locale(language);\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tmoment.locale('en');\n\t\t\t\tconsole.error('Error loading moment locale:', error);\n\t\t\t});\n\t}, [language, loadLocale, availableLanguages]);\n\n\tuseEffect(() => {\n\t\tconst cb = () => {\n\t\t\tAppClientOrchestratorInstance.getAppClientManager().initialize();\n\t\t\tAppClientOrchestratorInstance.load();\n\t\t};\n\t\tCachedCollectionManager.onLogin(cb);\n\t\treturn () => CachedCollectionManager.off('login', cb);\n\t}, []);\n\n\treturn (\n\t\t<I18nextProvider i18n={i18nextInstance}>\n\t\t\t<TranslationProviderInner children={children} availableLanguages={availableLanguages} />\n\t\t</I18nextProvider>\n\t);\n};\n\n/**\n * I was forced to create this component to keep the api useTranslation from rocketchat\n * rocketchat useTranslation invalidates the provider content, triggering all the places that use it\n * i18next triggers a re-render inside useTranslation, since now we are using 100% of the i18next\n * the only way to invalidate after changing the language in a safe way is using the useTranslation from i8next\n * and invalidating the provider content\n */\n// eslint-disable-next-line react/no-multi-comp\nconst TranslationProviderInner = ({\n\tchildren,\n\tavailableLanguages,\n}: {\n\tchildren: ReactNode;\n\tavailableLanguages: {\n\t\ten: string;\n\t\tname: string;\n\t\togName: string;\n\t\tkey: string;\n\t}[];\n}): ReactElement => {\n\tconst { t, i18n } = useTranslation();\n\n\tconst value: TranslationContextValue = useMemo(\n\t\t() => ({\n\t\t\tlanguage: i18n.language,\n\t\t\tlanguages: availableLanguages,\n\t\t\tloadLanguage: async (language: string) => {\n\t\t\t\ti18n.changeLanguage(language);\n\t\t\t},\n\t\t\ttranslate: Object.assign(addSprinfToI18n(t), {\n\t\t\t\thas: ((key, options) => key && i18n.exists(key, options)) as TranslationContextValue['translate']['has'],\n\t\t\t}),\n\t\t}),\n\t\t[availableLanguages, i18n, t],\n\t);\n\n\treturn <TranslationContext.Provider children={children} value={value} />;\n};\n\nexport default TranslationProvider;\n"]}}},"code":"var _regeneratorRuntime;\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\nvar _toConsumableArray;\nmodule.link(\"@babel/runtime/helpers/toConsumableArray\", {\n  default: function (v) {\n    _toConsumableArray = v;\n  }\n}, 1);\nvar _slicedToArray;\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 2);\nvar useLocalStorage;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useLocalStorage: function (v) {\n    useLocalStorage = v;\n  }\n}, 0);\nvar languages;\nmodule.link(\"@rocket.chat/i18n/dist/languages\", {\n  \"default\": function (v) {\n    languages = v;\n  }\n}, 1);\nvar en;\nmodule.link(\"@rocket.chat/i18n/src/locales/en.i18n.json\", {\n  \"default\": function (v) {\n    en = v;\n  }\n}, 2);\nvar normalizeLanguage;\nmodule.link(\"@rocket.chat/tools\", {\n  normalizeLanguage: function (v) {\n    normalizeLanguage = v;\n  }\n}, 3);\nvar useMethod, useSetting, TranslationContext;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useMethod: function (v) {\n    useMethod = v;\n  },\n  useSetting: function (v) {\n    useSetting = v;\n  },\n  TranslationContext: function (v) {\n    TranslationContext = v;\n  }\n}, 4);\nvar I18NextHttpBackend;\nmodule.link(\"i18next-http-backend\", {\n  \"default\": function (v) {\n    I18NextHttpBackend = v;\n  }\n}, 5);\nvar moment;\nmodule.link(\"moment\", {\n  \"default\": function (v) {\n    moment = v;\n  }\n}, 6);\nvar React, useEffect, useMemo;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useEffect: function (v) {\n    useEffect = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  }\n}, 7);\nvar I18nextProvider, initReactI18next, useTranslation;\nmodule.link(\"react-i18next\", {\n  I18nextProvider: function (v) {\n    I18nextProvider = v;\n  },\n  initReactI18next: function (v) {\n    initReactI18next = v;\n  },\n  useTranslation: function (v) {\n    useTranslation = v;\n  }\n}, 8);\nvar CachedCollectionManager;\nmodule.link(\"../../app/ui-cached-collection/client\", {\n  CachedCollectionManager: function (v) {\n    CachedCollectionManager = v;\n  }\n}, 9);\nvar getURL;\nmodule.link(\"../../app/utils/client\", {\n  getURL: function (v) {\n    getURL = v;\n  }\n}, 10);\nvar i18n, addSprinfToI18n, extractTranslationKeys, applyCustomTranslations, availableTranslationNamespaces, defaultTranslationNamespace, extractTranslationNamespaces;\nmodule.link(\"../../app/utils/lib/i18n\", {\n  i18n: function (v) {\n    i18n = v;\n  },\n  addSprinfToI18n: function (v) {\n    addSprinfToI18n = v;\n  },\n  extractTranslationKeys: function (v) {\n    extractTranslationKeys = v;\n  },\n  applyCustomTranslations: function (v) {\n    applyCustomTranslations = v;\n  },\n  availableTranslationNamespaces: function (v) {\n    availableTranslationNamespaces = v;\n  },\n  defaultTranslationNamespace: function (v) {\n    defaultTranslationNamespace = v;\n  },\n  extractTranslationNamespaces: function (v) {\n    extractTranslationNamespaces = v;\n  }\n}, 11);\nvar AppClientOrchestratorInstance;\nmodule.link(\"../apps/orchestrator\", {\n  AppClientOrchestratorInstance: function (v) {\n    AppClientOrchestratorInstance = v;\n  }\n}, 12);\nvar isRTLScriptLanguage;\nmodule.link(\"../lib/utils/isRTLScriptLanguage\", {\n  isRTLScriptLanguage: function (v) {\n    isRTLScriptLanguage = v;\n  }\n}, 13);\ni18n.use(I18NextHttpBackend).use(initReactI18next);\nvar useCustomTranslations = function (i18n) {\n  var customTranslations = useSetting('Custom_Translations');\n  var parsedCustomTranslations = useMemo(function () {\n    if (!customTranslations || typeof customTranslations !== 'string') {\n      return undefined;\n    }\n    try {\n      return JSON.parse(customTranslations);\n    } catch (e) {\n      console.error(e);\n      return undefined;\n    }\n  }, [customTranslations]);\n  useEffect(function () {\n    if (!parsedCustomTranslations) {\n      return;\n    }\n    applyCustomTranslations(i18n, parsedCustomTranslations);\n    var handleLanguageChanged = function () {\n      applyCustomTranslations(i18n, parsedCustomTranslations);\n    };\n    i18n.on('languageChanged', handleLanguageChanged);\n    return function () {\n      i18n.off('languageChanged', handleLanguageChanged);\n    };\n  }, [i18n, parsedCustomTranslations]);\n};\nvar localeCache = new Map();\nvar isI18nInitialized = false;\nvar useI18next = function (lng) {\n  // i18n.init is async, so there's a chance a race condition happens and it is initialized twice\n  // This breaks translations because it loads `lng` in the first init but not the second.\n  if (!isI18nInitialized) {\n    isI18nInitialized = true;\n    i18n.init({\n      lng: lng,\n      fallbackLng: 'en',\n      ns: availableTranslationNamespaces,\n      defaultNS: defaultTranslationNamespace,\n      nsSeparator: '.',\n      resources: {\n        en: extractTranslationNamespaces(en)\n      },\n      partialBundledLanguages: true,\n      backend: {\n        loadPath: 'i18n/{{lng}}.json',\n        parse: function (data, _lngs) {\n          var namespaces = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n          return extractTranslationKeys(JSON.parse(data), namespaces);\n        },\n        request: function (_options, url, _payload, callback) {\n          var params = url.split('/');\n          var lng = params[params.length - 1];\n          var promise = localeCache.get(lng);\n          if (!promise) {\n            promise = fetch(getURL(url)).then(function (res) {\n              return res.text();\n            });\n            localeCache.set(lng, promise);\n          }\n          promise.then(function (res) {\n            return callback(null, {\n              data: res,\n              status: 200\n            });\n          }, function () {\n            return callback(null, {\n              data: '',\n              status: 500\n            });\n          });\n        }\n      },\n      react: {\n        useSuspense: true,\n        bindI18n: 'languageChanged loaded',\n        bindI18nStore: 'added removed'\n      },\n      interpolation: {\n        escapeValue: false\n      }\n    });\n  }\n  useEffect(function () {\n    i18n.changeLanguage(lng);\n  }, [lng]);\n  return i18n;\n};\nvar useAutoLanguage = function () {\n  var _window$navigator$use, _defaultUserLanguage$;\n  var serverLanguage = useSetting('Language');\n  var browserLanguage = normalizeLanguage((_window$navigator$use = window.navigator.userLanguage) !== null && _window$navigator$use !== void 0 ? _window$navigator$use : window.navigator.language);\n  var defaultUserLanguage = browserLanguage || serverLanguage || 'en';\n  // if the language is supported, if not remove the region\n  var suggestedLanguage = languages.includes(defaultUserLanguage) ? defaultUserLanguage : (_defaultUserLanguage$ = defaultUserLanguage.split('-').shift()) !== null && _defaultUserLanguage$ !== void 0 ? _defaultUserLanguage$ : 'en';\n  // usually that value is set based on the user's config language\n  var _useLocalStorage = useLocalStorage('userLanguage', suggestedLanguage),\n    _useLocalStorage2 = _slicedToArray(_useLocalStorage, 1),\n    language = _useLocalStorage2[0];\n  document.documentElement.classList[isRTLScriptLanguage(language) ? 'add' : 'remove']('rtl');\n  document.documentElement.setAttribute('dir', isRTLScriptLanguage(language) ? 'rtl' : 'ltr');\n  document.documentElement.lang = language;\n  // if user has no language set, we should set it to the default language\n  return language || suggestedLanguage;\n};\nvar getLanguageName = function (code, lng) {\n  try {\n    var _lang$of;\n    var lang = new Intl.DisplayNames([lng], {\n      type: 'language'\n    });\n    return (_lang$of = lang.of(code)) !== null && _lang$of !== void 0 ? _lang$of : code;\n  } catch (e) {\n    return code;\n  }\n};\nvar TranslationProvider = function (_ref) {\n  var children = _ref.children;\n  var loadLocale = useMethod('loadLocale');\n  var language = useAutoLanguage();\n  var i18nextInstance = useI18next(language);\n  useCustomTranslations(i18nextInstance);\n  var availableLanguages = useMemo(function () {\n    return [{\n      en: 'Default',\n      name: i18nextInstance.t('Default'),\n      ogName: i18nextInstance.t('Default'),\n      key: ''\n    }].concat(_toConsumableArray(_toConsumableArray(new Set([].concat(_toConsumableArray(i18nextInstance.languages), _toConsumableArray(languages)))).map(function (key) {\n      return {\n        en: key,\n        name: getLanguageName(key, language),\n        ogName: getLanguageName(key, key),\n        key: key\n      };\n    })));\n  }, [language, i18nextInstance]);\n  useEffect(function () {\n    if (moment.locales().includes(language.toLowerCase())) {\n      moment.locale(language);\n      return;\n    }\n    var locale = !availableLanguages.find(function (lng) {\n      return lng.key === language;\n    }) ? language.split('-').shift() : language;\n    loadLocale(locale !== null && locale !== void 0 ? locale : language).then(function (localeSrc) {\n      localeSrc && Function(localeSrc).call({\n        moment: moment\n      });\n      moment.locale(language);\n    }).catch(function (error) {\n      moment.locale('en');\n      console.error('Error loading moment locale:', error);\n    });\n  }, [language, loadLocale, availableLanguages]);\n  useEffect(function () {\n    var cb = function () {\n      AppClientOrchestratorInstance.getAppClientManager().initialize();\n      AppClientOrchestratorInstance.load();\n    };\n    CachedCollectionManager.onLogin(cb);\n    return function () {\n      return CachedCollectionManager.off('login', cb);\n    };\n  }, []);\n  return /*#__PURE__*/React.createElement(I18nextProvider, {\n    i18n: i18nextInstance\n  }, /*#__PURE__*/React.createElement(TranslationProviderInner, {\n    children: children,\n    availableLanguages: availableLanguages\n  }));\n};\n/**\n * I was forced to create this component to keep the api useTranslation from rocketchat\n * rocketchat useTranslation invalidates the provider content, triggering all the places that use it\n * i18next triggers a re-render inside useTranslation, since now we are using 100% of the i18next\n * the only way to invalidate after changing the language in a safe way is using the useTranslation from i8next\n * and invalidating the provider content\n */\n// eslint-disable-next-line react/no-multi-comp\nvar TranslationProviderInner = function (_ref2) {\n  var children = _ref2.children,\n    availableLanguages = _ref2.availableLanguages;\n  var _useTranslation = useTranslation(),\n    t = _useTranslation.t,\n    i18n = _useTranslation.i18n;\n  var value = useMemo(function () {\n    return {\n      language: i18n.language,\n      languages: availableLanguages,\n      loadLanguage: function () {\n        function _callee(language) {\n          return _regeneratorRuntime.async(function () {\n            function _callee$(_context) {\n              while (1) switch (_context.prev = _context.next) {\n                case 0:\n                  i18n.changeLanguage(language);\n                case 1:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n            return _callee$;\n          }(), null, null, null, Promise);\n        }\n        return _callee;\n      }(),\n      translate: Object.assign(addSprinfToI18n(t), {\n        has: function (key, options) {\n          return key && i18n.exists(key, options);\n        }\n      })\n    };\n  }, [availableLanguages, i18n, t]);\n  return /*#__PURE__*/React.createElement(TranslationContext.Provider, {\n    children: children,\n    value: value\n  });\n};\nmodule.exportDefault(TranslationProvider);","map":{"version":3,"names":["_regeneratorRuntime","module","link","default","v","_toConsumableArray","_slicedToArray","useLocalStorage","languages","en","normalizeLanguage","useMethod","useSetting","TranslationContext","I18NextHttpBackend","moment","React","useEffect","useMemo","I18nextProvider","initReactI18next","useTranslation","CachedCollectionManager","getURL","i18n","addSprinfToI18n","extractTranslationKeys","applyCustomTranslations","availableTranslationNamespaces","defaultTranslationNamespace","extractTranslationNamespaces","AppClientOrchestratorInstance","isRTLScriptLanguage","use","useCustomTranslations","customTranslations","parsedCustomTranslations","undefined","JSON","parse","e","console","error","handleLanguageChanged","on","off","localeCache","Map","isI18nInitialized","useI18next","lng","init","fallbackLng","ns","defaultNS","nsSeparator","resources","partialBundledLanguages","backend","loadPath","data","_lngs","namespaces","arguments","length","request","_options","url","_payload","callback","params","split","promise","get","fetch","then","res","text","set","status","react","useSuspense","bindI18n","bindI18nStore","interpolation","escapeValue","changeLanguage","useAutoLanguage","_window$navigator$use","_defaultUserLanguage$","serverLanguage","browserLanguage","window","navigator","userLanguage","language","defaultUserLanguage","suggestedLanguage","includes","shift","_useLocalStorage","_useLocalStorage2","document","documentElement","classList","setAttribute","lang","getLanguageName","code","_lang$of","Intl","DisplayNames","type","of","TranslationProvider","_ref","children","loadLocale","i18nextInstance","availableLanguages","name","t","ogName","key","concat","Set","map","locales","toLowerCase","locale","find","localeSrc","Function","call","catch","cb","getAppClientManager","initialize","load","onLogin","createElement","TranslationProviderInner","_ref2","_useTranslation","value","loadLanguage","_callee","async","_callee$","_context","prev","next","stop","Promise","translate","Object","assign","has","options","exists","Provider","exportDefault"],"sources":["client/providers/TranslationProvider.tsx"],"sourcesContent":["import { useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport languages from '@rocket.chat/i18n/dist/languages';\nimport en from '@rocket.chat/i18n/src/locales/en.i18n.json';\nimport { normalizeLanguage } from '@rocket.chat/tools';\nimport type { TranslationContextValue } from '@rocket.chat/ui-contexts';\nimport { useMethod, useSetting, TranslationContext } from '@rocket.chat/ui-contexts';\nimport type i18next from 'i18next';\nimport I18NextHttpBackend from 'i18next-http-backend';\nimport moment from 'moment';\nimport type { ReactElement, ReactNode } from 'react';\nimport React, { useEffect, useMemo } from 'react';\nimport { I18nextProvider, initReactI18next, useTranslation } from 'react-i18next';\n\nimport { CachedCollectionManager } from '../../app/ui-cached-collection/client';\nimport { getURL } from '../../app/utils/client';\nimport {\n\ti18n,\n\taddSprinfToI18n,\n\textractTranslationKeys,\n\tapplyCustomTranslations,\n\tavailableTranslationNamespaces,\n\tdefaultTranslationNamespace,\n\textractTranslationNamespaces,\n} from '../../app/utils/lib/i18n';\nimport { AppClientOrchestratorInstance } from '../apps/orchestrator';\nimport { isRTLScriptLanguage } from '../lib/utils/isRTLScriptLanguage';\n\ni18n.use(I18NextHttpBackend).use(initReactI18next);\n\nconst useCustomTranslations = (i18n: typeof i18next) => {\n\tconst customTranslations = useSetting('Custom_Translations');\n\n\tconst parsedCustomTranslations = useMemo((): Record<string, Record<string, string>> | undefined => {\n\t\tif (!customTranslations || typeof customTranslations !== 'string') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\ttry {\n\t\t\treturn JSON.parse(customTranslations);\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t\treturn undefined;\n\t\t}\n\t}, [customTranslations]);\n\n\tuseEffect(() => {\n\t\tif (!parsedCustomTranslations) {\n\t\t\treturn;\n\t\t}\n\n\t\tapplyCustomTranslations(i18n, parsedCustomTranslations);\n\n\t\tconst handleLanguageChanged = (): void => {\n\t\t\tapplyCustomTranslations(i18n, parsedCustomTranslations);\n\t\t};\n\n\t\ti18n.on('languageChanged', handleLanguageChanged);\n\n\t\treturn () => {\n\t\t\ti18n.off('languageChanged', handleLanguageChanged);\n\t\t};\n\t}, [i18n, parsedCustomTranslations]);\n};\n\nconst localeCache = new Map<string, Promise<string>>();\nlet isI18nInitialized = false;\n\nconst useI18next = (lng: string): typeof i18next => {\n\t// i18n.init is async, so there's a chance a race condition happens and it is initialized twice\n\t// This breaks translations because it loads `lng` in the first init but not the second.\n\tif (!isI18nInitialized) {\n\t\tisI18nInitialized = true;\n\t\ti18n.init({\n\t\t\tlng,\n\t\t\tfallbackLng: 'en',\n\t\t\tns: availableTranslationNamespaces,\n\t\t\tdefaultNS: defaultTranslationNamespace,\n\t\t\tnsSeparator: '.',\n\t\t\tresources: {\n\t\t\t\ten: extractTranslationNamespaces(en),\n\t\t\t},\n\t\t\tpartialBundledLanguages: true,\n\t\t\tbackend: {\n\t\t\t\tloadPath: 'i18n/{{lng}}.json',\n\t\t\t\tparse: (data: string, _lngs?: string | string[], namespaces: string | string[] = []) =>\n\t\t\t\t\textractTranslationKeys(JSON.parse(data), namespaces),\n\t\t\t\trequest: (_options: unknown, url: string, _payload: unknown, callback: (error: unknown, data: unknown) => void) => {\n\t\t\t\t\tconst params = url.split('/');\n\n\t\t\t\t\tconst lng = params[params.length - 1];\n\n\t\t\t\t\tlet promise = localeCache.get(lng);\n\n\t\t\t\t\tif (!promise) {\n\t\t\t\t\t\tpromise = fetch(getURL(url)).then((res) => res.text());\n\t\t\t\t\t\tlocaleCache.set(lng, promise);\n\t\t\t\t\t}\n\n\t\t\t\t\tpromise.then(\n\t\t\t\t\t\t(res) => callback(null, { data: res, status: 200 }),\n\t\t\t\t\t\t() => callback(null, { data: '', status: 500 }),\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t},\n\t\t\treact: {\n\t\t\t\tuseSuspense: true,\n\t\t\t\tbindI18n: 'languageChanged loaded',\n\t\t\t\tbindI18nStore: 'added removed',\n\t\t\t},\n\t\t\tinterpolation: {\n\t\t\t\tescapeValue: false,\n\t\t\t},\n\t\t});\n\t}\n\n\tuseEffect(() => {\n\t\ti18n.changeLanguage(lng);\n\t}, [lng]);\n\n\treturn i18n;\n};\n\nconst useAutoLanguage = () => {\n\tconst serverLanguage = useSetting<string>('Language');\n\tconst browserLanguage = normalizeLanguage(window.navigator.userLanguage ?? window.navigator.language);\n\tconst defaultUserLanguage = browserLanguage || serverLanguage || 'en';\n\n\t// if the language is supported, if not remove the region\n\tconst suggestedLanguage = languages.includes(defaultUserLanguage) ? defaultUserLanguage : defaultUserLanguage.split('-').shift() ?? 'en';\n\n\t// usually that value is set based on the user's config language\n\tconst [language] = useLocalStorage('userLanguage', suggestedLanguage);\n\n\tdocument.documentElement.classList[isRTLScriptLanguage(language) ? 'add' : 'remove']('rtl');\n\tdocument.documentElement.setAttribute('dir', isRTLScriptLanguage(language) ? 'rtl' : 'ltr');\n\tdocument.documentElement.lang = language;\n\n\t// if user has no language set, we should set it to the default language\n\treturn language || suggestedLanguage;\n};\n\nconst getLanguageName = (code: string, lng: string): string => {\n\ttry {\n\t\tconst lang = new Intl.DisplayNames([lng], { type: 'language' });\n\t\treturn lang.of(code) ?? code;\n\t} catch (e) {\n\t\treturn code;\n\t}\n};\n\ntype TranslationProviderProps = {\n\tchildren: ReactNode;\n};\n\nconst TranslationProvider = ({ children }: TranslationProviderProps): ReactElement => {\n\tconst loadLocale = useMethod('loadLocale');\n\n\tconst language = useAutoLanguage();\n\tconst i18nextInstance = useI18next(language);\n\tuseCustomTranslations(i18nextInstance);\n\n\tconst availableLanguages = useMemo(\n\t\t() => [\n\t\t\t{\n\t\t\t\ten: 'Default',\n\t\t\t\tname: i18nextInstance.t('Default'),\n\t\t\t\togName: i18nextInstance.t('Default'),\n\t\t\t\tkey: '',\n\t\t\t},\n\t\t\t...[...new Set([...i18nextInstance.languages, ...languages])].map((key) => ({\n\t\t\t\ten: key,\n\t\t\t\tname: getLanguageName(key, language),\n\t\t\t\togName: getLanguageName(key, key),\n\t\t\t\tkey,\n\t\t\t})),\n\t\t],\n\t\t[language, i18nextInstance],\n\t);\n\n\tuseEffect(() => {\n\t\tif (moment.locales().includes(language.toLowerCase())) {\n\t\t\tmoment.locale(language);\n\t\t\treturn;\n\t\t}\n\n\t\tconst locale = !availableLanguages.find((lng) => lng.key === language) ? language.split('-').shift() : language;\n\n\t\tloadLocale(locale ?? language)\n\t\t\t.then((localeSrc) => {\n\t\t\t\tlocaleSrc && Function(localeSrc).call({ moment });\n\t\t\t\tmoment.locale(language);\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tmoment.locale('en');\n\t\t\t\tconsole.error('Error loading moment locale:', error);\n\t\t\t});\n\t}, [language, loadLocale, availableLanguages]);\n\n\tuseEffect(() => {\n\t\tconst cb = () => {\n\t\t\tAppClientOrchestratorInstance.getAppClientManager().initialize();\n\t\t\tAppClientOrchestratorInstance.load();\n\t\t};\n\t\tCachedCollectionManager.onLogin(cb);\n\t\treturn () => CachedCollectionManager.off('login', cb);\n\t}, []);\n\n\treturn (\n\t\t<I18nextProvider i18n={i18nextInstance}>\n\t\t\t<TranslationProviderInner children={children} availableLanguages={availableLanguages} />\n\t\t</I18nextProvider>\n\t);\n};\n\n/**\n * I was forced to create this component to keep the api useTranslation from rocketchat\n * rocketchat useTranslation invalidates the provider content, triggering all the places that use it\n * i18next triggers a re-render inside useTranslation, since now we are using 100% of the i18next\n * the only way to invalidate after changing the language in a safe way is using the useTranslation from i8next\n * and invalidating the provider content\n */\n// eslint-disable-next-line react/no-multi-comp\nconst TranslationProviderInner = ({\n\tchildren,\n\tavailableLanguages,\n}: {\n\tchildren: ReactNode;\n\tavailableLanguages: {\n\t\ten: string;\n\t\tname: string;\n\t\togName: string;\n\t\tkey: string;\n\t}[];\n}): ReactElement => {\n\tconst { t, i18n } = useTranslation();\n\n\tconst value: TranslationContextValue = useMemo(\n\t\t() => ({\n\t\t\tlanguage: i18n.language,\n\t\t\tlanguages: availableLanguages,\n\t\t\tloadLanguage: async (language: string) => {\n\t\t\t\ti18n.changeLanguage(language);\n\t\t\t},\n\t\t\ttranslate: Object.assign(addSprinfToI18n(t), {\n\t\t\t\thas: ((key, options) => key && i18n.exists(key, options)) as TranslationContextValue['translate']['has'],\n\t\t\t}),\n\t\t}),\n\t\t[availableLanguages, i18n, t],\n\t);\n\n\treturn <TranslationContext.Provider children={children} value={value} />;\n};\n\nexport default TranslationProvider;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"51f71720574b01f1b23fae5b1ff1227fe8046226"}
