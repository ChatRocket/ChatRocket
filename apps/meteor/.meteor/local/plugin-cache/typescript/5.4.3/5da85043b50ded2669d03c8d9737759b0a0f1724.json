{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/startup/startup.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/startup/startup.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/startup/startup.ts","inputSourceMap":{"version":3,"file":"client/startup/startup.ts","sourceRoot":"","sources":["client/startup/startup.ts"],"names":[],"mappings":"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","sourcesContent":["import type { UserStatus } from '@rocket.chat/core-typings';\nimport { Meteor } from 'meteor/meteor';\nimport { UserPresence } from 'meteor/rocketchat:user-presence';\nimport { Session } from 'meteor/session';\nimport { Tracker } from 'meteor/tracker';\nimport moment from 'moment';\n\nimport { register } from '../../app/markdown/lib/hljs';\nimport { settings } from '../../app/settings/client';\nimport { getUserPreference } from '../../app/utils/client';\nimport 'hljs9/styles/github.css';\nimport { sdk } from '../../app/utils/client/lib/SDKClient';\nimport { synchronizeUserData, removeLocalUserData } from '../lib/userData';\nimport { fireGlobalEvent } from '../lib/utils/fireGlobalEvent';\n\nMeteor.startup(() => {\n\tfireGlobalEvent('startup', true);\n\n\tSession.setDefault('AvatarRandom', 0);\n\n\twindow.lastMessageWindow = {};\n\twindow.lastMessageWindowHistory = {};\n\n\tlet status: UserStatus | undefined = undefined;\n\tTracker.autorun(async () => {\n\t\tconst uid = Meteor.userId();\n\t\tif (!uid) {\n\t\t\tremoveLocalUserData();\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Meteor.status().connected) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (Meteor.loggingIn()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst user = await synchronizeUserData(uid);\n\t\tif (!user) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst utcOffset = moment().utcOffset() / 60;\n\t\tif (user.utcOffset !== utcOffset) {\n\t\t\tsdk.call('userSetUtcOffset', utcOffset);\n\t\t}\n\n\t\tif (getUserPreference(user, 'enableAutoAway')) {\n\t\t\tconst idleTimeLimit = (getUserPreference(user, 'idleTimeLimit') as number | null | undefined) || 300;\n\t\t\tUserPresence.awayTime = idleTimeLimit * 1000;\n\t\t} else {\n\t\t\tdelete UserPresence.awayTime;\n\t\t\tUserPresence.stopTimer();\n\t\t}\n\n\t\tUserPresence.start();\n\n\t\tif (user.status !== status) {\n\t\t\tstatus = user.status;\n\t\t\tfireGlobalEvent('status-changed', status);\n\t\t}\n\t});\n});\nMeteor.startup(() => {\n\tTracker.autorun(() => {\n\t\tconst code = settings.get('Message_Code_highlight') as string | undefined;\n\t\tcode?.split(',').forEach((language: string) => {\n\t\t\tlanguage.trim() && register(language.trim());\n\t\t});\n\t});\n});\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/startup/startup.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/startup/startup.ts","inputSourceMap":{"version":3,"file":"client/startup/startup.ts","sourceRoot":"","sources":["client/startup/startup.ts"],"names":[],"mappings":"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","sourcesContent":["import type { UserStatus } from '@rocket.chat/core-typings';\nimport { Meteor } from 'meteor/meteor';\nimport { UserPresence } from 'meteor/rocketchat:user-presence';\nimport { Session } from 'meteor/session';\nimport { Tracker } from 'meteor/tracker';\nimport moment from 'moment';\n\nimport { register } from '../../app/markdown/lib/hljs';\nimport { settings } from '../../app/settings/client';\nimport { getUserPreference } from '../../app/utils/client';\nimport 'hljs9/styles/github.css';\nimport { sdk } from '../../app/utils/client/lib/SDKClient';\nimport { synchronizeUserData, removeLocalUserData } from '../lib/userData';\nimport { fireGlobalEvent } from '../lib/utils/fireGlobalEvent';\n\nMeteor.startup(() => {\n\tfireGlobalEvent('startup', true);\n\n\tSession.setDefault('AvatarRandom', 0);\n\n\twindow.lastMessageWindow = {};\n\twindow.lastMessageWindowHistory = {};\n\n\tlet status: UserStatus | undefined = undefined;\n\tTracker.autorun(async () => {\n\t\tconst uid = Meteor.userId();\n\t\tif (!uid) {\n\t\t\tremoveLocalUserData();\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Meteor.status().connected) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (Meteor.loggingIn()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst user = await synchronizeUserData(uid);\n\t\tif (!user) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst utcOffset = moment().utcOffset() / 60;\n\t\tif (user.utcOffset !== utcOffset) {\n\t\t\tsdk.call('userSetUtcOffset', utcOffset);\n\t\t}\n\n\t\tif (getUserPreference(user, 'enableAutoAway')) {\n\t\t\tconst idleTimeLimit = (getUserPreference(user, 'idleTimeLimit') as number | null | undefined) || 300;\n\t\t\tUserPresence.awayTime = idleTimeLimit * 1000;\n\t\t} else {\n\t\t\tdelete UserPresence.awayTime;\n\t\t\tUserPresence.stopTimer();\n\t\t}\n\n\t\tUserPresence.start();\n\n\t\tif (user.status !== status) {\n\t\t\tstatus = user.status;\n\t\t\tfireGlobalEvent('status-changed', status);\n\t\t}\n\t});\n});\nMeteor.startup(() => {\n\tTracker.autorun(() => {\n\t\tconst code = settings.get('Message_Code_highlight') as string | undefined;\n\t\tcode?.split(',').forEach((language: string) => {\n\t\t\tlanguage.trim() && register(language.trim());\n\t\t});\n\t});\n});\n"]}}},"code":"var _regeneratorRuntime;\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\nvar Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar UserPresence;\nmodule.link(\"meteor/rocketchat:user-presence\", {\n  UserPresence: function (v) {\n    UserPresence = v;\n  }\n}, 1);\nvar Session;\nmodule.link(\"meteor/session\", {\n  Session: function (v) {\n    Session = v;\n  }\n}, 2);\nvar Tracker;\nmodule.link(\"meteor/tracker\", {\n  Tracker: function (v) {\n    Tracker = v;\n  }\n}, 3);\nvar moment;\nmodule.link(\"moment\", {\n  \"default\": function (v) {\n    moment = v;\n  }\n}, 4);\nvar register;\nmodule.link(\"../../app/markdown/lib/hljs\", {\n  register: function (v) {\n    register = v;\n  }\n}, 5);\nvar settings;\nmodule.link(\"../../app/settings/client\", {\n  settings: function (v) {\n    settings = v;\n  }\n}, 6);\nvar getUserPreference;\nmodule.link(\"../../app/utils/client\", {\n  getUserPreference: function (v) {\n    getUserPreference = v;\n  }\n}, 7);\nmodule.link(\"hljs9/styles/github.css\");\nvar sdk;\nmodule.link(\"../../app/utils/client/lib/SDKClient\", {\n  sdk: function (v) {\n    sdk = v;\n  }\n}, 8);\nvar synchronizeUserData, removeLocalUserData;\nmodule.link(\"../lib/userData\", {\n  synchronizeUserData: function (v) {\n    synchronizeUserData = v;\n  },\n  removeLocalUserData: function (v) {\n    removeLocalUserData = v;\n  }\n}, 9);\nvar fireGlobalEvent;\nmodule.link(\"../lib/utils/fireGlobalEvent\", {\n  fireGlobalEvent: function (v) {\n    fireGlobalEvent = v;\n  }\n}, 10);\nMeteor.startup(function () {\n  fireGlobalEvent('startup', true);\n  Session.setDefault('AvatarRandom', 0);\n  window.lastMessageWindow = {};\n  window.lastMessageWindowHistory = {};\n  var status = undefined;\n  Tracker.autorun(function () {\n    function _callee() {\n      var uid, user, utcOffset, idleTimeLimit;\n      return _regeneratorRuntime.async(function () {\n        function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              uid = Meteor.userId();\n              if (uid) {\n                _context.next = 4;\n                break;\n              }\n              removeLocalUserData();\n              return _context.abrupt(\"return\");\n            case 4:\n              if (Meteor.status().connected) {\n                _context.next = 6;\n                break;\n              }\n              return _context.abrupt(\"return\");\n            case 6:\n              if (!Meteor.loggingIn()) {\n                _context.next = 8;\n                break;\n              }\n              return _context.abrupt(\"return\");\n            case 8:\n              _context.next = 10;\n              return _regeneratorRuntime.awrap(synchronizeUserData(uid));\n            case 10:\n              user = _context.sent;\n              if (user) {\n                _context.next = 13;\n                break;\n              }\n              return _context.abrupt(\"return\");\n            case 13:\n              utcOffset = moment().utcOffset() / 60;\n              if (user.utcOffset !== utcOffset) {\n                sdk.call('userSetUtcOffset', utcOffset);\n              }\n              if (getUserPreference(user, 'enableAutoAway')) {\n                idleTimeLimit = getUserPreference(user, 'idleTimeLimit') || 300;\n                UserPresence.awayTime = idleTimeLimit * 1000;\n              } else {\n                delete UserPresence.awayTime;\n                UserPresence.stopTimer();\n              }\n              UserPresence.start();\n              if (user.status !== status) {\n                status = user.status;\n                fireGlobalEvent('status-changed', status);\n              }\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n        return _callee$;\n      }(), null, null, null, Promise);\n    }\n    return _callee;\n  }());\n});\nMeteor.startup(function () {\n  Tracker.autorun(function () {\n    var code = settings.get('Message_Code_highlight');\n    code === null || code === void 0 ? void 0 : code.split(',').forEach(function (language) {\n      language.trim() && register(language.trim());\n    });\n  });\n});","map":{"version":3,"names":["_regeneratorRuntime","module","link","default","v","Meteor","UserPresence","Session","Tracker","moment","register","settings","getUserPreference","sdk","synchronizeUserData","removeLocalUserData","fireGlobalEvent","startup","setDefault","window","lastMessageWindow","lastMessageWindowHistory","status","undefined","autorun","_callee","uid","user","utcOffset","idleTimeLimit","async","_callee$","_context","prev","next","userId","abrupt","connected","loggingIn","awrap","sent","call","awayTime","stopTimer","start","stop","Promise","code","get","split","forEach","language","trim"],"sources":["client/startup/startup.ts"],"sourcesContent":["import type { UserStatus } from '@rocket.chat/core-typings';\nimport { Meteor } from 'meteor/meteor';\nimport { UserPresence } from 'meteor/rocketchat:user-presence';\nimport { Session } from 'meteor/session';\nimport { Tracker } from 'meteor/tracker';\nimport moment from 'moment';\n\nimport { register } from '../../app/markdown/lib/hljs';\nimport { settings } from '../../app/settings/client';\nimport { getUserPreference } from '../../app/utils/client';\nimport 'hljs9/styles/github.css';\nimport { sdk } from '../../app/utils/client/lib/SDKClient';\nimport { synchronizeUserData, removeLocalUserData } from '../lib/userData';\nimport { fireGlobalEvent } from '../lib/utils/fireGlobalEvent';\n\nMeteor.startup(() => {\n\tfireGlobalEvent('startup', true);\n\n\tSession.setDefault('AvatarRandom', 0);\n\n\twindow.lastMessageWindow = {};\n\twindow.lastMessageWindowHistory = {};\n\n\tlet status: UserStatus | undefined = undefined;\n\tTracker.autorun(async () => {\n\t\tconst uid = Meteor.userId();\n\t\tif (!uid) {\n\t\t\tremoveLocalUserData();\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Meteor.status().connected) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (Meteor.loggingIn()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst user = await synchronizeUserData(uid);\n\t\tif (!user) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst utcOffset = moment().utcOffset() / 60;\n\t\tif (user.utcOffset !== utcOffset) {\n\t\t\tsdk.call('userSetUtcOffset', utcOffset);\n\t\t}\n\n\t\tif (getUserPreference(user, 'enableAutoAway')) {\n\t\t\tconst idleTimeLimit = (getUserPreference(user, 'idleTimeLimit') as number | null | undefined) || 300;\n\t\t\tUserPresence.awayTime = idleTimeLimit * 1000;\n\t\t} else {\n\t\t\tdelete UserPresence.awayTime;\n\t\t\tUserPresence.stopTimer();\n\t\t}\n\n\t\tUserPresence.start();\n\n\t\tif (user.status !== status) {\n\t\t\tstatus = user.status;\n\t\t\tfireGlobalEvent('status-changed', status);\n\t\t}\n\t});\n});\nMeteor.startup(() => {\n\tTracker.autorun(() => {\n\t\tconst code = settings.get('Message_Code_highlight') as string | undefined;\n\t\tcode?.split(',').forEach((language: string) => {\n\t\t\tlanguage.trim() && register(language.trim());\n\t\t});\n\t});\n});\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"5da85043b50ded2669d03c8d9737759b0a0f1724"}
