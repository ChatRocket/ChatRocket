{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/providers/EmojiPickerProvider/EmojiPickerProvider.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/providers/EmojiPickerProvider/EmojiPickerProvider.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/providers/EmojiPickerProvider/EmojiPickerProvider.tsx","inputSourceMap":{"version":3,"file":"client/providers/EmojiPickerProvider/EmojiPickerProvider.tsx","sourceRoot":"","sources":["client/providers/EmojiPickerProvider/EmojiPickerProvider.tsx"],"names":[],"mappings":"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","sourcesContent":["import { useDebouncedState, useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport type { ReactNode, ReactElement, ContextType } from 'react';\nimport React, { useState, useCallback, useMemo, useEffect } from 'react';\n\nimport type { EmojiByCategory } from '../../../app/emoji/client';\nimport { emoji, getFrequentEmoji, updateRecent, createEmojiList, createPickerEmojis, CUSTOM_CATEGORY } from '../../../app/emoji/client';\nimport { EmojiPickerContext } from '../../contexts/EmojiPickerContext';\nimport EmojiPicker from '../../views/composer/EmojiPicker/EmojiPicker';\nimport { useUpdateCustomEmoji } from './useUpdateCustomEmoji';\n\nconst DEFAULT_ITEMS_LIMIT = 90;\n\nconst EmojiPickerProvider = ({ children }: { children: ReactNode }): ReactElement => {\n\tconst [emojiPicker, setEmojiPicker] = useState<ReactElement | null>(null);\n\tconst [emojiToPreview, setEmojiToPreview] = useDebouncedState<{ emoji: string; name: string } | null>(null, 100);\n\tconst [recentEmojis, setRecentEmojis] = useLocalStorage<string[]>('emoji.recent', []);\n\tconst [actualTone, setActualTone] = useLocalStorage('emoji.tone', 0);\n\tconst [currentCategory, setCurrentCategory] = useState('recent');\n\tconst [customItemsLimit, setCustomItemsLimit] = useState(DEFAULT_ITEMS_LIMIT);\n\n\tconst [frequentEmojis, setFrequentEmojis] = useLocalStorage<[string, number][]>('emoji.frequent', []);\n\n\tconst [quickReactions, setQuickReactions] = useState<{ emoji: string; image: string }[]>(() =>\n\t\tgetFrequentEmoji(frequentEmojis.map(([emoji]) => emoji)),\n\t);\n\n\tuseUpdateCustomEmoji();\n\n\tconst addFrequentEmojis = useCallback(\n\t\t(emoji: string) => {\n\t\t\tconst empty: [string, number][] = frequentEmojis.some(([emojiName]) => emojiName === emoji) ? [] : [[emoji, 0]];\n\n\t\t\tconst sortedFrequent = [...empty, ...frequentEmojis]\n\t\t\t\t.map(([emojiName, count]) => {\n\t\t\t\t\treturn (emojiName === emoji ? [emojiName, Math.min(count + 5, 100)] : [emojiName, Math.max(count - 1, 0)]) as [string, number];\n\t\t\t\t})\n\t\t\t\t.sort(([, frequentA], [, frequentB]) => frequentB - frequentA);\n\n\t\t\tsetFrequentEmojis(sortedFrequent);\n\t\t\tsetQuickReactions(getFrequentEmoji(sortedFrequent.map(([emoji]) => emoji)));\n\t\t},\n\t\t[frequentEmojis, setFrequentEmojis],\n\t);\n\n\tconst [getEmojiListsByCategory, setEmojiListsByCategoryGetter] = useState<() => EmojiByCategory[]>(() => () => []);\n\n\t// TODO: improve this update\n\tconst updateEmojiListByCategory = useCallback(\n\t\t(categoryKey: string, limit: number = DEFAULT_ITEMS_LIMIT) => {\n\t\t\tsetEmojiListsByCategoryGetter(\n\t\t\t\t(getEmojiListsByCategory) => () =>\n\t\t\t\t\tgetEmojiListsByCategory().map((category) =>\n\t\t\t\t\t\tcategoryKey === category.key\n\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t...category,\n\t\t\t\t\t\t\t\t\temojis: {\n\t\t\t\t\t\t\t\t\t\tlist: createEmojiList(category.key, null, recentEmojis, setRecentEmojis),\n\t\t\t\t\t\t\t\t\t\tlimit: category.key === CUSTOM_CATEGORY ? limit | customItemsLimit : null,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t: category,\n\t\t\t\t\t),\n\t\t\t);\n\t\t},\n\t\t[customItemsLimit, recentEmojis, setRecentEmojis],\n\t);\n\n\tuseEffect(() => {\n\t\tif (recentEmojis?.length > 0) {\n\t\t\tupdateRecent(recentEmojis);\n\t\t}\n\n\t\tsetEmojiListsByCategoryGetter(() => () => createPickerEmojis(customItemsLimit, actualTone, recentEmojis, setRecentEmojis));\n\t}, [actualTone, recentEmojis, customItemsLimit, currentCategory, setRecentEmojis, frequentEmojis]);\n\n\tconst addRecentEmoji = useCallback(\n\t\t(_emoji: string) => {\n\t\t\taddFrequentEmojis(_emoji);\n\n\t\t\tconst recent = recentEmojis || [];\n\t\t\tconst pos = recent.indexOf(_emoji as never);\n\n\t\t\tif (pos !== -1) {\n\t\t\t\trecent.splice(pos, 1);\n\t\t\t}\n\n\t\t\trecent.unshift(_emoji);\n\n\t\t\t// limit recent emojis to 27 (3 rows of 9)\n\t\t\trecent.splice(27);\n\n\t\t\tsetRecentEmojis(recent);\n\t\t\temoji.packages.base.emojisByCategory.recent = recent;\n\t\t\tupdateEmojiListByCategory('recent');\n\t\t},\n\t\t[recentEmojis, setRecentEmojis, updateEmojiListByCategory, addFrequentEmojis],\n\t);\n\n\tconst open = useCallback((ref: Element, callback: (emoji: string) => void) => {\n\t\treturn setEmojiPicker(<EmojiPicker reference={ref} onClose={() => setEmojiPicker(null)} onPickEmoji={(emoji) => callback(emoji)} />);\n\t}, []);\n\n\tconst handlePreview = useCallback((emoji: string, name: string) => setEmojiToPreview({ emoji, name }), [setEmojiToPreview]);\n\n\tconst handleRemovePreview = useCallback(() => setEmojiToPreview(null), [setEmojiToPreview]);\n\n\tconst contextValue = useMemo(\n\t\t(): ContextType<typeof EmojiPickerContext> => ({\n\t\t\tisOpen: emojiPicker !== null,\n\t\t\tclose: () => setEmojiPicker(null),\n\t\t\topen,\n\t\t\temojiToPreview,\n\t\t\thandlePreview,\n\t\t\thandleRemovePreview,\n\t\t\taddRecentEmoji,\n\t\t\tgetEmojiListsByCategory,\n\t\t\trecentEmojis,\n\t\t\tsetRecentEmojis,\n\t\t\tactualTone,\n\t\t\tcurrentCategory,\n\t\t\tsetCurrentCategory,\n\t\t\tcustomItemsLimit,\n\t\t\tsetCustomItemsLimit,\n\t\t\tsetActualTone,\n\t\t\tquickReactions,\n\t\t}),\n\t\t[\n\t\t\temojiPicker,\n\t\t\topen,\n\t\t\temojiToPreview,\n\t\t\taddRecentEmoji,\n\t\t\tgetEmojiListsByCategory,\n\t\t\trecentEmojis,\n\t\t\tsetRecentEmojis,\n\t\t\tactualTone,\n\t\t\tcurrentCategory,\n\t\t\tsetCurrentCategory,\n\t\t\tcustomItemsLimit,\n\t\t\tsetActualTone,\n\t\t\tquickReactions,\n\t\t\thandlePreview,\n\t\t\thandleRemovePreview,\n\t\t],\n\t);\n\n\treturn (\n\t\t<EmojiPickerContext.Provider value={contextValue}>\n\t\t\t{children}\n\t\t\t{emojiPicker}\n\t\t</EmojiPickerContext.Provider>\n\t);\n};\n\nexport default EmojiPickerProvider;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/providers/EmojiPickerProvider/EmojiPickerProvider.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/providers/EmojiPickerProvider/EmojiPickerProvider.tsx","inputSourceMap":{"version":3,"file":"client/providers/EmojiPickerProvider/EmojiPickerProvider.tsx","sourceRoot":"","sources":["client/providers/EmojiPickerProvider/EmojiPickerProvider.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,iBAAiB,EAAE,eAAe,EAAE,MAAM,6BAA6B,CAAC;AAEjF,OAAO,KAAK,EAAE,EAAE,QAAQ,EAAE,WAAW,EAAE,OAAO,EAAE,SAAS,EAAE,MAAM,OAAO,CAAC;AAGzE,OAAO,EAAE,KAAK,EAAE,gBAAgB,EAAE,YAAY,EAAE,eAAe,EAAE,kBAAkB,EAAE,eAAe,EAAE,MAAM,2BAA2B,CAAC;AACxI,OAAO,EAAE,kBAAkB,EAAE,MAAM,mCAAmC,CAAC;AACvE,OAAO,WAAW,MAAM,8CAA8C,CAAC;AACvE,OAAO,EAAE,oBAAoB,EAAE,MAAM,wBAAwB,CAAC;AAE9D,MAAM,mBAAmB,GAAG,EAAE,CAAC;AAE/B,MAAM,mBAAmB,GAAG,CAAC,EAAE,QAAQ,EAA2B,EAAgB,EAAE;IACnF,MAAM,CAAC,WAAW,EAAE,cAAc,CAAC,GAAG,QAAQ,CAAsB,IAAI,CAAC,CAAC;IAC1E,MAAM,CAAC,cAAc,EAAE,iBAAiB,CAAC,GAAG,iBAAiB,CAAyC,IAAI,EAAE,GAAG,CAAC,CAAC;IACjH,MAAM,CAAC,YAAY,EAAE,eAAe,CAAC,GAAG,eAAe,CAAW,cAAc,EAAE,EAAE,CAAC,CAAC;IACtF,MAAM,CAAC,UAAU,EAAE,aAAa,CAAC,GAAG,eAAe,CAAC,YAAY,EAAE,CAAC,CAAC,CAAC;IACrE,MAAM,CAAC,eAAe,EAAE,kBAAkB,CAAC,GAAG,QAAQ,CAAC,QAAQ,CAAC,CAAC;IACjE,MAAM,CAAC,gBAAgB,EAAE,mBAAmB,CAAC,GAAG,QAAQ,CAAC,mBAAmB,CAAC,CAAC;IAE9E,MAAM,CAAC,cAAc,EAAE,iBAAiB,CAAC,GAAG,eAAe,CAAqB,gBAAgB,EAAE,EAAE,CAAC,CAAC;IAEtG,MAAM,CAAC,cAAc,EAAE,iBAAiB,CAAC,GAAG,QAAQ,CAAqC,GAAG,EAAE,CAC7F,gBAAgB,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE,EAAE,CAAC,KAAK,CAAC,CAAC,CACxD,CAAC;IAEF,oBAAoB,EAAE,CAAC;IAEvB,MAAM,iBAAiB,GAAG,WAAW,CACpC,CAAC,KAAa,EAAE,EAAE;QACjB,MAAM,KAAK,GAAuB,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,EAAE,EAAE,CAAC,SAAS,KAAK,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;QAEhH,MAAM,cAAc,GAAG,CAAC,GAAG,KAAK,EAAE,GAAG,cAAc,CAAC;aAClD,GAAG,CAAC,CAAC,CAAC,SAAS,EAAE,KAAK,CAAC,EAAE,EAAE;YAC3B,OAAO,CAAC,SAAS,KAAK,KAAK,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,CAAqB,CAAC;QAChI,CAAC,CAAC;aACD,IAAI,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,EAAE,CAAC,EAAE,SAAS,CAAC,EAAE,EAAE,CAAC,SAAS,GAAG,SAAS,CAAC,CAAC;QAEhE,iBAAiB,CAAC,cAAc,CAAC,CAAC;QAClC,iBAAiB,CAAC,gBAAgB,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IAC7E,CAAC,EACD,CAAC,cAAc,EAAE,iBAAiB,CAAC,CACnC,CAAC;IAEF,MAAM,CAAC,uBAAuB,EAAE,6BAA6B,CAAC,GAAG,QAAQ,CAA0B,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;IAEnH,4BAA4B;IAC5B,MAAM,yBAAyB,GAAG,WAAW,CAC5C,CAAC,WAAmB,EAAE,QAAgB,mBAAmB,EAAE,EAAE;QAC5D,6BAA6B,CAC5B,CAAC,uBAAuB,EAAE,EAAE,CAAC,GAAG,EAAE,CACjC,uBAAuB,EAAE,CAAC,GAAG,CAAC,CAAC,QAAQ,EAAE,EAAE,CAC1C,WAAW,KAAK,QAAQ,CAAC,GAAG;YAC3B,CAAC,CAAC;gBACA,GAAG,QAAQ;gBACX,MAAM,EAAE;oBACP,IAAI,EAAE,eAAe,CAAC,QAAQ,CAAC,GAAG,EAAE,IAAI,EAAE,YAAY,EAAE,eAAe,CAAC;oBACxE,KAAK,EAAE,QAAQ,CAAC,GAAG,KAAK,eAAe,CAAC,CAAC,CAAC,KAAK,GAAG,gBAAgB,CAAC,CAAC,CAAC,IAAI;iBACzE;aACA;YACH,CAAC,CAAC,QAAQ,CACX,CACF,CAAC;IACH,CAAC,EACD,CAAC,gBAAgB,EAAE,YAAY,EAAE,eAAe,CAAC,CACjD,CAAC;IAEF,SAAS,CAAC,GAAG,EAAE;QACd,IAAI,YAAY,EAAE,MAAM,GAAG,CAAC,EAAE,CAAC;YAC9B,YAAY,CAAC,YAAY,CAAC,CAAC;QAC5B,CAAC;QAED,6BAA6B,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,kBAAkB,CAAC,gBAAgB,EAAE,UAAU,EAAE,YAAY,EAAE,eAAe,CAAC,CAAC,CAAC;IAC5H,CAAC,EAAE,CAAC,UAAU,EAAE,YAAY,EAAE,gBAAgB,EAAE,eAAe,EAAE,eAAe,EAAE,cAAc,CAAC,CAAC,CAAC;IAEnG,MAAM,cAAc,GAAG,WAAW,CACjC,CAAC,MAAc,EAAE,EAAE;QAClB,iBAAiB,CAAC,MAAM,CAAC,CAAC;QAE1B,MAAM,MAAM,GAAG,YAAY,IAAI,EAAE,CAAC;QAClC,MAAM,GAAG,GAAG,MAAM,CAAC,OAAO,CAAC,MAAe,CAAC,CAAC;QAE5C,IAAI,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC;YAChB,MAAM,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;QACvB,CAAC;QAED,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QAEvB,0CAA0C;QAC1C,MAAM,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;QAElB,eAAe,CAAC,MAAM,CAAC,CAAC;QACxB,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,gBAAgB,CAAC,MAAM,GAAG,MAAM,CAAC;QACrD,yBAAyB,CAAC,QAAQ,CAAC,CAAC;IACrC,CAAC,EACD,CAAC,YAAY,EAAE,eAAe,EAAE,yBAAyB,EAAE,iBAAiB,CAAC,CAC7E,CAAC;IAEF,MAAM,IAAI,GAAG,WAAW,CAAC,CAAC,GAAY,EAAE,QAAiC,EAAE,EAAE;QAC5E,OAAO,cAAc,CAAC,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAG,CAAC,CAAC;IACtI,CAAC,EAAE,EAAE,CAAC,CAAC;IAEP,MAAM,aAAa,GAAG,WAAW,CAAC,CAAC,KAAa,EAAE,IAAY,EAAE,EAAE,CAAC,iBAAiB,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,iBAAiB,CAAC,CAAC,CAAC;IAE5H,MAAM,mBAAmB,GAAG,WAAW,CAAC,GAAG,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC,CAAC,CAAC;IAE5F,MAAM,YAAY,GAAG,OAAO,CAC3B,GAA2C,EAAE,CAAC,CAAC;QAC9C,MAAM,EAAE,WAAW,KAAK,IAAI;QAC5B,KAAK,EAAE,GAAG,EAAE,CAAC,cAAc,CAAC,IAAI,CAAC;QACjC,IAAI;QACJ,cAAc;QACd,aAAa;QACb,mBAAmB;QACnB,cAAc;QACd,uBAAuB;QACvB,YAAY;QACZ,eAAe;QACf,UAAU;QACV,eAAe;QACf,kBAAkB;QAClB,gBAAgB;QAChB,mBAAmB;QACnB,aAAa;QACb,cAAc;KACd,CAAC,EACF;QACC,WAAW;QACX,IAAI;QACJ,cAAc;QACd,cAAc;QACd,uBAAuB;QACvB,YAAY;QACZ,eAAe;QACf,UAAU;QACV,eAAe;QACf,kBAAkB;QAClB,gBAAgB;QAChB,aAAa;QACb,cAAc;QACd,aAAa;QACb,mBAAmB;KACnB,CACD,CAAC;IAEF,OAAO,CACN,CAAC,kBAAkB,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,YAAY,CAAC,CAChD;GAAA,CAAC,QAAQ,CACT;GAAA,CAAC,WAAW,CACb;EAAA,EAAE,kBAAkB,CAAC,QAAQ,CAAC,CAC9B,CAAC;AACH,CAAC,CAAC;AAEF,eAAe,mBAAmB,CAAC","sourcesContent":["import { useDebouncedState, useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport type { ReactNode, ReactElement, ContextType } from 'react';\nimport React, { useState, useCallback, useMemo, useEffect } from 'react';\n\nimport type { EmojiByCategory } from '../../../app/emoji/client';\nimport { emoji, getFrequentEmoji, updateRecent, createEmojiList, createPickerEmojis, CUSTOM_CATEGORY } from '../../../app/emoji/client';\nimport { EmojiPickerContext } from '../../contexts/EmojiPickerContext';\nimport EmojiPicker from '../../views/composer/EmojiPicker/EmojiPicker';\nimport { useUpdateCustomEmoji } from './useUpdateCustomEmoji';\n\nconst DEFAULT_ITEMS_LIMIT = 90;\n\nconst EmojiPickerProvider = ({ children }: { children: ReactNode }): ReactElement => {\n\tconst [emojiPicker, setEmojiPicker] = useState<ReactElement | null>(null);\n\tconst [emojiToPreview, setEmojiToPreview] = useDebouncedState<{ emoji: string; name: string } | null>(null, 100);\n\tconst [recentEmojis, setRecentEmojis] = useLocalStorage<string[]>('emoji.recent', []);\n\tconst [actualTone, setActualTone] = useLocalStorage('emoji.tone', 0);\n\tconst [currentCategory, setCurrentCategory] = useState('recent');\n\tconst [customItemsLimit, setCustomItemsLimit] = useState(DEFAULT_ITEMS_LIMIT);\n\n\tconst [frequentEmojis, setFrequentEmojis] = useLocalStorage<[string, number][]>('emoji.frequent', []);\n\n\tconst [quickReactions, setQuickReactions] = useState<{ emoji: string; image: string }[]>(() =>\n\t\tgetFrequentEmoji(frequentEmojis.map(([emoji]) => emoji)),\n\t);\n\n\tuseUpdateCustomEmoji();\n\n\tconst addFrequentEmojis = useCallback(\n\t\t(emoji: string) => {\n\t\t\tconst empty: [string, number][] = frequentEmojis.some(([emojiName]) => emojiName === emoji) ? [] : [[emoji, 0]];\n\n\t\t\tconst sortedFrequent = [...empty, ...frequentEmojis]\n\t\t\t\t.map(([emojiName, count]) => {\n\t\t\t\t\treturn (emojiName === emoji ? [emojiName, Math.min(count + 5, 100)] : [emojiName, Math.max(count - 1, 0)]) as [string, number];\n\t\t\t\t})\n\t\t\t\t.sort(([, frequentA], [, frequentB]) => frequentB - frequentA);\n\n\t\t\tsetFrequentEmojis(sortedFrequent);\n\t\t\tsetQuickReactions(getFrequentEmoji(sortedFrequent.map(([emoji]) => emoji)));\n\t\t},\n\t\t[frequentEmojis, setFrequentEmojis],\n\t);\n\n\tconst [getEmojiListsByCategory, setEmojiListsByCategoryGetter] = useState<() => EmojiByCategory[]>(() => () => []);\n\n\t// TODO: improve this update\n\tconst updateEmojiListByCategory = useCallback(\n\t\t(categoryKey: string, limit: number = DEFAULT_ITEMS_LIMIT) => {\n\t\t\tsetEmojiListsByCategoryGetter(\n\t\t\t\t(getEmojiListsByCategory) => () =>\n\t\t\t\t\tgetEmojiListsByCategory().map((category) =>\n\t\t\t\t\t\tcategoryKey === category.key\n\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t...category,\n\t\t\t\t\t\t\t\t\temojis: {\n\t\t\t\t\t\t\t\t\t\tlist: createEmojiList(category.key, null, recentEmojis, setRecentEmojis),\n\t\t\t\t\t\t\t\t\t\tlimit: category.key === CUSTOM_CATEGORY ? limit | customItemsLimit : null,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t: category,\n\t\t\t\t\t),\n\t\t\t);\n\t\t},\n\t\t[customItemsLimit, recentEmojis, setRecentEmojis],\n\t);\n\n\tuseEffect(() => {\n\t\tif (recentEmojis?.length > 0) {\n\t\t\tupdateRecent(recentEmojis);\n\t\t}\n\n\t\tsetEmojiListsByCategoryGetter(() => () => createPickerEmojis(customItemsLimit, actualTone, recentEmojis, setRecentEmojis));\n\t}, [actualTone, recentEmojis, customItemsLimit, currentCategory, setRecentEmojis, frequentEmojis]);\n\n\tconst addRecentEmoji = useCallback(\n\t\t(_emoji: string) => {\n\t\t\taddFrequentEmojis(_emoji);\n\n\t\t\tconst recent = recentEmojis || [];\n\t\t\tconst pos = recent.indexOf(_emoji as never);\n\n\t\t\tif (pos !== -1) {\n\t\t\t\trecent.splice(pos, 1);\n\t\t\t}\n\n\t\t\trecent.unshift(_emoji);\n\n\t\t\t// limit recent emojis to 27 (3 rows of 9)\n\t\t\trecent.splice(27);\n\n\t\t\tsetRecentEmojis(recent);\n\t\t\temoji.packages.base.emojisByCategory.recent = recent;\n\t\t\tupdateEmojiListByCategory('recent');\n\t\t},\n\t\t[recentEmojis, setRecentEmojis, updateEmojiListByCategory, addFrequentEmojis],\n\t);\n\n\tconst open = useCallback((ref: Element, callback: (emoji: string) => void) => {\n\t\treturn setEmojiPicker(<EmojiPicker reference={ref} onClose={() => setEmojiPicker(null)} onPickEmoji={(emoji) => callback(emoji)} />);\n\t}, []);\n\n\tconst handlePreview = useCallback((emoji: string, name: string) => setEmojiToPreview({ emoji, name }), [setEmojiToPreview]);\n\n\tconst handleRemovePreview = useCallback(() => setEmojiToPreview(null), [setEmojiToPreview]);\n\n\tconst contextValue = useMemo(\n\t\t(): ContextType<typeof EmojiPickerContext> => ({\n\t\t\tisOpen: emojiPicker !== null,\n\t\t\tclose: () => setEmojiPicker(null),\n\t\t\topen,\n\t\t\temojiToPreview,\n\t\t\thandlePreview,\n\t\t\thandleRemovePreview,\n\t\t\taddRecentEmoji,\n\t\t\tgetEmojiListsByCategory,\n\t\t\trecentEmojis,\n\t\t\tsetRecentEmojis,\n\t\t\tactualTone,\n\t\t\tcurrentCategory,\n\t\t\tsetCurrentCategory,\n\t\t\tcustomItemsLimit,\n\t\t\tsetCustomItemsLimit,\n\t\t\tsetActualTone,\n\t\t\tquickReactions,\n\t\t}),\n\t\t[\n\t\t\temojiPicker,\n\t\t\topen,\n\t\t\temojiToPreview,\n\t\t\taddRecentEmoji,\n\t\t\tgetEmojiListsByCategory,\n\t\t\trecentEmojis,\n\t\t\tsetRecentEmojis,\n\t\t\tactualTone,\n\t\t\tcurrentCategory,\n\t\t\tsetCurrentCategory,\n\t\t\tcustomItemsLimit,\n\t\t\tsetActualTone,\n\t\t\tquickReactions,\n\t\t\thandlePreview,\n\t\t\thandleRemovePreview,\n\t\t],\n\t);\n\n\treturn (\n\t\t<EmojiPickerContext.Provider value={contextValue}>\n\t\t\t{children}\n\t\t\t{emojiPicker}\n\t\t</EmojiPickerContext.Provider>\n\t);\n};\n\nexport default EmojiPickerProvider;\n"]}}},"code":"var _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default: function (v) {\n    _objectSpread = v;\n  }\n}, 0);\nvar _toConsumableArray;\nmodule.link(\"@babel/runtime/helpers/toConsumableArray\", {\n  default: function (v) {\n    _toConsumableArray = v;\n  }\n}, 1);\nvar _slicedToArray;\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 2);\nvar useDebouncedState, useLocalStorage;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useDebouncedState: function (v) {\n    useDebouncedState = v;\n  },\n  useLocalStorage: function (v) {\n    useLocalStorage = v;\n  }\n}, 0);\nvar React, useState, useCallback, useMemo, useEffect;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useState: function (v) {\n    useState = v;\n  },\n  useCallback: function (v) {\n    useCallback = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  },\n  useEffect: function (v) {\n    useEffect = v;\n  }\n}, 1);\nvar emoji, getFrequentEmoji, updateRecent, createEmojiList, createPickerEmojis, CUSTOM_CATEGORY;\nmodule.link(\"../../../app/emoji/client\", {\n  emoji: function (v) {\n    emoji = v;\n  },\n  getFrequentEmoji: function (v) {\n    getFrequentEmoji = v;\n  },\n  updateRecent: function (v) {\n    updateRecent = v;\n  },\n  createEmojiList: function (v) {\n    createEmojiList = v;\n  },\n  createPickerEmojis: function (v) {\n    createPickerEmojis = v;\n  },\n  CUSTOM_CATEGORY: function (v) {\n    CUSTOM_CATEGORY = v;\n  }\n}, 2);\nvar EmojiPickerContext;\nmodule.link(\"../../contexts/EmojiPickerContext\", {\n  EmojiPickerContext: function (v) {\n    EmojiPickerContext = v;\n  }\n}, 3);\nvar EmojiPicker;\nmodule.link(\"../../views/composer/EmojiPicker/EmojiPicker\", {\n  \"default\": function (v) {\n    EmojiPicker = v;\n  }\n}, 4);\nvar useUpdateCustomEmoji;\nmodule.link(\"./useUpdateCustomEmoji\", {\n  useUpdateCustomEmoji: function (v) {\n    useUpdateCustomEmoji = v;\n  }\n}, 5);\nvar DEFAULT_ITEMS_LIMIT = 90;\nvar EmojiPickerProvider = function (_ref) {\n  var children = _ref.children;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    emojiPicker = _useState2[0],\n    setEmojiPicker = _useState2[1];\n  var _useDebouncedState = useDebouncedState(null, 100),\n    _useDebouncedState2 = _slicedToArray(_useDebouncedState, 2),\n    emojiToPreview = _useDebouncedState2[0],\n    setEmojiToPreview = _useDebouncedState2[1];\n  var _useLocalStorage = useLocalStorage('emoji.recent', []),\n    _useLocalStorage2 = _slicedToArray(_useLocalStorage, 2),\n    recentEmojis = _useLocalStorage2[0],\n    setRecentEmojis = _useLocalStorage2[1];\n  var _useLocalStorage3 = useLocalStorage('emoji.tone', 0),\n    _useLocalStorage4 = _slicedToArray(_useLocalStorage3, 2),\n    actualTone = _useLocalStorage4[0],\n    setActualTone = _useLocalStorage4[1];\n  var _useState3 = useState('recent'),\n    _useState4 = _slicedToArray(_useState3, 2),\n    currentCategory = _useState4[0],\n    setCurrentCategory = _useState4[1];\n  var _useState5 = useState(DEFAULT_ITEMS_LIMIT),\n    _useState6 = _slicedToArray(_useState5, 2),\n    customItemsLimit = _useState6[0],\n    setCustomItemsLimit = _useState6[1];\n  var _useLocalStorage5 = useLocalStorage('emoji.frequent', []),\n    _useLocalStorage6 = _slicedToArray(_useLocalStorage5, 2),\n    frequentEmojis = _useLocalStorage6[0],\n    setFrequentEmojis = _useLocalStorage6[1];\n  var _useState7 = useState(function () {\n      return getFrequentEmoji(frequentEmojis.map(function (_ref2) {\n        var _ref3 = _slicedToArray(_ref2, 1),\n          emoji = _ref3[0];\n        return emoji;\n      }));\n    }),\n    _useState8 = _slicedToArray(_useState7, 2),\n    quickReactions = _useState8[0],\n    setQuickReactions = _useState8[1];\n  useUpdateCustomEmoji();\n  var addFrequentEmojis = useCallback(function (emoji) {\n    var empty = frequentEmojis.some(function (_ref4) {\n      var _ref5 = _slicedToArray(_ref4, 1),\n        emojiName = _ref5[0];\n      return emojiName === emoji;\n    }) ? [] : [[emoji, 0]];\n    var sortedFrequent = [].concat(empty, _toConsumableArray(frequentEmojis)).map(function (_ref6) {\n      var _ref7 = _slicedToArray(_ref6, 2),\n        emojiName = _ref7[0],\n        count = _ref7[1];\n      return emojiName === emoji ? [emojiName, Math.min(count + 5, 100)] : [emojiName, Math.max(count - 1, 0)];\n    }).sort(function (_ref8, _ref9) {\n      var _ref10 = _slicedToArray(_ref8, 2),\n        frequentA = _ref10[1];\n      var _ref11 = _slicedToArray(_ref9, 2),\n        frequentB = _ref11[1];\n      return frequentB - frequentA;\n    });\n    setFrequentEmojis(sortedFrequent);\n    setQuickReactions(getFrequentEmoji(sortedFrequent.map(function (_ref12) {\n      var _ref13 = _slicedToArray(_ref12, 1),\n        emoji = _ref13[0];\n      return emoji;\n    })));\n  }, [frequentEmojis, setFrequentEmojis]);\n  var _useState9 = useState(function () {\n      return function () {\n        return [];\n      };\n    }),\n    _useState10 = _slicedToArray(_useState9, 2),\n    getEmojiListsByCategory = _useState10[0],\n    setEmojiListsByCategoryGetter = _useState10[1];\n  // TODO: improve this update\n  var updateEmojiListByCategory = useCallback(function (categoryKey) {\n    var limit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : DEFAULT_ITEMS_LIMIT;\n    setEmojiListsByCategoryGetter(function (getEmojiListsByCategory) {\n      return function () {\n        return getEmojiListsByCategory().map(function (category) {\n          return categoryKey === category.key ? _objectSpread(_objectSpread({}, category), {}, {\n            emojis: {\n              list: createEmojiList(category.key, null, recentEmojis, setRecentEmojis),\n              limit: category.key === CUSTOM_CATEGORY ? limit | customItemsLimit : null\n            }\n          }) : category;\n        });\n      };\n    });\n  }, [customItemsLimit, recentEmojis, setRecentEmojis]);\n  useEffect(function () {\n    if ((recentEmojis === null || recentEmojis === void 0 ? void 0 : recentEmojis.length) > 0) {\n      updateRecent(recentEmojis);\n    }\n    setEmojiListsByCategoryGetter(function () {\n      return function () {\n        return createPickerEmojis(customItemsLimit, actualTone, recentEmojis, setRecentEmojis);\n      };\n    });\n  }, [actualTone, recentEmojis, customItemsLimit, currentCategory, setRecentEmojis, frequentEmojis]);\n  var addRecentEmoji = useCallback(function (_emoji) {\n    addFrequentEmojis(_emoji);\n    var recent = recentEmojis || [];\n    var pos = recent.indexOf(_emoji);\n    if (pos !== -1) {\n      recent.splice(pos, 1);\n    }\n    recent.unshift(_emoji);\n    // limit recent emojis to 27 (3 rows of 9)\n    recent.splice(27);\n    setRecentEmojis(recent);\n    emoji.packages.base.emojisByCategory.recent = recent;\n    updateEmojiListByCategory('recent');\n  }, [recentEmojis, setRecentEmojis, updateEmojiListByCategory, addFrequentEmojis]);\n  var open = useCallback(function (ref, callback) {\n    return setEmojiPicker( /*#__PURE__*/React.createElement(EmojiPicker, {\n      reference: ref,\n      onClose: function () {\n        return setEmojiPicker(null);\n      },\n      onPickEmoji: function (emoji) {\n        return callback(emoji);\n      }\n    }));\n  }, []);\n  var handlePreview = useCallback(function (emoji, name) {\n    return setEmojiToPreview({\n      emoji: emoji,\n      name: name\n    });\n  }, [setEmojiToPreview]);\n  var handleRemovePreview = useCallback(function () {\n    return setEmojiToPreview(null);\n  }, [setEmojiToPreview]);\n  var contextValue = useMemo(function () {\n    return {\n      isOpen: emojiPicker !== null,\n      close: function () {\n        return setEmojiPicker(null);\n      },\n      open: open,\n      emojiToPreview: emojiToPreview,\n      handlePreview: handlePreview,\n      handleRemovePreview: handleRemovePreview,\n      addRecentEmoji: addRecentEmoji,\n      getEmojiListsByCategory: getEmojiListsByCategory,\n      recentEmojis: recentEmojis,\n      setRecentEmojis: setRecentEmojis,\n      actualTone: actualTone,\n      currentCategory: currentCategory,\n      setCurrentCategory: setCurrentCategory,\n      customItemsLimit: customItemsLimit,\n      setCustomItemsLimit: setCustomItemsLimit,\n      setActualTone: setActualTone,\n      quickReactions: quickReactions\n    };\n  }, [emojiPicker, open, emojiToPreview, addRecentEmoji, getEmojiListsByCategory, recentEmojis, setRecentEmojis, actualTone, currentCategory, setCurrentCategory, customItemsLimit, setActualTone, quickReactions, handlePreview, handleRemovePreview]);\n  return /*#__PURE__*/React.createElement(EmojiPickerContext.Provider, {\n    value: contextValue\n  }, children, emojiPicker);\n};\nmodule.exportDefault(EmojiPickerProvider);","map":{"version":3,"names":["_objectSpread","module","link","default","v","_toConsumableArray","_slicedToArray","useDebouncedState","useLocalStorage","React","useState","useCallback","useMemo","useEffect","emoji","getFrequentEmoji","updateRecent","createEmojiList","createPickerEmojis","CUSTOM_CATEGORY","EmojiPickerContext","EmojiPicker","useUpdateCustomEmoji","DEFAULT_ITEMS_LIMIT","EmojiPickerProvider","_ref","children","_useState","_useState2","emojiPicker","setEmojiPicker","_useDebouncedState","_useDebouncedState2","emojiToPreview","setEmojiToPreview","_useLocalStorage","_useLocalStorage2","recentEmojis","setRecentEmojis","_useLocalStorage3","_useLocalStorage4","actualTone","setActualTone","_useState3","_useState4","currentCategory","setCurrentCategory","_useState5","_useState6","customItemsLimit","setCustomItemsLimit","_useLocalStorage5","_useLocalStorage6","frequentEmojis","setFrequentEmojis","_useState7","map","_ref2","_ref3","_useState8","quickReactions","setQuickReactions","addFrequentEmojis","empty","some","_ref4","_ref5","emojiName","sortedFrequent","concat","_ref6","_ref7","count","Math","min","max","sort","_ref8","_ref9","_ref10","frequentA","_ref11","frequentB","_ref12","_ref13","_useState9","_useState10","getEmojiListsByCategory","setEmojiListsByCategoryGetter","updateEmojiListByCategory","categoryKey","limit","arguments","length","undefined","category","key","emojis","list","addRecentEmoji","_emoji","recent","pos","indexOf","splice","unshift","packages","base","emojisByCategory","open","ref","callback","createElement","reference","onClose","onPickEmoji","handlePreview","name","handleRemovePreview","contextValue","isOpen","close","Provider","value","exportDefault"],"sources":["client/providers/EmojiPickerProvider/EmojiPickerProvider.tsx"],"sourcesContent":["import { useDebouncedState, useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport type { ReactNode, ReactElement, ContextType } from 'react';\nimport React, { useState, useCallback, useMemo, useEffect } from 'react';\n\nimport type { EmojiByCategory } from '../../../app/emoji/client';\nimport { emoji, getFrequentEmoji, updateRecent, createEmojiList, createPickerEmojis, CUSTOM_CATEGORY } from '../../../app/emoji/client';\nimport { EmojiPickerContext } from '../../contexts/EmojiPickerContext';\nimport EmojiPicker from '../../views/composer/EmojiPicker/EmojiPicker';\nimport { useUpdateCustomEmoji } from './useUpdateCustomEmoji';\n\nconst DEFAULT_ITEMS_LIMIT = 90;\n\nconst EmojiPickerProvider = ({ children }: { children: ReactNode }): ReactElement => {\n\tconst [emojiPicker, setEmojiPicker] = useState<ReactElement | null>(null);\n\tconst [emojiToPreview, setEmojiToPreview] = useDebouncedState<{ emoji: string; name: string } | null>(null, 100);\n\tconst [recentEmojis, setRecentEmojis] = useLocalStorage<string[]>('emoji.recent', []);\n\tconst [actualTone, setActualTone] = useLocalStorage('emoji.tone', 0);\n\tconst [currentCategory, setCurrentCategory] = useState('recent');\n\tconst [customItemsLimit, setCustomItemsLimit] = useState(DEFAULT_ITEMS_LIMIT);\n\n\tconst [frequentEmojis, setFrequentEmojis] = useLocalStorage<[string, number][]>('emoji.frequent', []);\n\n\tconst [quickReactions, setQuickReactions] = useState<{ emoji: string; image: string }[]>(() =>\n\t\tgetFrequentEmoji(frequentEmojis.map(([emoji]) => emoji)),\n\t);\n\n\tuseUpdateCustomEmoji();\n\n\tconst addFrequentEmojis = useCallback(\n\t\t(emoji: string) => {\n\t\t\tconst empty: [string, number][] = frequentEmojis.some(([emojiName]) => emojiName === emoji) ? [] : [[emoji, 0]];\n\n\t\t\tconst sortedFrequent = [...empty, ...frequentEmojis]\n\t\t\t\t.map(([emojiName, count]) => {\n\t\t\t\t\treturn (emojiName === emoji ? [emojiName, Math.min(count + 5, 100)] : [emojiName, Math.max(count - 1, 0)]) as [string, number];\n\t\t\t\t})\n\t\t\t\t.sort(([, frequentA], [, frequentB]) => frequentB - frequentA);\n\n\t\t\tsetFrequentEmojis(sortedFrequent);\n\t\t\tsetQuickReactions(getFrequentEmoji(sortedFrequent.map(([emoji]) => emoji)));\n\t\t},\n\t\t[frequentEmojis, setFrequentEmojis],\n\t);\n\n\tconst [getEmojiListsByCategory, setEmojiListsByCategoryGetter] = useState<() => EmojiByCategory[]>(() => () => []);\n\n\t// TODO: improve this update\n\tconst updateEmojiListByCategory = useCallback(\n\t\t(categoryKey: string, limit: number = DEFAULT_ITEMS_LIMIT) => {\n\t\t\tsetEmojiListsByCategoryGetter(\n\t\t\t\t(getEmojiListsByCategory) => () =>\n\t\t\t\t\tgetEmojiListsByCategory().map((category) =>\n\t\t\t\t\t\tcategoryKey === category.key\n\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t...category,\n\t\t\t\t\t\t\t\t\temojis: {\n\t\t\t\t\t\t\t\t\t\tlist: createEmojiList(category.key, null, recentEmojis, setRecentEmojis),\n\t\t\t\t\t\t\t\t\t\tlimit: category.key === CUSTOM_CATEGORY ? limit | customItemsLimit : null,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t: category,\n\t\t\t\t\t),\n\t\t\t);\n\t\t},\n\t\t[customItemsLimit, recentEmojis, setRecentEmojis],\n\t);\n\n\tuseEffect(() => {\n\t\tif (recentEmojis?.length > 0) {\n\t\t\tupdateRecent(recentEmojis);\n\t\t}\n\n\t\tsetEmojiListsByCategoryGetter(() => () => createPickerEmojis(customItemsLimit, actualTone, recentEmojis, setRecentEmojis));\n\t}, [actualTone, recentEmojis, customItemsLimit, currentCategory, setRecentEmojis, frequentEmojis]);\n\n\tconst addRecentEmoji = useCallback(\n\t\t(_emoji: string) => {\n\t\t\taddFrequentEmojis(_emoji);\n\n\t\t\tconst recent = recentEmojis || [];\n\t\t\tconst pos = recent.indexOf(_emoji as never);\n\n\t\t\tif (pos !== -1) {\n\t\t\t\trecent.splice(pos, 1);\n\t\t\t}\n\n\t\t\trecent.unshift(_emoji);\n\n\t\t\t// limit recent emojis to 27 (3 rows of 9)\n\t\t\trecent.splice(27);\n\n\t\t\tsetRecentEmojis(recent);\n\t\t\temoji.packages.base.emojisByCategory.recent = recent;\n\t\t\tupdateEmojiListByCategory('recent');\n\t\t},\n\t\t[recentEmojis, setRecentEmojis, updateEmojiListByCategory, addFrequentEmojis],\n\t);\n\n\tconst open = useCallback((ref: Element, callback: (emoji: string) => void) => {\n\t\treturn setEmojiPicker(<EmojiPicker reference={ref} onClose={() => setEmojiPicker(null)} onPickEmoji={(emoji) => callback(emoji)} />);\n\t}, []);\n\n\tconst handlePreview = useCallback((emoji: string, name: string) => setEmojiToPreview({ emoji, name }), [setEmojiToPreview]);\n\n\tconst handleRemovePreview = useCallback(() => setEmojiToPreview(null), [setEmojiToPreview]);\n\n\tconst contextValue = useMemo(\n\t\t(): ContextType<typeof EmojiPickerContext> => ({\n\t\t\tisOpen: emojiPicker !== null,\n\t\t\tclose: () => setEmojiPicker(null),\n\t\t\topen,\n\t\t\temojiToPreview,\n\t\t\thandlePreview,\n\t\t\thandleRemovePreview,\n\t\t\taddRecentEmoji,\n\t\t\tgetEmojiListsByCategory,\n\t\t\trecentEmojis,\n\t\t\tsetRecentEmojis,\n\t\t\tactualTone,\n\t\t\tcurrentCategory,\n\t\t\tsetCurrentCategory,\n\t\t\tcustomItemsLimit,\n\t\t\tsetCustomItemsLimit,\n\t\t\tsetActualTone,\n\t\t\tquickReactions,\n\t\t}),\n\t\t[\n\t\t\temojiPicker,\n\t\t\topen,\n\t\t\temojiToPreview,\n\t\t\taddRecentEmoji,\n\t\t\tgetEmojiListsByCategory,\n\t\t\trecentEmojis,\n\t\t\tsetRecentEmojis,\n\t\t\tactualTone,\n\t\t\tcurrentCategory,\n\t\t\tsetCurrentCategory,\n\t\t\tcustomItemsLimit,\n\t\t\tsetActualTone,\n\t\t\tquickReactions,\n\t\t\thandlePreview,\n\t\t\thandleRemovePreview,\n\t\t],\n\t);\n\n\treturn (\n\t\t<EmojiPickerContext.Provider value={contextValue}>\n\t\t\t{children}\n\t\t\t{emojiPicker}\n\t\t</EmojiPickerContext.Provider>\n\t);\n};\n\nexport default EmojiPickerProvider;\n"],"mappings":"AAAA,IAAAA,aAAS;AAAAC,MAAA,CAAAC,IAAmB,uCAAuB;EAAAC,OAAA,WAAAA,CAA8BC,CAAA;IAAAJ,aAAA,GAAAI,CAAA;EAAA;AAAA;AAAA,IAAAC,kBAAA;AAAAJ,MAAA,CAAAC,IAAA;EAAAC,OAAA,WAAAA,CAAAC,CAAA;IAAAC,kBAAA,GAAAD,CAAA;EAAA;AAAA;AAAA,IAAAE,cAAA;AAAAL,MAAA,CAAAC,IAAA;EAAAC,OAAA,WAAAA,CAAAC,CAAA;IAAAE,cAAA,GAAAF,CAAA;EAAA;AAAA;AAAjF,IAAAG,iBAAS,EAAAC,eAAmB;AAAAP,MAAe,CAAEC,IAAA,8BAAM,EAA6B;EAACK,iBAAA,WAAAA,CAAAH,CAAA;IAAAG,iBAAA,GAAAH,CAAA;EAAA;EAAAI,eAAA,WAAAA,CAAAJ,CAAA;IAAAI,eAAA,GAAAJ,CAAA;EAAA;AAAA;AAAA,IAAAK,KAAA,EAAAC,QAAA,EAAAC,WAAA,EAAAC,OAAA,EAAAC,SAAA;AAAAZ,MAAA,CAAAC,IAAA;EAAA,oBAAAC,CAAAC,CAAA;IAAAK,KAAA,GAAAL,CAAA;EAAA;EAAAM,QAAA,WAAAA,CAAAN,CAAA;IAAAM,QAAA,GAAAN,CAAA;EAAA;EAAAO,WAAA,WAAAA,CAAAP,CAAA;IAAAO,WAAA,GAAAP,CAAA;EAAA;EAAAQ,OAAA,WAAAA,CAAAR,CAAA;IAAAQ,OAAA,GAAAR,CAAA;EAAA;EAAAS,SAAA,WAAAA,CAAAT,CAAA;IAAAS,SAAA,GAAAT,CAAA;EAAA;AAAA;AAAA,IAAAU,KAAA,EAAAC,gBAAA,EAAAC,YAAA,EAAAC,eAAA,EAAAC,kBAAA,EAAAC,eAAA;AAAAlB,MAAA,CAAAC,IAAA;EAAAY,KAAA,WAAAA,CAAAV,CAAA;IAAAU,KAAA,GAAAV,CAAA;EAAA;EAAAW,gBAAA,WAAAA,CAAAX,CAAA;IAAAW,gBAAA,GAAAX,CAAA;EAAA;EAAAY,YAAA,WAAAA,CAAAZ,CAAA;IAAAY,YAAA,GAAAZ,CAAA;EAAA;EAAAa,eAAA,WAAAA,CAAAb,CAAA;IAAAa,eAAA,GAAAb,CAAA;EAAA;EAAAc,kBAAA,WAAAA,CAAAd,CAAA;IAAAc,kBAAA,GAAAd,CAAA;EAAA;EAAAe,eAAA,WAAAA,CAAAf,CAAA;IAAAe,eAAA,GAAAf,CAAA;EAAA;AAAA;AAAA,IAAAgB,kBAAA;AAAAnB,MAAA,CAAAC,IAAA;EAAAkB,kBAAA,WAAAA,CAAAhB,CAAA;IAAAgB,kBAAA,GAAAhB,CAAA;EAAA;AAAA;AAAA,IAAAiB,WAAA;AAAApB,MAAA,CAAAC,IAAA;EAAA,oBAAAC,CAAAC,CAAA;IAAAiB,WAAA,GAAAjB,CAAA;EAAA;AAAA;AAAA,IAAAkB,oBAAA;AAAArB,MAAA,CAAAC,IAAA;EAAAoB,oBAAA,WAAAA,CAAAlB,CAAA;IAAAkB,oBAAA,GAAAlB,CAAA;EAAA;AAAA;AAUjF,IAAMmB,mBAAmB,GAAG,EAAE;AAE9B,IAAMC,mBAAmB,GAAG,SAAAA,CAAAC,IAAA,EAAwD;EAAA,IAArDC,QAAQ,GAAAD,IAAA,CAARC,QAAQ;EACtC,IAAAC,SAAA,GAAsCjB,QAAQ,CAAsB,IAAI,CAAC;IAAAkB,UAAA,GAAAtB,cAAA,CAAAqB,SAAA;IAAlEE,WAAW,GAAAD,UAAA;IAAEE,cAAc,GAAAF,UAAA;EAClC,IAAAG,kBAAA,GAA4CxB,iBAAiB,CAAyC,IAAI,EAAE,GAAG,CAAC;IAAAyB,mBAAA,GAAA1B,cAAA,CAAAyB,kBAAA;IAAzGE,cAAc,GAAAD,mBAAA;IAAEE,iBAAiB,GAAAF,mBAAA;EACxC,IAAAG,gBAAA,GAAwC3B,eAAe,CAAW,cAAc,EAAE,EAAE,CAAC;IAAA4B,iBAAA,GAAA9B,cAAA,CAAA6B,gBAAA;IAA9EE,YAAY,GAAAD,iBAAA;IAAEE,eAAe,GAAAF,iBAAA;EACpC,IAAAG,iBAAA,GAAoC/B,eAAe,CAAC,YAAY,EAAE,CAAC,CAAC;IAAAgC,iBAAA,GAAAlC,cAAA,CAAAiC,iBAAA;IAA7DE,UAAU,GAAAD,iBAAA;IAAEE,aAAa,GAAAF,iBAAA;EAChC,IAAAG,UAAA,GAA8CjC,QAAQ,CAAC,QAAQ,CAAC;IAAAkC,UAAA,GAAAtC,cAAA,CAAAqC,UAAA;IAAzDE,eAAe,GAAAD,UAAA;IAAEE,kBAAkB,GAAAF,UAAA;EAC1C,IAAAG,UAAA,GAAgDrC,QAAQ,CAACa,mBAAmB,CAAC;IAAAyB,UAAA,GAAA1C,cAAA,CAAAyC,UAAA;IAAtEE,gBAAgB,GAAAD,UAAA;IAAEE,mBAAmB,GAAAF,UAAA;EAE5C,IAAAG,iBAAA,GAA4C3C,eAAe,CAAqB,gBAAgB,EAAE,EAAE,CAAC;IAAA4C,iBAAA,GAAA9C,cAAA,CAAA6C,iBAAA;IAA9FE,cAAc,GAAAD,iBAAA;IAAEE,iBAAiB,GAAAF,iBAAA;EAExC,IAAAG,UAAA,GAA4C7C,QAAQ,CAAqC;MAAA,OACxFK,gBAAgB,CAACsC,cAAc,CAACG,GAAG,CAAC,UAAAC,KAAA;QAAA,IAAAC,KAAA,GAAApD,cAAA,CAAAmD,KAAA;UAAE3C,KAAK,GAAA4C,KAAA;QAAA,OAAM5C,KAAK;MAAA,EAAC,CAAC;IAAA,EACxD;IAAA6C,UAAA,GAAArD,cAAA,CAAAiD,UAAA;IAFMK,cAAc,GAAAD,UAAA;IAAEE,iBAAiB,GAAAF,UAAA;EAIxCrC,oBAAoB,EAAE;EAEtB,IAAMwC,iBAAiB,GAAGnD,WAAW,CACpC,UAACG,KAAa,EAAI;IACjB,IAAMiD,KAAK,GAAuBV,cAAc,CAACW,IAAI,CAAC,UAAAC,KAAA;MAAA,IAAAC,KAAA,GAAA5D,cAAA,CAAA2D,KAAA;QAAEE,SAAS,GAAAD,KAAA;MAAA,OAAMC,SAAS,KAAKrD,KAAK;IAAA,EAAC,GAAG,EAAE,GAAG,CAAC,CAACA,KAAK,EAAE,CAAC,CAAC,CAAC;IAE/G,IAAMsD,cAAc,GAAG,GAAAC,MAAA,CAAIN,KAAK,EAAA1D,kBAAA,CAAKgD,cAAc,GACjDG,GAAG,CAAC,UAAAc,KAAA,EAAuB;MAAA,IAAAC,KAAA,GAAAjE,cAAA,CAAAgE,KAAA;QAArBH,SAAS,GAAAI,KAAA;QAAEC,KAAK,GAAAD,KAAA;MACtB,OAAQJ,SAAS,KAAKrD,KAAK,GAAG,CAACqD,SAAS,EAAEM,IAAI,CAACC,GAAG,CAACF,KAAK,GAAG,CAAC,EAAE,GAAG,CAAC,CAAC,GAAG,CAACL,SAAS,EAAEM,IAAI,CAACE,GAAG,CAACH,KAAK,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;IAC1G,CAAC,CAAC,CACDI,IAAI,CAAC,UAAAC,KAAA,EAAAC,KAAA;MAAA,IAAAC,MAAA,GAAAzE,cAAA,CAAAuE,KAAA;QAAIG,SAAS,GAAAD,MAAA;MAAA,IAAAE,MAAA,GAAA3E,cAAA,CAAAwE,KAAA;QAAMI,SAAS,GAAAD,MAAA;MAAA,OAAMC,SAAS,GAAGF,SAAS;IAAA,EAAC;IAE/D1B,iBAAiB,CAACc,cAAc,CAAC;IACjCP,iBAAiB,CAAC9C,gBAAgB,CAACqD,cAAc,CAACZ,GAAG,CAAC,UAAA2B,MAAA;MAAA,IAAAC,MAAA,GAAA9E,cAAA,CAAA6E,MAAA;QAAErE,KAAK,GAAAsE,MAAA;MAAA,OAAMtE,KAAK;IAAA,EAAC,CAAC,CAAC;EAC5E,CAAC,EACD,CAACuC,cAAc,EAAEC,iBAAiB,CAAC,CACnC;EAED,IAAA+B,UAAA,GAAiE3E,QAAQ,CAA0B;MAAA,OAAM;QAAA,OAAM,EAAE;MAAA;IAAA,EAAC;IAAA4E,WAAA,GAAAhF,cAAA,CAAA+E,UAAA;IAA3GE,uBAAuB,GAAAD,WAAA;IAAEE,6BAA6B,GAAAF,WAAA;EAE7D;EACA,IAAMG,yBAAyB,GAAG9E,WAAW,CAC5C,UAAC+E,WAAmB,EAAyC;IAAA,IAAvCC,KAAA,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAgBrE,mBAAmB;IACxDiE,6BAA6B,CAC5B,UAACD,uBAAuB;MAAA,OAAK;QAAA,OAC5BA,uBAAuB,EAAE,CAAC/B,GAAG,CAAC,UAACuC,QAAQ;UAAA,OACtCL,WAAW,KAAKK,QAAQ,CAACC,GAAG,GAAAhG,aAAA,CAAAA,aAAA,KAEtB+F,QAAQ;YACXE,MAAM,EAAE;cACPC,IAAI,EAAEjF,eAAe,CAAC8E,QAAQ,CAACC,GAAG,EAAE,IAAI,EAAE3D,YAAY,EAAEC,eAAe,CAAC;cACxEqD,KAAK,EAAEI,QAAQ,CAACC,GAAG,KAAK7E,eAAe,GAAGwE,KAAK,GAAG1C,gBAAgB,GAAG;;UACrE,KAED8C,QAAQ;QAAA,EACX;MAAA;IAAA,EACF;EACF,CAAC,EACD,CAAC9C,gBAAgB,EAAEZ,YAAY,EAAEC,eAAe,CAAC,CACjD;EAEDzB,SAAS,CAAC,YAAK;IACd,IAAI,CAAAwB,YAAY,aAAZA,YAAY,uBAAZA,YAAY,CAAEwD,MAAM,IAAG,CAAC,EAAE;MAC7B7E,YAAY,CAACqB,YAAY,CAAC;IAC3B;IAEAmD,6BAA6B,CAAC;MAAA,OAAM;QAAA,OAAMtE,kBAAkB,CAAC+B,gBAAgB,EAAER,UAAU,EAAEJ,YAAY,EAAEC,eAAe,CAAC;MAAA;IAAA,EAAC;EAC3H,CAAC,EAAE,CAACG,UAAU,EAAEJ,YAAY,EAAEY,gBAAgB,EAAEJ,eAAe,EAAEP,eAAe,EAAEe,cAAc,CAAC,CAAC;EAElG,IAAM8C,cAAc,GAAGxF,WAAW,CACjC,UAACyF,MAAc,EAAI;IAClBtC,iBAAiB,CAACsC,MAAM,CAAC;IAEzB,IAAMC,MAAM,GAAGhE,YAAY,IAAI,EAAE;IACjC,IAAMiE,GAAG,GAAGD,MAAM,CAACE,OAAO,CAACH,MAAe,CAAC;IAE3C,IAAIE,GAAG,KAAK,CAAC,CAAC,EAAE;MACfD,MAAM,CAACG,MAAM,CAACF,GAAG,EAAE,CAAC,CAAC;IACtB;IAEAD,MAAM,CAACI,OAAO,CAACL,MAAM,CAAC;IAEtB;IACAC,MAAM,CAACG,MAAM,CAAC,EAAE,CAAC;IAEjBlE,eAAe,CAAC+D,MAAM,CAAC;IACvBvF,KAAK,CAAC4F,QAAQ,CAACC,IAAI,CAACC,gBAAgB,CAACP,MAAM,GAAGA,MAAM;IACpDZ,yBAAyB,CAAC,QAAQ,CAAC;EACpC,CAAC,EACD,CAACpD,YAAY,EAAEC,eAAe,EAAEmD,yBAAyB,EAAE3B,iBAAiB,CAAC,CAC7E;EAED,IAAM+C,IAAI,GAAGlG,WAAW,CAAC,UAACmG,GAAY,EAAEC,QAAiC,EAAI;IAC5E,OAAOjF,cAAc,eAACrB,KAAA,CAAAuG,aAAA,CAAC3F,WAAW;MAAC4F,SAAS,EAAEH,GAAI;MAACI,OAAO,EAAE,SAAAA,CAAA;QAAA,OAAMpF,cAAc,CAAC,IAAI,CAAC;MAAA,CAAC;MAACqF,WAAW,EAAE,SAAAA,CAACrG,KAAK;QAAA,OAAKiG,QAAQ,CAACjG,KAAK,CAAC;MAAA;IAAC,EAAG,CAAC;EACrI,CAAC,EAAE,EAAE,CAAC;EAEN,IAAMsG,aAAa,GAAGzG,WAAW,CAAC,UAACG,KAAa,EAAEuG,IAAY;IAAA,OAAKnF,iBAAiB,CAAC;MAAEpB,KAAK,EAALA,KAAK;MAAEuG,IAAI,EAAJA;IAAI,CAAE,CAAC;EAAA,GAAE,CAACnF,iBAAiB,CAAC,CAAC;EAE3H,IAAMoF,mBAAmB,GAAG3G,WAAW,CAAC;IAAA,OAAMuB,iBAAiB,CAAC,IAAI,CAAC;EAAA,GAAE,CAACA,iBAAiB,CAAC,CAAC;EAE3F,IAAMqF,YAAY,GAAG3G,OAAO,CAC3B;IAAA,OAA+C;MAC9C4G,MAAM,EAAE3F,WAAW,KAAK,IAAI;MAC5B4F,KAAK,EAAE,SAAAA,CAAA;QAAA,OAAM3F,cAAc,CAAC,IAAI,CAAC;MAAA;MACjC+E,IAAI,EAAJA,IAAI;MACJ5E,cAAc,EAAdA,cAAc;MACdmF,aAAa,EAAbA,aAAa;MACbE,mBAAmB,EAAnBA,mBAAmB;MACnBnB,cAAc,EAAdA,cAAc;MACdZ,uBAAuB,EAAvBA,uBAAuB;MACvBlD,YAAY,EAAZA,YAAY;MACZC,eAAe,EAAfA,eAAe;MACfG,UAAU,EAAVA,UAAU;MACVI,eAAe,EAAfA,eAAe;MACfC,kBAAkB,EAAlBA,kBAAkB;MAClBG,gBAAgB,EAAhBA,gBAAgB;MAChBC,mBAAmB,EAAnBA,mBAAmB;MACnBR,aAAa,EAAbA,aAAa;MACbkB,cAAc,EAAdA;KACA;EAAA,CAAC,EACF,CACC/B,WAAW,EACXgF,IAAI,EACJ5E,cAAc,EACdkE,cAAc,EACdZ,uBAAuB,EACvBlD,YAAY,EACZC,eAAe,EACfG,UAAU,EACVI,eAAe,EACfC,kBAAkB,EAClBG,gBAAgB,EAChBP,aAAa,EACbkB,cAAc,EACdwD,aAAa,EACbE,mBAAmB,CACnB,CACD;EAED,oBACC7G,KAAA,CAAAuG,aAAA,CAAC5F,kBAAkB,CAACsG,QAAQ;IAACC,KAAK,EAAEJ;EAAa,GAC/C7F,QAAQ,EACRG,WAC2B,CAAC;AAEhC,CAAC;AAvJD5B,MAAA,CAAO2H,aAAE,CAyJMpG,mBAzJN","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"6c4d4097f694ab91699ec01ac50e6123945dab62"}
