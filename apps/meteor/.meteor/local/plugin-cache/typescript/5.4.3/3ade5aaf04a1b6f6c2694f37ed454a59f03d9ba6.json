{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/sidebarv2/header/CreateDirectMessage.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/sidebarv2/header/CreateDirectMessage.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/sidebarv2/header/CreateDirectMessage.tsx","inputSourceMap":{"version":3,"file":"client/sidebarv2/header/CreateDirectMessage.tsx","sourceRoot":"","sources":["client/sidebarv2/header/CreateDirectMessage.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IUser } from '@rocket.chat/core-typings';\nimport { Box, Modal, Button, FieldGroup, Field, FieldRow, FieldError, FieldHint } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation, useEndpoint, useToastMessageDispatch, useSetting } from '@rocket.chat/ui-contexts';\nimport { useMutation } from '@tanstack/react-query';\nimport React, { memo } from 'react';\nimport { useForm, Controller } from 'react-hook-form';\n\nimport UserAutoCompleteMultipleFederated from '../../components/UserAutoCompleteMultiple/UserAutoCompleteMultipleFederated';\nimport { goToRoomById } from '../../lib/utils/goToRoomById';\n\ntype CreateDirectMessageProps = { onClose: () => void };\n\nconst CreateDirectMessage = ({ onClose }: CreateDirectMessageProps) => {\n\tconst t = useTranslation();\n\tconst directMaxUsers = useSetting<number>('DirectMesssage_maxUsers') || 1;\n\tconst membersFieldId = useUniqueId();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst createDirectAction = useEndpoint('POST', '/v1/dm.create');\n\n\tconst {\n\t\tcontrol,\n\t\thandleSubmit,\n\t\tformState: { isSubmitting, isValidating, errors },\n\t} = useForm({ mode: 'onBlur', defaultValues: { users: [] } });\n\n\tconst mutateDirectMessage = useMutation({\n\t\tmutationFn: createDirectAction,\n\t\tonSuccess: ({ room: { rid } }) => {\n\t\t\tgoToRoomById(rid);\n\t\t},\n\t\tonError: (error) => {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t},\n\t\tonSettled: () => {\n\t\t\tonClose();\n\t\t},\n\t});\n\n\tconst handleCreate = async ({ users }: { users: IUser['username'][] }) => {\n\t\treturn mutateDirectMessage.mutateAsync({ usernames: users.join(',') });\n\t};\n\n\treturn (\n\t\t<Modal data-qa='create-direct-modal' wrapperFunction={(props) => <Box is='form' onSubmit={handleSubmit(handleCreate)} {...props} />}>\n\t\t\t<Modal.Header>\n\t\t\t\t<Modal.Title>{t('Create_direct_message')}</Modal.Title>\n\t\t\t\t<Modal.Close tabIndex={-1} onClick={onClose} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content mbe={2}>\n\t\t\t\t<FieldGroup>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Box htmlFor={membersFieldId}>{t('Direct_message_creation_description')}</Box>\n\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\tname='users'\n\t\t\t\t\t\t\t\trules={{\n\t\t\t\t\t\t\t\t\trequired: t('Direct_message_creation_error'),\n\t\t\t\t\t\t\t\t\tvalidate: (users) =>\n\t\t\t\t\t\t\t\t\t\tusers.length + 1 > directMaxUsers\n\t\t\t\t\t\t\t\t\t\t\t? t('error-direct-message-max-user-exceeded', { maxUsers: directMaxUsers })\n\t\t\t\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\trender={({ field: { name, onChange, value, onBlur } }) => (\n\t\t\t\t\t\t\t\t\t<UserAutoCompleteMultipleFederated\n\t\t\t\t\t\t\t\t\t\tname={name}\n\t\t\t\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\t\t\t\tonBlur={onBlur}\n\t\t\t\t\t\t\t\t\t\tid={membersFieldId}\n\t\t\t\t\t\t\t\t\t\taria-describedby={`${membersFieldId}-hint ${membersFieldId}-error`}\n\t\t\t\t\t\t\t\t\t\taria-required='true'\n\t\t\t\t\t\t\t\t\t\taria-invalid={Boolean(errors.users)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t{errors.users && (\n\t\t\t\t\t\t\t<FieldError aria-live='assertive' id={`${membersFieldId}-error`}>\n\t\t\t\t\t\t\t\t{errors.users.message}\n\t\t\t\t\t\t\t</FieldError>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<FieldHint id={`${membersFieldId}-hint`}>{t('Direct_message_creation_description_hint')}</FieldHint>\n\t\t\t\t\t</Field>\n\t\t\t\t</FieldGroup>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t<Modal.FooterControllers>\n\t\t\t\t\t<Button onClick={onClose}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button loading={isSubmitting || isValidating} type='submit' primary>\n\t\t\t\t\t\t{t('Create')}\n\t\t\t\t\t</Button>\n\t\t\t\t</Modal.FooterControllers>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default memo(CreateDirectMessage);\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/sidebarv2/header/CreateDirectMessage.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/sidebarv2/header/CreateDirectMessage.tsx","inputSourceMap":{"version":3,"file":"client/sidebarv2/header/CreateDirectMessage.tsx","sourceRoot":"","sources":["client/sidebarv2/header/CreateDirectMessage.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IUser } from '@rocket.chat/core-typings';\nimport { Box, Modal, Button, FieldGroup, Field, FieldRow, FieldError, FieldHint } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation, useEndpoint, useToastMessageDispatch, useSetting } from '@rocket.chat/ui-contexts';\nimport { useMutation } from '@tanstack/react-query';\nimport React, { memo } from 'react';\nimport { useForm, Controller } from 'react-hook-form';\n\nimport UserAutoCompleteMultipleFederated from '../../components/UserAutoCompleteMultiple/UserAutoCompleteMultipleFederated';\nimport { goToRoomById } from '../../lib/utils/goToRoomById';\n\ntype CreateDirectMessageProps = { onClose: () => void };\n\nconst CreateDirectMessage = ({ onClose }: CreateDirectMessageProps) => {\n\tconst t = useTranslation();\n\tconst directMaxUsers = useSetting<number>('DirectMesssage_maxUsers') || 1;\n\tconst membersFieldId = useUniqueId();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst createDirectAction = useEndpoint('POST', '/v1/dm.create');\n\n\tconst {\n\t\tcontrol,\n\t\thandleSubmit,\n\t\tformState: { isSubmitting, isValidating, errors },\n\t} = useForm({ mode: 'onBlur', defaultValues: { users: [] } });\n\n\tconst mutateDirectMessage = useMutation({\n\t\tmutationFn: createDirectAction,\n\t\tonSuccess: ({ room: { rid } }) => {\n\t\t\tgoToRoomById(rid);\n\t\t},\n\t\tonError: (error) => {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t},\n\t\tonSettled: () => {\n\t\t\tonClose();\n\t\t},\n\t});\n\n\tconst handleCreate = async ({ users }: { users: IUser['username'][] }) => {\n\t\treturn mutateDirectMessage.mutateAsync({ usernames: users.join(',') });\n\t};\n\n\treturn (\n\t\t<Modal data-qa='create-direct-modal' wrapperFunction={(props) => <Box is='form' onSubmit={handleSubmit(handleCreate)} {...props} />}>\n\t\t\t<Modal.Header>\n\t\t\t\t<Modal.Title>{t('Create_direct_message')}</Modal.Title>\n\t\t\t\t<Modal.Close tabIndex={-1} onClick={onClose} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content mbe={2}>\n\t\t\t\t<FieldGroup>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Box htmlFor={membersFieldId}>{t('Direct_message_creation_description')}</Box>\n\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\tname='users'\n\t\t\t\t\t\t\t\trules={{\n\t\t\t\t\t\t\t\t\trequired: t('Direct_message_creation_error'),\n\t\t\t\t\t\t\t\t\tvalidate: (users) =>\n\t\t\t\t\t\t\t\t\t\tusers.length + 1 > directMaxUsers\n\t\t\t\t\t\t\t\t\t\t\t? t('error-direct-message-max-user-exceeded', { maxUsers: directMaxUsers })\n\t\t\t\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\trender={({ field: { name, onChange, value, onBlur } }) => (\n\t\t\t\t\t\t\t\t\t<UserAutoCompleteMultipleFederated\n\t\t\t\t\t\t\t\t\t\tname={name}\n\t\t\t\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\t\t\t\tonBlur={onBlur}\n\t\t\t\t\t\t\t\t\t\tid={membersFieldId}\n\t\t\t\t\t\t\t\t\t\taria-describedby={`${membersFieldId}-hint ${membersFieldId}-error`}\n\t\t\t\t\t\t\t\t\t\taria-required='true'\n\t\t\t\t\t\t\t\t\t\taria-invalid={Boolean(errors.users)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t{errors.users && (\n\t\t\t\t\t\t\t<FieldError aria-live='assertive' id={`${membersFieldId}-error`}>\n\t\t\t\t\t\t\t\t{errors.users.message}\n\t\t\t\t\t\t\t</FieldError>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<FieldHint id={`${membersFieldId}-hint`}>{t('Direct_message_creation_description_hint')}</FieldHint>\n\t\t\t\t\t</Field>\n\t\t\t\t</FieldGroup>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t<Modal.FooterControllers>\n\t\t\t\t\t<Button onClick={onClose}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button loading={isSubmitting || isValidating} type='submit' primary>\n\t\t\t\t\t\t{t('Create')}\n\t\t\t\t\t</Button>\n\t\t\t\t</Modal.FooterControllers>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default memo(CreateDirectMessage);\n"]}}},"code":"var _extends;\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default: function (v) {\n    _extends = v;\n  }\n}, 0);\nvar _regeneratorRuntime;\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 1);\nvar Box, Modal, Button, FieldGroup, Field, FieldRow, FieldError, FieldHint;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Box: function (v) {\n    Box = v;\n  },\n  Modal: function (v) {\n    Modal = v;\n  },\n  Button: function (v) {\n    Button = v;\n  },\n  FieldGroup: function (v) {\n    FieldGroup = v;\n  },\n  Field: function (v) {\n    Field = v;\n  },\n  FieldRow: function (v) {\n    FieldRow = v;\n  },\n  FieldError: function (v) {\n    FieldError = v;\n  },\n  FieldHint: function (v) {\n    FieldHint = v;\n  }\n}, 0);\nvar useUniqueId;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useUniqueId: function (v) {\n    useUniqueId = v;\n  }\n}, 1);\nvar useTranslation, useEndpoint, useToastMessageDispatch, useSetting;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useTranslation: function (v) {\n    useTranslation = v;\n  },\n  useEndpoint: function (v) {\n    useEndpoint = v;\n  },\n  useToastMessageDispatch: function (v) {\n    useToastMessageDispatch = v;\n  },\n  useSetting: function (v) {\n    useSetting = v;\n  }\n}, 2);\nvar useMutation;\nmodule.link(\"@tanstack/react-query\", {\n  useMutation: function (v) {\n    useMutation = v;\n  }\n}, 3);\nvar React, memo;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  memo: function (v) {\n    memo = v;\n  }\n}, 4);\nvar useForm, Controller;\nmodule.link(\"react-hook-form\", {\n  useForm: function (v) {\n    useForm = v;\n  },\n  Controller: function (v) {\n    Controller = v;\n  }\n}, 5);\nvar UserAutoCompleteMultipleFederated;\nmodule.link(\"../../components/UserAutoCompleteMultiple/UserAutoCompleteMultipleFederated\", {\n  \"default\": function (v) {\n    UserAutoCompleteMultipleFederated = v;\n  }\n}, 6);\nvar goToRoomById;\nmodule.link(\"../../lib/utils/goToRoomById\", {\n  goToRoomById: function (v) {\n    goToRoomById = v;\n  }\n}, 7);\nvar CreateDirectMessage = function (_ref) {\n  var onClose = _ref.onClose;\n  var t = useTranslation();\n  var directMaxUsers = useSetting('DirectMesssage_maxUsers') || 1;\n  var membersFieldId = useUniqueId();\n  var dispatchToastMessage = useToastMessageDispatch();\n  var createDirectAction = useEndpoint('POST', '/v1/dm.create');\n  var _useForm = useForm({\n      mode: 'onBlur',\n      defaultValues: {\n        users: []\n      }\n    }),\n    control = _useForm.control,\n    handleSubmit = _useForm.handleSubmit,\n    _useForm$formState = _useForm.formState,\n    isSubmitting = _useForm$formState.isSubmitting,\n    isValidating = _useForm$formState.isValidating,\n    errors = _useForm$formState.errors;\n  var mutateDirectMessage = useMutation({\n    mutationFn: createDirectAction,\n    onSuccess: function (_ref2) {\n      var rid = _ref2.room.rid;\n      goToRoomById(rid);\n    },\n    onError: function (error) {\n      dispatchToastMessage({\n        type: 'error',\n        message: error\n      });\n    },\n    onSettled: function () {\n      onClose();\n    }\n  });\n  var handleCreate = function () {\n    function _callee(_ref3) {\n      var users;\n      return _regeneratorRuntime.async(function () {\n        function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              users = _ref3.users;\n              return _context.abrupt(\"return\", mutateDirectMessage.mutateAsync({\n                usernames: users.join(',')\n              }));\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n        return _callee$;\n      }(), null, null, null, Promise);\n    }\n    return _callee;\n  }();\n  return /*#__PURE__*/React.createElement(Modal, {\n    \"data-qa\": \"create-direct-modal\",\n    wrapperFunction: function (props) {\n      return /*#__PURE__*/React.createElement(Box, _extends({\n        is: \"form\",\n        onSubmit: handleSubmit(handleCreate)\n      }, props));\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Header, null, /*#__PURE__*/React.createElement(Modal.Title, null, t('Create_direct_message')), /*#__PURE__*/React.createElement(Modal.Close, {\n    tabIndex: -1,\n    onClick: onClose\n  })), /*#__PURE__*/React.createElement(Modal.Content, {\n    mbe: 2\n  }, /*#__PURE__*/React.createElement(FieldGroup, null, /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Box, {\n    htmlFor: membersFieldId\n  }, t('Direct_message_creation_description')), /*#__PURE__*/React.createElement(FieldRow, null, /*#__PURE__*/React.createElement(Controller, {\n    name: \"users\",\n    rules: {\n      required: t('Direct_message_creation_error'),\n      validate: function (users) {\n        return users.length + 1 > directMaxUsers ? t('error-direct-message-max-user-exceeded', {\n          maxUsers: directMaxUsers\n        }) : undefined;\n      }\n    },\n    control: control,\n    render: function (_ref4) {\n      var _ref4$field = _ref4.field,\n        name = _ref4$field.name,\n        onChange = _ref4$field.onChange,\n        value = _ref4$field.value,\n        onBlur = _ref4$field.onBlur;\n      return /*#__PURE__*/React.createElement(UserAutoCompleteMultipleFederated, {\n        name: name,\n        onChange: onChange,\n        value: value,\n        onBlur: onBlur,\n        id: membersFieldId,\n        \"aria-describedby\": membersFieldId + \"-hint \" + membersFieldId + \"-error\",\n        \"aria-required\": \"true\",\n        \"aria-invalid\": Boolean(errors.users)\n      });\n    }\n  })), errors.users && /*#__PURE__*/React.createElement(FieldError, {\n    \"aria-live\": \"assertive\",\n    id: membersFieldId + \"-error\"\n  }, errors.users.message), /*#__PURE__*/React.createElement(FieldHint, {\n    id: membersFieldId + \"-hint\"\n  }, t('Direct_message_creation_description_hint'))))), /*#__PURE__*/React.createElement(Modal.Footer, null, /*#__PURE__*/React.createElement(Modal.FooterControllers, null, /*#__PURE__*/React.createElement(Button, {\n    onClick: onClose\n  }, t('Cancel')), /*#__PURE__*/React.createElement(Button, {\n    loading: isSubmitting || isValidating,\n    type: \"submit\",\n    primary: true\n  }, t('Create')))));\n};\nmodule.exportDefault( /*#__PURE__*/memo(CreateDirectMessage));","map":{"version":3,"names":["_extends","module","link","default","v","_regeneratorRuntime","Box","Modal","Button","FieldGroup","Field","FieldRow","FieldError","FieldHint","useUniqueId","useTranslation","useEndpoint","useToastMessageDispatch","useSetting","useMutation","React","memo","useForm","Controller","UserAutoCompleteMultipleFederated","goToRoomById","CreateDirectMessage","_ref","onClose","t","directMaxUsers","membersFieldId","dispatchToastMessage","createDirectAction","_useForm","mode","defaultValues","users","control","handleSubmit","_useForm$formState","formState","isSubmitting","isValidating","errors","mutateDirectMessage","mutationFn","onSuccess","_ref2","rid","room","onError","error","type","message","onSettled","handleCreate","_callee","_ref3","async","_callee$","_context","prev","next","abrupt","mutateAsync","usernames","join","stop","Promise","createElement","wrapperFunction","props","is","onSubmit","Header","Title","Close","tabIndex","onClick","Content","mbe","htmlFor","name","rules","required","validate","length","maxUsers","undefined","render","_ref4","_ref4$field","field","onChange","value","onBlur","id","Boolean","Footer","FooterControllers","loading","primary","exportDefault"],"sources":["client/sidebarv2/header/CreateDirectMessage.tsx"],"sourcesContent":["import type { IUser } from '@rocket.chat/core-typings';\nimport { Box, Modal, Button, FieldGroup, Field, FieldRow, FieldError, FieldHint } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation, useEndpoint, useToastMessageDispatch, useSetting } from '@rocket.chat/ui-contexts';\nimport { useMutation } from '@tanstack/react-query';\nimport React, { memo } from 'react';\nimport { useForm, Controller } from 'react-hook-form';\n\nimport UserAutoCompleteMultipleFederated from '../../components/UserAutoCompleteMultiple/UserAutoCompleteMultipleFederated';\nimport { goToRoomById } from '../../lib/utils/goToRoomById';\n\ntype CreateDirectMessageProps = { onClose: () => void };\n\nconst CreateDirectMessage = ({ onClose }: CreateDirectMessageProps) => {\n\tconst t = useTranslation();\n\tconst directMaxUsers = useSetting<number>('DirectMesssage_maxUsers') || 1;\n\tconst membersFieldId = useUniqueId();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst createDirectAction = useEndpoint('POST', '/v1/dm.create');\n\n\tconst {\n\t\tcontrol,\n\t\thandleSubmit,\n\t\tformState: { isSubmitting, isValidating, errors },\n\t} = useForm({ mode: 'onBlur', defaultValues: { users: [] } });\n\n\tconst mutateDirectMessage = useMutation({\n\t\tmutationFn: createDirectAction,\n\t\tonSuccess: ({ room: { rid } }) => {\n\t\t\tgoToRoomById(rid);\n\t\t},\n\t\tonError: (error) => {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t},\n\t\tonSettled: () => {\n\t\t\tonClose();\n\t\t},\n\t});\n\n\tconst handleCreate = async ({ users }: { users: IUser['username'][] }) => {\n\t\treturn mutateDirectMessage.mutateAsync({ usernames: users.join(',') });\n\t};\n\n\treturn (\n\t\t<Modal data-qa='create-direct-modal' wrapperFunction={(props) => <Box is='form' onSubmit={handleSubmit(handleCreate)} {...props} />}>\n\t\t\t<Modal.Header>\n\t\t\t\t<Modal.Title>{t('Create_direct_message')}</Modal.Title>\n\t\t\t\t<Modal.Close tabIndex={-1} onClick={onClose} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content mbe={2}>\n\t\t\t\t<FieldGroup>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<Box htmlFor={membersFieldId}>{t('Direct_message_creation_description')}</Box>\n\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\tname='users'\n\t\t\t\t\t\t\t\trules={{\n\t\t\t\t\t\t\t\t\trequired: t('Direct_message_creation_error'),\n\t\t\t\t\t\t\t\t\tvalidate: (users) =>\n\t\t\t\t\t\t\t\t\t\tusers.length + 1 > directMaxUsers\n\t\t\t\t\t\t\t\t\t\t\t? t('error-direct-message-max-user-exceeded', { maxUsers: directMaxUsers })\n\t\t\t\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\trender={({ field: { name, onChange, value, onBlur } }) => (\n\t\t\t\t\t\t\t\t\t<UserAutoCompleteMultipleFederated\n\t\t\t\t\t\t\t\t\t\tname={name}\n\t\t\t\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\t\t\t\tonBlur={onBlur}\n\t\t\t\t\t\t\t\t\t\tid={membersFieldId}\n\t\t\t\t\t\t\t\t\t\taria-describedby={`${membersFieldId}-hint ${membersFieldId}-error`}\n\t\t\t\t\t\t\t\t\t\taria-required='true'\n\t\t\t\t\t\t\t\t\t\taria-invalid={Boolean(errors.users)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t{errors.users && (\n\t\t\t\t\t\t\t<FieldError aria-live='assertive' id={`${membersFieldId}-error`}>\n\t\t\t\t\t\t\t\t{errors.users.message}\n\t\t\t\t\t\t\t</FieldError>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<FieldHint id={`${membersFieldId}-hint`}>{t('Direct_message_creation_description_hint')}</FieldHint>\n\t\t\t\t\t</Field>\n\t\t\t\t</FieldGroup>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t<Modal.FooterControllers>\n\t\t\t\t\t<Button onClick={onClose}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button loading={isSubmitting || isValidating} type='submit' primary>\n\t\t\t\t\t\t{t('Create')}\n\t\t\t\t\t</Button>\n\t\t\t\t</Modal.FooterControllers>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default memo(CreateDirectMessage);\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"3ade5aaf04a1b6f6c2694f37ed454a59f03d9ba6"}
