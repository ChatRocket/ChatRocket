{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/marketplace/hooks/useAppMenu.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/marketplace/hooks/useAppMenu.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/marketplace/hooks/useAppMenu.tsx","inputSourceMap":{"version":3,"file":"client/views/marketplace/hooks/useAppMenu.tsx","sourceRoot":"","sources":["client/views/marketplace/hooks/useAppMenu.tsx"],"names":[],"mappings":"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","sourcesContent":["import { AppStatus } from '@rocket.chat/apps-engine/definition/AppStatus';\nimport type { App } from '@rocket.chat/core-typings';\nimport { Box, Icon } from '@rocket.chat/fuselage';\nimport {\n\tuseSetModal,\n\tuseEndpoint,\n\tuseTranslation,\n\tuseRouteParameter,\n\tuseToastMessageDispatch,\n\tusePermission,\n\tuseRouter,\n} from '@rocket.chat/ui-contexts';\nimport type { MouseEvent, ReactNode } from 'react';\nimport React, { useMemo, useCallback, useState } from 'react';\nimport semver from 'semver';\n\nimport { useAppInstallationHandler } from './useAppInstallationHandler';\nimport type { MarketplaceRouteContext } from './useAppsCountQuery';\nimport { useAppsCountQuery } from './useAppsCountQuery';\nimport { useMarketplaceActions } from './useMarketplaceActions';\nimport { useOpenAppPermissionsReviewModal } from './useOpenAppPermissionsReviewModal';\nimport { useOpenIncompatibleModal } from './useOpenIncompatibleModal';\nimport WarningModal from '../../../components/WarningModal';\nimport { useHasLicenseModule } from '../../../hooks/useHasLicenseModule';\nimport { useIsEnterprise } from '../../../hooks/useIsEnterprise';\nimport type { AddonActionType } from '../AppsList/AddonRequiredModal';\nimport AddonRequiredModal from '../AppsList/AddonRequiredModal';\nimport IframeModal from '../IframeModal';\nimport UninstallGrandfatheredAppModal from '../components/UninstallGrandfatheredAppModal/UninstallGrandfatheredAppModal';\nimport type { Actions } from '../helpers';\nimport { appEnabledStatuses, appButtonProps } from '../helpers';\nimport { handleAPIError } from '../helpers/handleAPIError';\nimport { warnEnableDisableApp } from '../helpers/warnEnableDisableApp';\n\nexport type AppMenuOption = {\n\tid: string;\n\tsection: number;\n\tcontent: ReactNode;\n\tdisabled?: boolean;\n\tonClick?: (e?: MouseEvent<HTMLElement>) => void;\n};\n\ntype AppMenuSections = {\n\titems: AppMenuOption[];\n}[];\n\nexport const useAppMenu = (app: App, isAppDetailsPage: boolean) => {\n\tconst t = useTranslation();\n\tconst router = useRouter();\n\tconst setModal = useSetModal();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst openIncompatibleModal = useOpenIncompatibleModal();\n\n\tconst context = useRouteParameter('context') as MarketplaceRouteContext;\n\tconst currentTab = useRouteParameter('tab');\n\tconst appCountQuery = useAppsCountQuery(context);\n\n\tconst isAdminUser = usePermission('manage-apps');\n\tconst { data } = useIsEnterprise();\n\tconst isEnterpriseLicense = !!data?.isEnterprise;\n\n\tconst workspaceHasMarketplaceAddon = useHasLicenseModule(app.addon);\n\tconst workspaceHasInstalledAddon = useHasLicenseModule(app.installedAddon);\n\n\tconst [isLoading, setLoading] = useState(false);\n\tconst [requestedEndUser, setRequestedEndUser] = useState(app.requestedEndUser);\n\tconst [isAppPurchased, setPurchased] = useState(app?.isPurchased);\n\n\tconst button = appButtonProps({ ...app, isAdminUser, endUserRequested: false });\n\tconst buttonLabel = button?.label.replace(' ', '_') as\n\t\t| 'Update'\n\t\t| 'Install'\n\t\t| 'Subscribe'\n\t\t| 'See_Pricing'\n\t\t| 'Try_now'\n\t\t| 'Buy'\n\t\t| 'Request'\n\t\t| 'Requested';\n\tconst action = button?.action || '';\n\n\tconst setAppStatus = useEndpoint<'POST', '/apps/:id/status'>('POST', '/apps/:id/status', { id: app.id });\n\tconst buildExternalUrl = useEndpoint('GET', '/apps');\n\tconst syncApp = useEndpoint<'POST', '/apps/:id/sync'>('POST', '/apps/:id/sync', { id: app.id });\n\tconst uninstallApp = useEndpoint<'DELETE', '/apps/:id'>('DELETE', '/apps/:id', { id: app.id });\n\n\tconst canAppBeSubscribed = app.purchaseType === 'subscription';\n\tconst isSubscribed = app.subscriptionInfo && ['active', 'trialing'].includes(app.subscriptionInfo.status);\n\tconst isAppEnabled = app.status ? appEnabledStatuses.includes(app.status) : false;\n\n\tconst closeModal = useCallback(() => {\n\t\tsetModal(null);\n\t\tsetLoading(false);\n\t}, [setModal, setLoading]);\n\n\tconst marketplaceActions = useMarketplaceActions();\n\n\tconst installationSuccess = useCallback(\n\t\tasync (action: Actions | '', permissionsGranted) => {\n\t\t\tif (action) {\n\t\t\t\tif (action === 'request') {\n\t\t\t\t\tsetRequestedEndUser(true);\n\t\t\t\t} else {\n\t\t\t\t\tawait marketplaceActions[action]({ ...app, permissionsGranted });\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetLoading(false);\n\t\t},\n\t\t[app, marketplaceActions, setLoading],\n\t);\n\n\tconst openPermissionModal = useOpenAppPermissionsReviewModal({\n\t\tapp,\n\t\tonCancel: closeModal,\n\t\tonConfirm: (permissionsGranted) => installationSuccess(action, permissionsGranted),\n\t});\n\n\tconst appInstallationHandler = useAppInstallationHandler({\n\t\tapp,\n\t\tisAppPurchased,\n\t\taction,\n\t\tonDismiss: closeModal,\n\t\tonSuccess: installationSuccess,\n\t\tsetIsPurchased: setPurchased,\n\t});\n\n\t// TODO: There is no necessity of all these callbacks being out of the above useMemo.\n\t// My propose here is to refactor the hook to make it clearer and with less unnecessary caching.\n\tconst missingAddonHandler = useCallback(\n\t\t(actionType: AddonActionType) => {\n\t\t\tsetModal(<AddonRequiredModal actionType={actionType} onDismiss={closeModal} onInstallAnyway={appInstallationHandler} />);\n\t\t},\n\t\t[appInstallationHandler, closeModal, setModal],\n\t);\n\n\tconst handleAddon = useCallback(\n\t\t(actionType: AddonActionType, callback: () => void) => {\n\t\t\tif (actionType === 'enable' && isAdminUser && app.installedAddon && !workspaceHasInstalledAddon) {\n\t\t\t\treturn missingAddonHandler(actionType);\n\t\t\t}\n\n\t\t\tif (actionType !== 'enable' && isAdminUser && app.addon && !workspaceHasMarketplaceAddon) {\n\t\t\t\treturn missingAddonHandler(actionType);\n\t\t\t}\n\n\t\t\tcallback();\n\t\t},\n\t\t[app.addon, app.installedAddon, isAdminUser, missingAddonHandler, workspaceHasInstalledAddon, workspaceHasMarketplaceAddon],\n\t);\n\n\tconst handleAcquireApp = useCallback(() => {\n\t\tsetLoading(true);\n\t\thandleAddon('install', appInstallationHandler);\n\t}, [appInstallationHandler, handleAddon]);\n\n\tconst handleSubscription = useCallback(async () => {\n\t\tif (app?.versionIncompatible && !isSubscribed) {\n\t\t\topenIncompatibleModal(app, 'subscribe', closeModal);\n\t\t\treturn;\n\t\t}\n\n\t\tlet data;\n\t\ttry {\n\t\t\tdata = (await buildExternalUrl({\n\t\t\t\tbuildExternalUrl: 'true',\n\t\t\t\tappId: app.id,\n\t\t\t\tpurchaseType: app.purchaseType,\n\t\t\t\tdetails: 'true',\n\t\t\t})) as { url: string };\n\t\t} catch (error) {\n\t\t\thandleAPIError(error);\n\t\t\treturn;\n\t\t}\n\n\t\tconst confirm = async () => {\n\t\t\ttry {\n\t\t\t\tawait syncApp();\n\t\t\t} catch (error) {\n\t\t\t\thandleAPIError(error);\n\t\t\t}\n\t\t};\n\n\t\tsetModal(<IframeModal url={data.url} confirm={confirm} cancel={closeModal} />);\n\t}, [app, isSubscribed, setModal, closeModal, openIncompatibleModal, buildExternalUrl, syncApp]);\n\n\tconst handleViewLogs = useCallback(() => {\n\t\trouter.navigate({\n\t\t\tname: 'marketplace',\n\t\t\tparams: {\n\t\t\t\tcontext,\n\t\t\t\tpage: 'info',\n\t\t\t\tid: app.id,\n\t\t\t\tversion: app.version,\n\t\t\t\ttab: 'logs',\n\t\t\t},\n\t\t});\n\t}, [app.id, app.version, context, router]);\n\n\tconst handleDisable = useCallback(() => {\n\t\tconst confirm = async () => {\n\t\t\tcloseModal();\n\t\t\ttry {\n\t\t\t\tconst { status } = await setAppStatus({ status: AppStatus.MANUALLY_DISABLED });\n\t\t\t\twarnEnableDisableApp(app.name, status, 'disable');\n\t\t\t} catch (error) {\n\t\t\t\thandleAPIError(error);\n\t\t\t}\n\t\t};\n\t\tsetModal(\n\t\t\t<WarningModal close={closeModal} confirm={confirm} text={t('Apps_Marketplace_Deactivate_App_Prompt')} confirmText={t('Yes')} />,\n\t\t);\n\t}, [app.name, closeModal, setAppStatus, setModal, t]);\n\n\tconst handleEnable = useCallback(() => {\n\t\thandleAddon('enable', async () => {\n\t\t\ttry {\n\t\t\t\tconst { status } = await setAppStatus({ status: AppStatus.MANUALLY_ENABLED });\n\t\t\t\twarnEnableDisableApp(app.name, status, 'enable');\n\t\t\t} catch (error) {\n\t\t\t\thandleAPIError(error);\n\t\t\t}\n\t\t});\n\t}, [app.name, handleAddon, setAppStatus]);\n\n\tconst handleUninstall = useCallback(() => {\n\t\tconst uninstall = async () => {\n\t\t\tcloseModal();\n\t\t\ttry {\n\t\t\t\tconst { success } = await uninstallApp();\n\t\t\t\tif (success) {\n\t\t\t\t\tdispatchToastMessage({ type: 'success', message: `${app.name} uninstalled` });\n\t\t\t\t\tif (context === 'details' && currentTab !== 'details') {\n\t\t\t\t\t\trouter.navigate(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: 'marketplace',\n\t\t\t\t\t\t\t\tparams: { ...router.getRouteParameters(), tab: 'details' },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ replace: true },\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\thandleAPIError(error);\n\t\t\t}\n\t\t};\n\n\t\tif (isSubscribed) {\n\t\t\tconst confirm = async () => {\n\t\t\t\tawait handleSubscription();\n\t\t\t};\n\n\t\t\tsetModal(\n\t\t\t\t<WarningModal\n\t\t\t\t\tclose={closeModal}\n\t\t\t\t\tcancel={uninstall}\n\t\t\t\t\tconfirm={confirm}\n\t\t\t\t\ttext={t('Apps_Marketplace_Uninstall_Subscribed_App_Prompt')}\n\t\t\t\t\tconfirmText={t('Apps_Marketplace_Modify_App_Subscription')}\n\t\t\t\t\tcancelText={t('Apps_Marketplace_Uninstall_Subscribed_App_Anyway')}\n\t\t\t\t/>,\n\t\t\t);\n\t\t}\n\n\t\tif (!appCountQuery.data) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (app.migrated) {\n\t\t\tsetModal(\n\t\t\t\t<UninstallGrandfatheredAppModal\n\t\t\t\t\tcontext={context}\n\t\t\t\t\tappName={app.name}\n\t\t\t\t\tlimit={appCountQuery.data.limit}\n\t\t\t\t\thandleUninstall={uninstall}\n\t\t\t\t\thandleClose={closeModal}\n\t\t\t\t/>,\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tsetModal(\n\t\t\t<WarningModal close={closeModal} confirm={uninstall} text={t('Apps_Marketplace_Uninstall_App_Prompt')} confirmText={t('Yes')} />,\n\t\t);\n\t}, [\n\t\tisSubscribed,\n\t\tappCountQuery.data,\n\t\tapp.migrated,\n\t\tapp.name,\n\t\tsetModal,\n\t\tcloseModal,\n\t\tt,\n\t\tuninstallApp,\n\t\tdispatchToastMessage,\n\t\tcontext,\n\t\tcurrentTab,\n\t\trouter,\n\t\thandleSubscription,\n\t]);\n\n\tconst incompatibleIconName = useCallback(\n\t\t(app, action) => {\n\t\t\tif (!app.versionIncompatible) {\n\t\t\t\tif (action === 'update') {\n\t\t\t\t\treturn 'refresh';\n\t\t\t\t}\n\n\t\t\t\treturn 'card';\n\t\t\t}\n\n\t\t\t// Now we are handling an incompatible app\n\t\t\tif (action === 'subscribe' && !isSubscribed) {\n\t\t\t\treturn 'warning';\n\t\t\t}\n\n\t\t\tif (action === 'install' || action === 'update') {\n\t\t\t\treturn 'warning';\n\t\t\t}\n\n\t\t\treturn 'card';\n\t\t},\n\t\t[isSubscribed],\n\t);\n\n\tconst handleUpdate = useCallback(async () => {\n\t\tsetLoading(true);\n\n\t\tif (app?.versionIncompatible) {\n\t\t\topenIncompatibleModal(app, 'update', closeModal);\n\t\t\treturn;\n\t\t}\n\n\t\thandleAddon('update', openPermissionModal);\n\t}, [app, handleAddon, openPermissionModal, openIncompatibleModal, closeModal]);\n\n\tconst canUpdate = app.installed && app.version && app.marketplaceVersion && semver.lt(app.version, app.marketplaceVersion);\n\n\tconst menuSections = useMemo(() => {\n\t\tconst bothAppStatusOptions = [\n\t\t\tcanAppBeSubscribed &&\n\t\t\t\tisSubscribed &&\n\t\t\t\tisAdminUser && {\n\t\t\t\t\tid: 'subscribe',\n\t\t\t\t\tsection: 0,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Icon name={incompatibleIconName(app, 'subscribe')} size='x16' mie={4} />\n\t\t\t\t\t\t\t{t('Subscription')}\n\t\t\t\t\t\t</>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleSubscription,\n\t\t\t\t},\n\t\t];\n\n\t\tconst nonInstalledAppOptions = [\n\t\t\t!app.installed &&\n\t\t\t\t!!button && {\n\t\t\t\t\tid: 'acquire',\n\t\t\t\t\tsection: 0,\n\t\t\t\t\tdisabled: requestedEndUser,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t{isAdminUser && <Icon name={incompatibleIconName(app, 'install')} size='x16' mie={4} />}\n\t\t\t\t\t\t\t{t(buttonLabel)}\n\t\t\t\t\t\t</>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleAcquireApp,\n\t\t\t\t},\n\t\t];\n\n\t\tconst isEnterpriseOrNot = (app.isEnterpriseOnly && isEnterpriseLicense) || !app.isEnterpriseOnly;\n\t\tconst isPossibleToEnableApp = app.installed && isAdminUser && !isAppEnabled && isEnterpriseOrNot;\n\t\tconst doesItReachedTheLimit =\n\t\t\t!app.migrated &&\n\t\t\t!appCountQuery?.data?.hasUnlimitedApps &&\n\t\t\tappCountQuery?.data?.enabled !== undefined &&\n\t\t\tappCountQuery?.data?.enabled >= appCountQuery?.data?.limit;\n\n\t\tconst installedAppOptions = [\n\t\t\tcontext !== 'details' &&\n\t\t\t\tisAdminUser &&\n\t\t\t\tapp.installed && {\n\t\t\t\t\tid: 'viewLogs',\n\t\t\t\t\tsection: 0,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Icon name='desktop-text' size='x16' mie={4} />\n\t\t\t\t\t\t\t{t('View_Logs')}\n\t\t\t\t\t\t</>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleViewLogs,\n\t\t\t\t},\n\t\t\tisAdminUser &&\n\t\t\t\t!!canUpdate &&\n\t\t\t\t!isAppDetailsPage && {\n\t\t\t\t\tid: 'update',\n\t\t\t\t\tsection: 0,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Icon name={incompatibleIconName(app, 'update')} size='x16' mie={4} />\n\t\t\t\t\t\t\t{t('Update')}\n\t\t\t\t\t\t</>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleUpdate,\n\t\t\t\t},\n\t\t\tapp.installed &&\n\t\t\t\tisAdminUser &&\n\t\t\t\tisAppEnabled && {\n\t\t\t\t\tid: 'disable',\n\t\t\t\t\tsection: 0,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<Box color='status-font-on-warning'>\n\t\t\t\t\t\t\t<Icon name='ban' size='x16' mie={4} />\n\t\t\t\t\t\t\t{t('Disable')}\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleDisable,\n\t\t\t\t},\n\t\t\tisPossibleToEnableApp && {\n\t\t\t\tid: 'enable',\n\t\t\t\tsection: 0,\n\t\t\t\tdisabled: doesItReachedTheLimit,\n\t\t\t\tcontent: (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Icon name='check' size='x16' marginInlineEnd='x4' />\n\t\t\t\t\t\t{t('Enable')}\n\t\t\t\t\t</>\n\t\t\t\t),\n\t\t\t\tonClick: handleEnable,\n\t\t\t},\n\t\t\tapp.installed &&\n\t\t\t\tisAdminUser && {\n\t\t\t\t\tid: 'uninstall',\n\t\t\t\t\tsection: 1,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<Box color='status-font-on-danger'>\n\t\t\t\t\t\t\t<Icon name='trash' size='x16' mie={4} />\n\t\t\t\t\t\t\t{t('Uninstall')}\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleUninstall,\n\t\t\t\t},\n\t\t];\n\n\t\tconst filtered = [...bothAppStatusOptions, ...nonInstalledAppOptions, ...installedAppOptions].flatMap((value) =>\n\t\t\tvalue && typeof value !== 'boolean' ? value : [],\n\t\t);\n\n\t\tconst sections: AppMenuSections = [];\n\n\t\tfiltered.forEach((option) => {\n\t\t\tif (typeof sections[option.section] === 'undefined') {\n\t\t\t\tsections[option.section] = { items: [] };\n\t\t\t}\n\n\t\t\tsections[option.section].items.push(option);\n\t\t});\n\n\t\treturn sections;\n\t}, [\n\t\tcanAppBeSubscribed,\n\t\tisSubscribed,\n\t\tisAdminUser,\n\t\tincompatibleIconName,\n\t\tapp,\n\t\tt,\n\t\thandleSubscription,\n\t\tbutton,\n\t\trequestedEndUser,\n\t\tbuttonLabel,\n\t\thandleAcquireApp,\n\t\tisEnterpriseLicense,\n\t\tisAppEnabled,\n\t\tappCountQuery?.data?.hasUnlimitedApps,\n\t\tappCountQuery?.data?.enabled,\n\t\tappCountQuery?.data?.limit,\n\t\tcontext,\n\t\thandleViewLogs,\n\t\tcanUpdate,\n\t\tisAppDetailsPage,\n\t\thandleUpdate,\n\t\thandleDisable,\n\t\thandleEnable,\n\t\thandleUninstall,\n\t]);\n\n\treturn { isLoading, isAdminUser, sections: menuSections };\n};\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/marketplace/hooks/useAppMenu.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/marketplace/hooks/useAppMenu.tsx","inputSourceMap":{"version":3,"file":"client/views/marketplace/hooks/useAppMenu.tsx","sourceRoot":"","sources":["client/views/marketplace/hooks/useAppMenu.tsx"],"names":[],"mappings":"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","sourcesContent":["import { AppStatus } from '@rocket.chat/apps-engine/definition/AppStatus';\nimport type { App } from '@rocket.chat/core-typings';\nimport { Box, Icon } from '@rocket.chat/fuselage';\nimport {\n\tuseSetModal,\n\tuseEndpoint,\n\tuseTranslation,\n\tuseRouteParameter,\n\tuseToastMessageDispatch,\n\tusePermission,\n\tuseRouter,\n} from '@rocket.chat/ui-contexts';\nimport type { MouseEvent, ReactNode } from 'react';\nimport React, { useMemo, useCallback, useState } from 'react';\nimport semver from 'semver';\n\nimport { useAppInstallationHandler } from './useAppInstallationHandler';\nimport type { MarketplaceRouteContext } from './useAppsCountQuery';\nimport { useAppsCountQuery } from './useAppsCountQuery';\nimport { useMarketplaceActions } from './useMarketplaceActions';\nimport { useOpenAppPermissionsReviewModal } from './useOpenAppPermissionsReviewModal';\nimport { useOpenIncompatibleModal } from './useOpenIncompatibleModal';\nimport WarningModal from '../../../components/WarningModal';\nimport { useHasLicenseModule } from '../../../hooks/useHasLicenseModule';\nimport { useIsEnterprise } from '../../../hooks/useIsEnterprise';\nimport type { AddonActionType } from '../AppsList/AddonRequiredModal';\nimport AddonRequiredModal from '../AppsList/AddonRequiredModal';\nimport IframeModal from '../IframeModal';\nimport UninstallGrandfatheredAppModal from '../components/UninstallGrandfatheredAppModal/UninstallGrandfatheredAppModal';\nimport type { Actions } from '../helpers';\nimport { appEnabledStatuses, appButtonProps } from '../helpers';\nimport { handleAPIError } from '../helpers/handleAPIError';\nimport { warnEnableDisableApp } from '../helpers/warnEnableDisableApp';\n\nexport type AppMenuOption = {\n\tid: string;\n\tsection: number;\n\tcontent: ReactNode;\n\tdisabled?: boolean;\n\tonClick?: (e?: MouseEvent<HTMLElement>) => void;\n};\n\ntype AppMenuSections = {\n\titems: AppMenuOption[];\n}[];\n\nexport const useAppMenu = (app: App, isAppDetailsPage: boolean) => {\n\tconst t = useTranslation();\n\tconst router = useRouter();\n\tconst setModal = useSetModal();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst openIncompatibleModal = useOpenIncompatibleModal();\n\n\tconst context = useRouteParameter('context') as MarketplaceRouteContext;\n\tconst currentTab = useRouteParameter('tab');\n\tconst appCountQuery = useAppsCountQuery(context);\n\n\tconst isAdminUser = usePermission('manage-apps');\n\tconst { data } = useIsEnterprise();\n\tconst isEnterpriseLicense = !!data?.isEnterprise;\n\n\tconst workspaceHasMarketplaceAddon = useHasLicenseModule(app.addon);\n\tconst workspaceHasInstalledAddon = useHasLicenseModule(app.installedAddon);\n\n\tconst [isLoading, setLoading] = useState(false);\n\tconst [requestedEndUser, setRequestedEndUser] = useState(app.requestedEndUser);\n\tconst [isAppPurchased, setPurchased] = useState(app?.isPurchased);\n\n\tconst button = appButtonProps({ ...app, isAdminUser, endUserRequested: false });\n\tconst buttonLabel = button?.label.replace(' ', '_') as\n\t\t| 'Update'\n\t\t| 'Install'\n\t\t| 'Subscribe'\n\t\t| 'See_Pricing'\n\t\t| 'Try_now'\n\t\t| 'Buy'\n\t\t| 'Request'\n\t\t| 'Requested';\n\tconst action = button?.action || '';\n\n\tconst setAppStatus = useEndpoint<'POST', '/apps/:id/status'>('POST', '/apps/:id/status', { id: app.id });\n\tconst buildExternalUrl = useEndpoint('GET', '/apps');\n\tconst syncApp = useEndpoint<'POST', '/apps/:id/sync'>('POST', '/apps/:id/sync', { id: app.id });\n\tconst uninstallApp = useEndpoint<'DELETE', '/apps/:id'>('DELETE', '/apps/:id', { id: app.id });\n\n\tconst canAppBeSubscribed = app.purchaseType === 'subscription';\n\tconst isSubscribed = app.subscriptionInfo && ['active', 'trialing'].includes(app.subscriptionInfo.status);\n\tconst isAppEnabled = app.status ? appEnabledStatuses.includes(app.status) : false;\n\n\tconst closeModal = useCallback(() => {\n\t\tsetModal(null);\n\t\tsetLoading(false);\n\t}, [setModal, setLoading]);\n\n\tconst marketplaceActions = useMarketplaceActions();\n\n\tconst installationSuccess = useCallback(\n\t\tasync (action: Actions | '', permissionsGranted) => {\n\t\t\tif (action) {\n\t\t\t\tif (action === 'request') {\n\t\t\t\t\tsetRequestedEndUser(true);\n\t\t\t\t} else {\n\t\t\t\t\tawait marketplaceActions[action]({ ...app, permissionsGranted });\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetLoading(false);\n\t\t},\n\t\t[app, marketplaceActions, setLoading],\n\t);\n\n\tconst openPermissionModal = useOpenAppPermissionsReviewModal({\n\t\tapp,\n\t\tonCancel: closeModal,\n\t\tonConfirm: (permissionsGranted) => installationSuccess(action, permissionsGranted),\n\t});\n\n\tconst appInstallationHandler = useAppInstallationHandler({\n\t\tapp,\n\t\tisAppPurchased,\n\t\taction,\n\t\tonDismiss: closeModal,\n\t\tonSuccess: installationSuccess,\n\t\tsetIsPurchased: setPurchased,\n\t});\n\n\t// TODO: There is no necessity of all these callbacks being out of the above useMemo.\n\t// My propose here is to refactor the hook to make it clearer and with less unnecessary caching.\n\tconst missingAddonHandler = useCallback(\n\t\t(actionType: AddonActionType) => {\n\t\t\tsetModal(<AddonRequiredModal actionType={actionType} onDismiss={closeModal} onInstallAnyway={appInstallationHandler} />);\n\t\t},\n\t\t[appInstallationHandler, closeModal, setModal],\n\t);\n\n\tconst handleAddon = useCallback(\n\t\t(actionType: AddonActionType, callback: () => void) => {\n\t\t\tif (actionType === 'enable' && isAdminUser && app.installedAddon && !workspaceHasInstalledAddon) {\n\t\t\t\treturn missingAddonHandler(actionType);\n\t\t\t}\n\n\t\t\tif (actionType !== 'enable' && isAdminUser && app.addon && !workspaceHasMarketplaceAddon) {\n\t\t\t\treturn missingAddonHandler(actionType);\n\t\t\t}\n\n\t\t\tcallback();\n\t\t},\n\t\t[app.addon, app.installedAddon, isAdminUser, missingAddonHandler, workspaceHasInstalledAddon, workspaceHasMarketplaceAddon],\n\t);\n\n\tconst handleAcquireApp = useCallback(() => {\n\t\tsetLoading(true);\n\t\thandleAddon('install', appInstallationHandler);\n\t}, [appInstallationHandler, handleAddon]);\n\n\tconst handleSubscription = useCallback(async () => {\n\t\tif (app?.versionIncompatible && !isSubscribed) {\n\t\t\topenIncompatibleModal(app, 'subscribe', closeModal);\n\t\t\treturn;\n\t\t}\n\n\t\tlet data;\n\t\ttry {\n\t\t\tdata = (await buildExternalUrl({\n\t\t\t\tbuildExternalUrl: 'true',\n\t\t\t\tappId: app.id,\n\t\t\t\tpurchaseType: app.purchaseType,\n\t\t\t\tdetails: 'true',\n\t\t\t})) as { url: string };\n\t\t} catch (error) {\n\t\t\thandleAPIError(error);\n\t\t\treturn;\n\t\t}\n\n\t\tconst confirm = async () => {\n\t\t\ttry {\n\t\t\t\tawait syncApp();\n\t\t\t} catch (error) {\n\t\t\t\thandleAPIError(error);\n\t\t\t}\n\t\t};\n\n\t\tsetModal(<IframeModal url={data.url} confirm={confirm} cancel={closeModal} />);\n\t}, [app, isSubscribed, setModal, closeModal, openIncompatibleModal, buildExternalUrl, syncApp]);\n\n\tconst handleViewLogs = useCallback(() => {\n\t\trouter.navigate({\n\t\t\tname: 'marketplace',\n\t\t\tparams: {\n\t\t\t\tcontext,\n\t\t\t\tpage: 'info',\n\t\t\t\tid: app.id,\n\t\t\t\tversion: app.version,\n\t\t\t\ttab: 'logs',\n\t\t\t},\n\t\t});\n\t}, [app.id, app.version, context, router]);\n\n\tconst handleDisable = useCallback(() => {\n\t\tconst confirm = async () => {\n\t\t\tcloseModal();\n\t\t\ttry {\n\t\t\t\tconst { status } = await setAppStatus({ status: AppStatus.MANUALLY_DISABLED });\n\t\t\t\twarnEnableDisableApp(app.name, status, 'disable');\n\t\t\t} catch (error) {\n\t\t\t\thandleAPIError(error);\n\t\t\t}\n\t\t};\n\t\tsetModal(\n\t\t\t<WarningModal close={closeModal} confirm={confirm} text={t('Apps_Marketplace_Deactivate_App_Prompt')} confirmText={t('Yes')} />,\n\t\t);\n\t}, [app.name, closeModal, setAppStatus, setModal, t]);\n\n\tconst handleEnable = useCallback(() => {\n\t\thandleAddon('enable', async () => {\n\t\t\ttry {\n\t\t\t\tconst { status } = await setAppStatus({ status: AppStatus.MANUALLY_ENABLED });\n\t\t\t\twarnEnableDisableApp(app.name, status, 'enable');\n\t\t\t} catch (error) {\n\t\t\t\thandleAPIError(error);\n\t\t\t}\n\t\t});\n\t}, [app.name, handleAddon, setAppStatus]);\n\n\tconst handleUninstall = useCallback(() => {\n\t\tconst uninstall = async () => {\n\t\t\tcloseModal();\n\t\t\ttry {\n\t\t\t\tconst { success } = await uninstallApp();\n\t\t\t\tif (success) {\n\t\t\t\t\tdispatchToastMessage({ type: 'success', message: `${app.name} uninstalled` });\n\t\t\t\t\tif (context === 'details' && currentTab !== 'details') {\n\t\t\t\t\t\trouter.navigate(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: 'marketplace',\n\t\t\t\t\t\t\t\tparams: { ...router.getRouteParameters(), tab: 'details' },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ replace: true },\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\thandleAPIError(error);\n\t\t\t}\n\t\t};\n\n\t\tif (isSubscribed) {\n\t\t\tconst confirm = async () => {\n\t\t\t\tawait handleSubscription();\n\t\t\t};\n\n\t\t\tsetModal(\n\t\t\t\t<WarningModal\n\t\t\t\t\tclose={closeModal}\n\t\t\t\t\tcancel={uninstall}\n\t\t\t\t\tconfirm={confirm}\n\t\t\t\t\ttext={t('Apps_Marketplace_Uninstall_Subscribed_App_Prompt')}\n\t\t\t\t\tconfirmText={t('Apps_Marketplace_Modify_App_Subscription')}\n\t\t\t\t\tcancelText={t('Apps_Marketplace_Uninstall_Subscribed_App_Anyway')}\n\t\t\t\t/>,\n\t\t\t);\n\t\t}\n\n\t\tif (!appCountQuery.data) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (app.migrated) {\n\t\t\tsetModal(\n\t\t\t\t<UninstallGrandfatheredAppModal\n\t\t\t\t\tcontext={context}\n\t\t\t\t\tappName={app.name}\n\t\t\t\t\tlimit={appCountQuery.data.limit}\n\t\t\t\t\thandleUninstall={uninstall}\n\t\t\t\t\thandleClose={closeModal}\n\t\t\t\t/>,\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tsetModal(\n\t\t\t<WarningModal close={closeModal} confirm={uninstall} text={t('Apps_Marketplace_Uninstall_App_Prompt')} confirmText={t('Yes')} />,\n\t\t);\n\t}, [\n\t\tisSubscribed,\n\t\tappCountQuery.data,\n\t\tapp.migrated,\n\t\tapp.name,\n\t\tsetModal,\n\t\tcloseModal,\n\t\tt,\n\t\tuninstallApp,\n\t\tdispatchToastMessage,\n\t\tcontext,\n\t\tcurrentTab,\n\t\trouter,\n\t\thandleSubscription,\n\t]);\n\n\tconst incompatibleIconName = useCallback(\n\t\t(app, action) => {\n\t\t\tif (!app.versionIncompatible) {\n\t\t\t\tif (action === 'update') {\n\t\t\t\t\treturn 'refresh';\n\t\t\t\t}\n\n\t\t\t\treturn 'card';\n\t\t\t}\n\n\t\t\t// Now we are handling an incompatible app\n\t\t\tif (action === 'subscribe' && !isSubscribed) {\n\t\t\t\treturn 'warning';\n\t\t\t}\n\n\t\t\tif (action === 'install' || action === 'update') {\n\t\t\t\treturn 'warning';\n\t\t\t}\n\n\t\t\treturn 'card';\n\t\t},\n\t\t[isSubscribed],\n\t);\n\n\tconst handleUpdate = useCallback(async () => {\n\t\tsetLoading(true);\n\n\t\tif (app?.versionIncompatible) {\n\t\t\topenIncompatibleModal(app, 'update', closeModal);\n\t\t\treturn;\n\t\t}\n\n\t\thandleAddon('update', openPermissionModal);\n\t}, [app, handleAddon, openPermissionModal, openIncompatibleModal, closeModal]);\n\n\tconst canUpdate = app.installed && app.version && app.marketplaceVersion && semver.lt(app.version, app.marketplaceVersion);\n\n\tconst menuSections = useMemo(() => {\n\t\tconst bothAppStatusOptions = [\n\t\t\tcanAppBeSubscribed &&\n\t\t\t\tisSubscribed &&\n\t\t\t\tisAdminUser && {\n\t\t\t\t\tid: 'subscribe',\n\t\t\t\t\tsection: 0,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Icon name={incompatibleIconName(app, 'subscribe')} size='x16' mie={4} />\n\t\t\t\t\t\t\t{t('Subscription')}\n\t\t\t\t\t\t</>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleSubscription,\n\t\t\t\t},\n\t\t];\n\n\t\tconst nonInstalledAppOptions = [\n\t\t\t!app.installed &&\n\t\t\t\t!!button && {\n\t\t\t\t\tid: 'acquire',\n\t\t\t\t\tsection: 0,\n\t\t\t\t\tdisabled: requestedEndUser,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t{isAdminUser && <Icon name={incompatibleIconName(app, 'install')} size='x16' mie={4} />}\n\t\t\t\t\t\t\t{t(buttonLabel)}\n\t\t\t\t\t\t</>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleAcquireApp,\n\t\t\t\t},\n\t\t];\n\n\t\tconst isEnterpriseOrNot = (app.isEnterpriseOnly && isEnterpriseLicense) || !app.isEnterpriseOnly;\n\t\tconst isPossibleToEnableApp = app.installed && isAdminUser && !isAppEnabled && isEnterpriseOrNot;\n\t\tconst doesItReachedTheLimit =\n\t\t\t!app.migrated &&\n\t\t\t!appCountQuery?.data?.hasUnlimitedApps &&\n\t\t\tappCountQuery?.data?.enabled !== undefined &&\n\t\t\tappCountQuery?.data?.enabled >= appCountQuery?.data?.limit;\n\n\t\tconst installedAppOptions = [\n\t\t\tcontext !== 'details' &&\n\t\t\t\tisAdminUser &&\n\t\t\t\tapp.installed && {\n\t\t\t\t\tid: 'viewLogs',\n\t\t\t\t\tsection: 0,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Icon name='desktop-text' size='x16' mie={4} />\n\t\t\t\t\t\t\t{t('View_Logs')}\n\t\t\t\t\t\t</>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleViewLogs,\n\t\t\t\t},\n\t\t\tisAdminUser &&\n\t\t\t\t!!canUpdate &&\n\t\t\t\t!isAppDetailsPage && {\n\t\t\t\t\tid: 'update',\n\t\t\t\t\tsection: 0,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Icon name={incompatibleIconName(app, 'update')} size='x16' mie={4} />\n\t\t\t\t\t\t\t{t('Update')}\n\t\t\t\t\t\t</>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleUpdate,\n\t\t\t\t},\n\t\t\tapp.installed &&\n\t\t\t\tisAdminUser &&\n\t\t\t\tisAppEnabled && {\n\t\t\t\t\tid: 'disable',\n\t\t\t\t\tsection: 0,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<Box color='status-font-on-warning'>\n\t\t\t\t\t\t\t<Icon name='ban' size='x16' mie={4} />\n\t\t\t\t\t\t\t{t('Disable')}\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleDisable,\n\t\t\t\t},\n\t\t\tisPossibleToEnableApp && {\n\t\t\t\tid: 'enable',\n\t\t\t\tsection: 0,\n\t\t\t\tdisabled: doesItReachedTheLimit,\n\t\t\t\tcontent: (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Icon name='check' size='x16' marginInlineEnd='x4' />\n\t\t\t\t\t\t{t('Enable')}\n\t\t\t\t\t</>\n\t\t\t\t),\n\t\t\t\tonClick: handleEnable,\n\t\t\t},\n\t\t\tapp.installed &&\n\t\t\t\tisAdminUser && {\n\t\t\t\t\tid: 'uninstall',\n\t\t\t\t\tsection: 1,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<Box color='status-font-on-danger'>\n\t\t\t\t\t\t\t<Icon name='trash' size='x16' mie={4} />\n\t\t\t\t\t\t\t{t('Uninstall')}\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleUninstall,\n\t\t\t\t},\n\t\t];\n\n\t\tconst filtered = [...bothAppStatusOptions, ...nonInstalledAppOptions, ...installedAppOptions].flatMap((value) =>\n\t\t\tvalue && typeof value !== 'boolean' ? value : [],\n\t\t);\n\n\t\tconst sections: AppMenuSections = [];\n\n\t\tfiltered.forEach((option) => {\n\t\t\tif (typeof sections[option.section] === 'undefined') {\n\t\t\t\tsections[option.section] = { items: [] };\n\t\t\t}\n\n\t\t\tsections[option.section].items.push(option);\n\t\t});\n\n\t\treturn sections;\n\t}, [\n\t\tcanAppBeSubscribed,\n\t\tisSubscribed,\n\t\tisAdminUser,\n\t\tincompatibleIconName,\n\t\tapp,\n\t\tt,\n\t\thandleSubscription,\n\t\tbutton,\n\t\trequestedEndUser,\n\t\tbuttonLabel,\n\t\thandleAcquireApp,\n\t\tisEnterpriseLicense,\n\t\tisAppEnabled,\n\t\tappCountQuery?.data?.hasUnlimitedApps,\n\t\tappCountQuery?.data?.enabled,\n\t\tappCountQuery?.data?.limit,\n\t\tcontext,\n\t\thandleViewLogs,\n\t\tcanUpdate,\n\t\tisAppDetailsPage,\n\t\thandleUpdate,\n\t\thandleDisable,\n\t\thandleEnable,\n\t\thandleUninstall,\n\t]);\n\n\treturn { isLoading, isAdminUser, sections: menuSections };\n};\n"]}}},"code":"let _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n}, 0);\nmodule.export({\n  useAppMenu: () => useAppMenu\n});\nlet AppStatus;\nmodule.link(\"@rocket.chat/apps-engine/definition/AppStatus\", {\n  AppStatus(v) {\n    AppStatus = v;\n  }\n}, 0);\nlet Box, Icon;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Box(v) {\n    Box = v;\n  },\n  Icon(v) {\n    Icon = v;\n  }\n}, 1);\nlet useSetModal, useEndpoint, useTranslation, useRouteParameter, useToastMessageDispatch, usePermission, useRouter;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useSetModal(v) {\n    useSetModal = v;\n  },\n  useEndpoint(v) {\n    useEndpoint = v;\n  },\n  useTranslation(v) {\n    useTranslation = v;\n  },\n  useRouteParameter(v) {\n    useRouteParameter = v;\n  },\n  useToastMessageDispatch(v) {\n    useToastMessageDispatch = v;\n  },\n  usePermission(v) {\n    usePermission = v;\n  },\n  useRouter(v) {\n    useRouter = v;\n  }\n}, 2);\nlet React, useMemo, useCallback, useState;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n  useMemo(v) {\n    useMemo = v;\n  },\n  useCallback(v) {\n    useCallback = v;\n  },\n  useState(v) {\n    useState = v;\n  }\n}, 3);\nlet semver;\nmodule.link(\"semver\", {\n  default(v) {\n    semver = v;\n  }\n}, 4);\nlet useAppInstallationHandler;\nmodule.link(\"./useAppInstallationHandler\", {\n  useAppInstallationHandler(v) {\n    useAppInstallationHandler = v;\n  }\n}, 5);\nlet useAppsCountQuery;\nmodule.link(\"./useAppsCountQuery\", {\n  useAppsCountQuery(v) {\n    useAppsCountQuery = v;\n  }\n}, 6);\nlet useMarketplaceActions;\nmodule.link(\"./useMarketplaceActions\", {\n  useMarketplaceActions(v) {\n    useMarketplaceActions = v;\n  }\n}, 7);\nlet useOpenAppPermissionsReviewModal;\nmodule.link(\"./useOpenAppPermissionsReviewModal\", {\n  useOpenAppPermissionsReviewModal(v) {\n    useOpenAppPermissionsReviewModal = v;\n  }\n}, 8);\nlet useOpenIncompatibleModal;\nmodule.link(\"./useOpenIncompatibleModal\", {\n  useOpenIncompatibleModal(v) {\n    useOpenIncompatibleModal = v;\n  }\n}, 9);\nlet WarningModal;\nmodule.link(\"../../../components/WarningModal\", {\n  default(v) {\n    WarningModal = v;\n  }\n}, 10);\nlet useHasLicenseModule;\nmodule.link(\"../../../hooks/useHasLicenseModule\", {\n  useHasLicenseModule(v) {\n    useHasLicenseModule = v;\n  }\n}, 11);\nlet useIsEnterprise;\nmodule.link(\"../../../hooks/useIsEnterprise\", {\n  useIsEnterprise(v) {\n    useIsEnterprise = v;\n  }\n}, 12);\nlet AddonRequiredModal;\nmodule.link(\"../AppsList/AddonRequiredModal\", {\n  default(v) {\n    AddonRequiredModal = v;\n  }\n}, 13);\nlet IframeModal;\nmodule.link(\"../IframeModal\", {\n  default(v) {\n    IframeModal = v;\n  }\n}, 14);\nlet UninstallGrandfatheredAppModal;\nmodule.link(\"../components/UninstallGrandfatheredAppModal/UninstallGrandfatheredAppModal\", {\n  default(v) {\n    UninstallGrandfatheredAppModal = v;\n  }\n}, 15);\nlet appEnabledStatuses, appButtonProps;\nmodule.link(\"../helpers\", {\n  appEnabledStatuses(v) {\n    appEnabledStatuses = v;\n  },\n  appButtonProps(v) {\n    appButtonProps = v;\n  }\n}, 16);\nlet handleAPIError;\nmodule.link(\"../helpers/handleAPIError\", {\n  handleAPIError(v) {\n    handleAPIError = v;\n  }\n}, 17);\nlet warnEnableDisableApp;\nmodule.link(\"../helpers/warnEnableDisableApp\", {\n  warnEnableDisableApp(v) {\n    warnEnableDisableApp = v;\n  }\n}, 18);\nconst useAppMenu = (app, isAppDetailsPage) => {\n  var _appCountQuery$data5, _appCountQuery$data6, _appCountQuery$data7;\n  const t = useTranslation();\n  const router = useRouter();\n  const setModal = useSetModal();\n  const dispatchToastMessage = useToastMessageDispatch();\n  const openIncompatibleModal = useOpenIncompatibleModal();\n  const context = useRouteParameter('context');\n  const currentTab = useRouteParameter('tab');\n  const appCountQuery = useAppsCountQuery(context);\n  const isAdminUser = usePermission('manage-apps');\n  const {\n    data\n  } = useIsEnterprise();\n  const isEnterpriseLicense = !!(data !== null && data !== void 0 && data.isEnterprise);\n  const workspaceHasMarketplaceAddon = useHasLicenseModule(app.addon);\n  const workspaceHasInstalledAddon = useHasLicenseModule(app.installedAddon);\n  const [isLoading, setLoading] = useState(false);\n  const [requestedEndUser, setRequestedEndUser] = useState(app.requestedEndUser);\n  const [isAppPurchased, setPurchased] = useState(app === null || app === void 0 ? void 0 : app.isPurchased);\n  const button = appButtonProps(_objectSpread(_objectSpread({}, app), {}, {\n    isAdminUser,\n    endUserRequested: false\n  }));\n  const buttonLabel = button === null || button === void 0 ? void 0 : button.label.replace(' ', '_');\n  const action = (button === null || button === void 0 ? void 0 : button.action) || '';\n  const setAppStatus = useEndpoint('POST', '/apps/:id/status', {\n    id: app.id\n  });\n  const buildExternalUrl = useEndpoint('GET', '/apps');\n  const syncApp = useEndpoint('POST', '/apps/:id/sync', {\n    id: app.id\n  });\n  const uninstallApp = useEndpoint('DELETE', '/apps/:id', {\n    id: app.id\n  });\n  const canAppBeSubscribed = app.purchaseType === 'subscription';\n  const isSubscribed = app.subscriptionInfo && ['active', 'trialing'].includes(app.subscriptionInfo.status);\n  const isAppEnabled = app.status ? appEnabledStatuses.includes(app.status) : false;\n  const closeModal = useCallback(() => {\n    setModal(null);\n    setLoading(false);\n  }, [setModal, setLoading]);\n  const marketplaceActions = useMarketplaceActions();\n  const installationSuccess = useCallback(async (action, permissionsGranted) => {\n    if (action) {\n      if (action === 'request') {\n        setRequestedEndUser(true);\n      } else {\n        await marketplaceActions[action](_objectSpread(_objectSpread({}, app), {}, {\n          permissionsGranted\n        }));\n      }\n    }\n    setLoading(false);\n  }, [app, marketplaceActions, setLoading]);\n  const openPermissionModal = useOpenAppPermissionsReviewModal({\n    app,\n    onCancel: closeModal,\n    onConfirm: permissionsGranted => installationSuccess(action, permissionsGranted)\n  });\n  const appInstallationHandler = useAppInstallationHandler({\n    app,\n    isAppPurchased,\n    action,\n    onDismiss: closeModal,\n    onSuccess: installationSuccess,\n    setIsPurchased: setPurchased\n  });\n  // TODO: There is no necessity of all these callbacks being out of the above useMemo.\n  // My propose here is to refactor the hook to make it clearer and with less unnecessary caching.\n  const missingAddonHandler = useCallback(actionType => {\n    setModal( /*#__PURE__*/React.createElement(AddonRequiredModal, {\n      actionType: actionType,\n      onDismiss: closeModal,\n      onInstallAnyway: appInstallationHandler\n    }));\n  }, [appInstallationHandler, closeModal, setModal]);\n  const handleAddon = useCallback((actionType, callback) => {\n    if (actionType === 'enable' && isAdminUser && app.installedAddon && !workspaceHasInstalledAddon) {\n      return missingAddonHandler(actionType);\n    }\n    if (actionType !== 'enable' && isAdminUser && app.addon && !workspaceHasMarketplaceAddon) {\n      return missingAddonHandler(actionType);\n    }\n    callback();\n  }, [app.addon, app.installedAddon, isAdminUser, missingAddonHandler, workspaceHasInstalledAddon, workspaceHasMarketplaceAddon]);\n  const handleAcquireApp = useCallback(() => {\n    setLoading(true);\n    handleAddon('install', appInstallationHandler);\n  }, [appInstallationHandler, handleAddon]);\n  const handleSubscription = useCallback(async () => {\n    if (app !== null && app !== void 0 && app.versionIncompatible && !isSubscribed) {\n      openIncompatibleModal(app, 'subscribe', closeModal);\n      return;\n    }\n    let data;\n    try {\n      data = await buildExternalUrl({\n        buildExternalUrl: 'true',\n        appId: app.id,\n        purchaseType: app.purchaseType,\n        details: 'true'\n      });\n    } catch (error) {\n      handleAPIError(error);\n      return;\n    }\n    const confirm = async () => {\n      try {\n        await syncApp();\n      } catch (error) {\n        handleAPIError(error);\n      }\n    };\n    setModal( /*#__PURE__*/React.createElement(IframeModal, {\n      url: data.url,\n      confirm: confirm,\n      cancel: closeModal\n    }));\n  }, [app, isSubscribed, setModal, closeModal, openIncompatibleModal, buildExternalUrl, syncApp]);\n  const handleViewLogs = useCallback(() => {\n    router.navigate({\n      name: 'marketplace',\n      params: {\n        context,\n        page: 'info',\n        id: app.id,\n        version: app.version,\n        tab: 'logs'\n      }\n    });\n  }, [app.id, app.version, context, router]);\n  const handleDisable = useCallback(() => {\n    const confirm = async () => {\n      closeModal();\n      try {\n        const {\n          status\n        } = await setAppStatus({\n          status: AppStatus.MANUALLY_DISABLED\n        });\n        warnEnableDisableApp(app.name, status, 'disable');\n      } catch (error) {\n        handleAPIError(error);\n      }\n    };\n    setModal( /*#__PURE__*/React.createElement(WarningModal, {\n      close: closeModal,\n      confirm: confirm,\n      text: t('Apps_Marketplace_Deactivate_App_Prompt'),\n      confirmText: t('Yes')\n    }));\n  }, [app.name, closeModal, setAppStatus, setModal, t]);\n  const handleEnable = useCallback(() => {\n    handleAddon('enable', async () => {\n      try {\n        const {\n          status\n        } = await setAppStatus({\n          status: AppStatus.MANUALLY_ENABLED\n        });\n        warnEnableDisableApp(app.name, status, 'enable');\n      } catch (error) {\n        handleAPIError(error);\n      }\n    });\n  }, [app.name, handleAddon, setAppStatus]);\n  const handleUninstall = useCallback(() => {\n    const uninstall = async () => {\n      closeModal();\n      try {\n        const {\n          success\n        } = await uninstallApp();\n        if (success) {\n          dispatchToastMessage({\n            type: 'success',\n            message: \"\".concat(app.name, \" uninstalled\")\n          });\n          if (context === 'details' && currentTab !== 'details') {\n            router.navigate({\n              name: 'marketplace',\n              params: _objectSpread(_objectSpread({}, router.getRouteParameters()), {}, {\n                tab: 'details'\n              })\n            }, {\n              replace: true\n            });\n          }\n        }\n      } catch (error) {\n        handleAPIError(error);\n      }\n    };\n    if (isSubscribed) {\n      const confirm = async () => {\n        await handleSubscription();\n      };\n      setModal( /*#__PURE__*/React.createElement(WarningModal, {\n        close: closeModal,\n        cancel: uninstall,\n        confirm: confirm,\n        text: t('Apps_Marketplace_Uninstall_Subscribed_App_Prompt'),\n        confirmText: t('Apps_Marketplace_Modify_App_Subscription'),\n        cancelText: t('Apps_Marketplace_Uninstall_Subscribed_App_Anyway')\n      }));\n    }\n    if (!appCountQuery.data) {\n      return;\n    }\n    if (app.migrated) {\n      setModal( /*#__PURE__*/React.createElement(UninstallGrandfatheredAppModal, {\n        context: context,\n        appName: app.name,\n        limit: appCountQuery.data.limit,\n        handleUninstall: uninstall,\n        handleClose: closeModal\n      }));\n      return;\n    }\n    setModal( /*#__PURE__*/React.createElement(WarningModal, {\n      close: closeModal,\n      confirm: uninstall,\n      text: t('Apps_Marketplace_Uninstall_App_Prompt'),\n      confirmText: t('Yes')\n    }));\n  }, [isSubscribed, appCountQuery.data, app.migrated, app.name, setModal, closeModal, t, uninstallApp, dispatchToastMessage, context, currentTab, router, handleSubscription]);\n  const incompatibleIconName = useCallback((app, action) => {\n    if (!app.versionIncompatible) {\n      if (action === 'update') {\n        return 'refresh';\n      }\n      return 'card';\n    }\n    // Now we are handling an incompatible app\n    if (action === 'subscribe' && !isSubscribed) {\n      return 'warning';\n    }\n    if (action === 'install' || action === 'update') {\n      return 'warning';\n    }\n    return 'card';\n  }, [isSubscribed]);\n  const handleUpdate = useCallback(async () => {\n    setLoading(true);\n    if (app !== null && app !== void 0 && app.versionIncompatible) {\n      openIncompatibleModal(app, 'update', closeModal);\n      return;\n    }\n    handleAddon('update', openPermissionModal);\n  }, [app, handleAddon, openPermissionModal, openIncompatibleModal, closeModal]);\n  const canUpdate = app.installed && app.version && app.marketplaceVersion && semver.lt(app.version, app.marketplaceVersion);\n  const menuSections = useMemo(() => {\n    var _appCountQuery$data, _appCountQuery$data2, _appCountQuery$data3, _appCountQuery$data4;\n    const bothAppStatusOptions = [canAppBeSubscribed && isSubscribed && isAdminUser && {\n      id: 'subscribe',\n      section: 0,\n      content: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Icon, {\n        name: incompatibleIconName(app, 'subscribe'),\n        size: \"x16\",\n        mie: 4\n      }), t('Subscription')),\n      onClick: handleSubscription\n    }];\n    const nonInstalledAppOptions = [!app.installed && !!button && {\n      id: 'acquire',\n      section: 0,\n      disabled: requestedEndUser,\n      content: /*#__PURE__*/React.createElement(React.Fragment, null, isAdminUser && /*#__PURE__*/React.createElement(Icon, {\n        name: incompatibleIconName(app, 'install'),\n        size: \"x16\",\n        mie: 4\n      }), t(buttonLabel)),\n      onClick: handleAcquireApp\n    }];\n    const isEnterpriseOrNot = app.isEnterpriseOnly && isEnterpriseLicense || !app.isEnterpriseOnly;\n    const isPossibleToEnableApp = app.installed && isAdminUser && !isAppEnabled && isEnterpriseOrNot;\n    const doesItReachedTheLimit = !app.migrated && !(appCountQuery !== null && appCountQuery !== void 0 && (_appCountQuery$data = appCountQuery.data) !== null && _appCountQuery$data !== void 0 && _appCountQuery$data.hasUnlimitedApps) && (appCountQuery === null || appCountQuery === void 0 ? void 0 : (_appCountQuery$data2 = appCountQuery.data) === null || _appCountQuery$data2 === void 0 ? void 0 : _appCountQuery$data2.enabled) !== undefined && (appCountQuery === null || appCountQuery === void 0 ? void 0 : (_appCountQuery$data3 = appCountQuery.data) === null || _appCountQuery$data3 === void 0 ? void 0 : _appCountQuery$data3.enabled) >= (appCountQuery === null || appCountQuery === void 0 ? void 0 : (_appCountQuery$data4 = appCountQuery.data) === null || _appCountQuery$data4 === void 0 ? void 0 : _appCountQuery$data4.limit);\n    const installedAppOptions = [context !== 'details' && isAdminUser && app.installed && {\n      id: 'viewLogs',\n      section: 0,\n      content: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Icon, {\n        name: \"desktop-text\",\n        size: \"x16\",\n        mie: 4\n      }), t('View_Logs')),\n      onClick: handleViewLogs\n    }, isAdminUser && !!canUpdate && !isAppDetailsPage && {\n      id: 'update',\n      section: 0,\n      content: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Icon, {\n        name: incompatibleIconName(app, 'update'),\n        size: \"x16\",\n        mie: 4\n      }), t('Update')),\n      onClick: handleUpdate\n    }, app.installed && isAdminUser && isAppEnabled && {\n      id: 'disable',\n      section: 0,\n      content: /*#__PURE__*/React.createElement(Box, {\n        color: \"status-font-on-warning\"\n      }, /*#__PURE__*/React.createElement(Icon, {\n        name: \"ban\",\n        size: \"x16\",\n        mie: 4\n      }), t('Disable')),\n      onClick: handleDisable\n    }, isPossibleToEnableApp && {\n      id: 'enable',\n      section: 0,\n      disabled: doesItReachedTheLimit,\n      content: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Icon, {\n        name: \"check\",\n        size: \"x16\",\n        marginInlineEnd: \"x4\"\n      }), t('Enable')),\n      onClick: handleEnable\n    }, app.installed && isAdminUser && {\n      id: 'uninstall',\n      section: 1,\n      content: /*#__PURE__*/React.createElement(Box, {\n        color: \"status-font-on-danger\"\n      }, /*#__PURE__*/React.createElement(Icon, {\n        name: \"trash\",\n        size: \"x16\",\n        mie: 4\n      }), t('Uninstall')),\n      onClick: handleUninstall\n    }];\n    const filtered = [...bothAppStatusOptions, ...nonInstalledAppOptions, ...installedAppOptions].flatMap(value => value && typeof value !== 'boolean' ? value : []);\n    const sections = [];\n    filtered.forEach(option => {\n      if (typeof sections[option.section] === 'undefined') {\n        sections[option.section] = {\n          items: []\n        };\n      }\n      sections[option.section].items.push(option);\n    });\n    return sections;\n  }, [canAppBeSubscribed, isSubscribed, isAdminUser, incompatibleIconName, app, t, handleSubscription, button, requestedEndUser, buttonLabel, handleAcquireApp, isEnterpriseLicense, isAppEnabled, appCountQuery === null || appCountQuery === void 0 ? void 0 : (_appCountQuery$data5 = appCountQuery.data) === null || _appCountQuery$data5 === void 0 ? void 0 : _appCountQuery$data5.hasUnlimitedApps, appCountQuery === null || appCountQuery === void 0 ? void 0 : (_appCountQuery$data6 = appCountQuery.data) === null || _appCountQuery$data6 === void 0 ? void 0 : _appCountQuery$data6.enabled, appCountQuery === null || appCountQuery === void 0 ? void 0 : (_appCountQuery$data7 = appCountQuery.data) === null || _appCountQuery$data7 === void 0 ? void 0 : _appCountQuery$data7.limit, context, handleViewLogs, canUpdate, isAppDetailsPage, handleUpdate, handleDisable, handleEnable, handleUninstall]);\n  return {\n    isLoading,\n    isAdminUser,\n    sections: menuSections\n  };\n};","map":{"version":3,"names":["_objectSpread","module","link","default","v","export","useAppMenu","AppStatus","Box","Icon","useSetModal","useEndpoint","useTranslation","useRouteParameter","useToastMessageDispatch","usePermission","useRouter","React","useMemo","useCallback","useState","semver","useAppInstallationHandler","useAppsCountQuery","useMarketplaceActions","useOpenAppPermissionsReviewModal","useOpenIncompatibleModal","WarningModal","useHasLicenseModule","useIsEnterprise","AddonRequiredModal","IframeModal","UninstallGrandfatheredAppModal","appEnabledStatuses","appButtonProps","handleAPIError","warnEnableDisableApp","app","isAppDetailsPage","_appCountQuery$data5","_appCountQuery$data6","_appCountQuery$data7","t","router","setModal","dispatchToastMessage","openIncompatibleModal","context","currentTab","appCountQuery","isAdminUser","data","isEnterpriseLicense","isEnterprise","workspaceHasMarketplaceAddon","addon","workspaceHasInstalledAddon","installedAddon","isLoading","setLoading","requestedEndUser","setRequestedEndUser","isAppPurchased","setPurchased","isPurchased","button","endUserRequested","buttonLabel","label","replace","action","setAppStatus","id","buildExternalUrl","syncApp","uninstallApp","canAppBeSubscribed","purchaseType","isSubscribed","subscriptionInfo","includes","status","isAppEnabled","closeModal","marketplaceActions","installationSuccess","permissionsGranted","openPermissionModal","onCancel","onConfirm","appInstallationHandler","onDismiss","onSuccess","setIsPurchased","missingAddonHandler","actionType","createElement","onInstallAnyway","handleAddon","callback","handleAcquireApp","handleSubscription","versionIncompatible","appId","details","error","confirm","url","cancel","handleViewLogs","navigate","name","params","page","version","tab","handleDisable","MANUALLY_DISABLED","close","text","confirmText","handleEnable","MANUALLY_ENABLED","handleUninstall","uninstall","success","type","message","concat","getRouteParameters","cancelText","migrated","appName","limit","handleClose","incompatibleIconName","handleUpdate","canUpdate","installed","marketplaceVersion","lt","menuSections","_appCountQuery$data","_appCountQuery$data2","_appCountQuery$data3","_appCountQuery$data4","bothAppStatusOptions","section","content","Fragment","size","mie","onClick","nonInstalledAppOptions","disabled","isEnterpriseOrNot","isEnterpriseOnly","isPossibleToEnableApp","doesItReachedTheLimit","hasUnlimitedApps","enabled","undefined","installedAppOptions","color","marginInlineEnd","filtered","flatMap","value","sections","forEach","option","items","push"],"sources":["client/views/marketplace/hooks/useAppMenu.tsx"],"sourcesContent":["import { AppStatus } from '@rocket.chat/apps-engine/definition/AppStatus';\nimport type { App } from '@rocket.chat/core-typings';\nimport { Box, Icon } from '@rocket.chat/fuselage';\nimport {\n\tuseSetModal,\n\tuseEndpoint,\n\tuseTranslation,\n\tuseRouteParameter,\n\tuseToastMessageDispatch,\n\tusePermission,\n\tuseRouter,\n} from '@rocket.chat/ui-contexts';\nimport type { MouseEvent, ReactNode } from 'react';\nimport React, { useMemo, useCallback, useState } from 'react';\nimport semver from 'semver';\n\nimport { useAppInstallationHandler } from './useAppInstallationHandler';\nimport type { MarketplaceRouteContext } from './useAppsCountQuery';\nimport { useAppsCountQuery } from './useAppsCountQuery';\nimport { useMarketplaceActions } from './useMarketplaceActions';\nimport { useOpenAppPermissionsReviewModal } from './useOpenAppPermissionsReviewModal';\nimport { useOpenIncompatibleModal } from './useOpenIncompatibleModal';\nimport WarningModal from '../../../components/WarningModal';\nimport { useHasLicenseModule } from '../../../hooks/useHasLicenseModule';\nimport { useIsEnterprise } from '../../../hooks/useIsEnterprise';\nimport type { AddonActionType } from '../AppsList/AddonRequiredModal';\nimport AddonRequiredModal from '../AppsList/AddonRequiredModal';\nimport IframeModal from '../IframeModal';\nimport UninstallGrandfatheredAppModal from '../components/UninstallGrandfatheredAppModal/UninstallGrandfatheredAppModal';\nimport type { Actions } from '../helpers';\nimport { appEnabledStatuses, appButtonProps } from '../helpers';\nimport { handleAPIError } from '../helpers/handleAPIError';\nimport { warnEnableDisableApp } from '../helpers/warnEnableDisableApp';\n\nexport type AppMenuOption = {\n\tid: string;\n\tsection: number;\n\tcontent: ReactNode;\n\tdisabled?: boolean;\n\tonClick?: (e?: MouseEvent<HTMLElement>) => void;\n};\n\ntype AppMenuSections = {\n\titems: AppMenuOption[];\n}[];\n\nexport const useAppMenu = (app: App, isAppDetailsPage: boolean) => {\n\tconst t = useTranslation();\n\tconst router = useRouter();\n\tconst setModal = useSetModal();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst openIncompatibleModal = useOpenIncompatibleModal();\n\n\tconst context = useRouteParameter('context') as MarketplaceRouteContext;\n\tconst currentTab = useRouteParameter('tab');\n\tconst appCountQuery = useAppsCountQuery(context);\n\n\tconst isAdminUser = usePermission('manage-apps');\n\tconst { data } = useIsEnterprise();\n\tconst isEnterpriseLicense = !!data?.isEnterprise;\n\n\tconst workspaceHasMarketplaceAddon = useHasLicenseModule(app.addon);\n\tconst workspaceHasInstalledAddon = useHasLicenseModule(app.installedAddon);\n\n\tconst [isLoading, setLoading] = useState(false);\n\tconst [requestedEndUser, setRequestedEndUser] = useState(app.requestedEndUser);\n\tconst [isAppPurchased, setPurchased] = useState(app?.isPurchased);\n\n\tconst button = appButtonProps({ ...app, isAdminUser, endUserRequested: false });\n\tconst buttonLabel = button?.label.replace(' ', '_') as\n\t\t| 'Update'\n\t\t| 'Install'\n\t\t| 'Subscribe'\n\t\t| 'See_Pricing'\n\t\t| 'Try_now'\n\t\t| 'Buy'\n\t\t| 'Request'\n\t\t| 'Requested';\n\tconst action = button?.action || '';\n\n\tconst setAppStatus = useEndpoint<'POST', '/apps/:id/status'>('POST', '/apps/:id/status', { id: app.id });\n\tconst buildExternalUrl = useEndpoint('GET', '/apps');\n\tconst syncApp = useEndpoint<'POST', '/apps/:id/sync'>('POST', '/apps/:id/sync', { id: app.id });\n\tconst uninstallApp = useEndpoint<'DELETE', '/apps/:id'>('DELETE', '/apps/:id', { id: app.id });\n\n\tconst canAppBeSubscribed = app.purchaseType === 'subscription';\n\tconst isSubscribed = app.subscriptionInfo && ['active', 'trialing'].includes(app.subscriptionInfo.status);\n\tconst isAppEnabled = app.status ? appEnabledStatuses.includes(app.status) : false;\n\n\tconst closeModal = useCallback(() => {\n\t\tsetModal(null);\n\t\tsetLoading(false);\n\t}, [setModal, setLoading]);\n\n\tconst marketplaceActions = useMarketplaceActions();\n\n\tconst installationSuccess = useCallback(\n\t\tasync (action: Actions | '', permissionsGranted) => {\n\t\t\tif (action) {\n\t\t\t\tif (action === 'request') {\n\t\t\t\t\tsetRequestedEndUser(true);\n\t\t\t\t} else {\n\t\t\t\t\tawait marketplaceActions[action]({ ...app, permissionsGranted });\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetLoading(false);\n\t\t},\n\t\t[app, marketplaceActions, setLoading],\n\t);\n\n\tconst openPermissionModal = useOpenAppPermissionsReviewModal({\n\t\tapp,\n\t\tonCancel: closeModal,\n\t\tonConfirm: (permissionsGranted) => installationSuccess(action, permissionsGranted),\n\t});\n\n\tconst appInstallationHandler = useAppInstallationHandler({\n\t\tapp,\n\t\tisAppPurchased,\n\t\taction,\n\t\tonDismiss: closeModal,\n\t\tonSuccess: installationSuccess,\n\t\tsetIsPurchased: setPurchased,\n\t});\n\n\t// TODO: There is no necessity of all these callbacks being out of the above useMemo.\n\t// My propose here is to refactor the hook to make it clearer and with less unnecessary caching.\n\tconst missingAddonHandler = useCallback(\n\t\t(actionType: AddonActionType) => {\n\t\t\tsetModal(<AddonRequiredModal actionType={actionType} onDismiss={closeModal} onInstallAnyway={appInstallationHandler} />);\n\t\t},\n\t\t[appInstallationHandler, closeModal, setModal],\n\t);\n\n\tconst handleAddon = useCallback(\n\t\t(actionType: AddonActionType, callback: () => void) => {\n\t\t\tif (actionType === 'enable' && isAdminUser && app.installedAddon && !workspaceHasInstalledAddon) {\n\t\t\t\treturn missingAddonHandler(actionType);\n\t\t\t}\n\n\t\t\tif (actionType !== 'enable' && isAdminUser && app.addon && !workspaceHasMarketplaceAddon) {\n\t\t\t\treturn missingAddonHandler(actionType);\n\t\t\t}\n\n\t\t\tcallback();\n\t\t},\n\t\t[app.addon, app.installedAddon, isAdminUser, missingAddonHandler, workspaceHasInstalledAddon, workspaceHasMarketplaceAddon],\n\t);\n\n\tconst handleAcquireApp = useCallback(() => {\n\t\tsetLoading(true);\n\t\thandleAddon('install', appInstallationHandler);\n\t}, [appInstallationHandler, handleAddon]);\n\n\tconst handleSubscription = useCallback(async () => {\n\t\tif (app?.versionIncompatible && !isSubscribed) {\n\t\t\topenIncompatibleModal(app, 'subscribe', closeModal);\n\t\t\treturn;\n\t\t}\n\n\t\tlet data;\n\t\ttry {\n\t\t\tdata = (await buildExternalUrl({\n\t\t\t\tbuildExternalUrl: 'true',\n\t\t\t\tappId: app.id,\n\t\t\t\tpurchaseType: app.purchaseType,\n\t\t\t\tdetails: 'true',\n\t\t\t})) as { url: string };\n\t\t} catch (error) {\n\t\t\thandleAPIError(error);\n\t\t\treturn;\n\t\t}\n\n\t\tconst confirm = async () => {\n\t\t\ttry {\n\t\t\t\tawait syncApp();\n\t\t\t} catch (error) {\n\t\t\t\thandleAPIError(error);\n\t\t\t}\n\t\t};\n\n\t\tsetModal(<IframeModal url={data.url} confirm={confirm} cancel={closeModal} />);\n\t}, [app, isSubscribed, setModal, closeModal, openIncompatibleModal, buildExternalUrl, syncApp]);\n\n\tconst handleViewLogs = useCallback(() => {\n\t\trouter.navigate({\n\t\t\tname: 'marketplace',\n\t\t\tparams: {\n\t\t\t\tcontext,\n\t\t\t\tpage: 'info',\n\t\t\t\tid: app.id,\n\t\t\t\tversion: app.version,\n\t\t\t\ttab: 'logs',\n\t\t\t},\n\t\t});\n\t}, [app.id, app.version, context, router]);\n\n\tconst handleDisable = useCallback(() => {\n\t\tconst confirm = async () => {\n\t\t\tcloseModal();\n\t\t\ttry {\n\t\t\t\tconst { status } = await setAppStatus({ status: AppStatus.MANUALLY_DISABLED });\n\t\t\t\twarnEnableDisableApp(app.name, status, 'disable');\n\t\t\t} catch (error) {\n\t\t\t\thandleAPIError(error);\n\t\t\t}\n\t\t};\n\t\tsetModal(\n\t\t\t<WarningModal close={closeModal} confirm={confirm} text={t('Apps_Marketplace_Deactivate_App_Prompt')} confirmText={t('Yes')} />,\n\t\t);\n\t}, [app.name, closeModal, setAppStatus, setModal, t]);\n\n\tconst handleEnable = useCallback(() => {\n\t\thandleAddon('enable', async () => {\n\t\t\ttry {\n\t\t\t\tconst { status } = await setAppStatus({ status: AppStatus.MANUALLY_ENABLED });\n\t\t\t\twarnEnableDisableApp(app.name, status, 'enable');\n\t\t\t} catch (error) {\n\t\t\t\thandleAPIError(error);\n\t\t\t}\n\t\t});\n\t}, [app.name, handleAddon, setAppStatus]);\n\n\tconst handleUninstall = useCallback(() => {\n\t\tconst uninstall = async () => {\n\t\t\tcloseModal();\n\t\t\ttry {\n\t\t\t\tconst { success } = await uninstallApp();\n\t\t\t\tif (success) {\n\t\t\t\t\tdispatchToastMessage({ type: 'success', message: `${app.name} uninstalled` });\n\t\t\t\t\tif (context === 'details' && currentTab !== 'details') {\n\t\t\t\t\t\trouter.navigate(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: 'marketplace',\n\t\t\t\t\t\t\t\tparams: { ...router.getRouteParameters(), tab: 'details' },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ replace: true },\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\thandleAPIError(error);\n\t\t\t}\n\t\t};\n\n\t\tif (isSubscribed) {\n\t\t\tconst confirm = async () => {\n\t\t\t\tawait handleSubscription();\n\t\t\t};\n\n\t\t\tsetModal(\n\t\t\t\t<WarningModal\n\t\t\t\t\tclose={closeModal}\n\t\t\t\t\tcancel={uninstall}\n\t\t\t\t\tconfirm={confirm}\n\t\t\t\t\ttext={t('Apps_Marketplace_Uninstall_Subscribed_App_Prompt')}\n\t\t\t\t\tconfirmText={t('Apps_Marketplace_Modify_App_Subscription')}\n\t\t\t\t\tcancelText={t('Apps_Marketplace_Uninstall_Subscribed_App_Anyway')}\n\t\t\t\t/>,\n\t\t\t);\n\t\t}\n\n\t\tif (!appCountQuery.data) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (app.migrated) {\n\t\t\tsetModal(\n\t\t\t\t<UninstallGrandfatheredAppModal\n\t\t\t\t\tcontext={context}\n\t\t\t\t\tappName={app.name}\n\t\t\t\t\tlimit={appCountQuery.data.limit}\n\t\t\t\t\thandleUninstall={uninstall}\n\t\t\t\t\thandleClose={closeModal}\n\t\t\t\t/>,\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tsetModal(\n\t\t\t<WarningModal close={closeModal} confirm={uninstall} text={t('Apps_Marketplace_Uninstall_App_Prompt')} confirmText={t('Yes')} />,\n\t\t);\n\t}, [\n\t\tisSubscribed,\n\t\tappCountQuery.data,\n\t\tapp.migrated,\n\t\tapp.name,\n\t\tsetModal,\n\t\tcloseModal,\n\t\tt,\n\t\tuninstallApp,\n\t\tdispatchToastMessage,\n\t\tcontext,\n\t\tcurrentTab,\n\t\trouter,\n\t\thandleSubscription,\n\t]);\n\n\tconst incompatibleIconName = useCallback(\n\t\t(app, action) => {\n\t\t\tif (!app.versionIncompatible) {\n\t\t\t\tif (action === 'update') {\n\t\t\t\t\treturn 'refresh';\n\t\t\t\t}\n\n\t\t\t\treturn 'card';\n\t\t\t}\n\n\t\t\t// Now we are handling an incompatible app\n\t\t\tif (action === 'subscribe' && !isSubscribed) {\n\t\t\t\treturn 'warning';\n\t\t\t}\n\n\t\t\tif (action === 'install' || action === 'update') {\n\t\t\t\treturn 'warning';\n\t\t\t}\n\n\t\t\treturn 'card';\n\t\t},\n\t\t[isSubscribed],\n\t);\n\n\tconst handleUpdate = useCallback(async () => {\n\t\tsetLoading(true);\n\n\t\tif (app?.versionIncompatible) {\n\t\t\topenIncompatibleModal(app, 'update', closeModal);\n\t\t\treturn;\n\t\t}\n\n\t\thandleAddon('update', openPermissionModal);\n\t}, [app, handleAddon, openPermissionModal, openIncompatibleModal, closeModal]);\n\n\tconst canUpdate = app.installed && app.version && app.marketplaceVersion && semver.lt(app.version, app.marketplaceVersion);\n\n\tconst menuSections = useMemo(() => {\n\t\tconst bothAppStatusOptions = [\n\t\t\tcanAppBeSubscribed &&\n\t\t\t\tisSubscribed &&\n\t\t\t\tisAdminUser && {\n\t\t\t\t\tid: 'subscribe',\n\t\t\t\t\tsection: 0,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Icon name={incompatibleIconName(app, 'subscribe')} size='x16' mie={4} />\n\t\t\t\t\t\t\t{t('Subscription')}\n\t\t\t\t\t\t</>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleSubscription,\n\t\t\t\t},\n\t\t];\n\n\t\tconst nonInstalledAppOptions = [\n\t\t\t!app.installed &&\n\t\t\t\t!!button && {\n\t\t\t\t\tid: 'acquire',\n\t\t\t\t\tsection: 0,\n\t\t\t\t\tdisabled: requestedEndUser,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t{isAdminUser && <Icon name={incompatibleIconName(app, 'install')} size='x16' mie={4} />}\n\t\t\t\t\t\t\t{t(buttonLabel)}\n\t\t\t\t\t\t</>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleAcquireApp,\n\t\t\t\t},\n\t\t];\n\n\t\tconst isEnterpriseOrNot = (app.isEnterpriseOnly && isEnterpriseLicense) || !app.isEnterpriseOnly;\n\t\tconst isPossibleToEnableApp = app.installed && isAdminUser && !isAppEnabled && isEnterpriseOrNot;\n\t\tconst doesItReachedTheLimit =\n\t\t\t!app.migrated &&\n\t\t\t!appCountQuery?.data?.hasUnlimitedApps &&\n\t\t\tappCountQuery?.data?.enabled !== undefined &&\n\t\t\tappCountQuery?.data?.enabled >= appCountQuery?.data?.limit;\n\n\t\tconst installedAppOptions = [\n\t\t\tcontext !== 'details' &&\n\t\t\t\tisAdminUser &&\n\t\t\t\tapp.installed && {\n\t\t\t\t\tid: 'viewLogs',\n\t\t\t\t\tsection: 0,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Icon name='desktop-text' size='x16' mie={4} />\n\t\t\t\t\t\t\t{t('View_Logs')}\n\t\t\t\t\t\t</>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleViewLogs,\n\t\t\t\t},\n\t\t\tisAdminUser &&\n\t\t\t\t!!canUpdate &&\n\t\t\t\t!isAppDetailsPage && {\n\t\t\t\t\tid: 'update',\n\t\t\t\t\tsection: 0,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Icon name={incompatibleIconName(app, 'update')} size='x16' mie={4} />\n\t\t\t\t\t\t\t{t('Update')}\n\t\t\t\t\t\t</>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleUpdate,\n\t\t\t\t},\n\t\t\tapp.installed &&\n\t\t\t\tisAdminUser &&\n\t\t\t\tisAppEnabled && {\n\t\t\t\t\tid: 'disable',\n\t\t\t\t\tsection: 0,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<Box color='status-font-on-warning'>\n\t\t\t\t\t\t\t<Icon name='ban' size='x16' mie={4} />\n\t\t\t\t\t\t\t{t('Disable')}\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleDisable,\n\t\t\t\t},\n\t\t\tisPossibleToEnableApp && {\n\t\t\t\tid: 'enable',\n\t\t\t\tsection: 0,\n\t\t\t\tdisabled: doesItReachedTheLimit,\n\t\t\t\tcontent: (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Icon name='check' size='x16' marginInlineEnd='x4' />\n\t\t\t\t\t\t{t('Enable')}\n\t\t\t\t\t</>\n\t\t\t\t),\n\t\t\t\tonClick: handleEnable,\n\t\t\t},\n\t\t\tapp.installed &&\n\t\t\t\tisAdminUser && {\n\t\t\t\t\tid: 'uninstall',\n\t\t\t\t\tsection: 1,\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<Box color='status-font-on-danger'>\n\t\t\t\t\t\t\t<Icon name='trash' size='x16' mie={4} />\n\t\t\t\t\t\t\t{t('Uninstall')}\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t),\n\t\t\t\t\tonClick: handleUninstall,\n\t\t\t\t},\n\t\t];\n\n\t\tconst filtered = [...bothAppStatusOptions, ...nonInstalledAppOptions, ...installedAppOptions].flatMap((value) =>\n\t\t\tvalue && typeof value !== 'boolean' ? value : [],\n\t\t);\n\n\t\tconst sections: AppMenuSections = [];\n\n\t\tfiltered.forEach((option) => {\n\t\t\tif (typeof sections[option.section] === 'undefined') {\n\t\t\t\tsections[option.section] = { items: [] };\n\t\t\t}\n\n\t\t\tsections[option.section].items.push(option);\n\t\t});\n\n\t\treturn sections;\n\t}, [\n\t\tcanAppBeSubscribed,\n\t\tisSubscribed,\n\t\tisAdminUser,\n\t\tincompatibleIconName,\n\t\tapp,\n\t\tt,\n\t\thandleSubscription,\n\t\tbutton,\n\t\trequestedEndUser,\n\t\tbuttonLabel,\n\t\thandleAcquireApp,\n\t\tisEnterpriseLicense,\n\t\tisAppEnabled,\n\t\tappCountQuery?.data?.hasUnlimitedApps,\n\t\tappCountQuery?.data?.enabled,\n\t\tappCountQuery?.data?.limit,\n\t\tcontext,\n\t\thandleViewLogs,\n\t\tcanUpdate,\n\t\tisAppDetailsPage,\n\t\thandleUpdate,\n\t\thandleDisable,\n\t\thandleEnable,\n\t\thandleUninstall,\n\t]);\n\n\treturn { isLoading, isAdminUser, sections: menuSections };\n};\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"61b328fc1d0e0963832400455b379038d90f7f51"}
