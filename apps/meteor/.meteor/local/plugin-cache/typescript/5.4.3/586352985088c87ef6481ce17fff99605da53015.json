{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/account/security/TwoFactorTOTP.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/account/security/TwoFactorTOTP.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/account/security/TwoFactorTOTP.tsx","inputSourceMap":{"version":3,"file":"client/views/account/security/TwoFactorTOTP.tsx","sourceRoot":"","sources":["client/views/account/security/TwoFactorTOTP.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Box, Button, TextInput, Margins } from '@rocket.chat/fuselage';\nimport { useSafely } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useToastMessageDispatch, useUser, useMethod, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement, ComponentProps } from 'react';\nimport React, { useState, useCallback, useEffect } from 'react';\nimport { useForm } from 'react-hook-form';\nimport qrcode from 'yaqrcode';\n\nimport TextCopy from '../../../components/TextCopy';\nimport TwoFactorTotpModal from '../../../components/TwoFactorModal/TwoFactorTotpModal';\nimport BackupCodesModal from './BackupCodesModal';\n\nconst TwoFactorTOTP = (props: ComponentProps<typeof Box>): ReactElement => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst user = useUser();\n\tconst setModal = useSetModal();\n\n\tconst enableTotpFn = useMethod('2fa:enable');\n\tconst disableTotpFn = useMethod('2fa:disable');\n\tconst verifyCodeFn = useMethod('2fa:validateTempToken');\n\tconst checkCodesRemainingFn = useMethod('2fa:checkCodesRemaining');\n\tconst regenerateCodesFn = useMethod('2fa:regenerateCodes');\n\n\tconst [registeringTotp, setRegisteringTotp] = useSafely(useState(false));\n\tconst [qrCode, setQrCode] = useSafely(useState<string>());\n\tconst [totpSecret, setTotpSecret] = useSafely(useState<string>());\n\tconst [codesRemaining, setCodesRemaining] = useSafely(useState(0));\n\n\tconst { register, handleSubmit } = useForm({ defaultValues: { authCode: '' } });\n\n\tconst totpEnabled = user?.services?.totp?.enabled;\n\n\tconst closeModal = useCallback(() => setModal(null), [setModal]);\n\n\tuseEffect(() => {\n\t\tconst updateCodesRemaining = async (): Promise<void | boolean> => {\n\t\t\tif (!totpEnabled) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst result = await checkCodesRemainingFn();\n\t\t\tsetCodesRemaining(result.remaining);\n\t\t};\n\t\tupdateCodesRemaining();\n\t}, [checkCodesRemainingFn, setCodesRemaining, totpEnabled]);\n\n\tconst handleEnableTotp = useCallback(async () => {\n\t\ttry {\n\t\t\tconst result = await enableTotpFn();\n\n\t\t\tsetTotpSecret(result.secret);\n\t\t\tsetQrCode(qrcode(result.url, { size: 200 }));\n\n\t\t\tsetRegisteringTotp(true);\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t}, [dispatchToastMessage, enableTotpFn, setQrCode, setRegisteringTotp, setTotpSecret]);\n\n\tconst handleDisableTotp = useCallback(async () => {\n\t\tconst onDisable = async (authCode: string): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tconst result = await disableTotpFn(authCode);\n\n\t\t\t\tif (!result) {\n\t\t\t\t\treturn dispatchToastMessage({ type: 'error', message: t('Invalid_two_factor_code') });\n\t\t\t\t}\n\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Two-factor_authentication_disabled') });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t\tcloseModal();\n\t\t};\n\n\t\tsetModal(<TwoFactorTotpModal onConfirm={onDisable} onClose={closeModal} />);\n\t}, [closeModal, disableTotpFn, dispatchToastMessage, setModal, t]);\n\n\tconst handleVerifyCode = useCallback(\n\t\tasync ({ authCode }) => {\n\t\t\ttry {\n\t\t\t\tconst result = await verifyCodeFn(authCode);\n\n\t\t\t\tif (!result) {\n\t\t\t\t\treturn dispatchToastMessage({ type: 'error', message: t('Invalid_two_factor_code') });\n\t\t\t\t}\n\n\t\t\t\tsetModal(<BackupCodesModal codes={result.codes} onClose={closeModal} />);\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t},\n\t\t[closeModal, dispatchToastMessage, setModal, t, verifyCodeFn],\n\t);\n\n\tconst handleRegenerateCodes = useCallback(() => {\n\t\tconst onRegenerate = async (authCode: string): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tconst result = await regenerateCodesFn(authCode);\n\n\t\t\t\tif (!result) {\n\t\t\t\t\treturn dispatchToastMessage({ type: 'error', message: t('Invalid_two_factor_code') });\n\t\t\t\t}\n\t\t\t\tsetModal(<BackupCodesModal codes={result.codes} onClose={closeModal} />);\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t};\n\n\t\tsetModal(<TwoFactorTotpModal onConfirm={onRegenerate} onClose={closeModal} />);\n\t}, [closeModal, dispatchToastMessage, regenerateCodesFn, setModal, t]);\n\n\treturn (\n\t\t<Box display='flex' flexDirection='column' alignItems='flex-start' {...props}>\n\t\t\t<Margins blockEnd={8}>\n\t\t\t\t<Box fontScale='h4'>{t('Two-factor_authentication_via_TOTP')}</Box>\n\t\t\t\t{!totpEnabled && !registeringTotp && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Box>{t('Two-factor_authentication_is_currently_disabled')}</Box>\n\t\t\t\t\t\t<Button primary onClick={handleEnableTotp}>\n\t\t\t\t\t\t\t{t('Enable_two-factor_authentication')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t\t{!totpEnabled && registeringTotp && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Box>{t('Scan_QR_code')}</Box>\n\t\t\t\t\t\t<Box>{t('Scan_QR_code_alternative_s')}</Box>\n\t\t\t\t\t\t<TextCopy text={totpSecret || ''} />\n\t\t\t\t\t\t<Box is='img' size='x200' src={qrCode} aria-hidden='true' />\n\t\t\t\t\t\t<Box display='flex' flexDirection='row' w='full'>\n\t\t\t\t\t\t\t<TextInput placeholder={t('Enter_authentication_code')} {...register('authCode')} />\n\t\t\t\t\t\t\t<Button primary onClick={handleSubmit(handleVerifyCode)}>\n\t\t\t\t\t\t\t\t{t('Verify')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t\t{totpEnabled && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Button danger onClick={handleDisableTotp}>\n\t\t\t\t\t\t\t{t('Disable_two-factor_authentication')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Box fontScale='p2m' mbs={8}>\n\t\t\t\t\t\t\t{t('Backup_codes')}\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t<Box>{t('You_have_n_codes_remaining', { number: codesRemaining })}</Box>\n\t\t\t\t\t\t<Button onClick={handleRegenerateCodes}>{t('Regenerate_codes')}</Button>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</Margins>\n\t\t</Box>\n\t);\n};\n\nexport default TwoFactorTOTP;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/account/security/TwoFactorTOTP.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/account/security/TwoFactorTOTP.tsx","inputSourceMap":{"version":3,"file":"client/views/account/security/TwoFactorTOTP.tsx","sourceRoot":"","sources":["client/views/account/security/TwoFactorTOTP.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Box, Button, TextInput, Margins } from '@rocket.chat/fuselage';\nimport { useSafely } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useToastMessageDispatch, useUser, useMethod, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement, ComponentProps } from 'react';\nimport React, { useState, useCallback, useEffect } from 'react';\nimport { useForm } from 'react-hook-form';\nimport qrcode from 'yaqrcode';\n\nimport TextCopy from '../../../components/TextCopy';\nimport TwoFactorTotpModal from '../../../components/TwoFactorModal/TwoFactorTotpModal';\nimport BackupCodesModal from './BackupCodesModal';\n\nconst TwoFactorTOTP = (props: ComponentProps<typeof Box>): ReactElement => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst user = useUser();\n\tconst setModal = useSetModal();\n\n\tconst enableTotpFn = useMethod('2fa:enable');\n\tconst disableTotpFn = useMethod('2fa:disable');\n\tconst verifyCodeFn = useMethod('2fa:validateTempToken');\n\tconst checkCodesRemainingFn = useMethod('2fa:checkCodesRemaining');\n\tconst regenerateCodesFn = useMethod('2fa:regenerateCodes');\n\n\tconst [registeringTotp, setRegisteringTotp] = useSafely(useState(false));\n\tconst [qrCode, setQrCode] = useSafely(useState<string>());\n\tconst [totpSecret, setTotpSecret] = useSafely(useState<string>());\n\tconst [codesRemaining, setCodesRemaining] = useSafely(useState(0));\n\n\tconst { register, handleSubmit } = useForm({ defaultValues: { authCode: '' } });\n\n\tconst totpEnabled = user?.services?.totp?.enabled;\n\n\tconst closeModal = useCallback(() => setModal(null), [setModal]);\n\n\tuseEffect(() => {\n\t\tconst updateCodesRemaining = async (): Promise<void | boolean> => {\n\t\t\tif (!totpEnabled) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst result = await checkCodesRemainingFn();\n\t\t\tsetCodesRemaining(result.remaining);\n\t\t};\n\t\tupdateCodesRemaining();\n\t}, [checkCodesRemainingFn, setCodesRemaining, totpEnabled]);\n\n\tconst handleEnableTotp = useCallback(async () => {\n\t\ttry {\n\t\t\tconst result = await enableTotpFn();\n\n\t\t\tsetTotpSecret(result.secret);\n\t\t\tsetQrCode(qrcode(result.url, { size: 200 }));\n\n\t\t\tsetRegisteringTotp(true);\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t}, [dispatchToastMessage, enableTotpFn, setQrCode, setRegisteringTotp, setTotpSecret]);\n\n\tconst handleDisableTotp = useCallback(async () => {\n\t\tconst onDisable = async (authCode: string): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tconst result = await disableTotpFn(authCode);\n\n\t\t\t\tif (!result) {\n\t\t\t\t\treturn dispatchToastMessage({ type: 'error', message: t('Invalid_two_factor_code') });\n\t\t\t\t}\n\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Two-factor_authentication_disabled') });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t\tcloseModal();\n\t\t};\n\n\t\tsetModal(<TwoFactorTotpModal onConfirm={onDisable} onClose={closeModal} />);\n\t}, [closeModal, disableTotpFn, dispatchToastMessage, setModal, t]);\n\n\tconst handleVerifyCode = useCallback(\n\t\tasync ({ authCode }) => {\n\t\t\ttry {\n\t\t\t\tconst result = await verifyCodeFn(authCode);\n\n\t\t\t\tif (!result) {\n\t\t\t\t\treturn dispatchToastMessage({ type: 'error', message: t('Invalid_two_factor_code') });\n\t\t\t\t}\n\n\t\t\t\tsetModal(<BackupCodesModal codes={result.codes} onClose={closeModal} />);\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t},\n\t\t[closeModal, dispatchToastMessage, setModal, t, verifyCodeFn],\n\t);\n\n\tconst handleRegenerateCodes = useCallback(() => {\n\t\tconst onRegenerate = async (authCode: string): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tconst result = await regenerateCodesFn(authCode);\n\n\t\t\t\tif (!result) {\n\t\t\t\t\treturn dispatchToastMessage({ type: 'error', message: t('Invalid_two_factor_code') });\n\t\t\t\t}\n\t\t\t\tsetModal(<BackupCodesModal codes={result.codes} onClose={closeModal} />);\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t};\n\n\t\tsetModal(<TwoFactorTotpModal onConfirm={onRegenerate} onClose={closeModal} />);\n\t}, [closeModal, dispatchToastMessage, regenerateCodesFn, setModal, t]);\n\n\treturn (\n\t\t<Box display='flex' flexDirection='column' alignItems='flex-start' {...props}>\n\t\t\t<Margins blockEnd={8}>\n\t\t\t\t<Box fontScale='h4'>{t('Two-factor_authentication_via_TOTP')}</Box>\n\t\t\t\t{!totpEnabled && !registeringTotp && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Box>{t('Two-factor_authentication_is_currently_disabled')}</Box>\n\t\t\t\t\t\t<Button primary onClick={handleEnableTotp}>\n\t\t\t\t\t\t\t{t('Enable_two-factor_authentication')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t\t{!totpEnabled && registeringTotp && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Box>{t('Scan_QR_code')}</Box>\n\t\t\t\t\t\t<Box>{t('Scan_QR_code_alternative_s')}</Box>\n\t\t\t\t\t\t<TextCopy text={totpSecret || ''} />\n\t\t\t\t\t\t<Box is='img' size='x200' src={qrCode} aria-hidden='true' />\n\t\t\t\t\t\t<Box display='flex' flexDirection='row' w='full'>\n\t\t\t\t\t\t\t<TextInput placeholder={t('Enter_authentication_code')} {...register('authCode')} />\n\t\t\t\t\t\t\t<Button primary onClick={handleSubmit(handleVerifyCode)}>\n\t\t\t\t\t\t\t\t{t('Verify')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t\t{totpEnabled && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Button danger onClick={handleDisableTotp}>\n\t\t\t\t\t\t\t{t('Disable_two-factor_authentication')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Box fontScale='p2m' mbs={8}>\n\t\t\t\t\t\t\t{t('Backup_codes')}\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t<Box>{t('You_have_n_codes_remaining', { number: codesRemaining })}</Box>\n\t\t\t\t\t\t<Button onClick={handleRegenerateCodes}>{t('Regenerate_codes')}</Button>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</Margins>\n\t\t</Box>\n\t);\n};\n\nexport default TwoFactorTOTP;\n"]}}},"code":"let _extends;\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default(v) {\n    _extends = v;\n  }\n}, 0);\nlet Box, Button, TextInput, Margins;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Box(v) {\n    Box = v;\n  },\n  Button(v) {\n    Button = v;\n  },\n  TextInput(v) {\n    TextInput = v;\n  },\n  Margins(v) {\n    Margins = v;\n  }\n}, 0);\nlet useSafely;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useSafely(v) {\n    useSafely = v;\n  }\n}, 1);\nlet useSetModal, useToastMessageDispatch, useUser, useMethod, useTranslation;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useSetModal(v) {\n    useSetModal = v;\n  },\n  useToastMessageDispatch(v) {\n    useToastMessageDispatch = v;\n  },\n  useUser(v) {\n    useUser = v;\n  },\n  useMethod(v) {\n    useMethod = v;\n  },\n  useTranslation(v) {\n    useTranslation = v;\n  }\n}, 2);\nlet React, useState, useCallback, useEffect;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n  useState(v) {\n    useState = v;\n  },\n  useCallback(v) {\n    useCallback = v;\n  },\n  useEffect(v) {\n    useEffect = v;\n  }\n}, 3);\nlet useForm;\nmodule.link(\"react-hook-form\", {\n  useForm(v) {\n    useForm = v;\n  }\n}, 4);\nlet qrcode;\nmodule.link(\"yaqrcode\", {\n  default(v) {\n    qrcode = v;\n  }\n}, 5);\nlet TextCopy;\nmodule.link(\"../../../components/TextCopy\", {\n  default(v) {\n    TextCopy = v;\n  }\n}, 6);\nlet TwoFactorTotpModal;\nmodule.link(\"../../../components/TwoFactorModal/TwoFactorTotpModal\", {\n  default(v) {\n    TwoFactorTotpModal = v;\n  }\n}, 7);\nlet BackupCodesModal;\nmodule.link(\"./BackupCodesModal\", {\n  default(v) {\n    BackupCodesModal = v;\n  }\n}, 8);\nconst TwoFactorTOTP = props => {\n  var _user$services, _user$services$totp;\n  const t = useTranslation();\n  const dispatchToastMessage = useToastMessageDispatch();\n  const user = useUser();\n  const setModal = useSetModal();\n  const enableTotpFn = useMethod('2fa:enable');\n  const disableTotpFn = useMethod('2fa:disable');\n  const verifyCodeFn = useMethod('2fa:validateTempToken');\n  const checkCodesRemainingFn = useMethod('2fa:checkCodesRemaining');\n  const regenerateCodesFn = useMethod('2fa:regenerateCodes');\n  const [registeringTotp, setRegisteringTotp] = useSafely(useState(false));\n  const [qrCode, setQrCode] = useSafely(useState());\n  const [totpSecret, setTotpSecret] = useSafely(useState());\n  const [codesRemaining, setCodesRemaining] = useSafely(useState(0));\n  const {\n    register,\n    handleSubmit\n  } = useForm({\n    defaultValues: {\n      authCode: ''\n    }\n  });\n  const totpEnabled = user === null || user === void 0 ? void 0 : (_user$services = user.services) === null || _user$services === void 0 ? void 0 : (_user$services$totp = _user$services.totp) === null || _user$services$totp === void 0 ? void 0 : _user$services$totp.enabled;\n  const closeModal = useCallback(() => setModal(null), [setModal]);\n  useEffect(() => {\n    const updateCodesRemaining = async () => {\n      if (!totpEnabled) {\n        return false;\n      }\n      const result = await checkCodesRemainingFn();\n      setCodesRemaining(result.remaining);\n    };\n    updateCodesRemaining();\n  }, [checkCodesRemainingFn, setCodesRemaining, totpEnabled]);\n  const handleEnableTotp = useCallback(async () => {\n    try {\n      const result = await enableTotpFn();\n      setTotpSecret(result.secret);\n      setQrCode(qrcode(result.url, {\n        size: 200\n      }));\n      setRegisteringTotp(true);\n    } catch (error) {\n      dispatchToastMessage({\n        type: 'error',\n        message: error\n      });\n    }\n  }, [dispatchToastMessage, enableTotpFn, setQrCode, setRegisteringTotp, setTotpSecret]);\n  const handleDisableTotp = useCallback(async () => {\n    const onDisable = async authCode => {\n      try {\n        const result = await disableTotpFn(authCode);\n        if (!result) {\n          return dispatchToastMessage({\n            type: 'error',\n            message: t('Invalid_two_factor_code')\n          });\n        }\n        dispatchToastMessage({\n          type: 'success',\n          message: t('Two-factor_authentication_disabled')\n        });\n      } catch (error) {\n        dispatchToastMessage({\n          type: 'error',\n          message: error\n        });\n      }\n      closeModal();\n    };\n    setModal( /*#__PURE__*/React.createElement(TwoFactorTotpModal, {\n      onConfirm: onDisable,\n      onClose: closeModal\n    }));\n  }, [closeModal, disableTotpFn, dispatchToastMessage, setModal, t]);\n  const handleVerifyCode = useCallback(async _ref => {\n    let {\n      authCode\n    } = _ref;\n    try {\n      const result = await verifyCodeFn(authCode);\n      if (!result) {\n        return dispatchToastMessage({\n          type: 'error',\n          message: t('Invalid_two_factor_code')\n        });\n      }\n      setModal( /*#__PURE__*/React.createElement(BackupCodesModal, {\n        codes: result.codes,\n        onClose: closeModal\n      }));\n    } catch (error) {\n      dispatchToastMessage({\n        type: 'error',\n        message: error\n      });\n    }\n  }, [closeModal, dispatchToastMessage, setModal, t, verifyCodeFn]);\n  const handleRegenerateCodes = useCallback(() => {\n    const onRegenerate = async authCode => {\n      try {\n        const result = await regenerateCodesFn(authCode);\n        if (!result) {\n          return dispatchToastMessage({\n            type: 'error',\n            message: t('Invalid_two_factor_code')\n          });\n        }\n        setModal( /*#__PURE__*/React.createElement(BackupCodesModal, {\n          codes: result.codes,\n          onClose: closeModal\n        }));\n      } catch (error) {\n        dispatchToastMessage({\n          type: 'error',\n          message: error\n        });\n      }\n    };\n    setModal( /*#__PURE__*/React.createElement(TwoFactorTotpModal, {\n      onConfirm: onRegenerate,\n      onClose: closeModal\n    }));\n  }, [closeModal, dispatchToastMessage, regenerateCodesFn, setModal, t]);\n  return /*#__PURE__*/React.createElement(Box, _extends({\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"flex-start\"\n  }, props), /*#__PURE__*/React.createElement(Margins, {\n    blockEnd: 8\n  }, /*#__PURE__*/React.createElement(Box, {\n    fontScale: \"h4\"\n  }, t('Two-factor_authentication_via_TOTP')), !totpEnabled && !registeringTotp && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Box, null, t('Two-factor_authentication_is_currently_disabled')), /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    onClick: handleEnableTotp\n  }, t('Enable_two-factor_authentication'))), !totpEnabled && registeringTotp && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Box, null, t('Scan_QR_code')), /*#__PURE__*/React.createElement(Box, null, t('Scan_QR_code_alternative_s')), /*#__PURE__*/React.createElement(TextCopy, {\n    text: totpSecret || ''\n  }), /*#__PURE__*/React.createElement(Box, {\n    is: \"img\",\n    size: \"x200\",\n    src: qrCode,\n    \"aria-hidden\": \"true\"\n  }), /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"row\",\n    w: \"full\"\n  }, /*#__PURE__*/React.createElement(TextInput, _extends({\n    placeholder: t('Enter_authentication_code')\n  }, register('authCode'))), /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    onClick: handleSubmit(handleVerifyCode)\n  }, t('Verify')))), totpEnabled && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Button, {\n    danger: true,\n    onClick: handleDisableTotp\n  }, t('Disable_two-factor_authentication')), /*#__PURE__*/React.createElement(Box, {\n    fontScale: \"p2m\",\n    mbs: 8\n  }, t('Backup_codes')), /*#__PURE__*/React.createElement(Box, null, t('You_have_n_codes_remaining', {\n    number: codesRemaining\n  })), /*#__PURE__*/React.createElement(Button, {\n    onClick: handleRegenerateCodes\n  }, t('Regenerate_codes')))));\n};\nmodule.exportDefault(TwoFactorTOTP);","map":{"version":3,"names":["_extends","module","link","default","v","Box","Button","TextInput","Margins","useSafely","useSetModal","useToastMessageDispatch","useUser","useMethod","useTranslation","React","useState","useCallback","useEffect","useForm","qrcode","TextCopy","TwoFactorTotpModal","BackupCodesModal","TwoFactorTOTP","props","_user$services","_user$services$totp","t","dispatchToastMessage","user","setModal","enableTotpFn","disableTotpFn","verifyCodeFn","checkCodesRemainingFn","regenerateCodesFn","registeringTotp","setRegisteringTotp","qrCode","setQrCode","totpSecret","setTotpSecret","codesRemaining","setCodesRemaining","register","handleSubmit","defaultValues","authCode","totpEnabled","services","totp","enabled","closeModal","updateCodesRemaining","result","remaining","handleEnableTotp","secret","url","size","error","type","message","handleDisableTotp","onDisable","createElement","onConfirm","onClose","handleVerifyCode","_ref","codes","handleRegenerateCodes","onRegenerate","display","flexDirection","alignItems","blockEnd","fontScale","Fragment","primary","onClick","text","is","src","w","placeholder","danger","mbs","number","exportDefault"],"sources":["client/views/account/security/TwoFactorTOTP.tsx"],"sourcesContent":["import { Box, Button, TextInput, Margins } from '@rocket.chat/fuselage';\nimport { useSafely } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useToastMessageDispatch, useUser, useMethod, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement, ComponentProps } from 'react';\nimport React, { useState, useCallback, useEffect } from 'react';\nimport { useForm } from 'react-hook-form';\nimport qrcode from 'yaqrcode';\n\nimport TextCopy from '../../../components/TextCopy';\nimport TwoFactorTotpModal from '../../../components/TwoFactorModal/TwoFactorTotpModal';\nimport BackupCodesModal from './BackupCodesModal';\n\nconst TwoFactorTOTP = (props: ComponentProps<typeof Box>): ReactElement => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst user = useUser();\n\tconst setModal = useSetModal();\n\n\tconst enableTotpFn = useMethod('2fa:enable');\n\tconst disableTotpFn = useMethod('2fa:disable');\n\tconst verifyCodeFn = useMethod('2fa:validateTempToken');\n\tconst checkCodesRemainingFn = useMethod('2fa:checkCodesRemaining');\n\tconst regenerateCodesFn = useMethod('2fa:regenerateCodes');\n\n\tconst [registeringTotp, setRegisteringTotp] = useSafely(useState(false));\n\tconst [qrCode, setQrCode] = useSafely(useState<string>());\n\tconst [totpSecret, setTotpSecret] = useSafely(useState<string>());\n\tconst [codesRemaining, setCodesRemaining] = useSafely(useState(0));\n\n\tconst { register, handleSubmit } = useForm({ defaultValues: { authCode: '' } });\n\n\tconst totpEnabled = user?.services?.totp?.enabled;\n\n\tconst closeModal = useCallback(() => setModal(null), [setModal]);\n\n\tuseEffect(() => {\n\t\tconst updateCodesRemaining = async (): Promise<void | boolean> => {\n\t\t\tif (!totpEnabled) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst result = await checkCodesRemainingFn();\n\t\t\tsetCodesRemaining(result.remaining);\n\t\t};\n\t\tupdateCodesRemaining();\n\t}, [checkCodesRemainingFn, setCodesRemaining, totpEnabled]);\n\n\tconst handleEnableTotp = useCallback(async () => {\n\t\ttry {\n\t\t\tconst result = await enableTotpFn();\n\n\t\t\tsetTotpSecret(result.secret);\n\t\t\tsetQrCode(qrcode(result.url, { size: 200 }));\n\n\t\t\tsetRegisteringTotp(true);\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t}, [dispatchToastMessage, enableTotpFn, setQrCode, setRegisteringTotp, setTotpSecret]);\n\n\tconst handleDisableTotp = useCallback(async () => {\n\t\tconst onDisable = async (authCode: string): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tconst result = await disableTotpFn(authCode);\n\n\t\t\t\tif (!result) {\n\t\t\t\t\treturn dispatchToastMessage({ type: 'error', message: t('Invalid_two_factor_code') });\n\t\t\t\t}\n\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Two-factor_authentication_disabled') });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t\tcloseModal();\n\t\t};\n\n\t\tsetModal(<TwoFactorTotpModal onConfirm={onDisable} onClose={closeModal} />);\n\t}, [closeModal, disableTotpFn, dispatchToastMessage, setModal, t]);\n\n\tconst handleVerifyCode = useCallback(\n\t\tasync ({ authCode }) => {\n\t\t\ttry {\n\t\t\t\tconst result = await verifyCodeFn(authCode);\n\n\t\t\t\tif (!result) {\n\t\t\t\t\treturn dispatchToastMessage({ type: 'error', message: t('Invalid_two_factor_code') });\n\t\t\t\t}\n\n\t\t\t\tsetModal(<BackupCodesModal codes={result.codes} onClose={closeModal} />);\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t},\n\t\t[closeModal, dispatchToastMessage, setModal, t, verifyCodeFn],\n\t);\n\n\tconst handleRegenerateCodes = useCallback(() => {\n\t\tconst onRegenerate = async (authCode: string): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tconst result = await regenerateCodesFn(authCode);\n\n\t\t\t\tif (!result) {\n\t\t\t\t\treturn dispatchToastMessage({ type: 'error', message: t('Invalid_two_factor_code') });\n\t\t\t\t}\n\t\t\t\tsetModal(<BackupCodesModal codes={result.codes} onClose={closeModal} />);\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t};\n\n\t\tsetModal(<TwoFactorTotpModal onConfirm={onRegenerate} onClose={closeModal} />);\n\t}, [closeModal, dispatchToastMessage, regenerateCodesFn, setModal, t]);\n\n\treturn (\n\t\t<Box display='flex' flexDirection='column' alignItems='flex-start' {...props}>\n\t\t\t<Margins blockEnd={8}>\n\t\t\t\t<Box fontScale='h4'>{t('Two-factor_authentication_via_TOTP')}</Box>\n\t\t\t\t{!totpEnabled && !registeringTotp && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Box>{t('Two-factor_authentication_is_currently_disabled')}</Box>\n\t\t\t\t\t\t<Button primary onClick={handleEnableTotp}>\n\t\t\t\t\t\t\t{t('Enable_two-factor_authentication')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t\t{!totpEnabled && registeringTotp && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Box>{t('Scan_QR_code')}</Box>\n\t\t\t\t\t\t<Box>{t('Scan_QR_code_alternative_s')}</Box>\n\t\t\t\t\t\t<TextCopy text={totpSecret || ''} />\n\t\t\t\t\t\t<Box is='img' size='x200' src={qrCode} aria-hidden='true' />\n\t\t\t\t\t\t<Box display='flex' flexDirection='row' w='full'>\n\t\t\t\t\t\t\t<TextInput placeholder={t('Enter_authentication_code')} {...register('authCode')} />\n\t\t\t\t\t\t\t<Button primary onClick={handleSubmit(handleVerifyCode)}>\n\t\t\t\t\t\t\t\t{t('Verify')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t\t{totpEnabled && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Button danger onClick={handleDisableTotp}>\n\t\t\t\t\t\t\t{t('Disable_two-factor_authentication')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Box fontScale='p2m' mbs={8}>\n\t\t\t\t\t\t\t{t('Backup_codes')}\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t<Box>{t('You_have_n_codes_remaining', { number: codesRemaining })}</Box>\n\t\t\t\t\t\t<Button onClick={handleRegenerateCodes}>{t('Regenerate_codes')}</Button>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</Margins>\n\t\t</Box>\n\t);\n};\n\nexport default TwoFactorTOTP;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"586352985088c87ef6481ce17fff99605da53015"}
