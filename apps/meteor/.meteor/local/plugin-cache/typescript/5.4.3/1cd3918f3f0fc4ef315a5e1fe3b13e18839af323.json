{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/ComposerMessage.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/room/composer/ComposerMessage.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/ComposerMessage.tsx","inputSourceMap":{"version":3,"file":"client/views/room/composer/ComposerMessage.tsx","sourceRoot":"","sources":["client/views/room/composer/ComposerMessage.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IMessage, ISubscription } from '@rocket.chat/core-typings';\nimport { useToastMessageDispatch } from '@rocket.chat/ui-contexts';\nimport type { ReactElement, ReactNode } from 'react';\nimport React, { memo, useCallback, useMemo } from 'react';\n\nimport ComposerSkeleton from './ComposerSkeleton';\nimport { LegacyRoomManager } from '../../../../app/ui-utils/client';\nimport { useReactiveValue } from '../../../hooks/useReactiveValue';\nimport { useChat } from '../contexts/ChatContext';\nimport { useRoom } from '../contexts/RoomContext';\nimport MessageBox from './messageBox/MessageBox';\n\nexport type ComposerMessageProps = {\n\ttmid?: IMessage['_id'];\n\tchildren?: ReactNode;\n\tsubscription?: ISubscription;\n\ttshow?: boolean;\n\tpreviewUrls?: string[];\n\tonResize?: () => void;\n\tonEscape?: () => void;\n\tonSend?: () => void;\n\tonNavigateToNextMessage?: () => void;\n\tonNavigateToPreviousMessage?: () => void;\n\tonUploadFiles?: (files: readonly File[]) => void;\n};\n\nconst ComposerMessage = ({ tmid, onSend, ...props }: ComposerMessageProps): ReactElement => {\n\tconst chat = useChat();\n\tconst room = useRoom();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst composerProps = useMemo(\n\t\t() => ({\n\t\t\tonJoin: async (): Promise<void> => {\n\t\t\t\ttry {\n\t\t\t\t\tawait chat?.data?.joinRoom();\n\t\t\t\t} catch (error) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonSend: async ({\n\t\t\t\tvalue: text,\n\t\t\t\ttshow,\n\t\t\t\tpreviewUrls,\n\t\t\t\tisSlashCommandAllowed,\n\t\t\t}: {\n\t\t\t\tvalue: string;\n\t\t\t\ttshow?: boolean;\n\t\t\t\tpreviewUrls?: string[];\n\t\t\t\tisSlashCommandAllowed?: boolean;\n\t\t\t}): Promise<void> => {\n\t\t\t\ttry {\n\t\t\t\t\tawait chat?.action.stop('typing');\n\t\t\t\t\tconst newMessageSent = await chat?.flows.sendMessage({\n\t\t\t\t\t\ttext,\n\t\t\t\t\t\ttshow,\n\t\t\t\t\t\tpreviewUrls,\n\t\t\t\t\t\tisSlashCommandAllowed,\n\t\t\t\t\t});\n\t\t\t\t\tif (newMessageSent) onSend?.();\n\t\t\t\t} catch (error) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t}\n\t\t\t},\n\t\t\tonTyping: async (): Promise<void> => {\n\t\t\t\tif (chat?.composer?.text?.trim() === '') {\n\t\t\t\t\tawait chat?.action.stop('typing');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tawait chat?.action.start('typing');\n\t\t\t},\n\t\t\tonNavigateToPreviousMessage: () => chat?.messageEditing.toPreviousMessage(),\n\t\t\tonNavigateToNextMessage: () => chat?.messageEditing.toNextMessage(),\n\t\t\tonUploadFiles: (files: readonly File[]) => {\n\t\t\t\treturn chat?.flows.uploadFiles(files);\n\t\t\t},\n\t\t}),\n\t\t[chat?.data, chat?.flows, chat?.action, chat?.composer?.text, chat?.messageEditing, dispatchToastMessage, onSend],\n\t);\n\n\tconst publicationReady = useReactiveValue(\n\t\tuseCallback(() => LegacyRoomManager.getOpenedRoomByRid(room._id)?.streamActive ?? false, [room._id]),\n\t);\n\n\tif (!publicationReady) {\n\t\treturn <ComposerSkeleton />;\n\t}\n\n\treturn <MessageBox key={room._id} tmid={tmid} {...composerProps} showFormattingTips={true} {...props} />;\n};\n\nexport default memo(ComposerMessage);\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/ComposerMessage.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/composer/ComposerMessage.tsx","inputSourceMap":{"version":3,"file":"client/views/room/composer/ComposerMessage.tsx","sourceRoot":"","sources":["client/views/room/composer/ComposerMessage.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IMessage, ISubscription } from '@rocket.chat/core-typings';\nimport { useToastMessageDispatch } from '@rocket.chat/ui-contexts';\nimport type { ReactElement, ReactNode } from 'react';\nimport React, { memo, useCallback, useMemo } from 'react';\n\nimport ComposerSkeleton from './ComposerSkeleton';\nimport { LegacyRoomManager } from '../../../../app/ui-utils/client';\nimport { useReactiveValue } from '../../../hooks/useReactiveValue';\nimport { useChat } from '../contexts/ChatContext';\nimport { useRoom } from '../contexts/RoomContext';\nimport MessageBox from './messageBox/MessageBox';\n\nexport type ComposerMessageProps = {\n\ttmid?: IMessage['_id'];\n\tchildren?: ReactNode;\n\tsubscription?: ISubscription;\n\ttshow?: boolean;\n\tpreviewUrls?: string[];\n\tonResize?: () => void;\n\tonEscape?: () => void;\n\tonSend?: () => void;\n\tonNavigateToNextMessage?: () => void;\n\tonNavigateToPreviousMessage?: () => void;\n\tonUploadFiles?: (files: readonly File[]) => void;\n};\n\nconst ComposerMessage = ({ tmid, onSend, ...props }: ComposerMessageProps): ReactElement => {\n\tconst chat = useChat();\n\tconst room = useRoom();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst composerProps = useMemo(\n\t\t() => ({\n\t\t\tonJoin: async (): Promise<void> => {\n\t\t\t\ttry {\n\t\t\t\t\tawait chat?.data?.joinRoom();\n\t\t\t\t} catch (error) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonSend: async ({\n\t\t\t\tvalue: text,\n\t\t\t\ttshow,\n\t\t\t\tpreviewUrls,\n\t\t\t\tisSlashCommandAllowed,\n\t\t\t}: {\n\t\t\t\tvalue: string;\n\t\t\t\ttshow?: boolean;\n\t\t\t\tpreviewUrls?: string[];\n\t\t\t\tisSlashCommandAllowed?: boolean;\n\t\t\t}): Promise<void> => {\n\t\t\t\ttry {\n\t\t\t\t\tawait chat?.action.stop('typing');\n\t\t\t\t\tconst newMessageSent = await chat?.flows.sendMessage({\n\t\t\t\t\t\ttext,\n\t\t\t\t\t\ttshow,\n\t\t\t\t\t\tpreviewUrls,\n\t\t\t\t\t\tisSlashCommandAllowed,\n\t\t\t\t\t});\n\t\t\t\t\tif (newMessageSent) onSend?.();\n\t\t\t\t} catch (error) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t}\n\t\t\t},\n\t\t\tonTyping: async (): Promise<void> => {\n\t\t\t\tif (chat?.composer?.text?.trim() === '') {\n\t\t\t\t\tawait chat?.action.stop('typing');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tawait chat?.action.start('typing');\n\t\t\t},\n\t\t\tonNavigateToPreviousMessage: () => chat?.messageEditing.toPreviousMessage(),\n\t\t\tonNavigateToNextMessage: () => chat?.messageEditing.toNextMessage(),\n\t\t\tonUploadFiles: (files: readonly File[]) => {\n\t\t\t\treturn chat?.flows.uploadFiles(files);\n\t\t\t},\n\t\t}),\n\t\t[chat?.data, chat?.flows, chat?.action, chat?.composer?.text, chat?.messageEditing, dispatchToastMessage, onSend],\n\t);\n\n\tconst publicationReady = useReactiveValue(\n\t\tuseCallback(() => LegacyRoomManager.getOpenedRoomByRid(room._id)?.streamActive ?? false, [room._id]),\n\t);\n\n\tif (!publicationReady) {\n\t\treturn <ComposerSkeleton />;\n\t}\n\n\treturn <MessageBox key={room._id} tmid={tmid} {...composerProps} showFormattingTips={true} {...props} />;\n};\n\nexport default memo(ComposerMessage);\n"]}}},"code":"const _excluded = [\"tmid\", \"onSend\"];\nlet _extends;\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default(v) {\n    _extends = v;\n  }\n}, 0);\nlet _objectWithoutProperties;\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default(v) {\n    _objectWithoutProperties = v;\n  }\n}, 1);\nlet useToastMessageDispatch;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useToastMessageDispatch(v) {\n    useToastMessageDispatch = v;\n  }\n}, 0);\nlet React, memo, useCallback, useMemo;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n  memo(v) {\n    memo = v;\n  },\n  useCallback(v) {\n    useCallback = v;\n  },\n  useMemo(v) {\n    useMemo = v;\n  }\n}, 1);\nlet ComposerSkeleton;\nmodule.link(\"./ComposerSkeleton\", {\n  default(v) {\n    ComposerSkeleton = v;\n  }\n}, 2);\nlet LegacyRoomManager;\nmodule.link(\"../../../../app/ui-utils/client\", {\n  LegacyRoomManager(v) {\n    LegacyRoomManager = v;\n  }\n}, 3);\nlet useReactiveValue;\nmodule.link(\"../../../hooks/useReactiveValue\", {\n  useReactiveValue(v) {\n    useReactiveValue = v;\n  }\n}, 4);\nlet useChat;\nmodule.link(\"../contexts/ChatContext\", {\n  useChat(v) {\n    useChat = v;\n  }\n}, 5);\nlet useRoom;\nmodule.link(\"../contexts/RoomContext\", {\n  useRoom(v) {\n    useRoom = v;\n  }\n}, 6);\nlet MessageBox;\nmodule.link(\"./messageBox/MessageBox\", {\n  default(v) {\n    MessageBox = v;\n  }\n}, 7);\nconst ComposerMessage = _ref => {\n  var _chat$composer2;\n  let {\n      tmid,\n      onSend\n    } = _ref,\n    props = _objectWithoutProperties(_ref, _excluded);\n  const chat = useChat();\n  const room = useRoom();\n  const dispatchToastMessage = useToastMessageDispatch();\n  const composerProps = useMemo(() => ({\n    onJoin: async () => {\n      try {\n        var _chat$data;\n        await (chat === null || chat === void 0 ? void 0 : (_chat$data = chat.data) === null || _chat$data === void 0 ? void 0 : _chat$data.joinRoom());\n      } catch (error) {\n        dispatchToastMessage({\n          type: 'error',\n          message: error\n        });\n        throw error;\n      }\n    },\n    onSend: async _ref2 => {\n      let {\n        value: text,\n        tshow,\n        previewUrls,\n        isSlashCommandAllowed\n      } = _ref2;\n      try {\n        await (chat === null || chat === void 0 ? void 0 : chat.action.stop('typing'));\n        const newMessageSent = await (chat === null || chat === void 0 ? void 0 : chat.flows.sendMessage({\n          text,\n          tshow,\n          previewUrls,\n          isSlashCommandAllowed\n        }));\n        if (newMessageSent) onSend === null || onSend === void 0 ? void 0 : onSend();\n      } catch (error) {\n        dispatchToastMessage({\n          type: 'error',\n          message: error\n        });\n      }\n    },\n    onTyping: async () => {\n      var _chat$composer, _chat$composer$text;\n      if ((chat === null || chat === void 0 ? void 0 : (_chat$composer = chat.composer) === null || _chat$composer === void 0 ? void 0 : (_chat$composer$text = _chat$composer.text) === null || _chat$composer$text === void 0 ? void 0 : _chat$composer$text.trim()) === '') {\n        await (chat === null || chat === void 0 ? void 0 : chat.action.stop('typing'));\n        return;\n      }\n      await (chat === null || chat === void 0 ? void 0 : chat.action.start('typing'));\n    },\n    onNavigateToPreviousMessage: () => chat === null || chat === void 0 ? void 0 : chat.messageEditing.toPreviousMessage(),\n    onNavigateToNextMessage: () => chat === null || chat === void 0 ? void 0 : chat.messageEditing.toNextMessage(),\n    onUploadFiles: files => {\n      return chat === null || chat === void 0 ? void 0 : chat.flows.uploadFiles(files);\n    }\n  }), [chat === null || chat === void 0 ? void 0 : chat.data, chat === null || chat === void 0 ? void 0 : chat.flows, chat === null || chat === void 0 ? void 0 : chat.action, chat === null || chat === void 0 ? void 0 : (_chat$composer2 = chat.composer) === null || _chat$composer2 === void 0 ? void 0 : _chat$composer2.text, chat === null || chat === void 0 ? void 0 : chat.messageEditing, dispatchToastMessage, onSend]);\n  const publicationReady = useReactiveValue(useCallback(() => {\n    var _LegacyRoomManager$ge, _LegacyRoomManager$ge2;\n    return (_LegacyRoomManager$ge = (_LegacyRoomManager$ge2 = LegacyRoomManager.getOpenedRoomByRid(room._id)) === null || _LegacyRoomManager$ge2 === void 0 ? void 0 : _LegacyRoomManager$ge2.streamActive) !== null && _LegacyRoomManager$ge !== void 0 ? _LegacyRoomManager$ge : false;\n  }, [room._id]));\n  if (!publicationReady) {\n    return /*#__PURE__*/React.createElement(ComposerSkeleton, null);\n  }\n  return /*#__PURE__*/React.createElement(MessageBox, _extends({\n    key: room._id,\n    tmid: tmid\n  }, composerProps, {\n    showFormattingTips: true\n  }, props));\n};\nmodule.exportDefault( /*#__PURE__*/memo(ComposerMessage));","map":{"version":3,"names":["_extends","module","link","default","v","_objectWithoutProperties","useToastMessageDispatch","React","memo","useCallback","useMemo","ComposerSkeleton","LegacyRoomManager","useReactiveValue","useChat","useRoom","MessageBox","ComposerMessage","_ref","_chat$composer2","tmid","onSend","props","_excluded","chat","room","dispatchToastMessage","composerProps","onJoin","_chat$data","data","joinRoom","error","type","message","_ref2","value","text","tshow","previewUrls","isSlashCommandAllowed","action","stop","newMessageSent","flows","sendMessage","onTyping","_chat$composer","_chat$composer$text","composer","trim","start","onNavigateToPreviousMessage","messageEditing","toPreviousMessage","onNavigateToNextMessage","toNextMessage","onUploadFiles","files","uploadFiles","publicationReady","_LegacyRoomManager$ge","_LegacyRoomManager$ge2","getOpenedRoomByRid","_id","streamActive","createElement","key","showFormattingTips","exportDefault"],"sources":["client/views/room/composer/ComposerMessage.tsx"],"sourcesContent":["import type { IMessage, ISubscription } from '@rocket.chat/core-typings';\nimport { useToastMessageDispatch } from '@rocket.chat/ui-contexts';\nimport type { ReactElement, ReactNode } from 'react';\nimport React, { memo, useCallback, useMemo } from 'react';\n\nimport ComposerSkeleton from './ComposerSkeleton';\nimport { LegacyRoomManager } from '../../../../app/ui-utils/client';\nimport { useReactiveValue } from '../../../hooks/useReactiveValue';\nimport { useChat } from '../contexts/ChatContext';\nimport { useRoom } from '../contexts/RoomContext';\nimport MessageBox from './messageBox/MessageBox';\n\nexport type ComposerMessageProps = {\n\ttmid?: IMessage['_id'];\n\tchildren?: ReactNode;\n\tsubscription?: ISubscription;\n\ttshow?: boolean;\n\tpreviewUrls?: string[];\n\tonResize?: () => void;\n\tonEscape?: () => void;\n\tonSend?: () => void;\n\tonNavigateToNextMessage?: () => void;\n\tonNavigateToPreviousMessage?: () => void;\n\tonUploadFiles?: (files: readonly File[]) => void;\n};\n\nconst ComposerMessage = ({ tmid, onSend, ...props }: ComposerMessageProps): ReactElement => {\n\tconst chat = useChat();\n\tconst room = useRoom();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst composerProps = useMemo(\n\t\t() => ({\n\t\t\tonJoin: async (): Promise<void> => {\n\t\t\t\ttry {\n\t\t\t\t\tawait chat?.data?.joinRoom();\n\t\t\t\t} catch (error) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonSend: async ({\n\t\t\t\tvalue: text,\n\t\t\t\ttshow,\n\t\t\t\tpreviewUrls,\n\t\t\t\tisSlashCommandAllowed,\n\t\t\t}: {\n\t\t\t\tvalue: string;\n\t\t\t\ttshow?: boolean;\n\t\t\t\tpreviewUrls?: string[];\n\t\t\t\tisSlashCommandAllowed?: boolean;\n\t\t\t}): Promise<void> => {\n\t\t\t\ttry {\n\t\t\t\t\tawait chat?.action.stop('typing');\n\t\t\t\t\tconst newMessageSent = await chat?.flows.sendMessage({\n\t\t\t\t\t\ttext,\n\t\t\t\t\t\ttshow,\n\t\t\t\t\t\tpreviewUrls,\n\t\t\t\t\t\tisSlashCommandAllowed,\n\t\t\t\t\t});\n\t\t\t\t\tif (newMessageSent) onSend?.();\n\t\t\t\t} catch (error) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t}\n\t\t\t},\n\t\t\tonTyping: async (): Promise<void> => {\n\t\t\t\tif (chat?.composer?.text?.trim() === '') {\n\t\t\t\t\tawait chat?.action.stop('typing');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tawait chat?.action.start('typing');\n\t\t\t},\n\t\t\tonNavigateToPreviousMessage: () => chat?.messageEditing.toPreviousMessage(),\n\t\t\tonNavigateToNextMessage: () => chat?.messageEditing.toNextMessage(),\n\t\t\tonUploadFiles: (files: readonly File[]) => {\n\t\t\t\treturn chat?.flows.uploadFiles(files);\n\t\t\t},\n\t\t}),\n\t\t[chat?.data, chat?.flows, chat?.action, chat?.composer?.text, chat?.messageEditing, dispatchToastMessage, onSend],\n\t);\n\n\tconst publicationReady = useReactiveValue(\n\t\tuseCallback(() => LegacyRoomManager.getOpenedRoomByRid(room._id)?.streamActive ?? false, [room._id]),\n\t);\n\n\tif (!publicationReady) {\n\t\treturn <ComposerSkeleton />;\n\t}\n\n\treturn <MessageBox key={room._id} tmid={tmid} {...composerProps} showFormattingTips={true} {...props} />;\n};\n\nexport default memo(ComposerMessage);\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"1cd3918f3f0fc4ef315a5e1fe3b13e18839af323"}
