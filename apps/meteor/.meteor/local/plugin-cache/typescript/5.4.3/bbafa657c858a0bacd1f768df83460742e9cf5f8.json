{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/ui-utils/client/lib/messageActionDefault.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"app/ui-utils/client/lib/messageActionDefault.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/ui-utils/client/lib/messageActionDefault.ts","inputSourceMap":{"version":3,"file":"app/ui-utils/client/lib/messageActionDefault.ts","sourceRoot":"","sources":["app/ui-utils/client/lib/messageActionDefault.ts"],"names":[],"mappings":"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","sourcesContent":["import type { IMessage } from '@rocket.chat/core-typings';\nimport { isE2EEMessage, isRoomFederated } from '@rocket.chat/core-typings';\nimport { Meteor } from 'meteor/meteor';\nimport moment from 'moment';\n\nimport { getPermaLink } from '../../../../client/lib/getPermaLink';\nimport { imperativeModal } from '../../../../client/lib/imperativeModal';\nimport { roomCoordinator } from '../../../../client/lib/rooms/roomCoordinator';\nimport { dispatchToastMessage } from '../../../../client/lib/toast';\nimport { messageArgs } from '../../../../client/lib/utils/messageArgs';\nimport { router } from '../../../../client/providers/RouterProvider';\nimport ForwardMessageModal from '../../../../client/views/room/modals/ForwardMessageModal/ForwardMessageModal';\nimport ReactionListModal from '../../../../client/views/room/modals/ReactionListModal';\nimport ReportMessageModal from '../../../../client/views/room/modals/ReportMessageModal';\nimport { hasAtLeastOnePermission, hasPermission } from '../../../authorization/client';\nimport { ChatRoom, Subscriptions } from '../../../models/client';\nimport { t } from '../../../utils/lib/i18n';\nimport { MessageAction } from './MessageAction';\n\nconst getMainMessageText = (message: IMessage): IMessage => {\n\tconst newMessage = { ...message };\n\tnewMessage.msg = newMessage.msg || newMessage.attachments?.[0]?.description || newMessage.attachments?.[0]?.title || '';\n\tnewMessage.md = newMessage.md || newMessage.attachments?.[0]?.descriptionMd || undefined;\n\treturn { ...newMessage };\n};\n\nMeteor.startup(async () => {\n\tMessageAction.addButton({\n\t\tid: 'reply-directly',\n\t\ticon: 'reply-directly',\n\t\tlabel: 'Reply_in_direct_message',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated'],\n\t\trole: 'link',\n\t\ttype: 'communication',\n\t\taction(_, props) {\n\t\t\tconst { message = messageArgs(this).msg } = props;\n\t\t\troomCoordinator.openRouteLink(\n\t\t\t\t'd',\n\t\t\t\t{ name: message.u.username },\n\t\t\t\t{\n\t\t\t\t\t...router.getSearchParameters(),\n\t\t\t\t\treply: message._id,\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tcondition({ subscription, room, message, user }) {\n\t\t\tif (subscription == null) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (room.t === 'd' || room.t === 'l') {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Check if we already have a DM started with the message user (not ourselves) or we can start one\n\t\t\tif (!!user && user._id !== message.u._id && !hasPermission('create-d')) {\n\t\t\t\tconst dmRoom = ChatRoom.findOne({ _id: [user._id, message.u._id].sort().join('') });\n\t\t\t\tif (!dmRoom || !Subscriptions.findOne({ 'rid': dmRoom._id, 'u._id': user._id })) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\torder: 0,\n\t\tgroup: 'menu',\n\t\tdisabled({ message }) {\n\t\t\treturn isE2EEMessage(message);\n\t\t},\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'forward-message',\n\t\ticon: 'arrow-forward',\n\t\tlabel: 'Forward_message',\n\t\tcontext: ['message', 'message-mobile', 'threads'],\n\t\ttype: 'communication',\n\t\tasync action(_, props) {\n\t\t\tconst { message = messageArgs(this).msg } = props;\n\t\t\tconst permalink = await getPermaLink(message._id);\n\t\t\timperativeModal.open({\n\t\t\t\tcomponent: ForwardMessageModal,\n\t\t\t\tprops: {\n\t\t\t\t\tmessage,\n\t\t\t\t\tpermalink,\n\t\t\t\t\tonClose: (): void => {\n\t\t\t\t\t\timperativeModal.close();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\torder: 0,\n\t\tgroup: 'message',\n\t\tdisabled({ message }) {\n\t\t\treturn isE2EEMessage(message);\n\t\t},\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'quote-message',\n\t\ticon: 'quote',\n\t\tlabel: 'Quote',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated'],\n\t\tasync action(_, props) {\n\t\t\tconst { message = messageArgs(this).msg, chat, autoTranslateOptions } = props;\n\n\t\t\tif (message && autoTranslateOptions?.autoTranslateEnabled && autoTranslateOptions.showAutoTranslate(message)) {\n\t\t\t\tmessage.msg =\n\t\t\t\t\tmessage.translations && autoTranslateOptions.autoTranslateLanguage\n\t\t\t\t\t\t? message.translations[autoTranslateOptions.autoTranslateLanguage]\n\t\t\t\t\t\t: message.msg;\n\t\t\t}\n\n\t\t\tawait chat?.composer?.quoteMessage(message);\n\t\t},\n\t\tcondition({ subscription }) {\n\t\t\tif (subscription == null) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\torder: -2,\n\t\tgroup: 'message',\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'permalink',\n\t\ticon: 'permalink',\n\t\tlabel: 'Copy_link',\n\t\t// classes: 'clipboard',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated', 'videoconf', 'videoconf-threads'],\n\t\ttype: 'duplication',\n\t\tasync action(_, props) {\n\t\t\ttry {\n\t\t\t\tconst { message = messageArgs(this).msg } = props;\n\t\t\t\tconst permalink = await getPermaLink(message._id);\n\t\t\t\tawait navigator.clipboard.writeText(permalink);\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Copied') });\n\t\t\t} catch (e) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: e });\n\t\t\t}\n\t\t},\n\t\tcondition({ subscription }) {\n\t\t\treturn !!subscription;\n\t\t},\n\t\torder: 5,\n\t\tgroup: 'menu',\n\t\tdisabled({ message }) {\n\t\t\treturn isE2EEMessage(message);\n\t\t},\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'copy',\n\t\ticon: 'copy',\n\t\tlabel: 'Copy_text',\n\t\t// classes: 'clipboard',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated'],\n\t\ttype: 'duplication',\n\t\tasync action(_, props) {\n\t\t\tconst { message = messageArgs(this).msg } = props;\n\t\t\tconst msgText = getMainMessageText(message).msg;\n\t\t\tawait navigator.clipboard.writeText(msgText);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Copied') });\n\t\t},\n\t\tcondition({ subscription }) {\n\t\t\treturn !!subscription;\n\t\t},\n\t\torder: 6,\n\t\tgroup: 'menu',\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'edit-message',\n\t\ticon: 'edit',\n\t\tlabel: 'Edit',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated'],\n\t\ttype: 'management',\n\t\tasync action(_, props) {\n\t\t\tconst { message = messageArgs(this).msg, chat } = props;\n\t\t\tawait chat?.messageEditing.editMessage(message);\n\t\t},\n\t\tcondition({ message, subscription, settings, room, user }) {\n\t\t\tif (subscription == null) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (isRoomFederated(room)) {\n\t\t\t\treturn message.u._id === user?._id;\n\t\t\t}\n\t\t\tconst canEditMessage = hasAtLeastOnePermission('edit-message', message.rid);\n\t\t\tconst isEditAllowed = settings.Message_AllowEditing;\n\t\t\tconst editOwn = message.u && message.u._id === user?._id;\n\t\t\tif (!(canEditMessage || (isEditAllowed && editOwn))) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst blockEditInMinutes = settings.Message_AllowEditing_BlockEditInMinutes as number;\n\t\t\tconst bypassBlockTimeLimit = hasPermission('bypass-time-limit-edit-and-delete', message.rid);\n\n\t\t\tif (!bypassBlockTimeLimit && blockEditInMinutes) {\n\t\t\t\tlet msgTs;\n\t\t\t\tif (message.ts != null) {\n\t\t\t\t\tmsgTs = moment(message.ts);\n\t\t\t\t}\n\t\t\t\tlet currentTsDiff;\n\t\t\t\tif (msgTs != null) {\n\t\t\t\t\tcurrentTsDiff = moment().diff(msgTs, 'minutes');\n\t\t\t\t}\n\t\t\t\treturn (!!currentTsDiff || currentTsDiff === 0) && currentTsDiff < blockEditInMinutes;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\torder: 8,\n\t\tgroup: 'menu',\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'delete-message',\n\t\ticon: 'trash',\n\t\tlabel: 'Delete',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated', 'videoconf', 'videoconf-threads'],\n\t\tcolor: 'alert',\n\t\ttype: 'management',\n\t\tasync action(this: unknown, _, { message = messageArgs(this).msg, chat }) {\n\t\t\tawait chat?.flows.requestMessageDeletion(message);\n\t\t},\n\t\tcondition({ message, subscription, room, chat, user }) {\n\t\t\tif (!subscription) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (isRoomFederated(room)) {\n\t\t\t\treturn message.u._id === user?._id;\n\t\t\t}\n\t\t\tconst isLivechatRoom = roomCoordinator.isLivechatRoom(room.t);\n\t\t\tif (isLivechatRoom) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn chat?.data.canDeleteMessage(message) ?? false;\n\t\t},\n\t\torder: 10,\n\t\tgroup: 'menu',\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'report-message',\n\t\ticon: 'report',\n\t\tlabel: 'Report',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated', 'videoconf', 'videoconf-threads'],\n\t\tcolor: 'alert',\n\t\ttype: 'management',\n\t\taction(this: unknown, _, { message = messageArgs(this).msg }) {\n\t\t\timperativeModal.open({\n\t\t\t\tcomponent: ReportMessageModal,\n\t\t\t\tprops: {\n\t\t\t\t\tmessage: getMainMessageText(message),\n\t\t\t\t\tonClose: imperativeModal.close,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tcondition({ subscription, room, message, user }) {\n\t\t\tconst isLivechatRoom = roomCoordinator.isLivechatRoom(room.t);\n\t\t\tif (isLivechatRoom || message.u._id === user?._id) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn Boolean(subscription);\n\t\t},\n\t\torder: 9,\n\t\tgroup: 'menu',\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'reaction-list',\n\t\ticon: 'emoji',\n\t\tlabel: 'Reactions',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'videoconf', 'videoconf-threads'],\n\t\ttype: 'interaction',\n\t\taction(this: unknown, _, { message: { reactions = {} } = messageArgs(this).msg }) {\n\t\t\timperativeModal.open({\n\t\t\t\tcomponent: ReactionListModal,\n\t\t\t\tprops: { reactions, onClose: imperativeModal.close },\n\t\t\t});\n\t\t},\n\t\tcondition({ message: { reactions } }) {\n\t\t\treturn !!reactions;\n\t\t},\n\t\torder: 9,\n\t\tgroup: 'menu',\n\t});\n});\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/ui-utils/client/lib/messageActionDefault.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/ui-utils/client/lib/messageActionDefault.ts","inputSourceMap":{"version":3,"file":"app/ui-utils/client/lib/messageActionDefault.ts","sourceRoot":"","sources":["app/ui-utils/client/lib/messageActionDefault.ts"],"names":[],"mappings":"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","sourcesContent":["import type { IMessage } from '@rocket.chat/core-typings';\nimport { isE2EEMessage, isRoomFederated } from '@rocket.chat/core-typings';\nimport { Meteor } from 'meteor/meteor';\nimport moment from 'moment';\n\nimport { getPermaLink } from '../../../../client/lib/getPermaLink';\nimport { imperativeModal } from '../../../../client/lib/imperativeModal';\nimport { roomCoordinator } from '../../../../client/lib/rooms/roomCoordinator';\nimport { dispatchToastMessage } from '../../../../client/lib/toast';\nimport { messageArgs } from '../../../../client/lib/utils/messageArgs';\nimport { router } from '../../../../client/providers/RouterProvider';\nimport ForwardMessageModal from '../../../../client/views/room/modals/ForwardMessageModal/ForwardMessageModal';\nimport ReactionListModal from '../../../../client/views/room/modals/ReactionListModal';\nimport ReportMessageModal from '../../../../client/views/room/modals/ReportMessageModal';\nimport { hasAtLeastOnePermission, hasPermission } from '../../../authorization/client';\nimport { ChatRoom, Subscriptions } from '../../../models/client';\nimport { t } from '../../../utils/lib/i18n';\nimport { MessageAction } from './MessageAction';\n\nconst getMainMessageText = (message: IMessage): IMessage => {\n\tconst newMessage = { ...message };\n\tnewMessage.msg = newMessage.msg || newMessage.attachments?.[0]?.description || newMessage.attachments?.[0]?.title || '';\n\tnewMessage.md = newMessage.md || newMessage.attachments?.[0]?.descriptionMd || undefined;\n\treturn { ...newMessage };\n};\n\nMeteor.startup(async () => {\n\tMessageAction.addButton({\n\t\tid: 'reply-directly',\n\t\ticon: 'reply-directly',\n\t\tlabel: 'Reply_in_direct_message',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated'],\n\t\trole: 'link',\n\t\ttype: 'communication',\n\t\taction(_, props) {\n\t\t\tconst { message = messageArgs(this).msg } = props;\n\t\t\troomCoordinator.openRouteLink(\n\t\t\t\t'd',\n\t\t\t\t{ name: message.u.username },\n\t\t\t\t{\n\t\t\t\t\t...router.getSearchParameters(),\n\t\t\t\t\treply: message._id,\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tcondition({ subscription, room, message, user }) {\n\t\t\tif (subscription == null) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (room.t === 'd' || room.t === 'l') {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Check if we already have a DM started with the message user (not ourselves) or we can start one\n\t\t\tif (!!user && user._id !== message.u._id && !hasPermission('create-d')) {\n\t\t\t\tconst dmRoom = ChatRoom.findOne({ _id: [user._id, message.u._id].sort().join('') });\n\t\t\t\tif (!dmRoom || !Subscriptions.findOne({ 'rid': dmRoom._id, 'u._id': user._id })) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\torder: 0,\n\t\tgroup: 'menu',\n\t\tdisabled({ message }) {\n\t\t\treturn isE2EEMessage(message);\n\t\t},\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'forward-message',\n\t\ticon: 'arrow-forward',\n\t\tlabel: 'Forward_message',\n\t\tcontext: ['message', 'message-mobile', 'threads'],\n\t\ttype: 'communication',\n\t\tasync action(_, props) {\n\t\t\tconst { message = messageArgs(this).msg } = props;\n\t\t\tconst permalink = await getPermaLink(message._id);\n\t\t\timperativeModal.open({\n\t\t\t\tcomponent: ForwardMessageModal,\n\t\t\t\tprops: {\n\t\t\t\t\tmessage,\n\t\t\t\t\tpermalink,\n\t\t\t\t\tonClose: (): void => {\n\t\t\t\t\t\timperativeModal.close();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\torder: 0,\n\t\tgroup: 'message',\n\t\tdisabled({ message }) {\n\t\t\treturn isE2EEMessage(message);\n\t\t},\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'quote-message',\n\t\ticon: 'quote',\n\t\tlabel: 'Quote',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated'],\n\t\tasync action(_, props) {\n\t\t\tconst { message = messageArgs(this).msg, chat, autoTranslateOptions } = props;\n\n\t\t\tif (message && autoTranslateOptions?.autoTranslateEnabled && autoTranslateOptions.showAutoTranslate(message)) {\n\t\t\t\tmessage.msg =\n\t\t\t\t\tmessage.translations && autoTranslateOptions.autoTranslateLanguage\n\t\t\t\t\t\t? message.translations[autoTranslateOptions.autoTranslateLanguage]\n\t\t\t\t\t\t: message.msg;\n\t\t\t}\n\n\t\t\tawait chat?.composer?.quoteMessage(message);\n\t\t},\n\t\tcondition({ subscription }) {\n\t\t\tif (subscription == null) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\torder: -2,\n\t\tgroup: 'message',\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'permalink',\n\t\ticon: 'permalink',\n\t\tlabel: 'Copy_link',\n\t\t// classes: 'clipboard',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated', 'videoconf', 'videoconf-threads'],\n\t\ttype: 'duplication',\n\t\tasync action(_, props) {\n\t\t\ttry {\n\t\t\t\tconst { message = messageArgs(this).msg } = props;\n\t\t\t\tconst permalink = await getPermaLink(message._id);\n\t\t\t\tawait navigator.clipboard.writeText(permalink);\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Copied') });\n\t\t\t} catch (e) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: e });\n\t\t\t}\n\t\t},\n\t\tcondition({ subscription }) {\n\t\t\treturn !!subscription;\n\t\t},\n\t\torder: 5,\n\t\tgroup: 'menu',\n\t\tdisabled({ message }) {\n\t\t\treturn isE2EEMessage(message);\n\t\t},\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'copy',\n\t\ticon: 'copy',\n\t\tlabel: 'Copy_text',\n\t\t// classes: 'clipboard',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated'],\n\t\ttype: 'duplication',\n\t\tasync action(_, props) {\n\t\t\tconst { message = messageArgs(this).msg } = props;\n\t\t\tconst msgText = getMainMessageText(message).msg;\n\t\t\tawait navigator.clipboard.writeText(msgText);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Copied') });\n\t\t},\n\t\tcondition({ subscription }) {\n\t\t\treturn !!subscription;\n\t\t},\n\t\torder: 6,\n\t\tgroup: 'menu',\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'edit-message',\n\t\ticon: 'edit',\n\t\tlabel: 'Edit',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated'],\n\t\ttype: 'management',\n\t\tasync action(_, props) {\n\t\t\tconst { message = messageArgs(this).msg, chat } = props;\n\t\t\tawait chat?.messageEditing.editMessage(message);\n\t\t},\n\t\tcondition({ message, subscription, settings, room, user }) {\n\t\t\tif (subscription == null) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (isRoomFederated(room)) {\n\t\t\t\treturn message.u._id === user?._id;\n\t\t\t}\n\t\t\tconst canEditMessage = hasAtLeastOnePermission('edit-message', message.rid);\n\t\t\tconst isEditAllowed = settings.Message_AllowEditing;\n\t\t\tconst editOwn = message.u && message.u._id === user?._id;\n\t\t\tif (!(canEditMessage || (isEditAllowed && editOwn))) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst blockEditInMinutes = settings.Message_AllowEditing_BlockEditInMinutes as number;\n\t\t\tconst bypassBlockTimeLimit = hasPermission('bypass-time-limit-edit-and-delete', message.rid);\n\n\t\t\tif (!bypassBlockTimeLimit && blockEditInMinutes) {\n\t\t\t\tlet msgTs;\n\t\t\t\tif (message.ts != null) {\n\t\t\t\t\tmsgTs = moment(message.ts);\n\t\t\t\t}\n\t\t\t\tlet currentTsDiff;\n\t\t\t\tif (msgTs != null) {\n\t\t\t\t\tcurrentTsDiff = moment().diff(msgTs, 'minutes');\n\t\t\t\t}\n\t\t\t\treturn (!!currentTsDiff || currentTsDiff === 0) && currentTsDiff < blockEditInMinutes;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\torder: 8,\n\t\tgroup: 'menu',\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'delete-message',\n\t\ticon: 'trash',\n\t\tlabel: 'Delete',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated', 'videoconf', 'videoconf-threads'],\n\t\tcolor: 'alert',\n\t\ttype: 'management',\n\t\tasync action(this: unknown, _, { message = messageArgs(this).msg, chat }) {\n\t\t\tawait chat?.flows.requestMessageDeletion(message);\n\t\t},\n\t\tcondition({ message, subscription, room, chat, user }) {\n\t\t\tif (!subscription) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (isRoomFederated(room)) {\n\t\t\t\treturn message.u._id === user?._id;\n\t\t\t}\n\t\t\tconst isLivechatRoom = roomCoordinator.isLivechatRoom(room.t);\n\t\t\tif (isLivechatRoom) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn chat?.data.canDeleteMessage(message) ?? false;\n\t\t},\n\t\torder: 10,\n\t\tgroup: 'menu',\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'report-message',\n\t\ticon: 'report',\n\t\tlabel: 'Report',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated', 'videoconf', 'videoconf-threads'],\n\t\tcolor: 'alert',\n\t\ttype: 'management',\n\t\taction(this: unknown, _, { message = messageArgs(this).msg }) {\n\t\t\timperativeModal.open({\n\t\t\t\tcomponent: ReportMessageModal,\n\t\t\t\tprops: {\n\t\t\t\t\tmessage: getMainMessageText(message),\n\t\t\t\t\tonClose: imperativeModal.close,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tcondition({ subscription, room, message, user }) {\n\t\t\tconst isLivechatRoom = roomCoordinator.isLivechatRoom(room.t);\n\t\t\tif (isLivechatRoom || message.u._id === user?._id) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn Boolean(subscription);\n\t\t},\n\t\torder: 9,\n\t\tgroup: 'menu',\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'reaction-list',\n\t\ticon: 'emoji',\n\t\tlabel: 'Reactions',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'videoconf', 'videoconf-threads'],\n\t\ttype: 'interaction',\n\t\taction(this: unknown, _, { message: { reactions = {} } = messageArgs(this).msg }) {\n\t\t\timperativeModal.open({\n\t\t\t\tcomponent: ReactionListModal,\n\t\t\t\tprops: { reactions, onClose: imperativeModal.close },\n\t\t\t});\n\t\t},\n\t\tcondition({ message: { reactions } }) {\n\t\t\treturn !!reactions;\n\t\t},\n\t\torder: 9,\n\t\tgroup: 'menu',\n\t});\n});\n"]}}},"code":"let _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n}, 0);\nlet isE2EEMessage, isRoomFederated;\nmodule.link(\"@rocket.chat/core-typings\", {\n  isE2EEMessage(v) {\n    isE2EEMessage = v;\n  },\n  isRoomFederated(v) {\n    isRoomFederated = v;\n  }\n}, 0);\nlet Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor(v) {\n    Meteor = v;\n  }\n}, 1);\nlet moment;\nmodule.link(\"moment\", {\n  default(v) {\n    moment = v;\n  }\n}, 2);\nlet getPermaLink;\nmodule.link(\"../../../../client/lib/getPermaLink\", {\n  getPermaLink(v) {\n    getPermaLink = v;\n  }\n}, 3);\nlet imperativeModal;\nmodule.link(\"../../../../client/lib/imperativeModal\", {\n  imperativeModal(v) {\n    imperativeModal = v;\n  }\n}, 4);\nlet roomCoordinator;\nmodule.link(\"../../../../client/lib/rooms/roomCoordinator\", {\n  roomCoordinator(v) {\n    roomCoordinator = v;\n  }\n}, 5);\nlet dispatchToastMessage;\nmodule.link(\"../../../../client/lib/toast\", {\n  dispatchToastMessage(v) {\n    dispatchToastMessage = v;\n  }\n}, 6);\nlet messageArgs;\nmodule.link(\"../../../../client/lib/utils/messageArgs\", {\n  messageArgs(v) {\n    messageArgs = v;\n  }\n}, 7);\nlet router;\nmodule.link(\"../../../../client/providers/RouterProvider\", {\n  router(v) {\n    router = v;\n  }\n}, 8);\nlet ForwardMessageModal;\nmodule.link(\"../../../../client/views/room/modals/ForwardMessageModal/ForwardMessageModal\", {\n  default(v) {\n    ForwardMessageModal = v;\n  }\n}, 9);\nlet ReactionListModal;\nmodule.link(\"../../../../client/views/room/modals/ReactionListModal\", {\n  default(v) {\n    ReactionListModal = v;\n  }\n}, 10);\nlet ReportMessageModal;\nmodule.link(\"../../../../client/views/room/modals/ReportMessageModal\", {\n  default(v) {\n    ReportMessageModal = v;\n  }\n}, 11);\nlet hasAtLeastOnePermission, hasPermission;\nmodule.link(\"../../../authorization/client\", {\n  hasAtLeastOnePermission(v) {\n    hasAtLeastOnePermission = v;\n  },\n  hasPermission(v) {\n    hasPermission = v;\n  }\n}, 12);\nlet ChatRoom, Subscriptions;\nmodule.link(\"../../../models/client\", {\n  ChatRoom(v) {\n    ChatRoom = v;\n  },\n  Subscriptions(v) {\n    Subscriptions = v;\n  }\n}, 13);\nlet t;\nmodule.link(\"../../../utils/lib/i18n\", {\n  t(v) {\n    t = v;\n  }\n}, 14);\nlet MessageAction;\nmodule.link(\"./MessageAction\", {\n  MessageAction(v) {\n    MessageAction = v;\n  }\n}, 15);\nconst getMainMessageText = message => {\n  var _newMessage$attachmen, _newMessage$attachmen2, _newMessage$attachmen3, _newMessage$attachmen4, _newMessage$attachmen5, _newMessage$attachmen6;\n  const newMessage = _objectSpread({}, message);\n  newMessage.msg = newMessage.msg || ((_newMessage$attachmen = newMessage.attachments) === null || _newMessage$attachmen === void 0 ? void 0 : (_newMessage$attachmen2 = _newMessage$attachmen[0]) === null || _newMessage$attachmen2 === void 0 ? void 0 : _newMessage$attachmen2.description) || ((_newMessage$attachmen3 = newMessage.attachments) === null || _newMessage$attachmen3 === void 0 ? void 0 : (_newMessage$attachmen4 = _newMessage$attachmen3[0]) === null || _newMessage$attachmen4 === void 0 ? void 0 : _newMessage$attachmen4.title) || '';\n  newMessage.md = newMessage.md || ((_newMessage$attachmen5 = newMessage.attachments) === null || _newMessage$attachmen5 === void 0 ? void 0 : (_newMessage$attachmen6 = _newMessage$attachmen5[0]) === null || _newMessage$attachmen6 === void 0 ? void 0 : _newMessage$attachmen6.descriptionMd) || undefined;\n  return _objectSpread({}, newMessage);\n};\nMeteor.startup(async () => {\n  MessageAction.addButton({\n    id: 'reply-directly',\n    icon: 'reply-directly',\n    label: 'Reply_in_direct_message',\n    context: ['message', 'message-mobile', 'threads', 'federated'],\n    role: 'link',\n    type: 'communication',\n    action(_, props) {\n      const {\n        message = messageArgs(this).msg\n      } = props;\n      roomCoordinator.openRouteLink('d', {\n        name: message.u.username\n      }, _objectSpread(_objectSpread({}, router.getSearchParameters()), {}, {\n        reply: message._id\n      }));\n    },\n    condition(_ref) {\n      let {\n        subscription,\n        room,\n        message,\n        user\n      } = _ref;\n      if (subscription == null) {\n        return false;\n      }\n      if (room.t === 'd' || room.t === 'l') {\n        return false;\n      }\n      // Check if we already have a DM started with the message user (not ourselves) or we can start one\n      if (!!user && user._id !== message.u._id && !hasPermission('create-d')) {\n        const dmRoom = ChatRoom.findOne({\n          _id: [user._id, message.u._id].sort().join('')\n        });\n        if (!dmRoom || !Subscriptions.findOne({\n          'rid': dmRoom._id,\n          'u._id': user._id\n        })) {\n          return false;\n        }\n      }\n      return true;\n    },\n    order: 0,\n    group: 'menu',\n    disabled(_ref2) {\n      let {\n        message\n      } = _ref2;\n      return isE2EEMessage(message);\n    }\n  });\n  MessageAction.addButton({\n    id: 'forward-message',\n    icon: 'arrow-forward',\n    label: 'Forward_message',\n    context: ['message', 'message-mobile', 'threads'],\n    type: 'communication',\n    async action(_, props) {\n      const {\n        message = messageArgs(this).msg\n      } = props;\n      const permalink = await getPermaLink(message._id);\n      imperativeModal.open({\n        component: ForwardMessageModal,\n        props: {\n          message,\n          permalink,\n          onClose: () => {\n            imperativeModal.close();\n          }\n        }\n      });\n    },\n    order: 0,\n    group: 'message',\n    disabled(_ref3) {\n      let {\n        message\n      } = _ref3;\n      return isE2EEMessage(message);\n    }\n  });\n  MessageAction.addButton({\n    id: 'quote-message',\n    icon: 'quote',\n    label: 'Quote',\n    context: ['message', 'message-mobile', 'threads', 'federated'],\n    async action(_, props) {\n      var _chat$composer;\n      const {\n        message = messageArgs(this).msg,\n        chat,\n        autoTranslateOptions\n      } = props;\n      if (message && autoTranslateOptions !== null && autoTranslateOptions !== void 0 && autoTranslateOptions.autoTranslateEnabled && autoTranslateOptions.showAutoTranslate(message)) {\n        message.msg = message.translations && autoTranslateOptions.autoTranslateLanguage ? message.translations[autoTranslateOptions.autoTranslateLanguage] : message.msg;\n      }\n      await (chat === null || chat === void 0 ? void 0 : (_chat$composer = chat.composer) === null || _chat$composer === void 0 ? void 0 : _chat$composer.quoteMessage(message));\n    },\n    condition(_ref4) {\n      let {\n        subscription\n      } = _ref4;\n      if (subscription == null) {\n        return false;\n      }\n      return true;\n    },\n    order: -2,\n    group: 'message'\n  });\n  MessageAction.addButton({\n    id: 'permalink',\n    icon: 'permalink',\n    label: 'Copy_link',\n    // classes: 'clipboard',\n    context: ['message', 'message-mobile', 'threads', 'federated', 'videoconf', 'videoconf-threads'],\n    type: 'duplication',\n    async action(_, props) {\n      try {\n        const {\n          message = messageArgs(this).msg\n        } = props;\n        const permalink = await getPermaLink(message._id);\n        await navigator.clipboard.writeText(permalink);\n        dispatchToastMessage({\n          type: 'success',\n          message: t('Copied')\n        });\n      } catch (e) {\n        dispatchToastMessage({\n          type: 'error',\n          message: e\n        });\n      }\n    },\n    condition(_ref5) {\n      let {\n        subscription\n      } = _ref5;\n      return !!subscription;\n    },\n    order: 5,\n    group: 'menu',\n    disabled(_ref6) {\n      let {\n        message\n      } = _ref6;\n      return isE2EEMessage(message);\n    }\n  });\n  MessageAction.addButton({\n    id: 'copy',\n    icon: 'copy',\n    label: 'Copy_text',\n    // classes: 'clipboard',\n    context: ['message', 'message-mobile', 'threads', 'federated'],\n    type: 'duplication',\n    async action(_, props) {\n      const {\n        message = messageArgs(this).msg\n      } = props;\n      const msgText = getMainMessageText(message).msg;\n      await navigator.clipboard.writeText(msgText);\n      dispatchToastMessage({\n        type: 'success',\n        message: t('Copied')\n      });\n    },\n    condition(_ref7) {\n      let {\n        subscription\n      } = _ref7;\n      return !!subscription;\n    },\n    order: 6,\n    group: 'menu'\n  });\n  MessageAction.addButton({\n    id: 'edit-message',\n    icon: 'edit',\n    label: 'Edit',\n    context: ['message', 'message-mobile', 'threads', 'federated'],\n    type: 'management',\n    async action(_, props) {\n      const {\n        message = messageArgs(this).msg,\n        chat\n      } = props;\n      await (chat === null || chat === void 0 ? void 0 : chat.messageEditing.editMessage(message));\n    },\n    condition(_ref8) {\n      let {\n        message,\n        subscription,\n        settings,\n        room,\n        user\n      } = _ref8;\n      if (subscription == null) {\n        return false;\n      }\n      if (isRoomFederated(room)) {\n        return message.u._id === (user === null || user === void 0 ? void 0 : user._id);\n      }\n      const canEditMessage = hasAtLeastOnePermission('edit-message', message.rid);\n      const isEditAllowed = settings.Message_AllowEditing;\n      const editOwn = message.u && message.u._id === (user === null || user === void 0 ? void 0 : user._id);\n      if (!(canEditMessage || isEditAllowed && editOwn)) {\n        return false;\n      }\n      const blockEditInMinutes = settings.Message_AllowEditing_BlockEditInMinutes;\n      const bypassBlockTimeLimit = hasPermission('bypass-time-limit-edit-and-delete', message.rid);\n      if (!bypassBlockTimeLimit && blockEditInMinutes) {\n        let msgTs;\n        if (message.ts != null) {\n          msgTs = moment(message.ts);\n        }\n        let currentTsDiff;\n        if (msgTs != null) {\n          currentTsDiff = moment().diff(msgTs, 'minutes');\n        }\n        return (!!currentTsDiff || currentTsDiff === 0) && currentTsDiff < blockEditInMinutes;\n      }\n      return true;\n    },\n    order: 8,\n    group: 'menu'\n  });\n  MessageAction.addButton({\n    id: 'delete-message',\n    icon: 'trash',\n    label: 'Delete',\n    context: ['message', 'message-mobile', 'threads', 'federated', 'videoconf', 'videoconf-threads'],\n    color: 'alert',\n    type: 'management',\n    async action(_, _ref9) {\n      let {\n        message = messageArgs(this).msg,\n        chat\n      } = _ref9;\n      await (chat === null || chat === void 0 ? void 0 : chat.flows.requestMessageDeletion(message));\n    },\n    condition(_ref10) {\n      var _chat$data$canDeleteM;\n      let {\n        message,\n        subscription,\n        room,\n        chat,\n        user\n      } = _ref10;\n      if (!subscription) {\n        return false;\n      }\n      if (isRoomFederated(room)) {\n        return message.u._id === (user === null || user === void 0 ? void 0 : user._id);\n      }\n      const isLivechatRoom = roomCoordinator.isLivechatRoom(room.t);\n      if (isLivechatRoom) {\n        return false;\n      }\n      return (_chat$data$canDeleteM = chat === null || chat === void 0 ? void 0 : chat.data.canDeleteMessage(message)) !== null && _chat$data$canDeleteM !== void 0 ? _chat$data$canDeleteM : false;\n    },\n    order: 10,\n    group: 'menu'\n  });\n  MessageAction.addButton({\n    id: 'report-message',\n    icon: 'report',\n    label: 'Report',\n    context: ['message', 'message-mobile', 'threads', 'federated', 'videoconf', 'videoconf-threads'],\n    color: 'alert',\n    type: 'management',\n    action(_, _ref11) {\n      let {\n        message = messageArgs(this).msg\n      } = _ref11;\n      imperativeModal.open({\n        component: ReportMessageModal,\n        props: {\n          message: getMainMessageText(message),\n          onClose: imperativeModal.close\n        }\n      });\n    },\n    condition(_ref12) {\n      let {\n        subscription,\n        room,\n        message,\n        user\n      } = _ref12;\n      const isLivechatRoom = roomCoordinator.isLivechatRoom(room.t);\n      if (isLivechatRoom || message.u._id === (user === null || user === void 0 ? void 0 : user._id)) {\n        return false;\n      }\n      return Boolean(subscription);\n    },\n    order: 9,\n    group: 'menu'\n  });\n  MessageAction.addButton({\n    id: 'reaction-list',\n    icon: 'emoji',\n    label: 'Reactions',\n    context: ['message', 'message-mobile', 'threads', 'videoconf', 'videoconf-threads'],\n    type: 'interaction',\n    action(_, _ref13) {\n      let {\n        message: {\n          reactions = {}\n        } = messageArgs(this).msg\n      } = _ref13;\n      imperativeModal.open({\n        component: ReactionListModal,\n        props: {\n          reactions,\n          onClose: imperativeModal.close\n        }\n      });\n    },\n    condition(_ref14) {\n      let {\n        message: {\n          reactions\n        }\n      } = _ref14;\n      return !!reactions;\n    },\n    order: 9,\n    group: 'menu'\n  });\n});","map":{"version":3,"names":["_objectSpread","module","link","default","v","isE2EEMessage","isRoomFederated","Meteor","moment","getPermaLink","imperativeModal","roomCoordinator","dispatchToastMessage","messageArgs","router","ForwardMessageModal","ReactionListModal","ReportMessageModal","hasAtLeastOnePermission","hasPermission","ChatRoom","Subscriptions","t","MessageAction","getMainMessageText","message","_newMessage$attachmen","_newMessage$attachmen2","_newMessage$attachmen3","_newMessage$attachmen4","_newMessage$attachmen5","_newMessage$attachmen6","newMessage","msg","attachments","description","title","md","descriptionMd","undefined","startup","addButton","id","icon","label","context","role","type","action","_","props","openRouteLink","name","u","username","getSearchParameters","reply","_id","condition","_ref","subscription","room","user","dmRoom","findOne","sort","join","order","group","disabled","_ref2","permalink","open","component","onClose","close","_ref3","_chat$composer","chat","autoTranslateOptions","autoTranslateEnabled","showAutoTranslate","translations","autoTranslateLanguage","composer","quoteMessage","_ref4","navigator","clipboard","writeText","e","_ref5","_ref6","msgText","_ref7","messageEditing","editMessage","_ref8","settings","canEditMessage","rid","isEditAllowed","Message_AllowEditing","editOwn","blockEditInMinutes","Message_AllowEditing_BlockEditInMinutes","bypassBlockTimeLimit","msgTs","ts","currentTsDiff","diff","color","_ref9","flows","requestMessageDeletion","_ref10","_chat$data$canDeleteM","isLivechatRoom","data","canDeleteMessage","_ref11","_ref12","Boolean","_ref13","reactions","_ref14"],"sources":["app/ui-utils/client/lib/messageActionDefault.ts"],"sourcesContent":["import type { IMessage } from '@rocket.chat/core-typings';\nimport { isE2EEMessage, isRoomFederated } from '@rocket.chat/core-typings';\nimport { Meteor } from 'meteor/meteor';\nimport moment from 'moment';\n\nimport { getPermaLink } from '../../../../client/lib/getPermaLink';\nimport { imperativeModal } from '../../../../client/lib/imperativeModal';\nimport { roomCoordinator } from '../../../../client/lib/rooms/roomCoordinator';\nimport { dispatchToastMessage } from '../../../../client/lib/toast';\nimport { messageArgs } from '../../../../client/lib/utils/messageArgs';\nimport { router } from '../../../../client/providers/RouterProvider';\nimport ForwardMessageModal from '../../../../client/views/room/modals/ForwardMessageModal/ForwardMessageModal';\nimport ReactionListModal from '../../../../client/views/room/modals/ReactionListModal';\nimport ReportMessageModal from '../../../../client/views/room/modals/ReportMessageModal';\nimport { hasAtLeastOnePermission, hasPermission } from '../../../authorization/client';\nimport { ChatRoom, Subscriptions } from '../../../models/client';\nimport { t } from '../../../utils/lib/i18n';\nimport { MessageAction } from './MessageAction';\n\nconst getMainMessageText = (message: IMessage): IMessage => {\n\tconst newMessage = { ...message };\n\tnewMessage.msg = newMessage.msg || newMessage.attachments?.[0]?.description || newMessage.attachments?.[0]?.title || '';\n\tnewMessage.md = newMessage.md || newMessage.attachments?.[0]?.descriptionMd || undefined;\n\treturn { ...newMessage };\n};\n\nMeteor.startup(async () => {\n\tMessageAction.addButton({\n\t\tid: 'reply-directly',\n\t\ticon: 'reply-directly',\n\t\tlabel: 'Reply_in_direct_message',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated'],\n\t\trole: 'link',\n\t\ttype: 'communication',\n\t\taction(_, props) {\n\t\t\tconst { message = messageArgs(this).msg } = props;\n\t\t\troomCoordinator.openRouteLink(\n\t\t\t\t'd',\n\t\t\t\t{ name: message.u.username },\n\t\t\t\t{\n\t\t\t\t\t...router.getSearchParameters(),\n\t\t\t\t\treply: message._id,\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tcondition({ subscription, room, message, user }) {\n\t\t\tif (subscription == null) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (room.t === 'd' || room.t === 'l') {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Check if we already have a DM started with the message user (not ourselves) or we can start one\n\t\t\tif (!!user && user._id !== message.u._id && !hasPermission('create-d')) {\n\t\t\t\tconst dmRoom = ChatRoom.findOne({ _id: [user._id, message.u._id].sort().join('') });\n\t\t\t\tif (!dmRoom || !Subscriptions.findOne({ 'rid': dmRoom._id, 'u._id': user._id })) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\torder: 0,\n\t\tgroup: 'menu',\n\t\tdisabled({ message }) {\n\t\t\treturn isE2EEMessage(message);\n\t\t},\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'forward-message',\n\t\ticon: 'arrow-forward',\n\t\tlabel: 'Forward_message',\n\t\tcontext: ['message', 'message-mobile', 'threads'],\n\t\ttype: 'communication',\n\t\tasync action(_, props) {\n\t\t\tconst { message = messageArgs(this).msg } = props;\n\t\t\tconst permalink = await getPermaLink(message._id);\n\t\t\timperativeModal.open({\n\t\t\t\tcomponent: ForwardMessageModal,\n\t\t\t\tprops: {\n\t\t\t\t\tmessage,\n\t\t\t\t\tpermalink,\n\t\t\t\t\tonClose: (): void => {\n\t\t\t\t\t\timperativeModal.close();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\torder: 0,\n\t\tgroup: 'message',\n\t\tdisabled({ message }) {\n\t\t\treturn isE2EEMessage(message);\n\t\t},\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'quote-message',\n\t\ticon: 'quote',\n\t\tlabel: 'Quote',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated'],\n\t\tasync action(_, props) {\n\t\t\tconst { message = messageArgs(this).msg, chat, autoTranslateOptions } = props;\n\n\t\t\tif (message && autoTranslateOptions?.autoTranslateEnabled && autoTranslateOptions.showAutoTranslate(message)) {\n\t\t\t\tmessage.msg =\n\t\t\t\t\tmessage.translations && autoTranslateOptions.autoTranslateLanguage\n\t\t\t\t\t\t? message.translations[autoTranslateOptions.autoTranslateLanguage]\n\t\t\t\t\t\t: message.msg;\n\t\t\t}\n\n\t\t\tawait chat?.composer?.quoteMessage(message);\n\t\t},\n\t\tcondition({ subscription }) {\n\t\t\tif (subscription == null) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\torder: -2,\n\t\tgroup: 'message',\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'permalink',\n\t\ticon: 'permalink',\n\t\tlabel: 'Copy_link',\n\t\t// classes: 'clipboard',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated', 'videoconf', 'videoconf-threads'],\n\t\ttype: 'duplication',\n\t\tasync action(_, props) {\n\t\t\ttry {\n\t\t\t\tconst { message = messageArgs(this).msg } = props;\n\t\t\t\tconst permalink = await getPermaLink(message._id);\n\t\t\t\tawait navigator.clipboard.writeText(permalink);\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Copied') });\n\t\t\t} catch (e) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: e });\n\t\t\t}\n\t\t},\n\t\tcondition({ subscription }) {\n\t\t\treturn !!subscription;\n\t\t},\n\t\torder: 5,\n\t\tgroup: 'menu',\n\t\tdisabled({ message }) {\n\t\t\treturn isE2EEMessage(message);\n\t\t},\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'copy',\n\t\ticon: 'copy',\n\t\tlabel: 'Copy_text',\n\t\t// classes: 'clipboard',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated'],\n\t\ttype: 'duplication',\n\t\tasync action(_, props) {\n\t\t\tconst { message = messageArgs(this).msg } = props;\n\t\t\tconst msgText = getMainMessageText(message).msg;\n\t\t\tawait navigator.clipboard.writeText(msgText);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Copied') });\n\t\t},\n\t\tcondition({ subscription }) {\n\t\t\treturn !!subscription;\n\t\t},\n\t\torder: 6,\n\t\tgroup: 'menu',\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'edit-message',\n\t\ticon: 'edit',\n\t\tlabel: 'Edit',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated'],\n\t\ttype: 'management',\n\t\tasync action(_, props) {\n\t\t\tconst { message = messageArgs(this).msg, chat } = props;\n\t\t\tawait chat?.messageEditing.editMessage(message);\n\t\t},\n\t\tcondition({ message, subscription, settings, room, user }) {\n\t\t\tif (subscription == null) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (isRoomFederated(room)) {\n\t\t\t\treturn message.u._id === user?._id;\n\t\t\t}\n\t\t\tconst canEditMessage = hasAtLeastOnePermission('edit-message', message.rid);\n\t\t\tconst isEditAllowed = settings.Message_AllowEditing;\n\t\t\tconst editOwn = message.u && message.u._id === user?._id;\n\t\t\tif (!(canEditMessage || (isEditAllowed && editOwn))) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst blockEditInMinutes = settings.Message_AllowEditing_BlockEditInMinutes as number;\n\t\t\tconst bypassBlockTimeLimit = hasPermission('bypass-time-limit-edit-and-delete', message.rid);\n\n\t\t\tif (!bypassBlockTimeLimit && blockEditInMinutes) {\n\t\t\t\tlet msgTs;\n\t\t\t\tif (message.ts != null) {\n\t\t\t\t\tmsgTs = moment(message.ts);\n\t\t\t\t}\n\t\t\t\tlet currentTsDiff;\n\t\t\t\tif (msgTs != null) {\n\t\t\t\t\tcurrentTsDiff = moment().diff(msgTs, 'minutes');\n\t\t\t\t}\n\t\t\t\treturn (!!currentTsDiff || currentTsDiff === 0) && currentTsDiff < blockEditInMinutes;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\torder: 8,\n\t\tgroup: 'menu',\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'delete-message',\n\t\ticon: 'trash',\n\t\tlabel: 'Delete',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated', 'videoconf', 'videoconf-threads'],\n\t\tcolor: 'alert',\n\t\ttype: 'management',\n\t\tasync action(this: unknown, _, { message = messageArgs(this).msg, chat }) {\n\t\t\tawait chat?.flows.requestMessageDeletion(message);\n\t\t},\n\t\tcondition({ message, subscription, room, chat, user }) {\n\t\t\tif (!subscription) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (isRoomFederated(room)) {\n\t\t\t\treturn message.u._id === user?._id;\n\t\t\t}\n\t\t\tconst isLivechatRoom = roomCoordinator.isLivechatRoom(room.t);\n\t\t\tif (isLivechatRoom) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn chat?.data.canDeleteMessage(message) ?? false;\n\t\t},\n\t\torder: 10,\n\t\tgroup: 'menu',\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'report-message',\n\t\ticon: 'report',\n\t\tlabel: 'Report',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'federated', 'videoconf', 'videoconf-threads'],\n\t\tcolor: 'alert',\n\t\ttype: 'management',\n\t\taction(this: unknown, _, { message = messageArgs(this).msg }) {\n\t\t\timperativeModal.open({\n\t\t\t\tcomponent: ReportMessageModal,\n\t\t\t\tprops: {\n\t\t\t\t\tmessage: getMainMessageText(message),\n\t\t\t\t\tonClose: imperativeModal.close,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tcondition({ subscription, room, message, user }) {\n\t\t\tconst isLivechatRoom = roomCoordinator.isLivechatRoom(room.t);\n\t\t\tif (isLivechatRoom || message.u._id === user?._id) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn Boolean(subscription);\n\t\t},\n\t\torder: 9,\n\t\tgroup: 'menu',\n\t});\n\n\tMessageAction.addButton({\n\t\tid: 'reaction-list',\n\t\ticon: 'emoji',\n\t\tlabel: 'Reactions',\n\t\tcontext: ['message', 'message-mobile', 'threads', 'videoconf', 'videoconf-threads'],\n\t\ttype: 'interaction',\n\t\taction(this: unknown, _, { message: { reactions = {} } = messageArgs(this).msg }) {\n\t\t\timperativeModal.open({\n\t\t\t\tcomponent: ReactionListModal,\n\t\t\t\tprops: { reactions, onClose: imperativeModal.close },\n\t\t\t});\n\t\t},\n\t\tcondition({ message: { reactions } }) {\n\t\t\treturn !!reactions;\n\t\t},\n\t\torder: 9,\n\t\tgroup: 'menu',\n\t});\n});\n"],"mappings":"AACA,IAAAA,aAAS;AAAAC,MAAe,CAAAC,IAAA,uCAAuB;EAAAC,OAA4BA,CAAAC,CAAA;IAAAJ,aAAA,GAAAI,CAAA;EAAA;AAAA;AAA3E,IAAAC,aAAS,EAAAC,eAAe;AAAAL,MAAe,CAAEC,IAAA,4BAAM,EAA2B;EAACG,cAAAD,CAAA;IAAAC,aAAA,GAAAD,CAAA;EAAA;EAAAE,gBAAAF,CAAA;IAAAE,eAAA,GAAAF,CAAA;EAAA;AAAA;AAAA,IAAAG,MAAA;AAAAN,MAAA,CAAAC,IAAA;EAAAK,OAAAH,CAAA;IAAAG,MAAA,GAAAH,CAAA;EAAA;AAAA;AAAA,IAAAI,MAAA;AAAAP,MAAA,CAAAC,IAAA;EAAAC,QAAAC,CAAA;IAAAI,MAAA,GAAAJ,CAAA;EAAA;AAAA;AAAA,IAAAK,YAAA;AAAAR,MAAA,CAAAC,IAAA;EAAAO,aAAAL,CAAA;IAAAK,YAAA,GAAAL,CAAA;EAAA;AAAA;AAAA,IAAAM,eAAA;AAAAT,MAAA,CAAAC,IAAA;EAAAQ,gBAAAN,CAAA;IAAAM,eAAA,GAAAN,CAAA;EAAA;AAAA;AAAA,IAAAO,eAAA;AAAAV,MAAA,CAAAC,IAAA;EAAAS,gBAAAP,CAAA;IAAAO,eAAA,GAAAP,CAAA;EAAA;AAAA;AAAA,IAAAQ,oBAAA;AAAAX,MAAA,CAAAC,IAAA;EAAAU,qBAAAR,CAAA;IAAAQ,oBAAA,GAAAR,CAAA;EAAA;AAAA;AAAA,IAAAS,WAAA;AAAAZ,MAAA,CAAAC,IAAA;EAAAW,YAAAT,CAAA;IAAAS,WAAA,GAAAT,CAAA;EAAA;AAAA;AAAA,IAAAU,MAAA;AAAAb,MAAA,CAAAC,IAAA;EAAAY,OAAAV,CAAA;IAAAU,MAAA,GAAAV,CAAA;EAAA;AAAA;AAAA,IAAAW,mBAAA;AAAAd,MAAA,CAAAC,IAAA;EAAAC,QAAAC,CAAA;IAAAW,mBAAA,GAAAX,CAAA;EAAA;AAAA;AAAA,IAAAY,iBAAA;AAAAf,MAAA,CAAAC,IAAA;EAAAC,QAAAC,CAAA;IAAAY,iBAAA,GAAAZ,CAAA;EAAA;AAAA;AAAA,IAAAa,kBAAA;AAAAhB,MAAA,CAAAC,IAAA;EAAAC,QAAAC,CAAA;IAAAa,kBAAA,GAAAb,CAAA;EAAA;AAAA;AAAA,IAAAc,uBAAA,EAAAC,aAAA;AAAAlB,MAAA,CAAAC,IAAA;EAAAgB,wBAAAd,CAAA;IAAAc,uBAAA,GAAAd,CAAA;EAAA;EAAAe,cAAAf,CAAA;IAAAe,aAAA,GAAAf,CAAA;EAAA;AAAA;AAAA,IAAAgB,QAAA,EAAAC,aAAA;AAAApB,MAAA,CAAAC,IAAA;EAAAkB,SAAAhB,CAAA;IAAAgB,QAAA,GAAAhB,CAAA;EAAA;EAAAiB,cAAAjB,CAAA;IAAAiB,aAAA,GAAAjB,CAAA;EAAA;AAAA;AAAA,IAAAkB,CAAA;AAAArB,MAAA,CAAAC,IAAA;EAAAoB,EAAAlB,CAAA;IAAAkB,CAAA,GAAAlB,CAAA;EAAA;AAAA;AAAA,IAAAmB,aAAA;AAAAtB,MAAA,CAAAC,IAAA;EAAAqB,cAAAnB,CAAA;IAAAmB,aAAA,GAAAnB,CAAA;EAAA;AAAA;AAkB3E,MAAMoB,kBAAkB,GAAIC,OAAiB,IAAc;EAAA,IAAAC,qBAAA,EAAAC,sBAAA,EAAAC,sBAAA,EAAAC,sBAAA,EAAAC,sBAAA,EAAAC,sBAAA;EAC1D,MAAMC,UAAU,GAAAhC,aAAA,KAAQyB,OAAO,CAAE;EACjCO,UAAU,CAACC,GAAG,GAAGD,UAAU,CAACC,GAAG,MAAAP,qBAAA,GAAIM,UAAU,CAACE,WAAW,cAAAR,qBAAA,wBAAAC,sBAAA,GAAtBD,qBAAA,CAAyB,CAAC,CAAC,cAAAC,sBAAA,uBAA3BA,sBAAA,CAA6BQ,WAAW,OAAAP,sBAAA,GAAII,UAAU,CAACE,WAAW,cAAAN,sBAAA,wBAAAC,sBAAA,GAAtBD,sBAAA,CAAyB,CAAC,CAAC,cAAAC,sBAAA,uBAA3BA,sBAAA,CAA6BO,KAAK,KAAI,EAAE;EACvHJ,UAAU,CAACK,EAAE,GAAGL,UAAU,CAACK,EAAE,MAAAP,sBAAA,GAAIE,UAAU,CAACE,WAAW,cAAAJ,sBAAA,wBAAAC,sBAAA,GAAtBD,sBAAA,CAAyB,CAAC,CAAC,cAAAC,sBAAA,uBAA3BA,sBAAA,CAA6BO,aAAa,KAAIC,SAAS;EACxF,OAAAvC,aAAA,KAAYgC,UAAU;AACvB,CAAC;AAEDzB,MAAM,CAACiC,OAAO,CAAC,YAAW;EACzBjB,aAAa,CAACkB,SAAS,CAAC;IACvBC,EAAE,EAAE,gBAAgB;IACpBC,IAAI,EAAE,gBAAgB;IACtBC,KAAK,EAAE,yBAAyB;IAChCC,OAAO,EAAE,CAAC,SAAS,EAAE,gBAAgB,EAAE,SAAS,EAAE,WAAW,CAAC;IAC9DC,IAAI,EAAE,MAAM;IACZC,IAAI,EAAE,eAAe;IACrBC,MAAMA,CAACC,CAAC,EAAEC,KAAK;MACd,MAAM;QAAEzB,OAAO,GAAGZ,WAAW,CAAC,IAAI,CAAC,CAACoB;MAAG,CAAE,GAAGiB,KAAK;MACjDvC,eAAe,CAACwC,aAAa,CAC5B,GAAG,EACH;QAAEC,IAAI,EAAE3B,OAAO,CAAC4B,CAAC,CAACC;MAAQ,CAAE,EAAAtD,aAAA,CAAAA,aAAA,KAExBc,MAAM,CAACyC,mBAAmB,EAAE;QAC/BC,KAAK,EAAE/B,OAAO,CAACgC;MAAG,EAClB,CACD;IACF,CAAC;IACDC,SAASA,CAAAC,IAAA,EAAsC;MAAA,IAArC;QAAEC,YAAY;QAAEC,IAAI;QAAEpC,OAAO;QAAEqC;MAAI,CAAE,GAAAH,IAAA;MAC9C,IAAIC,YAAY,IAAI,IAAI,EAAE;QACzB,OAAO,KAAK;MACb;MACA,IAAIC,IAAI,CAACvC,CAAC,KAAK,GAAG,IAAIuC,IAAI,CAACvC,CAAC,KAAK,GAAG,EAAE;QACrC,OAAO,KAAK;MACb;MAEA;MACA,IAAI,CAAC,CAACwC,IAAI,IAAIA,IAAI,CAACL,GAAG,KAAKhC,OAAO,CAAC4B,CAAC,CAACI,GAAG,IAAI,CAACtC,aAAa,CAAC,UAAU,CAAC,EAAE;QACvE,MAAM4C,MAAM,GAAG3C,QAAQ,CAAC4C,OAAO,CAAC;UAAEP,GAAG,EAAE,CAACK,IAAI,CAACL,GAAG,EAAEhC,OAAO,CAAC4B,CAAC,CAACI,GAAG,CAAC,CAACQ,IAAI,EAAE,CAACC,IAAI,CAAC,EAAE;QAAC,CAAE,CAAC;QACnF,IAAI,CAACH,MAAM,IAAI,CAAC1C,aAAa,CAAC2C,OAAO,CAAC;UAAE,KAAK,EAAED,MAAM,CAACN,GAAG;UAAE,OAAO,EAAEK,IAAI,CAACL;QAAG,CAAE,CAAC,EAAE;UAChF,OAAO,KAAK;QACb;MACD;MAEA,OAAO,IAAI;IACZ,CAAC;IACDU,KAAK,EAAE,CAAC;IACRC,KAAK,EAAE,MAAM;IACbC,QAAQA,CAAAC,KAAA,EAAY;MAAA,IAAX;QAAE7C;MAAO,CAAE,GAAA6C,KAAA;MACnB,OAAOjE,aAAa,CAACoB,OAAO,CAAC;IAC9B;GACA,CAAC;EAEFF,aAAa,CAACkB,SAAS,CAAC;IACvBC,EAAE,EAAE,iBAAiB;IACrBC,IAAI,EAAE,eAAe;IACrBC,KAAK,EAAE,iBAAiB;IACxBC,OAAO,EAAE,CAAC,SAAS,EAAE,gBAAgB,EAAE,SAAS,CAAC;IACjDE,IAAI,EAAE,eAAe;IACrB,MAAMC,MAAMA,CAACC,CAAC,EAAEC,KAAK;MACpB,MAAM;QAAEzB,OAAO,GAAGZ,WAAW,CAAC,IAAI,CAAC,CAACoB;MAAG,CAAE,GAAGiB,KAAK;MACjD,MAAMqB,SAAS,GAAG,MAAM9D,YAAY,CAACgB,OAAO,CAACgC,GAAG,CAAC;MACjD/C,eAAe,CAAC8D,IAAI,CAAC;QACpBC,SAAS,EAAE1D,mBAAmB;QAC9BmC,KAAK,EAAE;UACNzB,OAAO;UACP8C,SAAS;UACTG,OAAO,EAAEA,CAAA,KAAW;YACnBhE,eAAe,CAACiE,KAAK,EAAE;UACxB;;OAED,CAAC;IACH,CAAC;IACDR,KAAK,EAAE,CAAC;IACRC,KAAK,EAAE,SAAS;IAChBC,QAAQA,CAAAO,KAAA,EAAY;MAAA,IAAX;QAAEnD;MAAO,CAAE,GAAAmD,KAAA;MACnB,OAAOvE,aAAa,CAACoB,OAAO,CAAC;IAC9B;GACA,CAAC;EAEFF,aAAa,CAACkB,SAAS,CAAC;IACvBC,EAAE,EAAE,eAAe;IACnBC,IAAI,EAAE,OAAO;IACbC,KAAK,EAAE,OAAO;IACdC,OAAO,EAAE,CAAC,SAAS,EAAE,gBAAgB,EAAE,SAAS,EAAE,WAAW,CAAC;IAC9D,MAAMG,MAAMA,CAACC,CAAC,EAAEC,KAAK;MAAA,IAAA2B,cAAA;MACpB,MAAM;QAAEpD,OAAO,GAAGZ,WAAW,CAAC,IAAI,CAAC,CAACoB,GAAG;QAAE6C,IAAI;QAAEC;MAAoB,CAAE,GAAG7B,KAAK;MAE7E,IAAIzB,OAAO,IAAIsD,oBAAoB,aAApBA,oBAAoB,eAApBA,oBAAoB,CAAEC,oBAAoB,IAAID,oBAAoB,CAACE,iBAAiB,CAACxD,OAAO,CAAC,EAAE;QAC7GA,OAAO,CAACQ,GAAG,GACVR,OAAO,CAACyD,YAAY,IAAIH,oBAAoB,CAACI,qBAAqB,GAC/D1D,OAAO,CAACyD,YAAY,CAACH,oBAAoB,CAACI,qBAAqB,CAAC,GAChE1D,OAAO,CAACQ,GAAG;MAChB;MAEA,OAAM6C,IAAI,aAAJA,IAAI,wBAAAD,cAAA,GAAJC,IAAI,CAAEM,QAAQ,cAAAP,cAAA,uBAAdA,cAAA,CAAgBQ,YAAY,CAAC5D,OAAO,CAAC;IAC5C,CAAC;IACDiC,SAASA,CAAA4B,KAAA,EAAiB;MAAA,IAAhB;QAAE1B;MAAY,CAAE,GAAA0B,KAAA;MACzB,IAAI1B,YAAY,IAAI,IAAI,EAAE;QACzB,OAAO,KAAK;MACb;MAEA,OAAO,IAAI;IACZ,CAAC;IACDO,KAAK,EAAE,CAAC,CAAC;IACTC,KAAK,EAAE;GACP,CAAC;EAEF7C,aAAa,CAACkB,SAAS,CAAC;IACvBC,EAAE,EAAE,WAAW;IACfC,IAAI,EAAE,WAAW;IACjBC,KAAK,EAAE,WAAW;IAClB;IACAC,OAAO,EAAE,CAAC,SAAS,EAAE,gBAAgB,EAAE,SAAS,EAAE,WAAW,EAAE,WAAW,EAAE,mBAAmB,CAAC;IAChGE,IAAI,EAAE,aAAa;IACnB,MAAMC,MAAMA,CAACC,CAAC,EAAEC,KAAK;MACpB,IAAI;QACH,MAAM;UAAEzB,OAAO,GAAGZ,WAAW,CAAC,IAAI,CAAC,CAACoB;QAAG,CAAE,GAAGiB,KAAK;QACjD,MAAMqB,SAAS,GAAG,MAAM9D,YAAY,CAACgB,OAAO,CAACgC,GAAG,CAAC;QACjD,MAAM8B,SAAS,CAACC,SAAS,CAACC,SAAS,CAAClB,SAAS,CAAC;QAC9C3D,oBAAoB,CAAC;UAAEmC,IAAI,EAAE,SAAS;UAAEtB,OAAO,EAAEH,CAAC,CAAC,QAAQ;QAAC,CAAE,CAAC;MAChE,CAAC,CAAC,OAAOoE,CAAC,EAAE;QACX9E,oBAAoB,CAAC;UAAEmC,IAAI,EAAE,OAAO;UAAEtB,OAAO,EAAEiE;QAAC,CAAE,CAAC;MACpD;IACD,CAAC;IACDhC,SAASA,CAAAiC,KAAA,EAAiB;MAAA,IAAhB;QAAE/B;MAAY,CAAE,GAAA+B,KAAA;MACzB,OAAO,CAAC,CAAC/B,YAAY;IACtB,CAAC;IACDO,KAAK,EAAE,CAAC;IACRC,KAAK,EAAE,MAAM;IACbC,QAAQA,CAAAuB,KAAA,EAAY;MAAA,IAAX;QAAEnE;MAAO,CAAE,GAAAmE,KAAA;MACnB,OAAOvF,aAAa,CAACoB,OAAO,CAAC;IAC9B;GACA,CAAC;EAEFF,aAAa,CAACkB,SAAS,CAAC;IACvBC,EAAE,EAAE,MAAM;IACVC,IAAI,EAAE,MAAM;IACZC,KAAK,EAAE,WAAW;IAClB;IACAC,OAAO,EAAE,CAAC,SAAS,EAAE,gBAAgB,EAAE,SAAS,EAAE,WAAW,CAAC;IAC9DE,IAAI,EAAE,aAAa;IACnB,MAAMC,MAAMA,CAACC,CAAC,EAAEC,KAAK;MACpB,MAAM;QAAEzB,OAAO,GAAGZ,WAAW,CAAC,IAAI,CAAC,CAACoB;MAAG,CAAE,GAAGiB,KAAK;MACjD,MAAM2C,OAAO,GAAGrE,kBAAkB,CAACC,OAAO,CAAC,CAACQ,GAAG;MAC/C,MAAMsD,SAAS,CAACC,SAAS,CAACC,SAAS,CAACI,OAAO,CAAC;MAC5CjF,oBAAoB,CAAC;QAAEmC,IAAI,EAAE,SAAS;QAAEtB,OAAO,EAAEH,CAAC,CAAC,QAAQ;MAAC,CAAE,CAAC;IAChE,CAAC;IACDoC,SAASA,CAAAoC,KAAA,EAAiB;MAAA,IAAhB;QAAElC;MAAY,CAAE,GAAAkC,KAAA;MACzB,OAAO,CAAC,CAAClC,YAAY;IACtB,CAAC;IACDO,KAAK,EAAE,CAAC;IACRC,KAAK,EAAE;GACP,CAAC;EAEF7C,aAAa,CAACkB,SAAS,CAAC;IACvBC,EAAE,EAAE,cAAc;IAClBC,IAAI,EAAE,MAAM;IACZC,KAAK,EAAE,MAAM;IACbC,OAAO,EAAE,CAAC,SAAS,EAAE,gBAAgB,EAAE,SAAS,EAAE,WAAW,CAAC;IAC9DE,IAAI,EAAE,YAAY;IAClB,MAAMC,MAAMA,CAACC,CAAC,EAAEC,KAAK;MACpB,MAAM;QAAEzB,OAAO,GAAGZ,WAAW,CAAC,IAAI,CAAC,CAACoB,GAAG;QAAE6C;MAAI,CAAE,GAAG5B,KAAK;MACvD,OAAM4B,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEiB,cAAc,CAACC,WAAW,CAACvE,OAAO,CAAC;IAChD,CAAC;IACDiC,SAASA,CAAAuC,KAAA,EAAgD;MAAA,IAA/C;QAAExE,OAAO;QAAEmC,YAAY;QAAEsC,QAAQ;QAAErC,IAAI;QAAEC;MAAI,CAAE,GAAAmC,KAAA;MACxD,IAAIrC,YAAY,IAAI,IAAI,EAAE;QACzB,OAAO,KAAK;MACb;MACA,IAAItD,eAAe,CAACuD,IAAI,CAAC,EAAE;QAC1B,OAAOpC,OAAO,CAAC4B,CAAC,CAACI,GAAG,MAAKK,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEL,GAAG;MACnC;MACA,MAAM0C,cAAc,GAAGjF,uBAAuB,CAAC,cAAc,EAAEO,OAAO,CAAC2E,GAAG,CAAC;MAC3E,MAAMC,aAAa,GAAGH,QAAQ,CAACI,oBAAoB;MACnD,MAAMC,OAAO,GAAG9E,OAAO,CAAC4B,CAAC,IAAI5B,OAAO,CAAC4B,CAAC,CAACI,GAAG,MAAKK,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEL,GAAG;MACxD,IAAI,EAAE0C,cAAc,IAAKE,aAAa,IAAIE,OAAQ,CAAC,EAAE;QACpD,OAAO,KAAK;MACb;MACA,MAAMC,kBAAkB,GAAGN,QAAQ,CAACO,uCAAiD;MACrF,MAAMC,oBAAoB,GAAGvF,aAAa,CAAC,mCAAmC,EAAEM,OAAO,CAAC2E,GAAG,CAAC;MAE5F,IAAI,CAACM,oBAAoB,IAAIF,kBAAkB,EAAE;QAChD,IAAIG,KAAK;QACT,IAAIlF,OAAO,CAACmF,EAAE,IAAI,IAAI,EAAE;UACvBD,KAAK,GAAGnG,MAAM,CAACiB,OAAO,CAACmF,EAAE,CAAC;QAC3B;QACA,IAAIC,aAAa;QACjB,IAAIF,KAAK,IAAI,IAAI,EAAE;UAClBE,aAAa,GAAGrG,MAAM,EAAE,CAACsG,IAAI,CAACH,KAAK,EAAE,SAAS,CAAC;QAChD;QACA,OAAO,CAAC,CAAC,CAACE,aAAa,IAAIA,aAAa,KAAK,CAAC,KAAKA,aAAa,GAAGL,kBAAkB;MACtF;MACA,OAAO,IAAI;IACZ,CAAC;IACDrC,KAAK,EAAE,CAAC;IACRC,KAAK,EAAE;GACP,CAAC;EAEF7C,aAAa,CAACkB,SAAS,CAAC;IACvBC,EAAE,EAAE,gBAAgB;IACpBC,IAAI,EAAE,OAAO;IACbC,KAAK,EAAE,QAAQ;IACfC,OAAO,EAAE,CAAC,SAAS,EAAE,gBAAgB,EAAE,SAAS,EAAE,WAAW,EAAE,WAAW,EAAE,mBAAmB,CAAC;IAChGkE,KAAK,EAAE,OAAO;IACdhE,IAAI,EAAE,YAAY;IAClB,MAAMC,MAAMA,CAAgBC,CAAC,EAAA+D,KAAA,EAA2C;MAAA,IAAzC;QAAEvF,OAAO,GAAGZ,WAAW,CAAC,IAAI,CAAC,CAACoB,GAAG;QAAE6C;MAAI,CAAE,GAAAkC,KAAA;MACvE,OAAMlC,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEmC,KAAK,CAACC,sBAAsB,CAACzF,OAAO,CAAC;IAClD,CAAC;IACDiC,SAASA,CAAAyD,MAAA,EAA4C;MAAA,IAAAC,qBAAA;MAAA,IAA3C;QAAE3F,OAAO;QAAEmC,YAAY;QAAEC,IAAI;QAAEiB,IAAI;QAAEhB;MAAI,CAAE,GAAAqD,MAAA;MACpD,IAAI,CAACvD,YAAY,EAAE;QAClB,OAAO,KAAK;MACb;MACA,IAAItD,eAAe,CAACuD,IAAI,CAAC,EAAE;QAC1B,OAAOpC,OAAO,CAAC4B,CAAC,CAACI,GAAG,MAAKK,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEL,GAAG;MACnC;MACA,MAAM4D,cAAc,GAAG1G,eAAe,CAAC0G,cAAc,CAACxD,IAAI,CAACvC,CAAC,CAAC;MAC7D,IAAI+F,cAAc,EAAE;QACnB,OAAO,KAAK;MACb;MAEA,QAAAD,qBAAA,GAAOtC,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEwC,IAAI,CAACC,gBAAgB,CAAC9F,OAAO,CAAC,cAAA2F,qBAAA,cAAAA,qBAAA,GAAI,KAAK;IACrD,CAAC;IACDjD,KAAK,EAAE,EAAE;IACTC,KAAK,EAAE;GACP,CAAC;EAEF7C,aAAa,CAACkB,SAAS,CAAC;IACvBC,EAAE,EAAE,gBAAgB;IACpBC,IAAI,EAAE,QAAQ;IACdC,KAAK,EAAE,QAAQ;IACfC,OAAO,EAAE,CAAC,SAAS,EAAE,gBAAgB,EAAE,SAAS,EAAE,WAAW,EAAE,WAAW,EAAE,mBAAmB,CAAC;IAChGkE,KAAK,EAAE,OAAO;IACdhE,IAAI,EAAE,YAAY;IAClBC,MAAMA,CAAgBC,CAAC,EAAAuE,MAAA,EAAqC;MAAA,IAAnC;QAAE/F,OAAO,GAAGZ,WAAW,CAAC,IAAI,CAAC,CAACoB;MAAG,CAAE,GAAAuF,MAAA;MAC3D9G,eAAe,CAAC8D,IAAI,CAAC;QACpBC,SAAS,EAAExD,kBAAkB;QAC7BiC,KAAK,EAAE;UACNzB,OAAO,EAAED,kBAAkB,CAACC,OAAO,CAAC;UACpCiD,OAAO,EAAEhE,eAAe,CAACiE;;OAE1B,CAAC;IACH,CAAC;IACDjB,SAASA,CAAA+D,MAAA,EAAsC;MAAA,IAArC;QAAE7D,YAAY;QAAEC,IAAI;QAAEpC,OAAO;QAAEqC;MAAI,CAAE,GAAA2D,MAAA;MAC9C,MAAMJ,cAAc,GAAG1G,eAAe,CAAC0G,cAAc,CAACxD,IAAI,CAACvC,CAAC,CAAC;MAC7D,IAAI+F,cAAc,IAAI5F,OAAO,CAAC4B,CAAC,CAACI,GAAG,MAAKK,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEL,GAAG,GAAE;QAClD,OAAO,KAAK;MACb;MAEA,OAAOiE,OAAO,CAAC9D,YAAY,CAAC;IAC7B,CAAC;IACDO,KAAK,EAAE,CAAC;IACRC,KAAK,EAAE;GACP,CAAC;EAEF7C,aAAa,CAACkB,SAAS,CAAC;IACvBC,EAAE,EAAE,eAAe;IACnBC,IAAI,EAAE,OAAO;IACbC,KAAK,EAAE,WAAW;IAClBC,OAAO,EAAE,CAAC,SAAS,EAAE,gBAAgB,EAAE,SAAS,EAAE,WAAW,EAAE,mBAAmB,CAAC;IACnFE,IAAI,EAAE,aAAa;IACnBC,MAAMA,CAAgBC,CAAC,EAAA0E,MAAA,EAAyD;MAAA,IAAvD;QAAElG,OAAO,EAAE;UAAEmG,SAAS,GAAG;QAAE,CAAE,GAAG/G,WAAW,CAAC,IAAI,CAAC,CAACoB;MAAG,CAAE,GAAA0F,MAAA;MAC/EjH,eAAe,CAAC8D,IAAI,CAAC;QACpBC,SAAS,EAAEzD,iBAAiB;QAC5BkC,KAAK,EAAE;UAAE0E,SAAS;UAAElD,OAAO,EAAEhE,eAAe,CAACiE;QAAK;OAClD,CAAC;IACH,CAAC;IACDjB,SAASA,CAAAmE,MAAA,EAA2B;MAAA,IAA1B;QAAEpG,OAAO,EAAE;UAAEmG;QAAS;MAAE,CAAE,GAAAC,MAAA;MACnC,OAAO,CAAC,CAACD,SAAS;IACnB,CAAC;IACDzD,KAAK,EAAE,CAAC;IACRC,KAAK,EAAE;GACP,CAAC;AACH,CAAC,CAAC","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"bbafa657c858a0bacd1f768df83460742e9cf5f8"}
