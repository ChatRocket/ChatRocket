{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/ee/server/apps/cron.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.arm64"},"sourceFileName":"ee/server/apps/cron.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/ee/server/apps/cron.ts","inputSourceMap":{"version":3,"file":"ee/server/apps/cron.ts","sourceRoot":"","sources":["ee/server/apps/cron.ts"],"names":[],"mappings":"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","sourcesContent":["import { AppStatus } from '@rocket.chat/apps-engine/definition/AppStatus';\nimport type { ProxiedApp } from '@rocket.chat/apps-engine/server/ProxiedApp';\nimport { cronJobs } from '@rocket.chat/cron';\nimport { Settings, Users } from '@rocket.chat/models';\nimport { serverFetch as fetch } from '@rocket.chat/server-fetch';\n\nimport { Apps } from './orchestrator';\nimport { getWorkspaceAccessToken } from '../../../app/cloud/server';\nimport { i18n } from '../../../server/lib/i18n';\nimport { sendMessagesToAdmins } from '../../../server/lib/sendMessagesToAdmins';\n\nconst notifyAdminsAboutInvalidApps = async function _notifyAdminsAboutInvalidApps(apps?: ProxiedApp[]) {\n\tif (!apps) {\n\t\treturn;\n\t}\n\n\tconst hasInvalidApps = !!apps.find((app) => app.getLatestLicenseValidationResult().hasErrors);\n\n\tif (!hasInvalidApps) {\n\t\treturn;\n\t}\n\n\tconst id = 'someAppInInvalidState';\n\tconst title = 'Warning';\n\tconst text = 'There is one or more apps in an invalid state. Click here to review.';\n\tconst rocketCatMessage = 'There is one or more apps in an invalid state. Go to Administration > Apps to review.';\n\tconst link = '/admin/apps';\n\n\tawait sendMessagesToAdmins({\n\t\tmsgs: async ({ adminUser }) => ({\n\t\t\tmsg: `*${i18n.t(title, { lng: adminUser.language || 'en' })}*\\n${i18n.t(rocketCatMessage, {\n\t\t\t\tlng: adminUser.language || 'en',\n\t\t\t})}`,\n\t\t}),\n\t\tbanners: async ({ adminUser }) => {\n\t\t\tawait Users.removeBannerById(adminUser._id, id);\n\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tid,\n\t\t\t\t\tpriority: 10,\n\t\t\t\t\ttitle,\n\t\t\t\t\ttext,\n\t\t\t\t\tmodifiers: ['danger'],\n\t\t\t\t\tlink,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t});\n\n\treturn apps;\n};\n\nconst notifyAdminsAboutRenewedApps = async function _notifyAdminsAboutRenewedApps(apps?: ProxiedApp[]) {\n\tif (!apps) {\n\t\treturn;\n\t}\n\n\tconst renewedApps = apps.filter(\n\t\tasync (app) => (await app.getStatus()) === AppStatus.DISABLED && app.getPreviousStatus() === AppStatus.INVALID_LICENSE_DISABLED,\n\t);\n\n\tif (renewedApps.length === 0) {\n\t\treturn;\n\t}\n\n\tconst rocketCatMessage = 'There is one or more disabled apps with valid licenses. Go to Administration > Apps to review.';\n\n\tawait sendMessagesToAdmins({\n\t\tmsgs: async ({ adminUser }) => ({ msg: `${i18n.t(rocketCatMessage, { lng: adminUser.language || 'en' })}` }),\n\t});\n};\n\nconst appsUpdateMarketplaceInfo = async function _appsUpdateMarketplaceInfo() {\n\tconst token = await getWorkspaceAccessToken();\n\tconst baseUrl = Apps.getMarketplaceUrl();\n\tconst workspaceIdSetting = await Settings.getValueById('Cloud_Workspace_Id');\n\n\tconst currentSeats = await Users.getActiveLocalUserCount();\n\n\tconst fullUrl = `${baseUrl}/v1/workspaces/${workspaceIdSetting}/apps`;\n\tconst options = {\n\t\theaders: {\n\t\t\tAuthorization: `Bearer ${token}`,\n\t\t},\n\t\tparams: {\n\t\t\tseats: currentSeats,\n\t\t},\n\t};\n\n\tlet data = [];\n\n\ttry {\n\t\tconst response = await fetch(fullUrl, options);\n\n\t\tconst result = await response.json();\n\n\t\tif (Array.isArray(result)) {\n\t\t\tdata = result;\n\t\t}\n\t} catch (err) {\n\t\tApps.debugLog(err);\n\t}\n\n\tawait Apps.updateAppsMarketplaceInfo(data).then(notifyAdminsAboutInvalidApps).then(notifyAdminsAboutRenewedApps);\n};\n\nawait cronJobs.add('Apps-Engine:check', '0 4 * * *', async () => appsUpdateMarketplaceInfo());\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true,"topLevelAwait":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/ee/server/apps/cron.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"ee/server/apps/cron.ts","inputSourceMap":{"version":3,"file":"ee/server/apps/cron.ts","sourceRoot":"","sources":["ee/server/apps/cron.ts"],"names":[],"mappings":"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","sourcesContent":["import { AppStatus } from '@rocket.chat/apps-engine/definition/AppStatus';\nimport type { ProxiedApp } from '@rocket.chat/apps-engine/server/ProxiedApp';\nimport { cronJobs } from '@rocket.chat/cron';\nimport { Settings, Users } from '@rocket.chat/models';\nimport { serverFetch as fetch } from '@rocket.chat/server-fetch';\n\nimport { Apps } from './orchestrator';\nimport { getWorkspaceAccessToken } from '../../../app/cloud/server';\nimport { i18n } from '../../../server/lib/i18n';\nimport { sendMessagesToAdmins } from '../../../server/lib/sendMessagesToAdmins';\n\nconst notifyAdminsAboutInvalidApps = async function _notifyAdminsAboutInvalidApps(apps?: ProxiedApp[]) {\n\tif (!apps) {\n\t\treturn;\n\t}\n\n\tconst hasInvalidApps = !!apps.find((app) => app.getLatestLicenseValidationResult().hasErrors);\n\n\tif (!hasInvalidApps) {\n\t\treturn;\n\t}\n\n\tconst id = 'someAppInInvalidState';\n\tconst title = 'Warning';\n\tconst text = 'There is one or more apps in an invalid state. Click here to review.';\n\tconst rocketCatMessage = 'There is one or more apps in an invalid state. Go to Administration > Apps to review.';\n\tconst link = '/admin/apps';\n\n\tawait sendMessagesToAdmins({\n\t\tmsgs: async ({ adminUser }) => ({\n\t\t\tmsg: `*${i18n.t(title, { lng: adminUser.language || 'en' })}*\\n${i18n.t(rocketCatMessage, {\n\t\t\t\tlng: adminUser.language || 'en',\n\t\t\t})}`,\n\t\t}),\n\t\tbanners: async ({ adminUser }) => {\n\t\t\tawait Users.removeBannerById(adminUser._id, id);\n\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tid,\n\t\t\t\t\tpriority: 10,\n\t\t\t\t\ttitle,\n\t\t\t\t\ttext,\n\t\t\t\t\tmodifiers: ['danger'],\n\t\t\t\t\tlink,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t});\n\n\treturn apps;\n};\n\nconst notifyAdminsAboutRenewedApps = async function _notifyAdminsAboutRenewedApps(apps?: ProxiedApp[]) {\n\tif (!apps) {\n\t\treturn;\n\t}\n\n\tconst renewedApps = apps.filter(\n\t\tasync (app) => (await app.getStatus()) === AppStatus.DISABLED && app.getPreviousStatus() === AppStatus.INVALID_LICENSE_DISABLED,\n\t);\n\n\tif (renewedApps.length === 0) {\n\t\treturn;\n\t}\n\n\tconst rocketCatMessage = 'There is one or more disabled apps with valid licenses. Go to Administration > Apps to review.';\n\n\tawait sendMessagesToAdmins({\n\t\tmsgs: async ({ adminUser }) => ({ msg: `${i18n.t(rocketCatMessage, { lng: adminUser.language || 'en' })}` }),\n\t});\n};\n\nconst appsUpdateMarketplaceInfo = async function _appsUpdateMarketplaceInfo() {\n\tconst token = await getWorkspaceAccessToken();\n\tconst baseUrl = Apps.getMarketplaceUrl();\n\tconst workspaceIdSetting = await Settings.getValueById('Cloud_Workspace_Id');\n\n\tconst currentSeats = await Users.getActiveLocalUserCount();\n\n\tconst fullUrl = `${baseUrl}/v1/workspaces/${workspaceIdSetting}/apps`;\n\tconst options = {\n\t\theaders: {\n\t\t\tAuthorization: `Bearer ${token}`,\n\t\t},\n\t\tparams: {\n\t\t\tseats: currentSeats,\n\t\t},\n\t};\n\n\tlet data = [];\n\n\ttry {\n\t\tconst response = await fetch(fullUrl, options);\n\n\t\tconst result = await response.json();\n\n\t\tif (Array.isArray(result)) {\n\t\t\tdata = result;\n\t\t}\n\t} catch (err) {\n\t\tApps.debugLog(err);\n\t}\n\n\tawait Apps.updateAppsMarketplaceInfo(data).then(notifyAdminsAboutInvalidApps).then(notifyAdminsAboutRenewedApps);\n};\n\nawait cronJobs.add('Apps-Engine:check', '0 4 * * *', async () => appsUpdateMarketplaceInfo());\n"]}}},"code":"!module.wrapAsync(async function (module, __reifyWaitForDeps__, __reify_async_result__) {\n  \"use strict\";\n  try {\n    let AppStatus;\n    module.link(\"@rocket.chat/apps-engine/definition/AppStatus\", {\n      AppStatus(v) {\n        AppStatus = v;\n      }\n    }, 0);\n    let cronJobs;\n    module.link(\"@rocket.chat/cron\", {\n      cronJobs(v) {\n        cronJobs = v;\n      }\n    }, 1);\n    let Settings, Users;\n    module.link(\"@rocket.chat/models\", {\n      Settings(v) {\n        Settings = v;\n      },\n      Users(v) {\n        Users = v;\n      }\n    }, 2);\n    let fetch;\n    module.link(\"@rocket.chat/server-fetch\", {\n      serverFetch(v) {\n        fetch = v;\n      }\n    }, 3);\n    let Apps;\n    module.link(\"./orchestrator\", {\n      Apps(v) {\n        Apps = v;\n      }\n    }, 4);\n    let getWorkspaceAccessToken;\n    module.link(\"../../../app/cloud/server\", {\n      getWorkspaceAccessToken(v) {\n        getWorkspaceAccessToken = v;\n      }\n    }, 5);\n    let i18n;\n    module.link(\"../../../server/lib/i18n\", {\n      i18n(v) {\n        i18n = v;\n      }\n    }, 6);\n    let sendMessagesToAdmins;\n    module.link(\"../../../server/lib/sendMessagesToAdmins\", {\n      sendMessagesToAdmins(v) {\n        sendMessagesToAdmins = v;\n      }\n    }, 7);\n    if (__reifyWaitForDeps__()) (await __reifyWaitForDeps__())();\n    const notifyAdminsAboutInvalidApps = async function _notifyAdminsAboutInvalidApps(apps) {\n      if (!apps) {\n        return;\n      }\n      const hasInvalidApps = !!apps.find(app => app.getLatestLicenseValidationResult().hasErrors);\n      if (!hasInvalidApps) {\n        return;\n      }\n      const id = 'someAppInInvalidState';\n      const title = 'Warning';\n      const text = 'There is one or more apps in an invalid state. Click here to review.';\n      const rocketCatMessage = 'There is one or more apps in an invalid state. Go to Administration > Apps to review.';\n      const link = '/admin/apps';\n      await sendMessagesToAdmins({\n        msgs: async _ref => {\n          let {\n            adminUser\n          } = _ref;\n          return {\n            msg: \"*\".concat(i18n.t(title, {\n              lng: adminUser.language || 'en'\n            }), \"*\\n\").concat(i18n.t(rocketCatMessage, {\n              lng: adminUser.language || 'en'\n            }))\n          };\n        },\n        banners: async _ref2 => {\n          let {\n            adminUser\n          } = _ref2;\n          await Users.removeBannerById(adminUser._id, id);\n          return [{\n            id,\n            priority: 10,\n            title,\n            text,\n            modifiers: ['danger'],\n            link\n          }];\n        }\n      });\n      return apps;\n    };\n    const notifyAdminsAboutRenewedApps = async function _notifyAdminsAboutRenewedApps(apps) {\n      if (!apps) {\n        return;\n      }\n      const renewedApps = apps.filter(async app => (await app.getStatus()) === AppStatus.DISABLED && app.getPreviousStatus() === AppStatus.INVALID_LICENSE_DISABLED);\n      if (renewedApps.length === 0) {\n        return;\n      }\n      const rocketCatMessage = 'There is one or more disabled apps with valid licenses. Go to Administration > Apps to review.';\n      await sendMessagesToAdmins({\n        msgs: async _ref3 => {\n          let {\n            adminUser\n          } = _ref3;\n          return {\n            msg: \"\".concat(i18n.t(rocketCatMessage, {\n              lng: adminUser.language || 'en'\n            }))\n          };\n        }\n      });\n    };\n    const appsUpdateMarketplaceInfo = async function _appsUpdateMarketplaceInfo() {\n      const token = await getWorkspaceAccessToken();\n      const baseUrl = Apps.getMarketplaceUrl();\n      const workspaceIdSetting = await Settings.getValueById('Cloud_Workspace_Id');\n      const currentSeats = await Users.getActiveLocalUserCount();\n      const fullUrl = \"\".concat(baseUrl, \"/v1/workspaces/\").concat(workspaceIdSetting, \"/apps\");\n      const options = {\n        headers: {\n          Authorization: \"Bearer \".concat(token)\n        },\n        params: {\n          seats: currentSeats\n        }\n      };\n      let data = [];\n      try {\n        const response = await fetch(fullUrl, options);\n        const result = await response.json();\n        if (Array.isArray(result)) {\n          data = result;\n        }\n      } catch (err) {\n        Apps.debugLog(err);\n      }\n      await Apps.updateAppsMarketplaceInfo(data).then(notifyAdminsAboutInvalidApps).then(notifyAdminsAboutRenewedApps);\n    };\n    await cronJobs.add('Apps-Engine:check', '0 4 * * *', async () => appsUpdateMarketplaceInfo());\n    __reify_async_result__();\n  } catch (_reifyError) {\n    return __reify_async_result__(_reifyError);\n  }\n  __reify_async_result__()\n}, {\n  self: this,\n  async: true\n});","map":{"version":3,"names":["AppStatus","module","link","v","cronJobs","Settings","Users","fetch","serverFetch","Apps","getWorkspaceAccessToken","i18n","sendMessagesToAdmins","__reifyWaitForDeps__","notifyAdminsAboutInvalidApps","_notifyAdminsAboutInvalidApps","apps","hasInvalidApps","find","app","getLatestLicenseValidationResult","hasErrors","id","title","text","rocketCatMessage","msgs","_ref","adminUser","msg","concat","t","lng","language","banners","_ref2","removeBannerById","_id","priority","modifiers","notifyAdminsAboutRenewedApps","_notifyAdminsAboutRenewedApps","renewedApps","filter","getStatus","DISABLED","getPreviousStatus","INVALID_LICENSE_DISABLED","length","_ref3","appsUpdateMarketplaceInfo","_appsUpdateMarketplaceInfo","token","baseUrl","getMarketplaceUrl","workspaceIdSetting","getValueById","currentSeats","getActiveLocalUserCount","fullUrl","options","headers","Authorization","params","seats","data","response","result","json","Array","isArray","err","debugLog","updateAppsMarketplaceInfo","then","add","__reify_async_result__","_reifyError","self","async"],"sources":["ee/server/apps/cron.ts"],"sourcesContent":["import { AppStatus } from '@rocket.chat/apps-engine/definition/AppStatus';\nimport type { ProxiedApp } from '@rocket.chat/apps-engine/server/ProxiedApp';\nimport { cronJobs } from '@rocket.chat/cron';\nimport { Settings, Users } from '@rocket.chat/models';\nimport { serverFetch as fetch } from '@rocket.chat/server-fetch';\n\nimport { Apps } from './orchestrator';\nimport { getWorkspaceAccessToken } from '../../../app/cloud/server';\nimport { i18n } from '../../../server/lib/i18n';\nimport { sendMessagesToAdmins } from '../../../server/lib/sendMessagesToAdmins';\n\nconst notifyAdminsAboutInvalidApps = async function _notifyAdminsAboutInvalidApps(apps?: ProxiedApp[]) {\n\tif (!apps) {\n\t\treturn;\n\t}\n\n\tconst hasInvalidApps = !!apps.find((app) => app.getLatestLicenseValidationResult().hasErrors);\n\n\tif (!hasInvalidApps) {\n\t\treturn;\n\t}\n\n\tconst id = 'someAppInInvalidState';\n\tconst title = 'Warning';\n\tconst text = 'There is one or more apps in an invalid state. Click here to review.';\n\tconst rocketCatMessage = 'There is one or more apps in an invalid state. Go to Administration > Apps to review.';\n\tconst link = '/admin/apps';\n\n\tawait sendMessagesToAdmins({\n\t\tmsgs: async ({ adminUser }) => ({\n\t\t\tmsg: `*${i18n.t(title, { lng: adminUser.language || 'en' })}*\\n${i18n.t(rocketCatMessage, {\n\t\t\t\tlng: adminUser.language || 'en',\n\t\t\t})}`,\n\t\t}),\n\t\tbanners: async ({ adminUser }) => {\n\t\t\tawait Users.removeBannerById(adminUser._id, id);\n\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tid,\n\t\t\t\t\tpriority: 10,\n\t\t\t\t\ttitle,\n\t\t\t\t\ttext,\n\t\t\t\t\tmodifiers: ['danger'],\n\t\t\t\t\tlink,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t});\n\n\treturn apps;\n};\n\nconst notifyAdminsAboutRenewedApps = async function _notifyAdminsAboutRenewedApps(apps?: ProxiedApp[]) {\n\tif (!apps) {\n\t\treturn;\n\t}\n\n\tconst renewedApps = apps.filter(\n\t\tasync (app) => (await app.getStatus()) === AppStatus.DISABLED && app.getPreviousStatus() === AppStatus.INVALID_LICENSE_DISABLED,\n\t);\n\n\tif (renewedApps.length === 0) {\n\t\treturn;\n\t}\n\n\tconst rocketCatMessage = 'There is one or more disabled apps with valid licenses. Go to Administration > Apps to review.';\n\n\tawait sendMessagesToAdmins({\n\t\tmsgs: async ({ adminUser }) => ({ msg: `${i18n.t(rocketCatMessage, { lng: adminUser.language || 'en' })}` }),\n\t});\n};\n\nconst appsUpdateMarketplaceInfo = async function _appsUpdateMarketplaceInfo() {\n\tconst token = await getWorkspaceAccessToken();\n\tconst baseUrl = Apps.getMarketplaceUrl();\n\tconst workspaceIdSetting = await Settings.getValueById('Cloud_Workspace_Id');\n\n\tconst currentSeats = await Users.getActiveLocalUserCount();\n\n\tconst fullUrl = `${baseUrl}/v1/workspaces/${workspaceIdSetting}/apps`;\n\tconst options = {\n\t\theaders: {\n\t\t\tAuthorization: `Bearer ${token}`,\n\t\t},\n\t\tparams: {\n\t\t\tseats: currentSeats,\n\t\t},\n\t};\n\n\tlet data = [];\n\n\ttry {\n\t\tconst response = await fetch(fullUrl, options);\n\n\t\tconst result = await response.json();\n\n\t\tif (Array.isArray(result)) {\n\t\t\tdata = result;\n\t\t}\n\t} catch (err) {\n\t\tApps.debugLog(err);\n\t}\n\n\tawait Apps.updateAppsMarketplaceInfo(data).then(notifyAdminsAboutInvalidApps).then(notifyAdminsAboutRenewedApps);\n};\n\nawait cronJobs.add('Apps-Engine:check', '0 4 * * *', async () => appsUpdateMarketplaceInfo());\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"6972c5cf39e356ee9a4ab1e2b7ecce0090a9c72c"}
