{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/omnichannel/directory/contacts/contextualBar/ContactNewEdit.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/omnichannel/directory/contacts/contextualBar/ContactNewEdit.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/omnichannel/directory/contacts/contextualBar/ContactNewEdit.tsx","inputSourceMap":{"version":3,"file":"client/views/omnichannel/directory/contacts/contextualBar/ContactNewEdit.tsx","sourceRoot":"","sources":["client/views/omnichannel/directory/contacts/contextualBar/ContactNewEdit.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { ILivechatVisitor, Serialized } from '@rocket.chat/core-typings';\nimport { Field, FieldLabel, FieldRow, FieldError, TextInput, ButtonGroup, Button, ContextualbarContent } from '@rocket.chat/fuselage';\nimport { CustomFieldsForm } from '@rocket.chat/ui-client';\nimport { useToastMessageDispatch, useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQueryClient } from '@tanstack/react-query';\nimport type { ReactElement } from 'react';\nimport React, { useState, useEffect } from 'react';\nimport { useForm } from 'react-hook-form';\n\nimport { hasAtLeastOnePermission } from '../../../../../../app/authorization/client';\nimport { validateEmail } from '../../../../../../lib/emailValidator';\nimport { ContextualbarScrollableContent, ContextualbarFooter } from '../../../../../components/Contextualbar';\nimport { createToken } from '../../../../../lib/utils/createToken';\nimport { ContactManager as ContactManagerForm } from '../../../additionalForms';\nimport { FormSkeleton } from '../../components/FormSkeleton';\nimport { useCustomFieldsMetadata } from '../../hooks/useCustomFieldsMetadata';\n\ntype ContactNewEditProps = {\n\tid: string;\n\tdata?: { contact: Serialized<ILivechatVisitor> | null };\n\tclose(): void;\n};\n\ntype ContactFormData = {\n\ttoken: string;\n\tname: string;\n\temail: string;\n\tphone: string;\n\tusername: string;\n\tcustomFields: Record<any, any>;\n};\n\nconst DEFAULT_VALUES = {\n\ttoken: '',\n\tname: '',\n\temail: '',\n\tphone: '',\n\tusername: '',\n\tcustomFields: {},\n};\n\nconst getInitialValues = (data: ContactNewEditProps['data']): ContactFormData => {\n\tif (!data) {\n\t\treturn DEFAULT_VALUES;\n\t}\n\n\tconst { name, token, phone, visitorEmails, livechatData, contactManager } = data.contact ?? {};\n\n\treturn {\n\t\ttoken: token ?? '',\n\t\tname: name ?? '',\n\t\temail: visitorEmails ? visitorEmails[0].address : '',\n\t\tphone: phone ? phone[0].phoneNumber : '',\n\t\tcustomFields: livechatData ?? {},\n\t\tusername: contactManager?.username ?? '',\n\t};\n};\n\nconst ContactNewEdit = ({ id, data, close }: ContactNewEditProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst queryClient = useQueryClient();\n\n\tconst canViewCustomFields = (): boolean =>\n\t\thasAtLeastOnePermission(['view-livechat-room-customfields', 'edit-livechat-room-customfields']);\n\n\tconst [userId, setUserId] = useState('no-agent-selected');\n\tconst saveContact = useEndpoint('POST', '/v1/omnichannel/contact');\n\tconst getContactBy = useEndpoint('GET', '/v1/omnichannel/contact.search');\n\tconst getUserData = useEndpoint('GET', '/v1/users.info');\n\n\tconst { data: customFieldsMetadata = [], isInitialLoading: isLoadingCustomFields } = useCustomFieldsMetadata({\n\t\tscope: 'visitor',\n\t\tenabled: canViewCustomFields(),\n\t});\n\n\tconst initialValue = getInitialValues(data);\n\tconst { username: initialUsername } = initialValue;\n\n\tconst {\n\t\tregister,\n\t\tformState: { errors, isValid, isDirty, isSubmitting },\n\t\tcontrol,\n\t\tsetValue,\n\t\thandleSubmit,\n\t\tsetError,\n\t} = useForm<ContactFormData>({\n\t\tmode: 'onChange',\n\t\treValidateMode: 'onChange',\n\t\tdefaultValues: initialValue,\n\t});\n\n\tuseEffect(() => {\n\t\tif (!initialUsername) {\n\t\t\treturn;\n\t\t}\n\n\t\tgetUserData({ username: initialUsername }).then(({ user }) => {\n\t\t\tsetUserId(user._id);\n\t\t});\n\t}, [getUserData, initialUsername]);\n\n\tconst validateEmailFormat = (email: string): boolean | string => {\n\t\tif (!email || email === initialValue.email) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!validateEmail(email)) {\n\t\t\treturn t('error-invalid-email-address');\n\t\t}\n\n\t\treturn true;\n\t};\n\n\tconst validateContactField = async (name: 'phone' | 'email', value: string, optional = true) => {\n\t\tif ((optional && !value) || value === initialValue[name]) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst query = { [name]: value } as Record<'phone' | 'email', string>;\n\t\tconst { contact } = await getContactBy(query);\n\t\treturn !contact || contact._id === id;\n\t};\n\n\tconst validateName = (v: string): string | boolean => (!v.trim() ? t('Required_field', { field: t('Name') }) : true);\n\n\tconst handleContactManagerChange = async (userId: string): Promise<void> => {\n\t\tsetUserId(userId);\n\n\t\tif (userId === 'no-agent-selected') {\n\t\t\tsetValue('username', '', { shouldDirty: true });\n\t\t\treturn;\n\t\t}\n\n\t\tconst { user } = await getUserData({ userId });\n\t\tsetValue('username', user.username || '', { shouldDirty: true });\n\t};\n\n\tconst validateAsync = async ({ phone = '', email = '' } = {}) => {\n\t\tconst isEmailValid = await validateContactField('email', email);\n\t\tconst isPhoneValid = await validateContactField('phone', phone);\n\n\t\t!isEmailValid && setError('email', { message: t('Email_already_exists') });\n\t\t!isPhoneValid && setError('phone', { message: t('Phone_already_exists') });\n\n\t\treturn isEmailValid && isPhoneValid;\n\t};\n\n\tconst handleSave = async (data: ContactFormData): Promise<void> => {\n\t\tif (!(await validateAsync(data))) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { name, phone, email, customFields, username, token } = data;\n\n\t\tconst payload = {\n\t\t\tname,\n\t\t\tphone,\n\t\t\temail,\n\t\t\tcustomFields,\n\t\t\ttoken: token || createToken(),\n\t\t\t...(username && { contactManager: { username } }),\n\t\t\t...(id && { _id: id }),\n\t\t};\n\n\t\ttry {\n\t\t\tawait saveContact(payload);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\tawait queryClient.invalidateQueries({ queryKey: ['current-contacts'] });\n\t\t\tclose();\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t};\n\n\tif (isLoadingCustomFields) {\n\t\treturn (\n\t\t\t<ContextualbarContent>\n\t\t\t\t<FormSkeleton />\n\t\t\t</ContextualbarContent>\n\t\t);\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarScrollableContent is='form' onSubmit={handleSubmit(handleSave)}>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel>{t('Name')}*</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput {...register('name', { validate: validateName })} error={errors.name?.message} flexGrow={1} />\n\t\t\t\t\t</FieldRow>\n\t\t\t\t\t<FieldError>{errors.name?.message}</FieldError>\n\t\t\t\t</Field>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel>{t('Email')}</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput {...register('email', { validate: validateEmailFormat })} error={errors.email?.message} flexGrow={1} />\n\t\t\t\t\t</FieldRow>\n\t\t\t\t\t<FieldError>{errors.email?.message}</FieldError>\n\t\t\t\t</Field>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel>{t('Phone')}</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput {...register('phone')} error={errors.phone?.message} flexGrow={1} />\n\t\t\t\t\t</FieldRow>\n\t\t\t\t\t<FieldError>{errors.phone?.message}</FieldError>\n\t\t\t\t</Field>\n\t\t\t\t{canViewCustomFields() && <CustomFieldsForm formName='customFields' formControl={control} metadata={customFieldsMetadata} />}\n\t\t\t\t<ContactManagerForm value={userId} handler={handleContactManagerChange} />\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button flexGrow={1} onClick={close}>\n\t\t\t\t\t\t{t('Cancel')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tmie='none'\n\t\t\t\t\t\ttype='submit'\n\t\t\t\t\t\tonClick={handleSubmit(handleSave)}\n\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\tloading={isSubmitting}\n\t\t\t\t\t\tdisabled={!isValid || !isDirty}\n\t\t\t\t\t\tprimary\n\t\t\t\t\t>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</>\n\t);\n};\n\nexport default ContactNewEdit;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/omnichannel/directory/contacts/contextualBar/ContactNewEdit.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/omnichannel/directory/contacts/contextualBar/ContactNewEdit.tsx","inputSourceMap":{"version":3,"file":"client/views/omnichannel/directory/contacts/contextualBar/ContactNewEdit.tsx","sourceRoot":"","sources":["client/views/omnichannel/directory/contacts/contextualBar/ContactNewEdit.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { ILivechatVisitor, Serialized } from '@rocket.chat/core-typings';\nimport { Field, FieldLabel, FieldRow, FieldError, TextInput, ButtonGroup, Button, ContextualbarContent } from '@rocket.chat/fuselage';\nimport { CustomFieldsForm } from '@rocket.chat/ui-client';\nimport { useToastMessageDispatch, useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQueryClient } from '@tanstack/react-query';\nimport type { ReactElement } from 'react';\nimport React, { useState, useEffect } from 'react';\nimport { useForm } from 'react-hook-form';\n\nimport { hasAtLeastOnePermission } from '../../../../../../app/authorization/client';\nimport { validateEmail } from '../../../../../../lib/emailValidator';\nimport { ContextualbarScrollableContent, ContextualbarFooter } from '../../../../../components/Contextualbar';\nimport { createToken } from '../../../../../lib/utils/createToken';\nimport { ContactManager as ContactManagerForm } from '../../../additionalForms';\nimport { FormSkeleton } from '../../components/FormSkeleton';\nimport { useCustomFieldsMetadata } from '../../hooks/useCustomFieldsMetadata';\n\ntype ContactNewEditProps = {\n\tid: string;\n\tdata?: { contact: Serialized<ILivechatVisitor> | null };\n\tclose(): void;\n};\n\ntype ContactFormData = {\n\ttoken: string;\n\tname: string;\n\temail: string;\n\tphone: string;\n\tusername: string;\n\tcustomFields: Record<any, any>;\n};\n\nconst DEFAULT_VALUES = {\n\ttoken: '',\n\tname: '',\n\temail: '',\n\tphone: '',\n\tusername: '',\n\tcustomFields: {},\n};\n\nconst getInitialValues = (data: ContactNewEditProps['data']): ContactFormData => {\n\tif (!data) {\n\t\treturn DEFAULT_VALUES;\n\t}\n\n\tconst { name, token, phone, visitorEmails, livechatData, contactManager } = data.contact ?? {};\n\n\treturn {\n\t\ttoken: token ?? '',\n\t\tname: name ?? '',\n\t\temail: visitorEmails ? visitorEmails[0].address : '',\n\t\tphone: phone ? phone[0].phoneNumber : '',\n\t\tcustomFields: livechatData ?? {},\n\t\tusername: contactManager?.username ?? '',\n\t};\n};\n\nconst ContactNewEdit = ({ id, data, close }: ContactNewEditProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst queryClient = useQueryClient();\n\n\tconst canViewCustomFields = (): boolean =>\n\t\thasAtLeastOnePermission(['view-livechat-room-customfields', 'edit-livechat-room-customfields']);\n\n\tconst [userId, setUserId] = useState('no-agent-selected');\n\tconst saveContact = useEndpoint('POST', '/v1/omnichannel/contact');\n\tconst getContactBy = useEndpoint('GET', '/v1/omnichannel/contact.search');\n\tconst getUserData = useEndpoint('GET', '/v1/users.info');\n\n\tconst { data: customFieldsMetadata = [], isInitialLoading: isLoadingCustomFields } = useCustomFieldsMetadata({\n\t\tscope: 'visitor',\n\t\tenabled: canViewCustomFields(),\n\t});\n\n\tconst initialValue = getInitialValues(data);\n\tconst { username: initialUsername } = initialValue;\n\n\tconst {\n\t\tregister,\n\t\tformState: { errors, isValid, isDirty, isSubmitting },\n\t\tcontrol,\n\t\tsetValue,\n\t\thandleSubmit,\n\t\tsetError,\n\t} = useForm<ContactFormData>({\n\t\tmode: 'onChange',\n\t\treValidateMode: 'onChange',\n\t\tdefaultValues: initialValue,\n\t});\n\n\tuseEffect(() => {\n\t\tif (!initialUsername) {\n\t\t\treturn;\n\t\t}\n\n\t\tgetUserData({ username: initialUsername }).then(({ user }) => {\n\t\t\tsetUserId(user._id);\n\t\t});\n\t}, [getUserData, initialUsername]);\n\n\tconst validateEmailFormat = (email: string): boolean | string => {\n\t\tif (!email || email === initialValue.email) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!validateEmail(email)) {\n\t\t\treturn t('error-invalid-email-address');\n\t\t}\n\n\t\treturn true;\n\t};\n\n\tconst validateContactField = async (name: 'phone' | 'email', value: string, optional = true) => {\n\t\tif ((optional && !value) || value === initialValue[name]) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst query = { [name]: value } as Record<'phone' | 'email', string>;\n\t\tconst { contact } = await getContactBy(query);\n\t\treturn !contact || contact._id === id;\n\t};\n\n\tconst validateName = (v: string): string | boolean => (!v.trim() ? t('Required_field', { field: t('Name') }) : true);\n\n\tconst handleContactManagerChange = async (userId: string): Promise<void> => {\n\t\tsetUserId(userId);\n\n\t\tif (userId === 'no-agent-selected') {\n\t\t\tsetValue('username', '', { shouldDirty: true });\n\t\t\treturn;\n\t\t}\n\n\t\tconst { user } = await getUserData({ userId });\n\t\tsetValue('username', user.username || '', { shouldDirty: true });\n\t};\n\n\tconst validateAsync = async ({ phone = '', email = '' } = {}) => {\n\t\tconst isEmailValid = await validateContactField('email', email);\n\t\tconst isPhoneValid = await validateContactField('phone', phone);\n\n\t\t!isEmailValid && setError('email', { message: t('Email_already_exists') });\n\t\t!isPhoneValid && setError('phone', { message: t('Phone_already_exists') });\n\n\t\treturn isEmailValid && isPhoneValid;\n\t};\n\n\tconst handleSave = async (data: ContactFormData): Promise<void> => {\n\t\tif (!(await validateAsync(data))) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { name, phone, email, customFields, username, token } = data;\n\n\t\tconst payload = {\n\t\t\tname,\n\t\t\tphone,\n\t\t\temail,\n\t\t\tcustomFields,\n\t\t\ttoken: token || createToken(),\n\t\t\t...(username && { contactManager: { username } }),\n\t\t\t...(id && { _id: id }),\n\t\t};\n\n\t\ttry {\n\t\t\tawait saveContact(payload);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\tawait queryClient.invalidateQueries({ queryKey: ['current-contacts'] });\n\t\t\tclose();\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t};\n\n\tif (isLoadingCustomFields) {\n\t\treturn (\n\t\t\t<ContextualbarContent>\n\t\t\t\t<FormSkeleton />\n\t\t\t</ContextualbarContent>\n\t\t);\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarScrollableContent is='form' onSubmit={handleSubmit(handleSave)}>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel>{t('Name')}*</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput {...register('name', { validate: validateName })} error={errors.name?.message} flexGrow={1} />\n\t\t\t\t\t</FieldRow>\n\t\t\t\t\t<FieldError>{errors.name?.message}</FieldError>\n\t\t\t\t</Field>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel>{t('Email')}</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput {...register('email', { validate: validateEmailFormat })} error={errors.email?.message} flexGrow={1} />\n\t\t\t\t\t</FieldRow>\n\t\t\t\t\t<FieldError>{errors.email?.message}</FieldError>\n\t\t\t\t</Field>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel>{t('Phone')}</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput {...register('phone')} error={errors.phone?.message} flexGrow={1} />\n\t\t\t\t\t</FieldRow>\n\t\t\t\t\t<FieldError>{errors.phone?.message}</FieldError>\n\t\t\t\t</Field>\n\t\t\t\t{canViewCustomFields() && <CustomFieldsForm formName='customFields' formControl={control} metadata={customFieldsMetadata} />}\n\t\t\t\t<ContactManagerForm value={userId} handler={handleContactManagerChange} />\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button flexGrow={1} onClick={close}>\n\t\t\t\t\t\t{t('Cancel')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tmie='none'\n\t\t\t\t\t\ttype='submit'\n\t\t\t\t\t\tonClick={handleSubmit(handleSave)}\n\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\tloading={isSubmitting}\n\t\t\t\t\t\tdisabled={!isValid || !isDirty}\n\t\t\t\t\t\tprimary\n\t\t\t\t\t>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</>\n\t);\n};\n\nexport default ContactNewEdit;\n"]}}},"code":"var _regeneratorRuntime;\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\nvar _extends;\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default: function (v) {\n    _extends = v;\n  }\n}, 1);\nvar _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default: function (v) {\n    _objectSpread = v;\n  }\n}, 2);\nvar _slicedToArray;\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 3);\nvar Field, FieldLabel, FieldRow, FieldError, TextInput, ButtonGroup, Button, ContextualbarContent;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Field: function (v) {\n    Field = v;\n  },\n  FieldLabel: function (v) {\n    FieldLabel = v;\n  },\n  FieldRow: function (v) {\n    FieldRow = v;\n  },\n  FieldError: function (v) {\n    FieldError = v;\n  },\n  TextInput: function (v) {\n    TextInput = v;\n  },\n  ButtonGroup: function (v) {\n    ButtonGroup = v;\n  },\n  Button: function (v) {\n    Button = v;\n  },\n  ContextualbarContent: function (v) {\n    ContextualbarContent = v;\n  }\n}, 0);\nvar CustomFieldsForm;\nmodule.link(\"@rocket.chat/ui-client\", {\n  CustomFieldsForm: function (v) {\n    CustomFieldsForm = v;\n  }\n}, 1);\nvar useToastMessageDispatch, useEndpoint, useTranslation;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useToastMessageDispatch: function (v) {\n    useToastMessageDispatch = v;\n  },\n  useEndpoint: function (v) {\n    useEndpoint = v;\n  },\n  useTranslation: function (v) {\n    useTranslation = v;\n  }\n}, 2);\nvar useQueryClient;\nmodule.link(\"@tanstack/react-query\", {\n  useQueryClient: function (v) {\n    useQueryClient = v;\n  }\n}, 3);\nvar React, useState, useEffect;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useState: function (v) {\n    useState = v;\n  },\n  useEffect: function (v) {\n    useEffect = v;\n  }\n}, 4);\nvar useForm;\nmodule.link(\"react-hook-form\", {\n  useForm: function (v) {\n    useForm = v;\n  }\n}, 5);\nvar hasAtLeastOnePermission;\nmodule.link(\"../../../../../../app/authorization/client\", {\n  hasAtLeastOnePermission: function (v) {\n    hasAtLeastOnePermission = v;\n  }\n}, 6);\nvar validateEmail;\nmodule.link(\"../../../../../../lib/emailValidator\", {\n  validateEmail: function (v) {\n    validateEmail = v;\n  }\n}, 7);\nvar ContextualbarScrollableContent, ContextualbarFooter;\nmodule.link(\"../../../../../components/Contextualbar\", {\n  ContextualbarScrollableContent: function (v) {\n    ContextualbarScrollableContent = v;\n  },\n  ContextualbarFooter: function (v) {\n    ContextualbarFooter = v;\n  }\n}, 8);\nvar createToken;\nmodule.link(\"../../../../../lib/utils/createToken\", {\n  createToken: function (v) {\n    createToken = v;\n  }\n}, 9);\nvar ContactManagerForm;\nmodule.link(\"../../../additionalForms\", {\n  ContactManager: function (v) {\n    ContactManagerForm = v;\n  }\n}, 10);\nvar FormSkeleton;\nmodule.link(\"../../components/FormSkeleton\", {\n  FormSkeleton: function (v) {\n    FormSkeleton = v;\n  }\n}, 11);\nvar useCustomFieldsMetadata;\nmodule.link(\"../../hooks/useCustomFieldsMetadata\", {\n  useCustomFieldsMetadata: function (v) {\n    useCustomFieldsMetadata = v;\n  }\n}, 12);\nvar DEFAULT_VALUES = {\n  token: '',\n  name: '',\n  email: '',\n  phone: '',\n  username: '',\n  customFields: {}\n};\nvar getInitialValues = function (data) {\n  var _data$contact, _contactManager$usern;\n  if (!data) {\n    return DEFAULT_VALUES;\n  }\n  var _ref = (_data$contact = data.contact) !== null && _data$contact !== void 0 ? _data$contact : {},\n    name = _ref.name,\n    token = _ref.token,\n    phone = _ref.phone,\n    visitorEmails = _ref.visitorEmails,\n    livechatData = _ref.livechatData,\n    contactManager = _ref.contactManager;\n  return {\n    token: token !== null && token !== void 0 ? token : '',\n    name: name !== null && name !== void 0 ? name : '',\n    email: visitorEmails ? visitorEmails[0].address : '',\n    phone: phone ? phone[0].phoneNumber : '',\n    customFields: livechatData !== null && livechatData !== void 0 ? livechatData : {},\n    username: (_contactManager$usern = contactManager === null || contactManager === void 0 ? void 0 : contactManager.username) !== null && _contactManager$usern !== void 0 ? _contactManager$usern : ''\n  };\n};\nvar ContactNewEdit = function (_ref2) {\n  var _errors$name, _errors$name2, _errors$email, _errors$email2, _errors$phone, _errors$phone2;\n  var id = _ref2.id,\n    data = _ref2.data,\n    close = _ref2.close;\n  var t = useTranslation();\n  var dispatchToastMessage = useToastMessageDispatch();\n  var queryClient = useQueryClient();\n  var canViewCustomFields = function () {\n    return hasAtLeastOnePermission(['view-livechat-room-customfields', 'edit-livechat-room-customfields']);\n  };\n  var _useState = useState('no-agent-selected'),\n    _useState2 = _slicedToArray(_useState, 2),\n    userId = _useState2[0],\n    setUserId = _useState2[1];\n  var saveContact = useEndpoint('POST', '/v1/omnichannel/contact');\n  var getContactBy = useEndpoint('GET', '/v1/omnichannel/contact.search');\n  var getUserData = useEndpoint('GET', '/v1/users.info');\n  var _useCustomFieldsMetad = useCustomFieldsMetadata({\n      scope: 'visitor',\n      enabled: canViewCustomFields()\n    }),\n    _useCustomFieldsMetad2 = _useCustomFieldsMetad.data,\n    customFieldsMetadata = _useCustomFieldsMetad2 === void 0 ? [] : _useCustomFieldsMetad2,\n    isLoadingCustomFields = _useCustomFieldsMetad.isInitialLoading;\n  var initialValue = getInitialValues(data);\n  var initialUsername = initialValue.username;\n  var _useForm = useForm({\n      mode: 'onChange',\n      reValidateMode: 'onChange',\n      defaultValues: initialValue\n    }),\n    register = _useForm.register,\n    _useForm$formState = _useForm.formState,\n    errors = _useForm$formState.errors,\n    isValid = _useForm$formState.isValid,\n    isDirty = _useForm$formState.isDirty,\n    isSubmitting = _useForm$formState.isSubmitting,\n    control = _useForm.control,\n    setValue = _useForm.setValue,\n    handleSubmit = _useForm.handleSubmit,\n    setError = _useForm.setError;\n  useEffect(function () {\n    if (!initialUsername) {\n      return;\n    }\n    getUserData({\n      username: initialUsername\n    }).then(function (_ref3) {\n      var user = _ref3.user;\n      setUserId(user._id);\n    });\n  }, [getUserData, initialUsername]);\n  var validateEmailFormat = function (email) {\n    if (!email || email === initialValue.email) {\n      return true;\n    }\n    if (!validateEmail(email)) {\n      return t('error-invalid-email-address');\n    }\n    return true;\n  };\n  var validateContactField = function () {\n    function _callee(name, value) {\n      var _query;\n      var optional,\n        query,\n        _await$getContactBy,\n        contact,\n        _args = arguments;\n      return _regeneratorRuntime.async(function () {\n        function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              optional = _args.length > 2 && _args[2] !== undefined ? _args[2] : true;\n              if (!(optional && !value || value === initialValue[name])) {\n                _context.next = 3;\n                break;\n              }\n              return _context.abrupt(\"return\", true);\n            case 3:\n              query = (_query = {}, _query[name] = value, _query);\n              _context.next = 6;\n              return _regeneratorRuntime.awrap(getContactBy(query));\n            case 6:\n              _await$getContactBy = _context.sent;\n              contact = _await$getContactBy.contact;\n              return _context.abrupt(\"return\", !contact || contact._id === id);\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n        return _callee$;\n      }(), null, null, null, Promise);\n    }\n    return _callee;\n  }();\n  var validateName = function (v) {\n    return !v.trim() ? t('Required_field', {\n      field: t('Name')\n    }) : true;\n  };\n  var handleContactManagerChange = function () {\n    function _callee2(userId) {\n      var _await$getUserData, user;\n      return _regeneratorRuntime.async(function () {\n        function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              setUserId(userId);\n              if (!(userId === 'no-agent-selected')) {\n                _context2.next = 4;\n                break;\n              }\n              setValue('username', '', {\n                shouldDirty: true\n              });\n              return _context2.abrupt(\"return\");\n            case 4:\n              _context2.next = 6;\n              return _regeneratorRuntime.awrap(getUserData({\n                userId: userId\n              }));\n            case 6:\n              _await$getUserData = _context2.sent;\n              user = _await$getUserData.user;\n              setValue('username', user.username || '', {\n                shouldDirty: true\n              });\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n        return _callee2$;\n      }(), null, null, null, Promise);\n    }\n    return _callee2;\n  }();\n  var validateAsync = function () {\n    function _callee3() {\n      var _ref4,\n        _ref4$phone,\n        phone,\n        _ref4$email,\n        email,\n        isEmailValid,\n        isPhoneValid,\n        _args3 = arguments;\n      return _regeneratorRuntime.async(function () {\n        function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _ref4 = _args3.length > 0 && _args3[0] !== undefined ? _args3[0] : {}, _ref4$phone = _ref4.phone, phone = _ref4$phone === void 0 ? '' : _ref4$phone, _ref4$email = _ref4.email, email = _ref4$email === void 0 ? '' : _ref4$email;\n              _context3.next = 3;\n              return _regeneratorRuntime.awrap(validateContactField('email', email));\n            case 3:\n              isEmailValid = _context3.sent;\n              _context3.next = 6;\n              return _regeneratorRuntime.awrap(validateContactField('phone', phone));\n            case 6:\n              isPhoneValid = _context3.sent;\n              !isEmailValid && setError('email', {\n                message: t('Email_already_exists')\n              });\n              !isPhoneValid && setError('phone', {\n                message: t('Phone_already_exists')\n              });\n              return _context3.abrupt(\"return\", isEmailValid && isPhoneValid);\n            case 10:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n        return _callee3$;\n      }(), null, null, null, Promise);\n    }\n    return _callee3;\n  }();\n  var handleSave = function () {\n    function _callee4(data) {\n      var name, phone, email, customFields, username, token, payload;\n      return _regeneratorRuntime.async(function () {\n        function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return _regeneratorRuntime.awrap(validateAsync(data));\n            case 2:\n              if (_context4.sent) {\n                _context4.next = 4;\n                break;\n              }\n              return _context4.abrupt(\"return\");\n            case 4:\n              name = data.name, phone = data.phone, email = data.email, customFields = data.customFields, username = data.username, token = data.token;\n              payload = _objectSpread(_objectSpread({\n                name: name,\n                phone: phone,\n                email: email,\n                customFields: customFields,\n                token: token || createToken()\n              }, username && {\n                contactManager: {\n                  username: username\n                }\n              }), id && {\n                _id: id\n              });\n              _context4.prev = 6;\n              _context4.next = 9;\n              return _regeneratorRuntime.awrap(saveContact(payload));\n            case 9:\n              dispatchToastMessage({\n                type: 'success',\n                message: t('Saved')\n              });\n              _context4.next = 12;\n              return _regeneratorRuntime.awrap(queryClient.invalidateQueries({\n                queryKey: ['current-contacts']\n              }));\n            case 12:\n              close();\n              _context4.next = 18;\n              break;\n            case 15:\n              _context4.prev = 15;\n              _context4.t0 = _context4[\"catch\"](6);\n              dispatchToastMessage({\n                type: 'error',\n                message: _context4.t0\n              });\n            case 18:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n        return _callee4$;\n      }(), null, null, [[6, 15]], Promise);\n    }\n    return _callee4;\n  }();\n  if (isLoadingCustomFields) {\n    return /*#__PURE__*/React.createElement(ContextualbarContent, null, /*#__PURE__*/React.createElement(FormSkeleton, null));\n  }\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ContextualbarScrollableContent, {\n    is: \"form\",\n    onSubmit: handleSubmit(handleSave)\n  }, /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(FieldLabel, null, t('Name'), \"*\"), /*#__PURE__*/React.createElement(FieldRow, null, /*#__PURE__*/React.createElement(TextInput, _extends({}, register('name', {\n    validate: validateName\n  }), {\n    error: (_errors$name = errors.name) === null || _errors$name === void 0 ? void 0 : _errors$name.message,\n    flexGrow: 1\n  }))), /*#__PURE__*/React.createElement(FieldError, null, (_errors$name2 = errors.name) === null || _errors$name2 === void 0 ? void 0 : _errors$name2.message)), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(FieldLabel, null, t('Email')), /*#__PURE__*/React.createElement(FieldRow, null, /*#__PURE__*/React.createElement(TextInput, _extends({}, register('email', {\n    validate: validateEmailFormat\n  }), {\n    error: (_errors$email = errors.email) === null || _errors$email === void 0 ? void 0 : _errors$email.message,\n    flexGrow: 1\n  }))), /*#__PURE__*/React.createElement(FieldError, null, (_errors$email2 = errors.email) === null || _errors$email2 === void 0 ? void 0 : _errors$email2.message)), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(FieldLabel, null, t('Phone')), /*#__PURE__*/React.createElement(FieldRow, null, /*#__PURE__*/React.createElement(TextInput, _extends({}, register('phone'), {\n    error: (_errors$phone = errors.phone) === null || _errors$phone === void 0 ? void 0 : _errors$phone.message,\n    flexGrow: 1\n  }))), /*#__PURE__*/React.createElement(FieldError, null, (_errors$phone2 = errors.phone) === null || _errors$phone2 === void 0 ? void 0 : _errors$phone2.message)), canViewCustomFields() && /*#__PURE__*/React.createElement(CustomFieldsForm, {\n    formName: \"customFields\",\n    formControl: control,\n    metadata: customFieldsMetadata\n  }), /*#__PURE__*/React.createElement(ContactManagerForm, {\n    value: userId,\n    handler: handleContactManagerChange\n  })), /*#__PURE__*/React.createElement(ContextualbarFooter, null, /*#__PURE__*/React.createElement(ButtonGroup, {\n    stretch: true\n  }, /*#__PURE__*/React.createElement(Button, {\n    flexGrow: 1,\n    onClick: close\n  }, t('Cancel')), /*#__PURE__*/React.createElement(Button, {\n    mie: \"none\",\n    type: \"submit\",\n    onClick: handleSubmit(handleSave),\n    flexGrow: 1,\n    loading: isSubmitting,\n    disabled: !isValid || !isDirty,\n    primary: true\n  }, t('Save')))));\n};\nmodule.exportDefault(ContactNewEdit);","map":{"version":3,"names":["_regeneratorRuntime","module","link","default","v","_extends","_objectSpread","_slicedToArray","Field","FieldLabel","FieldRow","FieldError","TextInput","ButtonGroup","Button","ContextualbarContent","CustomFieldsForm","useToastMessageDispatch","useEndpoint","useTranslation","useQueryClient","React","useState","useEffect","useForm","hasAtLeastOnePermission","validateEmail","ContextualbarScrollableContent","ContextualbarFooter","createToken","ContactManagerForm","ContactManager","FormSkeleton","useCustomFieldsMetadata","DEFAULT_VALUES","token","name","email","phone","username","customFields","getInitialValues","data","_data$contact","_contactManager$usern","_ref","contact","visitorEmails","livechatData","contactManager","address","phoneNumber","ContactNewEdit","_ref2","_errors$name","_errors$name2","_errors$email","_errors$email2","_errors$phone","_errors$phone2","id","close","t","dispatchToastMessage","queryClient","canViewCustomFields","_useState","_useState2","userId","setUserId","saveContact","getContactBy","getUserData","_useCustomFieldsMetad","scope","enabled","_useCustomFieldsMetad2","customFieldsMetadata","isLoadingCustomFields","isInitialLoading","initialValue","initialUsername","_useForm","mode","reValidateMode","defaultValues","register","_useForm$formState","formState","errors","isValid","isDirty","isSubmitting","control","setValue","handleSubmit","setError","then","_ref3","user","_id","validateEmailFormat","validateContactField","_callee","value","_query","optional","query","_await$getContactBy","_args","arguments","async","_callee$","_context","prev","next","length","undefined","abrupt","awrap","sent","stop","Promise","validateName","trim","field","handleContactManagerChange","_callee2","_await$getUserData","_callee2$","_context2","shouldDirty","validateAsync","_callee3","_ref4","_ref4$phone","_ref4$email","isEmailValid","isPhoneValid","_args3","_callee3$","_context3","message","handleSave","_callee4","payload","_callee4$","_context4","type","invalidateQueries","queryKey","t0","createElement","Fragment","is","onSubmit","validate","error","flexGrow","formName","formControl","metadata","handler","stretch","onClick","mie","loading","disabled","primary","exportDefault"],"sources":["client/views/omnichannel/directory/contacts/contextualBar/ContactNewEdit.tsx"],"sourcesContent":["import type { ILivechatVisitor, Serialized } from '@rocket.chat/core-typings';\nimport { Field, FieldLabel, FieldRow, FieldError, TextInput, ButtonGroup, Button, ContextualbarContent } from '@rocket.chat/fuselage';\nimport { CustomFieldsForm } from '@rocket.chat/ui-client';\nimport { useToastMessageDispatch, useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQueryClient } from '@tanstack/react-query';\nimport type { ReactElement } from 'react';\nimport React, { useState, useEffect } from 'react';\nimport { useForm } from 'react-hook-form';\n\nimport { hasAtLeastOnePermission } from '../../../../../../app/authorization/client';\nimport { validateEmail } from '../../../../../../lib/emailValidator';\nimport { ContextualbarScrollableContent, ContextualbarFooter } from '../../../../../components/Contextualbar';\nimport { createToken } from '../../../../../lib/utils/createToken';\nimport { ContactManager as ContactManagerForm } from '../../../additionalForms';\nimport { FormSkeleton } from '../../components/FormSkeleton';\nimport { useCustomFieldsMetadata } from '../../hooks/useCustomFieldsMetadata';\n\ntype ContactNewEditProps = {\n\tid: string;\n\tdata?: { contact: Serialized<ILivechatVisitor> | null };\n\tclose(): void;\n};\n\ntype ContactFormData = {\n\ttoken: string;\n\tname: string;\n\temail: string;\n\tphone: string;\n\tusername: string;\n\tcustomFields: Record<any, any>;\n};\n\nconst DEFAULT_VALUES = {\n\ttoken: '',\n\tname: '',\n\temail: '',\n\tphone: '',\n\tusername: '',\n\tcustomFields: {},\n};\n\nconst getInitialValues = (data: ContactNewEditProps['data']): ContactFormData => {\n\tif (!data) {\n\t\treturn DEFAULT_VALUES;\n\t}\n\n\tconst { name, token, phone, visitorEmails, livechatData, contactManager } = data.contact ?? {};\n\n\treturn {\n\t\ttoken: token ?? '',\n\t\tname: name ?? '',\n\t\temail: visitorEmails ? visitorEmails[0].address : '',\n\t\tphone: phone ? phone[0].phoneNumber : '',\n\t\tcustomFields: livechatData ?? {},\n\t\tusername: contactManager?.username ?? '',\n\t};\n};\n\nconst ContactNewEdit = ({ id, data, close }: ContactNewEditProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst queryClient = useQueryClient();\n\n\tconst canViewCustomFields = (): boolean =>\n\t\thasAtLeastOnePermission(['view-livechat-room-customfields', 'edit-livechat-room-customfields']);\n\n\tconst [userId, setUserId] = useState('no-agent-selected');\n\tconst saveContact = useEndpoint('POST', '/v1/omnichannel/contact');\n\tconst getContactBy = useEndpoint('GET', '/v1/omnichannel/contact.search');\n\tconst getUserData = useEndpoint('GET', '/v1/users.info');\n\n\tconst { data: customFieldsMetadata = [], isInitialLoading: isLoadingCustomFields } = useCustomFieldsMetadata({\n\t\tscope: 'visitor',\n\t\tenabled: canViewCustomFields(),\n\t});\n\n\tconst initialValue = getInitialValues(data);\n\tconst { username: initialUsername } = initialValue;\n\n\tconst {\n\t\tregister,\n\t\tformState: { errors, isValid, isDirty, isSubmitting },\n\t\tcontrol,\n\t\tsetValue,\n\t\thandleSubmit,\n\t\tsetError,\n\t} = useForm<ContactFormData>({\n\t\tmode: 'onChange',\n\t\treValidateMode: 'onChange',\n\t\tdefaultValues: initialValue,\n\t});\n\n\tuseEffect(() => {\n\t\tif (!initialUsername) {\n\t\t\treturn;\n\t\t}\n\n\t\tgetUserData({ username: initialUsername }).then(({ user }) => {\n\t\t\tsetUserId(user._id);\n\t\t});\n\t}, [getUserData, initialUsername]);\n\n\tconst validateEmailFormat = (email: string): boolean | string => {\n\t\tif (!email || email === initialValue.email) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!validateEmail(email)) {\n\t\t\treturn t('error-invalid-email-address');\n\t\t}\n\n\t\treturn true;\n\t};\n\n\tconst validateContactField = async (name: 'phone' | 'email', value: string, optional = true) => {\n\t\tif ((optional && !value) || value === initialValue[name]) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst query = { [name]: value } as Record<'phone' | 'email', string>;\n\t\tconst { contact } = await getContactBy(query);\n\t\treturn !contact || contact._id === id;\n\t};\n\n\tconst validateName = (v: string): string | boolean => (!v.trim() ? t('Required_field', { field: t('Name') }) : true);\n\n\tconst handleContactManagerChange = async (userId: string): Promise<void> => {\n\t\tsetUserId(userId);\n\n\t\tif (userId === 'no-agent-selected') {\n\t\t\tsetValue('username', '', { shouldDirty: true });\n\t\t\treturn;\n\t\t}\n\n\t\tconst { user } = await getUserData({ userId });\n\t\tsetValue('username', user.username || '', { shouldDirty: true });\n\t};\n\n\tconst validateAsync = async ({ phone = '', email = '' } = {}) => {\n\t\tconst isEmailValid = await validateContactField('email', email);\n\t\tconst isPhoneValid = await validateContactField('phone', phone);\n\n\t\t!isEmailValid && setError('email', { message: t('Email_already_exists') });\n\t\t!isPhoneValid && setError('phone', { message: t('Phone_already_exists') });\n\n\t\treturn isEmailValid && isPhoneValid;\n\t};\n\n\tconst handleSave = async (data: ContactFormData): Promise<void> => {\n\t\tif (!(await validateAsync(data))) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { name, phone, email, customFields, username, token } = data;\n\n\t\tconst payload = {\n\t\t\tname,\n\t\t\tphone,\n\t\t\temail,\n\t\t\tcustomFields,\n\t\t\ttoken: token || createToken(),\n\t\t\t...(username && { contactManager: { username } }),\n\t\t\t...(id && { _id: id }),\n\t\t};\n\n\t\ttry {\n\t\t\tawait saveContact(payload);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\tawait queryClient.invalidateQueries({ queryKey: ['current-contacts'] });\n\t\t\tclose();\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t};\n\n\tif (isLoadingCustomFields) {\n\t\treturn (\n\t\t\t<ContextualbarContent>\n\t\t\t\t<FormSkeleton />\n\t\t\t</ContextualbarContent>\n\t\t);\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarScrollableContent is='form' onSubmit={handleSubmit(handleSave)}>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel>{t('Name')}*</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput {...register('name', { validate: validateName })} error={errors.name?.message} flexGrow={1} />\n\t\t\t\t\t</FieldRow>\n\t\t\t\t\t<FieldError>{errors.name?.message}</FieldError>\n\t\t\t\t</Field>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel>{t('Email')}</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput {...register('email', { validate: validateEmailFormat })} error={errors.email?.message} flexGrow={1} />\n\t\t\t\t\t</FieldRow>\n\t\t\t\t\t<FieldError>{errors.email?.message}</FieldError>\n\t\t\t\t</Field>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel>{t('Phone')}</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput {...register('phone')} error={errors.phone?.message} flexGrow={1} />\n\t\t\t\t\t</FieldRow>\n\t\t\t\t\t<FieldError>{errors.phone?.message}</FieldError>\n\t\t\t\t</Field>\n\t\t\t\t{canViewCustomFields() && <CustomFieldsForm formName='customFields' formControl={control} metadata={customFieldsMetadata} />}\n\t\t\t\t<ContactManagerForm value={userId} handler={handleContactManagerChange} />\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button flexGrow={1} onClick={close}>\n\t\t\t\t\t\t{t('Cancel')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tmie='none'\n\t\t\t\t\t\ttype='submit'\n\t\t\t\t\t\tonClick={handleSubmit(handleSave)}\n\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\tloading={isSubmitting}\n\t\t\t\t\t\tdisabled={!isValid || !isDirty}\n\t\t\t\t\t\tprimary\n\t\t\t\t\t>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</>\n\t);\n};\n\nexport default ContactNewEdit;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"9f5b3e6b2a1ecb1cbfeb5120b5dda96c43c12045"}
