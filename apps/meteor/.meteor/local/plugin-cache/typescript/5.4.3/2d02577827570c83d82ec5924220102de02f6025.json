{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/contextualBar/Info/EditRoomInfo/useEditRoomPermissions.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/room/contextualBar/Info/EditRoomInfo/useEditRoomPermissions.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/contextualBar/Info/EditRoomInfo/useEditRoomPermissions.ts","inputSourceMap":{"version":3,"file":"client/views/room/contextualBar/Info/EditRoomInfo/useEditRoomPermissions.ts","sourceRoot":"","sources":["client/views/room/contextualBar/Info/EditRoomInfo/useEditRoomPermissions.ts"],"names":[],"mappings":"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","sourcesContent":["import type { IRoom, IRoomWithRetentionPolicy } from '@rocket.chat/core-typings';\nimport { usePermission, useAtLeastOnePermission, useRole, useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport { useMemo } from 'react';\n\nimport { E2EEState } from '../../../../../../app/e2e/client/E2EEState';\nimport { RoomSettingsEnum } from '../../../../../../definition/IRoomTypeConfig';\nimport { roomCoordinator } from '../../../../../lib/rooms/roomCoordinator';\nimport { useE2EEState } from '../../../hooks/useE2EEState';\n\nconst getCanChangeType = (room: IRoom | IRoomWithRetentionPolicy, canCreateChannel: boolean, canCreateGroup: boolean, isAdmin: boolean) =>\n\t(!room.default || isAdmin) && ((room.t === 'p' && canCreateChannel) || (room.t === 'c' && canCreateGroup));\n\nexport const useEditRoomPermissions = (room: IRoom | IRoomWithRetentionPolicy) => {\n\tconst isAdmin = useRole('admin');\n\tconst e2eeState = useE2EEState();\n\tconst isE2EEReady = e2eeState === E2EEState.READY || e2eeState === E2EEState.SAVE_PASSWORD;\n\tconst canCreateChannel = usePermission('create-c');\n\tconst canCreateGroup = usePermission('create-p');\n\tconst teamsInfoEndpoint = useEndpoint('GET', '/v1/teams.info');\n\n\tconst teamId = room.teamId || '';\n\tconst { data: teamInfoData } = useQuery(['teamId', teamId], async () => teamsInfoEndpoint({ teamId }), {\n\t\tkeepPreviousData: true,\n\t\tretry: false,\n\t\tenabled: room.teamId !== '',\n\t});\n\n\tconst canCreateTeamChannel = usePermission('create-team-channel', teamInfoData?.teamInfo.roomId);\n\tconst canCreateTeamGroup = usePermission('create-team-group', teamInfoData?.teamInfo.roomId);\n\n\tconst canChangeType = getCanChangeType(\n\t\troom,\n\t\tteamId ? canCreateTeamChannel : canCreateChannel,\n\t\tteamId ? canCreateTeamGroup : canCreateGroup,\n\t\tisAdmin,\n\t);\n\tconst canSetReadOnly = usePermission('set-readonly', room._id);\n\tconst canSetReactWhenReadOnly = usePermission('set-react-when-readonly', room._id);\n\tconst canEditRoomRetentionPolicy = usePermission('edit-room-retention-policy', room._id);\n\tconst canArchiveOrUnarchive = useAtLeastOnePermission(\n\t\tuseMemo(() => ['archive-room', 'unarchive-room'], []),\n\t\troom._id,\n\t);\n\tconst canToggleEncryption = usePermission('toggle-room-e2e-encryption', room._id) && (room.encrypted || isE2EEReady);\n\n\tconst [\n\t\tcanViewName,\n\t\tcanViewTopic,\n\t\tcanViewAnnouncement,\n\t\tcanViewArchived,\n\t\tcanViewDescription,\n\t\tcanViewType,\n\t\tcanViewReadOnly,\n\t\tcanViewHideSysMes,\n\t\tcanViewJoinCode,\n\t\tcanViewReactWhenReadOnly,\n\t\tcanViewEncrypted,\n\t] = useMemo(() => {\n\t\tconst isAllowed =\n\t\t\troomCoordinator.getRoomDirectives(room.t)?.allowRoomSettingChange ||\n\t\t\t(() => {\n\t\t\t\tundefined;\n\t\t\t});\n\t\treturn [\n\t\t\tisAllowed(room, RoomSettingsEnum.NAME),\n\t\t\tisAllowed(room, RoomSettingsEnum.TOPIC),\n\t\t\tisAllowed(room, RoomSettingsEnum.ANNOUNCEMENT),\n\t\t\tisAllowed(room, RoomSettingsEnum.ARCHIVE_OR_UNARCHIVE),\n\t\t\tisAllowed(room, RoomSettingsEnum.DESCRIPTION),\n\t\t\tisAllowed(room, RoomSettingsEnum.TYPE),\n\t\t\tisAllowed(room, RoomSettingsEnum.READ_ONLY),\n\t\t\tisAllowed(room, RoomSettingsEnum.SYSTEM_MESSAGES),\n\t\t\tisAllowed(room, RoomSettingsEnum.JOIN_CODE),\n\t\t\tisAllowed(room, RoomSettingsEnum.REACT_WHEN_READ_ONLY),\n\t\t\tisAllowed(room, RoomSettingsEnum.E2E),\n\t\t];\n\t}, [room]);\n\n\treturn {\n\t\tcanChangeType,\n\t\tcanSetReadOnly,\n\t\tcanSetReactWhenReadOnly,\n\t\tcanEditRoomRetentionPolicy,\n\t\tcanArchiveOrUnarchive,\n\t\tcanToggleEncryption,\n\t\tcanViewName,\n\t\tcanViewTopic,\n\t\tcanViewAnnouncement,\n\t\tcanViewArchived,\n\t\tcanViewDescription,\n\t\tcanViewType,\n\t\tcanViewReadOnly,\n\t\tcanViewHideSysMes,\n\t\tcanViewJoinCode,\n\t\tcanViewReactWhenReadOnly,\n\t\tcanViewEncrypted,\n\t};\n};\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/contextualBar/Info/EditRoomInfo/useEditRoomPermissions.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/contextualBar/Info/EditRoomInfo/useEditRoomPermissions.ts","inputSourceMap":{"version":3,"file":"client/views/room/contextualBar/Info/EditRoomInfo/useEditRoomPermissions.ts","sourceRoot":"","sources":["client/views/room/contextualBar/Info/EditRoomInfo/useEditRoomPermissions.ts"],"names":[],"mappings":"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","sourcesContent":["import type { IRoom, IRoomWithRetentionPolicy } from '@rocket.chat/core-typings';\nimport { usePermission, useAtLeastOnePermission, useRole, useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport { useMemo } from 'react';\n\nimport { E2EEState } from '../../../../../../app/e2e/client/E2EEState';\nimport { RoomSettingsEnum } from '../../../../../../definition/IRoomTypeConfig';\nimport { roomCoordinator } from '../../../../../lib/rooms/roomCoordinator';\nimport { useE2EEState } from '../../../hooks/useE2EEState';\n\nconst getCanChangeType = (room: IRoom | IRoomWithRetentionPolicy, canCreateChannel: boolean, canCreateGroup: boolean, isAdmin: boolean) =>\n\t(!room.default || isAdmin) && ((room.t === 'p' && canCreateChannel) || (room.t === 'c' && canCreateGroup));\n\nexport const useEditRoomPermissions = (room: IRoom | IRoomWithRetentionPolicy) => {\n\tconst isAdmin = useRole('admin');\n\tconst e2eeState = useE2EEState();\n\tconst isE2EEReady = e2eeState === E2EEState.READY || e2eeState === E2EEState.SAVE_PASSWORD;\n\tconst canCreateChannel = usePermission('create-c');\n\tconst canCreateGroup = usePermission('create-p');\n\tconst teamsInfoEndpoint = useEndpoint('GET', '/v1/teams.info');\n\n\tconst teamId = room.teamId || '';\n\tconst { data: teamInfoData } = useQuery(['teamId', teamId], async () => teamsInfoEndpoint({ teamId }), {\n\t\tkeepPreviousData: true,\n\t\tretry: false,\n\t\tenabled: room.teamId !== '',\n\t});\n\n\tconst canCreateTeamChannel = usePermission('create-team-channel', teamInfoData?.teamInfo.roomId);\n\tconst canCreateTeamGroup = usePermission('create-team-group', teamInfoData?.teamInfo.roomId);\n\n\tconst canChangeType = getCanChangeType(\n\t\troom,\n\t\tteamId ? canCreateTeamChannel : canCreateChannel,\n\t\tteamId ? canCreateTeamGroup : canCreateGroup,\n\t\tisAdmin,\n\t);\n\tconst canSetReadOnly = usePermission('set-readonly', room._id);\n\tconst canSetReactWhenReadOnly = usePermission('set-react-when-readonly', room._id);\n\tconst canEditRoomRetentionPolicy = usePermission('edit-room-retention-policy', room._id);\n\tconst canArchiveOrUnarchive = useAtLeastOnePermission(\n\t\tuseMemo(() => ['archive-room', 'unarchive-room'], []),\n\t\troom._id,\n\t);\n\tconst canToggleEncryption = usePermission('toggle-room-e2e-encryption', room._id) && (room.encrypted || isE2EEReady);\n\n\tconst [\n\t\tcanViewName,\n\t\tcanViewTopic,\n\t\tcanViewAnnouncement,\n\t\tcanViewArchived,\n\t\tcanViewDescription,\n\t\tcanViewType,\n\t\tcanViewReadOnly,\n\t\tcanViewHideSysMes,\n\t\tcanViewJoinCode,\n\t\tcanViewReactWhenReadOnly,\n\t\tcanViewEncrypted,\n\t] = useMemo(() => {\n\t\tconst isAllowed =\n\t\t\troomCoordinator.getRoomDirectives(room.t)?.allowRoomSettingChange ||\n\t\t\t(() => {\n\t\t\t\tundefined;\n\t\t\t});\n\t\treturn [\n\t\t\tisAllowed(room, RoomSettingsEnum.NAME),\n\t\t\tisAllowed(room, RoomSettingsEnum.TOPIC),\n\t\t\tisAllowed(room, RoomSettingsEnum.ANNOUNCEMENT),\n\t\t\tisAllowed(room, RoomSettingsEnum.ARCHIVE_OR_UNARCHIVE),\n\t\t\tisAllowed(room, RoomSettingsEnum.DESCRIPTION),\n\t\t\tisAllowed(room, RoomSettingsEnum.TYPE),\n\t\t\tisAllowed(room, RoomSettingsEnum.READ_ONLY),\n\t\t\tisAllowed(room, RoomSettingsEnum.SYSTEM_MESSAGES),\n\t\t\tisAllowed(room, RoomSettingsEnum.JOIN_CODE),\n\t\t\tisAllowed(room, RoomSettingsEnum.REACT_WHEN_READ_ONLY),\n\t\t\tisAllowed(room, RoomSettingsEnum.E2E),\n\t\t];\n\t}, [room]);\n\n\treturn {\n\t\tcanChangeType,\n\t\tcanSetReadOnly,\n\t\tcanSetReactWhenReadOnly,\n\t\tcanEditRoomRetentionPolicy,\n\t\tcanArchiveOrUnarchive,\n\t\tcanToggleEncryption,\n\t\tcanViewName,\n\t\tcanViewTopic,\n\t\tcanViewAnnouncement,\n\t\tcanViewArchived,\n\t\tcanViewDescription,\n\t\tcanViewType,\n\t\tcanViewReadOnly,\n\t\tcanViewHideSysMes,\n\t\tcanViewJoinCode,\n\t\tcanViewReactWhenReadOnly,\n\t\tcanViewEncrypted,\n\t};\n};\n"]}}},"code":"var _slicedToArray;\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 0);\nvar _regeneratorRuntime;\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 1);\nmodule.export({\n  useEditRoomPermissions: function () {\n    return useEditRoomPermissions;\n  }\n});\nvar usePermission, useAtLeastOnePermission, useRole, useEndpoint;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  usePermission: function (v) {\n    usePermission = v;\n  },\n  useAtLeastOnePermission: function (v) {\n    useAtLeastOnePermission = v;\n  },\n  useRole: function (v) {\n    useRole = v;\n  },\n  useEndpoint: function (v) {\n    useEndpoint = v;\n  }\n}, 0);\nvar useQuery;\nmodule.link(\"@tanstack/react-query\", {\n  useQuery: function (v) {\n    useQuery = v;\n  }\n}, 1);\nvar useMemo;\nmodule.link(\"react\", {\n  useMemo: function (v) {\n    useMemo = v;\n  }\n}, 2);\nvar E2EEState;\nmodule.link(\"../../../../../../app/e2e/client/E2EEState\", {\n  E2EEState: function (v) {\n    E2EEState = v;\n  }\n}, 3);\nvar RoomSettingsEnum;\nmodule.link(\"../../../../../../definition/IRoomTypeConfig\", {\n  RoomSettingsEnum: function (v) {\n    RoomSettingsEnum = v;\n  }\n}, 4);\nvar roomCoordinator;\nmodule.link(\"../../../../../lib/rooms/roomCoordinator\", {\n  roomCoordinator: function (v) {\n    roomCoordinator = v;\n  }\n}, 5);\nvar useE2EEState;\nmodule.link(\"../../../hooks/useE2EEState\", {\n  useE2EEState: function (v) {\n    useE2EEState = v;\n  }\n}, 6);\nvar getCanChangeType = function (room, canCreateChannel, canCreateGroup, isAdmin) {\n  return (!room.default || isAdmin) && (room.t === 'p' && canCreateChannel || room.t === 'c' && canCreateGroup);\n};\nvar useEditRoomPermissions = function (room) {\n  var isAdmin = useRole('admin');\n  var e2eeState = useE2EEState();\n  var isE2EEReady = e2eeState === E2EEState.READY || e2eeState === E2EEState.SAVE_PASSWORD;\n  var canCreateChannel = usePermission('create-c');\n  var canCreateGroup = usePermission('create-p');\n  var teamsInfoEndpoint = useEndpoint('GET', '/v1/teams.info');\n  var teamId = room.teamId || '';\n  var _useQuery = useQuery(['teamId', teamId], function () {\n      function _callee() {\n        return _regeneratorRuntime.async(function () {\n          function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                return _context.abrupt(\"return\", teamsInfoEndpoint({\n                  teamId: teamId\n                }));\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n          return _callee$;\n        }(), null, null, null, Promise);\n      }\n      return _callee;\n    }(), {\n      keepPreviousData: true,\n      retry: false,\n      enabled: room.teamId !== ''\n    }),\n    teamInfoData = _useQuery.data;\n  var canCreateTeamChannel = usePermission('create-team-channel', teamInfoData === null || teamInfoData === void 0 ? void 0 : teamInfoData.teamInfo.roomId);\n  var canCreateTeamGroup = usePermission('create-team-group', teamInfoData === null || teamInfoData === void 0 ? void 0 : teamInfoData.teamInfo.roomId);\n  var canChangeType = getCanChangeType(room, teamId ? canCreateTeamChannel : canCreateChannel, teamId ? canCreateTeamGroup : canCreateGroup, isAdmin);\n  var canSetReadOnly = usePermission('set-readonly', room._id);\n  var canSetReactWhenReadOnly = usePermission('set-react-when-readonly', room._id);\n  var canEditRoomRetentionPolicy = usePermission('edit-room-retention-policy', room._id);\n  var canArchiveOrUnarchive = useAtLeastOnePermission(useMemo(function () {\n    return ['archive-room', 'unarchive-room'];\n  }, []), room._id);\n  var canToggleEncryption = usePermission('toggle-room-e2e-encryption', room._id) && (room.encrypted || isE2EEReady);\n  var _useMemo = useMemo(function () {\n      var _roomCoordinator$getR;\n      var isAllowed = ((_roomCoordinator$getR = roomCoordinator.getRoomDirectives(room.t)) === null || _roomCoordinator$getR === void 0 ? void 0 : _roomCoordinator$getR.allowRoomSettingChange) || function () {\n        undefined;\n      };\n      return [isAllowed(room, RoomSettingsEnum.NAME), isAllowed(room, RoomSettingsEnum.TOPIC), isAllowed(room, RoomSettingsEnum.ANNOUNCEMENT), isAllowed(room, RoomSettingsEnum.ARCHIVE_OR_UNARCHIVE), isAllowed(room, RoomSettingsEnum.DESCRIPTION), isAllowed(room, RoomSettingsEnum.TYPE), isAllowed(room, RoomSettingsEnum.READ_ONLY), isAllowed(room, RoomSettingsEnum.SYSTEM_MESSAGES), isAllowed(room, RoomSettingsEnum.JOIN_CODE), isAllowed(room, RoomSettingsEnum.REACT_WHEN_READ_ONLY), isAllowed(room, RoomSettingsEnum.E2E)];\n    }, [room]),\n    _useMemo2 = _slicedToArray(_useMemo, 11),\n    canViewName = _useMemo2[0],\n    canViewTopic = _useMemo2[1],\n    canViewAnnouncement = _useMemo2[2],\n    canViewArchived = _useMemo2[3],\n    canViewDescription = _useMemo2[4],\n    canViewType = _useMemo2[5],\n    canViewReadOnly = _useMemo2[6],\n    canViewHideSysMes = _useMemo2[7],\n    canViewJoinCode = _useMemo2[8],\n    canViewReactWhenReadOnly = _useMemo2[9],\n    canViewEncrypted = _useMemo2[10];\n  return {\n    canChangeType: canChangeType,\n    canSetReadOnly: canSetReadOnly,\n    canSetReactWhenReadOnly: canSetReactWhenReadOnly,\n    canEditRoomRetentionPolicy: canEditRoomRetentionPolicy,\n    canArchiveOrUnarchive: canArchiveOrUnarchive,\n    canToggleEncryption: canToggleEncryption,\n    canViewName: canViewName,\n    canViewTopic: canViewTopic,\n    canViewAnnouncement: canViewAnnouncement,\n    canViewArchived: canViewArchived,\n    canViewDescription: canViewDescription,\n    canViewType: canViewType,\n    canViewReadOnly: canViewReadOnly,\n    canViewHideSysMes: canViewHideSysMes,\n    canViewJoinCode: canViewJoinCode,\n    canViewReactWhenReadOnly: canViewReactWhenReadOnly,\n    canViewEncrypted: canViewEncrypted\n  };\n};","map":{"version":3,"names":["_slicedToArray","module","link","default","v","_regeneratorRuntime","export","useEditRoomPermissions","usePermission","useAtLeastOnePermission","useRole","useEndpoint","useQuery","useMemo","E2EEState","RoomSettingsEnum","roomCoordinator","useE2EEState","getCanChangeType","room","canCreateChannel","canCreateGroup","isAdmin","t","e2eeState","isE2EEReady","READY","SAVE_PASSWORD","teamsInfoEndpoint","teamId","_useQuery","_callee","async","_callee$","_context","prev","next","abrupt","stop","Promise","keepPreviousData","retry","enabled","teamInfoData","data","canCreateTeamChannel","teamInfo","roomId","canCreateTeamGroup","canChangeType","canSetReadOnly","_id","canSetReactWhenReadOnly","canEditRoomRetentionPolicy","canArchiveOrUnarchive","canToggleEncryption","encrypted","_useMemo","_roomCoordinator$getR","isAllowed","getRoomDirectives","allowRoomSettingChange","undefined","NAME","TOPIC","ANNOUNCEMENT","ARCHIVE_OR_UNARCHIVE","DESCRIPTION","TYPE","READ_ONLY","SYSTEM_MESSAGES","JOIN_CODE","REACT_WHEN_READ_ONLY","E2E","_useMemo2","canViewName","canViewTopic","canViewAnnouncement","canViewArchived","canViewDescription","canViewType","canViewReadOnly","canViewHideSysMes","canViewJoinCode","canViewReactWhenReadOnly","canViewEncrypted"],"sources":["client/views/room/contextualBar/Info/EditRoomInfo/useEditRoomPermissions.ts"],"sourcesContent":["import type { IRoom, IRoomWithRetentionPolicy } from '@rocket.chat/core-typings';\nimport { usePermission, useAtLeastOnePermission, useRole, useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport { useMemo } from 'react';\n\nimport { E2EEState } from '../../../../../../app/e2e/client/E2EEState';\nimport { RoomSettingsEnum } from '../../../../../../definition/IRoomTypeConfig';\nimport { roomCoordinator } from '../../../../../lib/rooms/roomCoordinator';\nimport { useE2EEState } from '../../../hooks/useE2EEState';\n\nconst getCanChangeType = (room: IRoom | IRoomWithRetentionPolicy, canCreateChannel: boolean, canCreateGroup: boolean, isAdmin: boolean) =>\n\t(!room.default || isAdmin) && ((room.t === 'p' && canCreateChannel) || (room.t === 'c' && canCreateGroup));\n\nexport const useEditRoomPermissions = (room: IRoom | IRoomWithRetentionPolicy) => {\n\tconst isAdmin = useRole('admin');\n\tconst e2eeState = useE2EEState();\n\tconst isE2EEReady = e2eeState === E2EEState.READY || e2eeState === E2EEState.SAVE_PASSWORD;\n\tconst canCreateChannel = usePermission('create-c');\n\tconst canCreateGroup = usePermission('create-p');\n\tconst teamsInfoEndpoint = useEndpoint('GET', '/v1/teams.info');\n\n\tconst teamId = room.teamId || '';\n\tconst { data: teamInfoData } = useQuery(['teamId', teamId], async () => teamsInfoEndpoint({ teamId }), {\n\t\tkeepPreviousData: true,\n\t\tretry: false,\n\t\tenabled: room.teamId !== '',\n\t});\n\n\tconst canCreateTeamChannel = usePermission('create-team-channel', teamInfoData?.teamInfo.roomId);\n\tconst canCreateTeamGroup = usePermission('create-team-group', teamInfoData?.teamInfo.roomId);\n\n\tconst canChangeType = getCanChangeType(\n\t\troom,\n\t\tteamId ? canCreateTeamChannel : canCreateChannel,\n\t\tteamId ? canCreateTeamGroup : canCreateGroup,\n\t\tisAdmin,\n\t);\n\tconst canSetReadOnly = usePermission('set-readonly', room._id);\n\tconst canSetReactWhenReadOnly = usePermission('set-react-when-readonly', room._id);\n\tconst canEditRoomRetentionPolicy = usePermission('edit-room-retention-policy', room._id);\n\tconst canArchiveOrUnarchive = useAtLeastOnePermission(\n\t\tuseMemo(() => ['archive-room', 'unarchive-room'], []),\n\t\troom._id,\n\t);\n\tconst canToggleEncryption = usePermission('toggle-room-e2e-encryption', room._id) && (room.encrypted || isE2EEReady);\n\n\tconst [\n\t\tcanViewName,\n\t\tcanViewTopic,\n\t\tcanViewAnnouncement,\n\t\tcanViewArchived,\n\t\tcanViewDescription,\n\t\tcanViewType,\n\t\tcanViewReadOnly,\n\t\tcanViewHideSysMes,\n\t\tcanViewJoinCode,\n\t\tcanViewReactWhenReadOnly,\n\t\tcanViewEncrypted,\n\t] = useMemo(() => {\n\t\tconst isAllowed =\n\t\t\troomCoordinator.getRoomDirectives(room.t)?.allowRoomSettingChange ||\n\t\t\t(() => {\n\t\t\t\tundefined;\n\t\t\t});\n\t\treturn [\n\t\t\tisAllowed(room, RoomSettingsEnum.NAME),\n\t\t\tisAllowed(room, RoomSettingsEnum.TOPIC),\n\t\t\tisAllowed(room, RoomSettingsEnum.ANNOUNCEMENT),\n\t\t\tisAllowed(room, RoomSettingsEnum.ARCHIVE_OR_UNARCHIVE),\n\t\t\tisAllowed(room, RoomSettingsEnum.DESCRIPTION),\n\t\t\tisAllowed(room, RoomSettingsEnum.TYPE),\n\t\t\tisAllowed(room, RoomSettingsEnum.READ_ONLY),\n\t\t\tisAllowed(room, RoomSettingsEnum.SYSTEM_MESSAGES),\n\t\t\tisAllowed(room, RoomSettingsEnum.JOIN_CODE),\n\t\t\tisAllowed(room, RoomSettingsEnum.REACT_WHEN_READ_ONLY),\n\t\t\tisAllowed(room, RoomSettingsEnum.E2E),\n\t\t];\n\t}, [room]);\n\n\treturn {\n\t\tcanChangeType,\n\t\tcanSetReadOnly,\n\t\tcanSetReactWhenReadOnly,\n\t\tcanEditRoomRetentionPolicy,\n\t\tcanArchiveOrUnarchive,\n\t\tcanToggleEncryption,\n\t\tcanViewName,\n\t\tcanViewTopic,\n\t\tcanViewAnnouncement,\n\t\tcanViewArchived,\n\t\tcanViewDescription,\n\t\tcanViewType,\n\t\tcanViewReadOnly,\n\t\tcanViewHideSysMes,\n\t\tcanViewJoinCode,\n\t\tcanViewReactWhenReadOnly,\n\t\tcanViewEncrypted,\n\t};\n};\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"2d02577827570c83d82ec5924220102de02f6025"}
