{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/providers/ComposerPopupProvider.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/room/providers/ComposerPopupProvider.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/providers/ComposerPopupProvider.tsx","inputSourceMap":{"version":3,"file":"client/views/room/providers/ComposerPopupProvider.tsx","sourceRoot":"","sources":["client/views/room/providers/ComposerPopupProvider.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { isOmnichannelRoom } from '@rocket.chat/core-typings';\nimport { useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport { escapeRegExp } from '@rocket.chat/string-helpers';\nimport { useMethod, useSetting, useTranslation, useUserPreference } from '@rocket.chat/ui-contexts';\nimport React, { useMemo } from 'react';\nimport type { ReactNode } from 'react';\n\nimport { hasAtLeastOnePermission } from '../../../../app/authorization/client';\nimport { CannedResponse } from '../../../../app/canned-responses/client/collections/CannedResponse';\nimport { emoji } from '../../../../app/emoji/client';\nimport { Subscriptions } from '../../../../app/models/client';\nimport { usersFromRoomMessages } from '../../../../app/ui-message/client/popup/messagePopupConfig';\nimport { slashCommands } from '../../../../app/utils/client';\nimport ComposerBoxPopupCannedResponse from '../composer/ComposerBoxPopupCannedResponse';\nimport type { ComposerBoxPopupEmojiProps } from '../composer/ComposerBoxPopupEmoji';\nimport ComposerBoxPopupEmoji from '../composer/ComposerBoxPopupEmoji';\nimport ComposerBoxPopupRoom from '../composer/ComposerBoxPopupRoom';\nimport type { ComposerBoxPopupRoomProps } from '../composer/ComposerBoxPopupRoom';\nimport type { ComposerBoxPopupSlashCommandProps } from '../composer/ComposerBoxPopupSlashCommand';\nimport ComposerBoxPopupSlashCommand from '../composer/ComposerBoxPopupSlashCommand';\nimport ComposerBoxPopupUser from '../composer/ComposerBoxPopupUser';\nimport type { ComposerBoxPopupUserProps } from '../composer/ComposerBoxPopupUser';\nimport type { ComposerPopupContextValue } from '../contexts/ComposerPopupContext';\nimport { ComposerPopupContext, createMessageBoxPopupConfig } from '../contexts/ComposerPopupContext';\n\nconst ComposerPopupProvider = ({ children, room }: { children: ReactNode; room: IRoom }) => {\n\tconst { _id: rid, encrypted: isRoomEncrypted } = room;\n\tconst userSpotlight = useMethod('spotlight');\n\tconst suggestionsCount = useSetting<number>('Number_of_users_autocomplete_suggestions');\n\tconst cannedResponseEnabled = useSetting<boolean>('Canned_Responses_Enable');\n\tconst [recentEmojis] = useLocalStorage('emoji.recent', []);\n\tconst isOmnichannel = isOmnichannelRoom(room);\n\tconst useEmoji = useUserPreference('useEmojis');\n\tconst t = useTranslation();\n\tconst e2eEnabled = useSetting<boolean>('E2E_Enable');\n\tconst unencryptedMessagesAllowed = useSetting<boolean>('E2E_Allow_Unencrypted_Messages');\n\tconst encrypted = isRoomEncrypted && e2eEnabled && !unencryptedMessagesAllowed;\n\n\tconst call = useMethod('getSlashCommandPreviews');\n\tconst value: ComposerPopupContextValue = useMemo(() => {\n\t\treturn [\n\t\t\tcreateMessageBoxPopupConfig({\n\t\t\t\ttrigger: '@',\n\t\t\t\ttitle: t('People'),\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = filter && new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst items: ComposerBoxPopupUserProps[] = [];\n\n\t\t\t\t\tconst users = usersFromRoomMessages\n\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tts: { $exists: true },\n\t\t\t\t\t\t\t\t...(filter && {\n\t\t\t\t\t\t\t\t\t$or: [{ username: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\t\tsort: { ts: -1 },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t.map((u) => {\n\t\t\t\t\t\t\tu.suggestion = true;\n\t\t\t\t\t\t\treturn u;\n\t\t\t\t\t\t});\n\t\t\t\t\tif (!filterRegex || filterRegex.test('all')) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t_id: 'all',\n\t\t\t\t\t\t\tusername: 'all',\n\t\t\t\t\t\t\tsystem: true,\n\t\t\t\t\t\t\tname: t('Notify_all_in_this_room'),\n\t\t\t\t\t\t\tsort: 4,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!filterRegex || filterRegex.test('here')) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t_id: 'here',\n\t\t\t\t\t\t\tusername: 'here',\n\t\t\t\t\t\t\tsystem: true,\n\t\t\t\t\t\t\tname: t('Notify_active_in_this_room'),\n\t\t\t\t\t\t\tsort: 4,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\treturn [...users, ...items];\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = filter && new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst usernames = usersFromRoomMessages\n\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tts: { $exists: true },\n\t\t\t\t\t\t\t\t...(filter && {\n\t\t\t\t\t\t\t\t\t$or: [{ username: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\t\tsort: { ts: -1 },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t.map((u) => {\n\t\t\t\t\t\t\treturn u.username;\n\t\t\t\t\t\t});\n\t\t\t\t\tconst { users = [] } = await userSpotlight(filter, usernames, { users: true, mentions: true }, rid);\n\n\t\t\t\t\treturn users.map(({ _id, username, nickname, name, status, avatarETag, outside }) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t_id,\n\t\t\t\t\t\t\tusername,\n\t\t\t\t\t\t\tnickname,\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tstatus,\n\t\t\t\t\t\t\tavatarETag,\n\t\t\t\t\t\t\toutside,\n\t\t\t\t\t\t\tsort: 3,\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => item.username,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupUser {...item} />,\n\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupRoomProps>({\n\t\t\t\ttrigger: '#',\n\t\t\t\ttitle: t('Channels'),\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst records = Subscriptions.find(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$and: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$or: [{ fname: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$or: [{ federated: { $exists: false } }, { federated: false }],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tt: {\n\t\t\t\t\t\t\t\t$in: ['c', 'p'],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\tls: -1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t).fetch();\n\t\t\t\t\treturn records;\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async (filter: string) => {\n\t\t\t\t\tconst { rooms = [] } = await userSpotlight(filter, [], { rooms: true, mentions: true }, rid);\n\t\t\t\t\treturn rooms as unknown as ComposerBoxPopupRoomProps[];\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => `${item.name || item.fname}`,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupRoom {...item} />,\n\t\t\t}) as any,\n\t\t\tuseEmoji &&\n\t\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupEmojiProps>({\n\t\t\t\t\ttrigger: ':',\n\t\t\t\t\ttitle: t('Emoji'),\n\t\t\t\t\ttriggerLength: 2,\n\t\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\t\tconst exactFinalTone = new RegExp('^tone[1-5]:*$');\n\t\t\t\t\t\tconst colorBlind = new RegExp('tone[1-5]:*$');\n\t\t\t\t\t\tconst seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');\n\n\t\t\t\t\t\tconst emojiSort = (recents: string[]) => (a: { _id: string }, b: { _id: string }) => {\n\t\t\t\t\t\t\tconst aExact = a._id === key ? 2 : 0;\n\t\t\t\t\t\t\tconst bExact = b._id === key ? 2 : 0;\n\t\t\t\t\t\t\tconst aPartial = a._id.startsWith(key) ? 1 : 0;\n\t\t\t\t\t\t\tconst bPartial = b._id.startsWith(key) ? 1 : 0;\n\n\t\t\t\t\t\t\tlet aScore = aExact + aPartial;\n\t\t\t\t\t\t\tlet bScore = bExact + bPartial;\n\n\t\t\t\t\t\t\tif (recents.includes(a._id)) {\n\t\t\t\t\t\t\t\taScore += recents.indexOf(a._id) + 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (recents.includes(b._id)) {\n\t\t\t\t\t\t\t\tbScore += recents.indexOf(b._id) + 1;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (aScore > bScore) {\n\t\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (aScore < bScore) {\n\t\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\t\tconst key = `:${filter}`;\n\n\t\t\t\t\t\tconst recents = recentEmojis.map((item) => `:${item}:`);\n\n\t\t\t\t\t\tconst collection = emoji.list;\n\n\t\t\t\t\t\treturn Object.keys(collection)\n\t\t\t\t\t\t\t.map((_id) => {\n\t\t\t\t\t\t\t\tconst data = collection[key];\n\t\t\t\t\t\t\t\treturn { _id, data };\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t\t({ _id }) =>\n\t\t\t\t\t\t\t\t\tfilterRegex.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id)),\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.sort(emojiSort(recents))\n\t\t\t\t\t\t\t.slice(0, 10);\n\t\t\t\t\t},\n\t\t\t\t\tgetItemsFromServer: async () => {\n\t\t\t\t\t\treturn [];\n\t\t\t\t\t},\n\t\t\t\t\tgetValue: (item) => `${item._id.substring(1)}`,\n\t\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupEmoji {...item} />,\n\t\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupEmojiProps>({\n\t\t\t\ttitle: t('Emoji'),\n\t\t\t\ttrigger: '\\\\+:',\n\t\t\t\tprefix: '+',\n\t\t\t\tsuffix: ' ',\n\t\t\t\ttriggerAnywhere: false,\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst exactFinalTone = new RegExp('^tone[1-5]:*$');\n\t\t\t\t\tconst colorBlind = new RegExp('tone[1-5]:*$');\n\t\t\t\t\tconst seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');\n\n\t\t\t\t\tconst emojiSort = (recents: string[]) => (a: { _id: string }, b: { _id: string }) => {\n\t\t\t\t\t\tlet idA = a._id;\n\t\t\t\t\t\tlet idB = a._id;\n\n\t\t\t\t\t\tif (recents.includes(a._id)) {\n\t\t\t\t\t\t\tidA = recents.indexOf(a._id) + idA;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (recents.includes(b._id)) {\n\t\t\t\t\t\t\tidB = recents.indexOf(b._id) + idB;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (idA < idB) {\n\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (idA > idB) {\n\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t};\n\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst key = `:${filter}`;\n\n\t\t\t\t\tconst recents = recentEmojis.map((item) => `:${item}:`);\n\n\t\t\t\t\tconst collection = emoji.list;\n\n\t\t\t\t\treturn Object.keys(collection)\n\t\t\t\t\t\t.map((_id) => {\n\t\t\t\t\t\t\tconst data = collection[key];\n\t\t\t\t\t\t\treturn { _id, data };\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t({ _id }) =>\n\t\t\t\t\t\t\t\tfilterRegex.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id)),\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.sort(emojiSort(recents))\n\t\t\t\t\t\t.slice(0, 10);\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async () => {\n\t\t\t\t\treturn [];\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => `${item._id}`,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupEmoji {...item} />,\n\t\t\t}),\n\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupSlashCommandProps>({\n\t\t\t\ttitle: t('Commands'),\n\t\t\t\ttrigger: '/',\n\t\t\t\tsuffix: ' ',\n\t\t\t\ttriggerAnywhere: false,\n\t\t\t\tdisabled: encrypted,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupSlashCommand {...item} />,\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\treturn Object.keys(slashCommands.commands)\n\t\t\t\t\t\t.map((command) => {\n\t\t\t\t\t\t\tconst item = slashCommands.commands[command];\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t_id: command,\n\t\t\t\t\t\t\t\tparams: item.params && t.has(item.params) ? t(item.params) : item.params ?? '',\n\t\t\t\t\t\t\t\tdescription: item.description && t.has(item.description) ? t(item.description) : item.description,\n\t\t\t\t\t\t\t\tpermission: item.permission,\n\t\t\t\t\t\t\t\t...(encrypted && { disabled: encrypted }),\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.filter((command) => {\n\t\t\t\t\t\t\tconst isMatch = command._id.indexOf(filter) > -1;\n\n\t\t\t\t\t\t\tif (!isMatch) {\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!command.permission) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn hasAtLeastOnePermission(command.permission, rid);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.sort((a, b) => a._id.localeCompare(b._id))\n\t\t\t\t\t\t.slice(0, 11);\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async () => [],\n\t\t\t}),\n\t\t\tcannedResponseEnabled &&\n\t\t\t\tisOmnichannel &&\n\t\t\t\tcreateMessageBoxPopupConfig<{\n\t\t\t\t\t_id: string;\n\t\t\t\t\ttext: string;\n\t\t\t\t\tshortcut: string;\n\t\t\t\t}>({\n\t\t\t\t\ttitle: t('Canned_Responses'),\n\t\t\t\t\ttrigger: '!',\n\t\t\t\t\tprefix: '',\n\t\t\t\t\ttriggerAnywhere: true,\n\t\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupCannedResponse {...item} />,\n\t\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\t\tconst exp = new RegExp(filter, 'i');\n\t\t\t\t\t\treturn CannedResponse.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshortcut: exp,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: 12,\n\t\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\t\tshortcut: -1,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t\t.map((record) => ({\n\t\t\t\t\t\t\t\t_id: record._id,\n\t\t\t\t\t\t\t\ttext: record.text,\n\t\t\t\t\t\t\t\tshortcut: record.shortcut,\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t},\n\t\t\t\t\tgetItemsFromServer: async () => [],\n\t\t\t\t\tgetValue: (item) => {\n\t\t\t\t\t\treturn item.text;\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig({\n\t\t\t\tmatchSelectorRegex: /(?:^)(\\/[\\w\\d\\S]+ )[^]*$/,\n\t\t\t\tpreview: true,\n\t\t\t\tgetItemsFromLocal: async ({ cmd, params, tmid }: { cmd: string; params: string; tmid: string }) => {\n\t\t\t\t\tconst result = await call({ cmd, params, msg: { rid, tmid } });\n\t\t\t\t\treturn (\n\t\t\t\t\t\tresult?.items.map((item) => ({\n\t\t\t\t\t\t\t_id: item.id,\n\t\t\t\t\t\t\tvalue: item.value,\n\t\t\t\t\t\t\ttype: item.type,\n\t\t\t\t\t\t})) ?? []\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t}),\n\t\t].filter(Boolean);\n\t}, [t, cannedResponseEnabled, isOmnichannel, recentEmojis, suggestionsCount, userSpotlight, rid, call, useEmoji, encrypted]);\n\n\treturn <ComposerPopupContext.Provider value={value} children={children} />;\n};\n\nexport default ComposerPopupProvider;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/providers/ComposerPopupProvider.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/providers/ComposerPopupProvider.tsx","inputSourceMap":{"version":3,"file":"client/views/room/providers/ComposerPopupProvider.tsx","sourceRoot":"","sources":["client/views/room/providers/ComposerPopupProvider.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { isOmnichannelRoom } from '@rocket.chat/core-typings';\nimport { useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport { escapeRegExp } from '@rocket.chat/string-helpers';\nimport { useMethod, useSetting, useTranslation, useUserPreference } from '@rocket.chat/ui-contexts';\nimport React, { useMemo } from 'react';\nimport type { ReactNode } from 'react';\n\nimport { hasAtLeastOnePermission } from '../../../../app/authorization/client';\nimport { CannedResponse } from '../../../../app/canned-responses/client/collections/CannedResponse';\nimport { emoji } from '../../../../app/emoji/client';\nimport { Subscriptions } from '../../../../app/models/client';\nimport { usersFromRoomMessages } from '../../../../app/ui-message/client/popup/messagePopupConfig';\nimport { slashCommands } from '../../../../app/utils/client';\nimport ComposerBoxPopupCannedResponse from '../composer/ComposerBoxPopupCannedResponse';\nimport type { ComposerBoxPopupEmojiProps } from '../composer/ComposerBoxPopupEmoji';\nimport ComposerBoxPopupEmoji from '../composer/ComposerBoxPopupEmoji';\nimport ComposerBoxPopupRoom from '../composer/ComposerBoxPopupRoom';\nimport type { ComposerBoxPopupRoomProps } from '../composer/ComposerBoxPopupRoom';\nimport type { ComposerBoxPopupSlashCommandProps } from '../composer/ComposerBoxPopupSlashCommand';\nimport ComposerBoxPopupSlashCommand from '../composer/ComposerBoxPopupSlashCommand';\nimport ComposerBoxPopupUser from '../composer/ComposerBoxPopupUser';\nimport type { ComposerBoxPopupUserProps } from '../composer/ComposerBoxPopupUser';\nimport type { ComposerPopupContextValue } from '../contexts/ComposerPopupContext';\nimport { ComposerPopupContext, createMessageBoxPopupConfig } from '../contexts/ComposerPopupContext';\n\nconst ComposerPopupProvider = ({ children, room }: { children: ReactNode; room: IRoom }) => {\n\tconst { _id: rid, encrypted: isRoomEncrypted } = room;\n\tconst userSpotlight = useMethod('spotlight');\n\tconst suggestionsCount = useSetting<number>('Number_of_users_autocomplete_suggestions');\n\tconst cannedResponseEnabled = useSetting<boolean>('Canned_Responses_Enable');\n\tconst [recentEmojis] = useLocalStorage('emoji.recent', []);\n\tconst isOmnichannel = isOmnichannelRoom(room);\n\tconst useEmoji = useUserPreference('useEmojis');\n\tconst t = useTranslation();\n\tconst e2eEnabled = useSetting<boolean>('E2E_Enable');\n\tconst unencryptedMessagesAllowed = useSetting<boolean>('E2E_Allow_Unencrypted_Messages');\n\tconst encrypted = isRoomEncrypted && e2eEnabled && !unencryptedMessagesAllowed;\n\n\tconst call = useMethod('getSlashCommandPreviews');\n\tconst value: ComposerPopupContextValue = useMemo(() => {\n\t\treturn [\n\t\t\tcreateMessageBoxPopupConfig({\n\t\t\t\ttrigger: '@',\n\t\t\t\ttitle: t('People'),\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = filter && new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst items: ComposerBoxPopupUserProps[] = [];\n\n\t\t\t\t\tconst users = usersFromRoomMessages\n\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tts: { $exists: true },\n\t\t\t\t\t\t\t\t...(filter && {\n\t\t\t\t\t\t\t\t\t$or: [{ username: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\t\tsort: { ts: -1 },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t.map((u) => {\n\t\t\t\t\t\t\tu.suggestion = true;\n\t\t\t\t\t\t\treturn u;\n\t\t\t\t\t\t});\n\t\t\t\t\tif (!filterRegex || filterRegex.test('all')) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t_id: 'all',\n\t\t\t\t\t\t\tusername: 'all',\n\t\t\t\t\t\t\tsystem: true,\n\t\t\t\t\t\t\tname: t('Notify_all_in_this_room'),\n\t\t\t\t\t\t\tsort: 4,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!filterRegex || filterRegex.test('here')) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t_id: 'here',\n\t\t\t\t\t\t\tusername: 'here',\n\t\t\t\t\t\t\tsystem: true,\n\t\t\t\t\t\t\tname: t('Notify_active_in_this_room'),\n\t\t\t\t\t\t\tsort: 4,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\treturn [...users, ...items];\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = filter && new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst usernames = usersFromRoomMessages\n\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tts: { $exists: true },\n\t\t\t\t\t\t\t\t...(filter && {\n\t\t\t\t\t\t\t\t\t$or: [{ username: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\t\tsort: { ts: -1 },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t.map((u) => {\n\t\t\t\t\t\t\treturn u.username;\n\t\t\t\t\t\t});\n\t\t\t\t\tconst { users = [] } = await userSpotlight(filter, usernames, { users: true, mentions: true }, rid);\n\n\t\t\t\t\treturn users.map(({ _id, username, nickname, name, status, avatarETag, outside }) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t_id,\n\t\t\t\t\t\t\tusername,\n\t\t\t\t\t\t\tnickname,\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tstatus,\n\t\t\t\t\t\t\tavatarETag,\n\t\t\t\t\t\t\toutside,\n\t\t\t\t\t\t\tsort: 3,\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => item.username,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupUser {...item} />,\n\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupRoomProps>({\n\t\t\t\ttrigger: '#',\n\t\t\t\ttitle: t('Channels'),\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst records = Subscriptions.find(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$and: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$or: [{ fname: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$or: [{ federated: { $exists: false } }, { federated: false }],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tt: {\n\t\t\t\t\t\t\t\t$in: ['c', 'p'],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\tls: -1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t).fetch();\n\t\t\t\t\treturn records;\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async (filter: string) => {\n\t\t\t\t\tconst { rooms = [] } = await userSpotlight(filter, [], { rooms: true, mentions: true }, rid);\n\t\t\t\t\treturn rooms as unknown as ComposerBoxPopupRoomProps[];\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => `${item.name || item.fname}`,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupRoom {...item} />,\n\t\t\t}) as any,\n\t\t\tuseEmoji &&\n\t\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupEmojiProps>({\n\t\t\t\t\ttrigger: ':',\n\t\t\t\t\ttitle: t('Emoji'),\n\t\t\t\t\ttriggerLength: 2,\n\t\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\t\tconst exactFinalTone = new RegExp('^tone[1-5]:*$');\n\t\t\t\t\t\tconst colorBlind = new RegExp('tone[1-5]:*$');\n\t\t\t\t\t\tconst seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');\n\n\t\t\t\t\t\tconst emojiSort = (recents: string[]) => (a: { _id: string }, b: { _id: string }) => {\n\t\t\t\t\t\t\tconst aExact = a._id === key ? 2 : 0;\n\t\t\t\t\t\t\tconst bExact = b._id === key ? 2 : 0;\n\t\t\t\t\t\t\tconst aPartial = a._id.startsWith(key) ? 1 : 0;\n\t\t\t\t\t\t\tconst bPartial = b._id.startsWith(key) ? 1 : 0;\n\n\t\t\t\t\t\t\tlet aScore = aExact + aPartial;\n\t\t\t\t\t\t\tlet bScore = bExact + bPartial;\n\n\t\t\t\t\t\t\tif (recents.includes(a._id)) {\n\t\t\t\t\t\t\t\taScore += recents.indexOf(a._id) + 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (recents.includes(b._id)) {\n\t\t\t\t\t\t\t\tbScore += recents.indexOf(b._id) + 1;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (aScore > bScore) {\n\t\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (aScore < bScore) {\n\t\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\t\tconst key = `:${filter}`;\n\n\t\t\t\t\t\tconst recents = recentEmojis.map((item) => `:${item}:`);\n\n\t\t\t\t\t\tconst collection = emoji.list;\n\n\t\t\t\t\t\treturn Object.keys(collection)\n\t\t\t\t\t\t\t.map((_id) => {\n\t\t\t\t\t\t\t\tconst data = collection[key];\n\t\t\t\t\t\t\t\treturn { _id, data };\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t\t({ _id }) =>\n\t\t\t\t\t\t\t\t\tfilterRegex.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id)),\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.sort(emojiSort(recents))\n\t\t\t\t\t\t\t.slice(0, 10);\n\t\t\t\t\t},\n\t\t\t\t\tgetItemsFromServer: async () => {\n\t\t\t\t\t\treturn [];\n\t\t\t\t\t},\n\t\t\t\t\tgetValue: (item) => `${item._id.substring(1)}`,\n\t\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupEmoji {...item} />,\n\t\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupEmojiProps>({\n\t\t\t\ttitle: t('Emoji'),\n\t\t\t\ttrigger: '\\\\+:',\n\t\t\t\tprefix: '+',\n\t\t\t\tsuffix: ' ',\n\t\t\t\ttriggerAnywhere: false,\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst exactFinalTone = new RegExp('^tone[1-5]:*$');\n\t\t\t\t\tconst colorBlind = new RegExp('tone[1-5]:*$');\n\t\t\t\t\tconst seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');\n\n\t\t\t\t\tconst emojiSort = (recents: string[]) => (a: { _id: string }, b: { _id: string }) => {\n\t\t\t\t\t\tlet idA = a._id;\n\t\t\t\t\t\tlet idB = a._id;\n\n\t\t\t\t\t\tif (recents.includes(a._id)) {\n\t\t\t\t\t\t\tidA = recents.indexOf(a._id) + idA;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (recents.includes(b._id)) {\n\t\t\t\t\t\t\tidB = recents.indexOf(b._id) + idB;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (idA < idB) {\n\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (idA > idB) {\n\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t};\n\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst key = `:${filter}`;\n\n\t\t\t\t\tconst recents = recentEmojis.map((item) => `:${item}:`);\n\n\t\t\t\t\tconst collection = emoji.list;\n\n\t\t\t\t\treturn Object.keys(collection)\n\t\t\t\t\t\t.map((_id) => {\n\t\t\t\t\t\t\tconst data = collection[key];\n\t\t\t\t\t\t\treturn { _id, data };\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t({ _id }) =>\n\t\t\t\t\t\t\t\tfilterRegex.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id)),\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.sort(emojiSort(recents))\n\t\t\t\t\t\t.slice(0, 10);\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async () => {\n\t\t\t\t\treturn [];\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => `${item._id}`,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupEmoji {...item} />,\n\t\t\t}),\n\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupSlashCommandProps>({\n\t\t\t\ttitle: t('Commands'),\n\t\t\t\ttrigger: '/',\n\t\t\t\tsuffix: ' ',\n\t\t\t\ttriggerAnywhere: false,\n\t\t\t\tdisabled: encrypted,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupSlashCommand {...item} />,\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\treturn Object.keys(slashCommands.commands)\n\t\t\t\t\t\t.map((command) => {\n\t\t\t\t\t\t\tconst item = slashCommands.commands[command];\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t_id: command,\n\t\t\t\t\t\t\t\tparams: item.params && t.has(item.params) ? t(item.params) : item.params ?? '',\n\t\t\t\t\t\t\t\tdescription: item.description && t.has(item.description) ? t(item.description) : item.description,\n\t\t\t\t\t\t\t\tpermission: item.permission,\n\t\t\t\t\t\t\t\t...(encrypted && { disabled: encrypted }),\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.filter((command) => {\n\t\t\t\t\t\t\tconst isMatch = command._id.indexOf(filter) > -1;\n\n\t\t\t\t\t\t\tif (!isMatch) {\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!command.permission) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn hasAtLeastOnePermission(command.permission, rid);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.sort((a, b) => a._id.localeCompare(b._id))\n\t\t\t\t\t\t.slice(0, 11);\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async () => [],\n\t\t\t}),\n\t\t\tcannedResponseEnabled &&\n\t\t\t\tisOmnichannel &&\n\t\t\t\tcreateMessageBoxPopupConfig<{\n\t\t\t\t\t_id: string;\n\t\t\t\t\ttext: string;\n\t\t\t\t\tshortcut: string;\n\t\t\t\t}>({\n\t\t\t\t\ttitle: t('Canned_Responses'),\n\t\t\t\t\ttrigger: '!',\n\t\t\t\t\tprefix: '',\n\t\t\t\t\ttriggerAnywhere: true,\n\t\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupCannedResponse {...item} />,\n\t\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\t\tconst exp = new RegExp(filter, 'i');\n\t\t\t\t\t\treturn CannedResponse.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshortcut: exp,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: 12,\n\t\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\t\tshortcut: -1,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t\t.map((record) => ({\n\t\t\t\t\t\t\t\t_id: record._id,\n\t\t\t\t\t\t\t\ttext: record.text,\n\t\t\t\t\t\t\t\tshortcut: record.shortcut,\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t},\n\t\t\t\t\tgetItemsFromServer: async () => [],\n\t\t\t\t\tgetValue: (item) => {\n\t\t\t\t\t\treturn item.text;\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig({\n\t\t\t\tmatchSelectorRegex: /(?:^)(\\/[\\w\\d\\S]+ )[^]*$/,\n\t\t\t\tpreview: true,\n\t\t\t\tgetItemsFromLocal: async ({ cmd, params, tmid }: { cmd: string; params: string; tmid: string }) => {\n\t\t\t\t\tconst result = await call({ cmd, params, msg: { rid, tmid } });\n\t\t\t\t\treturn (\n\t\t\t\t\t\tresult?.items.map((item) => ({\n\t\t\t\t\t\t\t_id: item.id,\n\t\t\t\t\t\t\tvalue: item.value,\n\t\t\t\t\t\t\ttype: item.type,\n\t\t\t\t\t\t})) ?? []\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t}),\n\t\t].filter(Boolean);\n\t}, [t, cannedResponseEnabled, isOmnichannel, recentEmojis, suggestionsCount, userSpotlight, rid, call, useEmoji, encrypted]);\n\n\treturn <ComposerPopupContext.Provider value={value} children={children} />;\n};\n\nexport default ComposerPopupProvider;\n"]}}},"code":"var _regeneratorRuntime;\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\nvar _toConsumableArray;\nmodule.link(\"@babel/runtime/helpers/toConsumableArray\", {\n  default: function (v) {\n    _toConsumableArray = v;\n  }\n}, 1);\nvar _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default: function (v) {\n    _objectSpread = v;\n  }\n}, 2);\nvar _slicedToArray;\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 3);\nvar isOmnichannelRoom;\nmodule.link(\"@rocket.chat/core-typings\", {\n  isOmnichannelRoom: function (v) {\n    isOmnichannelRoom = v;\n  }\n}, 0);\nvar useLocalStorage;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useLocalStorage: function (v) {\n    useLocalStorage = v;\n  }\n}, 1);\nvar escapeRegExp;\nmodule.link(\"@rocket.chat/string-helpers\", {\n  escapeRegExp: function (v) {\n    escapeRegExp = v;\n  }\n}, 2);\nvar useMethod, useSetting, useTranslation, useUserPreference;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useMethod: function (v) {\n    useMethod = v;\n  },\n  useSetting: function (v) {\n    useSetting = v;\n  },\n  useTranslation: function (v) {\n    useTranslation = v;\n  },\n  useUserPreference: function (v) {\n    useUserPreference = v;\n  }\n}, 3);\nvar React, useMemo;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  }\n}, 4);\nvar hasAtLeastOnePermission;\nmodule.link(\"../../../../app/authorization/client\", {\n  hasAtLeastOnePermission: function (v) {\n    hasAtLeastOnePermission = v;\n  }\n}, 5);\nvar CannedResponse;\nmodule.link(\"../../../../app/canned-responses/client/collections/CannedResponse\", {\n  CannedResponse: function (v) {\n    CannedResponse = v;\n  }\n}, 6);\nvar emoji;\nmodule.link(\"../../../../app/emoji/client\", {\n  emoji: function (v) {\n    emoji = v;\n  }\n}, 7);\nvar Subscriptions;\nmodule.link(\"../../../../app/models/client\", {\n  Subscriptions: function (v) {\n    Subscriptions = v;\n  }\n}, 8);\nvar usersFromRoomMessages;\nmodule.link(\"../../../../app/ui-message/client/popup/messagePopupConfig\", {\n  usersFromRoomMessages: function (v) {\n    usersFromRoomMessages = v;\n  }\n}, 9);\nvar slashCommands;\nmodule.link(\"../../../../app/utils/client\", {\n  slashCommands: function (v) {\n    slashCommands = v;\n  }\n}, 10);\nvar ComposerBoxPopupCannedResponse;\nmodule.link(\"../composer/ComposerBoxPopupCannedResponse\", {\n  \"default\": function (v) {\n    ComposerBoxPopupCannedResponse = v;\n  }\n}, 11);\nvar ComposerBoxPopupEmoji;\nmodule.link(\"../composer/ComposerBoxPopupEmoji\", {\n  \"default\": function (v) {\n    ComposerBoxPopupEmoji = v;\n  }\n}, 12);\nvar ComposerBoxPopupRoom;\nmodule.link(\"../composer/ComposerBoxPopupRoom\", {\n  \"default\": function (v) {\n    ComposerBoxPopupRoom = v;\n  }\n}, 13);\nvar ComposerBoxPopupSlashCommand;\nmodule.link(\"../composer/ComposerBoxPopupSlashCommand\", {\n  \"default\": function (v) {\n    ComposerBoxPopupSlashCommand = v;\n  }\n}, 14);\nvar ComposerBoxPopupUser;\nmodule.link(\"../composer/ComposerBoxPopupUser\", {\n  \"default\": function (v) {\n    ComposerBoxPopupUser = v;\n  }\n}, 15);\nvar ComposerPopupContext, createMessageBoxPopupConfig;\nmodule.link(\"../contexts/ComposerPopupContext\", {\n  ComposerPopupContext: function (v) {\n    ComposerPopupContext = v;\n  },\n  createMessageBoxPopupConfig: function (v) {\n    createMessageBoxPopupConfig = v;\n  }\n}, 16);\nvar ComposerPopupProvider = function (_ref) {\n  var children = _ref.children,\n    room = _ref.room;\n  var rid = room._id,\n    isRoomEncrypted = room.encrypted;\n  var userSpotlight = useMethod('spotlight');\n  var suggestionsCount = useSetting('Number_of_users_autocomplete_suggestions');\n  var cannedResponseEnabled = useSetting('Canned_Responses_Enable');\n  var _useLocalStorage = useLocalStorage('emoji.recent', []),\n    _useLocalStorage2 = _slicedToArray(_useLocalStorage, 1),\n    recentEmojis = _useLocalStorage2[0];\n  var isOmnichannel = isOmnichannelRoom(room);\n  var useEmoji = useUserPreference('useEmojis');\n  var t = useTranslation();\n  var e2eEnabled = useSetting('E2E_Enable');\n  var unencryptedMessagesAllowed = useSetting('E2E_Allow_Unencrypted_Messages');\n  var encrypted = isRoomEncrypted && e2eEnabled && !unencryptedMessagesAllowed;\n  var call = useMethod('getSlashCommandPreviews');\n  var value = useMemo(function () {\n    return [createMessageBoxPopupConfig({\n      trigger: '@',\n      title: t('People'),\n      getItemsFromLocal: function () {\n        function _callee(filter) {\n          var filterRegex, items, users;\n          return _regeneratorRuntime.async(function () {\n            function _callee$(_context) {\n              while (1) switch (_context.prev = _context.next) {\n                case 0:\n                  filterRegex = filter && new RegExp(escapeRegExp(filter), 'i');\n                  items = [];\n                  users = usersFromRoomMessages.find(_objectSpread({\n                    ts: {\n                      $exists: true\n                    }\n                  }, filter && {\n                    $or: [{\n                      username: filterRegex\n                    }, {\n                      name: filterRegex\n                    }]\n                  }), {\n                    limit: suggestionsCount !== null && suggestionsCount !== void 0 ? suggestionsCount : 5,\n                    sort: {\n                      ts: -1\n                    }\n                  }).fetch().map(function (u) {\n                    u.suggestion = true;\n                    return u;\n                  });\n                  if (!filterRegex || filterRegex.test('all')) {\n                    items.push({\n                      _id: 'all',\n                      username: 'all',\n                      system: true,\n                      name: t('Notify_all_in_this_room'),\n                      sort: 4\n                    });\n                  }\n                  if (!filterRegex || filterRegex.test('here')) {\n                    items.push({\n                      _id: 'here',\n                      username: 'here',\n                      system: true,\n                      name: t('Notify_active_in_this_room'),\n                      sort: 4\n                    });\n                  }\n                  return _context.abrupt(\"return\", [].concat(_toConsumableArray(users), items));\n                case 6:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n            return _callee$;\n          }(), null, null, null, Promise);\n        }\n        return _callee;\n      }(),\n      getItemsFromServer: function () {\n        function _callee2(filter) {\n          var filterRegex, usernames, _await$userSpotlight, _await$userSpotlight$, users;\n          return _regeneratorRuntime.async(function () {\n            function _callee2$(_context2) {\n              while (1) switch (_context2.prev = _context2.next) {\n                case 0:\n                  filterRegex = filter && new RegExp(escapeRegExp(filter), 'i');\n                  usernames = usersFromRoomMessages.find(_objectSpread({\n                    ts: {\n                      $exists: true\n                    }\n                  }, filter && {\n                    $or: [{\n                      username: filterRegex\n                    }, {\n                      name: filterRegex\n                    }]\n                  }), {\n                    limit: suggestionsCount !== null && suggestionsCount !== void 0 ? suggestionsCount : 5,\n                    sort: {\n                      ts: -1\n                    }\n                  }).fetch().map(function (u) {\n                    return u.username;\n                  });\n                  _context2.next = 4;\n                  return _regeneratorRuntime.awrap(userSpotlight(filter, usernames, {\n                    users: true,\n                    mentions: true\n                  }, rid));\n                case 4:\n                  _await$userSpotlight = _context2.sent;\n                  _await$userSpotlight$ = _await$userSpotlight.users;\n                  users = _await$userSpotlight$ === void 0 ? [] : _await$userSpotlight$;\n                  return _context2.abrupt(\"return\", users.map(function (_ref2) {\n                    var _id = _ref2._id,\n                      username = _ref2.username,\n                      nickname = _ref2.nickname,\n                      name = _ref2.name,\n                      status = _ref2.status,\n                      avatarETag = _ref2.avatarETag,\n                      outside = _ref2.outside;\n                    return {\n                      _id: _id,\n                      username: username,\n                      nickname: nickname,\n                      name: name,\n                      status: status,\n                      avatarETag: avatarETag,\n                      outside: outside,\n                      sort: 3\n                    };\n                  }));\n                case 8:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n            return _callee2$;\n          }(), null, null, null, Promise);\n        }\n        return _callee2;\n      }(),\n      getValue: function (item) {\n        return item.username;\n      },\n      renderItem: function (_ref3) {\n        var item = _ref3.item;\n        return /*#__PURE__*/React.createElement(ComposerBoxPopupUser, item);\n      }\n    }), createMessageBoxPopupConfig({\n      trigger: '#',\n      title: t('Channels'),\n      getItemsFromLocal: function () {\n        function _callee3(filter) {\n          var filterRegex, records;\n          return _regeneratorRuntime.async(function () {\n            function _callee3$(_context3) {\n              while (1) switch (_context3.prev = _context3.next) {\n                case 0:\n                  filterRegex = new RegExp(escapeRegExp(filter), 'i');\n                  records = Subscriptions.find({\n                    $and: [{\n                      $or: [{\n                        fname: filterRegex\n                      }, {\n                        name: filterRegex\n                      }]\n                    }, {\n                      $or: [{\n                        federated: {\n                          $exists: false\n                        }\n                      }, {\n                        federated: false\n                      }]\n                    }],\n                    t: {\n                      $in: ['c', 'p']\n                    }\n                  }, {\n                    limit: suggestionsCount !== null && suggestionsCount !== void 0 ? suggestionsCount : 5,\n                    sort: {\n                      ls: -1\n                    }\n                  }).fetch();\n                  return _context3.abrupt(\"return\", records);\n                case 3:\n                case \"end\":\n                  return _context3.stop();\n              }\n            }\n            return _callee3$;\n          }(), null, null, null, Promise);\n        }\n        return _callee3;\n      }(),\n      getItemsFromServer: function () {\n        function _callee4(filter) {\n          var _await$userSpotlight2, _await$userSpotlight3, rooms;\n          return _regeneratorRuntime.async(function () {\n            function _callee4$(_context4) {\n              while (1) switch (_context4.prev = _context4.next) {\n                case 0:\n                  _context4.next = 2;\n                  return _regeneratorRuntime.awrap(userSpotlight(filter, [], {\n                    rooms: true,\n                    mentions: true\n                  }, rid));\n                case 2:\n                  _await$userSpotlight2 = _context4.sent;\n                  _await$userSpotlight3 = _await$userSpotlight2.rooms;\n                  rooms = _await$userSpotlight3 === void 0 ? [] : _await$userSpotlight3;\n                  return _context4.abrupt(\"return\", rooms);\n                case 6:\n                case \"end\":\n                  return _context4.stop();\n              }\n            }\n            return _callee4$;\n          }(), null, null, null, Promise);\n        }\n        return _callee4;\n      }(),\n      getValue: function (item) {\n        return \"\" + (item.name || item.fname);\n      },\n      renderItem: function (_ref4) {\n        var item = _ref4.item;\n        return /*#__PURE__*/React.createElement(ComposerBoxPopupRoom, item);\n      }\n    }), useEmoji && createMessageBoxPopupConfig({\n      trigger: ':',\n      title: t('Emoji'),\n      triggerLength: 2,\n      getItemsFromLocal: function () {\n        function _callee5(filter) {\n          var exactFinalTone, colorBlind, seeColor, emojiSort, filterRegex, key, recents, collection;\n          return _regeneratorRuntime.async(function () {\n            function _callee5$(_context5) {\n              while (1) switch (_context5.prev = _context5.next) {\n                case 0:\n                  exactFinalTone = new RegExp('^tone[1-5]:*$');\n                  colorBlind = new RegExp('tone[1-5]:*$');\n                  seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');\n                  emojiSort = function (recents) {\n                    return function (a, b) {\n                      var aExact = a._id === key ? 2 : 0;\n                      var bExact = b._id === key ? 2 : 0;\n                      var aPartial = a._id.startsWith(key) ? 1 : 0;\n                      var bPartial = b._id.startsWith(key) ? 1 : 0;\n                      var aScore = aExact + aPartial;\n                      var bScore = bExact + bPartial;\n                      if (recents.includes(a._id)) {\n                        aScore += recents.indexOf(a._id) + 1;\n                      }\n                      if (recents.includes(b._id)) {\n                        bScore += recents.indexOf(b._id) + 1;\n                      }\n                      if (aScore > bScore) {\n                        return -1;\n                      }\n                      if (aScore < bScore) {\n                        return 1;\n                      }\n                      return 0;\n                    };\n                  };\n                  filterRegex = new RegExp(escapeRegExp(filter), 'i');\n                  key = \":\" + filter;\n                  recents = recentEmojis.map(function (item) {\n                    return \":\" + item + \":\";\n                  });\n                  collection = emoji.list;\n                  return _context5.abrupt(\"return\", Object.keys(collection).map(function (_id) {\n                    var data = collection[key];\n                    return {\n                      _id: _id,\n                      data: data\n                    };\n                  }).filter(function (_ref5) {\n                    var _id = _ref5._id;\n                    return filterRegex.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id));\n                  }).sort(emojiSort(recents)).slice(0, 10));\n                case 9:\n                case \"end\":\n                  return _context5.stop();\n              }\n            }\n            return _callee5$;\n          }(), null, null, null, Promise);\n        }\n        return _callee5;\n      }(),\n      getItemsFromServer: function () {\n        function _callee6() {\n          return _regeneratorRuntime.async(function () {\n            function _callee6$(_context6) {\n              while (1) switch (_context6.prev = _context6.next) {\n                case 0:\n                  return _context6.abrupt(\"return\", []);\n                case 1:\n                case \"end\":\n                  return _context6.stop();\n              }\n            }\n            return _callee6$;\n          }(), null, null, null, Promise);\n        }\n        return _callee6;\n      }(),\n      getValue: function (item) {\n        return \"\" + item._id.substring(1);\n      },\n      renderItem: function (_ref6) {\n        var item = _ref6.item;\n        return /*#__PURE__*/React.createElement(ComposerBoxPopupEmoji, item);\n      }\n    }), createMessageBoxPopupConfig({\n      title: t('Emoji'),\n      trigger: '\\\\+:',\n      prefix: '+',\n      suffix: ' ',\n      triggerAnywhere: false,\n      getItemsFromLocal: function () {\n        function _callee7(filter) {\n          var exactFinalTone, colorBlind, seeColor, emojiSort, filterRegex, key, recents, collection;\n          return _regeneratorRuntime.async(function () {\n            function _callee7$(_context7) {\n              while (1) switch (_context7.prev = _context7.next) {\n                case 0:\n                  exactFinalTone = new RegExp('^tone[1-5]:*$');\n                  colorBlind = new RegExp('tone[1-5]:*$');\n                  seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');\n                  emojiSort = function (recents) {\n                    return function (a, b) {\n                      var idA = a._id;\n                      var idB = a._id;\n                      if (recents.includes(a._id)) {\n                        idA = recents.indexOf(a._id) + idA;\n                      }\n                      if (recents.includes(b._id)) {\n                        idB = recents.indexOf(b._id) + idB;\n                      }\n                      if (idA < idB) {\n                        return -1;\n                      }\n                      if (idA > idB) {\n                        return 1;\n                      }\n                      return 0;\n                    };\n                  };\n                  filterRegex = new RegExp(escapeRegExp(filter), 'i');\n                  key = \":\" + filter;\n                  recents = recentEmojis.map(function (item) {\n                    return \":\" + item + \":\";\n                  });\n                  collection = emoji.list;\n                  return _context7.abrupt(\"return\", Object.keys(collection).map(function (_id) {\n                    var data = collection[key];\n                    return {\n                      _id: _id,\n                      data: data\n                    };\n                  }).filter(function (_ref7) {\n                    var _id = _ref7._id;\n                    return filterRegex.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id));\n                  }).sort(emojiSort(recents)).slice(0, 10));\n                case 9:\n                case \"end\":\n                  return _context7.stop();\n              }\n            }\n            return _callee7$;\n          }(), null, null, null, Promise);\n        }\n        return _callee7;\n      }(),\n      getItemsFromServer: function () {\n        function _callee8() {\n          return _regeneratorRuntime.async(function () {\n            function _callee8$(_context8) {\n              while (1) switch (_context8.prev = _context8.next) {\n                case 0:\n                  return _context8.abrupt(\"return\", []);\n                case 1:\n                case \"end\":\n                  return _context8.stop();\n              }\n            }\n            return _callee8$;\n          }(), null, null, null, Promise);\n        }\n        return _callee8;\n      }(),\n      getValue: function (item) {\n        return \"\" + item._id;\n      },\n      renderItem: function (_ref8) {\n        var item = _ref8.item;\n        return /*#__PURE__*/React.createElement(ComposerBoxPopupEmoji, item);\n      }\n    }), createMessageBoxPopupConfig({\n      title: t('Commands'),\n      trigger: '/',\n      suffix: ' ',\n      triggerAnywhere: false,\n      disabled: encrypted,\n      renderItem: function (_ref9) {\n        var item = _ref9.item;\n        return /*#__PURE__*/React.createElement(ComposerBoxPopupSlashCommand, item);\n      },\n      getItemsFromLocal: function () {\n        function _callee9(filter) {\n          return _regeneratorRuntime.async(function () {\n            function _callee9$(_context9) {\n              while (1) switch (_context9.prev = _context9.next) {\n                case 0:\n                  return _context9.abrupt(\"return\", Object.keys(slashCommands.commands).map(function (command) {\n                    var _item$params;\n                    var item = slashCommands.commands[command];\n                    return _objectSpread({\n                      _id: command,\n                      params: item.params && t.has(item.params) ? t(item.params) : (_item$params = item.params) !== null && _item$params !== void 0 ? _item$params : '',\n                      description: item.description && t.has(item.description) ? t(item.description) : item.description,\n                      permission: item.permission\n                    }, encrypted && {\n                      disabled: encrypted\n                    });\n                  }).filter(function (command) {\n                    var isMatch = command._id.indexOf(filter) > -1;\n                    if (!isMatch) {\n                      return false;\n                    }\n                    if (!command.permission) {\n                      return true;\n                    }\n                    return hasAtLeastOnePermission(command.permission, rid);\n                  }).sort(function (a, b) {\n                    return a._id.localeCompare(b._id);\n                  }).slice(0, 11));\n                case 1:\n                case \"end\":\n                  return _context9.stop();\n              }\n            }\n            return _callee9$;\n          }(), null, null, null, Promise);\n        }\n        return _callee9;\n      }(),\n      getItemsFromServer: function () {\n        function _callee10() {\n          return _regeneratorRuntime.async(function () {\n            function _callee10$(_context10) {\n              while (1) switch (_context10.prev = _context10.next) {\n                case 0:\n                  return _context10.abrupt(\"return\", []);\n                case 1:\n                case \"end\":\n                  return _context10.stop();\n              }\n            }\n            return _callee10$;\n          }(), null, null, null, Promise);\n        }\n        return _callee10;\n      }()\n    }), cannedResponseEnabled && isOmnichannel && createMessageBoxPopupConfig({\n      title: t('Canned_Responses'),\n      trigger: '!',\n      prefix: '',\n      triggerAnywhere: true,\n      renderItem: function (_ref10) {\n        var item = _ref10.item;\n        return /*#__PURE__*/React.createElement(ComposerBoxPopupCannedResponse, item);\n      },\n      getItemsFromLocal: function () {\n        function _callee11(filter) {\n          var exp;\n          return _regeneratorRuntime.async(function () {\n            function _callee11$(_context11) {\n              while (1) switch (_context11.prev = _context11.next) {\n                case 0:\n                  exp = new RegExp(filter, 'i');\n                  return _context11.abrupt(\"return\", CannedResponse.find({\n                    shortcut: exp\n                  }, {\n                    limit: 12,\n                    sort: {\n                      shortcut: -1\n                    }\n                  }).fetch().map(function (record) {\n                    return {\n                      _id: record._id,\n                      text: record.text,\n                      shortcut: record.shortcut\n                    };\n                  }));\n                case 2:\n                case \"end\":\n                  return _context11.stop();\n              }\n            }\n            return _callee11$;\n          }(), null, null, null, Promise);\n        }\n        return _callee11;\n      }(),\n      getItemsFromServer: function () {\n        function _callee12() {\n          return _regeneratorRuntime.async(function () {\n            function _callee12$(_context12) {\n              while (1) switch (_context12.prev = _context12.next) {\n                case 0:\n                  return _context12.abrupt(\"return\", []);\n                case 1:\n                case \"end\":\n                  return _context12.stop();\n              }\n            }\n            return _callee12$;\n          }(), null, null, null, Promise);\n        }\n        return _callee12;\n      }(),\n      getValue: function (item) {\n        return item.text;\n      }\n    }), createMessageBoxPopupConfig({\n      matchSelectorRegex: /(?:^)(\\/[\\w\\d\\S]+ )[^]*$/,\n      preview: true,\n      getItemsFromLocal: function () {\n        function _callee13(_ref11) {\n          var _result$items$map;\n          var cmd, params, tmid, result;\n          return _regeneratorRuntime.async(function () {\n            function _callee13$(_context13) {\n              while (1) switch (_context13.prev = _context13.next) {\n                case 0:\n                  cmd = _ref11.cmd, params = _ref11.params, tmid = _ref11.tmid;\n                  _context13.next = 3;\n                  return _regeneratorRuntime.awrap(call({\n                    cmd: cmd,\n                    params: params,\n                    msg: {\n                      rid: rid,\n                      tmid: tmid\n                    }\n                  }));\n                case 3:\n                  result = _context13.sent;\n                  return _context13.abrupt(\"return\", (_result$items$map = result === null || result === void 0 ? void 0 : result.items.map(function (item) {\n                    return {\n                      _id: item.id,\n                      value: item.value,\n                      type: item.type\n                    };\n                  })) !== null && _result$items$map !== void 0 ? _result$items$map : []);\n                case 5:\n                case \"end\":\n                  return _context13.stop();\n              }\n            }\n            return _callee13$;\n          }(), null, null, null, Promise);\n        }\n        return _callee13;\n      }()\n    })].filter(Boolean);\n  }, [t, cannedResponseEnabled, isOmnichannel, recentEmojis, suggestionsCount, userSpotlight, rid, call, useEmoji, encrypted]);\n  return /*#__PURE__*/React.createElement(ComposerPopupContext.Provider, {\n    value: value,\n    children: children\n  });\n};\nmodule.exportDefault(ComposerPopupProvider);","map":{"version":3,"names":["_regeneratorRuntime","module","link","default","v","_toConsumableArray","_objectSpread","_slicedToArray","isOmnichannelRoom","useLocalStorage","escapeRegExp","useMethod","useSetting","useTranslation","useUserPreference","React","useMemo","hasAtLeastOnePermission","CannedResponse","emoji","Subscriptions","usersFromRoomMessages","slashCommands","ComposerBoxPopupCannedResponse","ComposerBoxPopupEmoji","ComposerBoxPopupRoom","ComposerBoxPopupSlashCommand","ComposerBoxPopupUser","ComposerPopupContext","createMessageBoxPopupConfig","ComposerPopupProvider","_ref","children","room","rid","_id","isRoomEncrypted","encrypted","userSpotlight","suggestionsCount","cannedResponseEnabled","_useLocalStorage","_useLocalStorage2","recentEmojis","isOmnichannel","useEmoji","t","e2eEnabled","unencryptedMessagesAllowed","call","value","trigger","title","getItemsFromLocal","_callee","filter","filterRegex","items","users","async","_callee$","_context","prev","next","RegExp","find","ts","$exists","$or","username","name","limit","sort","fetch","map","u","suggestion","test","push","system","abrupt","concat","stop","Promise","getItemsFromServer","_callee2","usernames","_await$userSpotlight","_await$userSpotlight$","_callee2$","_context2","awrap","mentions","sent","_ref2","nickname","status","avatarETag","outside","getValue","item","renderItem","_ref3","createElement","_callee3","records","_callee3$","_context3","$and","fname","federated","$in","ls","_callee4","_await$userSpotlight2","_await$userSpotlight3","rooms","_callee4$","_context4","_ref4","triggerLength","_callee5","exactFinalTone","colorBlind","seeColor","emojiSort","key","recents","collection","_callee5$","_context5","a","b","aExact","bExact","aPartial","startsWith","bPartial","aScore","bScore","includes","indexOf","list","Object","keys","data","_ref5","substring","length","slice","_callee6","_callee6$","_context6","_ref6","prefix","suffix","triggerAnywhere","_callee7","_callee7$","_context7","idA","idB","_ref7","_callee8","_callee8$","_context8","_ref8","disabled","_ref9","_callee9","_callee9$","_context9","commands","command","_item$params","params","has","description","permission","isMatch","localeCompare","_callee10","_callee10$","_context10","_ref10","_callee11","exp","_callee11$","_context11","shortcut","record","text","_callee12","_callee12$","_context12","matchSelectorRegex","preview","_callee13","_ref11","_result$items$map","cmd","tmid","result","_callee13$","_context13","msg","id","type","Boolean","Provider","exportDefault"],"sources":["client/views/room/providers/ComposerPopupProvider.tsx"],"sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { isOmnichannelRoom } from '@rocket.chat/core-typings';\nimport { useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport { escapeRegExp } from '@rocket.chat/string-helpers';\nimport { useMethod, useSetting, useTranslation, useUserPreference } from '@rocket.chat/ui-contexts';\nimport React, { useMemo } from 'react';\nimport type { ReactNode } from 'react';\n\nimport { hasAtLeastOnePermission } from '../../../../app/authorization/client';\nimport { CannedResponse } from '../../../../app/canned-responses/client/collections/CannedResponse';\nimport { emoji } from '../../../../app/emoji/client';\nimport { Subscriptions } from '../../../../app/models/client';\nimport { usersFromRoomMessages } from '../../../../app/ui-message/client/popup/messagePopupConfig';\nimport { slashCommands } from '../../../../app/utils/client';\nimport ComposerBoxPopupCannedResponse from '../composer/ComposerBoxPopupCannedResponse';\nimport type { ComposerBoxPopupEmojiProps } from '../composer/ComposerBoxPopupEmoji';\nimport ComposerBoxPopupEmoji from '../composer/ComposerBoxPopupEmoji';\nimport ComposerBoxPopupRoom from '../composer/ComposerBoxPopupRoom';\nimport type { ComposerBoxPopupRoomProps } from '../composer/ComposerBoxPopupRoom';\nimport type { ComposerBoxPopupSlashCommandProps } from '../composer/ComposerBoxPopupSlashCommand';\nimport ComposerBoxPopupSlashCommand from '../composer/ComposerBoxPopupSlashCommand';\nimport ComposerBoxPopupUser from '../composer/ComposerBoxPopupUser';\nimport type { ComposerBoxPopupUserProps } from '../composer/ComposerBoxPopupUser';\nimport type { ComposerPopupContextValue } from '../contexts/ComposerPopupContext';\nimport { ComposerPopupContext, createMessageBoxPopupConfig } from '../contexts/ComposerPopupContext';\n\nconst ComposerPopupProvider = ({ children, room }: { children: ReactNode; room: IRoom }) => {\n\tconst { _id: rid, encrypted: isRoomEncrypted } = room;\n\tconst userSpotlight = useMethod('spotlight');\n\tconst suggestionsCount = useSetting<number>('Number_of_users_autocomplete_suggestions');\n\tconst cannedResponseEnabled = useSetting<boolean>('Canned_Responses_Enable');\n\tconst [recentEmojis] = useLocalStorage('emoji.recent', []);\n\tconst isOmnichannel = isOmnichannelRoom(room);\n\tconst useEmoji = useUserPreference('useEmojis');\n\tconst t = useTranslation();\n\tconst e2eEnabled = useSetting<boolean>('E2E_Enable');\n\tconst unencryptedMessagesAllowed = useSetting<boolean>('E2E_Allow_Unencrypted_Messages');\n\tconst encrypted = isRoomEncrypted && e2eEnabled && !unencryptedMessagesAllowed;\n\n\tconst call = useMethod('getSlashCommandPreviews');\n\tconst value: ComposerPopupContextValue = useMemo(() => {\n\t\treturn [\n\t\t\tcreateMessageBoxPopupConfig({\n\t\t\t\ttrigger: '@',\n\t\t\t\ttitle: t('People'),\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = filter && new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst items: ComposerBoxPopupUserProps[] = [];\n\n\t\t\t\t\tconst users = usersFromRoomMessages\n\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tts: { $exists: true },\n\t\t\t\t\t\t\t\t...(filter && {\n\t\t\t\t\t\t\t\t\t$or: [{ username: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\t\tsort: { ts: -1 },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t.map((u) => {\n\t\t\t\t\t\t\tu.suggestion = true;\n\t\t\t\t\t\t\treturn u;\n\t\t\t\t\t\t});\n\t\t\t\t\tif (!filterRegex || filterRegex.test('all')) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t_id: 'all',\n\t\t\t\t\t\t\tusername: 'all',\n\t\t\t\t\t\t\tsystem: true,\n\t\t\t\t\t\t\tname: t('Notify_all_in_this_room'),\n\t\t\t\t\t\t\tsort: 4,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!filterRegex || filterRegex.test('here')) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t_id: 'here',\n\t\t\t\t\t\t\tusername: 'here',\n\t\t\t\t\t\t\tsystem: true,\n\t\t\t\t\t\t\tname: t('Notify_active_in_this_room'),\n\t\t\t\t\t\t\tsort: 4,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\treturn [...users, ...items];\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = filter && new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst usernames = usersFromRoomMessages\n\t\t\t\t\t\t.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tts: { $exists: true },\n\t\t\t\t\t\t\t\t...(filter && {\n\t\t\t\t\t\t\t\t\t$or: [{ username: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\t\tsort: { ts: -1 },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t.map((u) => {\n\t\t\t\t\t\t\treturn u.username;\n\t\t\t\t\t\t});\n\t\t\t\t\tconst { users = [] } = await userSpotlight(filter, usernames, { users: true, mentions: true }, rid);\n\n\t\t\t\t\treturn users.map(({ _id, username, nickname, name, status, avatarETag, outside }) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t_id,\n\t\t\t\t\t\t\tusername,\n\t\t\t\t\t\t\tnickname,\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tstatus,\n\t\t\t\t\t\t\tavatarETag,\n\t\t\t\t\t\t\toutside,\n\t\t\t\t\t\t\tsort: 3,\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => item.username,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupUser {...item} />,\n\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupRoomProps>({\n\t\t\t\ttrigger: '#',\n\t\t\t\ttitle: t('Channels'),\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst records = Subscriptions.find(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$and: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$or: [{ fname: filterRegex }, { name: filterRegex }],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$or: [{ federated: { $exists: false } }, { federated: false }],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tt: {\n\t\t\t\t\t\t\t\t$in: ['c', 'p'],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlimit: suggestionsCount ?? 5,\n\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\tls: -1,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t).fetch();\n\t\t\t\t\treturn records;\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async (filter: string) => {\n\t\t\t\t\tconst { rooms = [] } = await userSpotlight(filter, [], { rooms: true, mentions: true }, rid);\n\t\t\t\t\treturn rooms as unknown as ComposerBoxPopupRoomProps[];\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => `${item.name || item.fname}`,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupRoom {...item} />,\n\t\t\t}) as any,\n\t\t\tuseEmoji &&\n\t\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupEmojiProps>({\n\t\t\t\t\ttrigger: ':',\n\t\t\t\t\ttitle: t('Emoji'),\n\t\t\t\t\ttriggerLength: 2,\n\t\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\t\tconst exactFinalTone = new RegExp('^tone[1-5]:*$');\n\t\t\t\t\t\tconst colorBlind = new RegExp('tone[1-5]:*$');\n\t\t\t\t\t\tconst seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');\n\n\t\t\t\t\t\tconst emojiSort = (recents: string[]) => (a: { _id: string }, b: { _id: string }) => {\n\t\t\t\t\t\t\tconst aExact = a._id === key ? 2 : 0;\n\t\t\t\t\t\t\tconst bExact = b._id === key ? 2 : 0;\n\t\t\t\t\t\t\tconst aPartial = a._id.startsWith(key) ? 1 : 0;\n\t\t\t\t\t\t\tconst bPartial = b._id.startsWith(key) ? 1 : 0;\n\n\t\t\t\t\t\t\tlet aScore = aExact + aPartial;\n\t\t\t\t\t\t\tlet bScore = bExact + bPartial;\n\n\t\t\t\t\t\t\tif (recents.includes(a._id)) {\n\t\t\t\t\t\t\t\taScore += recents.indexOf(a._id) + 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (recents.includes(b._id)) {\n\t\t\t\t\t\t\t\tbScore += recents.indexOf(b._id) + 1;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (aScore > bScore) {\n\t\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (aScore < bScore) {\n\t\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\t\tconst key = `:${filter}`;\n\n\t\t\t\t\t\tconst recents = recentEmojis.map((item) => `:${item}:`);\n\n\t\t\t\t\t\tconst collection = emoji.list;\n\n\t\t\t\t\t\treturn Object.keys(collection)\n\t\t\t\t\t\t\t.map((_id) => {\n\t\t\t\t\t\t\t\tconst data = collection[key];\n\t\t\t\t\t\t\t\treturn { _id, data };\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t\t({ _id }) =>\n\t\t\t\t\t\t\t\t\tfilterRegex.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id)),\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.sort(emojiSort(recents))\n\t\t\t\t\t\t\t.slice(0, 10);\n\t\t\t\t\t},\n\t\t\t\t\tgetItemsFromServer: async () => {\n\t\t\t\t\t\treturn [];\n\t\t\t\t\t},\n\t\t\t\t\tgetValue: (item) => `${item._id.substring(1)}`,\n\t\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupEmoji {...item} />,\n\t\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupEmojiProps>({\n\t\t\t\ttitle: t('Emoji'),\n\t\t\t\ttrigger: '\\\\+:',\n\t\t\t\tprefix: '+',\n\t\t\t\tsuffix: ' ',\n\t\t\t\ttriggerAnywhere: false,\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\tconst exactFinalTone = new RegExp('^tone[1-5]:*$');\n\t\t\t\t\tconst colorBlind = new RegExp('tone[1-5]:*$');\n\t\t\t\t\tconst seeColor = new RegExp('_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$');\n\n\t\t\t\t\tconst emojiSort = (recents: string[]) => (a: { _id: string }, b: { _id: string }) => {\n\t\t\t\t\t\tlet idA = a._id;\n\t\t\t\t\t\tlet idB = a._id;\n\n\t\t\t\t\t\tif (recents.includes(a._id)) {\n\t\t\t\t\t\t\tidA = recents.indexOf(a._id) + idA;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (recents.includes(b._id)) {\n\t\t\t\t\t\t\tidB = recents.indexOf(b._id) + idB;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (idA < idB) {\n\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (idA > idB) {\n\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t};\n\t\t\t\t\tconst filterRegex = new RegExp(escapeRegExp(filter), 'i');\n\t\t\t\t\tconst key = `:${filter}`;\n\n\t\t\t\t\tconst recents = recentEmojis.map((item) => `:${item}:`);\n\n\t\t\t\t\tconst collection = emoji.list;\n\n\t\t\t\t\treturn Object.keys(collection)\n\t\t\t\t\t\t.map((_id) => {\n\t\t\t\t\t\t\tconst data = collection[key];\n\t\t\t\t\t\t\treturn { _id, data };\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t({ _id }) =>\n\t\t\t\t\t\t\t\tfilterRegex.test(_id) && (exactFinalTone.test(_id.substring(key.length)) || seeColor.test(key) || !colorBlind.test(_id)),\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.sort(emojiSort(recents))\n\t\t\t\t\t\t.slice(0, 10);\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async () => {\n\t\t\t\t\treturn [];\n\t\t\t\t},\n\t\t\t\tgetValue: (item) => `${item._id}`,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupEmoji {...item} />,\n\t\t\t}),\n\n\t\t\tcreateMessageBoxPopupConfig<ComposerBoxPopupSlashCommandProps>({\n\t\t\t\ttitle: t('Commands'),\n\t\t\t\ttrigger: '/',\n\t\t\t\tsuffix: ' ',\n\t\t\t\ttriggerAnywhere: false,\n\t\t\t\tdisabled: encrypted,\n\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupSlashCommand {...item} />,\n\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\treturn Object.keys(slashCommands.commands)\n\t\t\t\t\t\t.map((command) => {\n\t\t\t\t\t\t\tconst item = slashCommands.commands[command];\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t_id: command,\n\t\t\t\t\t\t\t\tparams: item.params && t.has(item.params) ? t(item.params) : item.params ?? '',\n\t\t\t\t\t\t\t\tdescription: item.description && t.has(item.description) ? t(item.description) : item.description,\n\t\t\t\t\t\t\t\tpermission: item.permission,\n\t\t\t\t\t\t\t\t...(encrypted && { disabled: encrypted }),\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.filter((command) => {\n\t\t\t\t\t\t\tconst isMatch = command._id.indexOf(filter) > -1;\n\n\t\t\t\t\t\t\tif (!isMatch) {\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!command.permission) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn hasAtLeastOnePermission(command.permission, rid);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.sort((a, b) => a._id.localeCompare(b._id))\n\t\t\t\t\t\t.slice(0, 11);\n\t\t\t\t},\n\t\t\t\tgetItemsFromServer: async () => [],\n\t\t\t}),\n\t\t\tcannedResponseEnabled &&\n\t\t\t\tisOmnichannel &&\n\t\t\t\tcreateMessageBoxPopupConfig<{\n\t\t\t\t\t_id: string;\n\t\t\t\t\ttext: string;\n\t\t\t\t\tshortcut: string;\n\t\t\t\t}>({\n\t\t\t\t\ttitle: t('Canned_Responses'),\n\t\t\t\t\ttrigger: '!',\n\t\t\t\t\tprefix: '',\n\t\t\t\t\ttriggerAnywhere: true,\n\t\t\t\t\trenderItem: ({ item }) => <ComposerBoxPopupCannedResponse {...item} />,\n\t\t\t\t\tgetItemsFromLocal: async (filter: string) => {\n\t\t\t\t\t\tconst exp = new RegExp(filter, 'i');\n\t\t\t\t\t\treturn CannedResponse.find(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshortcut: exp,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlimit: 12,\n\t\t\t\t\t\t\t\tsort: {\n\t\t\t\t\t\t\t\t\tshortcut: -1,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.fetch()\n\t\t\t\t\t\t\t.map((record) => ({\n\t\t\t\t\t\t\t\t_id: record._id,\n\t\t\t\t\t\t\t\ttext: record.text,\n\t\t\t\t\t\t\t\tshortcut: record.shortcut,\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t},\n\t\t\t\t\tgetItemsFromServer: async () => [],\n\t\t\t\t\tgetValue: (item) => {\n\t\t\t\t\t\treturn item.text;\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\tcreateMessageBoxPopupConfig({\n\t\t\t\tmatchSelectorRegex: /(?:^)(\\/[\\w\\d\\S]+ )[^]*$/,\n\t\t\t\tpreview: true,\n\t\t\t\tgetItemsFromLocal: async ({ cmd, params, tmid }: { cmd: string; params: string; tmid: string }) => {\n\t\t\t\t\tconst result = await call({ cmd, params, msg: { rid, tmid } });\n\t\t\t\t\treturn (\n\t\t\t\t\t\tresult?.items.map((item) => ({\n\t\t\t\t\t\t\t_id: item.id,\n\t\t\t\t\t\t\tvalue: item.value,\n\t\t\t\t\t\t\ttype: item.type,\n\t\t\t\t\t\t})) ?? []\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t}),\n\t\t].filter(Boolean);\n\t}, [t, cannedResponseEnabled, isOmnichannel, recentEmojis, suggestionsCount, userSpotlight, rid, call, useEmoji, encrypted]);\n\n\treturn <ComposerPopupContext.Provider value={value} children={children} />;\n};\n\nexport default ComposerPopupProvider;\n"],"mappings":"AACA,IAAAA,mBAAS;AAAAC,MAAmB,CAAAC,IAAM,6BAA4B;EAAAC,OAAA,WAAAA,CAAAC,CAAA;IAAAJ,mBAAA,GAAAI,CAAA;EAAA;AAAA;AAAA,IAAAC,kBAAA;AAAAJ,MAAA,CAAAC,IAAA;EAAAC,OAAA,WAAAA,CAAAC,CAAA;IAAAC,kBAAA,GAAAD,CAAA;EAAA;AAAA;AAAA,IAAAE,aAAA;AAAAL,MAAA,CAAAC,IAAA;EAAAC,OAAA,WAAAA,CAAAC,CAAA;IAAAE,aAAA,GAAAF,CAAA;EAAA;AAAA;AAAA,IAAAG,cAAA;AAAAN,MAAA,CAAAC,IAAA;EAAAC,OAAA,WAAAA,CAAAC,CAAA;IAAAG,cAAA,GAAAH,CAAA;EAAA;AAAA;AAA9D,IAAAI,iBAAS;AAAAP,MAAmB,CAAAC,IAAA,CAAM,2BAA2B,EAAC;EAAAM,iBAAA,WAAAA,CAAAJ,CAAA;IAAAI,iBAAA,GAAAJ,CAAA;EAAA;AAAA;AAAA,IAAAK,eAAA;AAAAR,MAAA,CAAAC,IAAA;EAAAO,eAAA,WAAAA,CAAAL,CAAA;IAAAK,eAAA,GAAAL,CAAA;EAAA;AAAA;AAAA,IAAAM,YAAA;AAAAT,MAAA,CAAAC,IAAA;EAAAQ,YAAA,WAAAA,CAAAN,CAAA;IAAAM,YAAA,GAAAN,CAAA;EAAA;AAAA;AAAA,IAAAO,SAAA,EAAAC,UAAA,EAAAC,cAAA,EAAAC,iBAAA;AAAAb,MAAA,CAAAC,IAAA;EAAAS,SAAA,WAAAA,CAAAP,CAAA;IAAAO,SAAA,GAAAP,CAAA;EAAA;EAAAQ,UAAA,WAAAA,CAAAR,CAAA;IAAAQ,UAAA,GAAAR,CAAA;EAAA;EAAAS,cAAA,WAAAA,CAAAT,CAAA;IAAAS,cAAA,GAAAT,CAAA;EAAA;EAAAU,iBAAA,WAAAA,CAAAV,CAAA;IAAAU,iBAAA,GAAAV,CAAA;EAAA;AAAA;AAAA,IAAAW,KAAA,EAAAC,OAAA;AAAAf,MAAA,CAAAC,IAAA;EAAA,oBAAAC,CAAAC,CAAA;IAAAW,KAAA,GAAAX,CAAA;EAAA;EAAAY,OAAA,WAAAA,CAAAZ,CAAA;IAAAY,OAAA,GAAAZ,CAAA;EAAA;AAAA;AAAA,IAAAa,uBAAA;AAAAhB,MAAA,CAAAC,IAAA;EAAAe,uBAAA,WAAAA,CAAAb,CAAA;IAAAa,uBAAA,GAAAb,CAAA;EAAA;AAAA;AAAA,IAAAc,cAAA;AAAAjB,MAAA,CAAAC,IAAA;EAAAgB,cAAA,WAAAA,CAAAd,CAAA;IAAAc,cAAA,GAAAd,CAAA;EAAA;AAAA;AAAA,IAAAe,KAAA;AAAAlB,MAAA,CAAAC,IAAA;EAAAiB,KAAA,WAAAA,CAAAf,CAAA;IAAAe,KAAA,GAAAf,CAAA;EAAA;AAAA;AAAA,IAAAgB,aAAA;AAAAnB,MAAA,CAAAC,IAAA;EAAAkB,aAAA,WAAAA,CAAAhB,CAAA;IAAAgB,aAAA,GAAAhB,CAAA;EAAA;AAAA;AAAA,IAAAiB,qBAAA;AAAApB,MAAA,CAAAC,IAAA;EAAAmB,qBAAA,WAAAA,CAAAjB,CAAA;IAAAiB,qBAAA,GAAAjB,CAAA;EAAA;AAAA;AAAA,IAAAkB,aAAA;AAAArB,MAAA,CAAAC,IAAA;EAAAoB,aAAA,WAAAA,CAAAlB,CAAA;IAAAkB,aAAA,GAAAlB,CAAA;EAAA;AAAA;AAAA,IAAAmB,8BAAA;AAAAtB,MAAA,CAAAC,IAAA;EAAA,oBAAAC,CAAAC,CAAA;IAAAmB,8BAAA,GAAAnB,CAAA;EAAA;AAAA;AAAA,IAAAoB,qBAAA;AAAAvB,MAAA,CAAAC,IAAA;EAAA,oBAAAC,CAAAC,CAAA;IAAAoB,qBAAA,GAAApB,CAAA;EAAA;AAAA;AAAA,IAAAqB,oBAAA;AAAAxB,MAAA,CAAAC,IAAA;EAAA,oBAAAC,CAAAC,CAAA;IAAAqB,oBAAA,GAAArB,CAAA;EAAA;AAAA;AAAA,IAAAsB,4BAAA;AAAAzB,MAAA,CAAAC,IAAA;EAAA,oBAAAC,CAAAC,CAAA;IAAAsB,4BAAA,GAAAtB,CAAA;EAAA;AAAA;AAAA,IAAAuB,oBAAA;AAAA1B,MAAA,CAAAC,IAAA;EAAA,oBAAAC,CAAAC,CAAA;IAAAuB,oBAAA,GAAAvB,CAAA;EAAA;AAAA;AAAA,IAAAwB,oBAAA,EAAAC,2BAAA;AAAA5B,MAAA,CAAAC,IAAA;EAAA0B,oBAAA,WAAAA,CAAAxB,CAAA;IAAAwB,oBAAA,GAAAxB,CAAA;EAAA;EAAAyB,2BAAA,WAAAA,CAAAzB,CAAA;IAAAyB,2BAAA,GAAAzB,CAAA;EAAA;AAAA;AAyB9D,IAAM0B,qBAAqB,GAAG,SAAAA,CAAAC,IAAA,EAA6D;EAAA,IAA1DC,QAAQ,GAAAD,IAAA,CAARC,QAAQ;IAAEC,IAAI,GAAAF,IAAA,CAAJE,IAAI;EAC9C,IAAaC,GAAG,GAAiCD,IAAI,CAA7CE,GAAG;IAAkBC,eAAe,GAAKH,IAAI,CAAnCI,SAAS;EAC3B,IAAMC,aAAa,GAAG3B,SAAS,CAAC,WAAW,CAAC;EAC5C,IAAM4B,gBAAgB,GAAG3B,UAAU,CAAS,0CAA0C,CAAC;EACvF,IAAM4B,qBAAqB,GAAG5B,UAAU,CAAU,yBAAyB,CAAC;EAC5E,IAAA6B,gBAAA,GAAuBhC,eAAe,CAAC,cAAc,EAAE,EAAE,CAAC;IAAAiC,iBAAA,GAAAnC,cAAA,CAAAkC,gBAAA;IAAnDE,YAAY,GAAAD,iBAAA;EACnB,IAAME,aAAa,GAAGpC,iBAAiB,CAACyB,IAAI,CAAC;EAC7C,IAAMY,QAAQ,GAAG/B,iBAAiB,CAAC,WAAW,CAAC;EAC/C,IAAMgC,CAAC,GAAGjC,cAAc,EAAE;EAC1B,IAAMkC,UAAU,GAAGnC,UAAU,CAAU,YAAY,CAAC;EACpD,IAAMoC,0BAA0B,GAAGpC,UAAU,CAAU,gCAAgC,CAAC;EACxF,IAAMyB,SAAS,GAAGD,eAAe,IAAIW,UAAU,IAAI,CAACC,0BAA0B;EAE9E,IAAMC,IAAI,GAAGtC,SAAS,CAAC,yBAAyB,CAAC;EACjD,IAAMuC,KAAK,GAA8BlC,OAAO,CAAC,YAAK;IACrD,OAAO,CACNa,2BAA2B,CAAC;MAC3BsB,OAAO,EAAE,GAAG;MACZC,KAAK,EAAEN,CAAC,CAAC,QAAQ,CAAC;MAClBO,iBAAiB;QAAE,SAAAC,QAAOC,MAAc;UAAA,IAAAC,WAAA,EAAAC,KAAA,EAAAC,KAAA;UAAA,OAAA1D,mBAAA,CAAA2D,KAAA;YAAA,SAAAC,SAAAC,QAAA;cAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;gBAAA;kBACjCP,WAAW,GAAGD,MAAM,IAAI,IAAIS,MAAM,CAACtD,YAAY,CAAC6C,MAAM,CAAC,EAAE,GAAG,CAAC;kBAC7DE,KAAK,GAAgC,EAAE;kBAEvCC,KAAK,GAAGrC,qBAAqB,CACjC4C,IAAI,CAAA3D,aAAA;oBAEH4D,EAAE,EAAE;sBAAEC,OAAO,EAAE;oBAAI;kBAAE,GACjBZ,MAAM,IAAI;oBACba,GAAG,EAAE,CAAC;sBAAEC,QAAQ,EAAEb;oBAAW,CAAE,EAAE;sBAAEc,IAAI,EAAEd;oBAAW,CAAE;mBACtD,GAEF;oBACCe,KAAK,EAAEhC,gBAAgB,aAAhBA,gBAAgB,cAAhBA,gBAAgB,GAAI,CAAC;oBAC5BiC,IAAI,EAAE;sBAAEN,EAAE,EAAE,CAAC;oBAAC;mBACd,CACD,CACAO,KAAK,EAAE,CACPC,GAAG,CAAC,UAACC,CAAC,EAAI;oBACVA,CAAC,CAACC,UAAU,GAAG,IAAI;oBACnB,OAAOD,CAAC;kBACT,CAAC,CAAC;kBACH,IAAI,CAACnB,WAAW,IAAIA,WAAW,CAACqB,IAAI,CAAC,KAAK,CAAC,EAAE;oBAC5CpB,KAAK,CAACqB,IAAI,CAAC;sBACV3C,GAAG,EAAE,KAAK;sBACVkC,QAAQ,EAAE,KAAK;sBACfU,MAAM,EAAE,IAAI;sBACZT,IAAI,EAAExB,CAAC,CAAC,yBAAyB,CAAC;sBAClC0B,IAAI,EAAE;qBACN,CAAC;kBACH;kBAEA,IAAI,CAAChB,WAAW,IAAIA,WAAW,CAACqB,IAAI,CAAC,MAAM,CAAC,EAAE;oBAC7CpB,KAAK,CAACqB,IAAI,CAAC;sBACV3C,GAAG,EAAE,MAAM;sBACXkC,QAAQ,EAAE,MAAM;sBAChBU,MAAM,EAAE,IAAI;sBACZT,IAAI,EAAExB,CAAC,CAAC,4BAA4B,CAAC;sBACrC0B,IAAI,EAAE;qBACN,CAAC;kBACH;kBAAC,OAAAX,QAAA,CAAAmB,MAAA,cAAAC,MAAA,CAAA5E,kBAAA,CAEUqD,KAAK,GAAKD,KAAK;gBAAA;gBAAA;kBAAA,OAAAI,QAAA,CAAAqB,IAAA;cAAA;YAAA;YAAA,OAAAtB,QAAA;UAAA,uBAAAuB,OAAA;QAAA;QAC1B,OAAA7B,OAAA;MAAA;MACD8B,kBAAkB;QAAE,SAAAC,SAAO9B,MAAc;UAAA,IAAAC,WAAA,EAAA8B,SAAA,EAAAC,oBAAA,EAAAC,qBAAA,EAAA9B,KAAA;UAAA,OAAA1D,mBAAA,CAAA2D,KAAA;YAAA,SAAA8B,UAAAC,SAAA;cAAA,kBAAAA,SAAA,CAAA5B,IAAA,GAAA4B,SAAA,CAAA3B,IAAA;gBAAA;kBAClCP,WAAW,GAAGD,MAAM,IAAI,IAAIS,MAAM,CAACtD,YAAY,CAAC6C,MAAM,CAAC,EAAE,GAAG,CAAC;kBAC7D+B,SAAS,GAAGjE,qBAAqB,CACrC4C,IAAI,CAAA3D,aAAA;oBAEH4D,EAAE,EAAE;sBAAEC,OAAO,EAAE;oBAAI;kBAAE,GACjBZ,MAAM,IAAI;oBACba,GAAG,EAAE,CAAC;sBAAEC,QAAQ,EAAEb;oBAAW,CAAE,EAAE;sBAAEc,IAAI,EAAEd;oBAAW,CAAE;mBACtD,GAEF;oBACCe,KAAK,EAAEhC,gBAAgB,aAAhBA,gBAAgB,cAAhBA,gBAAgB,GAAI,CAAC;oBAC5BiC,IAAI,EAAE;sBAAEN,EAAE,EAAE,CAAC;oBAAC;mBACd,CACD,CACAO,KAAK,EAAE,CACPC,GAAG,CAAC,UAACC,CAAC,EAAI;oBACV,OAAOA,CAAC,CAACN,QAAQ;kBAClB,CAAC,CAAC;kBAAAqB,SAAA,CAAA3B,IAAA;kBAAA,OAAA/D,mBAAA,CAAA2F,KAAA,CAC0BrD,aAAa,CAACiB,MAAM,EAAE+B,SAAS,EAAE;oBAAE5B,KAAK,EAAE,IAAI;oBAAEkC,QAAQ,EAAE;kBAAI,CAAE,EAAE1D,GAAG,CAAC;gBAAA;kBAAAqD,oBAAA,GAAAG,SAAA,CAAAG,IAAA;kBAAAL,qBAAA,GAAAD,oBAAA,CAA3F7B,KAAK;kBAALA,KAAK,GAAA8B,qBAAA,cAAG,EAAE,GAAAA,qBAAA;kBAAA,OAAAE,SAAA,CAAAV,MAAA,WAEXtB,KAAK,CAACgB,GAAG,CAAC,UAAAoB,KAAA,EAAmE;oBAAA,IAAhE3D,GAAG,GAAA2D,KAAA,CAAH3D,GAAG;sBAAEkC,QAAQ,GAAAyB,KAAA,CAARzB,QAAQ;sBAAE0B,QAAQ,GAAAD,KAAA,CAARC,QAAQ;sBAAEzB,IAAI,GAAAwB,KAAA,CAAJxB,IAAI;sBAAE0B,MAAM,GAAAF,KAAA,CAANE,MAAM;sBAAEC,UAAU,GAAAH,KAAA,CAAVG,UAAU;sBAAEC,OAAO,GAAAJ,KAAA,CAAPI,OAAO;oBAC7E,OAAO;sBACN/D,GAAG,EAAHA,GAAG;sBACHkC,QAAQ,EAARA,QAAQ;sBACR0B,QAAQ,EAARA,QAAQ;sBACRzB,IAAI,EAAJA,IAAI;sBACJ0B,MAAM,EAANA,MAAM;sBACNC,UAAU,EAAVA,UAAU;sBACVC,OAAO,EAAPA,OAAO;sBACP1B,IAAI,EAAE;qBACN;kBACF,CAAC,CAAC;gBAAA;gBAAA;kBAAA,OAAAkB,SAAA,CAAAR,IAAA;cAAA;YAAA;YAAA,OAAAO,SAAA;UAAA,uBAAAN,OAAA;QAAA;QACF,OAAAE,QAAA;MAAA;MACDc,QAAQ,EAAE,SAAAA,CAACC,IAAI;QAAA,OAAKA,IAAI,CAAC/B,QAAQ;MAAA;MACjCgC,UAAU,EAAE,SAAAA,CAAAC,KAAA;QAAA,IAAGF,IAAI,GAAAE,KAAA,CAAJF,IAAI;QAAA,oBAAOrF,KAAA,CAAAwF,aAAA,CAAC5E,oBAAoB,EAAKyE,IAAK,CAAG;MAAA;KAC5D,CAAC,EACFvE,2BAA2B,CAA4B;MACtDsB,OAAO,EAAE,GAAG;MACZC,KAAK,EAAEN,CAAC,CAAC,UAAU,CAAC;MACpBO,iBAAiB;QAAE,SAAAmD,SAAOjD,MAAc;UAAA,IAAAC,WAAA,EAAAiD,OAAA;UAAA,OAAAzG,mBAAA,CAAA2D,KAAA;YAAA,SAAA+C,UAAAC,SAAA;cAAA,kBAAAA,SAAA,CAAA7C,IAAA,GAAA6C,SAAA,CAAA5C,IAAA;gBAAA;kBACjCP,WAAW,GAAG,IAAIQ,MAAM,CAACtD,YAAY,CAAC6C,MAAM,CAAC,EAAE,GAAG,CAAC;kBACnDkD,OAAO,GAAGrF,aAAa,CAAC6C,IAAI,CACjC;oBACC2C,IAAI,EAAE,CACL;sBACCxC,GAAG,EAAE,CAAC;wBAAEyC,KAAK,EAAErD;sBAAW,CAAE,EAAE;wBAAEc,IAAI,EAAEd;sBAAW,CAAE;qBACnD,EACD;sBACCY,GAAG,EAAE,CAAC;wBAAE0C,SAAS,EAAE;0BAAE3C,OAAO,EAAE;wBAAK;sBAAE,CAAE,EAAE;wBAAE2C,SAAS,EAAE;sBAAK,CAAE;qBAC7D,CACD;oBACDhE,CAAC,EAAE;sBACFiE,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG;;mBAEf,EACD;oBACCxC,KAAK,EAAEhC,gBAAgB,aAAhBA,gBAAgB,cAAhBA,gBAAgB,GAAI,CAAC;oBAC5BiC,IAAI,EAAE;sBACLwC,EAAE,EAAE,CAAC;;mBAEN,CACD,CAACvC,KAAK,EAAE;kBAAA,OAAAkC,SAAA,CAAA3B,MAAA,WACFyB,OAAO;gBAAA;gBAAA;kBAAA,OAAAE,SAAA,CAAAzB,IAAA;cAAA;YAAA;YAAA,OAAAwB,SAAA;UAAA,uBAAAvB,OAAA;QAAA;QACd,OAAAqB,QAAA;MAAA;MACDpB,kBAAkB;QAAE,SAAA6B,SAAO1D,MAAc;UAAA,IAAA2D,qBAAA,EAAAC,qBAAA,EAAAC,KAAA;UAAA,OAAApH,mBAAA,CAAA2D,KAAA;YAAA,SAAA0D,UAAAC,SAAA;cAAA,kBAAAA,SAAA,CAAAxD,IAAA,GAAAwD,SAAA,CAAAvD,IAAA;gBAAA;kBAAAuD,SAAA,CAAAvD,IAAA;kBAAA,OAAA/D,mBAAA,CAAA2F,KAAA,CACXrD,aAAa,CAACiB,MAAM,EAAE,EAAE,EAAE;oBAAE6D,KAAK,EAAE,IAAI;oBAAExB,QAAQ,EAAE;kBAAI,CAAE,EAAE1D,GAAG,CAAC;gBAAA;kBAAAgF,qBAAA,GAAAI,SAAA,CAAAzB,IAAA;kBAAAsB,qBAAA,GAAAD,qBAAA,CAApFE,KAAK;kBAALA,KAAK,GAAAD,qBAAA,cAAG,EAAE,GAAAA,qBAAA;kBAAA,OAAAG,SAAA,CAAAtC,MAAA,WACXoC,KAA+C;gBAAA;gBAAA;kBAAA,OAAAE,SAAA,CAAApC,IAAA;cAAA;YAAA;YAAA,OAAAmC,SAAA;UAAA,uBAAAlC,OAAA;QAAA;QACtD,OAAA8B,QAAA;MAAA;MACDd,QAAQ,EAAE,SAAAA,CAACC,IAAI;QAAA,aAAQA,IAAI,CAAC9B,IAAI,IAAI8B,IAAI,CAACS,KAAK;MAAA,CAAE;MAChDR,UAAU,EAAE,SAAAA,CAAAkB,KAAA;QAAA,IAAGnB,IAAI,GAAAmB,KAAA,CAAJnB,IAAI;QAAA,oBAAOrF,KAAA,CAAAwF,aAAA,CAAC9E,oBAAoB,EAAK2E,IAAK,CAAG;MAAA;KAC5D,CAAQ,EACTvD,QAAQ,IACPhB,2BAA2B,CAA6B;MACvDsB,OAAO,EAAE,GAAG;MACZC,KAAK,EAAEN,CAAC,CAAC,OAAO,CAAC;MACjB0E,aAAa,EAAE,CAAC;MAChBnE,iBAAiB;QAAE,SAAAoE,SAAOlE,MAAc;UAAA,IAAAmE,cAAA,EAAAC,UAAA,EAAAC,QAAA,EAAAC,SAAA,EAAArE,WAAA,EAAAsE,GAAA,EAAAC,OAAA,EAAAC,UAAA;UAAA,OAAAhI,mBAAA,CAAA2D,KAAA;YAAA,SAAAsE,UAAAC,SAAA;cAAA,kBAAAA,SAAA,CAAApE,IAAA,GAAAoE,SAAA,CAAAnE,IAAA;gBAAA;kBACjC2D,cAAc,GAAG,IAAI1D,MAAM,CAAC,eAAe,CAAC;kBAC5C2D,UAAU,GAAG,IAAI3D,MAAM,CAAC,cAAc,CAAC;kBACvC4D,QAAQ,GAAG,IAAI5D,MAAM,CAAC,4CAA4C,CAAC;kBAEnE6D,SAAS,GAAG,SAAAA,CAACE,OAAiB;oBAAA,OAAK,UAACI,CAAkB,EAAEC,CAAkB,EAAI;sBACnF,IAAMC,MAAM,GAAGF,CAAC,CAAChG,GAAG,KAAK2F,GAAG,GAAG,CAAC,GAAG,CAAC;sBACpC,IAAMQ,MAAM,GAAGF,CAAC,CAACjG,GAAG,KAAK2F,GAAG,GAAG,CAAC,GAAG,CAAC;sBACpC,IAAMS,QAAQ,GAAGJ,CAAC,CAAChG,GAAG,CAACqG,UAAU,CAACV,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC;sBAC9C,IAAMW,QAAQ,GAAGL,CAAC,CAACjG,GAAG,CAACqG,UAAU,CAACV,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC;sBAE9C,IAAIY,MAAM,GAAGL,MAAM,GAAGE,QAAQ;sBAC9B,IAAII,MAAM,GAAGL,MAAM,GAAGG,QAAQ;sBAE9B,IAAIV,OAAO,CAACa,QAAQ,CAACT,CAAC,CAAChG,GAAG,CAAC,EAAE;wBAC5BuG,MAAM,IAAIX,OAAO,CAACc,OAAO,CAACV,CAAC,CAAChG,GAAG,CAAC,GAAG,CAAC;sBACrC;sBACA,IAAI4F,OAAO,CAACa,QAAQ,CAACR,CAAC,CAACjG,GAAG,CAAC,EAAE;wBAC5BwG,MAAM,IAAIZ,OAAO,CAACc,OAAO,CAACT,CAAC,CAACjG,GAAG,CAAC,GAAG,CAAC;sBACrC;sBAEA,IAAIuG,MAAM,GAAGC,MAAM,EAAE;wBACpB,OAAO,CAAC,CAAC;sBACV;sBACA,IAAID,MAAM,GAAGC,MAAM,EAAE;wBACpB,OAAO,CAAC;sBACT;sBACA,OAAO,CAAC;oBACT,CAAC;kBAAA;kBACKnF,WAAW,GAAG,IAAIQ,MAAM,CAACtD,YAAY,CAAC6C,MAAM,CAAC,EAAE,GAAG,CAAC;kBACnDuE,GAAG,SAAOvE,MAAM;kBAEhBwE,OAAO,GAAGpF,YAAY,CAAC+B,GAAG,CAAC,UAAC0B,IAAI;oBAAA,aAASA,IAAI;kBAAA,CAAG,CAAC;kBAEjD4B,UAAU,GAAG7G,KAAK,CAAC2H,IAAI;kBAAA,OAAAZ,SAAA,CAAAlD,MAAA,WAEtB+D,MAAM,CAACC,IAAI,CAAChB,UAAU,CAAC,CAC5BtD,GAAG,CAAC,UAACvC,GAAG,EAAI;oBACZ,IAAM8G,IAAI,GAAGjB,UAAU,CAACF,GAAG,CAAC;oBAC5B,OAAO;sBAAE3F,GAAG,EAAHA,GAAG;sBAAE8G,IAAI,EAAJA;oBAAI,CAAE;kBACrB,CAAC,CAAC,CACD1F,MAAM,CACN,UAAA2F,KAAA;oBAAA,IAAG/G,GAAG,GAAA+G,KAAA,CAAH/G,GAAG;oBAAA,OACLqB,WAAW,CAACqB,IAAI,CAAC1C,GAAG,CAAC,KAAKuF,cAAc,CAAC7C,IAAI,CAAC1C,GAAG,CAACgH,SAAS,CAACrB,GAAG,CAACsB,MAAM,CAAC,CAAC,IAAIxB,QAAQ,CAAC/C,IAAI,CAACiD,GAAG,CAAC,IAAI,CAACH,UAAU,CAAC9C,IAAI,CAAC1C,GAAG,CAAC,CAAC;kBAAA,EACzH,CACAqC,IAAI,CAACqD,SAAS,CAACE,OAAO,CAAC,CAAC,CACxBsB,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC;gBAAA;gBAAA;kBAAA,OAAAnB,SAAA,CAAAhD,IAAA;cAAA;YAAA;YAAA,OAAA+C,SAAA;UAAA,uBAAA9C,OAAA;QAAA;QACd,OAAAsC,QAAA;MAAA;MACDrC,kBAAkB;QAAE,SAAAkE,SAAA;UAAA,OAAAtJ,mBAAA,CAAA2D,KAAA;YAAA,SAAA4F,UAAAC,SAAA;cAAA,kBAAAA,SAAA,CAAA1F,IAAA,GAAA0F,SAAA,CAAAzF,IAAA;gBAAA;kBAAA,OAAAyF,SAAA,CAAAxE,MAAA,WACZ,EAAE;gBAAA;gBAAA;kBAAA,OAAAwE,SAAA,CAAAtE,IAAA;cAAA;YAAA;YAAA,OAAAqE,SAAA;UAAA,uBAAApE,OAAA;QAAA;QACT,OAAAmE,QAAA;MAAA;MACDnD,QAAQ,EAAE,SAAAA,CAACC,IAAI;QAAA,YAAQA,IAAI,CAACjE,GAAG,CAACgH,SAAS,CAAC,CAAC,CAAC;MAAA,CAAE;MAC9C9C,UAAU,EAAE,SAAAA,CAAAoD,KAAA;QAAA,IAAGrD,IAAI,GAAAqD,KAAA,CAAJrD,IAAI;QAAA,oBAAOrF,KAAA,CAAAwF,aAAA,CAAC/E,qBAAqB,EAAK4E,IAAK,CAAG;MAAA;KAC7D,CAAC,EACHvE,2BAA2B,CAA6B;MACvDuB,KAAK,EAAEN,CAAC,CAAC,OAAO,CAAC;MACjBK,OAAO,EAAE,MAAM;MACfuG,MAAM,EAAE,GAAG;MACXC,MAAM,EAAE,GAAG;MACXC,eAAe,EAAE,KAAK;MACtBvG,iBAAiB;QAAE,SAAAwG,SAAOtG,MAAc;UAAA,IAAAmE,cAAA,EAAAC,UAAA,EAAAC,QAAA,EAAAC,SAAA,EAAArE,WAAA,EAAAsE,GAAA,EAAAC,OAAA,EAAAC,UAAA;UAAA,OAAAhI,mBAAA,CAAA2D,KAAA;YAAA,SAAAmG,UAAAC,SAAA;cAAA,kBAAAA,SAAA,CAAAjG,IAAA,GAAAiG,SAAA,CAAAhG,IAAA;gBAAA;kBACjC2D,cAAc,GAAG,IAAI1D,MAAM,CAAC,eAAe,CAAC;kBAC5C2D,UAAU,GAAG,IAAI3D,MAAM,CAAC,cAAc,CAAC;kBACvC4D,QAAQ,GAAG,IAAI5D,MAAM,CAAC,4CAA4C,CAAC;kBAEnE6D,SAAS,GAAG,SAAAA,CAACE,OAAiB;oBAAA,OAAK,UAACI,CAAkB,EAAEC,CAAkB,EAAI;sBACnF,IAAI4B,GAAG,GAAG7B,CAAC,CAAChG,GAAG;sBACf,IAAI8H,GAAG,GAAG9B,CAAC,CAAChG,GAAG;sBAEf,IAAI4F,OAAO,CAACa,QAAQ,CAACT,CAAC,CAAChG,GAAG,CAAC,EAAE;wBAC5B6H,GAAG,GAAGjC,OAAO,CAACc,OAAO,CAACV,CAAC,CAAChG,GAAG,CAAC,GAAG6H,GAAG;sBACnC;sBACA,IAAIjC,OAAO,CAACa,QAAQ,CAACR,CAAC,CAACjG,GAAG,CAAC,EAAE;wBAC5B8H,GAAG,GAAGlC,OAAO,CAACc,OAAO,CAACT,CAAC,CAACjG,GAAG,CAAC,GAAG8H,GAAG;sBACnC;sBAEA,IAAID,GAAG,GAAGC,GAAG,EAAE;wBACd,OAAO,CAAC,CAAC;sBACV;sBAEA,IAAID,GAAG,GAAGC,GAAG,EAAE;wBACd,OAAO,CAAC;sBACT;sBAEA,OAAO,CAAC;oBACT,CAAC;kBAAA;kBACKzG,WAAW,GAAG,IAAIQ,MAAM,CAACtD,YAAY,CAAC6C,MAAM,CAAC,EAAE,GAAG,CAAC;kBACnDuE,GAAG,SAAOvE,MAAM;kBAEhBwE,OAAO,GAAGpF,YAAY,CAAC+B,GAAG,CAAC,UAAC0B,IAAI;oBAAA,aAASA,IAAI;kBAAA,CAAG,CAAC;kBAEjD4B,UAAU,GAAG7G,KAAK,CAAC2H,IAAI;kBAAA,OAAAiB,SAAA,CAAA/E,MAAA,WAEtB+D,MAAM,CAACC,IAAI,CAAChB,UAAU,CAAC,CAC5BtD,GAAG,CAAC,UAACvC,GAAG,EAAI;oBACZ,IAAM8G,IAAI,GAAGjB,UAAU,CAACF,GAAG,CAAC;oBAC5B,OAAO;sBAAE3F,GAAG,EAAHA,GAAG;sBAAE8G,IAAI,EAAJA;oBAAI,CAAE;kBACrB,CAAC,CAAC,CACD1F,MAAM,CACN,UAAA2G,KAAA;oBAAA,IAAG/H,GAAG,GAAA+H,KAAA,CAAH/H,GAAG;oBAAA,OACLqB,WAAW,CAACqB,IAAI,CAAC1C,GAAG,CAAC,KAAKuF,cAAc,CAAC7C,IAAI,CAAC1C,GAAG,CAACgH,SAAS,CAACrB,GAAG,CAACsB,MAAM,CAAC,CAAC,IAAIxB,QAAQ,CAAC/C,IAAI,CAACiD,GAAG,CAAC,IAAI,CAACH,UAAU,CAAC9C,IAAI,CAAC1C,GAAG,CAAC,CAAC;kBAAA,EACzH,CACAqC,IAAI,CAACqD,SAAS,CAACE,OAAO,CAAC,CAAC,CACxBsB,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC;gBAAA;gBAAA;kBAAA,OAAAU,SAAA,CAAA7E,IAAA;cAAA;YAAA;YAAA,OAAA4E,SAAA;UAAA,uBAAA3E,OAAA;QAAA;QACd,OAAA0E,QAAA;MAAA;MACDzE,kBAAkB;QAAE,SAAA+E,SAAA;UAAA,OAAAnK,mBAAA,CAAA2D,KAAA;YAAA,SAAAyG,UAAAC,SAAA;cAAA,kBAAAA,SAAA,CAAAvG,IAAA,GAAAuG,SAAA,CAAAtG,IAAA;gBAAA;kBAAA,OAAAsG,SAAA,CAAArF,MAAA,WACZ,EAAE;gBAAA;gBAAA;kBAAA,OAAAqF,SAAA,CAAAnF,IAAA;cAAA;YAAA;YAAA,OAAAkF,SAAA;UAAA,uBAAAjF,OAAA;QAAA;QACT,OAAAgF,QAAA;MAAA;MACDhE,QAAQ,EAAE,SAAAA,CAACC,IAAI;QAAA,YAAQA,IAAI,CAACjE,GAAG;MAAA,CAAE;MACjCkE,UAAU,EAAE,SAAAA,CAAAiE,KAAA;QAAA,IAAGlE,IAAI,GAAAkE,KAAA,CAAJlE,IAAI;QAAA,oBAAOrF,KAAA,CAAAwF,aAAA,CAAC/E,qBAAqB,EAAK4E,IAAK,CAAG;MAAA;KAC7D,CAAC,EAEFvE,2BAA2B,CAAoC;MAC9DuB,KAAK,EAAEN,CAAC,CAAC,UAAU,CAAC;MACpBK,OAAO,EAAE,GAAG;MACZwG,MAAM,EAAE,GAAG;MACXC,eAAe,EAAE,KAAK;MACtBW,QAAQ,EAAElI,SAAS;MACnBgE,UAAU,EAAE,SAAAA,CAAAmE,KAAA;QAAA,IAAGpE,IAAI,GAAAoE,KAAA,CAAJpE,IAAI;QAAA,oBAAOrF,KAAA,CAAAwF,aAAA,CAAC7E,4BAA4B,EAAK0E,IAAK,CAAG;MAAA;MACpE/C,iBAAiB;QAAE,SAAAoH,SAAOlH,MAAc;UAAA,OAAAvD,mBAAA,CAAA2D,KAAA;YAAA,SAAA+G,UAAAC,SAAA;cAAA,kBAAAA,SAAA,CAAA7G,IAAA,GAAA6G,SAAA,CAAA5G,IAAA;gBAAA;kBAAA,OAAA4G,SAAA,CAAA3F,MAAA,WAChC+D,MAAM,CAACC,IAAI,CAAC1H,aAAa,CAACsJ,QAAQ,CAAC,CACxClG,GAAG,CAAC,UAACmG,OAAO,EAAI;oBAAA,IAAAC,YAAA;oBAChB,IAAM1E,IAAI,GAAG9E,aAAa,CAACsJ,QAAQ,CAACC,OAAO,CAAC;oBAC5C,OAAAvK,aAAA;sBACC6B,GAAG,EAAE0I,OAAO;sBACZE,MAAM,EAAE3E,IAAI,CAAC2E,MAAM,IAAIjI,CAAC,CAACkI,GAAG,CAAC5E,IAAI,CAAC2E,MAAM,CAAC,GAAGjI,CAAC,CAACsD,IAAI,CAAC2E,MAAM,CAAC,IAAAD,YAAA,GAAG1E,IAAI,CAAC2E,MAAM,cAAAD,YAAA,cAAAA,YAAA,GAAI,EAAE;sBAC9EG,WAAW,EAAE7E,IAAI,CAAC6E,WAAW,IAAInI,CAAC,CAACkI,GAAG,CAAC5E,IAAI,CAAC6E,WAAW,CAAC,GAAGnI,CAAC,CAACsD,IAAI,CAAC6E,WAAW,CAAC,GAAG7E,IAAI,CAAC6E,WAAW;sBACjGC,UAAU,EAAE9E,IAAI,CAAC8E;oBAAU,GACvB7I,SAAS,IAAI;sBAAEkI,QAAQ,EAAElI;oBAAS,CAAE;kBAE1C,CAAC,CAAC,CACDkB,MAAM,CAAC,UAACsH,OAAO,EAAI;oBACnB,IAAMM,OAAO,GAAGN,OAAO,CAAC1I,GAAG,CAAC0G,OAAO,CAACtF,MAAM,CAAC,GAAG,CAAC,CAAC;oBAEhD,IAAI,CAAC4H,OAAO,EAAE;sBACb,OAAO,KAAK;oBACb;oBAEA,IAAI,CAACN,OAAO,CAACK,UAAU,EAAE;sBACxB,OAAO,IAAI;oBACZ;oBAEA,OAAOjK,uBAAuB,CAAC4J,OAAO,CAACK,UAAU,EAAEhJ,GAAG,CAAC;kBACxD,CAAC,CAAC,CACDsC,IAAI,CAAC,UAAC2D,CAAC,EAAEC,CAAC;oBAAA,OAAKD,CAAC,CAAChG,GAAG,CAACiJ,aAAa,CAAChD,CAAC,CAACjG,GAAG,CAAC;kBAAA,EAAC,CAC1CkH,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC;gBAAA;gBAAA;kBAAA,OAAAsB,SAAA,CAAAzF,IAAA;cAAA;YAAA;YAAA,OAAAwF,SAAA;UAAA,uBAAAvF,OAAA;QAAA;QACd,OAAAsF,QAAA;MAAA;MACDrF,kBAAkB;QAAE,SAAAiG,UAAA;UAAA,OAAArL,mBAAA,CAAA2D,KAAA;YAAA,SAAA2H,WAAAC,UAAA;cAAA,kBAAAA,UAAA,CAAAzH,IAAA,GAAAyH,UAAA,CAAAxH,IAAA;gBAAA;kBAAA,OAAAwH,UAAA,CAAAvG,MAAA,WAAY,EAAE;gBAAA;gBAAA;kBAAA,OAAAuG,UAAA,CAAArG,IAAA;cAAA;YAAA;YAAA,OAAAoG,UAAA;UAAA,uBAAAnG,OAAA;QAAA;QAAA,OAAAkG,SAAA;MAAA;KAClC,CAAC,EACF7I,qBAAqB,IACpBI,aAAa,IACbf,2BAA2B,CAIxB;MACFuB,KAAK,EAAEN,CAAC,CAAC,kBAAkB,CAAC;MAC5BK,OAAO,EAAE,GAAG;MACZuG,MAAM,EAAE,EAAE;MACVE,eAAe,EAAE,IAAI;MACrBvD,UAAU,EAAE,SAAAA,CAAAmF,MAAA;QAAA,IAAGpF,IAAI,GAAAoF,MAAA,CAAJpF,IAAI;QAAA,oBAAOrF,KAAA,CAAAwF,aAAA,CAAChF,8BAA8B,EAAK6E,IAAK,CAAG;MAAA;MACtE/C,iBAAiB;QAAE,SAAAoI,UAAOlI,MAAc;UAAA,IAAAmI,GAAA;UAAA,OAAA1L,mBAAA,CAAA2D,KAAA;YAAA,SAAAgI,WAAAC,UAAA;cAAA,kBAAAA,UAAA,CAAA9H,IAAA,GAAA8H,UAAA,CAAA7H,IAAA;gBAAA;kBACjC2H,GAAG,GAAG,IAAI1H,MAAM,CAACT,MAAM,EAAE,GAAG,CAAC;kBAAA,OAAAqI,UAAA,CAAA5G,MAAA,WAC5B9D,cAAc,CAAC+C,IAAI,CACzB;oBACC4H,QAAQ,EAAEH;mBACV,EACD;oBACCnH,KAAK,EAAE,EAAE;oBACTC,IAAI,EAAE;sBACLqH,QAAQ,EAAE,CAAC;;mBAEZ,CACD,CACCpH,KAAK,EAAE,CACPC,GAAG,CAAC,UAACoH,MAAM;oBAAA,OAAM;sBACjB3J,GAAG,EAAE2J,MAAM,CAAC3J,GAAG;sBACf4J,IAAI,EAAED,MAAM,CAACC,IAAI;sBACjBF,QAAQ,EAAEC,MAAM,CAACD;qBACjB;kBAAA,CAAC,CAAC;gBAAA;gBAAA;kBAAA,OAAAD,UAAA,CAAA1G,IAAA;cAAA;YAAA;YAAA,OAAAyG,UAAA;UAAA,uBAAAxG,OAAA;QAAA;QACJ,OAAAsG,SAAA;MAAA;MACDrG,kBAAkB;QAAE,SAAA4G,UAAA;UAAA,OAAAhM,mBAAA,CAAA2D,KAAA;YAAA,SAAAsI,WAAAC,UAAA;cAAA,kBAAAA,UAAA,CAAApI,IAAA,GAAAoI,UAAA,CAAAnI,IAAA;gBAAA;kBAAA,OAAAmI,UAAA,CAAAlH,MAAA,WAAY,EAAE;gBAAA;gBAAA;kBAAA,OAAAkH,UAAA,CAAAhH,IAAA;cAAA;YAAA;YAAA,OAAA+G,UAAA;UAAA,uBAAA9G,OAAA;QAAA;QAAA,OAAA6G,SAAA;MAAA;MAClC7F,QAAQ,EAAE,SAAAA,CAACC,IAAI,EAAI;QAClB,OAAOA,IAAI,CAAC2F,IAAI;MACjB;KACA,CAAC,EACHlK,2BAA2B,CAAC;MAC3BsK,kBAAkB,EAAE,0BAA0B;MAC9CC,OAAO,EAAE,IAAI;MACb/I,iBAAiB;QAAE,SAAAgJ,UAAAC,MAAA;UAAA,IAAAC,iBAAA;UAAA,IAAAC,GAAA,EAAAzB,MAAA,EAAA0B,IAAA,EAAAC,MAAA;UAAA,OAAA1M,mBAAA,CAAA2D,KAAA;YAAA,SAAAgJ,WAAAC,UAAA;cAAA,kBAAAA,UAAA,CAAA9I,IAAA,GAAA8I,UAAA,CAAA7I,IAAA;gBAAA;kBAASyI,GAAG,GAAAF,MAAA,CAAHE,GAAG,EAAEzB,MAAM,GAAAuB,MAAA,CAANvB,MAAM,EAAE0B,IAAI,GAAAH,MAAA,CAAJG,IAAI;kBAAAG,UAAA,CAAA7I,IAAA;kBAAA,OAAA/D,mBAAA,CAAA2F,KAAA,CACvB1C,IAAI,CAAC;oBAAEuJ,GAAG,EAAHA,GAAG;oBAAEzB,MAAM,EAANA,MAAM;oBAAE8B,GAAG,EAAE;sBAAE3K,GAAG,EAAHA,GAAG;sBAAEuK,IAAI,EAAJA;oBAAI;kBAAE,CAAE,CAAC;gBAAA;kBAAxDC,MAAM,GAAAE,UAAA,CAAA/G,IAAA;kBAAA,OAAA+G,UAAA,CAAA5H,MAAA,YAAAuH,iBAAA,GAEXG,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAEjJ,KAAK,CAACiB,GAAG,CAAC,UAAC0B,IAAI;oBAAA,OAAM;sBAC5BjE,GAAG,EAAEiE,IAAI,CAAC0G,EAAE;sBACZ5J,KAAK,EAAEkD,IAAI,CAAClD,KAAK;sBACjB6J,IAAI,EAAE3G,IAAI,CAAC2G;qBACX;kBAAA,CAAC,CAAC,cAAAR,iBAAA,cAAAA,iBAAA,GAAI,EAAE;gBAAA;gBAAA;kBAAA,OAAAK,UAAA,CAAA1H,IAAA;cAAA;YAAA;YAAA,OAAAyH,UAAA;UAAA,uBAAAxH,OAAA;QAAA;QAEV,OAAAkH,SAAA;MAAA;KACD,CAAC,CACF,CAAC9I,MAAM,CAACyJ,OAAO,CAAC;EAClB,CAAC,EAAE,CAAClK,CAAC,EAAEN,qBAAqB,EAAEI,aAAa,EAAED,YAAY,EAAEJ,gBAAgB,EAAED,aAAa,EAAEJ,GAAG,EAAEe,IAAI,EAAEJ,QAAQ,EAAER,SAAS,CAAC,CAAC;EAE5H,oBAAOtB,KAAA,CAAAwF,aAAA,CAAC3E,oBAAoB,CAACqL,QAAQ;IAAC/J,KAAK,EAAEA,KAAM;IAAClB,QAAQ,EAAEA;EAAS,EAAG;AAC3E,CAAC;AAjXD/B,MAAA,CAAOiN,aAAE,CAmXMpL,qBAnXN","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"8b2d38b3848ea57dbd3d3d0a44ec2c95789411a8"}
