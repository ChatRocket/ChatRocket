{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/lib/rooms/roomCoordinator.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/lib/rooms/roomCoordinator.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/lib/rooms/roomCoordinator.tsx","inputSourceMap":{"version":3,"file":"client/lib/rooms/roomCoordinator.tsx","sourceRoot":"","sources":["client/lib/rooms/roomCoordinator.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IRoom, RoomType, IUser, AtLeast, ValueOf, ISubscription } from '@rocket.chat/core-typings';\nimport { isRoomFederated } from '@rocket.chat/core-typings';\nimport type { RouteName } from '@rocket.chat/ui-contexts';\nimport { Meteor } from 'meteor/meteor';\nimport React from 'react';\n\nimport { hasPermission } from '../../../app/authorization/client';\nimport { ChatRoom, ChatSubscription } from '../../../app/models/client';\nimport { settings } from '../../../app/settings/client';\nimport type {\n\tRoomSettingsEnum,\n\tRoomMemberActions,\n\tUiTextContext,\n\tIRoomTypeClientDirectives,\n\tRoomIdentification,\n\tIRoomTypeRouteConfig,\n\tIRoomTypeClientConfig,\n} from '../../../definition/IRoomTypeConfig';\nimport { RoomCoordinator } from '../../../lib/rooms/coordinator';\nimport { router } from '../../providers/RouterProvider';\nimport RoomRoute from '../../views/room/RoomRoute';\nimport MainLayout from '../../views/root/MainLayout';\nimport { appLayout } from '../appLayout';\n\nclass RoomCoordinatorClient extends RoomCoordinator {\n\tpublic add(roomConfig: IRoomTypeClientConfig, directives: Partial<IRoomTypeClientDirectives>): void {\n\t\tthis.addRoomType(roomConfig, {\n\t\t\tallowRoomSettingChange(_room: Partial<IRoom>, _setting: ValueOf<typeof RoomSettingsEnum>): boolean {\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tallowMemberAction(\n\t\t\t\t_room: Partial<IRoom>,\n\t\t\t\t_action: ValueOf<typeof RoomMemberActions>,\n\t\t\t\t_showingUserId: IUser['_id'],\n\t\t\t\t_userSubscription?: ISubscription,\n\t\t\t): boolean {\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\troomName(_room: AtLeast<IRoom, '_id' | 'name' | 'fname' | 'prid'>): string {\n\t\t\t\treturn '';\n\t\t\t},\n\t\t\tisGroupChat(_room: Partial<IRoom>): boolean {\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tgetUiText(_context: ValueOf<typeof UiTextContext>): string {\n\t\t\t\treturn '';\n\t\t\t},\n\t\t\tcondition(): boolean {\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tgetAvatarPath(_room): string {\n\t\t\t\treturn '';\n\t\t\t},\n\t\t\tfindRoom(_identifier: string): IRoom | undefined {\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t\tshowJoinLink(_roomId: string): boolean {\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tisLivechatRoom(): boolean {\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tcanSendMessage(rid: string): boolean {\n\t\t\t\treturn ChatSubscription.find({ rid }).count() > 0;\n\t\t\t},\n\t\t\t...directives,\n\t\t\tconfig: roomConfig,\n\t\t});\n\t}\n\n\tpublic getRoomDirectives(roomType: string): IRoomTypeClientDirectives {\n\t\treturn this.roomTypes[roomType].directives as IRoomTypeClientDirectives;\n\t}\n\n\tpublic openRouteLink(\n\t\troomType: RoomType,\n\t\tsubData: RoomIdentification,\n\t\tqueryParams?: Record<string, string>,\n\t\toptions: { replace?: boolean } = {},\n\t): void {\n\t\tconst config = this.getRoomTypeConfig(roomType);\n\t\tif (!config?.route) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet routeData = {};\n\t\tif (config.route.link) {\n\t\t\trouteData = config.route.link(subData);\n\t\t} else if (subData?.name) {\n\t\t\trouteData = {\n\t\t\t\tname: subData.name,\n\t\t\t};\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\trouter.navigate(\n\t\t\t{\n\t\t\t\tpattern: config.route.path ?? '/home',\n\t\t\t\tparams: routeData,\n\t\t\t\tsearch: queryParams,\n\t\t\t},\n\t\t\toptions,\n\t\t);\n\t}\n\n\tpublic isLivechatRoom(roomType: string): boolean {\n\t\treturn Boolean(this.getRoomDirectives(roomType).isLivechatRoom());\n\t}\n\n\tpublic getRoomName(roomType: string, roomData: AtLeast<IRoom, '_id' | 'name' | 'fname' | 'prid'>): string {\n\t\treturn this.getRoomDirectives(roomType).roomName(roomData) ?? '';\n\t}\n\n\tpublic readOnly(rid: string, user: AtLeast<IUser, 'username'>): boolean {\n\t\tconst fields = {\n\t\t\tro: 1,\n\t\t\tt: 1,\n\t\t\t...(user && { muted: 1, unmuted: 1 }),\n\t\t};\n\t\tconst room = ChatRoom.findOne({ _id: rid }, { fields });\n\t\tif (!room) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst directives = this.getRoomDirectives(room.t);\n\t\tif (directives?.readOnly) {\n\t\t\treturn directives.readOnly(rid, user);\n\t\t}\n\n\t\tif (!user?.username) {\n\t\t\treturn Boolean(room.ro);\n\t\t}\n\n\t\tif (!room) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (Array.isArray(room.muted) && room.muted.indexOf(user.username) !== -1) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (room.ro) {\n\t\t\tif (Array.isArray(room.unmuted) && room.unmuted.indexOf(user.username) !== -1) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (hasPermission('post-readonly', room._id)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t// #ToDo: Move this out of the RoomCoordinator\n\tpublic archived(rid: string): boolean {\n\t\tconst room = ChatRoom.findOne({ _id: rid }, { fields: { archived: 1 } });\n\t\treturn Boolean(room?.archived);\n\t}\n\n\tpublic verifyCanSendMessage(rid: string): boolean {\n\t\tconst room = ChatRoom.findOne({ _id: rid }, { fields: { t: 1, federated: 1 } });\n\t\tif (!room?.t) {\n\t\t\treturn false;\n\t\t}\n\t\tif (!this.getRoomDirectives(room.t).canSendMessage(rid)) {\n\t\t\treturn false;\n\t\t}\n\t\tif (isRoomFederated(room)) {\n\t\t\treturn settings.get('Federation_Matrix_enabled');\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate validateRoute<TRouteName extends RouteName>(route: IRoomTypeRouteConfig<TRouteName>): void {\n\t\tconst { name, path, link } = route;\n\n\t\tif (typeof name !== 'string' || name.length === 0) {\n\t\t\tthrow new Error('The route name must be a string.');\n\t\t}\n\n\t\tif (path !== undefined && (typeof path !== 'string' || path.length === 0)) {\n\t\t\tthrow new Error('The route path must be a string.');\n\t\t}\n\n\t\tif (!['undefined', 'function'].includes(typeof link)) {\n\t\t\tthrow new Error('The route link must be a function.');\n\t\t}\n\t}\n\n\tprotected validateRoomConfig(roomConfig: IRoomTypeClientConfig): void {\n\t\tsuper.validateRoomConfig(roomConfig);\n\n\t\tconst { route, label } = roomConfig;\n\n\t\tif (route !== undefined) {\n\t\t\tthis.validateRoute(route);\n\t\t}\n\n\t\tif (label !== undefined && (typeof label !== 'string' || label.length === 0)) {\n\t\t\tthrow new Error('The label must be a string.');\n\t\t}\n\t}\n\n\tprotected addRoomType(roomConfig: IRoomTypeClientConfig, directives: IRoomTypeClientDirectives): void {\n\t\tsuper.addRoomType(roomConfig, directives);\n\n\t\tif (roomConfig.route?.path && roomConfig.route.name && directives.extractOpenRoomParams) {\n\t\t\tconst {\n\t\t\t\troute: { name, path },\n\t\t\t} = roomConfig;\n\t\t\tconst { extractOpenRoomParams } = directives;\n\t\t\trouter.defineRoutes([\n\t\t\t\t{\n\t\t\t\t\tpath,\n\t\t\t\t\tid: name,\n\t\t\t\t\telement: appLayout.wrap(\n\t\t\t\t\t\t<MainLayout>\n\t\t\t\t\t\t\t<RoomRoute extractOpenRoomParams={extractOpenRoomParams} />\n\t\t\t\t\t\t</MainLayout>,\n\t\t\t\t\t),\n\t\t\t\t},\n\t\t\t]);\n\t\t}\n\t}\n\n\tpublic getURL(roomType: string, subData: RoomIdentification): string | false {\n\t\tconst config = this.getRoomTypeConfig(roomType);\n\t\tif (!config?.route) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst routeData = this.getRouteData(roomType, subData);\n\t\tif (!routeData) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn Meteor.absoluteUrl(\n\t\t\trouter.buildRoutePath({\n\t\t\t\tname: config.route.name,\n\t\t\t\tparams: routeData,\n\t\t\t}),\n\t\t);\n\t}\n\n\tpublic isRouteNameKnown(routeName: string): boolean {\n\t\treturn Boolean(this.getRouteNameIdentifier(routeName));\n\t}\n\n\tpublic getRouteNameIdentifier(routeName: string): string | undefined {\n\t\tif (!routeName) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn Object.keys(this.roomTypes).find((key) => this.roomTypes[key].config.route?.name === routeName);\n\t}\n}\n\nexport const roomCoordinator = new RoomCoordinatorClient();\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/lib/rooms/roomCoordinator.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/lib/rooms/roomCoordinator.tsx","inputSourceMap":{"version":3,"file":"client/lib/rooms/roomCoordinator.tsx","sourceRoot":"","sources":["client/lib/rooms/roomCoordinator.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IRoom, RoomType, IUser, AtLeast, ValueOf, ISubscription } from '@rocket.chat/core-typings';\nimport { isRoomFederated } from '@rocket.chat/core-typings';\nimport type { RouteName } from '@rocket.chat/ui-contexts';\nimport { Meteor } from 'meteor/meteor';\nimport React from 'react';\n\nimport { hasPermission } from '../../../app/authorization/client';\nimport { ChatRoom, ChatSubscription } from '../../../app/models/client';\nimport { settings } from '../../../app/settings/client';\nimport type {\n\tRoomSettingsEnum,\n\tRoomMemberActions,\n\tUiTextContext,\n\tIRoomTypeClientDirectives,\n\tRoomIdentification,\n\tIRoomTypeRouteConfig,\n\tIRoomTypeClientConfig,\n} from '../../../definition/IRoomTypeConfig';\nimport { RoomCoordinator } from '../../../lib/rooms/coordinator';\nimport { router } from '../../providers/RouterProvider';\nimport RoomRoute from '../../views/room/RoomRoute';\nimport MainLayout from '../../views/root/MainLayout';\nimport { appLayout } from '../appLayout';\n\nclass RoomCoordinatorClient extends RoomCoordinator {\n\tpublic add(roomConfig: IRoomTypeClientConfig, directives: Partial<IRoomTypeClientDirectives>): void {\n\t\tthis.addRoomType(roomConfig, {\n\t\t\tallowRoomSettingChange(_room: Partial<IRoom>, _setting: ValueOf<typeof RoomSettingsEnum>): boolean {\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tallowMemberAction(\n\t\t\t\t_room: Partial<IRoom>,\n\t\t\t\t_action: ValueOf<typeof RoomMemberActions>,\n\t\t\t\t_showingUserId: IUser['_id'],\n\t\t\t\t_userSubscription?: ISubscription,\n\t\t\t): boolean {\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\troomName(_room: AtLeast<IRoom, '_id' | 'name' | 'fname' | 'prid'>): string {\n\t\t\t\treturn '';\n\t\t\t},\n\t\t\tisGroupChat(_room: Partial<IRoom>): boolean {\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tgetUiText(_context: ValueOf<typeof UiTextContext>): string {\n\t\t\t\treturn '';\n\t\t\t},\n\t\t\tcondition(): boolean {\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tgetAvatarPath(_room): string {\n\t\t\t\treturn '';\n\t\t\t},\n\t\t\tfindRoom(_identifier: string): IRoom | undefined {\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t\tshowJoinLink(_roomId: string): boolean {\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tisLivechatRoom(): boolean {\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tcanSendMessage(rid: string): boolean {\n\t\t\t\treturn ChatSubscription.find({ rid }).count() > 0;\n\t\t\t},\n\t\t\t...directives,\n\t\t\tconfig: roomConfig,\n\t\t});\n\t}\n\n\tpublic getRoomDirectives(roomType: string): IRoomTypeClientDirectives {\n\t\treturn this.roomTypes[roomType].directives as IRoomTypeClientDirectives;\n\t}\n\n\tpublic openRouteLink(\n\t\troomType: RoomType,\n\t\tsubData: RoomIdentification,\n\t\tqueryParams?: Record<string, string>,\n\t\toptions: { replace?: boolean } = {},\n\t): void {\n\t\tconst config = this.getRoomTypeConfig(roomType);\n\t\tif (!config?.route) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet routeData = {};\n\t\tif (config.route.link) {\n\t\t\trouteData = config.route.link(subData);\n\t\t} else if (subData?.name) {\n\t\t\trouteData = {\n\t\t\t\tname: subData.name,\n\t\t\t};\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\trouter.navigate(\n\t\t\t{\n\t\t\t\tpattern: config.route.path ?? '/home',\n\t\t\t\tparams: routeData,\n\t\t\t\tsearch: queryParams,\n\t\t\t},\n\t\t\toptions,\n\t\t);\n\t}\n\n\tpublic isLivechatRoom(roomType: string): boolean {\n\t\treturn Boolean(this.getRoomDirectives(roomType).isLivechatRoom());\n\t}\n\n\tpublic getRoomName(roomType: string, roomData: AtLeast<IRoom, '_id' | 'name' | 'fname' | 'prid'>): string {\n\t\treturn this.getRoomDirectives(roomType).roomName(roomData) ?? '';\n\t}\n\n\tpublic readOnly(rid: string, user: AtLeast<IUser, 'username'>): boolean {\n\t\tconst fields = {\n\t\t\tro: 1,\n\t\t\tt: 1,\n\t\t\t...(user && { muted: 1, unmuted: 1 }),\n\t\t};\n\t\tconst room = ChatRoom.findOne({ _id: rid }, { fields });\n\t\tif (!room) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst directives = this.getRoomDirectives(room.t);\n\t\tif (directives?.readOnly) {\n\t\t\treturn directives.readOnly(rid, user);\n\t\t}\n\n\t\tif (!user?.username) {\n\t\t\treturn Boolean(room.ro);\n\t\t}\n\n\t\tif (!room) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (Array.isArray(room.muted) && room.muted.indexOf(user.username) !== -1) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (room.ro) {\n\t\t\tif (Array.isArray(room.unmuted) && room.unmuted.indexOf(user.username) !== -1) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (hasPermission('post-readonly', room._id)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t// #ToDo: Move this out of the RoomCoordinator\n\tpublic archived(rid: string): boolean {\n\t\tconst room = ChatRoom.findOne({ _id: rid }, { fields: { archived: 1 } });\n\t\treturn Boolean(room?.archived);\n\t}\n\n\tpublic verifyCanSendMessage(rid: string): boolean {\n\t\tconst room = ChatRoom.findOne({ _id: rid }, { fields: { t: 1, federated: 1 } });\n\t\tif (!room?.t) {\n\t\t\treturn false;\n\t\t}\n\t\tif (!this.getRoomDirectives(room.t).canSendMessage(rid)) {\n\t\t\treturn false;\n\t\t}\n\t\tif (isRoomFederated(room)) {\n\t\t\treturn settings.get('Federation_Matrix_enabled');\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate validateRoute<TRouteName extends RouteName>(route: IRoomTypeRouteConfig<TRouteName>): void {\n\t\tconst { name, path, link } = route;\n\n\t\tif (typeof name !== 'string' || name.length === 0) {\n\t\t\tthrow new Error('The route name must be a string.');\n\t\t}\n\n\t\tif (path !== undefined && (typeof path !== 'string' || path.length === 0)) {\n\t\t\tthrow new Error('The route path must be a string.');\n\t\t}\n\n\t\tif (!['undefined', 'function'].includes(typeof link)) {\n\t\t\tthrow new Error('The route link must be a function.');\n\t\t}\n\t}\n\n\tprotected validateRoomConfig(roomConfig: IRoomTypeClientConfig): void {\n\t\tsuper.validateRoomConfig(roomConfig);\n\n\t\tconst { route, label } = roomConfig;\n\n\t\tif (route !== undefined) {\n\t\t\tthis.validateRoute(route);\n\t\t}\n\n\t\tif (label !== undefined && (typeof label !== 'string' || label.length === 0)) {\n\t\t\tthrow new Error('The label must be a string.');\n\t\t}\n\t}\n\n\tprotected addRoomType(roomConfig: IRoomTypeClientConfig, directives: IRoomTypeClientDirectives): void {\n\t\tsuper.addRoomType(roomConfig, directives);\n\n\t\tif (roomConfig.route?.path && roomConfig.route.name && directives.extractOpenRoomParams) {\n\t\t\tconst {\n\t\t\t\troute: { name, path },\n\t\t\t} = roomConfig;\n\t\t\tconst { extractOpenRoomParams } = directives;\n\t\t\trouter.defineRoutes([\n\t\t\t\t{\n\t\t\t\t\tpath,\n\t\t\t\t\tid: name,\n\t\t\t\t\telement: appLayout.wrap(\n\t\t\t\t\t\t<MainLayout>\n\t\t\t\t\t\t\t<RoomRoute extractOpenRoomParams={extractOpenRoomParams} />\n\t\t\t\t\t\t</MainLayout>,\n\t\t\t\t\t),\n\t\t\t\t},\n\t\t\t]);\n\t\t}\n\t}\n\n\tpublic getURL(roomType: string, subData: RoomIdentification): string | false {\n\t\tconst config = this.getRoomTypeConfig(roomType);\n\t\tif (!config?.route) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst routeData = this.getRouteData(roomType, subData);\n\t\tif (!routeData) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn Meteor.absoluteUrl(\n\t\t\trouter.buildRoutePath({\n\t\t\t\tname: config.route.name,\n\t\t\t\tparams: routeData,\n\t\t\t}),\n\t\t);\n\t}\n\n\tpublic isRouteNameKnown(routeName: string): boolean {\n\t\treturn Boolean(this.getRouteNameIdentifier(routeName));\n\t}\n\n\tpublic getRouteNameIdentifier(routeName: string): string | undefined {\n\t\tif (!routeName) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn Object.keys(this.roomTypes).find((key) => this.roomTypes[key].config.route?.name === routeName);\n\t}\n}\n\nexport const roomCoordinator = new RoomCoordinatorClient();\n"]}}},"code":"var _typeof;\nmodule.link(\"@babel/runtime/helpers/typeof\", {\n  default: function (v) {\n    _typeof = v;\n  }\n}, 0);\nvar _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default: function (v) {\n    _objectSpread = v;\n  }\n}, 1);\nvar _inheritsLoose;\nmodule.link(\"@babel/runtime/helpers/inheritsLoose\", {\n  default: function (v) {\n    _inheritsLoose = v;\n  }\n}, 2);\nmodule.export({\n  roomCoordinator: function () {\n    return roomCoordinator;\n  }\n});\nvar isRoomFederated;\nmodule.link(\"@rocket.chat/core-typings\", {\n  isRoomFederated: function (v) {\n    isRoomFederated = v;\n  }\n}, 0);\nvar Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 1);\nvar React;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  }\n}, 2);\nvar hasPermission;\nmodule.link(\"../../../app/authorization/client\", {\n  hasPermission: function (v) {\n    hasPermission = v;\n  }\n}, 3);\nvar ChatRoom, ChatSubscription;\nmodule.link(\"../../../app/models/client\", {\n  ChatRoom: function (v) {\n    ChatRoom = v;\n  },\n  ChatSubscription: function (v) {\n    ChatSubscription = v;\n  }\n}, 4);\nvar settings;\nmodule.link(\"../../../app/settings/client\", {\n  settings: function (v) {\n    settings = v;\n  }\n}, 5);\nvar RoomCoordinator;\nmodule.link(\"../../../lib/rooms/coordinator\", {\n  RoomCoordinator: function (v) {\n    RoomCoordinator = v;\n  }\n}, 6);\nvar router;\nmodule.link(\"../../providers/RouterProvider\", {\n  router: function (v) {\n    router = v;\n  }\n}, 7);\nvar RoomRoute;\nmodule.link(\"../../views/room/RoomRoute\", {\n  \"default\": function (v) {\n    RoomRoute = v;\n  }\n}, 8);\nvar MainLayout;\nmodule.link(\"../../views/root/MainLayout\", {\n  \"default\": function (v) {\n    MainLayout = v;\n  }\n}, 9);\nvar appLayout;\nmodule.link(\"../appLayout\", {\n  appLayout: function (v) {\n    appLayout = v;\n  }\n}, 10);\nvar RoomCoordinatorClient = /*#__PURE__*/function (_RoomCoordinator) {\n  function RoomCoordinatorClient() {\n    return _RoomCoordinator.apply(this, arguments) || this;\n  }\n  _inheritsLoose(RoomCoordinatorClient, _RoomCoordinator);\n  var _proto = RoomCoordinatorClient.prototype;\n  _proto.add = function () {\n    function add(roomConfig, directives) {\n      this.addRoomType(roomConfig, _objectSpread(_objectSpread({\n        allowRoomSettingChange: function (_room, _setting) {\n          return true;\n        },\n        allowMemberAction: function (_room, _action, _showingUserId, _userSubscription) {\n          return false;\n        },\n        roomName: function (_room) {\n          return '';\n        },\n        isGroupChat: function (_room) {\n          return false;\n        },\n        getUiText: function (_context) {\n          return '';\n        },\n        condition: function () {\n          return true;\n        },\n        getAvatarPath: function (_room) {\n          return '';\n        },\n        findRoom: function (_identifier) {\n          return undefined;\n        },\n        showJoinLink: function (_roomId) {\n          return false;\n        },\n        isLivechatRoom: function () {\n          return false;\n        },\n        canSendMessage: function (rid) {\n          return ChatSubscription.find({\n            rid: rid\n          }).count() > 0;\n        }\n      }, directives), {}, {\n        config: roomConfig\n      }));\n    }\n    return add;\n  }();\n  _proto.getRoomDirectives = function () {\n    function getRoomDirectives(roomType) {\n      return this.roomTypes[roomType].directives;\n    }\n    return getRoomDirectives;\n  }();\n  _proto.openRouteLink = function () {\n    function openRouteLink(roomType, subData, queryParams) {\n      var _config$route$path;\n      var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      var config = this.getRoomTypeConfig(roomType);\n      if (!(config !== null && config !== void 0 && config.route)) {\n        return;\n      }\n      var routeData = {};\n      if (config.route.link) {\n        routeData = config.route.link(subData);\n      } else if (subData !== null && subData !== void 0 && subData.name) {\n        routeData = {\n          name: subData.name\n        };\n      } else {\n        return;\n      }\n      router.navigate({\n        pattern: (_config$route$path = config.route.path) !== null && _config$route$path !== void 0 ? _config$route$path : '/home',\n        params: routeData,\n        search: queryParams\n      }, options);\n    }\n    return openRouteLink;\n  }();\n  _proto.isLivechatRoom = function () {\n    function isLivechatRoom(roomType) {\n      return Boolean(this.getRoomDirectives(roomType).isLivechatRoom());\n    }\n    return isLivechatRoom;\n  }();\n  _proto.getRoomName = function () {\n    function getRoomName(roomType, roomData) {\n      var _this$getRoomDirectiv;\n      return (_this$getRoomDirectiv = this.getRoomDirectives(roomType).roomName(roomData)) !== null && _this$getRoomDirectiv !== void 0 ? _this$getRoomDirectiv : '';\n    }\n    return getRoomName;\n  }();\n  _proto.readOnly = function () {\n    function readOnly(rid, user) {\n      var fields = _objectSpread({\n        ro: 1,\n        t: 1\n      }, user && {\n        muted: 1,\n        unmuted: 1\n      });\n      var room = ChatRoom.findOne({\n        _id: rid\n      }, {\n        fields: fields\n      });\n      if (!room) {\n        return false;\n      }\n      var directives = this.getRoomDirectives(room.t);\n      if (directives !== null && directives !== void 0 && directives.readOnly) {\n        return directives.readOnly(rid, user);\n      }\n      if (!(user !== null && user !== void 0 && user.username)) {\n        return Boolean(room.ro);\n      }\n      if (!room) {\n        return false;\n      }\n      if (Array.isArray(room.muted) && room.muted.indexOf(user.username) !== -1) {\n        return true;\n      }\n      if (room.ro) {\n        if (Array.isArray(room.unmuted) && room.unmuted.indexOf(user.username) !== -1) {\n          return false;\n        }\n        if (hasPermission('post-readonly', room._id)) {\n          return false;\n        }\n        return true;\n      }\n      return false;\n    }\n    return readOnly;\n  }() // #ToDo: Move this out of the RoomCoordinator\n  ;\n  _proto.archived = function () {\n    function archived(rid) {\n      var room = ChatRoom.findOne({\n        _id: rid\n      }, {\n        fields: {\n          archived: 1\n        }\n      });\n      return Boolean(room === null || room === void 0 ? void 0 : room.archived);\n    }\n    return archived;\n  }();\n  _proto.verifyCanSendMessage = function () {\n    function verifyCanSendMessage(rid) {\n      var room = ChatRoom.findOne({\n        _id: rid\n      }, {\n        fields: {\n          t: 1,\n          federated: 1\n        }\n      });\n      if (!(room !== null && room !== void 0 && room.t)) {\n        return false;\n      }\n      if (!this.getRoomDirectives(room.t).canSendMessage(rid)) {\n        return false;\n      }\n      if (isRoomFederated(room)) {\n        return settings.get('Federation_Matrix_enabled');\n      }\n      return true;\n    }\n    return verifyCanSendMessage;\n  }();\n  _proto.validateRoute = function () {\n    function validateRoute(route) {\n      var name = route.name,\n        path = route.path,\n        link = route.link;\n      if (typeof name !== 'string' || name.length === 0) {\n        throw new Error('The route name must be a string.');\n      }\n      if (path !== undefined && (typeof path !== 'string' || path.length === 0)) {\n        throw new Error('The route path must be a string.');\n      }\n      if (!['undefined', 'function'].includes(_typeof(link))) {\n        throw new Error('The route link must be a function.');\n      }\n    }\n    return validateRoute;\n  }();\n  _proto.validateRoomConfig = function () {\n    function validateRoomConfig(roomConfig) {\n      _RoomCoordinator.prototype.validateRoomConfig.call(this, roomConfig);\n      var route = roomConfig.route,\n        label = roomConfig.label;\n      if (route !== undefined) {\n        this.validateRoute(route);\n      }\n      if (label !== undefined && (typeof label !== 'string' || label.length === 0)) {\n        throw new Error('The label must be a string.');\n      }\n    }\n    return validateRoomConfig;\n  }();\n  _proto.addRoomType = function () {\n    function addRoomType(roomConfig, directives) {\n      var _roomConfig$route;\n      _RoomCoordinator.prototype.addRoomType.call(this, roomConfig, directives);\n      if ((_roomConfig$route = roomConfig.route) !== null && _roomConfig$route !== void 0 && _roomConfig$route.path && roomConfig.route.name && directives.extractOpenRoomParams) {\n        var _roomConfig$route2 = roomConfig.route,\n          name = _roomConfig$route2.name,\n          path = _roomConfig$route2.path;\n        var extractOpenRoomParams = directives.extractOpenRoomParams;\n        router.defineRoutes([{\n          path: path,\n          id: name,\n          element: appLayout.wrap( /*#__PURE__*/React.createElement(MainLayout, null, /*#__PURE__*/React.createElement(RoomRoute, {\n            extractOpenRoomParams: extractOpenRoomParams\n          })))\n        }]);\n      }\n    }\n    return addRoomType;\n  }();\n  _proto.getURL = function () {\n    function getURL(roomType, subData) {\n      var config = this.getRoomTypeConfig(roomType);\n      if (!(config !== null && config !== void 0 && config.route)) {\n        return false;\n      }\n      var routeData = this.getRouteData(roomType, subData);\n      if (!routeData) {\n        return false;\n      }\n      return Meteor.absoluteUrl(router.buildRoutePath({\n        name: config.route.name,\n        params: routeData\n      }));\n    }\n    return getURL;\n  }();\n  _proto.isRouteNameKnown = function () {\n    function isRouteNameKnown(routeName) {\n      return Boolean(this.getRouteNameIdentifier(routeName));\n    }\n    return isRouteNameKnown;\n  }();\n  _proto.getRouteNameIdentifier = function () {\n    function getRouteNameIdentifier(routeName) {\n      var _this = this;\n      if (!routeName) {\n        return;\n      }\n      return Object.keys(this.roomTypes).find(function (key) {\n        var _this$roomTypes$key$c;\n        return ((_this$roomTypes$key$c = _this.roomTypes[key].config.route) === null || _this$roomTypes$key$c === void 0 ? void 0 : _this$roomTypes$key$c.name) === routeName;\n      });\n    }\n    return getRouteNameIdentifier;\n  }();\n  return RoomCoordinatorClient;\n}(RoomCoordinator);\nvar roomCoordinator = new RoomCoordinatorClient();","map":{"version":3,"names":["_typeof","module","link","default","v","_objectSpread","_inheritsLoose","export","roomCoordinator","isRoomFederated","Meteor","React","hasPermission","ChatRoom","ChatSubscription","settings","RoomCoordinator","router","RoomRoute","MainLayout","appLayout","RoomCoordinatorClient","_RoomCoordinator","apply","arguments","_proto","prototype","add","roomConfig","directives","addRoomType","allowRoomSettingChange","_room","_setting","allowMemberAction","_action","_showingUserId","_userSubscription","roomName","isGroupChat","getUiText","_context","condition","getAvatarPath","findRoom","_identifier","undefined","showJoinLink","_roomId","isLivechatRoom","canSendMessage","rid","find","count","config","getRoomDirectives","roomType","roomTypes","openRouteLink","subData","queryParams","_config$route$path","options","length","getRoomTypeConfig","route","routeData","name","navigate","pattern","path","params","search","Boolean","getRoomName","roomData","_this$getRoomDirectiv","readOnly","user","fields","ro","t","muted","unmuted","room","findOne","_id","username","Array","isArray","indexOf","archived","verifyCanSendMessage","federated","get","validateRoute","Error","includes","validateRoomConfig","call","label","_roomConfig$route","extractOpenRoomParams","_roomConfig$route2","defineRoutes","id","element","wrap","createElement","getURL","getRouteData","absoluteUrl","buildRoutePath","isRouteNameKnown","routeName","getRouteNameIdentifier","_this","Object","keys","key","_this$roomTypes$key$c"],"sources":["client/lib/rooms/roomCoordinator.tsx"],"sourcesContent":["import type { IRoom, RoomType, IUser, AtLeast, ValueOf, ISubscription } from '@rocket.chat/core-typings';\nimport { isRoomFederated } from '@rocket.chat/core-typings';\nimport type { RouteName } from '@rocket.chat/ui-contexts';\nimport { Meteor } from 'meteor/meteor';\nimport React from 'react';\n\nimport { hasPermission } from '../../../app/authorization/client';\nimport { ChatRoom, ChatSubscription } from '../../../app/models/client';\nimport { settings } from '../../../app/settings/client';\nimport type {\n\tRoomSettingsEnum,\n\tRoomMemberActions,\n\tUiTextContext,\n\tIRoomTypeClientDirectives,\n\tRoomIdentification,\n\tIRoomTypeRouteConfig,\n\tIRoomTypeClientConfig,\n} from '../../../definition/IRoomTypeConfig';\nimport { RoomCoordinator } from '../../../lib/rooms/coordinator';\nimport { router } from '../../providers/RouterProvider';\nimport RoomRoute from '../../views/room/RoomRoute';\nimport MainLayout from '../../views/root/MainLayout';\nimport { appLayout } from '../appLayout';\n\nclass RoomCoordinatorClient extends RoomCoordinator {\n\tpublic add(roomConfig: IRoomTypeClientConfig, directives: Partial<IRoomTypeClientDirectives>): void {\n\t\tthis.addRoomType(roomConfig, {\n\t\t\tallowRoomSettingChange(_room: Partial<IRoom>, _setting: ValueOf<typeof RoomSettingsEnum>): boolean {\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tallowMemberAction(\n\t\t\t\t_room: Partial<IRoom>,\n\t\t\t\t_action: ValueOf<typeof RoomMemberActions>,\n\t\t\t\t_showingUserId: IUser['_id'],\n\t\t\t\t_userSubscription?: ISubscription,\n\t\t\t): boolean {\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\troomName(_room: AtLeast<IRoom, '_id' | 'name' | 'fname' | 'prid'>): string {\n\t\t\t\treturn '';\n\t\t\t},\n\t\t\tisGroupChat(_room: Partial<IRoom>): boolean {\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tgetUiText(_context: ValueOf<typeof UiTextContext>): string {\n\t\t\t\treturn '';\n\t\t\t},\n\t\t\tcondition(): boolean {\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tgetAvatarPath(_room): string {\n\t\t\t\treturn '';\n\t\t\t},\n\t\t\tfindRoom(_identifier: string): IRoom | undefined {\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t\tshowJoinLink(_roomId: string): boolean {\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tisLivechatRoom(): boolean {\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tcanSendMessage(rid: string): boolean {\n\t\t\t\treturn ChatSubscription.find({ rid }).count() > 0;\n\t\t\t},\n\t\t\t...directives,\n\t\t\tconfig: roomConfig,\n\t\t});\n\t}\n\n\tpublic getRoomDirectives(roomType: string): IRoomTypeClientDirectives {\n\t\treturn this.roomTypes[roomType].directives as IRoomTypeClientDirectives;\n\t}\n\n\tpublic openRouteLink(\n\t\troomType: RoomType,\n\t\tsubData: RoomIdentification,\n\t\tqueryParams?: Record<string, string>,\n\t\toptions: { replace?: boolean } = {},\n\t): void {\n\t\tconst config = this.getRoomTypeConfig(roomType);\n\t\tif (!config?.route) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet routeData = {};\n\t\tif (config.route.link) {\n\t\t\trouteData = config.route.link(subData);\n\t\t} else if (subData?.name) {\n\t\t\trouteData = {\n\t\t\t\tname: subData.name,\n\t\t\t};\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\trouter.navigate(\n\t\t\t{\n\t\t\t\tpattern: config.route.path ?? '/home',\n\t\t\t\tparams: routeData,\n\t\t\t\tsearch: queryParams,\n\t\t\t},\n\t\t\toptions,\n\t\t);\n\t}\n\n\tpublic isLivechatRoom(roomType: string): boolean {\n\t\treturn Boolean(this.getRoomDirectives(roomType).isLivechatRoom());\n\t}\n\n\tpublic getRoomName(roomType: string, roomData: AtLeast<IRoom, '_id' | 'name' | 'fname' | 'prid'>): string {\n\t\treturn this.getRoomDirectives(roomType).roomName(roomData) ?? '';\n\t}\n\n\tpublic readOnly(rid: string, user: AtLeast<IUser, 'username'>): boolean {\n\t\tconst fields = {\n\t\t\tro: 1,\n\t\t\tt: 1,\n\t\t\t...(user && { muted: 1, unmuted: 1 }),\n\t\t};\n\t\tconst room = ChatRoom.findOne({ _id: rid }, { fields });\n\t\tif (!room) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst directives = this.getRoomDirectives(room.t);\n\t\tif (directives?.readOnly) {\n\t\t\treturn directives.readOnly(rid, user);\n\t\t}\n\n\t\tif (!user?.username) {\n\t\t\treturn Boolean(room.ro);\n\t\t}\n\n\t\tif (!room) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (Array.isArray(room.muted) && room.muted.indexOf(user.username) !== -1) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (room.ro) {\n\t\t\tif (Array.isArray(room.unmuted) && room.unmuted.indexOf(user.username) !== -1) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (hasPermission('post-readonly', room._id)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t// #ToDo: Move this out of the RoomCoordinator\n\tpublic archived(rid: string): boolean {\n\t\tconst room = ChatRoom.findOne({ _id: rid }, { fields: { archived: 1 } });\n\t\treturn Boolean(room?.archived);\n\t}\n\n\tpublic verifyCanSendMessage(rid: string): boolean {\n\t\tconst room = ChatRoom.findOne({ _id: rid }, { fields: { t: 1, federated: 1 } });\n\t\tif (!room?.t) {\n\t\t\treturn false;\n\t\t}\n\t\tif (!this.getRoomDirectives(room.t).canSendMessage(rid)) {\n\t\t\treturn false;\n\t\t}\n\t\tif (isRoomFederated(room)) {\n\t\t\treturn settings.get('Federation_Matrix_enabled');\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate validateRoute<TRouteName extends RouteName>(route: IRoomTypeRouteConfig<TRouteName>): void {\n\t\tconst { name, path, link } = route;\n\n\t\tif (typeof name !== 'string' || name.length === 0) {\n\t\t\tthrow new Error('The route name must be a string.');\n\t\t}\n\n\t\tif (path !== undefined && (typeof path !== 'string' || path.length === 0)) {\n\t\t\tthrow new Error('The route path must be a string.');\n\t\t}\n\n\t\tif (!['undefined', 'function'].includes(typeof link)) {\n\t\t\tthrow new Error('The route link must be a function.');\n\t\t}\n\t}\n\n\tprotected validateRoomConfig(roomConfig: IRoomTypeClientConfig): void {\n\t\tsuper.validateRoomConfig(roomConfig);\n\n\t\tconst { route, label } = roomConfig;\n\n\t\tif (route !== undefined) {\n\t\t\tthis.validateRoute(route);\n\t\t}\n\n\t\tif (label !== undefined && (typeof label !== 'string' || label.length === 0)) {\n\t\t\tthrow new Error('The label must be a string.');\n\t\t}\n\t}\n\n\tprotected addRoomType(roomConfig: IRoomTypeClientConfig, directives: IRoomTypeClientDirectives): void {\n\t\tsuper.addRoomType(roomConfig, directives);\n\n\t\tif (roomConfig.route?.path && roomConfig.route.name && directives.extractOpenRoomParams) {\n\t\t\tconst {\n\t\t\t\troute: { name, path },\n\t\t\t} = roomConfig;\n\t\t\tconst { extractOpenRoomParams } = directives;\n\t\t\trouter.defineRoutes([\n\t\t\t\t{\n\t\t\t\t\tpath,\n\t\t\t\t\tid: name,\n\t\t\t\t\telement: appLayout.wrap(\n\t\t\t\t\t\t<MainLayout>\n\t\t\t\t\t\t\t<RoomRoute extractOpenRoomParams={extractOpenRoomParams} />\n\t\t\t\t\t\t</MainLayout>,\n\t\t\t\t\t),\n\t\t\t\t},\n\t\t\t]);\n\t\t}\n\t}\n\n\tpublic getURL(roomType: string, subData: RoomIdentification): string | false {\n\t\tconst config = this.getRoomTypeConfig(roomType);\n\t\tif (!config?.route) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst routeData = this.getRouteData(roomType, subData);\n\t\tif (!routeData) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn Meteor.absoluteUrl(\n\t\t\trouter.buildRoutePath({\n\t\t\t\tname: config.route.name,\n\t\t\t\tparams: routeData,\n\t\t\t}),\n\t\t);\n\t}\n\n\tpublic isRouteNameKnown(routeName: string): boolean {\n\t\treturn Boolean(this.getRouteNameIdentifier(routeName));\n\t}\n\n\tpublic getRouteNameIdentifier(routeName: string): string | undefined {\n\t\tif (!routeName) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn Object.keys(this.roomTypes).find((key) => this.roomTypes[key].config.route?.name === routeName);\n\t}\n}\n\nexport const roomCoordinator = new RoomCoordinatorClient();\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"6bc5e1816955b325c43a3a1c38e6e3c61155b920"}
