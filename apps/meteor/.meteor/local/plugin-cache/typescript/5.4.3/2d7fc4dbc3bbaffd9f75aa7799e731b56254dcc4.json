{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/customSounds/AddCustomSound.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/admin/customSounds/AddCustomSound.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/customSounds/AddCustomSound.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/customSounds/AddCustomSound.tsx","sourceRoot":"","sources":["client/views/admin/customSounds/AddCustomSound.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Field, FieldLabel, FieldRow, TextInput, Box, Margins, Button, ButtonGroup, IconButton } from '@rocket.chat/fuselage';\nimport { useToastMessageDispatch, useMethod } from '@rocket.chat/ui-contexts';\nimport type { ReactElement, FormEvent } from 'react';\nimport React, { useState, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { validate, createSoundData } from './lib';\nimport { ContextualbarScrollableContent, ContextualbarFooter } from '../../../components/Contextualbar';\nimport { useSingleFileInput } from '../../../hooks/useSingleFileInput';\n\ntype AddCustomSoundProps = {\n\tgoToNew: (_id: string) => () => void;\n\tclose: () => void;\n\tonChange: () => void;\n};\n\nconst AddCustomSound = ({ goToNew, close, onChange, ...props }: AddCustomSoundProps): ReactElement => {\n\tconst { t } = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst [name, setName] = useState('');\n\tconst [sound, setSound] = useState<{ name: string }>();\n\n\tconst uploadCustomSound = useMethod('uploadCustomSound');\n\tconst insertOrUpdateSound = useMethod('insertOrUpdateSound');\n\n\tconst handleChangeFile = useCallback((soundFile) => {\n\t\tsetSound(soundFile);\n\t}, []);\n\n\tconst [clickUpload] = useSingleFileInput(handleChangeFile, 'audio/mp3');\n\n\tconst saveAction = useCallback(\n\t\tasync (name, soundFile): Promise<string | undefined> => {\n\t\t\tconst soundData = createSoundData(soundFile, name);\n\t\t\tconst validation = validate(soundData, soundFile) as Array<Parameters<typeof t>[0]>;\n\n\t\t\tvalidation.forEach((invalidFieldName) => {\n\t\t\t\tthrow new Error(t('Required_field', { field: t(invalidFieldName) }));\n\t\t\t});\n\n\t\t\ttry {\n\t\t\t\tconst soundId = await insertOrUpdateSound(soundData);\n\n\t\t\t\tif (!soundId) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Uploading_file') });\n\n\t\t\t\tconst reader = new FileReader();\n\t\t\t\treader.readAsBinaryString(soundFile);\n\t\t\t\treader.onloadend = (): void => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tuploadCustomSound(reader.result as string, soundFile.type, {\n\t\t\t\t\t\t\t...soundData,\n\t\t\t\t\t\t\t_id: soundId,\n\t\t\t\t\t\t\trandom: Math.round(Math.random() * 1000),\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdispatchToastMessage({ type: 'success', message: t('File_uploaded') });\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t(typeof error === 'string' || error instanceof Error) && dispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\treturn soundId;\n\t\t\t} catch (error) {\n\t\t\t\t(typeof error === 'string' || error instanceof Error) && dispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t},\n\t\t[dispatchToastMessage, insertOrUpdateSound, t, uploadCustomSound],\n\t);\n\n\tconst handleSave = useCallback(async () => {\n\t\ttry {\n\t\t\tconst result = await saveAction(name, sound);\n\t\t\tif (result) {\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Custom_Sound_Saved_Successfully') });\n\t\t\t}\n\t\t\tresult && goToNew(result);\n\t\t\tonChange();\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t}, [dispatchToastMessage, goToNew, name, onChange, saveAction, sound, t]);\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarScrollableContent {...props}>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel>{t('Name')}</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\tvalue={name}\n\t\t\t\t\t\t\tonChange={(e: FormEvent<HTMLInputElement>): void => setName(e.currentTarget.value)}\n\t\t\t\t\t\t\tplaceholder={t('Name')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</FieldRow>\n\t\t\t\t</Field>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel alignSelf='stretch'>{t('Sound_File_mp3')}</FieldLabel>\n\t\t\t\t\t<Box display='flex' flexDirection='row' mbs='none' alignItems='center'>\n\t\t\t\t\t\t<Margins inline={4}>\n\t\t\t\t\t\t\t<IconButton secondary small icon='upload' onClick={clickUpload} />\n\t\t\t\t\t\t\t{sound?.name || t('None')}\n\t\t\t\t\t\t</Margins>\n\t\t\t\t\t</Box>\n\t\t\t\t</Field>\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button onClick={close}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button primary onClick={handleSave}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</>\n\t);\n};\n\nexport default AddCustomSound;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/customSounds/AddCustomSound.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/admin/customSounds/AddCustomSound.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/customSounds/AddCustomSound.tsx","sourceRoot":"","sources":["client/views/admin/customSounds/AddCustomSound.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Field, FieldLabel, FieldRow, TextInput, Box, Margins, Button, ButtonGroup, IconButton } from '@rocket.chat/fuselage';\nimport { useToastMessageDispatch, useMethod } from '@rocket.chat/ui-contexts';\nimport type { ReactElement, FormEvent } from 'react';\nimport React, { useState, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { validate, createSoundData } from './lib';\nimport { ContextualbarScrollableContent, ContextualbarFooter } from '../../../components/Contextualbar';\nimport { useSingleFileInput } from '../../../hooks/useSingleFileInput';\n\ntype AddCustomSoundProps = {\n\tgoToNew: (_id: string) => () => void;\n\tclose: () => void;\n\tonChange: () => void;\n};\n\nconst AddCustomSound = ({ goToNew, close, onChange, ...props }: AddCustomSoundProps): ReactElement => {\n\tconst { t } = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst [name, setName] = useState('');\n\tconst [sound, setSound] = useState<{ name: string }>();\n\n\tconst uploadCustomSound = useMethod('uploadCustomSound');\n\tconst insertOrUpdateSound = useMethod('insertOrUpdateSound');\n\n\tconst handleChangeFile = useCallback((soundFile) => {\n\t\tsetSound(soundFile);\n\t}, []);\n\n\tconst [clickUpload] = useSingleFileInput(handleChangeFile, 'audio/mp3');\n\n\tconst saveAction = useCallback(\n\t\tasync (name, soundFile): Promise<string | undefined> => {\n\t\t\tconst soundData = createSoundData(soundFile, name);\n\t\t\tconst validation = validate(soundData, soundFile) as Array<Parameters<typeof t>[0]>;\n\n\t\t\tvalidation.forEach((invalidFieldName) => {\n\t\t\t\tthrow new Error(t('Required_field', { field: t(invalidFieldName) }));\n\t\t\t});\n\n\t\t\ttry {\n\t\t\t\tconst soundId = await insertOrUpdateSound(soundData);\n\n\t\t\t\tif (!soundId) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Uploading_file') });\n\n\t\t\t\tconst reader = new FileReader();\n\t\t\t\treader.readAsBinaryString(soundFile);\n\t\t\t\treader.onloadend = (): void => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tuploadCustomSound(reader.result as string, soundFile.type, {\n\t\t\t\t\t\t\t...soundData,\n\t\t\t\t\t\t\t_id: soundId,\n\t\t\t\t\t\t\trandom: Math.round(Math.random() * 1000),\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdispatchToastMessage({ type: 'success', message: t('File_uploaded') });\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t(typeof error === 'string' || error instanceof Error) && dispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\treturn soundId;\n\t\t\t} catch (error) {\n\t\t\t\t(typeof error === 'string' || error instanceof Error) && dispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t},\n\t\t[dispatchToastMessage, insertOrUpdateSound, t, uploadCustomSound],\n\t);\n\n\tconst handleSave = useCallback(async () => {\n\t\ttry {\n\t\t\tconst result = await saveAction(name, sound);\n\t\t\tif (result) {\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Custom_Sound_Saved_Successfully') });\n\t\t\t}\n\t\t\tresult && goToNew(result);\n\t\t\tonChange();\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t}, [dispatchToastMessage, goToNew, name, onChange, saveAction, sound, t]);\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarScrollableContent {...props}>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel>{t('Name')}</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\tvalue={name}\n\t\t\t\t\t\t\tonChange={(e: FormEvent<HTMLInputElement>): void => setName(e.currentTarget.value)}\n\t\t\t\t\t\t\tplaceholder={t('Name')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</FieldRow>\n\t\t\t\t</Field>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel alignSelf='stretch'>{t('Sound_File_mp3')}</FieldLabel>\n\t\t\t\t\t<Box display='flex' flexDirection='row' mbs='none' alignItems='center'>\n\t\t\t\t\t\t<Margins inline={4}>\n\t\t\t\t\t\t\t<IconButton secondary small icon='upload' onClick={clickUpload} />\n\t\t\t\t\t\t\t{sound?.name || t('None')}\n\t\t\t\t\t\t</Margins>\n\t\t\t\t\t</Box>\n\t\t\t\t</Field>\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button onClick={close}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button primary onClick={handleSave}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</>\n\t);\n};\n\nexport default AddCustomSound;\n"]}}},"code":"const _excluded = [\"goToNew\", \"close\", \"onChange\"];\nlet _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n}, 0);\nlet _objectWithoutProperties;\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default(v) {\n    _objectWithoutProperties = v;\n  }\n}, 1);\nlet Field, FieldLabel, FieldRow, TextInput, Box, Margins, Button, ButtonGroup, IconButton;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Field(v) {\n    Field = v;\n  },\n  FieldLabel(v) {\n    FieldLabel = v;\n  },\n  FieldRow(v) {\n    FieldRow = v;\n  },\n  TextInput(v) {\n    TextInput = v;\n  },\n  Box(v) {\n    Box = v;\n  },\n  Margins(v) {\n    Margins = v;\n  },\n  Button(v) {\n    Button = v;\n  },\n  ButtonGroup(v) {\n    ButtonGroup = v;\n  },\n  IconButton(v) {\n    IconButton = v;\n  }\n}, 0);\nlet useToastMessageDispatch, useMethod;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useToastMessageDispatch(v) {\n    useToastMessageDispatch = v;\n  },\n  useMethod(v) {\n    useMethod = v;\n  }\n}, 1);\nlet React, useState, useCallback;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n  useState(v) {\n    useState = v;\n  },\n  useCallback(v) {\n    useCallback = v;\n  }\n}, 2);\nlet useTranslation;\nmodule.link(\"react-i18next\", {\n  useTranslation(v) {\n    useTranslation = v;\n  }\n}, 3);\nlet validate, createSoundData;\nmodule.link(\"./lib\", {\n  validate(v) {\n    validate = v;\n  },\n  createSoundData(v) {\n    createSoundData = v;\n  }\n}, 4);\nlet ContextualbarScrollableContent, ContextualbarFooter;\nmodule.link(\"../../../components/Contextualbar\", {\n  ContextualbarScrollableContent(v) {\n    ContextualbarScrollableContent = v;\n  },\n  ContextualbarFooter(v) {\n    ContextualbarFooter = v;\n  }\n}, 5);\nlet useSingleFileInput;\nmodule.link(\"../../../hooks/useSingleFileInput\", {\n  useSingleFileInput(v) {\n    useSingleFileInput = v;\n  }\n}, 6);\nconst AddCustomSound = _ref => {\n  let {\n      goToNew,\n      close,\n      onChange\n    } = _ref,\n    props = _objectWithoutProperties(_ref, _excluded);\n  const {\n    t\n  } = useTranslation();\n  const dispatchToastMessage = useToastMessageDispatch();\n  const [name, setName] = useState('');\n  const [sound, setSound] = useState();\n  const uploadCustomSound = useMethod('uploadCustomSound');\n  const insertOrUpdateSound = useMethod('insertOrUpdateSound');\n  const handleChangeFile = useCallback(soundFile => {\n    setSound(soundFile);\n  }, []);\n  const [clickUpload] = useSingleFileInput(handleChangeFile, 'audio/mp3');\n  const saveAction = useCallback(async (name, soundFile) => {\n    const soundData = createSoundData(soundFile, name);\n    const validation = validate(soundData, soundFile);\n    validation.forEach(invalidFieldName => {\n      throw new Error(t('Required_field', {\n        field: t(invalidFieldName)\n      }));\n    });\n    try {\n      const soundId = await insertOrUpdateSound(soundData);\n      if (!soundId) {\n        return undefined;\n      }\n      dispatchToastMessage({\n        type: 'success',\n        message: t('Uploading_file')\n      });\n      const reader = new FileReader();\n      reader.readAsBinaryString(soundFile);\n      reader.onloadend = () => {\n        try {\n          uploadCustomSound(reader.result, soundFile.type, _objectSpread(_objectSpread({}, soundData), {}, {\n            _id: soundId,\n            random: Math.round(Math.random() * 1000)\n          }));\n          dispatchToastMessage({\n            type: 'success',\n            message: t('File_uploaded')\n          });\n        } catch (error) {\n          (typeof error === 'string' || error instanceof Error) && dispatchToastMessage({\n            type: 'error',\n            message: error\n          });\n        }\n      };\n      return soundId;\n    } catch (error) {\n      (typeof error === 'string' || error instanceof Error) && dispatchToastMessage({\n        type: 'error',\n        message: error\n      });\n    }\n  }, [dispatchToastMessage, insertOrUpdateSound, t, uploadCustomSound]);\n  const handleSave = useCallback(async () => {\n    try {\n      const result = await saveAction(name, sound);\n      if (result) {\n        dispatchToastMessage({\n          type: 'success',\n          message: t('Custom_Sound_Saved_Successfully')\n        });\n      }\n      result && goToNew(result);\n      onChange();\n    } catch (error) {\n      dispatchToastMessage({\n        type: 'error',\n        message: error\n      });\n    }\n  }, [dispatchToastMessage, goToNew, name, onChange, saveAction, sound, t]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ContextualbarScrollableContent, props, /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(FieldLabel, null, t('Name')), /*#__PURE__*/React.createElement(FieldRow, null, /*#__PURE__*/React.createElement(TextInput, {\n    value: name,\n    onChange: e => setName(e.currentTarget.value),\n    placeholder: t('Name')\n  }))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(FieldLabel, {\n    alignSelf: \"stretch\"\n  }, t('Sound_File_mp3')), /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    flexDirection: \"row\",\n    mbs: \"none\",\n    alignItems: \"center\"\n  }, /*#__PURE__*/React.createElement(Margins, {\n    inline: 4\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    secondary: true,\n    small: true,\n    icon: \"upload\",\n    onClick: clickUpload\n  }), (sound === null || sound === void 0 ? void 0 : sound.name) || t('None'))))), /*#__PURE__*/React.createElement(ContextualbarFooter, null, /*#__PURE__*/React.createElement(ButtonGroup, {\n    stretch: true\n  }, /*#__PURE__*/React.createElement(Button, {\n    onClick: close\n  }, t('Cancel')), /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    onClick: handleSave\n  }, t('Save')))));\n};\nmodule.exportDefault(AddCustomSound);","map":{"version":3,"names":["_objectSpread","module","link","default","v","_objectWithoutProperties","Field","FieldLabel","FieldRow","TextInput","Box","Margins","Button","ButtonGroup","IconButton","useToastMessageDispatch","useMethod","React","useState","useCallback","useTranslation","validate","createSoundData","ContextualbarScrollableContent","ContextualbarFooter","useSingleFileInput","AddCustomSound","_ref","goToNew","close","onChange","props","_excluded","t","dispatchToastMessage","name","setName","sound","setSound","uploadCustomSound","insertOrUpdateSound","handleChangeFile","soundFile","clickUpload","saveAction","soundData","validation","forEach","invalidFieldName","Error","field","soundId","undefined","type","message","reader","FileReader","readAsBinaryString","onloadend","result","_id","random","Math","round","error","handleSave","createElement","Fragment","value","e","currentTarget","placeholder","alignSelf","display","flexDirection","mbs","alignItems","inline","secondary","small","icon","onClick","stretch","primary","exportDefault"],"sources":["client/views/admin/customSounds/AddCustomSound.tsx"],"sourcesContent":["import { Field, FieldLabel, FieldRow, TextInput, Box, Margins, Button, ButtonGroup, IconButton } from '@rocket.chat/fuselage';\nimport { useToastMessageDispatch, useMethod } from '@rocket.chat/ui-contexts';\nimport type { ReactElement, FormEvent } from 'react';\nimport React, { useState, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { validate, createSoundData } from './lib';\nimport { ContextualbarScrollableContent, ContextualbarFooter } from '../../../components/Contextualbar';\nimport { useSingleFileInput } from '../../../hooks/useSingleFileInput';\n\ntype AddCustomSoundProps = {\n\tgoToNew: (_id: string) => () => void;\n\tclose: () => void;\n\tonChange: () => void;\n};\n\nconst AddCustomSound = ({ goToNew, close, onChange, ...props }: AddCustomSoundProps): ReactElement => {\n\tconst { t } = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst [name, setName] = useState('');\n\tconst [sound, setSound] = useState<{ name: string }>();\n\n\tconst uploadCustomSound = useMethod('uploadCustomSound');\n\tconst insertOrUpdateSound = useMethod('insertOrUpdateSound');\n\n\tconst handleChangeFile = useCallback((soundFile) => {\n\t\tsetSound(soundFile);\n\t}, []);\n\n\tconst [clickUpload] = useSingleFileInput(handleChangeFile, 'audio/mp3');\n\n\tconst saveAction = useCallback(\n\t\tasync (name, soundFile): Promise<string | undefined> => {\n\t\t\tconst soundData = createSoundData(soundFile, name);\n\t\t\tconst validation = validate(soundData, soundFile) as Array<Parameters<typeof t>[0]>;\n\n\t\t\tvalidation.forEach((invalidFieldName) => {\n\t\t\t\tthrow new Error(t('Required_field', { field: t(invalidFieldName) }));\n\t\t\t});\n\n\t\t\ttry {\n\t\t\t\tconst soundId = await insertOrUpdateSound(soundData);\n\n\t\t\t\tif (!soundId) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Uploading_file') });\n\n\t\t\t\tconst reader = new FileReader();\n\t\t\t\treader.readAsBinaryString(soundFile);\n\t\t\t\treader.onloadend = (): void => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tuploadCustomSound(reader.result as string, soundFile.type, {\n\t\t\t\t\t\t\t...soundData,\n\t\t\t\t\t\t\t_id: soundId,\n\t\t\t\t\t\t\trandom: Math.round(Math.random() * 1000),\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdispatchToastMessage({ type: 'success', message: t('File_uploaded') });\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t(typeof error === 'string' || error instanceof Error) && dispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\treturn soundId;\n\t\t\t} catch (error) {\n\t\t\t\t(typeof error === 'string' || error instanceof Error) && dispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t},\n\t\t[dispatchToastMessage, insertOrUpdateSound, t, uploadCustomSound],\n\t);\n\n\tconst handleSave = useCallback(async () => {\n\t\ttry {\n\t\t\tconst result = await saveAction(name, sound);\n\t\t\tif (result) {\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Custom_Sound_Saved_Successfully') });\n\t\t\t}\n\t\t\tresult && goToNew(result);\n\t\t\tonChange();\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t}, [dispatchToastMessage, goToNew, name, onChange, saveAction, sound, t]);\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarScrollableContent {...props}>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel>{t('Name')}</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\tvalue={name}\n\t\t\t\t\t\t\tonChange={(e: FormEvent<HTMLInputElement>): void => setName(e.currentTarget.value)}\n\t\t\t\t\t\t\tplaceholder={t('Name')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</FieldRow>\n\t\t\t\t</Field>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel alignSelf='stretch'>{t('Sound_File_mp3')}</FieldLabel>\n\t\t\t\t\t<Box display='flex' flexDirection='row' mbs='none' alignItems='center'>\n\t\t\t\t\t\t<Margins inline={4}>\n\t\t\t\t\t\t\t<IconButton secondary small icon='upload' onClick={clickUpload} />\n\t\t\t\t\t\t\t{sound?.name || t('None')}\n\t\t\t\t\t\t</Margins>\n\t\t\t\t\t</Box>\n\t\t\t\t</Field>\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button onClick={close}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button primary onClick={handleSave}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</>\n\t);\n};\n\nexport default AddCustomSound;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"2d7fc4dbc3bbaffd9f75aa7799e731b56254dcc4"}
