{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/providers/OmnichannelProvider.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/providers/OmnichannelProvider.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/providers/OmnichannelProvider.tsx","inputSourceMap":{"version":3,"file":"client/providers/OmnichannelProvider.tsx","sourceRoot":"","sources":["client/providers/OmnichannelProvider.tsx"],"names":[],"mappings":"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","sourcesContent":["import type {\n\tIOmnichannelAgent,\n\tOmichannelRoutingConfig,\n\tOmnichannelSortingMechanismSettingType,\n\tILivechatInquiryRecord,\n} from '@rocket.chat/core-typings';\nimport { useSafely } from '@rocket.chat/fuselage-hooks';\nimport { useUser, useSetting, usePermission, useMethod, useEndpoint, useStream } from '@rocket.chat/ui-contexts';\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\nimport type { ReactNode } from 'react';\nimport React, { useState, useEffect, useMemo, useCallback, memo, useRef } from 'react';\n\nimport { LivechatInquiry } from '../../app/livechat/client/collections/LivechatInquiry';\nimport { initializeLivechatInquiryStream } from '../../app/livechat/client/lib/stream/queueManager';\nimport { getOmniChatSortQuery } from '../../app/livechat/lib/inquiries';\nimport { KonchatNotification } from '../../app/ui/client/lib/KonchatNotification';\nimport { ClientLogger } from '../../lib/ClientLogger';\nimport type { OmnichannelContextValue } from '../contexts/OmnichannelContext';\nimport { OmnichannelContext } from '../contexts/OmnichannelContext';\nimport { useHasLicenseModule } from '../hooks/useHasLicenseModule';\nimport { useReactiveValue } from '../hooks/useReactiveValue';\nimport { useShouldPreventAction } from '../hooks/useShouldPreventAction';\n\nconst emptyContextValue: OmnichannelContextValue = {\n\tinquiries: { enabled: false },\n\tenabled: false,\n\tisEnterprise: false,\n\tagentAvailable: false,\n\tshowOmnichannelQueueLink: false,\n\tisOverMacLimit: false,\n\tlivechatPriorities: {\n\t\tenabled: false,\n\t\tdata: [],\n\t\tisLoading: false,\n\t\tisError: false,\n\t},\n};\n\ntype OmnichannelProviderProps = {\n\tchildren?: ReactNode;\n};\n\nconst OmnichannelProvider = ({ children }: OmnichannelProviderProps) => {\n\tconst omniChannelEnabled = useSetting('Livechat_enabled') as boolean;\n\tconst omnichannelRouting = useSetting('Livechat_Routing_Method');\n\tconst showOmnichannelQueueLink = useSetting('Livechat_show_queue_list_link') as boolean;\n\tconst omnichannelPoolMaxIncoming = useSetting<number>('Livechat_guest_pool_max_number_incoming_livechats_displayed') ?? 0;\n\tconst omnichannelSortingMechanism = useSetting('Omnichannel_sorting_mechanism') as OmnichannelSortingMechanismSettingType;\n\n\tconst loggerRef = useRef(new ClientLogger('OmnichannelProvider'));\n\tconst hasAccess = usePermission('view-l-room');\n\tconst canViewOmnichannelQueue = usePermission('view-livechat-queue');\n\tconst user = useUser() as IOmnichannelAgent;\n\n\tconst agentAvailable = user?.statusLivechat === 'available';\n\tconst voipCallAvailable = true; // TODO: use backend check;\n\n\tconst getRoutingConfig = useMethod('livechat:getRoutingConfig');\n\n\tconst [routeConfig, setRouteConfig] = useSafely(useState<OmichannelRoutingConfig | undefined>(undefined));\n\tconst [queueNotification, setQueueNotification] = useState(new Set());\n\n\tconst accessible = hasAccess && omniChannelEnabled;\n\tconst iceServersSetting: any = useSetting('WebRTC_Servers');\n\tconst isEnterprise = useHasLicenseModule('livechat-enterprise') === true;\n\n\tconst getPriorities = useEndpoint('GET', '/v1/livechat/priorities');\n\tconst subscribe = useStream('notify-logged');\n\tconst queryClient = useQueryClient();\n\tconst isPrioritiesEnabled = isEnterprise && accessible;\n\tconst enabled = accessible && !!user && !!routeConfig;\n\n\tconst {\n\t\tdata: { priorities = [] } = {},\n\t\tisInitialLoading: isLoadingPriorities,\n\t\tisError: isErrorPriorities,\n\t} = useQuery(['/v1/livechat/priorities'], () => getPriorities({ sort: JSON.stringify({ sortItem: 1 }) }), {\n\t\tstaleTime: Infinity,\n\t\tenabled: isPrioritiesEnabled,\n\t});\n\n\tconst isOverMacLimit = useShouldPreventAction('monthlyActiveContacts');\n\n\tuseEffect(() => {\n\t\tif (!isPrioritiesEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn subscribe('omnichannel.priority-changed', () => {\n\t\t\tqueryClient.invalidateQueries(['/v1/livechat/priorities']);\n\t\t});\n\t}, [isPrioritiesEnabled, queryClient, subscribe]);\n\n\tuseEffect(() => {\n\t\tif (!accessible) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst update = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tconst routeConfig = await getRoutingConfig();\n\t\t\t\tsetRouteConfig(routeConfig);\n\t\t\t} catch (error) {\n\t\t\t\tloggerRef.current.error(`update() error in routeConfig ${error}`);\n\t\t\t}\n\t\t};\n\n\t\tif (omnichannelRouting || !omnichannelRouting) {\n\t\t\tupdate();\n\t\t}\n\t}, [accessible, getRoutingConfig, iceServersSetting, omnichannelRouting, setRouteConfig, voipCallAvailable]);\n\n\tconst manuallySelected =\n\t\tenabled && canViewOmnichannelQueue && !!routeConfig && routeConfig.showQueue && !routeConfig.autoAssignAgent && agentAvailable;\n\n\tconst streamNotifyUser = useStream('notify-user');\n\tuseEffect(() => {\n\t\tif (!manuallySelected) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst handleDepartmentAgentData = (): void => {\n\t\t\tinitializeLivechatInquiryStream(user?._id);\n\t\t};\n\n\t\tinitializeLivechatInquiryStream(user?._id);\n\t\tif (!user?._id) {\n\t\t\treturn;\n\t\t}\n\t\treturn streamNotifyUser(`${user._id}/departmentAgentData`, handleDepartmentAgentData);\n\t}, [manuallySelected, streamNotifyUser, user?._id]);\n\n\tconst queue = useReactiveValue<ILivechatInquiryRecord[] | undefined>(\n\t\tuseCallback(() => {\n\t\t\tif (!manuallySelected) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn LivechatInquiry.find(\n\t\t\t\t{ status: 'queued' },\n\t\t\t\t{\n\t\t\t\t\tsort: getOmniChatSortQuery(omnichannelSortingMechanism),\n\t\t\t\t\tlimit: omnichannelPoolMaxIncoming,\n\t\t\t\t},\n\t\t\t).fetch();\n\t\t}, [manuallySelected, omnichannelPoolMaxIncoming, omnichannelSortingMechanism]),\n\t);\n\n\tqueue?.map(({ rid }) => {\n\t\tif (queueNotification.has(rid)) {\n\t\t\treturn;\n\t\t}\n\t\tsetQueueNotification((prev) => new Set([...prev, rid]));\n\t\treturn KonchatNotification.newRoom(rid);\n\t});\n\n\tconst contextValue = useMemo<OmnichannelContextValue>(() => {\n\t\tif (!enabled) {\n\t\t\treturn emptyContextValue;\n\t\t}\n\n\t\tconst livechatPriorities = {\n\t\t\tenabled: isPrioritiesEnabled,\n\t\t\tdata: priorities,\n\t\t\tisLoading: isLoadingPriorities,\n\t\t\tisError: isErrorPriorities,\n\t\t};\n\n\t\tif (!manuallySelected) {\n\t\t\treturn {\n\t\t\t\t...emptyContextValue,\n\t\t\t\tenabled: true,\n\t\t\t\tisEnterprise,\n\t\t\t\tagentAvailable,\n\t\t\t\tvoipCallAvailable,\n\t\t\t\trouteConfig,\n\t\t\t\tlivechatPriorities,\n\t\t\t\tisOverMacLimit,\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\t...emptyContextValue,\n\t\t\tenabled: true,\n\t\t\tisEnterprise,\n\t\t\tagentAvailable,\n\t\t\tvoipCallAvailable,\n\t\t\trouteConfig,\n\t\t\tinquiries: queue\n\t\t\t\t? {\n\t\t\t\t\t\tenabled: true,\n\t\t\t\t\t\tqueue,\n\t\t\t\t  }\n\t\t\t\t: { enabled: false },\n\t\t\tshowOmnichannelQueueLink: showOmnichannelQueueLink && !!agentAvailable,\n\t\t\tlivechatPriorities,\n\t\t\tisOverMacLimit,\n\t\t};\n\t}, [\n\t\tenabled,\n\t\tisPrioritiesEnabled,\n\t\tpriorities,\n\t\tisLoadingPriorities,\n\t\tisErrorPriorities,\n\t\tmanuallySelected,\n\t\tisEnterprise,\n\t\tagentAvailable,\n\t\tvoipCallAvailable,\n\t\trouteConfig,\n\t\tqueue,\n\t\tshowOmnichannelQueueLink,\n\t\tisOverMacLimit,\n\t]);\n\n\treturn <OmnichannelContext.Provider children={children} value={contextValue} />;\n};\n\nexport default memo<typeof OmnichannelProvider>(OmnichannelProvider);\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/providers/OmnichannelProvider.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/providers/OmnichannelProvider.tsx","inputSourceMap":{"version":3,"file":"client/providers/OmnichannelProvider.tsx","sourceRoot":"","sources":["client/providers/OmnichannelProvider.tsx"],"names":[],"mappings":"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","sourcesContent":["import type {\n\tIOmnichannelAgent,\n\tOmichannelRoutingConfig,\n\tOmnichannelSortingMechanismSettingType,\n\tILivechatInquiryRecord,\n} from '@rocket.chat/core-typings';\nimport { useSafely } from '@rocket.chat/fuselage-hooks';\nimport { useUser, useSetting, usePermission, useMethod, useEndpoint, useStream } from '@rocket.chat/ui-contexts';\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\nimport type { ReactNode } from 'react';\nimport React, { useState, useEffect, useMemo, useCallback, memo, useRef } from 'react';\n\nimport { LivechatInquiry } from '../../app/livechat/client/collections/LivechatInquiry';\nimport { initializeLivechatInquiryStream } from '../../app/livechat/client/lib/stream/queueManager';\nimport { getOmniChatSortQuery } from '../../app/livechat/lib/inquiries';\nimport { KonchatNotification } from '../../app/ui/client/lib/KonchatNotification';\nimport { ClientLogger } from '../../lib/ClientLogger';\nimport type { OmnichannelContextValue } from '../contexts/OmnichannelContext';\nimport { OmnichannelContext } from '../contexts/OmnichannelContext';\nimport { useHasLicenseModule } from '../hooks/useHasLicenseModule';\nimport { useReactiveValue } from '../hooks/useReactiveValue';\nimport { useShouldPreventAction } from '../hooks/useShouldPreventAction';\n\nconst emptyContextValue: OmnichannelContextValue = {\n\tinquiries: { enabled: false },\n\tenabled: false,\n\tisEnterprise: false,\n\tagentAvailable: false,\n\tshowOmnichannelQueueLink: false,\n\tisOverMacLimit: false,\n\tlivechatPriorities: {\n\t\tenabled: false,\n\t\tdata: [],\n\t\tisLoading: false,\n\t\tisError: false,\n\t},\n};\n\ntype OmnichannelProviderProps = {\n\tchildren?: ReactNode;\n};\n\nconst OmnichannelProvider = ({ children }: OmnichannelProviderProps) => {\n\tconst omniChannelEnabled = useSetting('Livechat_enabled') as boolean;\n\tconst omnichannelRouting = useSetting('Livechat_Routing_Method');\n\tconst showOmnichannelQueueLink = useSetting('Livechat_show_queue_list_link') as boolean;\n\tconst omnichannelPoolMaxIncoming = useSetting<number>('Livechat_guest_pool_max_number_incoming_livechats_displayed') ?? 0;\n\tconst omnichannelSortingMechanism = useSetting('Omnichannel_sorting_mechanism') as OmnichannelSortingMechanismSettingType;\n\n\tconst loggerRef = useRef(new ClientLogger('OmnichannelProvider'));\n\tconst hasAccess = usePermission('view-l-room');\n\tconst canViewOmnichannelQueue = usePermission('view-livechat-queue');\n\tconst user = useUser() as IOmnichannelAgent;\n\n\tconst agentAvailable = user?.statusLivechat === 'available';\n\tconst voipCallAvailable = true; // TODO: use backend check;\n\n\tconst getRoutingConfig = useMethod('livechat:getRoutingConfig');\n\n\tconst [routeConfig, setRouteConfig] = useSafely(useState<OmichannelRoutingConfig | undefined>(undefined));\n\tconst [queueNotification, setQueueNotification] = useState(new Set());\n\n\tconst accessible = hasAccess && omniChannelEnabled;\n\tconst iceServersSetting: any = useSetting('WebRTC_Servers');\n\tconst isEnterprise = useHasLicenseModule('livechat-enterprise') === true;\n\n\tconst getPriorities = useEndpoint('GET', '/v1/livechat/priorities');\n\tconst subscribe = useStream('notify-logged');\n\tconst queryClient = useQueryClient();\n\tconst isPrioritiesEnabled = isEnterprise && accessible;\n\tconst enabled = accessible && !!user && !!routeConfig;\n\n\tconst {\n\t\tdata: { priorities = [] } = {},\n\t\tisInitialLoading: isLoadingPriorities,\n\t\tisError: isErrorPriorities,\n\t} = useQuery(['/v1/livechat/priorities'], () => getPriorities({ sort: JSON.stringify({ sortItem: 1 }) }), {\n\t\tstaleTime: Infinity,\n\t\tenabled: isPrioritiesEnabled,\n\t});\n\n\tconst isOverMacLimit = useShouldPreventAction('monthlyActiveContacts');\n\n\tuseEffect(() => {\n\t\tif (!isPrioritiesEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn subscribe('omnichannel.priority-changed', () => {\n\t\t\tqueryClient.invalidateQueries(['/v1/livechat/priorities']);\n\t\t});\n\t}, [isPrioritiesEnabled, queryClient, subscribe]);\n\n\tuseEffect(() => {\n\t\tif (!accessible) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst update = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tconst routeConfig = await getRoutingConfig();\n\t\t\t\tsetRouteConfig(routeConfig);\n\t\t\t} catch (error) {\n\t\t\t\tloggerRef.current.error(`update() error in routeConfig ${error}`);\n\t\t\t}\n\t\t};\n\n\t\tif (omnichannelRouting || !omnichannelRouting) {\n\t\t\tupdate();\n\t\t}\n\t}, [accessible, getRoutingConfig, iceServersSetting, omnichannelRouting, setRouteConfig, voipCallAvailable]);\n\n\tconst manuallySelected =\n\t\tenabled && canViewOmnichannelQueue && !!routeConfig && routeConfig.showQueue && !routeConfig.autoAssignAgent && agentAvailable;\n\n\tconst streamNotifyUser = useStream('notify-user');\n\tuseEffect(() => {\n\t\tif (!manuallySelected) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst handleDepartmentAgentData = (): void => {\n\t\t\tinitializeLivechatInquiryStream(user?._id);\n\t\t};\n\n\t\tinitializeLivechatInquiryStream(user?._id);\n\t\tif (!user?._id) {\n\t\t\treturn;\n\t\t}\n\t\treturn streamNotifyUser(`${user._id}/departmentAgentData`, handleDepartmentAgentData);\n\t}, [manuallySelected, streamNotifyUser, user?._id]);\n\n\tconst queue = useReactiveValue<ILivechatInquiryRecord[] | undefined>(\n\t\tuseCallback(() => {\n\t\t\tif (!manuallySelected) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn LivechatInquiry.find(\n\t\t\t\t{ status: 'queued' },\n\t\t\t\t{\n\t\t\t\t\tsort: getOmniChatSortQuery(omnichannelSortingMechanism),\n\t\t\t\t\tlimit: omnichannelPoolMaxIncoming,\n\t\t\t\t},\n\t\t\t).fetch();\n\t\t}, [manuallySelected, omnichannelPoolMaxIncoming, omnichannelSortingMechanism]),\n\t);\n\n\tqueue?.map(({ rid }) => {\n\t\tif (queueNotification.has(rid)) {\n\t\t\treturn;\n\t\t}\n\t\tsetQueueNotification((prev) => new Set([...prev, rid]));\n\t\treturn KonchatNotification.newRoom(rid);\n\t});\n\n\tconst contextValue = useMemo<OmnichannelContextValue>(() => {\n\t\tif (!enabled) {\n\t\t\treturn emptyContextValue;\n\t\t}\n\n\t\tconst livechatPriorities = {\n\t\t\tenabled: isPrioritiesEnabled,\n\t\t\tdata: priorities,\n\t\t\tisLoading: isLoadingPriorities,\n\t\t\tisError: isErrorPriorities,\n\t\t};\n\n\t\tif (!manuallySelected) {\n\t\t\treturn {\n\t\t\t\t...emptyContextValue,\n\t\t\t\tenabled: true,\n\t\t\t\tisEnterprise,\n\t\t\t\tagentAvailable,\n\t\t\t\tvoipCallAvailable,\n\t\t\t\trouteConfig,\n\t\t\t\tlivechatPriorities,\n\t\t\t\tisOverMacLimit,\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\t...emptyContextValue,\n\t\t\tenabled: true,\n\t\t\tisEnterprise,\n\t\t\tagentAvailable,\n\t\t\tvoipCallAvailable,\n\t\t\trouteConfig,\n\t\t\tinquiries: queue\n\t\t\t\t? {\n\t\t\t\t\t\tenabled: true,\n\t\t\t\t\t\tqueue,\n\t\t\t\t  }\n\t\t\t\t: { enabled: false },\n\t\t\tshowOmnichannelQueueLink: showOmnichannelQueueLink && !!agentAvailable,\n\t\t\tlivechatPriorities,\n\t\t\tisOverMacLimit,\n\t\t};\n\t}, [\n\t\tenabled,\n\t\tisPrioritiesEnabled,\n\t\tpriorities,\n\t\tisLoadingPriorities,\n\t\tisErrorPriorities,\n\t\tmanuallySelected,\n\t\tisEnterprise,\n\t\tagentAvailable,\n\t\tvoipCallAvailable,\n\t\trouteConfig,\n\t\tqueue,\n\t\tshowOmnichannelQueueLink,\n\t\tisOverMacLimit,\n\t]);\n\n\treturn <OmnichannelContext.Provider children={children} value={contextValue} />;\n};\n\nexport default memo<typeof OmnichannelProvider>(OmnichannelProvider);\n"]}}},"code":"var _regeneratorRuntime;\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\nvar _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default: function (v) {\n    _objectSpread = v;\n  }\n}, 1);\nvar _toConsumableArray;\nmodule.link(\"@babel/runtime/helpers/toConsumableArray\", {\n  default: function (v) {\n    _toConsumableArray = v;\n  }\n}, 2);\nvar _slicedToArray;\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 3);\nvar useSafely;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useSafely: function (v) {\n    useSafely = v;\n  }\n}, 0);\nvar useUser, useSetting, usePermission, useMethod, useEndpoint, useStream;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useUser: function (v) {\n    useUser = v;\n  },\n  useSetting: function (v) {\n    useSetting = v;\n  },\n  usePermission: function (v) {\n    usePermission = v;\n  },\n  useMethod: function (v) {\n    useMethod = v;\n  },\n  useEndpoint: function (v) {\n    useEndpoint = v;\n  },\n  useStream: function (v) {\n    useStream = v;\n  }\n}, 1);\nvar useQuery, useQueryClient;\nmodule.link(\"@tanstack/react-query\", {\n  useQuery: function (v) {\n    useQuery = v;\n  },\n  useQueryClient: function (v) {\n    useQueryClient = v;\n  }\n}, 2);\nvar React, useState, useEffect, useMemo, useCallback, memo, useRef;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useState: function (v) {\n    useState = v;\n  },\n  useEffect: function (v) {\n    useEffect = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  },\n  useCallback: function (v) {\n    useCallback = v;\n  },\n  memo: function (v) {\n    memo = v;\n  },\n  useRef: function (v) {\n    useRef = v;\n  }\n}, 3);\nvar LivechatInquiry;\nmodule.link(\"../../app/livechat/client/collections/LivechatInquiry\", {\n  LivechatInquiry: function (v) {\n    LivechatInquiry = v;\n  }\n}, 4);\nvar initializeLivechatInquiryStream;\nmodule.link(\"../../app/livechat/client/lib/stream/queueManager\", {\n  initializeLivechatInquiryStream: function (v) {\n    initializeLivechatInquiryStream = v;\n  }\n}, 5);\nvar getOmniChatSortQuery;\nmodule.link(\"../../app/livechat/lib/inquiries\", {\n  getOmniChatSortQuery: function (v) {\n    getOmniChatSortQuery = v;\n  }\n}, 6);\nvar KonchatNotification;\nmodule.link(\"../../app/ui/client/lib/KonchatNotification\", {\n  KonchatNotification: function (v) {\n    KonchatNotification = v;\n  }\n}, 7);\nvar ClientLogger;\nmodule.link(\"../../lib/ClientLogger\", {\n  ClientLogger: function (v) {\n    ClientLogger = v;\n  }\n}, 8);\nvar OmnichannelContext;\nmodule.link(\"../contexts/OmnichannelContext\", {\n  OmnichannelContext: function (v) {\n    OmnichannelContext = v;\n  }\n}, 9);\nvar useHasLicenseModule;\nmodule.link(\"../hooks/useHasLicenseModule\", {\n  useHasLicenseModule: function (v) {\n    useHasLicenseModule = v;\n  }\n}, 10);\nvar useReactiveValue;\nmodule.link(\"../hooks/useReactiveValue\", {\n  useReactiveValue: function (v) {\n    useReactiveValue = v;\n  }\n}, 11);\nvar useShouldPreventAction;\nmodule.link(\"../hooks/useShouldPreventAction\", {\n  useShouldPreventAction: function (v) {\n    useShouldPreventAction = v;\n  }\n}, 12);\nvar emptyContextValue = {\n  inquiries: {\n    enabled: false\n  },\n  enabled: false,\n  isEnterprise: false,\n  agentAvailable: false,\n  showOmnichannelQueueLink: false,\n  isOverMacLimit: false,\n  livechatPriorities: {\n    enabled: false,\n    data: [],\n    isLoading: false,\n    isError: false\n  }\n};\nvar OmnichannelProvider = function (_ref) {\n  var _useSetting;\n  var children = _ref.children;\n  var omniChannelEnabled = useSetting('Livechat_enabled');\n  var omnichannelRouting = useSetting('Livechat_Routing_Method');\n  var showOmnichannelQueueLink = useSetting('Livechat_show_queue_list_link');\n  var omnichannelPoolMaxIncoming = (_useSetting = useSetting('Livechat_guest_pool_max_number_incoming_livechats_displayed')) !== null && _useSetting !== void 0 ? _useSetting : 0;\n  var omnichannelSortingMechanism = useSetting('Omnichannel_sorting_mechanism');\n  var loggerRef = useRef(new ClientLogger('OmnichannelProvider'));\n  var hasAccess = usePermission('view-l-room');\n  var canViewOmnichannelQueue = usePermission('view-livechat-queue');\n  var user = useUser();\n  var agentAvailable = (user === null || user === void 0 ? void 0 : user.statusLivechat) === 'available';\n  var voipCallAvailable = true; // TODO: use backend check;\n  var getRoutingConfig = useMethod('livechat:getRoutingConfig');\n  var _useSafely = useSafely(useState(undefined)),\n    _useSafely2 = _slicedToArray(_useSafely, 2),\n    routeConfig = _useSafely2[0],\n    setRouteConfig = _useSafely2[1];\n  var _useState = useState(new Set()),\n    _useState2 = _slicedToArray(_useState, 2),\n    queueNotification = _useState2[0],\n    setQueueNotification = _useState2[1];\n  var accessible = hasAccess && omniChannelEnabled;\n  var iceServersSetting = useSetting('WebRTC_Servers');\n  var isEnterprise = useHasLicenseModule('livechat-enterprise') === true;\n  var getPriorities = useEndpoint('GET', '/v1/livechat/priorities');\n  var subscribe = useStream('notify-logged');\n  var queryClient = useQueryClient();\n  var isPrioritiesEnabled = isEnterprise && accessible;\n  var enabled = accessible && !!user && !!routeConfig;\n  var _useQuery = useQuery(['/v1/livechat/priorities'], function () {\n      return getPriorities({\n        sort: JSON.stringify({\n          sortItem: 1\n        })\n      });\n    }, {\n      staleTime: Infinity,\n      enabled: isPrioritiesEnabled\n    }),\n    _useQuery$data = _useQuery.data;\n  _useQuery$data = _useQuery$data === void 0 ? {} : _useQuery$data;\n  var _useQuery$data$priori = _useQuery$data.priorities,\n    priorities = _useQuery$data$priori === void 0 ? [] : _useQuery$data$priori,\n    isLoadingPriorities = _useQuery.isInitialLoading,\n    isErrorPriorities = _useQuery.isError;\n  var isOverMacLimit = useShouldPreventAction('monthlyActiveContacts');\n  useEffect(function () {\n    if (!isPrioritiesEnabled) {\n      return;\n    }\n    return subscribe('omnichannel.priority-changed', function () {\n      queryClient.invalidateQueries(['/v1/livechat/priorities']);\n    });\n  }, [isPrioritiesEnabled, queryClient, subscribe]);\n  useEffect(function () {\n    if (!accessible) {\n      return;\n    }\n    var update = function () {\n      function _callee() {\n        var _routeConfig;\n        return _regeneratorRuntime.async(function () {\n          function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return _regeneratorRuntime.awrap(getRoutingConfig());\n              case 3:\n                _routeConfig = _context.sent;\n                setRouteConfig(_routeConfig);\n                _context.next = 10;\n                break;\n              case 7:\n                _context.prev = 7;\n                _context.t0 = _context[\"catch\"](0);\n                loggerRef.current.error(\"update() error in routeConfig \" + _context.t0);\n              case 10:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n          return _callee$;\n        }(), null, null, [[0, 7]], Promise);\n      }\n      return _callee;\n    }();\n    if (omnichannelRouting || !omnichannelRouting) {\n      update();\n    }\n  }, [accessible, getRoutingConfig, iceServersSetting, omnichannelRouting, setRouteConfig, voipCallAvailable]);\n  var manuallySelected = enabled && canViewOmnichannelQueue && !!routeConfig && routeConfig.showQueue && !routeConfig.autoAssignAgent && agentAvailable;\n  var streamNotifyUser = useStream('notify-user');\n  useEffect(function () {\n    if (!manuallySelected) {\n      return;\n    }\n    var handleDepartmentAgentData = function () {\n      initializeLivechatInquiryStream(user === null || user === void 0 ? void 0 : user._id);\n    };\n    initializeLivechatInquiryStream(user === null || user === void 0 ? void 0 : user._id);\n    if (!(user !== null && user !== void 0 && user._id)) {\n      return;\n    }\n    return streamNotifyUser(user._id + \"/departmentAgentData\", handleDepartmentAgentData);\n  }, [manuallySelected, streamNotifyUser, user === null || user === void 0 ? void 0 : user._id]);\n  var queue = useReactiveValue(useCallback(function () {\n    if (!manuallySelected) {\n      return undefined;\n    }\n    return LivechatInquiry.find({\n      status: 'queued'\n    }, {\n      sort: getOmniChatSortQuery(omnichannelSortingMechanism),\n      limit: omnichannelPoolMaxIncoming\n    }).fetch();\n  }, [manuallySelected, omnichannelPoolMaxIncoming, omnichannelSortingMechanism]));\n  queue === null || queue === void 0 ? void 0 : queue.map(function (_ref2) {\n    var rid = _ref2.rid;\n    if (queueNotification.has(rid)) {\n      return;\n    }\n    setQueueNotification(function (prev) {\n      return new Set([].concat(_toConsumableArray(prev), [rid]));\n    });\n    return KonchatNotification.newRoom(rid);\n  });\n  var contextValue = useMemo(function () {\n    if (!enabled) {\n      return emptyContextValue;\n    }\n    var livechatPriorities = {\n      enabled: isPrioritiesEnabled,\n      data: priorities,\n      isLoading: isLoadingPriorities,\n      isError: isErrorPriorities\n    };\n    if (!manuallySelected) {\n      return _objectSpread(_objectSpread({}, emptyContextValue), {}, {\n        enabled: true,\n        isEnterprise: isEnterprise,\n        agentAvailable: agentAvailable,\n        voipCallAvailable: voipCallAvailable,\n        routeConfig: routeConfig,\n        livechatPriorities: livechatPriorities,\n        isOverMacLimit: isOverMacLimit\n      });\n    }\n    return _objectSpread(_objectSpread({}, emptyContextValue), {}, {\n      enabled: true,\n      isEnterprise: isEnterprise,\n      agentAvailable: agentAvailable,\n      voipCallAvailable: voipCallAvailable,\n      routeConfig: routeConfig,\n      inquiries: queue ? {\n        enabled: true,\n        queue: queue\n      } : {\n        enabled: false\n      },\n      showOmnichannelQueueLink: showOmnichannelQueueLink && !!agentAvailable,\n      livechatPriorities: livechatPriorities,\n      isOverMacLimit: isOverMacLimit\n    });\n  }, [enabled, isPrioritiesEnabled, priorities, isLoadingPriorities, isErrorPriorities, manuallySelected, isEnterprise, agentAvailable, voipCallAvailable, routeConfig, queue, showOmnichannelQueueLink, isOverMacLimit]);\n  return /*#__PURE__*/React.createElement(OmnichannelContext.Provider, {\n    children: children,\n    value: contextValue\n  });\n};\nmodule.exportDefault( /*#__PURE__*/memo(OmnichannelProvider));","map":{"version":3,"names":["_regeneratorRuntime","module","link","default","v","_objectSpread","_toConsumableArray","_slicedToArray","useSafely","useUser","useSetting","usePermission","useMethod","useEndpoint","useStream","useQuery","useQueryClient","React","useState","useEffect","useMemo","useCallback","memo","useRef","LivechatInquiry","initializeLivechatInquiryStream","getOmniChatSortQuery","KonchatNotification","ClientLogger","OmnichannelContext","useHasLicenseModule","useReactiveValue","useShouldPreventAction","emptyContextValue","inquiries","enabled","isEnterprise","agentAvailable","showOmnichannelQueueLink","isOverMacLimit","livechatPriorities","data","isLoading","isError","OmnichannelProvider","_ref","_useSetting","children","omniChannelEnabled","omnichannelRouting","omnichannelPoolMaxIncoming","omnichannelSortingMechanism","loggerRef","hasAccess","canViewOmnichannelQueue","user","statusLivechat","voipCallAvailable","getRoutingConfig","_useSafely","undefined","_useSafely2","routeConfig","setRouteConfig","_useState","Set","_useState2","queueNotification","setQueueNotification","accessible","iceServersSetting","getPriorities","subscribe","queryClient","isPrioritiesEnabled","_useQuery","sort","JSON","stringify","sortItem","staleTime","Infinity","_useQuery$data","_useQuery$data$priori","priorities","isLoadingPriorities","isInitialLoading","isErrorPriorities","invalidateQueries","update","_callee","_routeConfig","async","_callee$","_context","prev","next","awrap","sent","t0","current","error","stop","Promise","manuallySelected","showQueue","autoAssignAgent","streamNotifyUser","handleDepartmentAgentData","_id","queue","find","status","limit","fetch","map","_ref2","rid","has","concat","newRoom","contextValue","createElement","Provider","value","exportDefault"],"sources":["client/providers/OmnichannelProvider.tsx"],"sourcesContent":["import type {\n\tIOmnichannelAgent,\n\tOmichannelRoutingConfig,\n\tOmnichannelSortingMechanismSettingType,\n\tILivechatInquiryRecord,\n} from '@rocket.chat/core-typings';\nimport { useSafely } from '@rocket.chat/fuselage-hooks';\nimport { useUser, useSetting, usePermission, useMethod, useEndpoint, useStream } from '@rocket.chat/ui-contexts';\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\nimport type { ReactNode } from 'react';\nimport React, { useState, useEffect, useMemo, useCallback, memo, useRef } from 'react';\n\nimport { LivechatInquiry } from '../../app/livechat/client/collections/LivechatInquiry';\nimport { initializeLivechatInquiryStream } from '../../app/livechat/client/lib/stream/queueManager';\nimport { getOmniChatSortQuery } from '../../app/livechat/lib/inquiries';\nimport { KonchatNotification } from '../../app/ui/client/lib/KonchatNotification';\nimport { ClientLogger } from '../../lib/ClientLogger';\nimport type { OmnichannelContextValue } from '../contexts/OmnichannelContext';\nimport { OmnichannelContext } from '../contexts/OmnichannelContext';\nimport { useHasLicenseModule } from '../hooks/useHasLicenseModule';\nimport { useReactiveValue } from '../hooks/useReactiveValue';\nimport { useShouldPreventAction } from '../hooks/useShouldPreventAction';\n\nconst emptyContextValue: OmnichannelContextValue = {\n\tinquiries: { enabled: false },\n\tenabled: false,\n\tisEnterprise: false,\n\tagentAvailable: false,\n\tshowOmnichannelQueueLink: false,\n\tisOverMacLimit: false,\n\tlivechatPriorities: {\n\t\tenabled: false,\n\t\tdata: [],\n\t\tisLoading: false,\n\t\tisError: false,\n\t},\n};\n\ntype OmnichannelProviderProps = {\n\tchildren?: ReactNode;\n};\n\nconst OmnichannelProvider = ({ children }: OmnichannelProviderProps) => {\n\tconst omniChannelEnabled = useSetting('Livechat_enabled') as boolean;\n\tconst omnichannelRouting = useSetting('Livechat_Routing_Method');\n\tconst showOmnichannelQueueLink = useSetting('Livechat_show_queue_list_link') as boolean;\n\tconst omnichannelPoolMaxIncoming = useSetting<number>('Livechat_guest_pool_max_number_incoming_livechats_displayed') ?? 0;\n\tconst omnichannelSortingMechanism = useSetting('Omnichannel_sorting_mechanism') as OmnichannelSortingMechanismSettingType;\n\n\tconst loggerRef = useRef(new ClientLogger('OmnichannelProvider'));\n\tconst hasAccess = usePermission('view-l-room');\n\tconst canViewOmnichannelQueue = usePermission('view-livechat-queue');\n\tconst user = useUser() as IOmnichannelAgent;\n\n\tconst agentAvailable = user?.statusLivechat === 'available';\n\tconst voipCallAvailable = true; // TODO: use backend check;\n\n\tconst getRoutingConfig = useMethod('livechat:getRoutingConfig');\n\n\tconst [routeConfig, setRouteConfig] = useSafely(useState<OmichannelRoutingConfig | undefined>(undefined));\n\tconst [queueNotification, setQueueNotification] = useState(new Set());\n\n\tconst accessible = hasAccess && omniChannelEnabled;\n\tconst iceServersSetting: any = useSetting('WebRTC_Servers');\n\tconst isEnterprise = useHasLicenseModule('livechat-enterprise') === true;\n\n\tconst getPriorities = useEndpoint('GET', '/v1/livechat/priorities');\n\tconst subscribe = useStream('notify-logged');\n\tconst queryClient = useQueryClient();\n\tconst isPrioritiesEnabled = isEnterprise && accessible;\n\tconst enabled = accessible && !!user && !!routeConfig;\n\n\tconst {\n\t\tdata: { priorities = [] } = {},\n\t\tisInitialLoading: isLoadingPriorities,\n\t\tisError: isErrorPriorities,\n\t} = useQuery(['/v1/livechat/priorities'], () => getPriorities({ sort: JSON.stringify({ sortItem: 1 }) }), {\n\t\tstaleTime: Infinity,\n\t\tenabled: isPrioritiesEnabled,\n\t});\n\n\tconst isOverMacLimit = useShouldPreventAction('monthlyActiveContacts');\n\n\tuseEffect(() => {\n\t\tif (!isPrioritiesEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn subscribe('omnichannel.priority-changed', () => {\n\t\t\tqueryClient.invalidateQueries(['/v1/livechat/priorities']);\n\t\t});\n\t}, [isPrioritiesEnabled, queryClient, subscribe]);\n\n\tuseEffect(() => {\n\t\tif (!accessible) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst update = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tconst routeConfig = await getRoutingConfig();\n\t\t\t\tsetRouteConfig(routeConfig);\n\t\t\t} catch (error) {\n\t\t\t\tloggerRef.current.error(`update() error in routeConfig ${error}`);\n\t\t\t}\n\t\t};\n\n\t\tif (omnichannelRouting || !omnichannelRouting) {\n\t\t\tupdate();\n\t\t}\n\t}, [accessible, getRoutingConfig, iceServersSetting, omnichannelRouting, setRouteConfig, voipCallAvailable]);\n\n\tconst manuallySelected =\n\t\tenabled && canViewOmnichannelQueue && !!routeConfig && routeConfig.showQueue && !routeConfig.autoAssignAgent && agentAvailable;\n\n\tconst streamNotifyUser = useStream('notify-user');\n\tuseEffect(() => {\n\t\tif (!manuallySelected) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst handleDepartmentAgentData = (): void => {\n\t\t\tinitializeLivechatInquiryStream(user?._id);\n\t\t};\n\n\t\tinitializeLivechatInquiryStream(user?._id);\n\t\tif (!user?._id) {\n\t\t\treturn;\n\t\t}\n\t\treturn streamNotifyUser(`${user._id}/departmentAgentData`, handleDepartmentAgentData);\n\t}, [manuallySelected, streamNotifyUser, user?._id]);\n\n\tconst queue = useReactiveValue<ILivechatInquiryRecord[] | undefined>(\n\t\tuseCallback(() => {\n\t\t\tif (!manuallySelected) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn LivechatInquiry.find(\n\t\t\t\t{ status: 'queued' },\n\t\t\t\t{\n\t\t\t\t\tsort: getOmniChatSortQuery(omnichannelSortingMechanism),\n\t\t\t\t\tlimit: omnichannelPoolMaxIncoming,\n\t\t\t\t},\n\t\t\t).fetch();\n\t\t}, [manuallySelected, omnichannelPoolMaxIncoming, omnichannelSortingMechanism]),\n\t);\n\n\tqueue?.map(({ rid }) => {\n\t\tif (queueNotification.has(rid)) {\n\t\t\treturn;\n\t\t}\n\t\tsetQueueNotification((prev) => new Set([...prev, rid]));\n\t\treturn KonchatNotification.newRoom(rid);\n\t});\n\n\tconst contextValue = useMemo<OmnichannelContextValue>(() => {\n\t\tif (!enabled) {\n\t\t\treturn emptyContextValue;\n\t\t}\n\n\t\tconst livechatPriorities = {\n\t\t\tenabled: isPrioritiesEnabled,\n\t\t\tdata: priorities,\n\t\t\tisLoading: isLoadingPriorities,\n\t\t\tisError: isErrorPriorities,\n\t\t};\n\n\t\tif (!manuallySelected) {\n\t\t\treturn {\n\t\t\t\t...emptyContextValue,\n\t\t\t\tenabled: true,\n\t\t\t\tisEnterprise,\n\t\t\t\tagentAvailable,\n\t\t\t\tvoipCallAvailable,\n\t\t\t\trouteConfig,\n\t\t\t\tlivechatPriorities,\n\t\t\t\tisOverMacLimit,\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\t...emptyContextValue,\n\t\t\tenabled: true,\n\t\t\tisEnterprise,\n\t\t\tagentAvailable,\n\t\t\tvoipCallAvailable,\n\t\t\trouteConfig,\n\t\t\tinquiries: queue\n\t\t\t\t? {\n\t\t\t\t\t\tenabled: true,\n\t\t\t\t\t\tqueue,\n\t\t\t\t  }\n\t\t\t\t: { enabled: false },\n\t\t\tshowOmnichannelQueueLink: showOmnichannelQueueLink && !!agentAvailable,\n\t\t\tlivechatPriorities,\n\t\t\tisOverMacLimit,\n\t\t};\n\t}, [\n\t\tenabled,\n\t\tisPrioritiesEnabled,\n\t\tpriorities,\n\t\tisLoadingPriorities,\n\t\tisErrorPriorities,\n\t\tmanuallySelected,\n\t\tisEnterprise,\n\t\tagentAvailable,\n\t\tvoipCallAvailable,\n\t\trouteConfig,\n\t\tqueue,\n\t\tshowOmnichannelQueueLink,\n\t\tisOverMacLimit,\n\t]);\n\n\treturn <OmnichannelContext.Provider children={children} value={contextValue} />;\n};\n\nexport default memo<typeof OmnichannelProvider>(OmnichannelProvider);\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"d690db4f870bff9efcc2e4277228e6c54a1bd6b9"}
