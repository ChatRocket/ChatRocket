{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/omnichannel/directory/chats/contextualBar/RoomEdit/RoomEdit.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/views/omnichannel/directory/chats/contextualBar/RoomEdit/RoomEdit.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/omnichannel/directory/chats/contextualBar/RoomEdit/RoomEdit.tsx","inputSourceMap":{"version":3,"file":"client/views/omnichannel/directory/chats/contextualBar/RoomEdit/RoomEdit.tsx","sourceRoot":"","sources":["client/views/omnichannel/directory/chats/contextualBar/RoomEdit/RoomEdit.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { ILivechatVisitor, IOmnichannelRoom, Serialized } from '@rocket.chat/core-typings';\nimport { Field, FieldLabel, FieldRow, TextInput, ButtonGroup, Button } from '@rocket.chat/fuselage';\nimport { CustomFieldsForm } from '@rocket.chat/ui-client';\nimport { useToastMessageDispatch, useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useQueryClient } from '@tanstack/react-query';\nimport React, { useCallback } from 'react';\nimport { useController, useForm } from 'react-hook-form';\n\nimport { hasAtLeastOnePermission } from '../../../../../../../app/authorization/client';\nimport { ContextualbarFooter, ContextualbarScrollableContent } from '../../../../../../components/Contextualbar';\nimport Tags from '../../../../../../components/Omnichannel/Tags';\nimport { useOmnichannelPriorities } from '../../../../../../omnichannel/hooks/useOmnichannelPriorities';\nimport { SlaPoliciesSelect, PrioritiesSelect } from '../../../../additionalForms';\nimport { FormSkeleton } from '../../../components/FormSkeleton';\nimport { useCustomFieldsMetadata } from '../../../hooks/useCustomFieldsMetadata';\nimport { useSlaPolicies } from '../../../hooks/useSlaPolicies';\n\ntype RoomEditProps = {\n\troom: Serialized<IOmnichannelRoom>;\n\tvisitor: Serialized<ILivechatVisitor>;\n\treload?: () => void;\n\treloadInfo?: () => void;\n\tonClose: () => void;\n};\n\nconst ROOM_INTIAL_VALUE = {\n\ttopic: '',\n\ttags: [],\n\tlivechatData: {},\n\tslaId: '',\n};\n\nconst getInitialValuesRoom = (room: Serialized<IOmnichannelRoom>) => {\n\tconst { topic, tags, livechatData, slaId, priorityId } = room ?? ROOM_INTIAL_VALUE;\n\n\treturn {\n\t\ttopic: topic ?? '',\n\t\ttags: tags ?? [],\n\t\tlivechatData: livechatData ?? {},\n\t\tslaId: slaId ?? '',\n\t\tpriorityId: priorityId ?? '',\n\t};\n};\n\nfunction RoomEdit({ room, visitor, reload, reloadInfo, onClose }: RoomEditProps) {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst queryClient = useQueryClient();\n\tconst canViewCustomFields = hasAtLeastOnePermission(['view-livechat-room-customfields', 'edit-livechat-room-customfields']);\n\n\tconst saveRoom = useEndpoint('POST', '/v1/livechat/room.saveInfo');\n\n\tconst { data: slaPolicies, isInitialLoading: isSlaPoliciesLoading } = useSlaPolicies();\n\tconst { data: customFieldsMetadata, isInitialLoading: isCustomFieldsLoading } = useCustomFieldsMetadata({\n\t\tscope: 'room',\n\t\tenabled: canViewCustomFields,\n\t});\n\tconst { data: priorities, isLoading: isPrioritiesLoading } = useOmnichannelPriorities();\n\n\tconst {\n\t\tregister,\n\t\tcontrol,\n\t\tformState: { isDirty: isFormDirty, isValid: isFormValid, isSubmitting },\n\t\thandleSubmit,\n\t} = useForm({\n\t\tmode: 'onChange',\n\t\tdefaultValues: getInitialValuesRoom(room),\n\t});\n\n\tconst { field: tagsField } = useController({ control, name: 'tags' });\n\tconst { field: slaIdField } = useController({ control, name: 'slaId' });\n\tconst { field: priorityIdField } = useController({ control, name: 'priorityId' });\n\n\tconst handleSave = useCallback(\n\t\tasync (data) => {\n\t\t\tif (!isFormValid) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { topic, tags, livechatData, slaId, priorityId } = data;\n\n\t\t\tconst guestData = {\n\t\t\t\t_id: visitor._id,\n\t\t\t};\n\n\t\t\tconst roomData = {\n\t\t\t\t_id: room._id,\n\t\t\t\ttopic,\n\t\t\t\ttags: tags.sort(),\n\t\t\t\tlivechatData,\n\t\t\t\tpriorityId,\n\t\t\t\t...(slaId && { slaId }),\n\t\t\t};\n\n\t\t\ttry {\n\t\t\t\tawait saveRoom({ guestData, roomData });\n\t\t\t\tawait queryClient.invalidateQueries(['/v1/rooms.info', room._id]);\n\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\t\treload?.();\n\t\t\t\treloadInfo?.();\n\t\t\t\tonClose();\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t},\n\t\t[dispatchToastMessage, isFormValid, onClose, queryClient, reload, reloadInfo, room._id, saveRoom, t, visitor._id],\n\t);\n\n\tif (isCustomFieldsLoading || isSlaPoliciesLoading || isPrioritiesLoading) {\n\t\treturn (\n\t\t\t<ContextualbarScrollableContent>\n\t\t\t\t<FormSkeleton />\n\t\t\t</ContextualbarScrollableContent>\n\t\t);\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarScrollableContent is='form' onSubmit={handleSubmit(handleSave)}>\n\t\t\t\t{canViewCustomFields && customFieldsMetadata && (\n\t\t\t\t\t<CustomFieldsForm formName='livechatData' formControl={control} metadata={customFieldsMetadata} />\n\t\t\t\t)}\n\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel>{t('Topic')}</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput {...register('topic')} flexGrow={1} />\n\t\t\t\t\t</FieldRow>\n\t\t\t\t</Field>\n\n\t\t\t\t<Field>\n\t\t\t\t\t<Tags tags={tagsField.value} handler={tagsField.onChange} department={room.departmentId} />\n\t\t\t\t</Field>\n\n\t\t\t\t{SlaPoliciesSelect && !!slaPolicies?.length && (\n\t\t\t\t\t<SlaPoliciesSelect label={t('SLA_Policy')} value={slaIdField.value} options={slaPolicies} onChange={slaIdField.onChange} />\n\t\t\t\t)}\n\n\t\t\t\t{PrioritiesSelect && !!priorities?.length && (\n\t\t\t\t\t<PrioritiesSelect label={t('Priority')} value={priorityIdField.value} options={priorities} onChange={priorityIdField.onChange} />\n\t\t\t\t)}\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button flexGrow={1} onClick={onClose}>\n\t\t\t\t\t\t{t('Cancel')}\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t<Button\n\t\t\t\t\t\tmie='none'\n\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\tonClick={handleSubmit(handleSave)}\n\t\t\t\t\t\tloading={isSubmitting}\n\t\t\t\t\t\tdisabled={!isFormValid || !isFormDirty}\n\t\t\t\t\t\tprimary\n\t\t\t\t\t>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</>\n\t);\n}\n\nexport default RoomEdit;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/omnichannel/directory/chats/contextualBar/RoomEdit/RoomEdit.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/omnichannel/directory/chats/contextualBar/RoomEdit/RoomEdit.tsx","inputSourceMap":{"version":3,"file":"client/views/omnichannel/directory/chats/contextualBar/RoomEdit/RoomEdit.tsx","sourceRoot":"","sources":["client/views/omnichannel/directory/chats/contextualBar/RoomEdit/RoomEdit.tsx"],"names":[],"mappings":"AACA,OAAO,EAAE,KAAK,EAAE,UAAU,EAAE,QAAQ,EAAE,SAAS,EAAE,WAAW,EAAE,MAAM,EAAE,MAAM,uBAAuB,CAAC;AACpG,OAAO,EAAE,gBAAgB,EAAE,MAAM,wBAAwB,CAAC;AAC1D,OAAO,EAAE,uBAAuB,EAAE,cAAc,EAAE,WAAW,EAAE,MAAM,0BAA0B,CAAC;AAChG,OAAO,EAAE,cAAc,EAAE,MAAM,uBAAuB,CAAC;AACvD,OAAO,KAAK,EAAE,EAAE,WAAW,EAAE,MAAM,OAAO,CAAC;AAC3C,OAAO,EAAE,aAAa,EAAE,OAAO,EAAE,MAAM,iBAAiB,CAAC;AAEzD,OAAO,EAAE,uBAAuB,EAAE,MAAM,+CAA+C,CAAC;AACxF,OAAO,EAAE,mBAAmB,EAAE,8BAA8B,EAAE,MAAM,4CAA4C,CAAC;AACjH,OAAO,IAAI,MAAM,+CAA+C,CAAC;AACjE,OAAO,EAAE,wBAAwB,EAAE,MAAM,8DAA8D,CAAC;AACxG,OAAO,EAAE,iBAAiB,EAAE,gBAAgB,EAAE,MAAM,6BAA6B,CAAC;AAClF,OAAO,EAAE,YAAY,EAAE,MAAM,kCAAkC,CAAC;AAChE,OAAO,EAAE,uBAAuB,EAAE,MAAM,wCAAwC,CAAC;AACjF,OAAO,EAAE,cAAc,EAAE,MAAM,+BAA+B,CAAC;AAU/D,MAAM,iBAAiB,GAAG;IACzB,KAAK,EAAE,EAAE;IACT,IAAI,EAAE,EAAE;IACR,YAAY,EAAE,EAAE;IAChB,KAAK,EAAE,EAAE;CACT,CAAC;AAEF,MAAM,oBAAoB,GAAG,CAAC,IAAkC,EAAE,EAAE;IACnE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,YAAY,EAAE,KAAK,EAAE,UAAU,EAAE,GAAG,IAAI,IAAI,iBAAiB,CAAC;IAEnF,OAAO;QACN,KAAK,EAAE,KAAK,IAAI,EAAE;QAClB,IAAI,EAAE,IAAI,IAAI,EAAE;QAChB,YAAY,EAAE,YAAY,IAAI,EAAE;QAChC,KAAK,EAAE,KAAK,IAAI,EAAE;QAClB,UAAU,EAAE,UAAU,IAAI,EAAE;KAC5B,CAAC;AACH,CAAC,CAAC;AAEF,SAAS,QAAQ,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,MAAM,EAAE,UAAU,EAAE,OAAO,EAAiB;IAC9E,MAAM,CAAC,GAAG,cAAc,EAAE,CAAC;IAC3B,MAAM,oBAAoB,GAAG,uBAAuB,EAAE,CAAC;IACvD,MAAM,WAAW,GAAG,cAAc,EAAE,CAAC;IACrC,MAAM,mBAAmB,GAAG,uBAAuB,CAAC,CAAC,iCAAiC,EAAE,iCAAiC,CAAC,CAAC,CAAC;IAE5H,MAAM,QAAQ,GAAG,WAAW,CAAC,MAAM,EAAE,4BAA4B,CAAC,CAAC;IAEnE,MAAM,EAAE,IAAI,EAAE,WAAW,EAAE,gBAAgB,EAAE,oBAAoB,EAAE,GAAG,cAAc,EAAE,CAAC;IACvF,MAAM,EAAE,IAAI,EAAE,oBAAoB,EAAE,gBAAgB,EAAE,qBAAqB,EAAE,GAAG,uBAAuB,CAAC;QACvG,KAAK,EAAE,MAAM;QACb,OAAO,EAAE,mBAAmB;KAC5B,CAAC,CAAC;IACH,MAAM,EAAE,IAAI,EAAE,UAAU,EAAE,SAAS,EAAE,mBAAmB,EAAE,GAAG,wBAAwB,EAAE,CAAC;IAExF,MAAM,EACL,QAAQ,EACR,OAAO,EACP,SAAS,EAAE,EAAE,OAAO,EAAE,WAAW,EAAE,OAAO,EAAE,WAAW,EAAE,YAAY,EAAE,EACvE,YAAY,GACZ,GAAG,OAAO,CAAC;QACX,IAAI,EAAE,UAAU;QAChB,aAAa,EAAE,oBAAoB,CAAC,IAAI,CAAC;KACzC,CAAC,CAAC;IAEH,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,aAAa,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;IACtE,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE,GAAG,aAAa,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;IACxE,MAAM,EAAE,KAAK,EAAE,eAAe,EAAE,GAAG,aAAa,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,YAAY,EAAE,CAAC,CAAC;IAElF,MAAM,UAAU,GAAG,WAAW,CAC7B,KAAK,EAAE,IAAI,EAAE,EAAE;QACd,IAAI,CAAC,WAAW,EAAE,CAAC;YAClB,OAAO;QACR,CAAC;QAED,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,YAAY,EAAE,KAAK,EAAE,UAAU,EAAE,GAAG,IAAI,CAAC;QAE9D,MAAM,SAAS,GAAG;YACjB,GAAG,EAAE,OAAO,CAAC,GAAG;SAChB,CAAC;QAEF,MAAM,QAAQ,GAAG;YAChB,GAAG,EAAE,IAAI,CAAC,GAAG;YACb,KAAK;YACL,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE;YACjB,YAAY;YACZ,UAAU;YACV,GAAG,CAAC,KAAK,IAAI,EAAE,KAAK,EAAE,CAAC;SACvB,CAAC;QAEF,IAAI,CAAC;YACJ,MAAM,QAAQ,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,CAAC,CAAC;YACxC,MAAM,WAAW,CAAC,iBAAiB,CAAC,CAAC,gBAAgB,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;YAElE,oBAAoB,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;YAC/D,MAAM,EAAE,EAAE,CAAC;YACX,UAAU,EAAE,EAAE,CAAC;YACf,OAAO,EAAE,CAAC;QACX,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YAChB,oBAAoB,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC;QACzD,CAAC;IACF,CAAC,EACD,CAAC,oBAAoB,EAAE,WAAW,EAAE,OAAO,EAAE,WAAW,EAAE,MAAM,EAAE,UAAU,EAAE,IAAI,CAAC,GAAG,EAAE,QAAQ,EAAE,CAAC,EAAE,OAAO,CAAC,GAAG,CAAC,CACjH,CAAC;IAEF,IAAI,qBAAqB,IAAI,oBAAoB,IAAI,mBAAmB,EAAE,CAAC;QAC1E,OAAO,CACN,CAAC,8BAA8B,CAC9B;IAAA,CAAC,YAAY,CAAC,AAAD,EACd;GAAA,EAAE,8BAA8B,CAAC,CACjC,CAAC;IACH,CAAC;IAED,OAAO,CACN,EACC;GAAA,CAAC,8BAA8B,CAAC,EAAE,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC,CAC5E;IAAA,CAAC,mBAAmB,IAAI,oBAAoB,IAAI,CAC/C,CAAC,gBAAgB,CAAC,QAAQ,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC,CAAC,oBAAoB,CAAC,EAAG,CAClG,CAED;;IAAA,CAAC,KAAK,CACL;KAAA,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,EAAE,UAAU,CACpC;KAAA,CAAC,QAAQ,CACR;MAAA,CAAC,SAAS,CAAC,IAAI,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,EAC/C;KAAA,EAAE,QAAQ,CACX;IAAA,EAAE,KAAK,CAEP;;IAAA,CAAC,KAAK,CACL;KAAA,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,EACzF;IAAA,EAAE,KAAK,CAEP;;IAAA,CAAC,iBAAiB,IAAI,CAAC,CAAC,WAAW,EAAE,MAAM,IAAI,CAC9C,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC,CAAC,UAAU,CAAC,QAAQ,CAAC,EAAG,CAC3H,CAED;;IAAA,CAAC,gBAAgB,IAAI,CAAC,CAAC,UAAU,EAAE,MAAM,IAAI,CAC5C,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC,UAAU,CAAC,CAAC,QAAQ,CAAC,CAAC,eAAe,CAAC,QAAQ,CAAC,EAAG,CACjI,CACF;GAAA,EAAE,8BAA8B,CAChC;GAAA,CAAC,mBAAmB,CACnB;IAAA,CAAC,WAAW,CAAC,OAAO,CACnB;KAAA,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,CACrC;MAAA,CAAC,CAAC,CAAC,QAAQ,CAAC,CACb;KAAA,EAAE,MAAM,CAER;;KAAA,CAAC,MAAM,CACN,GAAG,CAAC,MAAM,CACV,QAAQ,CAAC,CAAC,CAAC,CAAC,CACZ,OAAO,CAAC,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC,CAClC,OAAO,CAAC,CAAC,YAAY,CAAC,CACtB,QAAQ,CAAC,CAAC,CAAC,WAAW,IAAI,CAAC,WAAW,CAAC,CACvC,OAAO,CAEP;MAAA,CAAC,CAAC,CAAC,MAAM,CAAC,CACX;KAAA,EAAE,MAAM,CACT;IAAA,EAAE,WAAW,CACd;GAAA,EAAE,mBAAmB,CACtB;EAAA,GAAG,CACH,CAAC;AACH,CAAC;AAED,eAAe,QAAQ,CAAC","sourcesContent":["import type { ILivechatVisitor, IOmnichannelRoom, Serialized } from '@rocket.chat/core-typings';\nimport { Field, FieldLabel, FieldRow, TextInput, ButtonGroup, Button } from '@rocket.chat/fuselage';\nimport { CustomFieldsForm } from '@rocket.chat/ui-client';\nimport { useToastMessageDispatch, useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useQueryClient } from '@tanstack/react-query';\nimport React, { useCallback } from 'react';\nimport { useController, useForm } from 'react-hook-form';\n\nimport { hasAtLeastOnePermission } from '../../../../../../../app/authorization/client';\nimport { ContextualbarFooter, ContextualbarScrollableContent } from '../../../../../../components/Contextualbar';\nimport Tags from '../../../../../../components/Omnichannel/Tags';\nimport { useOmnichannelPriorities } from '../../../../../../omnichannel/hooks/useOmnichannelPriorities';\nimport { SlaPoliciesSelect, PrioritiesSelect } from '../../../../additionalForms';\nimport { FormSkeleton } from '../../../components/FormSkeleton';\nimport { useCustomFieldsMetadata } from '../../../hooks/useCustomFieldsMetadata';\nimport { useSlaPolicies } from '../../../hooks/useSlaPolicies';\n\ntype RoomEditProps = {\n\troom: Serialized<IOmnichannelRoom>;\n\tvisitor: Serialized<ILivechatVisitor>;\n\treload?: () => void;\n\treloadInfo?: () => void;\n\tonClose: () => void;\n};\n\nconst ROOM_INTIAL_VALUE = {\n\ttopic: '',\n\ttags: [],\n\tlivechatData: {},\n\tslaId: '',\n};\n\nconst getInitialValuesRoom = (room: Serialized<IOmnichannelRoom>) => {\n\tconst { topic, tags, livechatData, slaId, priorityId } = room ?? ROOM_INTIAL_VALUE;\n\n\treturn {\n\t\ttopic: topic ?? '',\n\t\ttags: tags ?? [],\n\t\tlivechatData: livechatData ?? {},\n\t\tslaId: slaId ?? '',\n\t\tpriorityId: priorityId ?? '',\n\t};\n};\n\nfunction RoomEdit({ room, visitor, reload, reloadInfo, onClose }: RoomEditProps) {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst queryClient = useQueryClient();\n\tconst canViewCustomFields = hasAtLeastOnePermission(['view-livechat-room-customfields', 'edit-livechat-room-customfields']);\n\n\tconst saveRoom = useEndpoint('POST', '/v1/livechat/room.saveInfo');\n\n\tconst { data: slaPolicies, isInitialLoading: isSlaPoliciesLoading } = useSlaPolicies();\n\tconst { data: customFieldsMetadata, isInitialLoading: isCustomFieldsLoading } = useCustomFieldsMetadata({\n\t\tscope: 'room',\n\t\tenabled: canViewCustomFields,\n\t});\n\tconst { data: priorities, isLoading: isPrioritiesLoading } = useOmnichannelPriorities();\n\n\tconst {\n\t\tregister,\n\t\tcontrol,\n\t\tformState: { isDirty: isFormDirty, isValid: isFormValid, isSubmitting },\n\t\thandleSubmit,\n\t} = useForm({\n\t\tmode: 'onChange',\n\t\tdefaultValues: getInitialValuesRoom(room),\n\t});\n\n\tconst { field: tagsField } = useController({ control, name: 'tags' });\n\tconst { field: slaIdField } = useController({ control, name: 'slaId' });\n\tconst { field: priorityIdField } = useController({ control, name: 'priorityId' });\n\n\tconst handleSave = useCallback(\n\t\tasync (data) => {\n\t\t\tif (!isFormValid) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { topic, tags, livechatData, slaId, priorityId } = data;\n\n\t\t\tconst guestData = {\n\t\t\t\t_id: visitor._id,\n\t\t\t};\n\n\t\t\tconst roomData = {\n\t\t\t\t_id: room._id,\n\t\t\t\ttopic,\n\t\t\t\ttags: tags.sort(),\n\t\t\t\tlivechatData,\n\t\t\t\tpriorityId,\n\t\t\t\t...(slaId && { slaId }),\n\t\t\t};\n\n\t\t\ttry {\n\t\t\t\tawait saveRoom({ guestData, roomData });\n\t\t\t\tawait queryClient.invalidateQueries(['/v1/rooms.info', room._id]);\n\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\t\treload?.();\n\t\t\t\treloadInfo?.();\n\t\t\t\tonClose();\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t},\n\t\t[dispatchToastMessage, isFormValid, onClose, queryClient, reload, reloadInfo, room._id, saveRoom, t, visitor._id],\n\t);\n\n\tif (isCustomFieldsLoading || isSlaPoliciesLoading || isPrioritiesLoading) {\n\t\treturn (\n\t\t\t<ContextualbarScrollableContent>\n\t\t\t\t<FormSkeleton />\n\t\t\t</ContextualbarScrollableContent>\n\t\t);\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarScrollableContent is='form' onSubmit={handleSubmit(handleSave)}>\n\t\t\t\t{canViewCustomFields && customFieldsMetadata && (\n\t\t\t\t\t<CustomFieldsForm formName='livechatData' formControl={control} metadata={customFieldsMetadata} />\n\t\t\t\t)}\n\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel>{t('Topic')}</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput {...register('topic')} flexGrow={1} />\n\t\t\t\t\t</FieldRow>\n\t\t\t\t</Field>\n\n\t\t\t\t<Field>\n\t\t\t\t\t<Tags tags={tagsField.value} handler={tagsField.onChange} department={room.departmentId} />\n\t\t\t\t</Field>\n\n\t\t\t\t{SlaPoliciesSelect && !!slaPolicies?.length && (\n\t\t\t\t\t<SlaPoliciesSelect label={t('SLA_Policy')} value={slaIdField.value} options={slaPolicies} onChange={slaIdField.onChange} />\n\t\t\t\t)}\n\n\t\t\t\t{PrioritiesSelect && !!priorities?.length && (\n\t\t\t\t\t<PrioritiesSelect label={t('Priority')} value={priorityIdField.value} options={priorities} onChange={priorityIdField.onChange} />\n\t\t\t\t)}\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button flexGrow={1} onClick={onClose}>\n\t\t\t\t\t\t{t('Cancel')}\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t<Button\n\t\t\t\t\t\tmie='none'\n\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\tonClick={handleSubmit(handleSave)}\n\t\t\t\t\t\tloading={isSubmitting}\n\t\t\t\t\t\tdisabled={!isFormValid || !isFormDirty}\n\t\t\t\t\t\tprimary\n\t\t\t\t\t>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</>\n\t);\n}\n\nexport default RoomEdit;\n"]}}},"code":"let _extends;\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default(v) {\n    _extends = v;\n  }\n}, 0);\nlet _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n}, 1);\nlet Field, FieldLabel, FieldRow, TextInput, ButtonGroup, Button;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Field(v) {\n    Field = v;\n  },\n  FieldLabel(v) {\n    FieldLabel = v;\n  },\n  FieldRow(v) {\n    FieldRow = v;\n  },\n  TextInput(v) {\n    TextInput = v;\n  },\n  ButtonGroup(v) {\n    ButtonGroup = v;\n  },\n  Button(v) {\n    Button = v;\n  }\n}, 0);\nlet CustomFieldsForm;\nmodule.link(\"@rocket.chat/ui-client\", {\n  CustomFieldsForm(v) {\n    CustomFieldsForm = v;\n  }\n}, 1);\nlet useToastMessageDispatch, useTranslation, useEndpoint;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useToastMessageDispatch(v) {\n    useToastMessageDispatch = v;\n  },\n  useTranslation(v) {\n    useTranslation = v;\n  },\n  useEndpoint(v) {\n    useEndpoint = v;\n  }\n}, 2);\nlet useQueryClient;\nmodule.link(\"@tanstack/react-query\", {\n  useQueryClient(v) {\n    useQueryClient = v;\n  }\n}, 3);\nlet React, useCallback;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n  useCallback(v) {\n    useCallback = v;\n  }\n}, 4);\nlet useController, useForm;\nmodule.link(\"react-hook-form\", {\n  useController(v) {\n    useController = v;\n  },\n  useForm(v) {\n    useForm = v;\n  }\n}, 5);\nlet hasAtLeastOnePermission;\nmodule.link(\"../../../../../../../app/authorization/client\", {\n  hasAtLeastOnePermission(v) {\n    hasAtLeastOnePermission = v;\n  }\n}, 6);\nlet ContextualbarFooter, ContextualbarScrollableContent;\nmodule.link(\"../../../../../../components/Contextualbar\", {\n  ContextualbarFooter(v) {\n    ContextualbarFooter = v;\n  },\n  ContextualbarScrollableContent(v) {\n    ContextualbarScrollableContent = v;\n  }\n}, 7);\nlet Tags;\nmodule.link(\"../../../../../../components/Omnichannel/Tags\", {\n  default(v) {\n    Tags = v;\n  }\n}, 8);\nlet useOmnichannelPriorities;\nmodule.link(\"../../../../../../omnichannel/hooks/useOmnichannelPriorities\", {\n  useOmnichannelPriorities(v) {\n    useOmnichannelPriorities = v;\n  }\n}, 9);\nlet SlaPoliciesSelect, PrioritiesSelect;\nmodule.link(\"../../../../additionalForms\", {\n  SlaPoliciesSelect(v) {\n    SlaPoliciesSelect = v;\n  },\n  PrioritiesSelect(v) {\n    PrioritiesSelect = v;\n  }\n}, 10);\nlet FormSkeleton;\nmodule.link(\"../../../components/FormSkeleton\", {\n  FormSkeleton(v) {\n    FormSkeleton = v;\n  }\n}, 11);\nlet useCustomFieldsMetadata;\nmodule.link(\"../../../hooks/useCustomFieldsMetadata\", {\n  useCustomFieldsMetadata(v) {\n    useCustomFieldsMetadata = v;\n  }\n}, 12);\nlet useSlaPolicies;\nmodule.link(\"../../../hooks/useSlaPolicies\", {\n  useSlaPolicies(v) {\n    useSlaPolicies = v;\n  }\n}, 13);\nconst ROOM_INTIAL_VALUE = {\n  topic: '',\n  tags: [],\n  livechatData: {},\n  slaId: ''\n};\nconst getInitialValuesRoom = room => {\n  const {\n    topic,\n    tags,\n    livechatData,\n    slaId,\n    priorityId\n  } = room !== null && room !== void 0 ? room : ROOM_INTIAL_VALUE;\n  return {\n    topic: topic !== null && topic !== void 0 ? topic : '',\n    tags: tags !== null && tags !== void 0 ? tags : [],\n    livechatData: livechatData !== null && livechatData !== void 0 ? livechatData : {},\n    slaId: slaId !== null && slaId !== void 0 ? slaId : '',\n    priorityId: priorityId !== null && priorityId !== void 0 ? priorityId : ''\n  };\n};\nfunction RoomEdit(_ref) {\n  let {\n    room,\n    visitor,\n    reload,\n    reloadInfo,\n    onClose\n  } = _ref;\n  const t = useTranslation();\n  const dispatchToastMessage = useToastMessageDispatch();\n  const queryClient = useQueryClient();\n  const canViewCustomFields = hasAtLeastOnePermission(['view-livechat-room-customfields', 'edit-livechat-room-customfields']);\n  const saveRoom = useEndpoint('POST', '/v1/livechat/room.saveInfo');\n  const {\n    data: slaPolicies,\n    isInitialLoading: isSlaPoliciesLoading\n  } = useSlaPolicies();\n  const {\n    data: customFieldsMetadata,\n    isInitialLoading: isCustomFieldsLoading\n  } = useCustomFieldsMetadata({\n    scope: 'room',\n    enabled: canViewCustomFields\n  });\n  const {\n    data: priorities,\n    isLoading: isPrioritiesLoading\n  } = useOmnichannelPriorities();\n  const {\n    register,\n    control,\n    formState: {\n      isDirty: isFormDirty,\n      isValid: isFormValid,\n      isSubmitting\n    },\n    handleSubmit\n  } = useForm({\n    mode: 'onChange',\n    defaultValues: getInitialValuesRoom(room)\n  });\n  const {\n    field: tagsField\n  } = useController({\n    control,\n    name: 'tags'\n  });\n  const {\n    field: slaIdField\n  } = useController({\n    control,\n    name: 'slaId'\n  });\n  const {\n    field: priorityIdField\n  } = useController({\n    control,\n    name: 'priorityId'\n  });\n  const handleSave = useCallback(async data => {\n    if (!isFormValid) {\n      return;\n    }\n    const {\n      topic,\n      tags,\n      livechatData,\n      slaId,\n      priorityId\n    } = data;\n    const guestData = {\n      _id: visitor._id\n    };\n    const roomData = _objectSpread({\n      _id: room._id,\n      topic,\n      tags: tags.sort(),\n      livechatData,\n      priorityId\n    }, slaId && {\n      slaId\n    });\n    try {\n      await saveRoom({\n        guestData,\n        roomData\n      });\n      await queryClient.invalidateQueries(['/v1/rooms.info', room._id]);\n      dispatchToastMessage({\n        type: 'success',\n        message: t('Saved')\n      });\n      reload === null || reload === void 0 ? void 0 : reload();\n      reloadInfo === null || reloadInfo === void 0 ? void 0 : reloadInfo();\n      onClose();\n    } catch (error) {\n      dispatchToastMessage({\n        type: 'error',\n        message: error\n      });\n    }\n  }, [dispatchToastMessage, isFormValid, onClose, queryClient, reload, reloadInfo, room._id, saveRoom, t, visitor._id]);\n  if (isCustomFieldsLoading || isSlaPoliciesLoading || isPrioritiesLoading) {\n    return /*#__PURE__*/React.createElement(ContextualbarScrollableContent, null, /*#__PURE__*/React.createElement(FormSkeleton, null));\n  }\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ContextualbarScrollableContent, {\n    is: \"form\",\n    onSubmit: handleSubmit(handleSave)\n  }, canViewCustomFields && customFieldsMetadata && /*#__PURE__*/React.createElement(CustomFieldsForm, {\n    formName: \"livechatData\",\n    formControl: control,\n    metadata: customFieldsMetadata\n  }), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(FieldLabel, null, t('Topic')), /*#__PURE__*/React.createElement(FieldRow, null, /*#__PURE__*/React.createElement(TextInput, _extends({}, register('topic'), {\n    flexGrow: 1\n  })))), /*#__PURE__*/React.createElement(Field, null, /*#__PURE__*/React.createElement(Tags, {\n    tags: tagsField.value,\n    handler: tagsField.onChange,\n    department: room.departmentId\n  })), SlaPoliciesSelect && !!(slaPolicies !== null && slaPolicies !== void 0 && slaPolicies.length) && /*#__PURE__*/React.createElement(SlaPoliciesSelect, {\n    label: t('SLA_Policy'),\n    value: slaIdField.value,\n    options: slaPolicies,\n    onChange: slaIdField.onChange\n  }), PrioritiesSelect && !!(priorities !== null && priorities !== void 0 && priorities.length) && /*#__PURE__*/React.createElement(PrioritiesSelect, {\n    label: t('Priority'),\n    value: priorityIdField.value,\n    options: priorities,\n    onChange: priorityIdField.onChange\n  })), /*#__PURE__*/React.createElement(ContextualbarFooter, null, /*#__PURE__*/React.createElement(ButtonGroup, {\n    stretch: true\n  }, /*#__PURE__*/React.createElement(Button, {\n    flexGrow: 1,\n    onClick: onClose\n  }, t('Cancel')), /*#__PURE__*/React.createElement(Button, {\n    mie: \"none\",\n    flexGrow: 1,\n    onClick: handleSubmit(handleSave),\n    loading: isSubmitting,\n    disabled: !isFormValid || !isFormDirty,\n    primary: true\n  }, t('Save')))));\n}\nmodule.exportDefault(RoomEdit);","map":{"version":3,"names":["_extends","module","link","default","v","_objectSpread","Field","FieldLabel","FieldRow","TextInput","ButtonGroup","Button","CustomFieldsForm","useToastMessageDispatch","useTranslation","useEndpoint","useQueryClient","React","useCallback","useController","useForm","hasAtLeastOnePermission","ContextualbarFooter","ContextualbarScrollableContent","Tags","useOmnichannelPriorities","SlaPoliciesSelect","PrioritiesSelect","FormSkeleton","useCustomFieldsMetadata","useSlaPolicies","ROOM_INTIAL_VALUE","topic","tags","livechatData","slaId","getInitialValuesRoom","room","priorityId","RoomEdit","_ref","visitor","reload","reloadInfo","onClose","t","dispatchToastMessage","queryClient","canViewCustomFields","saveRoom","data","slaPolicies","isInitialLoading","isSlaPoliciesLoading","customFieldsMetadata","isCustomFieldsLoading","scope","enabled","priorities","isLoading","isPrioritiesLoading","register","control","formState","isDirty","isFormDirty","isValid","isFormValid","isSubmitting","handleSubmit","mode","defaultValues","field","tagsField","name","slaIdField","priorityIdField","handleSave","guestData","_id","roomData","sort","invalidateQueries","type","message","error","createElement","Fragment","is","onSubmit","formName","formControl","metadata","flexGrow","value","handler","onChange","department","departmentId","length","label","options","stretch","onClick","mie","loading","disabled","primary","exportDefault"],"sources":["client/views/omnichannel/directory/chats/contextualBar/RoomEdit/RoomEdit.tsx"],"sourcesContent":["import type { ILivechatVisitor, IOmnichannelRoom, Serialized } from '@rocket.chat/core-typings';\nimport { Field, FieldLabel, FieldRow, TextInput, ButtonGroup, Button } from '@rocket.chat/fuselage';\nimport { CustomFieldsForm } from '@rocket.chat/ui-client';\nimport { useToastMessageDispatch, useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useQueryClient } from '@tanstack/react-query';\nimport React, { useCallback } from 'react';\nimport { useController, useForm } from 'react-hook-form';\n\nimport { hasAtLeastOnePermission } from '../../../../../../../app/authorization/client';\nimport { ContextualbarFooter, ContextualbarScrollableContent } from '../../../../../../components/Contextualbar';\nimport Tags from '../../../../../../components/Omnichannel/Tags';\nimport { useOmnichannelPriorities } from '../../../../../../omnichannel/hooks/useOmnichannelPriorities';\nimport { SlaPoliciesSelect, PrioritiesSelect } from '../../../../additionalForms';\nimport { FormSkeleton } from '../../../components/FormSkeleton';\nimport { useCustomFieldsMetadata } from '../../../hooks/useCustomFieldsMetadata';\nimport { useSlaPolicies } from '../../../hooks/useSlaPolicies';\n\ntype RoomEditProps = {\n\troom: Serialized<IOmnichannelRoom>;\n\tvisitor: Serialized<ILivechatVisitor>;\n\treload?: () => void;\n\treloadInfo?: () => void;\n\tonClose: () => void;\n};\n\nconst ROOM_INTIAL_VALUE = {\n\ttopic: '',\n\ttags: [],\n\tlivechatData: {},\n\tslaId: '',\n};\n\nconst getInitialValuesRoom = (room: Serialized<IOmnichannelRoom>) => {\n\tconst { topic, tags, livechatData, slaId, priorityId } = room ?? ROOM_INTIAL_VALUE;\n\n\treturn {\n\t\ttopic: topic ?? '',\n\t\ttags: tags ?? [],\n\t\tlivechatData: livechatData ?? {},\n\t\tslaId: slaId ?? '',\n\t\tpriorityId: priorityId ?? '',\n\t};\n};\n\nfunction RoomEdit({ room, visitor, reload, reloadInfo, onClose }: RoomEditProps) {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst queryClient = useQueryClient();\n\tconst canViewCustomFields = hasAtLeastOnePermission(['view-livechat-room-customfields', 'edit-livechat-room-customfields']);\n\n\tconst saveRoom = useEndpoint('POST', '/v1/livechat/room.saveInfo');\n\n\tconst { data: slaPolicies, isInitialLoading: isSlaPoliciesLoading } = useSlaPolicies();\n\tconst { data: customFieldsMetadata, isInitialLoading: isCustomFieldsLoading } = useCustomFieldsMetadata({\n\t\tscope: 'room',\n\t\tenabled: canViewCustomFields,\n\t});\n\tconst { data: priorities, isLoading: isPrioritiesLoading } = useOmnichannelPriorities();\n\n\tconst {\n\t\tregister,\n\t\tcontrol,\n\t\tformState: { isDirty: isFormDirty, isValid: isFormValid, isSubmitting },\n\t\thandleSubmit,\n\t} = useForm({\n\t\tmode: 'onChange',\n\t\tdefaultValues: getInitialValuesRoom(room),\n\t});\n\n\tconst { field: tagsField } = useController({ control, name: 'tags' });\n\tconst { field: slaIdField } = useController({ control, name: 'slaId' });\n\tconst { field: priorityIdField } = useController({ control, name: 'priorityId' });\n\n\tconst handleSave = useCallback(\n\t\tasync (data) => {\n\t\t\tif (!isFormValid) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { topic, tags, livechatData, slaId, priorityId } = data;\n\n\t\t\tconst guestData = {\n\t\t\t\t_id: visitor._id,\n\t\t\t};\n\n\t\t\tconst roomData = {\n\t\t\t\t_id: room._id,\n\t\t\t\ttopic,\n\t\t\t\ttags: tags.sort(),\n\t\t\t\tlivechatData,\n\t\t\t\tpriorityId,\n\t\t\t\t...(slaId && { slaId }),\n\t\t\t};\n\n\t\t\ttry {\n\t\t\t\tawait saveRoom({ guestData, roomData });\n\t\t\t\tawait queryClient.invalidateQueries(['/v1/rooms.info', room._id]);\n\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\t\treload?.();\n\t\t\t\treloadInfo?.();\n\t\t\t\tonClose();\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t},\n\t\t[dispatchToastMessage, isFormValid, onClose, queryClient, reload, reloadInfo, room._id, saveRoom, t, visitor._id],\n\t);\n\n\tif (isCustomFieldsLoading || isSlaPoliciesLoading || isPrioritiesLoading) {\n\t\treturn (\n\t\t\t<ContextualbarScrollableContent>\n\t\t\t\t<FormSkeleton />\n\t\t\t</ContextualbarScrollableContent>\n\t\t);\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarScrollableContent is='form' onSubmit={handleSubmit(handleSave)}>\n\t\t\t\t{canViewCustomFields && customFieldsMetadata && (\n\t\t\t\t\t<CustomFieldsForm formName='livechatData' formControl={control} metadata={customFieldsMetadata} />\n\t\t\t\t)}\n\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel>{t('Topic')}</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput {...register('topic')} flexGrow={1} />\n\t\t\t\t\t</FieldRow>\n\t\t\t\t</Field>\n\n\t\t\t\t<Field>\n\t\t\t\t\t<Tags tags={tagsField.value} handler={tagsField.onChange} department={room.departmentId} />\n\t\t\t\t</Field>\n\n\t\t\t\t{SlaPoliciesSelect && !!slaPolicies?.length && (\n\t\t\t\t\t<SlaPoliciesSelect label={t('SLA_Policy')} value={slaIdField.value} options={slaPolicies} onChange={slaIdField.onChange} />\n\t\t\t\t)}\n\n\t\t\t\t{PrioritiesSelect && !!priorities?.length && (\n\t\t\t\t\t<PrioritiesSelect label={t('Priority')} value={priorityIdField.value} options={priorities} onChange={priorityIdField.onChange} />\n\t\t\t\t)}\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button flexGrow={1} onClick={onClose}>\n\t\t\t\t\t\t{t('Cancel')}\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t<Button\n\t\t\t\t\t\tmie='none'\n\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\tonClick={handleSubmit(handleSave)}\n\t\t\t\t\t\tloading={isSubmitting}\n\t\t\t\t\t\tdisabled={!isFormValid || !isFormDirty}\n\t\t\t\t\t\tprimary\n\t\t\t\t\t>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</>\n\t);\n}\n\nexport default RoomEdit;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"07e3bde42a1094ce921dab37c9737b182187842d"}
