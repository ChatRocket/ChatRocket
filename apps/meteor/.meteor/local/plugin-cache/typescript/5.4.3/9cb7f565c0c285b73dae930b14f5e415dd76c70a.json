{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/providers/RoomProvider.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/room/providers/RoomProvider.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/providers/RoomProvider.tsx","inputSourceMap":{"version":3,"file":"client/views/room/providers/RoomProvider.tsx","sourceRoot":"","sources":["client/views/room/providers/RoomProvider.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { useRouter } from '@rocket.chat/ui-contexts';\nimport type { ReactNode, ContextType, ReactElement } from 'react';\nimport React, { useMemo, memo, useEffect, useCallback } from 'react';\n\nimport { ChatSubscription } from '../../../../app/models/client';\nimport { RoomHistoryManager } from '../../../../app/ui-utils/client';\nimport { UserAction } from '../../../../app/ui/client/lib/UserAction';\nimport { useReactiveQuery } from '../../../hooks/useReactiveQuery';\nimport { useReactiveValue } from '../../../hooks/useReactiveValue';\nimport { useRoomInfoEndpoint } from '../../../hooks/useRoomInfoEndpoint';\nimport { useSidePanelNavigation } from '../../../hooks/useSidePanelNavigation';\nimport { RoomManager } from '../../../lib/RoomManager';\nimport { roomCoordinator } from '../../../lib/rooms/roomCoordinator';\nimport ImageGalleryProvider from '../../../providers/ImageGalleryProvider';\nimport RoomNotFound from '../RoomNotFound';\nimport RoomSkeleton from '../RoomSkeleton';\nimport { useRoomRolesManagement } from '../body/hooks/useRoomRolesManagement';\nimport type { IRoomWithFederationOriginalName } from '../contexts/RoomContext';\nimport { RoomContext } from '../contexts/RoomContext';\nimport ComposerPopupProvider from './ComposerPopupProvider';\nimport RoomToolboxProvider from './RoomToolboxProvider';\nimport UserCardProvider from './UserCardProvider';\nimport { useRedirectOnSettingsChanged } from './hooks/useRedirectOnSettingsChanged';\nimport { useRoomQuery } from './hooks/useRoomQuery';\nimport { useUsersNameChanged } from './hooks/useUsersNameChanged';\n\ntype RoomProviderProps = {\n\tchildren: ReactNode;\n\trid: IRoom['_id'];\n};\n\nconst RoomProvider = ({ rid, children }: RoomProviderProps): ReactElement => {\n\tuseRoomRolesManagement(rid);\n\n\tconst resultFromServer = useRoomInfoEndpoint(rid);\n\n\tconst resultFromLocal = useRoomQuery(rid);\n\n\t// TODO: the following effect is a workaround while we don't have a general and definitive solution for it\n\tconst router = useRouter();\n\tuseEffect(() => {\n\t\tif (resultFromLocal.isSuccess && !resultFromLocal.data) {\n\t\t\trouter.navigate('/home');\n\t\t}\n\t}, [resultFromLocal.data, resultFromLocal.isSuccess, resultFromServer, router]);\n\n\tconst subscriptionQuery = useReactiveQuery(['subscriptions', { rid }], () => ChatSubscription.findOne({ rid }) ?? null);\n\n\tuseRedirectOnSettingsChanged(subscriptionQuery.data);\n\n\tuseUsersNameChanged();\n\n\tconst pseudoRoom: IRoomWithFederationOriginalName | null = useMemo(() => {\n\t\tconst room = resultFromLocal.data;\n\t\tif (!room) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\t...subscriptionQuery.data,\n\t\t\t...room,\n\t\t\tname: roomCoordinator.getRoomName(room.t, room),\n\t\t\tfederationOriginalName: room.name,\n\t\t};\n\t}, [resultFromLocal.data, subscriptionQuery.data]);\n\n\tconst { hasMorePreviousMessages, hasMoreNextMessages, isLoadingMoreMessages } = useReactiveValue(\n\t\tuseCallback(() => {\n\t\t\tconst { hasMore, hasMoreNext, isLoading } = RoomHistoryManager.getRoom(rid);\n\n\t\t\treturn {\n\t\t\t\thasMorePreviousMessages: hasMore.get(),\n\t\t\t\thasMoreNextMessages: hasMoreNext.get(),\n\t\t\t\tisLoadingMoreMessages: isLoading.get(),\n\t\t\t};\n\t\t}, [rid]),\n\t);\n\n\tconst context = useMemo((): ContextType<typeof RoomContext> => {\n\t\tif (!pseudoRoom) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\trid,\n\t\t\troom: pseudoRoom,\n\t\t\tsubscription: subscriptionQuery.data ?? undefined,\n\t\t\thasMorePreviousMessages,\n\t\t\thasMoreNextMessages,\n\t\t\tisLoadingMoreMessages,\n\t\t};\n\t}, [hasMoreNextMessages, hasMorePreviousMessages, isLoadingMoreMessages, pseudoRoom, rid, subscriptionQuery.data]);\n\n\tconst isSidepanelFeatureEnabled = useSidePanelNavigation();\n\n\tuseEffect(() => {\n\t\tif (isSidepanelFeatureEnabled) {\n\t\t\tif (resultFromServer.isSuccess) {\n\t\t\t\tif (resultFromServer.data.room?.teamMain) {\n\t\t\t\t\tif (\n\t\t\t\t\t\tresultFromServer.data.room.sidepanel?.items.includes('channels') ||\n\t\t\t\t\t\tresultFromServer.data.room?.sidepanel?.items.includes('discussions')\n\t\t\t\t\t) {\n\t\t\t\t\t\tRoomManager.openSecondLevel(rid, rid);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tRoomManager.open(rid);\n\t\t\t\t\t}\n\t\t\t\t\treturn (): void => {\n\t\t\t\t\t\tRoomManager.back(rid);\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tswitch (true) {\n\t\t\t\t\tcase resultFromServer.data.room?.prid &&\n\t\t\t\t\t\tresultFromServer.data.parent &&\n\t\t\t\t\t\tresultFromServer.data.parent.sidepanel?.items.includes('discussions'):\n\t\t\t\t\t\tRoomManager.openSecondLevel(resultFromServer.data.parent._id, rid);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase resultFromServer.data.team?.roomId &&\n\t\t\t\t\t\t!resultFromServer.data.room?.teamMain &&\n\t\t\t\t\t\tresultFromServer.data.parent?.sidepanel?.items.includes('channels'):\n\t\t\t\t\t\tRoomManager.openSecondLevel(resultFromServer.data.team.roomId, rid);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tresultFromServer.data.parent?.sidepanel?.items.includes('channels') ||\n\t\t\t\t\t\t\tresultFromServer.data.parent?.sidepanel?.items.includes('discussions')\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tRoomManager.openSecondLevel(rid, rid);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tRoomManager.open(rid);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn (): void => {\n\t\t\t\tRoomManager.back(rid);\n\t\t\t};\n\t\t}\n\n\t\tRoomManager.open(rid);\n\t\treturn (): void => {\n\t\t\tRoomManager.back(rid);\n\t\t};\n\t}, [\n\t\tisSidepanelFeatureEnabled,\n\t\trid,\n\t\tresultFromServer.data?.room?.prid,\n\t\tresultFromServer.data?.room?.teamId,\n\t\tresultFromServer.data?.room?.teamMain,\n\t\tresultFromServer.isSuccess,\n\t\tresultFromServer.data?.parent,\n\t\tresultFromServer.data?.team?.roomId,\n\t\tresultFromServer.data,\n\t]);\n\n\tconst subscribed = !!subscriptionQuery.data;\n\n\tuseEffect(() => {\n\t\tif (!subscribed) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn UserAction.addStream(rid);\n\t}, [rid, subscribed]);\n\n\tif (!pseudoRoom) {\n\t\treturn resultFromLocal.isSuccess && !resultFromLocal.data ? <RoomNotFound /> : <RoomSkeleton />;\n\t}\n\n\treturn (\n\t\t<RoomContext.Provider value={context}>\n\t\t\t<RoomToolboxProvider>\n\t\t\t\t<ImageGalleryProvider>\n\t\t\t\t\t<UserCardProvider>\n\t\t\t\t\t\t<ComposerPopupProvider room={pseudoRoom}>{children}</ComposerPopupProvider>\n\t\t\t\t\t</UserCardProvider>\n\t\t\t\t</ImageGalleryProvider>\n\t\t\t</RoomToolboxProvider>\n\t\t</RoomContext.Provider>\n\t);\n};\n\nexport default memo(RoomProvider);\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/providers/RoomProvider.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/providers/RoomProvider.tsx","inputSourceMap":{"version":3,"file":"client/views/room/providers/RoomProvider.tsx","sourceRoot":"","sources":["client/views/room/providers/RoomProvider.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { useRouter } from '@rocket.chat/ui-contexts';\nimport type { ReactNode, ContextType, ReactElement } from 'react';\nimport React, { useMemo, memo, useEffect, useCallback } from 'react';\n\nimport { ChatSubscription } from '../../../../app/models/client';\nimport { RoomHistoryManager } from '../../../../app/ui-utils/client';\nimport { UserAction } from '../../../../app/ui/client/lib/UserAction';\nimport { useReactiveQuery } from '../../../hooks/useReactiveQuery';\nimport { useReactiveValue } from '../../../hooks/useReactiveValue';\nimport { useRoomInfoEndpoint } from '../../../hooks/useRoomInfoEndpoint';\nimport { useSidePanelNavigation } from '../../../hooks/useSidePanelNavigation';\nimport { RoomManager } from '../../../lib/RoomManager';\nimport { roomCoordinator } from '../../../lib/rooms/roomCoordinator';\nimport ImageGalleryProvider from '../../../providers/ImageGalleryProvider';\nimport RoomNotFound from '../RoomNotFound';\nimport RoomSkeleton from '../RoomSkeleton';\nimport { useRoomRolesManagement } from '../body/hooks/useRoomRolesManagement';\nimport type { IRoomWithFederationOriginalName } from '../contexts/RoomContext';\nimport { RoomContext } from '../contexts/RoomContext';\nimport ComposerPopupProvider from './ComposerPopupProvider';\nimport RoomToolboxProvider from './RoomToolboxProvider';\nimport UserCardProvider from './UserCardProvider';\nimport { useRedirectOnSettingsChanged } from './hooks/useRedirectOnSettingsChanged';\nimport { useRoomQuery } from './hooks/useRoomQuery';\nimport { useUsersNameChanged } from './hooks/useUsersNameChanged';\n\ntype RoomProviderProps = {\n\tchildren: ReactNode;\n\trid: IRoom['_id'];\n};\n\nconst RoomProvider = ({ rid, children }: RoomProviderProps): ReactElement => {\n\tuseRoomRolesManagement(rid);\n\n\tconst resultFromServer = useRoomInfoEndpoint(rid);\n\n\tconst resultFromLocal = useRoomQuery(rid);\n\n\t// TODO: the following effect is a workaround while we don't have a general and definitive solution for it\n\tconst router = useRouter();\n\tuseEffect(() => {\n\t\tif (resultFromLocal.isSuccess && !resultFromLocal.data) {\n\t\t\trouter.navigate('/home');\n\t\t}\n\t}, [resultFromLocal.data, resultFromLocal.isSuccess, resultFromServer, router]);\n\n\tconst subscriptionQuery = useReactiveQuery(['subscriptions', { rid }], () => ChatSubscription.findOne({ rid }) ?? null);\n\n\tuseRedirectOnSettingsChanged(subscriptionQuery.data);\n\n\tuseUsersNameChanged();\n\n\tconst pseudoRoom: IRoomWithFederationOriginalName | null = useMemo(() => {\n\t\tconst room = resultFromLocal.data;\n\t\tif (!room) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\t...subscriptionQuery.data,\n\t\t\t...room,\n\t\t\tname: roomCoordinator.getRoomName(room.t, room),\n\t\t\tfederationOriginalName: room.name,\n\t\t};\n\t}, [resultFromLocal.data, subscriptionQuery.data]);\n\n\tconst { hasMorePreviousMessages, hasMoreNextMessages, isLoadingMoreMessages } = useReactiveValue(\n\t\tuseCallback(() => {\n\t\t\tconst { hasMore, hasMoreNext, isLoading } = RoomHistoryManager.getRoom(rid);\n\n\t\t\treturn {\n\t\t\t\thasMorePreviousMessages: hasMore.get(),\n\t\t\t\thasMoreNextMessages: hasMoreNext.get(),\n\t\t\t\tisLoadingMoreMessages: isLoading.get(),\n\t\t\t};\n\t\t}, [rid]),\n\t);\n\n\tconst context = useMemo((): ContextType<typeof RoomContext> => {\n\t\tif (!pseudoRoom) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\trid,\n\t\t\troom: pseudoRoom,\n\t\t\tsubscription: subscriptionQuery.data ?? undefined,\n\t\t\thasMorePreviousMessages,\n\t\t\thasMoreNextMessages,\n\t\t\tisLoadingMoreMessages,\n\t\t};\n\t}, [hasMoreNextMessages, hasMorePreviousMessages, isLoadingMoreMessages, pseudoRoom, rid, subscriptionQuery.data]);\n\n\tconst isSidepanelFeatureEnabled = useSidePanelNavigation();\n\n\tuseEffect(() => {\n\t\tif (isSidepanelFeatureEnabled) {\n\t\t\tif (resultFromServer.isSuccess) {\n\t\t\t\tif (resultFromServer.data.room?.teamMain) {\n\t\t\t\t\tif (\n\t\t\t\t\t\tresultFromServer.data.room.sidepanel?.items.includes('channels') ||\n\t\t\t\t\t\tresultFromServer.data.room?.sidepanel?.items.includes('discussions')\n\t\t\t\t\t) {\n\t\t\t\t\t\tRoomManager.openSecondLevel(rid, rid);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tRoomManager.open(rid);\n\t\t\t\t\t}\n\t\t\t\t\treturn (): void => {\n\t\t\t\t\t\tRoomManager.back(rid);\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tswitch (true) {\n\t\t\t\t\tcase resultFromServer.data.room?.prid &&\n\t\t\t\t\t\tresultFromServer.data.parent &&\n\t\t\t\t\t\tresultFromServer.data.parent.sidepanel?.items.includes('discussions'):\n\t\t\t\t\t\tRoomManager.openSecondLevel(resultFromServer.data.parent._id, rid);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase resultFromServer.data.team?.roomId &&\n\t\t\t\t\t\t!resultFromServer.data.room?.teamMain &&\n\t\t\t\t\t\tresultFromServer.data.parent?.sidepanel?.items.includes('channels'):\n\t\t\t\t\t\tRoomManager.openSecondLevel(resultFromServer.data.team.roomId, rid);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tresultFromServer.data.parent?.sidepanel?.items.includes('channels') ||\n\t\t\t\t\t\t\tresultFromServer.data.parent?.sidepanel?.items.includes('discussions')\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tRoomManager.openSecondLevel(rid, rid);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tRoomManager.open(rid);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn (): void => {\n\t\t\t\tRoomManager.back(rid);\n\t\t\t};\n\t\t}\n\n\t\tRoomManager.open(rid);\n\t\treturn (): void => {\n\t\t\tRoomManager.back(rid);\n\t\t};\n\t}, [\n\t\tisSidepanelFeatureEnabled,\n\t\trid,\n\t\tresultFromServer.data?.room?.prid,\n\t\tresultFromServer.data?.room?.teamId,\n\t\tresultFromServer.data?.room?.teamMain,\n\t\tresultFromServer.isSuccess,\n\t\tresultFromServer.data?.parent,\n\t\tresultFromServer.data?.team?.roomId,\n\t\tresultFromServer.data,\n\t]);\n\n\tconst subscribed = !!subscriptionQuery.data;\n\n\tuseEffect(() => {\n\t\tif (!subscribed) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn UserAction.addStream(rid);\n\t}, [rid, subscribed]);\n\n\tif (!pseudoRoom) {\n\t\treturn resultFromLocal.isSuccess && !resultFromLocal.data ? <RoomNotFound /> : <RoomSkeleton />;\n\t}\n\n\treturn (\n\t\t<RoomContext.Provider value={context}>\n\t\t\t<RoomToolboxProvider>\n\t\t\t\t<ImageGalleryProvider>\n\t\t\t\t\t<UserCardProvider>\n\t\t\t\t\t\t<ComposerPopupProvider room={pseudoRoom}>{children}</ComposerPopupProvider>\n\t\t\t\t\t</UserCardProvider>\n\t\t\t\t</ImageGalleryProvider>\n\t\t\t</RoomToolboxProvider>\n\t\t</RoomContext.Provider>\n\t);\n};\n\nexport default memo(RoomProvider);\n"]}}},"code":"var _objectSpread;\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default: function (v) {\n    _objectSpread = v;\n  }\n}, 0);\nvar useRouter;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useRouter: function (v) {\n    useRouter = v;\n  }\n}, 0);\nvar React, useMemo, memo, useEffect, useCallback;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  },\n  memo: function (v) {\n    memo = v;\n  },\n  useEffect: function (v) {\n    useEffect = v;\n  },\n  useCallback: function (v) {\n    useCallback = v;\n  }\n}, 1);\nvar ChatSubscription;\nmodule.link(\"../../../../app/models/client\", {\n  ChatSubscription: function (v) {\n    ChatSubscription = v;\n  }\n}, 2);\nvar RoomHistoryManager;\nmodule.link(\"../../../../app/ui-utils/client\", {\n  RoomHistoryManager: function (v) {\n    RoomHistoryManager = v;\n  }\n}, 3);\nvar UserAction;\nmodule.link(\"../../../../app/ui/client/lib/UserAction\", {\n  UserAction: function (v) {\n    UserAction = v;\n  }\n}, 4);\nvar useReactiveQuery;\nmodule.link(\"../../../hooks/useReactiveQuery\", {\n  useReactiveQuery: function (v) {\n    useReactiveQuery = v;\n  }\n}, 5);\nvar useReactiveValue;\nmodule.link(\"../../../hooks/useReactiveValue\", {\n  useReactiveValue: function (v) {\n    useReactiveValue = v;\n  }\n}, 6);\nvar useRoomInfoEndpoint;\nmodule.link(\"../../../hooks/useRoomInfoEndpoint\", {\n  useRoomInfoEndpoint: function (v) {\n    useRoomInfoEndpoint = v;\n  }\n}, 7);\nvar useSidePanelNavigation;\nmodule.link(\"../../../hooks/useSidePanelNavigation\", {\n  useSidePanelNavigation: function (v) {\n    useSidePanelNavigation = v;\n  }\n}, 8);\nvar RoomManager;\nmodule.link(\"../../../lib/RoomManager\", {\n  RoomManager: function (v) {\n    RoomManager = v;\n  }\n}, 9);\nvar roomCoordinator;\nmodule.link(\"../../../lib/rooms/roomCoordinator\", {\n  roomCoordinator: function (v) {\n    roomCoordinator = v;\n  }\n}, 10);\nvar ImageGalleryProvider;\nmodule.link(\"../../../providers/ImageGalleryProvider\", {\n  \"default\": function (v) {\n    ImageGalleryProvider = v;\n  }\n}, 11);\nvar RoomNotFound;\nmodule.link(\"../RoomNotFound\", {\n  \"default\": function (v) {\n    RoomNotFound = v;\n  }\n}, 12);\nvar RoomSkeleton;\nmodule.link(\"../RoomSkeleton\", {\n  \"default\": function (v) {\n    RoomSkeleton = v;\n  }\n}, 13);\nvar useRoomRolesManagement;\nmodule.link(\"../body/hooks/useRoomRolesManagement\", {\n  useRoomRolesManagement: function (v) {\n    useRoomRolesManagement = v;\n  }\n}, 14);\nvar RoomContext;\nmodule.link(\"../contexts/RoomContext\", {\n  RoomContext: function (v) {\n    RoomContext = v;\n  }\n}, 15);\nvar ComposerPopupProvider;\nmodule.link(\"./ComposerPopupProvider\", {\n  \"default\": function (v) {\n    ComposerPopupProvider = v;\n  }\n}, 16);\nvar RoomToolboxProvider;\nmodule.link(\"./RoomToolboxProvider\", {\n  \"default\": function (v) {\n    RoomToolboxProvider = v;\n  }\n}, 17);\nvar UserCardProvider;\nmodule.link(\"./UserCardProvider\", {\n  \"default\": function (v) {\n    UserCardProvider = v;\n  }\n}, 18);\nvar useRedirectOnSettingsChanged;\nmodule.link(\"./hooks/useRedirectOnSettingsChanged\", {\n  useRedirectOnSettingsChanged: function (v) {\n    useRedirectOnSettingsChanged = v;\n  }\n}, 19);\nvar useRoomQuery;\nmodule.link(\"./hooks/useRoomQuery\", {\n  useRoomQuery: function (v) {\n    useRoomQuery = v;\n  }\n}, 20);\nvar useUsersNameChanged;\nmodule.link(\"./hooks/useUsersNameChanged\", {\n  useUsersNameChanged: function (v) {\n    useUsersNameChanged = v;\n  }\n}, 21);\nvar RoomProvider = function (_ref) {\n  var _resultFromServer$dat15, _resultFromServer$dat16, _resultFromServer$dat17, _resultFromServer$dat18, _resultFromServer$dat19, _resultFromServer$dat20, _resultFromServer$dat21, _resultFromServer$dat22, _resultFromServer$dat23;\n  var rid = _ref.rid,\n    children = _ref.children;\n  useRoomRolesManagement(rid);\n  var resultFromServer = useRoomInfoEndpoint(rid);\n  var resultFromLocal = useRoomQuery(rid);\n  // TODO: the following effect is a workaround while we don't have a general and definitive solution for it\n  var router = useRouter();\n  useEffect(function () {\n    if (resultFromLocal.isSuccess && !resultFromLocal.data) {\n      router.navigate('/home');\n    }\n  }, [resultFromLocal.data, resultFromLocal.isSuccess, resultFromServer, router]);\n  var subscriptionQuery = useReactiveQuery(['subscriptions', {\n    rid: rid\n  }], function () {\n    var _ChatSubscription$fin;\n    return (_ChatSubscription$fin = ChatSubscription.findOne({\n      rid: rid\n    })) !== null && _ChatSubscription$fin !== void 0 ? _ChatSubscription$fin : null;\n  });\n  useRedirectOnSettingsChanged(subscriptionQuery.data);\n  useUsersNameChanged();\n  var pseudoRoom = useMemo(function () {\n    var room = resultFromLocal.data;\n    if (!room) {\n      return null;\n    }\n    return _objectSpread(_objectSpread(_objectSpread({}, subscriptionQuery.data), room), {}, {\n      name: roomCoordinator.getRoomName(room.t, room),\n      federationOriginalName: room.name\n    });\n  }, [resultFromLocal.data, subscriptionQuery.data]);\n  var _useReactiveValue = useReactiveValue(useCallback(function () {\n      var _RoomHistoryManager$g = RoomHistoryManager.getRoom(rid),\n        hasMore = _RoomHistoryManager$g.hasMore,\n        hasMoreNext = _RoomHistoryManager$g.hasMoreNext,\n        isLoading = _RoomHistoryManager$g.isLoading;\n      return {\n        hasMorePreviousMessages: hasMore.get(),\n        hasMoreNextMessages: hasMoreNext.get(),\n        isLoadingMoreMessages: isLoading.get()\n      };\n    }, [rid])),\n    hasMorePreviousMessages = _useReactiveValue.hasMorePreviousMessages,\n    hasMoreNextMessages = _useReactiveValue.hasMoreNextMessages,\n    isLoadingMoreMessages = _useReactiveValue.isLoadingMoreMessages;\n  var context = useMemo(function () {\n    var _subscriptionQuery$da;\n    if (!pseudoRoom) {\n      return null;\n    }\n    return {\n      rid: rid,\n      room: pseudoRoom,\n      subscription: (_subscriptionQuery$da = subscriptionQuery.data) !== null && _subscriptionQuery$da !== void 0 ? _subscriptionQuery$da : undefined,\n      hasMorePreviousMessages: hasMorePreviousMessages,\n      hasMoreNextMessages: hasMoreNextMessages,\n      isLoadingMoreMessages: isLoadingMoreMessages\n    };\n  }, [hasMoreNextMessages, hasMorePreviousMessages, isLoadingMoreMessages, pseudoRoom, rid, subscriptionQuery.data]);\n  var isSidepanelFeatureEnabled = useSidePanelNavigation();\n  useEffect(function () {\n    var _resultFromServer$dat5, _resultFromServer$dat6, _resultFromServer$dat7, _resultFromServer$dat8, _resultFromServer$dat9, _resultFromServer$dat10, _resultFromServer$dat11, _resultFromServer$dat12, _resultFromServer$dat13, _resultFromServer$dat14;\n    if (isSidepanelFeatureEnabled) {\n      if (resultFromServer.isSuccess) {\n        var _resultFromServer$dat;\n        if ((_resultFromServer$dat = resultFromServer.data.room) !== null && _resultFromServer$dat !== void 0 && _resultFromServer$dat.teamMain) {\n          var _resultFromServer$dat2, _resultFromServer$dat3, _resultFromServer$dat4;\n          if ((_resultFromServer$dat2 = resultFromServer.data.room.sidepanel) !== null && _resultFromServer$dat2 !== void 0 && _resultFromServer$dat2.items.includes('channels') || (_resultFromServer$dat3 = resultFromServer.data.room) !== null && _resultFromServer$dat3 !== void 0 && (_resultFromServer$dat4 = _resultFromServer$dat3.sidepanel) !== null && _resultFromServer$dat4 !== void 0 && _resultFromServer$dat4.items.includes('discussions')) {\n            RoomManager.openSecondLevel(rid, rid);\n          } else {\n            RoomManager.open(rid);\n          }\n          return function () {\n            RoomManager.back(rid);\n          };\n        }\n        switch (true) {\n          case ((_resultFromServer$dat5 = resultFromServer.data.room) === null || _resultFromServer$dat5 === void 0 ? void 0 : _resultFromServer$dat5.prid) && resultFromServer.data.parent && ((_resultFromServer$dat6 = resultFromServer.data.parent.sidepanel) === null || _resultFromServer$dat6 === void 0 ? void 0 : _resultFromServer$dat6.items.includes('discussions')):\n            RoomManager.openSecondLevel(resultFromServer.data.parent._id, rid);\n            break;\n          case ((_resultFromServer$dat7 = resultFromServer.data.team) === null || _resultFromServer$dat7 === void 0 ? void 0 : _resultFromServer$dat7.roomId) && !((_resultFromServer$dat8 = resultFromServer.data.room) !== null && _resultFromServer$dat8 !== void 0 && _resultFromServer$dat8.teamMain) && ((_resultFromServer$dat9 = resultFromServer.data.parent) === null || _resultFromServer$dat9 === void 0 ? void 0 : (_resultFromServer$dat10 = _resultFromServer$dat9.sidepanel) === null || _resultFromServer$dat10 === void 0 ? void 0 : _resultFromServer$dat10.items.includes('channels')):\n            RoomManager.openSecondLevel(resultFromServer.data.team.roomId, rid);\n            break;\n          default:\n            if ((_resultFromServer$dat11 = resultFromServer.data.parent) !== null && _resultFromServer$dat11 !== void 0 && (_resultFromServer$dat12 = _resultFromServer$dat11.sidepanel) !== null && _resultFromServer$dat12 !== void 0 && _resultFromServer$dat12.items.includes('channels') || (_resultFromServer$dat13 = resultFromServer.data.parent) !== null && _resultFromServer$dat13 !== void 0 && (_resultFromServer$dat14 = _resultFromServer$dat13.sidepanel) !== null && _resultFromServer$dat14 !== void 0 && _resultFromServer$dat14.items.includes('discussions')) {\n              RoomManager.openSecondLevel(rid, rid);\n            } else {\n              RoomManager.open(rid);\n            }\n            break;\n        }\n      }\n      return function () {\n        RoomManager.back(rid);\n      };\n    }\n    RoomManager.open(rid);\n    return function () {\n      RoomManager.back(rid);\n    };\n  }, [isSidepanelFeatureEnabled, rid, (_resultFromServer$dat15 = resultFromServer.data) === null || _resultFromServer$dat15 === void 0 ? void 0 : (_resultFromServer$dat16 = _resultFromServer$dat15.room) === null || _resultFromServer$dat16 === void 0 ? void 0 : _resultFromServer$dat16.prid, (_resultFromServer$dat17 = resultFromServer.data) === null || _resultFromServer$dat17 === void 0 ? void 0 : (_resultFromServer$dat18 = _resultFromServer$dat17.room) === null || _resultFromServer$dat18 === void 0 ? void 0 : _resultFromServer$dat18.teamId, (_resultFromServer$dat19 = resultFromServer.data) === null || _resultFromServer$dat19 === void 0 ? void 0 : (_resultFromServer$dat20 = _resultFromServer$dat19.room) === null || _resultFromServer$dat20 === void 0 ? void 0 : _resultFromServer$dat20.teamMain, resultFromServer.isSuccess, (_resultFromServer$dat21 = resultFromServer.data) === null || _resultFromServer$dat21 === void 0 ? void 0 : _resultFromServer$dat21.parent, (_resultFromServer$dat22 = resultFromServer.data) === null || _resultFromServer$dat22 === void 0 ? void 0 : (_resultFromServer$dat23 = _resultFromServer$dat22.team) === null || _resultFromServer$dat23 === void 0 ? void 0 : _resultFromServer$dat23.roomId, resultFromServer.data]);\n  var subscribed = !!subscriptionQuery.data;\n  useEffect(function () {\n    if (!subscribed) {\n      return;\n    }\n    return UserAction.addStream(rid);\n  }, [rid, subscribed]);\n  if (!pseudoRoom) {\n    return resultFromLocal.isSuccess && !resultFromLocal.data ? /*#__PURE__*/React.createElement(RoomNotFound, null) : /*#__PURE__*/React.createElement(RoomSkeleton, null);\n  }\n  return /*#__PURE__*/React.createElement(RoomContext.Provider, {\n    value: context\n  }, /*#__PURE__*/React.createElement(RoomToolboxProvider, null, /*#__PURE__*/React.createElement(ImageGalleryProvider, null, /*#__PURE__*/React.createElement(UserCardProvider, null, /*#__PURE__*/React.createElement(ComposerPopupProvider, {\n    room: pseudoRoom\n  }, children)))));\n};\nmodule.exportDefault( /*#__PURE__*/memo(RoomProvider));","map":{"version":3,"names":["_objectSpread","module","link","default","v","useRouter","React","useMemo","memo","useEffect","useCallback","ChatSubscription","RoomHistoryManager","UserAction","useReactiveQuery","useReactiveValue","useRoomInfoEndpoint","useSidePanelNavigation","RoomManager","roomCoordinator","ImageGalleryProvider","RoomNotFound","RoomSkeleton","useRoomRolesManagement","RoomContext","ComposerPopupProvider","RoomToolboxProvider","UserCardProvider","useRedirectOnSettingsChanged","useRoomQuery","useUsersNameChanged","RoomProvider","_ref","_resultFromServer$dat15","_resultFromServer$dat16","_resultFromServer$dat17","_resultFromServer$dat18","_resultFromServer$dat19","_resultFromServer$dat20","_resultFromServer$dat21","_resultFromServer$dat22","_resultFromServer$dat23","rid","children","resultFromServer","resultFromLocal","router","isSuccess","data","navigate","subscriptionQuery","_ChatSubscription$fin","findOne","pseudoRoom","room","name","getRoomName","t","federationOriginalName","_useReactiveValue","_RoomHistoryManager$g","getRoom","hasMore","hasMoreNext","isLoading","hasMorePreviousMessages","get","hasMoreNextMessages","isLoadingMoreMessages","context","_subscriptionQuery$da","subscription","undefined","isSidepanelFeatureEnabled","_resultFromServer$dat5","_resultFromServer$dat6","_resultFromServer$dat7","_resultFromServer$dat8","_resultFromServer$dat9","_resultFromServer$dat10","_resultFromServer$dat11","_resultFromServer$dat12","_resultFromServer$dat13","_resultFromServer$dat14","_resultFromServer$dat","teamMain","_resultFromServer$dat2","_resultFromServer$dat3","_resultFromServer$dat4","sidepanel","items","includes","openSecondLevel","open","back","prid","parent","_id","team","roomId","teamId","subscribed","addStream","createElement","Provider","value","exportDefault"],"sources":["client/views/room/providers/RoomProvider.tsx"],"sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { useRouter } from '@rocket.chat/ui-contexts';\nimport type { ReactNode, ContextType, ReactElement } from 'react';\nimport React, { useMemo, memo, useEffect, useCallback } from 'react';\n\nimport { ChatSubscription } from '../../../../app/models/client';\nimport { RoomHistoryManager } from '../../../../app/ui-utils/client';\nimport { UserAction } from '../../../../app/ui/client/lib/UserAction';\nimport { useReactiveQuery } from '../../../hooks/useReactiveQuery';\nimport { useReactiveValue } from '../../../hooks/useReactiveValue';\nimport { useRoomInfoEndpoint } from '../../../hooks/useRoomInfoEndpoint';\nimport { useSidePanelNavigation } from '../../../hooks/useSidePanelNavigation';\nimport { RoomManager } from '../../../lib/RoomManager';\nimport { roomCoordinator } from '../../../lib/rooms/roomCoordinator';\nimport ImageGalleryProvider from '../../../providers/ImageGalleryProvider';\nimport RoomNotFound from '../RoomNotFound';\nimport RoomSkeleton from '../RoomSkeleton';\nimport { useRoomRolesManagement } from '../body/hooks/useRoomRolesManagement';\nimport type { IRoomWithFederationOriginalName } from '../contexts/RoomContext';\nimport { RoomContext } from '../contexts/RoomContext';\nimport ComposerPopupProvider from './ComposerPopupProvider';\nimport RoomToolboxProvider from './RoomToolboxProvider';\nimport UserCardProvider from './UserCardProvider';\nimport { useRedirectOnSettingsChanged } from './hooks/useRedirectOnSettingsChanged';\nimport { useRoomQuery } from './hooks/useRoomQuery';\nimport { useUsersNameChanged } from './hooks/useUsersNameChanged';\n\ntype RoomProviderProps = {\n\tchildren: ReactNode;\n\trid: IRoom['_id'];\n};\n\nconst RoomProvider = ({ rid, children }: RoomProviderProps): ReactElement => {\n\tuseRoomRolesManagement(rid);\n\n\tconst resultFromServer = useRoomInfoEndpoint(rid);\n\n\tconst resultFromLocal = useRoomQuery(rid);\n\n\t// TODO: the following effect is a workaround while we don't have a general and definitive solution for it\n\tconst router = useRouter();\n\tuseEffect(() => {\n\t\tif (resultFromLocal.isSuccess && !resultFromLocal.data) {\n\t\t\trouter.navigate('/home');\n\t\t}\n\t}, [resultFromLocal.data, resultFromLocal.isSuccess, resultFromServer, router]);\n\n\tconst subscriptionQuery = useReactiveQuery(['subscriptions', { rid }], () => ChatSubscription.findOne({ rid }) ?? null);\n\n\tuseRedirectOnSettingsChanged(subscriptionQuery.data);\n\n\tuseUsersNameChanged();\n\n\tconst pseudoRoom: IRoomWithFederationOriginalName | null = useMemo(() => {\n\t\tconst room = resultFromLocal.data;\n\t\tif (!room) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\t...subscriptionQuery.data,\n\t\t\t...room,\n\t\t\tname: roomCoordinator.getRoomName(room.t, room),\n\t\t\tfederationOriginalName: room.name,\n\t\t};\n\t}, [resultFromLocal.data, subscriptionQuery.data]);\n\n\tconst { hasMorePreviousMessages, hasMoreNextMessages, isLoadingMoreMessages } = useReactiveValue(\n\t\tuseCallback(() => {\n\t\t\tconst { hasMore, hasMoreNext, isLoading } = RoomHistoryManager.getRoom(rid);\n\n\t\t\treturn {\n\t\t\t\thasMorePreviousMessages: hasMore.get(),\n\t\t\t\thasMoreNextMessages: hasMoreNext.get(),\n\t\t\t\tisLoadingMoreMessages: isLoading.get(),\n\t\t\t};\n\t\t}, [rid]),\n\t);\n\n\tconst context = useMemo((): ContextType<typeof RoomContext> => {\n\t\tif (!pseudoRoom) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\trid,\n\t\t\troom: pseudoRoom,\n\t\t\tsubscription: subscriptionQuery.data ?? undefined,\n\t\t\thasMorePreviousMessages,\n\t\t\thasMoreNextMessages,\n\t\t\tisLoadingMoreMessages,\n\t\t};\n\t}, [hasMoreNextMessages, hasMorePreviousMessages, isLoadingMoreMessages, pseudoRoom, rid, subscriptionQuery.data]);\n\n\tconst isSidepanelFeatureEnabled = useSidePanelNavigation();\n\n\tuseEffect(() => {\n\t\tif (isSidepanelFeatureEnabled) {\n\t\t\tif (resultFromServer.isSuccess) {\n\t\t\t\tif (resultFromServer.data.room?.teamMain) {\n\t\t\t\t\tif (\n\t\t\t\t\t\tresultFromServer.data.room.sidepanel?.items.includes('channels') ||\n\t\t\t\t\t\tresultFromServer.data.room?.sidepanel?.items.includes('discussions')\n\t\t\t\t\t) {\n\t\t\t\t\t\tRoomManager.openSecondLevel(rid, rid);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tRoomManager.open(rid);\n\t\t\t\t\t}\n\t\t\t\t\treturn (): void => {\n\t\t\t\t\t\tRoomManager.back(rid);\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tswitch (true) {\n\t\t\t\t\tcase resultFromServer.data.room?.prid &&\n\t\t\t\t\t\tresultFromServer.data.parent &&\n\t\t\t\t\t\tresultFromServer.data.parent.sidepanel?.items.includes('discussions'):\n\t\t\t\t\t\tRoomManager.openSecondLevel(resultFromServer.data.parent._id, rid);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase resultFromServer.data.team?.roomId &&\n\t\t\t\t\t\t!resultFromServer.data.room?.teamMain &&\n\t\t\t\t\t\tresultFromServer.data.parent?.sidepanel?.items.includes('channels'):\n\t\t\t\t\t\tRoomManager.openSecondLevel(resultFromServer.data.team.roomId, rid);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tresultFromServer.data.parent?.sidepanel?.items.includes('channels') ||\n\t\t\t\t\t\t\tresultFromServer.data.parent?.sidepanel?.items.includes('discussions')\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tRoomManager.openSecondLevel(rid, rid);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tRoomManager.open(rid);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn (): void => {\n\t\t\t\tRoomManager.back(rid);\n\t\t\t};\n\t\t}\n\n\t\tRoomManager.open(rid);\n\t\treturn (): void => {\n\t\t\tRoomManager.back(rid);\n\t\t};\n\t}, [\n\t\tisSidepanelFeatureEnabled,\n\t\trid,\n\t\tresultFromServer.data?.room?.prid,\n\t\tresultFromServer.data?.room?.teamId,\n\t\tresultFromServer.data?.room?.teamMain,\n\t\tresultFromServer.isSuccess,\n\t\tresultFromServer.data?.parent,\n\t\tresultFromServer.data?.team?.roomId,\n\t\tresultFromServer.data,\n\t]);\n\n\tconst subscribed = !!subscriptionQuery.data;\n\n\tuseEffect(() => {\n\t\tif (!subscribed) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn UserAction.addStream(rid);\n\t}, [rid, subscribed]);\n\n\tif (!pseudoRoom) {\n\t\treturn resultFromLocal.isSuccess && !resultFromLocal.data ? <RoomNotFound /> : <RoomSkeleton />;\n\t}\n\n\treturn (\n\t\t<RoomContext.Provider value={context}>\n\t\t\t<RoomToolboxProvider>\n\t\t\t\t<ImageGalleryProvider>\n\t\t\t\t\t<UserCardProvider>\n\t\t\t\t\t\t<ComposerPopupProvider room={pseudoRoom}>{children}</ComposerPopupProvider>\n\t\t\t\t\t</UserCardProvider>\n\t\t\t\t</ImageGalleryProvider>\n\t\t\t</RoomToolboxProvider>\n\t\t</RoomContext.Provider>\n\t);\n};\n\nexport default memo(RoomProvider);\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"9cb7f565c0c285b73dae930b14f5e415dd76c70a"}
