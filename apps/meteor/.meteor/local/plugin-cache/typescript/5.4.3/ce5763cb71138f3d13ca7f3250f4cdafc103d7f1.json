{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts","inputSourceMap":{"version":3,"file":"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts","sourceRoot":"","sources":["client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,kBAAkB,EAAE,MAAM,6BAA6B,CAAC;AAEjE,OAAO,EAAE,UAAU,EAAE,MAAM,0BAA0B,CAAC;AACtD,OAAO,EAAE,SAAS,EAAE,OAAO,EAAE,MAAM,OAAO,CAAC;AAE3C,OAAO,EAAE,aAAa,EAAE,MAAM,iEAAiE,CAAC;AAChG,OAAO,EAAE,OAAO,EAAE,MAAM,kCAAkC,CAAC;AAC3D,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AACtE,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AAEtE,MAAM,aAAa,GAAG,IAAI,aAAa,EAAE,CAAC;AAE1C,MAAM,CAAC,MAAM,qBAAqB,GAAG,CAAC,QAAiB,EAAE,kBAA2B,EAAwB,EAAE;IAC7G,MAAM,mBAAmB,GAAG,UAAU,CAAC,oBAAoB,CAAY,CAAC;IACxE,MAAM,sBAAsB,GAAG,UAAU,CAAC,8BAA8B,CAAY,CAAC;IACrF,MAAM,4BAA4B,GAAG,UAAU,CAAC,+BAA+B,CAAW,CAAC;IAC3F,MAAM,4BAA4B,GAAG,UAAU,CAAC,+BAA+B,CAAW,CAAC;IAC3F,MAAM,CAAC,kBAAkB,CAAC,GAAG,mBAAmB,CAAC,YAAY,CAAC,CAAC;IAE/D,MAAM,SAAS,GAAG,OAAO,CACxB,GAAG,EAAE,CACJ,OAAO,CACN,aAAa,CAAC,WAAW,EAAE;QAC1B,CAAC,kBAAkB;QACnB,mBAAmB;QACnB,sBAAsB;QACtB,CAAC,4BAA4B,EAAE,KAAK,CAAC,uBAAuB,CAAC;QAC7D,CAAC,CAAC,4BAA4B,IAAI,4BAA4B,CAAC,KAAK,CAAC,uBAAuB,CAAC,CAAC,CAC/F,EACF,CAAC,4BAA4B,EAAE,4BAA4B,EAAE,sBAAsB,EAAE,mBAAmB,EAAE,kBAAkB,CAAC,CAC7H,CAAC;IAEF,MAAM,mBAAmB,GAAG,mBAAmB,CAAC,OAAO,EAAE,kBAAkB,EAAE,mBAAmB,EAAE,sBAAsB,EAAE,SAAS,CAAC,CAAC;IAErI,MAAM,IAAI,GAAG,OAAO,EAAE,CAAC;IAEvB,MAAM,aAAa,GAAG,kBAAkB,CAAC,GAAG,EAAE;QAC7C,IAAI,EAAE,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAE/B,IAAI,EAAE,QAAQ,EAAE,gBAAgB,CAAC,KAAK,CAAC,CAAC;IACzC,CAAC,CAAC,CAAC;IAEH,MAAM,mBAAmB,GAAG,kBAAkB,CAAC,CAAC,QAAQ,EAAE,EAAE;QAC3D,IAAI,QAAQ,EAAE,CAAC;YACd,aAAa,EAAE,CAAC;QACjB,CAAC;QAED,IAAI,EAAE,QAAQ,EAAE,qBAAqB,CAAC,QAAQ,CAAC,CAAC;IACjD,CAAC,CAAC,CAAC;IAEH,SAAS,CAAC,GAAG,EAAE;QACd,mBAAmB,CAAC,kBAAkB,CAAC,CAAC;IACzC,CAAC,EAAE,CAAC,mBAAmB,EAAE,kBAAkB,CAAC,CAAC,CAAC;IAE9C,MAAM,uBAAuB,GAAG,GAAG,EAAE,CAAC,IAAI,EAAE,QAAQ,EAAE,gBAAgB,CAAC,IAAI,CAAC,CAAC;IAE7E,OAAO;QACN,EAAE,EAAE,eAAe;QACnB,OAAO,EAAE,mBAAmB;QAC5B,IAAI,EAAE,KAAK;QACX,QAAQ,EAAE,CAAC,SAAS,IAAI,OAAO,CAAC,QAAQ,CAAC;QACzC,OAAO,EAAE,uBAAuB;KAChC,CAAC;AACH,CAAC,CAAC","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useSetting } from '@rocket.chat/ui-contexts';\nimport { useEffect, useMemo } from 'react';\n\nimport { AudioRecorder } from '../../../../../../../app/ui/client/lib/recorderjs/AudioRecorder';\nimport { useChat } from '../../../../contexts/ChatContext';\nimport { useMediaActionTitle } from '../../hooks/useMediaActionTitle';\nimport { useMediaPermissions } from '../../hooks/useMediaPermissions';\n\nconst audioRecorder = new AudioRecorder();\n\nexport const useAudioMessageAction = (disabled: boolean, isMicrophoneDenied: boolean): GenericMenuItemProps => {\n\tconst isFileUploadEnabled = useSetting('FileUpload_Enabled') as boolean;\n\tconst isAudioRecorderEnabled = useSetting('Message_AudioRecorderEnabled') as boolean;\n\tconst fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList') as string;\n\tconst fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList') as string;\n\tconst [isPermissionDenied] = useMediaPermissions('microphone');\n\n\tconst isAllowed = useMemo(\n\t\t() =>\n\t\t\tBoolean(\n\t\t\t\taudioRecorder.isSupported() &&\n\t\t\t\t\t!isMicrophoneDenied &&\n\t\t\t\t\tisFileUploadEnabled &&\n\t\t\t\t\tisAudioRecorderEnabled &&\n\t\t\t\t\t!fileUploadMediaTypeBlackList?.match(/audio\\/mp3|audio\\/\\*/i) &&\n\t\t\t\t\t(!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/audio\\/mp3|audio\\/\\*/i)),\n\t\t\t),\n\t\t[fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isAudioRecorderEnabled, isFileUploadEnabled, isMicrophoneDenied],\n\t);\n\n\tconst getMediaActionTitle = useMediaActionTitle('audio', isPermissionDenied, isFileUploadEnabled, isAudioRecorderEnabled, isAllowed);\n\n\tconst chat = useChat();\n\n\tconst stopRecording = useMutableCallback(() => {\n\t\tchat?.action.stop('recording');\n\n\t\tchat?.composer?.setRecordingMode(false);\n\t});\n\n\tconst setMicrophoneDenied = useMutableCallback((isDenied) => {\n\t\tif (isDenied) {\n\t\t\tstopRecording();\n\t\t}\n\n\t\tchat?.composer?.setIsMicrophoneDenied(isDenied);\n\t});\n\n\tuseEffect(() => {\n\t\tsetMicrophoneDenied(isPermissionDenied);\n\t}, [setMicrophoneDenied, isPermissionDenied]);\n\n\tconst handleRecordButtonClick = () => chat?.composer?.setRecordingMode(true);\n\n\treturn {\n\t\tid: 'audio-message',\n\t\tcontent: getMediaActionTitle,\n\t\ticon: 'mic',\n\t\tdisabled: !isAllowed || Boolean(disabled),\n\t\tonClick: handleRecordButtonClick,\n\t};\n};\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts","inputSourceMap":{"version":3,"file":"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts","sourceRoot":"","sources":["client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,kBAAkB,EAAE,MAAM,6BAA6B,CAAC;AAEjE,OAAO,EAAE,UAAU,EAAE,MAAM,0BAA0B,CAAC;AACtD,OAAO,EAAE,SAAS,EAAE,OAAO,EAAE,MAAM,OAAO,CAAC;AAE3C,OAAO,EAAE,aAAa,EAAE,MAAM,iEAAiE,CAAC;AAChG,OAAO,EAAE,OAAO,EAAE,MAAM,kCAAkC,CAAC;AAC3D,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AACtE,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AAEtE,MAAM,aAAa,GAAG,IAAI,aAAa,EAAE,CAAC;AAE1C,MAAM,CAAC,MAAM,qBAAqB,GAAG,CAAC,QAAiB,EAAE,kBAA2B,EAAwB,EAAE;IAC7G,MAAM,mBAAmB,GAAG,UAAU,CAAC,oBAAoB,CAAY,CAAC;IACxE,MAAM,sBAAsB,GAAG,UAAU,CAAC,8BAA8B,CAAY,CAAC;IACrF,MAAM,4BAA4B,GAAG,UAAU,CAAC,+BAA+B,CAAW,CAAC;IAC3F,MAAM,4BAA4B,GAAG,UAAU,CAAC,+BAA+B,CAAW,CAAC;IAC3F,MAAM,CAAC,kBAAkB,CAAC,GAAG,mBAAmB,CAAC,YAAY,CAAC,CAAC;IAE/D,MAAM,SAAS,GAAG,OAAO,CACxB,GAAG,EAAE,CACJ,OAAO,CACN,aAAa,CAAC,WAAW,EAAE;QAC1B,CAAC,kBAAkB;QACnB,mBAAmB;QACnB,sBAAsB;QACtB,CAAC,4BAA4B,EAAE,KAAK,CAAC,uBAAuB,CAAC;QAC7D,CAAC,CAAC,4BAA4B,IAAI,4BAA4B,CAAC,KAAK,CAAC,uBAAuB,CAAC,CAAC,CAC/F,EACF,CAAC,4BAA4B,EAAE,4BAA4B,EAAE,sBAAsB,EAAE,mBAAmB,EAAE,kBAAkB,CAAC,CAC7H,CAAC;IAEF,MAAM,mBAAmB,GAAG,mBAAmB,CAAC,OAAO,EAAE,kBAAkB,EAAE,mBAAmB,EAAE,sBAAsB,EAAE,SAAS,CAAC,CAAC;IAErI,MAAM,IAAI,GAAG,OAAO,EAAE,CAAC;IAEvB,MAAM,aAAa,GAAG,kBAAkB,CAAC,GAAG,EAAE;QAC7C,IAAI,EAAE,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAE/B,IAAI,EAAE,QAAQ,EAAE,gBAAgB,CAAC,KAAK,CAAC,CAAC;IACzC,CAAC,CAAC,CAAC;IAEH,MAAM,mBAAmB,GAAG,kBAAkB,CAAC,CAAC,QAAQ,EAAE,EAAE;QAC3D,IAAI,QAAQ,EAAE,CAAC;YACd,aAAa,EAAE,CAAC;QACjB,CAAC;QAED,IAAI,EAAE,QAAQ,EAAE,qBAAqB,CAAC,QAAQ,CAAC,CAAC;IACjD,CAAC,CAAC,CAAC;IAEH,SAAS,CAAC,GAAG,EAAE;QACd,mBAAmB,CAAC,kBAAkB,CAAC,CAAC;IACzC,CAAC,EAAE,CAAC,mBAAmB,EAAE,kBAAkB,CAAC,CAAC,CAAC;IAE9C,MAAM,uBAAuB,GAAG,GAAG,EAAE,CAAC,IAAI,EAAE,QAAQ,EAAE,gBAAgB,CAAC,IAAI,CAAC,CAAC;IAE7E,OAAO;QACN,EAAE,EAAE,eAAe;QACnB,OAAO,EAAE,mBAAmB;QAC5B,IAAI,EAAE,KAAK;QACX,QAAQ,EAAE,CAAC,SAAS,IAAI,OAAO,CAAC,QAAQ,CAAC;QACzC,OAAO,EAAE,uBAAuB;KAChC,CAAC;AACH,CAAC,CAAC","sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useSetting } from '@rocket.chat/ui-contexts';\nimport { useEffect, useMemo } from 'react';\n\nimport { AudioRecorder } from '../../../../../../../app/ui/client/lib/recorderjs/AudioRecorder';\nimport { useChat } from '../../../../contexts/ChatContext';\nimport { useMediaActionTitle } from '../../hooks/useMediaActionTitle';\nimport { useMediaPermissions } from '../../hooks/useMediaPermissions';\n\nconst audioRecorder = new AudioRecorder();\n\nexport const useAudioMessageAction = (disabled: boolean, isMicrophoneDenied: boolean): GenericMenuItemProps => {\n\tconst isFileUploadEnabled = useSetting('FileUpload_Enabled') as boolean;\n\tconst isAudioRecorderEnabled = useSetting('Message_AudioRecorderEnabled') as boolean;\n\tconst fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList') as string;\n\tconst fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList') as string;\n\tconst [isPermissionDenied] = useMediaPermissions('microphone');\n\n\tconst isAllowed = useMemo(\n\t\t() =>\n\t\t\tBoolean(\n\t\t\t\taudioRecorder.isSupported() &&\n\t\t\t\t\t!isMicrophoneDenied &&\n\t\t\t\t\tisFileUploadEnabled &&\n\t\t\t\t\tisAudioRecorderEnabled &&\n\t\t\t\t\t!fileUploadMediaTypeBlackList?.match(/audio\\/mp3|audio\\/\\*/i) &&\n\t\t\t\t\t(!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/audio\\/mp3|audio\\/\\*/i)),\n\t\t\t),\n\t\t[fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isAudioRecorderEnabled, isFileUploadEnabled, isMicrophoneDenied],\n\t);\n\n\tconst getMediaActionTitle = useMediaActionTitle('audio', isPermissionDenied, isFileUploadEnabled, isAudioRecorderEnabled, isAllowed);\n\n\tconst chat = useChat();\n\n\tconst stopRecording = useMutableCallback(() => {\n\t\tchat?.action.stop('recording');\n\n\t\tchat?.composer?.setRecordingMode(false);\n\t});\n\n\tconst setMicrophoneDenied = useMutableCallback((isDenied) => {\n\t\tif (isDenied) {\n\t\t\tstopRecording();\n\t\t}\n\n\t\tchat?.composer?.setIsMicrophoneDenied(isDenied);\n\t});\n\n\tuseEffect(() => {\n\t\tsetMicrophoneDenied(isPermissionDenied);\n\t}, [setMicrophoneDenied, isPermissionDenied]);\n\n\tconst handleRecordButtonClick = () => chat?.composer?.setRecordingMode(true);\n\n\treturn {\n\t\tid: 'audio-message',\n\t\tcontent: getMediaActionTitle,\n\t\ticon: 'mic',\n\t\tdisabled: !isAllowed || Boolean(disabled),\n\t\tonClick: handleRecordButtonClick,\n\t};\n};\n"]}}},"code":"var _slicedToArray;\nmodule.link(\"@babel/runtime/helpers/slicedToArray\", {\n  default: function (v) {\n    _slicedToArray = v;\n  }\n}, 0);\nmodule.export({\n  useAudioMessageAction: function () {\n    return useAudioMessageAction;\n  }\n});\nvar useMutableCallback;\nmodule.link(\"@rocket.chat/fuselage-hooks\", {\n  useMutableCallback: function (v) {\n    useMutableCallback = v;\n  }\n}, 0);\nvar useSetting;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useSetting: function (v) {\n    useSetting = v;\n  }\n}, 1);\nvar useEffect, useMemo;\nmodule.link(\"react\", {\n  useEffect: function (v) {\n    useEffect = v;\n  },\n  useMemo: function (v) {\n    useMemo = v;\n  }\n}, 2);\nvar AudioRecorder;\nmodule.link(\"../../../../../../../app/ui/client/lib/recorderjs/AudioRecorder\", {\n  AudioRecorder: function (v) {\n    AudioRecorder = v;\n  }\n}, 3);\nvar useChat;\nmodule.link(\"../../../../contexts/ChatContext\", {\n  useChat: function (v) {\n    useChat = v;\n  }\n}, 4);\nvar useMediaActionTitle;\nmodule.link(\"../../hooks/useMediaActionTitle\", {\n  useMediaActionTitle: function (v) {\n    useMediaActionTitle = v;\n  }\n}, 5);\nvar useMediaPermissions;\nmodule.link(\"../../hooks/useMediaPermissions\", {\n  useMediaPermissions: function (v) {\n    useMediaPermissions = v;\n  }\n}, 6);\nvar audioRecorder = new AudioRecorder();\nvar useAudioMessageAction = function (disabled, isMicrophoneDenied) {\n  var isFileUploadEnabled = useSetting('FileUpload_Enabled');\n  var isAudioRecorderEnabled = useSetting('Message_AudioRecorderEnabled');\n  var fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList');\n  var fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList');\n  var _useMediaPermissions = useMediaPermissions('microphone'),\n    _useMediaPermissions2 = _slicedToArray(_useMediaPermissions, 1),\n    isPermissionDenied = _useMediaPermissions2[0];\n  var isAllowed = useMemo(function () {\n    return Boolean(audioRecorder.isSupported() && !isMicrophoneDenied && isFileUploadEnabled && isAudioRecorderEnabled && !(fileUploadMediaTypeBlackList !== null && fileUploadMediaTypeBlackList !== void 0 && fileUploadMediaTypeBlackList.match(/audio\\/mp3|audio\\/\\*/i)) && (!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/audio\\/mp3|audio\\/\\*/i)));\n  }, [fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isAudioRecorderEnabled, isFileUploadEnabled, isMicrophoneDenied]);\n  var getMediaActionTitle = useMediaActionTitle('audio', isPermissionDenied, isFileUploadEnabled, isAudioRecorderEnabled, isAllowed);\n  var chat = useChat();\n  var stopRecording = useMutableCallback(function () {\n    var _chat$composer;\n    chat === null || chat === void 0 ? void 0 : chat.action.stop('recording');\n    chat === null || chat === void 0 ? void 0 : (_chat$composer = chat.composer) === null || _chat$composer === void 0 ? void 0 : _chat$composer.setRecordingMode(false);\n  });\n  var setMicrophoneDenied = useMutableCallback(function (isDenied) {\n    var _chat$composer2;\n    if (isDenied) {\n      stopRecording();\n    }\n    chat === null || chat === void 0 ? void 0 : (_chat$composer2 = chat.composer) === null || _chat$composer2 === void 0 ? void 0 : _chat$composer2.setIsMicrophoneDenied(isDenied);\n  });\n  useEffect(function () {\n    setMicrophoneDenied(isPermissionDenied);\n  }, [setMicrophoneDenied, isPermissionDenied]);\n  var handleRecordButtonClick = function () {\n    var _chat$composer3;\n    return chat === null || chat === void 0 ? void 0 : (_chat$composer3 = chat.composer) === null || _chat$composer3 === void 0 ? void 0 : _chat$composer3.setRecordingMode(true);\n  };\n  return {\n    id: 'audio-message',\n    content: getMediaActionTitle,\n    icon: 'mic',\n    disabled: !isAllowed || Boolean(disabled),\n    onClick: handleRecordButtonClick\n  };\n};","map":{"version":3,"names":["_slicedToArray","module","link","default","v","export","useAudioMessageAction","useMutableCallback","useSetting","useEffect","useMemo","AudioRecorder","useChat","useMediaActionTitle","useMediaPermissions","audioRecorder","disabled","isMicrophoneDenied","isFileUploadEnabled","isAudioRecorderEnabled","fileUploadMediaTypeBlackList","fileUploadMediaTypeWhiteList","_useMediaPermissions","_useMediaPermissions2","isPermissionDenied","isAllowed","Boolean","isSupported","match","getMediaActionTitle","chat","stopRecording","_chat$composer","action","stop","composer","setRecordingMode","setMicrophoneDenied","isDenied","_chat$composer2","setIsMicrophoneDenied","handleRecordButtonClick","_chat$composer3","id","content","icon","onClick"],"sources":["client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useAudioMessageAction.ts"],"sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\nimport { useSetting } from '@rocket.chat/ui-contexts';\nimport { useEffect, useMemo } from 'react';\n\nimport { AudioRecorder } from '../../../../../../../app/ui/client/lib/recorderjs/AudioRecorder';\nimport { useChat } from '../../../../contexts/ChatContext';\nimport { useMediaActionTitle } from '../../hooks/useMediaActionTitle';\nimport { useMediaPermissions } from '../../hooks/useMediaPermissions';\n\nconst audioRecorder = new AudioRecorder();\n\nexport const useAudioMessageAction = (disabled: boolean, isMicrophoneDenied: boolean): GenericMenuItemProps => {\n\tconst isFileUploadEnabled = useSetting('FileUpload_Enabled') as boolean;\n\tconst isAudioRecorderEnabled = useSetting('Message_AudioRecorderEnabled') as boolean;\n\tconst fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList') as string;\n\tconst fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList') as string;\n\tconst [isPermissionDenied] = useMediaPermissions('microphone');\n\n\tconst isAllowed = useMemo(\n\t\t() =>\n\t\t\tBoolean(\n\t\t\t\taudioRecorder.isSupported() &&\n\t\t\t\t\t!isMicrophoneDenied &&\n\t\t\t\t\tisFileUploadEnabled &&\n\t\t\t\t\tisAudioRecorderEnabled &&\n\t\t\t\t\t!fileUploadMediaTypeBlackList?.match(/audio\\/mp3|audio\\/\\*/i) &&\n\t\t\t\t\t(!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/audio\\/mp3|audio\\/\\*/i)),\n\t\t\t),\n\t\t[fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isAudioRecorderEnabled, isFileUploadEnabled, isMicrophoneDenied],\n\t);\n\n\tconst getMediaActionTitle = useMediaActionTitle('audio', isPermissionDenied, isFileUploadEnabled, isAudioRecorderEnabled, isAllowed);\n\n\tconst chat = useChat();\n\n\tconst stopRecording = useMutableCallback(() => {\n\t\tchat?.action.stop('recording');\n\n\t\tchat?.composer?.setRecordingMode(false);\n\t});\n\n\tconst setMicrophoneDenied = useMutableCallback((isDenied) => {\n\t\tif (isDenied) {\n\t\t\tstopRecording();\n\t\t}\n\n\t\tchat?.composer?.setIsMicrophoneDenied(isDenied);\n\t});\n\n\tuseEffect(() => {\n\t\tsetMicrophoneDenied(isPermissionDenied);\n\t}, [setMicrophoneDenied, isPermissionDenied]);\n\n\tconst handleRecordButtonClick = () => chat?.composer?.setRecordingMode(true);\n\n\treturn {\n\t\tid: 'audio-message',\n\t\tcontent: getMediaActionTitle,\n\t\ticon: 'mic',\n\t\tdisabled: !isAllowed || Boolean(disabled),\n\t\tonClick: handleRecordButtonClick,\n\t};\n};\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"ce5763cb71138f3d13ca7f3250f4cdafc103d7f1"}
