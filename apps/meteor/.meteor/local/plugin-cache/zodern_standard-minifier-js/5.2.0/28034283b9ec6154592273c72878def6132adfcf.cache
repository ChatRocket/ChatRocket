{"code":"function module(e,t,a){let l,n,s,r,i,c,o,d,u,m,p,f;a.link(\"@rocket.chat/fuselage\",{Box(e){l=e},Button(e){n=e},Field(e){s=e},FieldLabel(e){r=e},FieldRow(e){i=e},Icon(e){c=e}},0),a.link(\"@rocket.chat/random\",{Random(e){o=e}},1),a.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch(e){d=e},useEndpoint(e){u=e},useTranslation(e){m=e},useUpload(e){p=e}},2),a.link(\"react\",{default(e){f=e}},3),a.link(\"./AssetSettingInput.styles.css\"),a.exportDefault(function(e){var t;let{_id:a,label:v,value:g,asset:E,required:h,disabled:y,fileConstraints:k}=e,b=m(),w=d(),N=p(\"/v1/assets.setAsset\"),x=u(\"POST\",\"/v1/assets.unsetAsset\"),T=e=>!!(\"dataTransfer\"in e&&e.dataTransfer.files),_=async()=>{try{await x({assetName:E})}catch(e){w({type:\"error\",message:e})}};return f.createElement(s,null,f.createElement(r,{htmlFor:a,title:a,required:h},v),f.createElement(i,null,f.createElement(\"div\",{className:\"settings-file-preview\"},null!=g&&g.url?f.createElement(\"div\",{className:\"preview\",style:{backgroundImage:\"url(\".concat(g.url,\"?_dc=\").concat(o.id(),\")\")},role:\"img\",\"aria-label\":b(\"Asset_preview\")}):f.createElement(\"div\",{className:\"preview no-file background-transparent-light secondary-font-color\"},f.createElement(c,{size:\"x16\",name:\"upload\"})),f.createElement(\"div\",{className:\"action\"},null!=g&&g.url?f.createElement(n,{icon:\"trash\",disabled:y,onClick:_},b(\"Delete\")):f.createElement(l,{position:\"relative\",className:\"rcx-button rcx-button--primary \".concat(y?\"is-disabled\":\"\")},b(\"Select_file\"),f.createElement(\"input\",{className:\"AssetSettingInput__input\",type:\"file\",accept:\".\".concat(null==k?void 0:null===(t=k.extensions)||void 0===t?void 0:t.join(\", .\")),onChange:e=>{var t;let{files:a}=e.target;(!a||0===a.length)&&T(e)&&(a=e.dataTransfer.files),Object.values(null!==(t=a)&&void 0!==t?t:[]).forEach(async e=>{w({type:\"info\",message:b(\"Uploading_file\")});let t=new FormData;t.append(\"asset\",e,e.name),t.append(\"assetName\",E);try{await N(t)}catch(e){w({type:\"error\",message:e})}})},disabled:y}))))))})}","map":"{\"version\":3,\"sources\":[\"client/views/admin/settings/Setting/inputs/AssetSettingInput.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Box, Button, Field, FieldLabel, FieldRow, Icon } from '@rocket.chat/fuselage';\\nimport { Random } from '@rocket.chat/random';\\nimport { useToastMessageDispatch, useEndpoint, useTranslation, useUpload } from '@rocket.chat/ui-contexts';\\nimport type { ChangeEventHandler, DragEvent, ReactElement, SyntheticEvent } from 'react';\\nimport React from 'react';\\n\\nimport './AssetSettingInput.styles.css';\\nimport type { SettingInputProps } from './types';\\n\\ntype AssetSettingInputProps = Omit<SettingInputProps<{ url: string }>, 'onChangeValue'> & {\\n\\tasset?: any;\\n\\tfileConstraints?: { extensions: string[] };\\n};\\n\\nfunction AssetSettingInput({ _id, label, value, asset, required, disabled, fileConstraints }: AssetSettingInputProps): ReactElement {\\n\\tconst t = useTranslation();\\n\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst setAsset = useUpload('/v1/assets.setAsset');\\n\\tconst unsetAsset = useEndpoint('POST', '/v1/assets.unsetAsset');\\n\\n\\tconst isDataTransferEvent = <T extends SyntheticEvent>(event: T): event is T & DragEvent<HTMLInputElement> =>\\n\\t\\tBoolean('dataTransfer' in event && (event as any).dataTransfer.files);\\n\\n\\tconst handleUpload: ChangeEventHandler<HTMLInputElement> = (event): void => {\\n\\t\\tlet { files } = event.target;\\n\\n\\t\\tif (!files || files.length === 0) {\\n\\t\\t\\tif (isDataTransferEvent(event)) {\\n\\t\\t\\t\\tfiles = event.dataTransfer.files;\\n\\t\\t\\t}\\n\\t\\t}\\n\\n\\t\\tObject.values(files ?? []).forEach(async (blob) => {\\n\\t\\t\\tdispatchToastMessage({ type: 'info', message: t('Uploading_file') });\\n\\n\\t\\t\\tconst fileData = new FormData();\\n\\t\\t\\tfileData.append('asset', blob, blob.name);\\n\\t\\t\\tfileData.append('assetName', asset);\\n\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tawait setAsset(fileData);\\n\\t\\t\\t} catch (e) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: e });\\n\\t\\t\\t}\\n\\t\\t});\\n\\t};\\n\\n\\tconst handleDeleteButtonClick = async (): Promise<void> => {\\n\\t\\ttry {\\n\\t\\t\\tawait unsetAsset({ assetName: asset });\\n\\t\\t} catch (error) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t}\\n\\t};\\n\\n\\treturn (\\n\\t\\t<Field>\\n\\t\\t\\t<FieldLabel htmlFor={_id} title={_id} required={required}>\\n\\t\\t\\t\\t{label}\\n\\t\\t\\t</FieldLabel>\\n\\t\\t\\t<FieldRow>\\n\\t\\t\\t\\t<div className='settings-file-preview'>\\n\\t\\t\\t\\t\\t{value?.url ? (\\n\\t\\t\\t\\t\\t\\t<div\\n\\t\\t\\t\\t\\t\\t\\tclassName='preview'\\n\\t\\t\\t\\t\\t\\t\\tstyle={{ backgroundImage: `url(${value.url}?_dc=${Random.id()})` }}\\n\\t\\t\\t\\t\\t\\t\\trole='img'\\n\\t\\t\\t\\t\\t\\t\\taria-label={t('Asset_preview')}\\n\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t) : (\\n\\t\\t\\t\\t\\t\\t<div className='preview no-file background-transparent-light secondary-font-color'>\\n\\t\\t\\t\\t\\t\\t\\t<Icon size='x16' name='upload' />\\n\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t<div className='action'>\\n\\t\\t\\t\\t\\t\\t{value?.url ? (\\n\\t\\t\\t\\t\\t\\t\\t<Button icon='trash' disabled={disabled} onClick={handleDeleteButtonClick}>\\n\\t\\t\\t\\t\\t\\t\\t\\t{t('Delete')}\\n\\t\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t\\t) : (\\n\\t\\t\\t\\t\\t\\t\\t<Box position='relative' className={`rcx-button rcx-button--primary ${disabled ? 'is-disabled' : ''}`}>\\n\\t\\t\\t\\t\\t\\t\\t\\t{t('Select_file')}\\n\\t\\t\\t\\t\\t\\t\\t\\t<input\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tclassName='AssetSettingInput__input'\\n\\t\\t\\t\\t\\t\\t\\t\\t\\ttype='file'\\n\\t\\t\\t\\t\\t\\t\\t\\t\\taccept={`.${fileConstraints?.extensions?.join(', .')}`}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tonChange={handleUpload}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tdisabled={disabled}\\n\\t\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</FieldRow>\\n\\t\\t</Field>\\n\\t);\\n}\\n\\nexport default AssetSettingInput;\\n\",null],\"names\":[\"Box\",\"Button\",\"Field\",\"FieldLabel\",\"FieldRow\",\"Icon\",\"Random\",\"useToastMessageDispatch\",\"useEndpoint\",\"useTranslation\",\"useUpload\",\"React\",\"module\",\"link\",\"v\",\"default\",\"exportDefault\",\"_ref\",\"_fileConstraints$exte\",\"_id\",\"label\",\"value\",\"asset\",\"required\",\"disabled\",\"fileConstraints\",\"t\",\"dispatchToastMessage\",\"setAsset\",\"unsetAsset\",\"isDataTransferEvent\",\"event\",\"Boolean\",\"dataTransfer\",\"files\",\"handleDeleteButtonClick\",\"assetName\",\"error\",\"type\",\"message\",\"createElement\",\"htmlFor\",\"title\",\"className\",\"url\",\"style\",\"backgroundImage\",\"concat\",\"id\",\"role\",\"size\",\"name\",\"icon\",\"onClick\",\"position\",\"accept\",\"extensions\",\"join\",\"onChange\",\"_files\",\"target\",\"length\",\"Object\",\"values\",\"forEach\",\"blob\",\"fileData\",\"FormData\",\"append\",\"e\"],\"mappings\":\"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\"}"}