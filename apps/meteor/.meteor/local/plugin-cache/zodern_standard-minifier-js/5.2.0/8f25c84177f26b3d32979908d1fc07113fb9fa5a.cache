{"code":"function module(e,t,r){let l,a,n,i,s,o,d,u,c,m,v,E,S,k,x,f,y,g,C,F,M;r.link(\"@rocket.chat/fuselage\",{Divider(e){l=e},Modal(e){a=e},ButtonGroup(e){n=e},Button(e){i=e},Field(e){s=e},TextInput(e){o=e},FieldLabel(e){d=e},FieldRow(e){u=e},FieldError(e){c=e},FieldHint(e){m=e}},0),r.link(\"@rocket.chat/ui-contexts\",{useSetModal(e){v=e},useTranslation(e){E=e},useEndpoint(e){S=e},useToastMessageDispatch(e){k=e}},1),r.link(\"@tanstack/react-query\",{useMutation(e){x=e},useQueryClient(e){f=e}},2),r.link(\"react\",{default(e){y=e},useState(e){g=e}},3),r.link(\"./MatrixFederationRemoveServerList\",{default(e){C=e}},4),r.link(\"./MatrixFederationSearch\",{default(e){F=e}},5),r.link(\"./useMatrixServerList\",{useMatrixServerList(e){M=e}},6);let _=e=>e?\"invalid-server-name\"===e.error?\"Server_doesnt_exist\":\"invalid-server-name\"===e.error?\"Server_already_added\":void 0:void 0;r.exportDefault(e=>{let{onClickClose:t}=e,r=E(),p=S(\"POST\",\"/v1/federation/addServerByUser\"),[h,T]=g(\"\"),[B,L]=g(),b=v(),D=f(),H=k(),{mutate:U,isLoading:w,isError:Q}=x([\"v1/federation/addServerByUser\",h],()=>p({serverName:h}),{onSuccess:async()=>{await D.invalidateQueries([\"federation/listServersByUsers\"]),b(y.createElement(F,{defaultSelectedServer:h,onClose:t,key:h}))},onError:e=>{let t=_(e);if(!t){H({type:\"error\",message:e});return}L(t)}}),{data:R,isLoading:q}=M();return y.createElement(a,{maxHeight:\"x600\"},y.createElement(a.Header,null,y.createElement(a.Title,null,r(\"Manage_servers\")),y.createElement(a.Close,{onClick:t})),y.createElement(a.Content,null,y.createElement(s,null,y.createElement(d,null,r(\"Server_name\")),y.createElement(u,null,y.createElement(o,{disabled:w,value:h,onChange:e=>{T(e.currentTarget.value),B&&L(void 0)},mie:4}),y.createElement(i,{onClick:()=>U(),primary:!0,loading:w},r(\"Add\"))),Q&&B&&y.createElement(c,null,r(B)),y.createElement(m,null,r(\"Federation_Example_matrix_server\"))),y.createElement(l,{mb:16}),!q&&(null==R?void 0:R.servers)&&y.createElement(C,{servers:R.servers})),y.createElement(a.Footer,null,y.createElement(n,null,y.createElement(i,{onClick:t},r(\"Cancel\")))))})}","map":"{\"version\":3,\"sources\":[\"client/sidebarv2/header/MatrixFederationSearch/MatrixFederationManageServerModal.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Divider, Modal, ButtonGroup, Button, Field, TextInput, FieldLabel, FieldRow, FieldError, FieldHint } from '@rocket.chat/fuselage';\\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\\nimport { useSetModal, useTranslation, useEndpoint, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\\nimport type { FormEvent } from 'react';\\nimport React, { useState } from 'react';\\n\\nimport MatrixFederationRemoveServerList from './MatrixFederationRemoveServerList';\\nimport MatrixFederationSearch from './MatrixFederationSearch';\\nimport { useMatrixServerList } from './useMatrixServerList';\\n\\ntype MatrixFederationAddServerModalProps = {\\n\\tonClickClose: () => void;\\n};\\n\\nconst getErrorKey = (error: any): TranslationKey | undefined => {\\n\\tif (!error) {\\n\\t\\treturn;\\n\\t}\\n\\tif (error.error === 'invalid-server-name') {\\n\\t\\treturn 'Server_doesnt_exist';\\n\\t}\\n\\tif (error.error === 'invalid-server-name') {\\n\\t\\treturn 'Server_already_added';\\n\\t}\\n};\\n\\nconst MatrixFederationAddServerModal = ({ onClickClose }: MatrixFederationAddServerModalProps) => {\\n\\tconst t = useTranslation();\\n\\tconst addMatrixServer = useEndpoint('POST', '/v1/federation/addServerByUser');\\n\\tconst [serverName, setServerName] = useState('');\\n\\tconst [errorKey, setErrorKey] = useState<TranslationKey | undefined>();\\n\\tconst setModal = useSetModal();\\n\\tconst queryClient = useQueryClient();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst {\\n\\t\\tmutate: addServer,\\n\\t\\tisLoading,\\n\\t\\tisError,\\n\\t} = useMutation(['v1/federation/addServerByUser', serverName], () => addMatrixServer({ serverName }), {\\n\\t\\tonSuccess: async () => {\\n\\t\\t\\tawait queryClient.invalidateQueries(['federation/listServersByUsers']);\\n\\t\\t\\tsetModal(<MatrixFederationSearch defaultSelectedServer={serverName} onClose={onClickClose} key={serverName} />);\\n\\t\\t},\\n\\t\\tonError: (error) => {\\n\\t\\t\\tconst errorKey = getErrorKey(error);\\n\\t\\t\\tif (!errorKey) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t\\tsetErrorKey(errorKey);\\n\\t\\t},\\n\\t});\\n\\n\\tconst { data, isLoading: isLoadingServerList } = useMatrixServerList();\\n\\n\\treturn (\\n\\t\\t<Modal maxHeight='x600'>\\n\\t\\t\\t<Modal.Header>\\n\\t\\t\\t\\t<Modal.Title>{t('Manage_servers')}</Modal.Title>\\n\\t\\t\\t\\t<Modal.Close onClick={onClickClose} />\\n\\t\\t\\t</Modal.Header>\\n\\t\\t\\t<Modal.Content>\\n\\t\\t\\t\\t<Field>\\n\\t\\t\\t\\t\\t<FieldLabel>{t('Server_name')}</FieldLabel>\\n\\t\\t\\t\\t\\t<FieldRow>\\n\\t\\t\\t\\t\\t\\t<TextInput\\n\\t\\t\\t\\t\\t\\t\\tdisabled={isLoading}\\n\\t\\t\\t\\t\\t\\t\\tvalue={serverName}\\n\\t\\t\\t\\t\\t\\t\\tonChange={(e: FormEvent<HTMLInputElement>) => {\\n\\t\\t\\t\\t\\t\\t\\t\\tsetServerName(e.currentTarget.value);\\n\\t\\t\\t\\t\\t\\t\\t\\tif (errorKey) {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tsetErrorKey(undefined);\\n\\t\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t\\t}}\\n\\t\\t\\t\\t\\t\\t\\tmie={4}\\n\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t<Button onClick={() => addServer()} primary loading={isLoading}>\\n\\t\\t\\t\\t\\t\\t\\t{t('Add')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t\\t\\t{isError && errorKey && <FieldError>{t(errorKey)}</FieldError>}\\n\\t\\t\\t\\t\\t<FieldHint>{t('Federation_Example_matrix_server')}</FieldHint>\\n\\t\\t\\t\\t</Field>\\n\\t\\t\\t\\t<Divider mb={16} />\\n\\t\\t\\t\\t{!isLoadingServerList && data?.servers && <MatrixFederationRemoveServerList servers={data.servers} />}\\n\\t\\t\\t</Modal.Content>\\n\\t\\t\\t<Modal.Footer>\\n\\t\\t\\t\\t<ButtonGroup>\\n\\t\\t\\t\\t\\t<Button onClick={onClickClose}>{t('Cancel')}</Button>\\n\\t\\t\\t\\t</ButtonGroup>\\n\\t\\t\\t</Modal.Footer>\\n\\t\\t</Modal>\\n\\t);\\n};\\n\\nexport default MatrixFederationAddServerModal;\\n\",null],\"names\":[\"Divider\",\"Modal\",\"ButtonGroup\",\"Button\",\"Field\",\"TextInput\",\"FieldLabel\",\"FieldRow\",\"FieldError\",\"FieldHint\",\"useSetModal\",\"useTranslation\",\"useEndpoint\",\"useToastMessageDispatch\",\"useMutation\",\"useQueryClient\",\"React\",\"useState\",\"MatrixFederationRemoveServerList\",\"MatrixFederationSearch\",\"useMatrixServerList\",\"module\",\"link\",\"v\",\"default\",\"getErrorKey\",\"error\",\"exportDefault\",\"_ref\",\"onClickClose\",\"t\",\"addMatrixServer\",\"serverName\",\"setServerName\",\"errorKey\",\"setErrorKey\",\"setModal\",\"queryClient\",\"dispatchToastMessage\",\"mutate\",\"addServer\",\"isLoading\",\"isError\",\"onSuccess\",\"invalidateQueries\",\"createElement\",\"defaultSelectedServer\",\"onClose\",\"key\",\"onError\",\"type\",\"message\",\"data\",\"isLoadingServerList\",\"maxHeight\",\"Header\",\"Title\",\"Close\",\"onClick\",\"Content\",\"disabled\",\"value\",\"onChange\",\"e\",\"currentTarget\",\"undefined\",\"mie\",\"primary\",\"loading\",\"mb\",\"servers\",\"Footer\"],\"mappings\":\"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\"}"}