{"code":"function module(e,n,t){t.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(e){i=e}},0),t.link(\"@babel/runtime/regenerator\",{default:function(e){o=e}},1),t.export({useWebRTCVideoRoomAction:function(){return f}}),t.link(\"@rocket.chat/core-typings\",{isRoomFederated:function(e){l=e}},0),t.link(\"@rocket.chat/ui-contexts\",{useSetting:function(e){r=e}},1),t.link(\"react\",{useCallback:function(e){a=e},useMemo:function(e){c=e}},2),t.link(\"react-i18next\",{useTranslation:function(e){u=e}},3),t.link(\"../../../app/utils/client/lib/SDKClient\",{sdk:function(e){s=e}},4),t.link(\"../../views/room/contexts/RoomContext\",{useRoom:function(e){d=e}},5);var i,o,l,r,a,c,u,s,d,f=function(){var e=r(\"WebRTC_Enabled\",!1),n=d(),t=l(n),f=r(\"Omnichannel_call_provider\",\"default-provider\"),b=e&&\"WebRTC\"===f&&n.servedBy,p=u().t,k=a(function(){return o.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!n.callStatus||\"declined\"===n.callStatus||\"ended\"===n.callStatus)){e.next=3;break}return e.next=3,o.awrap(s.rest.get(\"/v1/livechat/webrtc.call\",{rid:n._id}));case 3:window.open(\"/meet/\"+n._id,n._id);case 4:case\"end\":return e.stop()}},null,null,null,Promise)},[n._id,n.callStatus]);return c(function(){if(b)return i(i({id:\"webRTCVideo\",groups:[\"live\"],title:\"WebRTC_Call\",icon:\"phone\"},t&&{tooltip:p(\"core.Call_unavailable_for_federation\"),disabled:!0}),{},{action:function(){k()},full:!0,order:4})},[b,t,k,p])}}","map":"{\"version\":3,\"sources\":[\"client/hooks/roomActions/useWebRTCVideoRoomAction.ts\",\"<anon>\"],\"sourcesContent\":[\"import { isRoomFederated } from '@rocket.chat/core-typings';\\nimport { useSetting } from '@rocket.chat/ui-contexts';\\nimport { useCallback, useMemo } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { sdk } from '../../../app/utils/client/lib/SDKClient';\\nimport { useRoom } from '../../views/room/contexts/RoomContext';\\nimport type { RoomToolboxActionConfig } from '../../views/room/contexts/RoomToolboxContext';\\n\\nexport const useWebRTCVideoRoomAction = () => {\\n\\tconst enabled = useSetting('WebRTC_Enabled', false);\\n\\tconst room = useRoom();\\n\\tconst federated = isRoomFederated(room);\\n\\tconst callProvider = useSetting<string>('Omnichannel_call_provider', 'default-provider');\\n\\n\\tconst allowed = enabled && callProvider === 'WebRTC' && room.servedBy;\\n\\n\\tconst { t } = useTranslation();\\n\\n\\tconst handleClick = useCallback(async () => {\\n\\t\\tif (!room.callStatus || room.callStatus === 'declined' || room.callStatus === 'ended') {\\n\\t\\t\\tawait sdk.rest.get('/v1/livechat/webrtc.call', { rid: room._id });\\n\\t\\t}\\n\\t\\twindow.open(`/meet/${room._id}`, room._id);\\n\\t}, [room._id, room.callStatus]);\\n\\n\\treturn useMemo((): RoomToolboxActionConfig | undefined => {\\n\\t\\tif (!allowed) {\\n\\t\\t\\treturn undefined;\\n\\t\\t}\\n\\n\\t\\treturn {\\n\\t\\t\\tid: 'webRTCVideo',\\n\\t\\t\\tgroups: ['live'],\\n\\t\\t\\ttitle: 'WebRTC_Call',\\n\\t\\t\\ticon: 'phone',\\n\\t\\t\\t...(federated && {\\n\\t\\t\\t\\ttooltip: t('core.Call_unavailable_for_federation'),\\n\\t\\t\\t\\tdisabled: true,\\n\\t\\t\\t}),\\n\\t\\t\\taction: () => void handleClick(),\\n\\t\\t\\tfull: true,\\n\\t\\t\\torder: 4,\\n\\t\\t};\\n\\t}, [allowed, federated, handleClick, t]);\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_objectSpread\",\"_regeneratorRuntime\",\"export\",\"useWebRTCVideoRoomAction\",\"isRoomFederated\",\"useSetting\",\"useCallback\",\"useMemo\",\"useTranslation\",\"sdk\",\"useRoom\",\"enabled\",\"room\",\"federated\",\"callProvider\",\"allowed\",\"servedBy\",\"t\",\"_useTranslation\",\"handleClick\",\"async\",\"_context\",\"prev\",\"next\",\"callStatus\",\"awrap\",\"rest\",\"get\",\"rid\",\"_id\",\"window\",\"open\",\"stop\",\"Promise\",\"id\",\"groups\",\"title\",\"icon\",\"tooltip\",\"disabled\",\"action\",\"full\",\"order\"],\"mappings\":\"uBAASA,EAAeC,IAAE,CAAA,uCAAkC,CAAAC,QAAA,SAAAC,CAAA,EAAAC,EAAAD,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,6BAAA,CAAAC,QAAA,SAAAC,CAAA,EAAAE,EAAAF,CAAA,CAAA,EAAA,GAA5DH,EAAOM,MAAE,CAAA,CAAAC,yBAAuB,WAAA,OAAAA,CAA4B,CAAA,GAAAP,EAAAC,IAAA,CAAA,4BAAA,CAAAO,gBAAA,SAAAL,CAAA,EAAAK,EAAAL,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,2BAAA,CAAAQ,WAAA,SAAAN,CAAA,EAAAM,EAAAN,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAAS,YAAA,SAAAP,CAAA,EAAAO,EAAAP,CAAA,EAAAQ,QAAA,SAAAR,CAAA,EAAAQ,EAAAR,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,gBAAA,CAAAW,eAAA,SAAAT,CAAA,EAAAS,EAAAT,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,0CAAA,CAAAY,IAAA,SAAAV,CAAA,EAAAU,EAAAV,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,wCAAA,CAAAa,QAAA,SAAAX,CAAA,EAAAW,EAAAX,CAAA,CAAA,EAAA,GASrD,IATPC,EAA4DC,EAAAG,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAS/CP,EAA2B,WACvC,IAAMQ,EAAUN,EAAW,iBAAkB,CAAA,GACvCO,EAAOF,IACPG,EAAYT,EAAgBQ,GAC5BE,EAAeT,EAAmB,4BAA6B,oBAE/DU,EAAUJ,GAAWG,AAAiB,WAAjBA,GAA6BF,EAAKI,QAAQ,CAE7DC,EAACC,AAAKV,IAANS,CAAC,CAEHE,EAAcb,EAAY,WAAA,OAAAL,EAAAmB,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,GAAA,CAC3B,CAAA,CAACX,EAAKY,UAAU,EAAIZ,AAAoB,aAApBA,EAAKY,UAAU,EAAmBZ,AAAoB,UAApBA,EAAKY,UAAU,AAAK,EAAO,CAAAH,EAAAE,IAAA,CAAA,EAAA,KAAA,CAAA,OAAAF,EAAAE,IAAA,CAAA,EAAAtB,EAAAwB,KAAA,CAC9EhB,EAAIiB,IAAI,CAACC,GAAG,CAAC,2BAA4B,CAAEC,IAAKhB,EAAKiB,GAAAA,AAAG,GAAG,MAAA,EAElEC,OAAOC,IAAI,CAAA,SAAUnB,EAAKiB,GAAG,CAAIjB,EAAKiB,GAAG,CAAE,MAAA,EAAA,IAAA,MAAA,OAAAR,EAAAW,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EACzC,CAACrB,EAAKiB,GAAG,CAAEjB,EAAKY,UAAU,CAAC,EAE9B,OAAOjB,EAAQ,WACd,GAAKQ,EAIL,OAAAf,EAAAA,EAAA,CACCkC,GAAI,cACJC,OAAQ,CAAC,OAAO,CAChBC,MAAO,cACPC,KAAM,OAAO,EACTxB,GAAa,CAChByB,QAASrB,EAAE,wCACXsB,SAAU,CAAA,IACV,CAAA,EAAA,CACDC,OAAQ,WAAWrB,GAAa,EAChCsB,KAAM,CAAA,EACNC,MAAO,CAAC,EAEV,EAAG,CAAC3B,EAASF,EAAWM,EAAaF,EAAE,CACxC\"}"}