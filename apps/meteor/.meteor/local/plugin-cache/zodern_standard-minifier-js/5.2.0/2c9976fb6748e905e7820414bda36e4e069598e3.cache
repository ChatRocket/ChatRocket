{"code":"function module(e,n,t){let o,i,r,l,s,a,p,c,m,u,d,g,_;t.link(\"meteor/meteor\",{Meteor(e){o=e}},0),t.link(\"meteor/tracker\",{Tracker(e){i=e}},1),t.link(\"../../app/authorization/client\",{hasRole(e){r=e}},2),t.link(\"../../app/models/client\",{Roles(e){l=e}},3),t.link(\"../../app/settings/client\",{settings(e){s=e}},4),t.link(\"../../app/utils/client/lib/SDKClient\",{sdk(e){a=e}},5),t.link(\"../../app/utils/lib/i18n\",{t(e){p=e}},6),t.link(\"../components/FingerprintChangeModal\",{default(e){c=e}},7),t.link(\"../components/FingerprintChangeModalConfirmation\",{default(e){m=e}},8),t.link(\"../components/UrlChangeModal\",{default(e){u=e}},9),t.link(\"../lib/imperativeModal\",{imperativeModal(e){d=e}},10),t.link(\"../lib/toast\",{dispatchToastMessage(e){g=e}},11),t.link(\"../lib/userData\",{isSyncReady(e){_=e}},12),o.startup(()=>{i.autorun(e=>{let n=o.userId();if(!n||!l.ready.get()||!_.get())return;if(!1===r(n,\"admin\"))return e.stop();let t=s.get(\"Site_Url\");if(!t)return;let i=location.origin+window.__meteor_runtime_config__.ROOT_URL_PATH_PREFIX;window.__meteor_runtime_config__.ROOT_URL.replace(/\\/$/,\"\")!==i&&d.open({component:u,props:{onConfirm:()=>{d.close(),a.call(\"saveSetting\",\"Site_Url\",i).then(()=>{g({type:\"success\",message:p(\"Saved\")})})},siteUrl:t,currentUrl:i,onClose:d.close}});let c=s.get(\"Document_Domain\");return c&&(window.document.domain=c),e.stop()})}),o.startup(()=>{i.autorun(e=>{let n=o.userId();if(!n||!l.ready.get()||!_.get())return;if(!1===r(n,\"admin\"))return e.stop();let t=s.get(\"Deployment_FingerPrint_Verified\");if(null==t||!0===t)return;let i=()=>{d.close(),a.rest.post(\"/v1/fingerprint\",{setDeploymentAs:\"updated-configuration\"}).then(()=>{g({type:\"success\",message:p(\"Configuration_update_confirmed\")})})},u=()=>{d.close(),a.rest.post(\"/v1/fingerprint\",{setDeploymentAs:\"new-workspace\"}).then(()=>{g({type:\"success\",message:p(\"New_workspace_confirmed\")})})},f=()=>{d.open({component:c,props:{onConfirm:()=>{d.open({component:m,props:{onConfirm:u,onCancel:f,newWorkspace:!0}})},onCancel:()=>{d.open({component:m,props:{onConfirm:i,onCancel:f,newWorkspace:!1}})},onClose:d.close}})};return f(),e.stop()})})}","map":"{\"version\":3,\"sources\":[\"client/startup/rootUrlChange.ts\",\"<anon>\"],\"sourcesContent\":[\"import { Meteor } from 'meteor/meteor';\\nimport { Tracker } from 'meteor/tracker';\\n\\nimport { hasRole } from '../../app/authorization/client';\\nimport { Roles } from '../../app/models/client';\\nimport { settings } from '../../app/settings/client';\\nimport { sdk } from '../../app/utils/client/lib/SDKClient';\\nimport { t } from '../../app/utils/lib/i18n';\\nimport FingerprintChangeModal from '../components/FingerprintChangeModal';\\nimport FingerprintChangeModalConfirmation from '../components/FingerprintChangeModalConfirmation';\\nimport UrlChangeModal from '../components/UrlChangeModal';\\nimport { imperativeModal } from '../lib/imperativeModal';\\nimport { dispatchToastMessage } from '../lib/toast';\\nimport { isSyncReady } from '../lib/userData';\\n\\nMeteor.startup(() => {\\n\\tTracker.autorun((c) => {\\n\\t\\tconst userId = Meteor.userId();\\n\\t\\tif (!userId) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tif (!Roles.ready.get() || !isSyncReady.get()) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tif (hasRole(userId, 'admin') === false) {\\n\\t\\t\\treturn c.stop();\\n\\t\\t}\\n\\n\\t\\tconst siteUrl = settings.get('Site_Url');\\n\\t\\tif (!siteUrl) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tconst currentUrl = location.origin + window.__meteor_runtime_config__.ROOT_URL_PATH_PREFIX;\\n\\t\\tif (window.__meteor_runtime_config__.ROOT_URL.replace(/\\\\/$/, '') !== currentUrl) {\\n\\t\\t\\tconst confirm = (): void => {\\n\\t\\t\\t\\timperativeModal.close();\\n\\t\\t\\t\\tvoid sdk.call('saveSetting', 'Site_Url', currentUrl).then(() => {\\n\\t\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Saved') });\\n\\t\\t\\t\\t});\\n\\t\\t\\t};\\n\\t\\t\\timperativeModal.open({\\n\\t\\t\\t\\tcomponent: UrlChangeModal,\\n\\t\\t\\t\\tprops: {\\n\\t\\t\\t\\t\\tonConfirm: confirm,\\n\\t\\t\\t\\t\\tsiteUrl,\\n\\t\\t\\t\\t\\tcurrentUrl,\\n\\t\\t\\t\\t\\tonClose: imperativeModal.close,\\n\\t\\t\\t\\t},\\n\\t\\t\\t});\\n\\t\\t}\\n\\n\\t\\tconst documentDomain = settings.get('Document_Domain');\\n\\t\\tif (documentDomain) {\\n\\t\\t\\twindow.document.domain = documentDomain;\\n\\t\\t}\\n\\n\\t\\treturn c.stop();\\n\\t});\\n});\\n\\nMeteor.startup(() => {\\n\\tTracker.autorun((c) => {\\n\\t\\tconst userId = Meteor.userId();\\n\\t\\tif (!userId) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tif (!Roles.ready.get() || !isSyncReady.get()) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tif (hasRole(userId, 'admin') === false) {\\n\\t\\t\\treturn c.stop();\\n\\t\\t}\\n\\n\\t\\tconst deploymentFingerPrintVerified = settings.get('Deployment_FingerPrint_Verified');\\n\\t\\tif (deploymentFingerPrintVerified == null || deploymentFingerPrintVerified === true) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tconst updateWorkspace = (): void => {\\n\\t\\t\\timperativeModal.close();\\n\\t\\t\\tvoid sdk.rest.post('/v1/fingerprint', { setDeploymentAs: 'updated-configuration' }).then(() => {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Configuration_update_confirmed') });\\n\\t\\t\\t});\\n\\t\\t};\\n\\n\\t\\tconst setNewWorkspace = (): void => {\\n\\t\\t\\timperativeModal.close();\\n\\t\\t\\tvoid sdk.rest.post('/v1/fingerprint', { setDeploymentAs: 'new-workspace' }).then(() => {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('New_workspace_confirmed') });\\n\\t\\t\\t});\\n\\t\\t};\\n\\n\\t\\tconst openModal = (): void => {\\n\\t\\t\\timperativeModal.open({\\n\\t\\t\\t\\tcomponent: FingerprintChangeModal,\\n\\t\\t\\t\\tprops: {\\n\\t\\t\\t\\t\\tonConfirm: () => {\\n\\t\\t\\t\\t\\t\\timperativeModal.open({\\n\\t\\t\\t\\t\\t\\t\\tcomponent: FingerprintChangeModalConfirmation,\\n\\t\\t\\t\\t\\t\\t\\tprops: {\\n\\t\\t\\t\\t\\t\\t\\t\\tonConfirm: setNewWorkspace,\\n\\t\\t\\t\\t\\t\\t\\t\\tonCancel: openModal,\\n\\t\\t\\t\\t\\t\\t\\t\\tnewWorkspace: true,\\n\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\tonCancel: () => {\\n\\t\\t\\t\\t\\t\\timperativeModal.open({\\n\\t\\t\\t\\t\\t\\t\\tcomponent: FingerprintChangeModalConfirmation,\\n\\t\\t\\t\\t\\t\\t\\tprops: {\\n\\t\\t\\t\\t\\t\\t\\t\\tonConfirm: updateWorkspace,\\n\\t\\t\\t\\t\\t\\t\\t\\tonCancel: openModal,\\n\\t\\t\\t\\t\\t\\t\\t\\tnewWorkspace: false,\\n\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\tonClose: imperativeModal.close,\\n\\t\\t\\t\\t},\\n\\t\\t\\t});\\n\\t\\t};\\n\\n\\t\\topenModal();\\n\\n\\t\\treturn c.stop();\\n\\t});\\n});\\n\",null],\"names\":[\"Meteor\",\"Tracker\",\"hasRole\",\"Roles\",\"settings\",\"sdk\",\"t\",\"FingerprintChangeModal\",\"FingerprintChangeModalConfirmation\",\"UrlChangeModal\",\"imperativeModal\",\"dispatchToastMessage\",\"isSyncReady\",\"module\",\"link\",\"v\",\"default\",\"startup\",\"autorun\",\"c\",\"userId\",\"ready\",\"get\",\"stop\",\"siteUrl\",\"currentUrl\",\"location\",\"origin\",\"window\",\"__meteor_runtime_config__\",\"ROOT_URL_PATH_PREFIX\",\"ROOT_URL\",\"replace\",\"open\",\"component\",\"props\",\"onConfirm\",\"confirm\",\"close\",\"call\",\"then\",\"type\",\"message\",\"onClose\",\"documentDomain\",\"document\",\"domain\",\"deploymentFingerPrintVerified\",\"updateWorkspace\",\"rest\",\"post\",\"setDeploymentAs\",\"setNewWorkspace\",\"openModal\",\"onCancel\",\"newWorkspace\"],\"mappings\":\"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\"}"}