{"code":"function module(t,o,n){let e,a,s,r,i,c,l,u,d,_,g;n.link(\"@babel/runtime/helpers/objectSpread2\",{default(t){e=t}},0),n.export({useTagsSection:()=>S}),n.link(\"@rocket.chat/fuselage\",{Palette(t){a=t}},0),n.link(\"@rocket.chat/ui-contexts\",{useEndpoint(t){s=t},useTranslation(t){r=t}},1),n.link(\"@tanstack/react-query\",{useQuery(t){i=t}},2),n.link(\"react\",{useMemo(t){c=t}},3),n.link(\"../../../components/dashboards/periods\",{getPeriodRange(t){l=t}},4),n.link(\"../../../components/dashboards/usePeriodSelectorStorage\",{usePeriodSelectorStorage(t){u=t}},5),n.link(\"../components/constants\",{PERIOD_OPTIONS(t){d=t}},6),n.link(\"../utils/formatPeriodDescription\",{formatPeriodDescription(t){_=t}},7),n.link(\"./useDefaultDownload\",{useDefaultDownload(t){g=t}},8);let p={warning:a.statusColor[\"status-font-on-warning\"].toString(),danger:a.statusColor[\"status-font-on-danger\"].toString(),success:a.statusColor[\"status-font-on-success\"].toString(),info:a.statusColor[\"status-font-on-info\"].toString()},f=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map(t=>e(e({},t),{},{color:p.info}))},S=()=>{let t=r(),[o,n]=u(\"reports-tags-period\",d),a=s(\"GET\",\"/v1/livechat/analytics/dashboards/conversations-by-tags\"),{data:{data:p,total:S=0,unspecified:h=0}={data:[],total:0},refetch:m,isLoading:k,isError:b,isSuccess:v}=i([\"omnichannel-reports\",\"conversations-by-tags\",o],async()=>{let{start:t,end:n}=l(o),s=await a({start:t.toISOString(),end:n.toISOString()});return e(e({},s),{},{data:f(s.data)})},{refetchInterval:3e5}),y=t(\"Conversations_by_tag\"),D=t(\"__count__tags__and__count__conversations__period__\",{count:p.length,conversations:S,period:_(o,t)}),P=h>0?\"(\".concat(t(\"__count__without__tags__\",{count:h}),\")\"):\"\",w=\"\".concat(D,\" \").concat(P),O=t(\"Omnichannel_Reports_Tags_Empty_Subtitle\"),T=g({columnName:t(\"Tags\"),title:y,data:p,period:o});return c(()=>({id:\"conversations-by-tags\",title:y,subtitle:w,emptyStateSubtitle:O,data:p,total:S,period:o,periodSelectorProps:n,downloadProps:T,isError:b,isLoading:k,isDataFound:v&&p.length>0,onRetry:m}),[y,w,O,p,S,b,k,v,n,o,T,m])}}","map":"{\"version\":3,\"sources\":[\"client/omnichannel/reports/hooks/useTagsSection.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Palette } from '@rocket.chat/fuselage';\\nimport { useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\\nimport { useQuery } from '@tanstack/react-query';\\nimport { useMemo } from 'react';\\n\\nimport { getPeriodRange } from '../../../components/dashboards/periods';\\nimport { usePeriodSelectorStorage } from '../../../components/dashboards/usePeriodSelectorStorage';\\nimport { PERIOD_OPTIONS } from '../components/constants';\\nimport { formatPeriodDescription } from '../utils/formatPeriodDescription';\\nimport { useDefaultDownload } from './useDefaultDownload';\\n\\nconst colors = {\\n\\twarning: Palette.statusColor['status-font-on-warning'].toString(),\\n\\tdanger: Palette.statusColor['status-font-on-danger'].toString(),\\n\\tsuccess: Palette.statusColor['status-font-on-success'].toString(),\\n\\tinfo: Palette.statusColor['status-font-on-info'].toString(),\\n};\\n\\nconst formatChartData = (data: { label: string; value: number }[] | undefined = []) =>\\n\\tdata.map((item) => ({\\n\\t\\t...item,\\n\\t\\tcolor: colors.info,\\n\\t}));\\n\\nexport const useTagsSection = () => {\\n\\tconst t = useTranslation();\\n\\tconst [period, periodSelectorProps] = usePeriodSelectorStorage('reports-tags-period', PERIOD_OPTIONS);\\n\\tconst getConversationsByTags = useEndpoint('GET', '/v1/livechat/analytics/dashboards/conversations-by-tags');\\n\\n\\tconst {\\n\\t\\tdata: { data, total = 0, unspecified = 0 } = { data: [], total: 0 },\\n\\t\\trefetch,\\n\\t\\tisLoading,\\n\\t\\tisError,\\n\\t\\tisSuccess,\\n\\t} = useQuery(\\n\\t\\t['omnichannel-reports', 'conversations-by-tags', period],\\n\\t\\tasync () => {\\n\\t\\t\\tconst { start, end } = getPeriodRange(period);\\n\\t\\t\\tconst response = await getConversationsByTags({ start: start.toISOString(), end: end.toISOString() });\\n\\t\\t\\treturn { ...response, data: formatChartData(response.data) };\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\trefetchInterval: 5 * 60 * 1000,\\n\\t\\t},\\n\\t);\\n\\n\\tconst title = t('Conversations_by_tag');\\n\\tconst subtitleTotals = t('__count__tags__and__count__conversations__period__', {\\n\\t\\tcount: data.length,\\n\\t\\tconversations: total,\\n\\t\\tperiod: formatPeriodDescription(period, t),\\n\\t});\\n\\tconst subtitleUnspecified = unspecified > 0 ? `(${t('__count__without__tags__', { count: unspecified })})` : '';\\n\\tconst subtitle = `${subtitleTotals} ${subtitleUnspecified}`;\\n\\tconst emptyStateSubtitle = t('Omnichannel_Reports_Tags_Empty_Subtitle');\\n\\n\\tconst downloadProps = useDefaultDownload({ columnName: t('Tags'), title, data, period });\\n\\n\\treturn useMemo(\\n\\t\\t() => ({\\n\\t\\t\\tid: 'conversations-by-tags',\\n\\t\\t\\ttitle,\\n\\t\\t\\tsubtitle,\\n\\t\\t\\temptyStateSubtitle,\\n\\t\\t\\tdata,\\n\\t\\t\\ttotal,\\n\\t\\t\\tperiod,\\n\\t\\t\\tperiodSelectorProps,\\n\\t\\t\\tdownloadProps,\\n\\t\\t\\tisError,\\n\\t\\t\\tisLoading,\\n\\t\\t\\tisDataFound: isSuccess && data.length > 0,\\n\\t\\t\\tonRetry: refetch,\\n\\t\\t}),\\n\\t\\t[title, subtitle, emptyStateSubtitle, data, total, isError, isLoading, isSuccess, periodSelectorProps, period, downloadProps, refetch],\\n\\t);\\n};\\n\",null],\"names\":[\"_objectSpread\",\"Palette\",\"useEndpoint\",\"useTranslation\",\"useQuery\",\"useMemo\",\"getPeriodRange\",\"usePeriodSelectorStorage\",\"PERIOD_OPTIONS\",\"formatPeriodDescription\",\"useDefaultDownload\",\"module\",\"link\",\"default\",\"v\",\"export\",\"useTagsSection\",\"colors\",\"warning\",\"statusColor\",\"toString\",\"danger\",\"success\",\"info\",\"formatChartData\",\"data\",\"arguments\",\"length\",\"undefined\",\"map\",\"item\",\"color\",\"t\",\"period\",\"periodSelectorProps\",\"getConversationsByTags\",\"total\",\"unspecified\",\"refetch\",\"isLoading\",\"isError\",\"isSuccess\",\"start\",\"end\",\"response\",\"toISOString\",\"refetchInterval\",\"title\",\"subtitleTotals\",\"count\",\"conversations\",\"subtitleUnspecified\",\"concat\",\"subtitle\",\"emptyStateSubtitle\",\"downloadProps\",\"columnName\",\"id\",\"isDataFound\",\"onRetry\"],\"mappings\":\"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\"}"}