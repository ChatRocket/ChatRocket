{"code":"function module(e,t,a){var r;let n,l,o,i,s,c,u,d,f;a.link(\"@babel/runtime/helpers/taggedTemplateLiteral\",{default(e){n=e}},0),a.link(\"@babel/runtime/helpers/asyncIterator\",{default(e){l=e}},1),a.link(\"@rocket.chat/css-in-js\",{css(e){o=e}},0),a.link(\"@rocket.chat/fuselage\",{Box(e){i=e}},1),a.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback(e){s=e}},2),a.link(\"react\",{default(e){c=e},memo(e){u=e}},3),a.link(\"react-i18next\",{useTranslation(e){d=e}},4),a.link(\"../../../hooks/useFormatDateAndTime\",{useFormatDateAndTime(e){f=e}},5),a.exportDefault(u(function(e){let{enabled:t,reason:u,onFileDrop:m,visible:p=!0,onDismiss:y}=e,{t:g}=d(),h=s(e=>{e.stopPropagation(),null==y||y()}),k=s(e=>{e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect=[\"move\",\"linkMove\"].includes(e.dataTransfer.effectAllowed)?\"move\":\"copy\"}),b=f(),v=s(async e=>{e.stopPropagation(),null==y||y(),e.preventDefault();let t=Array.from(e.dataTransfer.files);if(e.dataTransfer.types.includes(\"text/uri-list\")&&e.dataTransfer.types.includes(\"text/html\")){let c=document.createRange().createContextualFragment(e.dataTransfer.getData(\"text/html\"));var r=!1,n=!1;try{for(var o,i,s=l(Array.from(c.querySelectorAll(\"img\")));r=!(i=await s.next()).done;r=!1){let{src:e}=i.value;try{let r=await fetch(e),n=await r.blob(),l=(await a.dynamicImport(\"../../../../app/utils/lib/mimeTypes\")).mime.extension(n.type),o=\"File - \".concat(b(new Date),\".\").concat(l),i=new File([n],o,{type:n.type});t.push(i)}catch(e){console.warn(e)}}}catch(e){n=!0,o=e}finally{try{r&&null!=s.return&&await s.return()}finally{if(n)throw o}}}null==m||m(t)});return p?c.createElement(i,{role:\"dialog\",\"data-qa\":\"DropTargetOverlay\",position:\"absolute\",zIndex:1e6,inset:0,display:\"flex\",alignItems:\"center\",justifyContent:\"center\",fontScale:\"hero\",textAlign:\"center\",backgroundColor:\"rgba(255, 255, 255, 0.8)\",borderWidth:4,borderStyle:\"dashed\",borderColor:\"currentColor\",color:t?\"primary\":\"danger\",className:o(r||(r=n([\"\\n\t\t\t\tanimation-name: zoomIn;\\n\t\t\t\tanimation-duration: 0.1s;\\n\t\t\t\"]))),onDragLeave:h,onDragOver:k,onDrop:v},t?g(\"Drop_to_upload_file\"):u):null}))}","map":"{\"version\":3,\"sources\":[\"client/views/room/body/DropTargetOverlay.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { css } from '@rocket.chat/css-in-js';\\nimport { Box } from '@rocket.chat/fuselage';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport type { DragEvent, ReactElement, ReactNode } from 'react';\\nimport React, { memo } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { useFormatDateAndTime } from '../../../hooks/useFormatDateAndTime';\\n\\ntype DropTargetOverlayProps = {\\n\\tenabled: boolean;\\n\\treason?: ReactNode;\\n\\tonFileDrop?: (files: File[]) => void;\\n\\tvisible?: boolean;\\n\\tonDismiss?: () => void;\\n};\\n\\nfunction DropTargetOverlay({ enabled, reason, onFileDrop, visible = true, onDismiss }: DropTargetOverlayProps): ReactElement | null {\\n\\tconst { t } = useTranslation();\\n\\n\\tconst handleDragLeave = useMutableCallback((event: DragEvent) => {\\n\\t\\tevent.stopPropagation();\\n\\t\\tonDismiss?.();\\n\\t});\\n\\n\\tconst handleDragOver = useMutableCallback((event: DragEvent) => {\\n\\t\\tevent.stopPropagation();\\n\\n\\t\\tevent.preventDefault();\\n\\t\\tevent.dataTransfer.dropEffect = ['move', 'linkMove'].includes(event.dataTransfer.effectAllowed) ? 'move' : 'copy';\\n\\t});\\n\\n\\tconst formatDateAndTime = useFormatDateAndTime();\\n\\n\\tconst handleDrop = useMutableCallback(async (event: DragEvent) => {\\n\\t\\tevent.stopPropagation();\\n\\t\\tonDismiss?.();\\n\\n\\t\\tevent.preventDefault();\\n\\n\\t\\tconst files = Array.from(event.dataTransfer.files);\\n\\n\\t\\tif (event.dataTransfer.types.includes('text/uri-list') && event.dataTransfer.types.includes('text/html')) {\\n\\t\\t\\tconst fragment = document.createRange().createContextualFragment(event.dataTransfer.getData('text/html'));\\n\\t\\t\\tfor await (const { src } of Array.from(fragment.querySelectorAll('img'))) {\\n\\t\\t\\t\\ttry {\\n\\t\\t\\t\\t\\tconst response = await fetch(src);\\n\\t\\t\\t\\t\\tconst data = await response.blob();\\n\\t\\t\\t\\t\\tconst extension = (await import('../../../../app/utils/lib/mimeTypes')).mime.extension(data.type);\\n\\t\\t\\t\\t\\tconst filename = `File - ${formatDateAndTime(new Date())}.${extension}`;\\n\\t\\t\\t\\t\\tconst file = new File([data], filename, { type: data.type });\\n\\t\\t\\t\\t\\tfiles.push(file);\\n\\t\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\t\\tconsole.warn(error);\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\n\\t\\tonFileDrop?.(files);\\n\\t});\\n\\n\\tif (!visible) {\\n\\t\\treturn null;\\n\\t}\\n\\n\\treturn (\\n\\t\\t<Box\\n\\t\\t\\trole='dialog'\\n\\t\\t\\tdata-qa='DropTargetOverlay'\\n\\t\\t\\tposition='absolute'\\n\\t\\t\\tzIndex={1_000_000}\\n\\t\\t\\tinset={0}\\n\\t\\t\\tdisplay='flex'\\n\\t\\t\\talignItems='center'\\n\\t\\t\\tjustifyContent='center'\\n\\t\\t\\tfontScale='hero'\\n\\t\\t\\ttextAlign='center'\\n\\t\\t\\tbackgroundColor='rgba(255, 255, 255, 0.8)'\\n\\t\\t\\tborderWidth={4}\\n\\t\\t\\tborderStyle='dashed'\\n\\t\\t\\tborderColor='currentColor'\\n\\t\\t\\tcolor={enabled ? 'primary' : 'danger'}\\n\\t\\t\\tclassName={css`\\n\\t\\t\\t\\tanimation-name: zoomIn;\\n\\t\\t\\t\\tanimation-duration: 0.1s;\\n\\t\\t\\t`}\\n\\t\\t\\tonDragLeave={handleDragLeave}\\n\\t\\t\\tonDragOver={handleDragOver}\\n\\t\\t\\tonDrop={handleDrop}\\n\\t\\t>\\n\\t\\t\\t{enabled ? t('Drop_to_upload_file') : reason}\\n\\t\\t</Box>\\n\\t);\\n}\\n\\nexport default memo(DropTargetOverlay);\\n\",null],\"names\":[\"_taggedTemplateLiteral\",\"_asyncIterator\",\"css\",\"Box\",\"useMutableCallback\",\"React\",\"memo\",\"useTranslation\",\"useFormatDateAndTime\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"enabled\",\"reason\",\"onFileDrop\",\"visible\",\"onDismiss\",\"t\",\"handleDragLeave\",\"event\",\"stopPropagation\",\"handleDragOver\",\"preventDefault\",\"dataTransfer\",\"dropEffect\",\"includes\",\"effectAllowed\",\"formatDateAndTime\",\"handleDrop\",\"files\",\"Array\",\"from\",\"types\",\"fragment\",\"document\",\"createRange\",\"createContextualFragment\",\"getData\",\"_iteratorAbruptCompletion\",\"_didIteratorError\",\"_iteratorError\",\"_step\",\"_iterator\",\"querySelectorAll\",\"next\",\"done\",\"src\",\"value\",\"response\",\"fetch\",\"data\",\"blob\",\"extension\",\"dynamicImport\",\"mime\",\"type\",\"filename\",\"concat\",\"Date\",\"file\",\"File\",\"push\",\"error\",\"console\",\"warn\",\"err\",\"return\",\"createElement\",\"role\",\"position\",\"zIndex\",\"inset\",\"display\",\"alignItems\",\"justifyContent\",\"fontScale\",\"textAlign\",\"backgroundColor\",\"borderWidth\",\"borderStyle\",\"borderColor\",\"color\",\"className\",\"_templateObject\",\"onDragLeave\",\"onDragOver\",\"onDrop\"],\"mappings\":\"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\"}"}