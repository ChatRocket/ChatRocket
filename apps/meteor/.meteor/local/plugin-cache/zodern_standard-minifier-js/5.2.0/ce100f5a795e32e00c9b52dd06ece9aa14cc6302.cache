{"code":"function module(e,t,a){let n,r,l,i,c,s,m,o,u;a.link(\"@rocket.chat/ui-contexts\",{useSetting(e){n=e},useUserId(e){r=e}},0),a.link(\"@tanstack/react-query\",{useQuery(e){l=e}},1),a.link(\"react\",{default(e){i=e},useMemo(e){c=e}},2),a.link(\"../../../app/livechat/client/externalFrame/crypto\",{encrypt(e){s=e},getKeyFromString(e){m=e}},3),a.link(\"../../../app/utils/client/lib/SDKClient\",{sdk(e){o=e}},4),a.link(\"../room/contexts/RoomContext\",{useRoom(e){u=e}},5),a.exportDefault(function(){let e=r(),t=u(),{\"X-Auth-Token\":a}=o.rest.getCredentials()||{},d=n(\"Omnichannel_External_Frame_Encryption_JWK\"),p=n(\"Omnichannel_External_Frame_URL\"),x=l([\"externalFrame\",d,a],async()=>d&&a?s(a,await m(d)):\"\"),k=c(()=>{if(!p||!e||!t._id||!a||!x.data)return\"\";let n=new URL(p);return n.searchParams.append(\"uid\",e),n.searchParams.append(\"rid\",t._id),n.searchParams.append(\"t\",a),n.toString()},[p,e,t._id,a,x.data]);return k?i.createElement(\"div\",{className:\"flex-nav\"},i.createElement(\"iframe\",{title:\"external-frame\",className:\"external-frame\",src:k})):null})}","map":"{\"version\":3,\"sources\":[\"client/views/omnichannel/ExternalFrameContainer.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { useSetting, useUserId } from '@rocket.chat/ui-contexts';\\nimport { useQuery } from '@tanstack/react-query';\\nimport React, { useMemo } from 'react';\\n\\nimport { encrypt, getKeyFromString } from '../../../app/livechat/client/externalFrame/crypto';\\nimport { sdk } from '../../../app/utils/client/lib/SDKClient';\\nimport { useRoom } from '../room/contexts/RoomContext';\\n\\nfunction ExternalFrameContainer() {\\n\\tconst uid = useUserId();\\n\\tconst room = useRoom();\\n\\tconst { 'X-Auth-Token': authToken } = sdk.rest.getCredentials() || {};\\n\\tconst keyStr = useSetting<string>('Omnichannel_External_Frame_Encryption_JWK');\\n\\tconst frameURLSetting = useSetting<string>('Omnichannel_External_Frame_URL');\\n\\n\\tconst token = useQuery(['externalFrame', keyStr, authToken], async () => {\\n\\t\\tif (!keyStr || !authToken) {\\n\\t\\t\\treturn '';\\n\\t\\t}\\n\\t\\treturn encrypt(authToken, await getKeyFromString(keyStr));\\n\\t});\\n\\n\\tconst externalFrameUrl = useMemo(() => {\\n\\t\\tif (!frameURLSetting || !uid || !room._id || !authToken || !token.data) {\\n\\t\\t\\treturn '';\\n\\t\\t}\\n\\t\\tconst frameURL = new URL(frameURLSetting);\\n\\n\\t\\tframeURL.searchParams.append('uid', uid);\\n\\t\\tframeURL.searchParams.append('rid', room._id);\\n\\t\\tframeURL.searchParams.append('t', authToken);\\n\\n\\t\\treturn frameURL.toString();\\n\\t}, [frameURLSetting, uid, room._id, authToken, token.data]);\\n\\n\\tif (!externalFrameUrl) {\\n\\t\\treturn null;\\n\\t}\\n\\n\\treturn (\\n\\t\\t<div className='flex-nav'>\\n\\t\\t\\t<iframe title='external-frame' className='external-frame' src={externalFrameUrl} />\\n\\t\\t</div>\\n\\t);\\n}\\n\\nexport default ExternalFrameContainer;\\n\",null],\"names\":[\"useSetting\",\"useUserId\",\"useQuery\",\"React\",\"useMemo\",\"encrypt\",\"getKeyFromString\",\"sdk\",\"useRoom\",\"module\",\"link\",\"v\",\"default\",\"exportDefault\",\"uid\",\"room\",\"authToken\",\"rest\",\"getCredentials\",\"keyStr\",\"frameURLSetting\",\"token\",\"externalFrameUrl\",\"_id\",\"data\",\"frameURL\",\"URL\",\"searchParams\",\"append\",\"toString\",\"createElement\",\"className\",\"title\",\"src\"],\"mappings\":\"2BAAAA,EAASC,EAAwDC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA5CC,EAAWC,IAAA,CAAA,2BAAgC,CAACV,WAAAW,CAAA,EAAAX,EAAAW,CAAA,EAAAV,UAAAU,CAAA,EAAAV,EAAAU,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,wBAAA,CAAAR,SAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,QAAA,CAAAE,QAAAD,CAAA,EAAAR,EAAAQ,CAAA,EAAAP,QAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,oDAAA,CAAAL,QAAAM,CAAA,EAAAN,EAAAM,CAAA,EAAAL,iBAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,0CAAA,CAAAH,IAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,+BAAA,CAAAF,QAAAG,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,GAAjEF,EAAOI,aAAY,CAQnB,WACC,IAAMC,EAAMb,IACNc,EAAOP,IACP,CAAE,eAAgBQ,CAAAA,CAAW,CAAGT,EAAIU,IAAI,CAACC,cAAc,IAAM,CAAA,EAC7DC,EAASnB,EAAmB,6CAC5BoB,EAAkBpB,EAAmB,kCAErCqB,EAAQnB,EAAS,CAAC,gBAAiBiB,EAAQH,EAAU,CAAE,SAC5D,AAAI,AAACG,GAAWH,EAGTX,EAAQW,EAAW,MAAMV,EAAiBa,IAFzC,IAKHG,EAAmBlB,EAAQ,KAChC,GAAI,CAACgB,GAAmB,CAACN,GAAO,CAACC,EAAKQ,GAAG,EAAI,CAACP,GAAa,CAACK,EAAMG,IAAI,CACrE,MAAO,GAER,IAAMC,EAAW,IAAIC,IAAIN,GAMzB,OAJAK,EAASE,YAAY,CAACC,MAAM,CAAC,MAAOd,GACpCW,EAASE,YAAY,CAACC,MAAM,CAAC,MAAOb,EAAKQ,GAAG,EAC5CE,EAASE,YAAY,CAACC,MAAM,CAAC,IAAKZ,GAE3BS,EAASI,QAAQ,EACzB,EAAG,CAACT,EAAiBN,EAAKC,EAAKQ,GAAG,CAAEP,EAAWK,EAAMG,IAAI,CAAC,SAE1D,AAAKF,EAKJnB,EAAA2B,aAAA,CAAA,MAAA,CAAKC,UAAU,UAAU,EACxB5B,EAAA2B,aAAA,CAAA,SAAA,CAAQE,MAAM,iBAAiBD,UAAU,iBAAiBE,IAAKX,CAAiB,IAL1E,IAQT\"}"}