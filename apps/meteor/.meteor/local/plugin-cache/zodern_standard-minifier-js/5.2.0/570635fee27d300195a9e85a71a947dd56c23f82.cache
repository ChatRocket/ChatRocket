{"code":"function module(t,r,e){e.export({getAvatarAsPng:function(){return a}}),e.link(\"../../../app/utils/client/getUserAvatarURL\",{getUserAvatarURL:function(t){n=t}},0);var n,a=function(t,r){var e=new Image,a=function(){return r(\"\")};return e.onload=function(){var t=document.createElement(\"canvas\");t.width=e.width,t.height=e.height;var n=t.getContext(\"2d\");if(!n)throw Error(\"failed to get canvas context\");n.drawImage(e,0,0);try{return r(t.toDataURL(\"image/png\"))}catch(t){return r(\"\")}},e.onerror=a,e.src=n(t||\"\"),a}}","map":"{\"version\":3,\"sources\":[\"client/lib/utils/getAvatarAsPng.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IUser } from '@rocket.chat/core-typings';\\n\\nimport { getUserAvatarURL } from '../../../app/utils/client/getUserAvatarURL';\\n\\nexport const getAvatarAsPng = (username: IUser['username'], cb: (dataURL: string) => void): (() => void) => {\\n\\tconst image = new Image();\\n\\n\\tconst onLoad = (): void => {\\n\\t\\tconst canvas = document.createElement('canvas');\\n\\t\\tcanvas.width = image.width;\\n\\t\\tcanvas.height = image.height;\\n\\t\\tconst context = canvas.getContext('2d');\\n\\n\\t\\tif (!context) {\\n\\t\\t\\tthrow new Error('failed to get canvas context');\\n\\t\\t}\\n\\n\\t\\tcontext.drawImage(image, 0, 0);\\n\\t\\ttry {\\n\\t\\t\\treturn cb(canvas.toDataURL('image/png'));\\n\\t\\t} catch (e) {\\n\\t\\t\\treturn cb('');\\n\\t\\t}\\n\\t};\\n\\n\\tconst onError = (): void => cb('');\\n\\n\\timage.onload = onLoad;\\n\\timage.onerror = onError;\\n\\timage.src = getUserAvatarURL(username || '') as string;\\n\\n\\treturn onError;\\n};\\n\",null],\"names\":[\"module\",\"export\",\"getAvatarAsPng\",\"link\",\"getUserAvatarURL\",\"v\",\"username\",\"cb\",\"image\",\"Image\",\"onError\",\"onload\",\"canvas\",\"document\",\"createElement\",\"width\",\"height\",\"context\",\"getContext\",\"Error\",\"drawImage\",\"toDataURL\",\"e\",\"onerror\",\"src\"],\"mappings\":\"uBAEAA,EAAOC,MAAE,CAAA,CAAAC,eAAkB,WAAM,OAAAA,CAAA,CAAA,GAA6CF,EAAAG,IAAA,CAAA,6CAAA,CAAAC,iBAAA,SAAAC,CAAA,EAAAD,EAAAC,CAAA,CAAA,EAAA,GAEvE,IAF0BD,EAEpBF,EAAiB,SAACI,CAA2B,CAAEC,CAA6B,EACxF,IAAMC,EAAQ,IAAIC,MAoBZC,EAAU,WAAA,OAAYH,EAAG,GAAG,EAMlC,OAJAC,EAAMG,MAAM,CApBG,WACd,IAAMC,EAASC,SAASC,aAAa,CAAC,SACtCF,CAAAA,EAAOG,KAAK,CAAGP,EAAMO,KAAK,CAC1BH,EAAOI,MAAM,CAAGR,EAAMQ,MAAM,CAC5B,IAAMC,EAAUL,EAAOM,UAAU,CAAC,MAElC,GAAI,CAACD,EACJ,MAAM,AAAIE,MAAM,gCAGjBF,EAAQG,SAAS,CAACZ,EAAO,EAAG,GAC5B,GAAI,CACH,OAAOD,EAAGK,EAAOS,SAAS,CAAC,aAC5B,CAAE,MAAOC,EAAG,CACX,OAAOf,EAAG,GACX,CACD,EAKAC,EAAMe,OAAO,CAAGb,EAChBF,EAAMgB,GAAG,CAAGpB,EAAiBE,GAAY,IAElCI,CACR\"}"}