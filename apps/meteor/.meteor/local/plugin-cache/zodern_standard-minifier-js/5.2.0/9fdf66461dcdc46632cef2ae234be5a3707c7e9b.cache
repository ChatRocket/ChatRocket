{"code":"function module(e,t,i){let s,n,a,r,l,o,u,_,d,c,k;i.link(\"@babel/runtime/helpers/objectSpread2\",{default(e){s=e}},0),i.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback(e){n=e}},0),i.link(\"@rocket.chat/ui-contexts\",{useEndpoint(e){a=e},useTranslation(e){r=e},useToastMessageDispatch(e){l=e}},1),i.link(\"react\",{default(e){o=e},useState(e){u=e},useEffect(e){_=e}},2),i.link(\"../../../../../hooks/useFormatDateAndTime\",{useFormatDateAndTime(e){d=e}},3),i.link(\"../../../contexts/RoomToolboxContext\",{useRoomToolbox(e){c=e}},4),i.link(\"./InviteUsers\",{default(e){k=e}},5),i.exportDefault(e=>{let{rid:t,onClickBack:i}=e,x=r(),m=l(),[{isEditing:f,url:p,caption:v,error:b,daysAndMaxUses:{days:U,maxUses:g}},E]=u({isEditing:!1,daysAndMaxUses:{days:\"1\",maxUses:\"0\"},url:\"\",caption:\"\",error:void 0}),{closeTab:T}=c(),y=d(),C=a(\"POST\",\"/v1/findOrCreateInvite\"),h=n(()=>E(e=>s(s({},e),{},{isEditing:!0}))),w=n(()=>E(e=>s(s({},e),{},{isEditing:!1}))),M=n(e=>{if(!e)return\"\";if(e.expires){let t=new Date(e.expires);if(e.maxUses){let i=e.maxUses-e.uses;return x(\"Your_invite_link_will_expire_on__date__or_after__usesLeft__uses\",{date:y(t),usesLeft:i})}return x(\"Your_invite_link_will_expire_on__date__\",{date:y(t)})}if(e.maxUses){let t=e.maxUses-e.uses;return x(\"Your_invite_link_will_expire_after__usesLeft__uses\",{usesLeft:t})}return x(\"Your_invite_link_will_never_expire\")});_(()=>{(async()=>{try{let e=await C({rid:t,days:Number(U),maxUses:Number(g)});E(t=>s(s({},t),{},{url:null==e?void 0:e.url,caption:M(e)})),m({type:\"success\",message:x(\"Invite_link_generated\")})}catch(e){E(t=>s(s({},t),{},{error:e}))}})()},[m,x,C,M,t,U,g]);let A=n(e=>{E(t=>s(s({},t),{},{daysAndMaxUses:e,isEditing:!1}))});return o.createElement(k,{isEditing:f,error:b,linkText:p,captionText:v,daysAndMaxUses:{days:U,maxUses:g},onClose:T,onClickBackMembers:i,onClickBackLink:w,onClickEdit:h,onClickNewLink:A})})}","map":"{\"version\":3,\"sources\":[\"client/views/room/contextualBar/RoomMembers/InviteUsers/InviteUsersWithData.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom } from '@rocket.chat/core-typings';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useEndpoint, useTranslation, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement } from 'react';\\nimport React, { useState, useEffect } from 'react';\\n\\nimport { useFormatDateAndTime } from '../../../../../hooks/useFormatDateAndTime';\\nimport { useRoomToolbox } from '../../../contexts/RoomToolboxContext';\\nimport InviteUsers from './InviteUsers';\\n\\ntype InviteUsersWithDataProps = {\\n\\trid: IRoom['_id'];\\n\\tonClickBack: () => void;\\n};\\n\\nconst InviteUsersWithData = ({ rid, onClickBack }: InviteUsersWithDataProps): ReactElement => {\\n\\tconst t = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst [\\n\\t\\t{\\n\\t\\t\\tisEditing,\\n\\t\\t\\turl,\\n\\t\\t\\tcaption,\\n\\t\\t\\terror,\\n\\t\\t\\tdaysAndMaxUses: { days, maxUses },\\n\\t\\t},\\n\\t\\tsetInviteState,\\n\\t] = useState({\\n\\t\\tisEditing: false,\\n\\t\\tdaysAndMaxUses: { days: '1', maxUses: '0' },\\n\\t\\turl: '',\\n\\t\\tcaption: '',\\n\\t\\terror: undefined as Error | undefined,\\n\\t});\\n\\n\\tconst { closeTab } = useRoomToolbox();\\n\\tconst format = useFormatDateAndTime();\\n\\tconst findOrCreateInvite = useEndpoint('POST', '/v1/findOrCreateInvite');\\n\\n\\tconst handleEdit = useMutableCallback(() => setInviteState((prevState) => ({ ...prevState, isEditing: true })));\\n\\tconst handleBackToLink = useMutableCallback(() => setInviteState((prevState) => ({ ...prevState, isEditing: false })));\\n\\n\\tconst linkExpirationText = useMutableCallback((data) => {\\n\\t\\tif (!data) {\\n\\t\\t\\treturn '';\\n\\t\\t}\\n\\n\\t\\tif (data.expires) {\\n\\t\\t\\tconst expiration = new Date(data.expires);\\n\\t\\t\\tif (data.maxUses) {\\n\\t\\t\\t\\tconst usesLeft = data.maxUses - data.uses;\\n\\t\\t\\t\\treturn t('Your_invite_link_will_expire_on__date__or_after__usesLeft__uses', {\\n\\t\\t\\t\\t\\tdate: format(expiration),\\n\\t\\t\\t\\t\\tusesLeft,\\n\\t\\t\\t\\t});\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn t('Your_invite_link_will_expire_on__date__', { date: format(expiration) });\\n\\t\\t}\\n\\n\\t\\tif (data.maxUses) {\\n\\t\\t\\tconst usesLeft = data.maxUses - data.uses;\\n\\t\\t\\treturn t('Your_invite_link_will_expire_after__usesLeft__uses', { usesLeft });\\n\\t\\t}\\n\\n\\t\\treturn t('Your_invite_link_will_never_expire');\\n\\t});\\n\\n\\tuseEffect(() => {\\n\\t\\t(async (): Promise<void> => {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tconst data = await findOrCreateInvite({ rid, days: Number(days), maxUses: Number(maxUses) });\\n\\t\\t\\t\\tsetInviteState((prevState) => ({ ...prevState, url: data?.url, caption: linkExpirationText(data) }));\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Invite_link_generated') });\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tsetInviteState((prevState) => ({ ...prevState, error: error as Error }));\\n\\t\\t\\t}\\n\\t\\t})();\\n\\t}, [dispatchToastMessage, t, findOrCreateInvite, linkExpirationText, rid, days, maxUses]);\\n\\n\\tconst handleGenerateLink = useMutableCallback((daysAndMaxUses) => {\\n\\t\\tsetInviteState((prevState) => ({ ...prevState, daysAndMaxUses, isEditing: false }));\\n\\t});\\n\\n\\treturn (\\n\\t\\t<InviteUsers\\n\\t\\t\\tisEditing={isEditing}\\n\\t\\t\\terror={error}\\n\\t\\t\\tlinkText={url}\\n\\t\\t\\tcaptionText={caption}\\n\\t\\t\\tdaysAndMaxUses={{ days, maxUses }}\\n\\t\\t\\tonClose={closeTab}\\n\\t\\t\\tonClickBackMembers={onClickBack}\\n\\t\\t\\tonClickBackLink={handleBackToLink}\\n\\t\\t\\tonClickEdit={handleEdit}\\n\\t\\t\\tonClickNewLink={handleGenerateLink}\\n\\t\\t/>\\n\\t);\\n};\\n\\nexport default InviteUsersWithData;\\n\",null],\"names\":[\"_objectSpread\",\"useMutableCallback\",\"useEndpoint\",\"useTranslation\",\"useToastMessageDispatch\",\"React\",\"useState\",\"useEffect\",\"useFormatDateAndTime\",\"useRoomToolbox\",\"InviteUsers\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"rid\",\"onClickBack\",\"t\",\"dispatchToastMessage\",\"isEditing\",\"url\",\"caption\",\"error\",\"daysAndMaxUses\",\"days\",\"maxUses\",\"setInviteState\",\"undefined\",\"closeTab\",\"format\",\"findOrCreateInvite\",\"handleEdit\",\"prevState\",\"handleBackToLink\",\"linkExpirationText\",\"data\",\"expires\",\"expiration\",\"Date\",\"usesLeft\",\"uses\",\"date\",\"Number\",\"type\",\"message\",\"handleGenerateLink\",\"createElement\",\"linkText\",\"captionText\",\"onClose\",\"onClickBackMembers\",\"onClickBackLink\",\"onClickEdit\",\"onClickNewLink\"],\"mappings\":\"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\"}"}