{"code":"function module(e,t,n){n.export({useVoipClient:function(){return d}},!0),n.link(\"@rocket.chat/ui-contexts\",{useUser:function(e){r=e},useEndpoint:function(e){o=e},useSetting:function(e){i=e}},0),n.link(\"@tanstack/react-query\",{useQuery:function(e){u=e}},1),n.link(\"react\",{useEffect:function(e){c=e},useRef:function(e){a=e}},2),n.link(\"../lib/VoipClient\",{default:function(e){s=e}},3),n.link(\"./useWebRtcServers\",{useWebRtcServers:function(e){l=e}},4);var r,o,i,u,c,a,s,l,f=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function u(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(u,c)}a((r=r.apply(e,t||[])).next())})};let d=({enabled:e=!0,autoRegister:t=!0}={})=>{let{_id:n}=r()||{},d=i(\"VoIP_TeamCollab_Enabled\"),h=a(null),v=o(\"GET\",\"/v1/voip-freeswitch.extension.getRegistrationInfoByUserId\"),w=l(),{data:p,error:b}=u([\"voip-client\",d,n,w],()=>f(void 0,void 0,void 0,function*(){if(h.current&&h.current.clear(),!n)throw Error(\"error-user-not-found\");let e=yield v({userId:n}).then(e=>{if(!e)throw Error(\"error-registration-not-found\");return e}).catch(e=>{throw Error(e.error||\"error-registration-not-found\")}),{extension:{extension:r},credentials:{websocketPath:o,password:i}}=e,u={iceServers:w,authUserName:r,authPassword:i,sipRegistrarHostnameOrIP:new URL(o).host,webSocketURI:o,connectionRetryCount:Number(10),enableKeepAliveUsingOptionsForUnstableNetworks:!0},c=yield s.create(u);return t&&c.register(),c}),{initialData:null,enabled:e});return c(()=>(h.current=p,()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.clear()}),[p]),{voipClient:p,error:b}}}","map":"{\"version\":3,\"sources\":[\"<anon>\"],\"names\":[],\"mappings\":\"\"}"}