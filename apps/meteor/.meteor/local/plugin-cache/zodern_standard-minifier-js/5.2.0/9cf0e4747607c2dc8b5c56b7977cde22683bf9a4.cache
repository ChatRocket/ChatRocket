{"code":"function module(e,t,n){var a,u,i,s,r,l,o,c,f,d,m,p,k,q,S,g,h;n.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){a=e}},0),n.link(\"@rocket.chat/fuselage\",{Box:function(e){u=e},Pagination:function(e){i=e},States:function(e){s=e},StatesSubtitle:function(e){r=e},StatesTitle:function(e){l=e}},0),n.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(e){o=e},useTranslation:function(e){c=e}},1),n.link(\"@tanstack/react-query\",{useMutation:function(e){f=e}},2),n.link(\"react\",{default:function(e){d=e},useState:function(e){m=e},useEffect:function(e){p=e}},3),n.link(\"../../../../../contexts/hooks/useAppsReload\",{useAppsReload:function(e){k=e}},4),n.link(\"../../../../../lib/queryClient\",{queryClient:function(e){q=e}},5),n.link(\"../../../hooks/useAppRequests\",{useAppRequests:function(e){S=e}},6),n.link(\"./AppRequestItem\",{default:function(e){g=e}},7),n.link(\"./AppRequestsLoading\",{default:function(e){h=e}},8),n.exportDefault(function(e){var t,n,x=e.id,y=e.isAdminUser,E=m(25),A=a(E,2),v=A[0],b=A[1],R=m(0),P=a(R,2),w=P[0],D=P[1],I=S(x,v,w),T=c(),_=k(),C=o(\"POST\",\"/apps/app-request/markAsSeen\"),K=f({mutationKey:[\"mark-app-requests-as-seen\"],mutationFn:function(e){return C({unseenRequests:e})},retry:!1});return(p(function(){return function(){if(y&&I.isSuccess){var e=I.data.data.filter(function(e){return!e.seen}).map(function(e){return e.id});e.length&&K.mutate(e,{onSuccess:function(){q.refetchQueries({queryKey:[\"app-requests-stats\"]}),_()}})}}},[y,I.isSuccess,null==I?void 0:I.data,_]),I.isLoading)?d.createElement(u,{w:\"full\",maxWidth:\"x608\",marginInline:\"auto\",pbs:36},d.createElement(h,null)):d.createElement(u,{h:\"full\",display:\"flex\",flexDirection:\"column\"},d.createElement(u,{w:\"full\",maxWidth:\"x608\",marginInline:\"auto\",pbs:36,flexGrow:\"1\"},I.isSuccess&&null!==(t=I.data.data)&&void 0!==t&&t.length?I.data.data.map(function(e){return d.createElement(g,{key:e.id,seen:e.seen,name:e.requester.name,createdDate:e.createdDate,message:e.message,username:e.requester.username})}):d.createElement(s,null,d.createElement(l,null,T(\"No_requests\")),d.createElement(r,null,T(\"App_requests_by_workspace\")))),I.isSuccess&&(null===(n=I.data.data)||void 0===n?void 0:n.length)&&d.createElement(i,{divider:!0,count:I.data.meta.total,itemsPerPage:I.data.meta.limit,current:I.data.meta.offset,onSetItemsPerPage:function(e){return b(e)},onSetCurrent:function(e){return D(e)}}))})}","map":"{\"version\":3,\"sources\":[\"client/views/marketplace/AppDetailsPage/tabs/AppRequests/AppRequests.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { App } from '@rocket.chat/core-typings';\\nimport { Box, Pagination, States, StatesSubtitle, StatesTitle } from '@rocket.chat/fuselage';\\nimport { useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\\nimport { useMutation } from '@tanstack/react-query';\\nimport type { ReactElement, SetStateAction } from 'react';\\nimport React, { useState, useEffect } from 'react';\\n\\nimport { useAppsReload } from '../../../../../contexts/hooks/useAppsReload';\\nimport { queryClient } from '../../../../../lib/queryClient';\\nimport { useAppRequests } from '../../../hooks/useAppRequests';\\nimport AppRequestItem from './AppRequestItem';\\nimport AppRequestsLoading from './AppRequestsLoading';\\n\\ntype itemsPerPage = 25 | 50 | 100;\\n\\nconst AppRequests = ({ id, isAdminUser }: { id: App['id']; isAdminUser: boolean }): ReactElement => {\\n\\tconst [limit, setLimit] = useState<itemsPerPage>(25);\\n\\tconst [offset, setOffset] = useState<number>(0);\\n\\n\\tconst paginatedAppRequests = useAppRequests(id, limit, offset);\\n\\tconst t = useTranslation();\\n\\n\\tconst onSetItemsPerPage = (itemsPerPageOption: SetStateAction<itemsPerPage>) => setLimit(itemsPerPageOption);\\n\\tconst onSetCurrent = (currentItemsOption: SetStateAction<number>) => setOffset(currentItemsOption);\\n\\n\\tconst reloadApps = useAppsReload();\\n\\tconst markSeen = useEndpoint('POST', '/apps/app-request/markAsSeen');\\n\\tconst markAppRequestsAsSeen = useMutation({\\n\\t\\tmutationKey: ['mark-app-requests-as-seen'],\\n\\t\\tmutationFn: (unseenRequests: Array<string>) => markSeen({ unseenRequests }),\\n\\t\\tretry: false,\\n\\t});\\n\\tuseEffect(() => {\\n\\t\\treturn () => {\\n\\t\\t\\tif (isAdminUser && paginatedAppRequests.isSuccess) {\\n\\t\\t\\t\\tconst unseenRequests = paginatedAppRequests.data.data.filter(({ seen }) => !seen).map(({ id }) => id);\\n\\n\\t\\t\\t\\tif (unseenRequests.length) {\\n\\t\\t\\t\\t\\tmarkAppRequestsAsSeen.mutate(unseenRequests, {\\n\\t\\t\\t\\t\\t\\tonSuccess: () => {\\n\\t\\t\\t\\t\\t\\t\\tqueryClient.refetchQueries({ queryKey: ['app-requests-stats'] });\\n\\t\\t\\t\\t\\t\\t\\treloadApps();\\n\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t};\\n\\t\\t// eslint-disable-next-line react-hooks/exhaustive-deps\\n\\t}, [isAdminUser, paginatedAppRequests.isSuccess, paginatedAppRequests?.data, reloadApps]);\\n\\n\\tif (paginatedAppRequests.isLoading) {\\n\\t\\treturn (\\n\\t\\t\\t<Box w='full' maxWidth='x608' marginInline='auto' pbs={36}>\\n\\t\\t\\t\\t<AppRequestsLoading />\\n\\t\\t\\t</Box>\\n\\t\\t);\\n\\t}\\n\\n\\treturn (\\n\\t\\t<Box h='full' display='flex' flexDirection='column'>\\n\\t\\t\\t<Box w='full' maxWidth='x608' marginInline='auto' pbs={36} flexGrow='1'>\\n\\t\\t\\t\\t{paginatedAppRequests.isSuccess && paginatedAppRequests.data.data?.length ? (\\n\\t\\t\\t\\t\\tpaginatedAppRequests.data.data.map((request) => (\\n\\t\\t\\t\\t\\t\\t<AppRequestItem\\n\\t\\t\\t\\t\\t\\t\\tkey={request.id}\\n\\t\\t\\t\\t\\t\\t\\tseen={request.seen}\\n\\t\\t\\t\\t\\t\\t\\tname={request.requester.name}\\n\\t\\t\\t\\t\\t\\t\\tcreatedDate={request.createdDate}\\n\\t\\t\\t\\t\\t\\t\\tmessage={request.message}\\n\\t\\t\\t\\t\\t\\t\\tusername={request.requester.username}\\n\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t))\\n\\t\\t\\t\\t) : (\\n\\t\\t\\t\\t\\t<States>\\n\\t\\t\\t\\t\\t\\t<StatesTitle>{t('No_requests')}</StatesTitle>\\n\\t\\t\\t\\t\\t\\t<StatesSubtitle>{t('App_requests_by_workspace')}</StatesSubtitle>\\n\\t\\t\\t\\t\\t</States>\\n\\t\\t\\t\\t)}\\n\\t\\t\\t</Box>\\n\\t\\t\\t{paginatedAppRequests.isSuccess && paginatedAppRequests.data.data?.length && (\\n\\t\\t\\t\\t<Pagination\\n\\t\\t\\t\\t\\tdivider\\n\\t\\t\\t\\t\\tcount={paginatedAppRequests.data.meta.total}\\n\\t\\t\\t\\t\\titemsPerPage={paginatedAppRequests.data.meta.limit}\\n\\t\\t\\t\\t\\tcurrent={paginatedAppRequests.data.meta.offset}\\n\\t\\t\\t\\t\\tonSetItemsPerPage={onSetItemsPerPage}\\n\\t\\t\\t\\t\\tonSetCurrent={onSetCurrent}\\n\\t\\t\\t\\t/>\\n\\t\\t\\t)}\\n\\t\\t</Box>\\n\\t);\\n};\\n\\nexport default AppRequests;\\n\",null],\"names\":[\"_slicedToArray\",\"Box\",\"Pagination\",\"States\",\"StatesSubtitle\",\"StatesTitle\",\"useEndpoint\",\"useTranslation\",\"useMutation\",\"React\",\"useState\",\"useEffect\",\"useAppsReload\",\"queryClient\",\"useAppRequests\",\"AppRequestItem\",\"AppRequestsLoading\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"_paginatedAppRequests\",\"_paginatedAppRequests2\",\"id\",\"isAdminUser\",\"_useState\",\"_useState2\",\"limit\",\"setLimit\",\"_useState3\",\"_useState4\",\"offset\",\"setOffset\",\"paginatedAppRequests\",\"t\",\"reloadApps\",\"markSeen\",\"markAppRequestsAsSeen\",\"mutationKey\",\"mutationFn\",\"unseenRequests\",\"retry\",\"isSuccess\",\"data\",\"filter\",\"_ref2\",\"seen\",\"map\",\"_ref3\",\"length\",\"mutate\",\"onSuccess\",\"refetchQueries\",\"queryKey\",\"isLoading\",\"createElement\",\"w\",\"maxWidth\",\"marginInline\",\"pbs\",\"h\",\"display\",\"flexDirection\",\"flexGrow\",\"request\",\"key\",\"name\",\"requester\",\"createdDate\",\"message\",\"username\",\"divider\",\"count\",\"meta\",\"total\",\"itemsPerPage\",\"current\",\"onSetItemsPerPage\",\"itemsPerPageOption\",\"onSetCurrent\",\"currentItemsOption\"],\"mappings\":\"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\"}"}