{"code":"function module(e,i,o){let d,l,t,s,n,a,c,r;o.export({useVideoMessageAction:()=>u}),o.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback(e){d=e}},0),o.link(\"@rocket.chat/ui-contexts\",{useSetting(e){l=e}},1),o.link(\"react\",{useEffect(e){t=e},useMemo(e){s=e}},2),o.link(\"../../../../../../../app/ui/client/lib/recorderjs/videoRecorder\",{VideoRecorder(e){n=e}},3),o.link(\"../../../../contexts/ChatContext\",{useChat(e){a=e}},4),o.link(\"../../hooks/useMediaActionTitle\",{useMediaActionTitle(e){c=e}},5),o.link(\"../../hooks/useMediaPermissions\",{useMediaPermissions(e){r=e}},6);let u=e=>{let i=l(\"FileUpload_Enabled\"),o=l(\"Message_VideoRecorderEnabled\"),u=l(\"FileUpload_MediaTypeBlackList\"),k=l(\"FileUpload_MediaTypeWhiteList\"),[m,v]=r(\"camera\"),p=s(()=>!!(!m&&navigator.mediaDevices&&window.MediaRecorder&&i&&o&&!(null!=u&&u.match(/video\\/webm|video\\/\\*/i))&&(!k||k.match(/video\\/webm|video\\/\\*/i))&&n.getSupportedMimeTypes()),[u,k,i,m,o]),M=c(\"video\",m,i,o,p),g=a(),h=d(e=>{if(e){var i;null==g||null===(i=g.composer)||void 0===i||i.setRecordingVideo(!1)}v(e)});return t(()=>{h(m)},[h,m]),{id:\"video-message\",content:M,icon:\"video\",disabled:!p||!!e,onClick:()=>{var e,i;null!=g&&null!==(e=g.composer)&&void 0!==e&&e.recordingVideo.get()||null==g||null===(i=g.composer)||void 0===i||i.setRecordingVideo(!0)}}}}","map":"{\"version\":3,\"sources\":[\"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\\nimport { useSetting } from '@rocket.chat/ui-contexts';\\nimport { useEffect, useMemo } from 'react';\\n\\nimport { VideoRecorder } from '../../../../../../../app/ui/client/lib/recorderjs/videoRecorder';\\nimport { useChat } from '../../../../contexts/ChatContext';\\nimport { useMediaActionTitle } from '../../hooks/useMediaActionTitle';\\nimport { useMediaPermissions } from '../../hooks/useMediaPermissions';\\n\\nexport const useVideoMessageAction = (disabled: boolean): GenericMenuItemProps => {\\n\\tconst isFileUploadEnabled = useSetting('FileUpload_Enabled') as boolean;\\n\\tconst isVideoRecorderEnabled = useSetting('Message_VideoRecorderEnabled') as boolean;\\n\\tconst fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList') as string;\\n\\tconst fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList') as string;\\n\\tconst [isPermissionDenied, setIsPermissionDenied] = useMediaPermissions('camera');\\n\\n\\tconst isAllowed = useMemo(\\n\\t\\t() =>\\n\\t\\t\\tBoolean(\\n\\t\\t\\t\\t!isPermissionDenied &&\\n\\t\\t\\t\\t\\tnavigator.mediaDevices &&\\n\\t\\t\\t\\t\\twindow.MediaRecorder &&\\n\\t\\t\\t\\t\\tisFileUploadEnabled &&\\n\\t\\t\\t\\t\\tisVideoRecorderEnabled &&\\n\\t\\t\\t\\t\\t!fileUploadMediaTypeBlackList?.match(/video\\\\/webm|video\\\\/\\\\*/i) &&\\n\\t\\t\\t\\t\\t(!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/video\\\\/webm|video\\\\/\\\\*/i)) &&\\n\\t\\t\\t\\t\\tBoolean(VideoRecorder.getSupportedMimeTypes()),\\n\\t\\t\\t),\\n\\t\\t[fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isFileUploadEnabled, isPermissionDenied, isVideoRecorderEnabled],\\n\\t);\\n\\n\\tconst getMediaActionTitle = useMediaActionTitle('video', isPermissionDenied, isFileUploadEnabled, isVideoRecorderEnabled, isAllowed);\\n\\n\\tconst chat = useChat();\\n\\n\\tconst handleOpenVideoMessage = () => {\\n\\t\\tif (!chat?.composer?.recordingVideo.get()) {\\n\\t\\t\\tchat?.composer?.setRecordingVideo(true);\\n\\t\\t}\\n\\t};\\n\\n\\tconst handleDenyVideo = useMutableCallback((isDenied) => {\\n\\t\\tif (isDenied) {\\n\\t\\t\\tchat?.composer?.setRecordingVideo(false);\\n\\t\\t}\\n\\n\\t\\tsetIsPermissionDenied(isDenied);\\n\\t});\\n\\n\\tuseEffect(() => {\\n\\t\\thandleDenyVideo(isPermissionDenied);\\n\\t}, [handleDenyVideo, isPermissionDenied]);\\n\\n\\treturn {\\n\\t\\tid: 'video-message',\\n\\t\\tcontent: getMediaActionTitle,\\n\\t\\ticon: 'video',\\n\\t\\tdisabled: !isAllowed || Boolean(disabled),\\n\\t\\tonClick: handleOpenVideoMessage,\\n\\t};\\n};\\n\",null],\"names\":[\"useMutableCallback\",\"useSetting\",\"useEffect\",\"useMemo\",\"VideoRecorder\",\"useChat\",\"useMediaActionTitle\",\"useMediaPermissions\",\"module\",\"export\",\"useVideoMessageAction\",\"link\",\"v\",\"disabled\",\"isFileUploadEnabled\",\"isVideoRecorderEnabled\",\"fileUploadMediaTypeBlackList\",\"fileUploadMediaTypeWhiteList\",\"isPermissionDenied\",\"setIsPermissionDenied\",\"isAllowed\",\"Boolean\",\"navigator\",\"mediaDevices\",\"window\",\"MediaRecorder\",\"match\",\"getSupportedMimeTypes\",\"getMediaActionTitle\",\"chat\",\"handleDenyVideo\",\"isDenied\",\"_chat$composer3\",\"composer\",\"setRecordingVideo\",\"id\",\"content\",\"icon\",\"onClick\",\"handleOpenVideoMessage\",\"_chat$composer\",\"_chat$composer2\",\"recordingVideo\",\"get\"],\"mappings\":\"2BAAiEA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAjEC,EAAOC,MAAE,CAAA,CAAAC,sBAA0BA,IAAAA,CAAA,GAA8BF,EAAAG,IAAA,CAAA,8BAAA,CAAAX,mBAAAY,CAAA,EAAAZ,EAAAY,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,2BAAA,CAAAV,WAAAW,CAAA,EAAAX,EAAAW,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,QAAA,CAAAT,UAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,QAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,kEAAA,CAAAP,cAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,mCAAA,CAAAN,QAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,kCAAA,CAAAL,oBAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,kCAAA,CAAAJ,oBAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAU1D,IAAMF,EAAyBG,IACrC,IAAMC,EAAsBb,EAAW,sBACjCc,EAAyBd,EAAW,gCACpCe,EAA+Bf,EAAW,iCAC1CgB,EAA+BhB,EAAW,iCAC1C,CAACiB,EAAoBC,EAAsB,CAAGZ,EAAoB,UAElEa,EAAYjB,EACjB,IACCkB,CAAAA,CACC,CAAA,CAACH,GACAI,UAAUC,YAAY,EACtBC,OAAOC,aAAa,EACpBX,GACAC,GACA,CAACC,CAAAA,MAAAA,GAAAA,EAA8BU,KAAK,CAAC,yBAAwB,GAC5D,CAAA,CAACT,GAAgCA,EAA6BS,KAAK,CAAC,yBAAwB,GACrFtB,EAAcuB,qBAAqB,EAAE,EAEhD,CAACX,EAA8BC,EAA8BH,EAAqBI,EAAoBH,EAAuB,EAGxHa,EAAsBtB,EAAoB,QAASY,EAAoBJ,EAAqBC,EAAwBK,GAEpHS,EAAOxB,IAQPyB,EAAkB9B,EAAoB+B,IAC3C,GAAIA,EAAU,CAAA,IAAAC,CACbH,OAAAA,GAAI,AAAU,OAAVG,CAAAA,EAAJH,EAAMI,QAAQ,AAARA,GAAQD,AAAA,KAAA,IAAAA,GAAdA,EAAgBE,iBAAiB,CAAC,CAAA,EACnC,CAEAf,EAAsBY,EACvB,GAMA,OAJA7B,EAAU,KACT4B,EAAgBZ,EACjB,EAAG,CAACY,EAAiBZ,EAAmB,EAEjC,CACNiB,GAAI,gBACJC,QAASR,EACTS,KAAM,QACNxB,SAAU,CAACO,GAAaC,CAAAA,CAAQR,EAChCyB,QAvB8BC,SAAKC,EACQC,QAAtCZ,GAAI,AAAU,OAAVW,CAAAA,EAAJX,EAAMI,QAAQ,AAARA,GAAQO,AAAA,KAAA,IAAAA,GAAdA,EAAgBE,cAAc,CAACC,GAAG,IACtCd,MAAAA,GAAI,AAAU,OAAVY,CAAAA,EAAJZ,EAAMI,QAAQ,AAARA,GAAQQ,AAAA,KAAA,IAAAA,GAAdA,EAAgBP,iBAAiB,CAAC,CAAA,EAEpC,EAqBD\"}"}