{"code":"function module(e,t,o){let l,i,n,a,s,u,d,r,v,c,m,g,p;let k=[\"tmid\",\"onSend\"];o.link(\"@babel/runtime/helpers/extends\",{default(e){l=e}},0),o.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default(e){i=e}},1),o.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch(e){n=e}},0),o.link(\"react\",{default(e){a=e},memo(e){s=e},useCallback(e){u=e},useMemo(e){d=e}},1),o.link(\"../../../../app/ui-utils/client\",{LegacyRoomManager(e){r=e}},2),o.link(\"../../../hooks/useReactiveValue\",{useReactiveValue(e){v=e}},3),o.link(\"../contexts/ChatContext\",{useChat(e){c=e}},4),o.link(\"../contexts/RoomContext\",{useRoom(e){m=e}},5),o.link(\"./ComposerSkeleton\",{default(e){g=e}},6),o.link(\"./messageBox/MessageBox\",{default(e){p=e}},7),o.exportDefault(s(e=>{var t;let{tmid:o,onSend:s}=e,y=i(e,k),x=c(),h=m(),f=n(),w=d(()=>({onJoin:async()=>{try{var e;await (null==x?void 0:null===(e=x.data)||void 0===e?void 0:e.joinRoom())}catch(e){throw f({type:\"error\",message:e}),e}},onSend:async e=>{let{value:t,tshow:o,previewUrls:l,isSlashCommandAllowed:i}=e;try{await (null==x?void 0:x.action.stop(\"typing\"));let e=await (null==x?void 0:x.flows.sendMessage({text:t,tshow:o,previewUrls:l,isSlashCommandAllowed:i}));e&&(null==s||s())}catch(e){f({type:\"error\",message:e})}},onTyping:async()=>{var e,t;if((null==x?void 0:null===(e=x.composer)||void 0===e?void 0:null===(t=e.text)||void 0===t?void 0:t.trim())===\"\"){await (null==x?void 0:x.action.stop(\"typing\"));return}await (null==x?void 0:x.action.start(\"typing\"))},onNavigateToPreviousMessage:()=>null==x?void 0:x.messageEditing.toPreviousMessage(),onNavigateToNextMessage:()=>null==x?void 0:x.messageEditing.toNextMessage(),onUploadFiles:e=>null==x?void 0:x.flows.uploadFiles(e)}),[null==x?void 0:x.data,null==x?void 0:x.flows,null==x?void 0:x.action,null==x?void 0:null===(t=x.composer)||void 0===t?void 0:t.text,null==x?void 0:x.messageEditing,f,s]),M=v(u(()=>{var e,t;return null!==(e=null===(t=r.getOpenedRoomByRid(h._id))||void 0===t?void 0:t.streamActive)&&void 0!==e&&e},[h._id]));return M?a.createElement(p,l({key:h._id,tmid:o},w,{showFormattingTips:!0},y)):a.createElement(g,null)}))}","map":"{\"version\":3,\"sources\":[\"client/views/room/composer/ComposerMessage.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IMessage, ISubscription } from '@rocket.chat/core-typings';\\nimport { useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement, ReactNode } from 'react';\\nimport React, { memo, useCallback, useMemo } from 'react';\\n\\nimport { LegacyRoomManager } from '../../../../app/ui-utils/client';\\nimport { useReactiveValue } from '../../../hooks/useReactiveValue';\\nimport { useChat } from '../contexts/ChatContext';\\nimport { useRoom } from '../contexts/RoomContext';\\nimport ComposerSkeleton from './ComposerSkeleton';\\nimport MessageBox from './messageBox/MessageBox';\\n\\nexport type ComposerMessageProps = {\\n\\ttmid?: IMessage['_id'];\\n\\tchildren?: ReactNode;\\n\\tsubscription?: ISubscription;\\n\\ttshow?: boolean;\\n\\tpreviewUrls?: string[];\\n\\tonResize?: () => void;\\n\\tonEscape?: () => void;\\n\\tonSend?: () => void;\\n\\tonNavigateToNextMessage?: () => void;\\n\\tonNavigateToPreviousMessage?: () => void;\\n\\tonUploadFiles?: (files: readonly File[]) => void;\\n};\\n\\nconst ComposerMessage = ({ tmid, onSend, ...props }: ComposerMessageProps): ReactElement => {\\n\\tconst chat = useChat();\\n\\tconst room = useRoom();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst composerProps = useMemo(\\n\\t\\t() => ({\\n\\t\\t\\tonJoin: async (): Promise<void> => {\\n\\t\\t\\t\\ttry {\\n\\t\\t\\t\\t\\tawait chat?.data?.joinRoom();\\n\\t\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t\\t\\tthrow error;\\n\\t\\t\\t\\t}\\n\\t\\t\\t},\\n\\n\\t\\t\\tonSend: async ({\\n\\t\\t\\t\\tvalue: text,\\n\\t\\t\\t\\ttshow,\\n\\t\\t\\t\\tpreviewUrls,\\n\\t\\t\\t\\tisSlashCommandAllowed,\\n\\t\\t\\t}: {\\n\\t\\t\\t\\tvalue: string;\\n\\t\\t\\t\\ttshow?: boolean;\\n\\t\\t\\t\\tpreviewUrls?: string[];\\n\\t\\t\\t\\tisSlashCommandAllowed?: boolean;\\n\\t\\t\\t}): Promise<void> => {\\n\\t\\t\\t\\ttry {\\n\\t\\t\\t\\t\\tawait chat?.action.stop('typing');\\n\\t\\t\\t\\t\\tconst newMessageSent = await chat?.flows.sendMessage({\\n\\t\\t\\t\\t\\t\\ttext,\\n\\t\\t\\t\\t\\t\\ttshow,\\n\\t\\t\\t\\t\\t\\tpreviewUrls,\\n\\t\\t\\t\\t\\t\\tisSlashCommandAllowed,\\n\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t\\tif (newMessageSent) onSend?.();\\n\\t\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t\\t}\\n\\t\\t\\t},\\n\\t\\t\\tonTyping: async (): Promise<void> => {\\n\\t\\t\\t\\tif (chat?.composer?.text?.trim() === '') {\\n\\t\\t\\t\\t\\tawait chat?.action.stop('typing');\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tawait chat?.action.start('typing');\\n\\t\\t\\t},\\n\\t\\t\\tonNavigateToPreviousMessage: () => chat?.messageEditing.toPreviousMessage(),\\n\\t\\t\\tonNavigateToNextMessage: () => chat?.messageEditing.toNextMessage(),\\n\\t\\t\\tonUploadFiles: (files: readonly File[]) => {\\n\\t\\t\\t\\treturn chat?.flows.uploadFiles(files);\\n\\t\\t\\t},\\n\\t\\t}),\\n\\t\\t[chat?.data, chat?.flows, chat?.action, chat?.composer?.text, chat?.messageEditing, dispatchToastMessage, onSend],\\n\\t);\\n\\n\\tconst publicationReady = useReactiveValue(\\n\\t\\tuseCallback(() => LegacyRoomManager.getOpenedRoomByRid(room._id)?.streamActive ?? false, [room._id]),\\n\\t);\\n\\n\\tif (!publicationReady) {\\n\\t\\treturn <ComposerSkeleton />;\\n\\t}\\n\\n\\treturn <MessageBox key={room._id} tmid={tmid} {...composerProps} showFormattingTips={true} {...props} />;\\n};\\n\\nexport default memo(ComposerMessage);\\n\",null],\"names\":[\"_extends\",\"_objectWithoutProperties\",\"useToastMessageDispatch\",\"React\",\"memo\",\"useCallback\",\"useMemo\",\"LegacyRoomManager\",\"useReactiveValue\",\"useChat\",\"useRoom\",\"ComposerSkeleton\",\"MessageBox\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"_chat$composer2\",\"tmid\",\"onSend\",\"props\",\"_excluded\",\"chat\",\"room\",\"dispatchToastMessage\",\"composerProps\",\"onJoin\",\"_chat$data\",\"data\",\"joinRoom\",\"error\",\"type\",\"message\",\"_ref2\",\"value\",\"text\",\"tshow\",\"previewUrls\",\"isSlashCommandAllowed\",\"action\",\"stop\",\"newMessageSent\",\"flows\",\"sendMessage\",\"onTyping\",\"_chat$composer\",\"_chat$composer$text\",\"composer\",\"trim\",\"start\",\"onNavigateToPreviousMessage\",\"messageEditing\",\"toPreviousMessage\",\"onNavigateToNextMessage\",\"toNextMessage\",\"onUploadFiles\",\"files\",\"uploadFiles\",\"publicationReady\",\"_LegacyRoomManager$ge\",\"_LegacyRoomManager$ge2\",\"getOpenedRoomByRid\",\"_id\",\"streamActive\",\"createElement\",\"key\",\"showFormattingTips\"],\"mappings\":\"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\"}"}