{"code":"function module(e,t,n){var a,u,i,s,r,l,c,o,f,d,m,p,k,q,S,g,h;n.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){a=e}},0),n.link(\"@rocket.chat/fuselage\",{Box:function(e){u=e},Pagination:function(e){i=e},States:function(e){s=e},StatesSubtitle:function(e){r=e},StatesTitle:function(e){l=e}},0),n.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(e){c=e}},1),n.link(\"@tanstack/react-query\",{useMutation:function(e){o=e}},2),n.link(\"react\",{default:function(e){f=e},useState:function(e){d=e},useEffect:function(e){m=e}},3),n.link(\"react-i18next\",{useTranslation:function(e){p=e}},4),n.link(\"../../../../../contexts/hooks/useAppsReload\",{useAppsReload:function(e){k=e}},5),n.link(\"../../../../../lib/queryClient\",{queryClient:function(e){q=e}},6),n.link(\"../../../hooks/useAppRequests\",{useAppRequests:function(e){S=e}},7),n.link(\"./AppRequestItem\",{default:function(e){g=e}},8),n.link(\"./AppRequestsLoading\",{default:function(e){h=e}},9),n.exportDefault(function(e){var t,n,x=e.id,y=e.isAdminUser,E=d(25),A=a(E,2),v=A[0],b=A[1],R=d(0),P=a(R,2),w=P[0],D=P[1],I=S(x,v,w),T=p().t,_=k(),C=c(\"POST\",\"/apps/app-request/markAsSeen\"),K=o({mutationKey:[\"mark-app-requests-as-seen\"],mutationFn:function(e){return C({unseenRequests:e})},retry:!1});return(m(function(){return function(){if(y&&I.isSuccess){var e=I.data.data.filter(function(e){return!e.seen}).map(function(e){return e.id});e.length&&K.mutate(e,{onSuccess:function(){q.refetchQueries({queryKey:[\"app-requests-stats\"]}),_()}})}}},[y,I.isSuccess,null==I?void 0:I.data,_]),I.isLoading)?f.createElement(u,{w:\"full\",maxWidth:\"x608\",marginInline:\"auto\",pbs:36},f.createElement(h,null)):f.createElement(u,{h:\"full\",display:\"flex\",flexDirection:\"column\"},f.createElement(u,{w:\"full\",maxWidth:\"x608\",marginInline:\"auto\",pbs:36,flexGrow:\"1\"},I.isSuccess&&null!==(t=I.data.data)&&void 0!==t&&t.length?I.data.data.map(function(e){return f.createElement(g,{key:e.id,seen:e.seen,name:e.requester.name,createdDate:e.createdDate,message:e.message,username:e.requester.username})}):f.createElement(s,null,f.createElement(l,null,T(\"No_requests\")),f.createElement(r,null,T(\"App_requests_by_workspace\")))),I.isSuccess&&(null===(n=I.data.data)||void 0===n?void 0:n.length)&&f.createElement(i,{divider:!0,count:I.data.meta.total,itemsPerPage:I.data.meta.limit,current:I.data.meta.offset,onSetItemsPerPage:function(e){return b(e)},onSetCurrent:function(e){return D(e)}}))})}","map":"{\"version\":3,\"sources\":[\"client/views/marketplace/AppDetailsPage/tabs/AppRequests/AppRequests.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { App } from '@rocket.chat/core-typings';\\nimport { Box, Pagination, States, StatesSubtitle, StatesTitle } from '@rocket.chat/fuselage';\\nimport { useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useMutation } from '@tanstack/react-query';\\nimport type { ReactElement, SetStateAction } from 'react';\\nimport React, { useState, useEffect } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { useAppsReload } from '../../../../../contexts/hooks/useAppsReload';\\nimport { queryClient } from '../../../../../lib/queryClient';\\nimport { useAppRequests } from '../../../hooks/useAppRequests';\\nimport AppRequestItem from './AppRequestItem';\\nimport AppRequestsLoading from './AppRequestsLoading';\\n\\ntype itemsPerPage = 25 | 50 | 100;\\n\\nconst AppRequests = ({ id, isAdminUser }: { id: App['id']; isAdminUser: boolean }): ReactElement => {\\n\\tconst [limit, setLimit] = useState<itemsPerPage>(25);\\n\\tconst [offset, setOffset] = useState<number>(0);\\n\\n\\tconst paginatedAppRequests = useAppRequests(id, limit, offset);\\n\\tconst { t } = useTranslation();\\n\\n\\tconst onSetItemsPerPage = (itemsPerPageOption: SetStateAction<itemsPerPage>) => setLimit(itemsPerPageOption);\\n\\tconst onSetCurrent = (currentItemsOption: SetStateAction<number>) => setOffset(currentItemsOption);\\n\\n\\tconst reloadApps = useAppsReload();\\n\\tconst markSeen = useEndpoint('POST', '/apps/app-request/markAsSeen');\\n\\tconst markAppRequestsAsSeen = useMutation({\\n\\t\\tmutationKey: ['mark-app-requests-as-seen'],\\n\\t\\tmutationFn: (unseenRequests: Array<string>) => markSeen({ unseenRequests }),\\n\\t\\tretry: false,\\n\\t});\\n\\tuseEffect(() => {\\n\\t\\treturn () => {\\n\\t\\t\\tif (isAdminUser && paginatedAppRequests.isSuccess) {\\n\\t\\t\\t\\tconst unseenRequests = paginatedAppRequests.data.data.filter(({ seen }) => !seen).map(({ id }) => id);\\n\\n\\t\\t\\t\\tif (unseenRequests.length) {\\n\\t\\t\\t\\t\\tmarkAppRequestsAsSeen.mutate(unseenRequests, {\\n\\t\\t\\t\\t\\t\\tonSuccess: () => {\\n\\t\\t\\t\\t\\t\\t\\tqueryClient.refetchQueries({ queryKey: ['app-requests-stats'] });\\n\\t\\t\\t\\t\\t\\t\\treloadApps();\\n\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t};\\n\\t\\t// eslint-disable-next-line react-hooks/exhaustive-deps\\n\\t}, [isAdminUser, paginatedAppRequests.isSuccess, paginatedAppRequests?.data, reloadApps]);\\n\\n\\tif (paginatedAppRequests.isLoading) {\\n\\t\\treturn (\\n\\t\\t\\t<Box w='full' maxWidth='x608' marginInline='auto' pbs={36}>\\n\\t\\t\\t\\t<AppRequestsLoading />\\n\\t\\t\\t</Box>\\n\\t\\t);\\n\\t}\\n\\n\\treturn (\\n\\t\\t<Box h='full' display='flex' flexDirection='column'>\\n\\t\\t\\t<Box w='full' maxWidth='x608' marginInline='auto' pbs={36} flexGrow='1'>\\n\\t\\t\\t\\t{paginatedAppRequests.isSuccess && paginatedAppRequests.data.data?.length ? (\\n\\t\\t\\t\\t\\tpaginatedAppRequests.data.data.map((request) => (\\n\\t\\t\\t\\t\\t\\t<AppRequestItem\\n\\t\\t\\t\\t\\t\\t\\tkey={request.id}\\n\\t\\t\\t\\t\\t\\t\\tseen={request.seen}\\n\\t\\t\\t\\t\\t\\t\\tname={request.requester.name}\\n\\t\\t\\t\\t\\t\\t\\tcreatedDate={request.createdDate}\\n\\t\\t\\t\\t\\t\\t\\tmessage={request.message}\\n\\t\\t\\t\\t\\t\\t\\tusername={request.requester.username}\\n\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t))\\n\\t\\t\\t\\t) : (\\n\\t\\t\\t\\t\\t<States>\\n\\t\\t\\t\\t\\t\\t<StatesTitle>{t('No_requests')}</StatesTitle>\\n\\t\\t\\t\\t\\t\\t<StatesSubtitle>{t('App_requests_by_workspace')}</StatesSubtitle>\\n\\t\\t\\t\\t\\t</States>\\n\\t\\t\\t\\t)}\\n\\t\\t\\t</Box>\\n\\t\\t\\t{paginatedAppRequests.isSuccess && paginatedAppRequests.data.data?.length && (\\n\\t\\t\\t\\t<Pagination\\n\\t\\t\\t\\t\\tdivider\\n\\t\\t\\t\\t\\tcount={paginatedAppRequests.data.meta.total}\\n\\t\\t\\t\\t\\titemsPerPage={paginatedAppRequests.data.meta.limit}\\n\\t\\t\\t\\t\\tcurrent={paginatedAppRequests.data.meta.offset}\\n\\t\\t\\t\\t\\tonSetItemsPerPage={onSetItemsPerPage}\\n\\t\\t\\t\\t\\tonSetCurrent={onSetCurrent}\\n\\t\\t\\t\\t/>\\n\\t\\t\\t)}\\n\\t\\t</Box>\\n\\t);\\n};\\n\\nexport default AppRequests;\\n\",null],\"names\":[\"_slicedToArray\",\"Box\",\"Pagination\",\"States\",\"StatesSubtitle\",\"StatesTitle\",\"useEndpoint\",\"useMutation\",\"React\",\"useState\",\"useEffect\",\"useTranslation\",\"useAppsReload\",\"queryClient\",\"useAppRequests\",\"AppRequestItem\",\"AppRequestsLoading\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"_paginatedAppRequests\",\"_paginatedAppRequests2\",\"id\",\"isAdminUser\",\"_useState\",\"_useState2\",\"limit\",\"setLimit\",\"_useState3\",\"_useState4\",\"offset\",\"setOffset\",\"paginatedAppRequests\",\"t\",\"_useTranslation\",\"reloadApps\",\"markSeen\",\"markAppRequestsAsSeen\",\"mutationKey\",\"mutationFn\",\"unseenRequests\",\"retry\",\"isSuccess\",\"data\",\"filter\",\"_ref2\",\"seen\",\"map\",\"_ref3\",\"length\",\"mutate\",\"onSuccess\",\"refetchQueries\",\"queryKey\",\"isLoading\",\"createElement\",\"w\",\"maxWidth\",\"marginInline\",\"pbs\",\"h\",\"display\",\"flexDirection\",\"flexGrow\",\"request\",\"key\",\"name\",\"requester\",\"createdDate\",\"message\",\"username\",\"divider\",\"count\",\"meta\",\"total\",\"itemsPerPage\",\"current\",\"onSetItemsPerPage\",\"itemsPerPageOption\",\"onSetCurrent\",\"currentItemsOption\"],\"mappings\":\"uBAgBA,IAfAA,EAAAC,EAAOC,EAAOC,EAAYC,EAAQC,EAA2DC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA/EC,EAAYC,IAAA,CAAA,uCAA2C,CAAAC,QAAA,SAAAC,CAAA,EAAApB,EAAwBoB,CAAA,CAAA,EAAA,GAA3CH,EAAAC,IAAa,CAAA,wBAAM,CAAAjB,IAAwB,SAAAmB,CAAA,EAAAnB,EAAAmB,CAAA,EAAAlB,WAAA,SAAAkB,CAAA,EAAAlB,EAAAkB,CAAA,EAAAjB,OAAA,SAAAiB,CAAA,EAAAjB,EAAAiB,CAAA,EAAAhB,eAAA,SAAAgB,CAAA,EAAAhB,EAAAgB,CAAA,EAAAf,YAAA,SAAAe,CAAA,EAAAf,EAAAe,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,2BAAA,CAAAZ,YAAA,SAAAc,CAAA,EAAAd,EAAAc,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,wBAAA,CAAAX,YAAA,SAAAa,CAAA,EAAAb,EAAAa,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAA,QAAA,SAAAE,CAAA,EAAAZ,EAAAY,CAAA,EAAAX,SAAA,SAAAW,CAAA,EAAAX,EAAAW,CAAA,EAAAV,UAAA,SAAAU,CAAA,EAAAV,EAAAU,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,gBAAA,CAAAP,eAAA,SAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,8CAAA,CAAAN,cAAA,SAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,iCAAA,CAAAL,YAAA,SAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,gCAAA,CAAAJ,eAAA,SAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,mBAAA,CAAA,QAAA,SAAAE,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,uBAAA,CAAA,QAAA,SAAAE,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAA7FH,EAAOI,aAAO,CAeM,SAAAC,CAAA,EAA+E,IAAAC,EAAAC,EAA5EC,EAAEH,EAAFG,EAAE,CAAEC,EAAWJ,EAAXI,WAAW,CACrCC,EAA0BlB,EAAuB,IAAGmB,EAAA5B,EAAA2B,EAAA,GAA7CE,EAAKD,CAAA,CAAA,EAAA,CAAEE,EAAQF,CAAA,CAAA,EAAA,CACtBG,EAA4BtB,EAAiB,GAAEuB,EAAAhC,EAAA+B,EAAA,GAAxCE,EAAMD,CAAA,CAAA,EAAA,CAAEE,EAASF,CAAA,CAAA,EAAA,CAElBG,EAAuBrB,EAAeW,EAAII,EAAOI,GAC/CG,EAACC,AAAK1B,IAANyB,CAAC,CAKHE,EAAa1B,IACb2B,EAAWjC,EAAY,OAAQ,gCAC/BkC,EAAwBjC,EAAY,CACzCkC,YAAa,CAAC,4BAA4B,CAC1CC,WAAY,SAACC,CAA6B,EAAA,OAAKJ,EAAS,CAAEI,eAAAA,CAAc,EAAG,EAC3EC,MAAO,CAAA,UAoBR,CAlBAlC,EAAU,WACT,OAAO,WACN,GAAIgB,GAAeS,EAAqBU,SAAS,CAAE,CAClD,IAAMF,EAAiBR,EAAqBW,IAAI,CAACA,IAAI,CAACC,MAAM,CAAC,SAAAC,CAAA,EAAO,MAAO,CAAPA,EAAJC,IAAI,AAAY,GAAEC,GAAG,CAAC,SAAAC,CAAA,EAAK,OAAAA,EAAF1B,EAAE,AAAS,EAEhGkB,CAAAA,EAAeS,MAAM,EACxBZ,EAAsBa,MAAM,CAACV,EAAgB,CAC5CW,UAAW,WACVzC,EAAY0C,cAAc,CAAC,CAAEC,SAAU,CAAC,qBAAoB,AAAC,GAC7DlB,GACD,GAGH,CACD,CAED,EAAG,CAACZ,EAAaS,EAAqBU,SAAS,CAAEV,MAAAA,EAAoB,KAAA,EAApBA,EAAsBW,IAAI,CAAER,EAAW,EAEpFH,EAAqBsB,SAAS,EAEhCjD,EAAAkD,aAAA,CAACzD,EAAG,CAAC0D,EAAE,OAAOC,SAAS,OAAOC,aAAa,OAAOC,IAAK,EAAG,EACzDtD,EAAAkD,aAAA,CAAC1C,EAAkB,OAMrBR,EAAAkD,aAAA,CAACzD,EAAG,CAAC8D,EAAE,OAAOC,QAAQ,OAAOC,cAAc,QAAQ,EAClDzD,EAAAkD,aAAA,CAACzD,EAAG,CAAC0D,EAAE,OAAOC,SAAS,OAAOC,aAAa,OAAOC,IAAK,GAAII,SAAS,GAAG,EACrE/B,EAAqBU,SAAS,EAAA,AAAkC,OAAlCtB,CAAAA,EAAIY,EAAqBW,IAAI,CAACA,IAAI,AAAJA,GAAIvB,AAAA,KAAA,IAAAA,GAA9BA,EAAgC6B,MAAM,CACxEjB,EAAqBW,IAAI,CAACA,IAAI,CAACI,GAAG,CAAC,SAACiB,CAAO,EAAA,OAC1C3D,EAAAkD,aAAA,CAAC3C,EAAc,CACdqD,IAAKD,EAAQ1C,EAAG,CAChBwB,KAAMkB,EAAQlB,IAAK,CACnBoB,KAAMF,EAAQG,SAAS,CAACD,IAAK,CAC7BE,YAAaJ,EAAQI,WAAY,CACjCC,QAASL,EAAQK,OAAQ,CACzBC,SAAUN,EAAQG,SAAS,CAACG,QAAAA,AAAS,EACpC,GAGHjE,EAAAkD,aAAA,CAACvD,EAAM,KACNK,EAAAkD,aAAA,CAACrD,EAAW,KAAE+B,EAAE,gBAChB5B,EAAAkD,aAAA,CAACtD,EAAc,KAAEgC,EAAE,gCAIrBD,EAAqBU,SAAS,EAAA,CAAA,AAAkC,OAAlCrB,CAAAA,EAAIW,EAAqBW,IAAI,CAACA,IAAI,AAAJA,GAAItB,AAAA,KAAA,IAAAA,EAAA,KAAA,EAA9BA,EAAgC4B,MAAM,AAANA,GAClE5C,EAAAkD,aAAA,CAACxD,EAAU,CACVwE,QAAO,CAAA,EACPC,MAAOxC,EAAqBW,IAAI,CAAC8B,IAAI,CAACC,KAAM,CAC5CC,aAAc3C,EAAqBW,IAAI,CAAC8B,IAAI,CAAC/C,KAAM,CACnDkD,QAAS5C,EAAqBW,IAAI,CAAC8B,IAAI,CAAC3C,MAAO,CAC/C+C,kBA/DsB,SAACC,CAAgD,EAAA,OAAKnD,EAASmD,EAAmB,EAgExGC,aA/DiB,SAACC,CAA0C,EAAA,OAAKjD,EAAUiD,EAAmB,CA+DnE,GAKhC\"}"}