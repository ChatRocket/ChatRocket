{"code":"function module(e,n,t){var o,i,l,a,u,r,s,c,d,v,f,p,m,g,x=[\"tmid\",\"onSend\"];t.link(\"@babel/runtime/regenerator\",{default:function(e){o=e}},0),t.link(\"@babel/runtime/helpers/extends\",{default:function(e){i=e}},1),t.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default:function(e){l=e}},2),t.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch:function(e){a=e}},0),t.link(\"react\",{default:function(e){u=e},memo:function(e){r=e},useCallback:function(e){s=e},useMemo:function(e){c=e}},1),t.link(\"../../../../app/ui-utils/client\",{LegacyRoomManager:function(e){d=e}},2),t.link(\"../../../hooks/useReactiveValue\",{useReactiveValue:function(e){v=e}},3),t.link(\"../contexts/ChatContext\",{useChat:function(e){f=e}},4),t.link(\"../contexts/RoomContext\",{useRoom:function(e){p=e}},5),t.link(\"./ComposerSkeleton\",{default:function(e){m=e}},6),t.link(\"./messageBox/MessageBox\",{default:function(e){g=e}},7),t.exportDefault(r(function(e){var n,t=e.tmid,r=e.onSend,h=l(e,x),k=f(),w=p(),b=a(),y=c(function(){return{onJoin:function(){var e;return o.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,o.awrap(null==k?void 0:null===(e=k.data)||void 0===e?void 0:e.joinRoom());case 3:n.next=9;break;case 5:throw n.prev=5,n.t0=n.catch(0),b({type:\"error\",message:n.t0}),n.t0;case 9:case\"end\":return n.stop()}},null,null,[[0,5]],Promise)},onSend:function(e){var n,t,i,l;return o.async(function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.value,t=e.tshow,i=e.previewUrls,l=e.isSlashCommandAllowed,a.prev=1,a.next=4,o.awrap(null==k?void 0:k.action.stop(\"typing\"));case 4:return a.next=6,o.awrap(null==k?void 0:k.flows.sendMessage({text:n,tshow:t,previewUrls:i,isSlashCommandAllowed:l}));case 6:a.sent&&(null==r||r()),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(1),b({type:\"error\",message:a.t0});case 13:case\"end\":return a.stop()}},null,null,[[1,10]],Promise)},onTyping:function(){var e,n;return o.async(function(t){for(;;)switch(t.prev=t.next){case 0:if((null==k?void 0:null===(e=k.composer)||void 0===e?void 0:null===(n=e.text)||void 0===n?void 0:n.trim())!==\"\"){t.next=4;break}return t.next=3,o.awrap(null==k?void 0:k.action.stop(\"typing\"));case 3:return t.abrupt(\"return\");case 4:return t.next=6,o.awrap(null==k?void 0:k.action.start(\"typing\"));case 6:case\"end\":return t.stop()}},null,null,null,Promise)},onNavigateToPreviousMessage:function(){return null==k?void 0:k.messageEditing.toPreviousMessage()},onNavigateToNextMessage:function(){return null==k?void 0:k.messageEditing.toNextMessage()},onUploadFiles:function(e){return null==k?void 0:k.flows.uploadFiles(e)}}},[null==k?void 0:k.data,null==k?void 0:k.flows,null==k?void 0:k.action,null==k?void 0:null===(n=k.composer)||void 0===n?void 0:n.text,null==k?void 0:k.messageEditing,b,r]);return v(s(function(){var e,n;return null!==(e=null===(n=d.getOpenedRoomByRid(w._id))||void 0===n?void 0:n.streamActive)&&void 0!==e&&e},[w._id]))?u.createElement(g,i({key:w._id,tmid:t},y,{showFormattingTips:!0},h)):u.createElement(m,null)}))}","map":"{\"version\":3,\"sources\":[\"client/views/room/composer/ComposerMessage.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IMessage, ISubscription } from '@rocket.chat/core-typings';\\nimport { useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement, ReactNode } from 'react';\\nimport React, { memo, useCallback, useMemo } from 'react';\\n\\nimport { LegacyRoomManager } from '../../../../app/ui-utils/client';\\nimport { useReactiveValue } from '../../../hooks/useReactiveValue';\\nimport { useChat } from '../contexts/ChatContext';\\nimport { useRoom } from '../contexts/RoomContext';\\nimport ComposerSkeleton from './ComposerSkeleton';\\nimport MessageBox from './messageBox/MessageBox';\\n\\nexport type ComposerMessageProps = {\\n\\ttmid?: IMessage['_id'];\\n\\tchildren?: ReactNode;\\n\\tsubscription?: ISubscription;\\n\\ttshow?: boolean;\\n\\tpreviewUrls?: string[];\\n\\tonResize?: () => void;\\n\\tonEscape?: () => void;\\n\\tonSend?: () => void;\\n\\tonNavigateToNextMessage?: () => void;\\n\\tonNavigateToPreviousMessage?: () => void;\\n\\tonUploadFiles?: (files: readonly File[]) => void;\\n};\\n\\nconst ComposerMessage = ({ tmid, onSend, ...props }: ComposerMessageProps): ReactElement => {\\n\\tconst chat = useChat();\\n\\tconst room = useRoom();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst composerProps = useMemo(\\n\\t\\t() => ({\\n\\t\\t\\tonJoin: async (): Promise<void> => {\\n\\t\\t\\t\\ttry {\\n\\t\\t\\t\\t\\tawait chat?.data?.joinRoom();\\n\\t\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t\\t\\tthrow error;\\n\\t\\t\\t\\t}\\n\\t\\t\\t},\\n\\n\\t\\t\\tonSend: async ({\\n\\t\\t\\t\\tvalue: text,\\n\\t\\t\\t\\ttshow,\\n\\t\\t\\t\\tpreviewUrls,\\n\\t\\t\\t\\tisSlashCommandAllowed,\\n\\t\\t\\t}: {\\n\\t\\t\\t\\tvalue: string;\\n\\t\\t\\t\\ttshow?: boolean;\\n\\t\\t\\t\\tpreviewUrls?: string[];\\n\\t\\t\\t\\tisSlashCommandAllowed?: boolean;\\n\\t\\t\\t}): Promise<void> => {\\n\\t\\t\\t\\ttry {\\n\\t\\t\\t\\t\\tawait chat?.action.stop('typing');\\n\\t\\t\\t\\t\\tconst newMessageSent = await chat?.flows.sendMessage({\\n\\t\\t\\t\\t\\t\\ttext,\\n\\t\\t\\t\\t\\t\\ttshow,\\n\\t\\t\\t\\t\\t\\tpreviewUrls,\\n\\t\\t\\t\\t\\t\\tisSlashCommandAllowed,\\n\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t\\tif (newMessageSent) onSend?.();\\n\\t\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t\\t}\\n\\t\\t\\t},\\n\\t\\t\\tonTyping: async (): Promise<void> => {\\n\\t\\t\\t\\tif (chat?.composer?.text?.trim() === '') {\\n\\t\\t\\t\\t\\tawait chat?.action.stop('typing');\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tawait chat?.action.start('typing');\\n\\t\\t\\t},\\n\\t\\t\\tonNavigateToPreviousMessage: () => chat?.messageEditing.toPreviousMessage(),\\n\\t\\t\\tonNavigateToNextMessage: () => chat?.messageEditing.toNextMessage(),\\n\\t\\t\\tonUploadFiles: (files: readonly File[]) => {\\n\\t\\t\\t\\treturn chat?.flows.uploadFiles(files);\\n\\t\\t\\t},\\n\\t\\t}),\\n\\t\\t[chat?.data, chat?.flows, chat?.action, chat?.composer?.text, chat?.messageEditing, dispatchToastMessage, onSend],\\n\\t);\\n\\n\\tconst publicationReady = useReactiveValue(\\n\\t\\tuseCallback(() => LegacyRoomManager.getOpenedRoomByRid(room._id)?.streamActive ?? false, [room._id]),\\n\\t);\\n\\n\\tif (!publicationReady) {\\n\\t\\treturn <ComposerSkeleton />;\\n\\t}\\n\\n\\treturn <MessageBox key={room._id} tmid={tmid} {...composerProps} showFormattingTips={true} {...props} />;\\n};\\n\\nexport default memo(ComposerMessage);\\n\",null],\"names\":[\"_regeneratorRuntime\",\"_extends\",\"_objectWithoutProperties\",\"useToastMessageDispatch\",\"React\",\"memo\",\"useCallback\",\"useMemo\",\"LegacyRoomManager\",\"useReactiveValue\",\"useChat\",\"useRoom\",\"ComposerSkeleton\",\"MessageBox\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"_chat$composer2\",\"tmid\",\"onSend\",\"props\",\"_excluded\",\"chat\",\"room\",\"dispatchToastMessage\",\"composerProps\",\"onJoin\",\"_chat$data\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"data\",\"joinRoom\",\"t0\",\"type\",\"message\",\"stop\",\"Promise\",\"_ref2\",\"text\",\"tshow\",\"previewUrls\",\"isSlashCommandAllowed\",\"_context2\",\"value\",\"action\",\"flows\",\"sendMessage\",\"sent\",\"onTyping\",\"_chat$composer\",\"_chat$composer$text\",\"_context3\",\"composer\",\"trim\",\"abrupt\",\"start\",\"onNavigateToPreviousMessage\",\"messageEditing\",\"toPreviousMessage\",\"onNavigateToNextMessage\",\"toNextMessage\",\"onUploadFiles\",\"files\",\"uploadFiles\",\"_LegacyRoomManager$ge\",\"_LegacyRoomManager$ge2\",\"getOpenedRoomByRid\",\"_id\",\"streamActive\",\"createElement\",\"key\",\"showFormattingTips\"],\"mappings\":\"2BACAA,EAAmEC,EAAAC,EAAnEC,EAAmEC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,sBAA1DC,EAAAC,IAAyB,CAAA,6BAAM,CAA0BC,QAAC,SAAAC,CAAA,EAAAjB,EAAAiB,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,iCAAA,CAAAC,QAAA,SAAAC,CAAA,EAAAhB,EAAAgB,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,iDAAA,CAAAC,QAAA,SAAAC,CAAA,EAAAf,EAAAe,CAAA,CAAA,EAAA,GAA1DH,EAAyBC,IAAA,CAAM,2BAA2B,CAAAZ,wBAAA,SAAAc,CAAA,EAAAd,EAAAc,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAA,QAAA,SAAAE,CAAA,EAAAb,EAAAa,CAAA,EAAAZ,KAAA,SAAAY,CAAA,EAAAZ,EAAAY,CAAA,EAAAX,YAAA,SAAAW,CAAA,EAAAX,EAAAW,CAAA,EAAAV,QAAA,SAAAU,CAAA,EAAAV,EAAAU,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,kCAAA,CAAAP,kBAAA,SAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,kCAAA,CAAAN,iBAAA,SAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,0BAAA,CAAAL,QAAA,SAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,0BAAA,CAAAJ,QAAA,SAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,qBAAA,CAAA,QAAA,SAAAE,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,0BAAA,CAAA,QAAA,SAAAE,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAnEH,EAAOI,aAAE,CA4FMb,EAnES,SAAAc,CAAA,EAAmE,IAAAC,EAAhEC,EAAIF,EAAJE,IAAI,CAAEC,EAAMH,EAANG,MAAM,CAAKC,EAAKrB,EAAAiB,EAAAK,GAC1CC,EAAOf,IACPgB,EAAOf,IACPgB,EAAuBxB,IAEvByB,EAAgBrB,EACrB,WAAA,MAAO,CACNsB,OAAQ,WAAA,IAAAC,EAAA,OAAA9B,EAAA+B,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,OAAAF,EAAAC,IAAA,CAAA,EAAAD,EAAAE,IAAA,CAAA,EAAAlC,EAAAmC,KAAA,CAEAV,MAAAA,EAAI,KAAA,EAAA,AAAM,OAANK,CAAAA,EAAJL,EAAMW,IAAI,AAAJA,GAAIN,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAVA,EAAYO,QAAQ,GAAE,MAAA,EAAAL,EAAAE,IAAA,CAAA,EAAA,KAAA,MAAA,EAE4B,MAF5BF,EAAAC,IAAA,CAAA,EAAAD,EAAAM,EAAA,CAAAN,EAAA,KAAA,CAAA,GAE5BL,EAAqB,CAAEY,KAAM,QAASC,QAAOR,EAAAM,EAAAA,AAAO,GAAIN,EAAAM,EAAA,MAAA,EAAA,IAAA,MAAA,OAAAN,EAAAS,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAAC,QAAA,EAK1DpB,OAAQ,SAAAqB,CAAA,EAAA,IAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAA/C,EAAA+B,KAAA,CAAA,SAAAiB,CAAA,EAAA,OAAA,OAAAA,EAAAf,IAAA,CAAAe,EAAAd,IAAA,EAAA,KAAA,EAIc,OAHdU,EAAID,EAAXM,KAAK,CACLJ,EAAKF,EAALE,KAAK,CACLC,EAAWH,EAAXG,WAAW,CACXC,EAAqBJ,EAArBI,qBAAqB,CAAAC,EAAAf,IAAA,CAAA,EAAAe,EAAAd,IAAA,CAAA,EAAAlC,EAAAmC,KAAA,CAQdV,MAAAA,EAAI,KAAA,EAAJA,EAAMyB,MAAM,CAACT,IAAI,CAAC,UAAS,MAAA,EAAA,OAAAO,EAAAd,IAAA,CAAA,EAAAlC,EAAAmC,KAAA,CACJV,MAAAA,EAAI,KAAA,EAAJA,EAAM0B,KAAK,CAACC,WAAW,CAAC,CACpDR,KAAAA,EACAC,MAAAA,EACAC,YAAAA,EACAC,sBAAAA,IACC,MAAA,EALkBC,EAAAK,IAAA,EAMA/B,CAAAA,MAAAA,GAAAA,GAAQ,EAAG0B,EAAAd,IAAA,CAAA,GAAA,KAAA,MAAA,GAAAc,EAAAf,IAAA,CAAA,GAAAe,EAAAV,EAAA,CAAAU,EAAA,KAAA,CAAA,GAE/BrB,EAAqB,CAAEY,KAAM,QAASC,QAAOQ,EAAAV,EAAAA,AAAO,EAAI,MAAA,GAAA,IAAA,MAAA,OAAAU,EAAAP,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,CAAA,CAAA,EAAA,GAAA,CAAA,CAAAC,QAAA,EAG1DY,SAAU,WAAA,IAAAC,EAAAC,EAAA,OAAAxD,EAAA+B,KAAA,CAAA,SAAA0B,CAAA,EAAA,OAAA,OAAAA,EAAAxB,IAAA,CAAAwB,EAAAvB,IAAA,EAAA,KAAA,EAAA,GAAA,AACLT,CAAAA,MAAAA,EAAI,KAAA,EAAA,AAAU,OAAV8B,CAAAA,EAAJ9B,EAAMiC,QAAQ,AAARA,GAAQH,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAA,AAAM,OAANC,CAAAA,EAAdD,EAAgBX,IAAI,AAAJA,GAAIY,AAAA,KAAA,IAAAA,EAAA,KAAA,EAApBA,EAAsBG,IAAI,EAAA,IAAO,GAAE,CAAAF,EAAAvB,IAAA,CAAA,EAAA,KAAA,CAAA,OAAAuB,EAAAvB,IAAA,CAAA,EAAAlC,EAAAmC,KAAA,CAChCV,MAAAA,EAAI,KAAA,EAAJA,EAAMyB,MAAM,CAACT,IAAI,CAAC,UAAS,MAAA,EAAA,OAAAgB,EAAAG,MAAA,CAAA,SAAA,MAAA,EAAA,OAAAH,EAAAvB,IAAA,CAAA,EAAAlC,EAAAmC,KAAA,CAG5BV,MAAAA,EAAI,KAAA,EAAJA,EAAMyB,MAAM,CAACW,KAAK,CAAC,UAAS,MAAA,EAAA,IAAA,MAAA,OAAAJ,EAAAhB,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EAEnCoB,4BAA6B,WAAA,OAAMrC,MAAAA,EAAI,KAAA,EAAJA,EAAMsC,cAAc,CAACC,iBAAiB,EAAE,EAC3EC,wBAAyB,WAAA,OAAMxC,MAAAA,EAAI,KAAA,EAAJA,EAAMsC,cAAc,CAACG,aAAa,EAAE,EACnEC,cAAe,SAACC,CAAsB,EACrC,OAAO3C,MAAAA,EAAI,KAAA,EAAJA,EAAM0B,KAAK,CAACkB,WAAW,CAACD,EAChC,EACA,EACD,CAAC3C,MAAAA,EAAI,KAAA,EAAJA,EAAMW,IAAI,CAAEX,MAAAA,EAAI,KAAA,EAAJA,EAAM0B,KAAK,CAAE1B,MAAAA,EAAI,KAAA,EAAJA,EAAMyB,MAAM,CAAEzB,MAAAA,EAAI,KAAA,EAAA,AAAU,OAAVL,CAAAA,EAAJK,EAAMiC,QAAQ,AAARA,GAAQtC,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAdA,EAAgBwB,IAAI,CAAEnB,MAAAA,EAAI,KAAA,EAAJA,EAAMsC,cAAc,CAAEpC,EAAsBL,EAAO,SAOlH,AAJyBb,EACxBH,EAAY,WAAA,IAAAgE,EAAAC,EAAA,OAAA,AAAkE,OAAlED,CAAAA,EAAA,AAAoD,OAApDC,CAAAA,EAAM/D,EAAkBgE,kBAAkB,CAAC9C,EAAK+C,GAAG,CAAA,GAACF,AAAA,KAAA,IAAAA,EAAA,KAAA,EAA9CA,EAAgDG,YAAY,AAAZA,GAAYJ,AAAA,KAAA,IAAAA,GAAAA,CAAS,EAAE,CAAC5C,EAAK+C,GAAG,CAAC,GAO7FrE,EAAAuE,aAAA,CAAC9D,EAAUZ,EAAA,CAAC2E,IAAKlD,EAAK+C,GAAI,CAACpD,KAAMA,CAAK,EAAKO,EAAa,CAAEiD,mBAAoB,CAAA,CAAK,EAAKtD,IAHvFnB,EAAAuE,aAAA,CAAC/D,EAAgB,KAI1B\"}"}