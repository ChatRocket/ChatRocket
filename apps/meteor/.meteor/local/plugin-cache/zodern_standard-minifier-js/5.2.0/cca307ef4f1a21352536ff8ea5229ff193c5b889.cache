{"code":"function module(e,t,n){let a,l,r,o,i,s,c,u,m,d,g,E,x,k,b,h,C,f,S,y,p,w,M,L,v,D,I,N,A,G;n.link(\"@rocket.chat/fuselage\",{Box(e){a=e},Icon(e){l=e},Margins(e){r=e},States(e){o=e},StatesIcon(e){i=e},StatesSubtitle(e){s=e},StatesTitle(e){c=e},TextInput(e){u=e},Throbber(e){m=e}},0),n.link(\"@rocket.chat/ui-contexts\",{useSetting(e){d=e},useTranslation(e){g=e},useUserPreference(e){E=e}},1),n.link(\"react\",{default(e){x=e},useMemo(e){k=e},useState(e){b=e}},2),n.link(\"react-virtuoso\",{Virtuoso(e){h=e}},3),n.link(\"../../../../components/Contextualbar\",{ContextualbarHeader(e){C=e},ContextualbarAction(e){f=e},ContextualbarIcon(e){S=e},ContextualbarTitle(e){y=e},ContextualbarClose(e){p=e},ContextualbarContent(e){w=e},ContextualbarEmptyContent(e){M=e}},4),n.link(\"../../../../components/CustomScrollbars\",{VirtuosoScrollbars(e){L=e}},5),n.link(\"../../../../hooks/lists/useRecordList\",{useRecordList(e){v=e}},6),n.link(\"../../../../lib/asyncState\",{AsyncStatePhase(e){D=e}},7),n.link(\"../../../room/MessageList/lib/isMessageNewDay\",{isMessageNewDay(e){I=e}},8),n.link(\"../../../room/MessageList/lib/isMessageSequential\",{isMessageSequential(e){N=e}},9),n.link(\"./ContactHistoryMessage\",{default(e){A=e}},10),n.link(\"./useHistoryMessageList\",{useHistoryMessageList(e){G=e}},11),n.exportDefault(e=>{let{chatId:t,setChatId:n,close:T}=e,[_,B]=b(\"\"),H=g(),q=!!E(\"displayAvatars\"),{itemsList:O,loadMoreItems:P}=G(k(()=>({roomId:t,filter:_}),[t,_])),{phase:R,error:z,items:U,itemCount:V}=v(O),F=Number(d(\"Message_GroupingPeriod\"));return x.createElement(x.Fragment,null,x.createElement(C,null,x.createElement(f,{onClick:()=>n(\"\"),title:H(\"Back\"),name:\"arrow-back\"}),x.createElement(S,{name:\"history\"}),x.createElement(y,null,H(\"Chat_History\")),x.createElement(p,{onClick:T})),x.createElement(w,{paddingInline:0},x.createElement(a,{display:\"flex\",flexDirection:\"row\",p:24,borderBlockEndWidth:\"default\",borderBlockEndStyle:\"solid\",borderBlockEndColor:\"extra-light\",flexShrink:0},x.createElement(a,{display:\"flex\",flexDirection:\"row\",flexGrow:1,mi:\"neg-x4\"},x.createElement(r,{inline:4},x.createElement(u,{placeholder:H(\"Search\"),value:_,onChange:e=>{B(e.currentTarget.value)},addon:x.createElement(l,{name:\"magnifier\",size:\"x20\"})})))),R===D.LOADING&&x.createElement(a,{pi:24,pb:12},x.createElement(m,{size:\"x12\"})),z&&x.createElement(o,null,x.createElement(i,{name:\"warning\",variation:\"danger\"}),x.createElement(c,null,H(\"Something_went_wrong\")),x.createElement(s,null,z.toString())),R!==D.LOADING&&0===V&&x.createElement(M,{title:H(\"No_results_found\")}),x.createElement(a,{flexGrow:1,flexShrink:1,overflow:\"hidden\",display:\"flex\"},!z&&V>0&&history.length>0&&x.createElement(h,{totalCount:V,endReached:R===D.LOADING?()=>void 0:e=>P(e,Math.min(50,V-e)),overscan:25,data:U,components:{Scroller:L},itemContent:(e,t)=>{let n=U[e-1],a=N(t,n,F),l=I(t,n);return x.createElement(A,{message:t,sequential:a,isNewDay:l,showUserAvatar:q})}}))))})}","map":"{\"version\":3,\"sources\":[\"client/views/omnichannel/contactHistory/MessageList/ContactHistoryMessagesList.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Box, Icon, Margins, States, StatesIcon, StatesSubtitle, StatesTitle, TextInput, Throbber } from '@rocket.chat/fuselage';\\nimport { useSetting, useTranslation, useUserPreference } from '@rocket.chat/ui-contexts';\\nimport type { ChangeEvent, Dispatch, ReactElement, SetStateAction } from 'react';\\nimport React, { useMemo, useState } from 'react';\\nimport { Virtuoso } from 'react-virtuoso';\\n\\nimport {\\n\\tContextualbarHeader,\\n\\tContextualbarAction,\\n\\tContextualbarIcon,\\n\\tContextualbarTitle,\\n\\tContextualbarClose,\\n\\tContextualbarContent,\\n\\tContextualbarEmptyContent,\\n} from '../../../../components/Contextualbar';\\nimport { VirtuosoScrollbars } from '../../../../components/CustomScrollbars';\\nimport { useRecordList } from '../../../../hooks/lists/useRecordList';\\nimport { AsyncStatePhase } from '../../../../lib/asyncState';\\nimport { isMessageNewDay } from '../../../room/MessageList/lib/isMessageNewDay';\\nimport { isMessageSequential } from '../../../room/MessageList/lib/isMessageSequential';\\nimport ContactHistoryMessage from './ContactHistoryMessage';\\nimport { useHistoryMessageList } from './useHistoryMessageList';\\n\\nconst ContactHistoryMessagesList = ({\\n\\tchatId,\\n\\tsetChatId,\\n\\tclose,\\n}: {\\n\\tchatId: string;\\n\\tsetChatId: Dispatch<SetStateAction<string>>;\\n\\tclose: () => void;\\n}): ReactElement => {\\n\\tconst [text, setText] = useState('');\\n\\tconst t = useTranslation();\\n\\tconst showUserAvatar = !!useUserPreference<boolean>('displayAvatars');\\n\\tconst { itemsList: messageList, loadMoreItems } = useHistoryMessageList(\\n\\t\\tuseMemo(() => ({ roomId: chatId, filter: text }), [chatId, text]),\\n\\t);\\n\\n\\tconst handleSearchChange = (event: ChangeEvent<HTMLInputElement>): void => {\\n\\t\\tsetText(event.currentTarget.value);\\n\\t};\\n\\n\\tconst { phase, error, items: messages, itemCount: totalItemCount } = useRecordList(messageList);\\n\\tconst messageGroupingPeriod = Number(useSetting('Message_GroupingPeriod'));\\n\\n\\treturn (\\n\\t\\t<>\\n\\t\\t\\t<ContextualbarHeader>\\n\\t\\t\\t\\t<ContextualbarAction onClick={(): void => setChatId('')} title={t('Back')} name='arrow-back' />\\n\\t\\t\\t\\t<ContextualbarIcon name='history' />\\n\\t\\t\\t\\t<ContextualbarTitle>{t('Chat_History')}</ContextualbarTitle>\\n\\t\\t\\t\\t<ContextualbarClose onClick={close} />\\n\\t\\t\\t</ContextualbarHeader>\\n\\n\\t\\t\\t<ContextualbarContent paddingInline={0}>\\n\\t\\t\\t\\t<Box\\n\\t\\t\\t\\t\\tdisplay='flex'\\n\\t\\t\\t\\t\\tflexDirection='row'\\n\\t\\t\\t\\t\\tp={24}\\n\\t\\t\\t\\t\\tborderBlockEndWidth='default'\\n\\t\\t\\t\\t\\tborderBlockEndStyle='solid'\\n\\t\\t\\t\\t\\tborderBlockEndColor='extra-light'\\n\\t\\t\\t\\t\\tflexShrink={0}\\n\\t\\t\\t\\t>\\n\\t\\t\\t\\t\\t<Box display='flex' flexDirection='row' flexGrow={1} mi='neg-x4'>\\n\\t\\t\\t\\t\\t\\t<Margins inline={4}>\\n\\t\\t\\t\\t\\t\\t\\t<TextInput\\n\\t\\t\\t\\t\\t\\t\\t\\tplaceholder={t('Search')}\\n\\t\\t\\t\\t\\t\\t\\t\\tvalue={text}\\n\\t\\t\\t\\t\\t\\t\\t\\tonChange={handleSearchChange}\\n\\t\\t\\t\\t\\t\\t\\t\\taddon={<Icon name='magnifier' size='x20' />}\\n\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t</Margins>\\n\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t{phase === AsyncStatePhase.LOADING && (\\n\\t\\t\\t\\t\\t<Box pi={24} pb={12}>\\n\\t\\t\\t\\t\\t\\t<Throbber size='x12' />\\n\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t)}\\n\\t\\t\\t\\t{error && (\\n\\t\\t\\t\\t\\t<States>\\n\\t\\t\\t\\t\\t\\t<StatesIcon name='warning' variation='danger' />\\n\\t\\t\\t\\t\\t\\t<StatesTitle>{t('Something_went_wrong')}</StatesTitle>\\n\\t\\t\\t\\t\\t\\t<StatesSubtitle>{error.toString()}</StatesSubtitle>\\n\\t\\t\\t\\t\\t</States>\\n\\t\\t\\t\\t)}\\n\\t\\t\\t\\t{phase !== AsyncStatePhase.LOADING && totalItemCount === 0 && <ContextualbarEmptyContent title={t('No_results_found')} />}\\n\\t\\t\\t\\t<Box flexGrow={1} flexShrink={1} overflow='hidden' display='flex'>\\n\\t\\t\\t\\t\\t{!error && totalItemCount > 0 && history.length > 0 && (\\n\\t\\t\\t\\t\\t\\t<Virtuoso\\n\\t\\t\\t\\t\\t\\t\\ttotalCount={totalItemCount}\\n\\t\\t\\t\\t\\t\\t\\tendReached={\\n\\t\\t\\t\\t\\t\\t\\t\\tphase === AsyncStatePhase.LOADING\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t? (): void => undefined\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t: (start): unknown => loadMoreItems(start, Math.min(50, totalItemCount - start))\\n\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t\\toverscan={25}\\n\\t\\t\\t\\t\\t\\t\\tdata={messages}\\n\\t\\t\\t\\t\\t\\t\\tcomponents={{ Scroller: VirtuosoScrollbars }}\\n\\t\\t\\t\\t\\t\\t\\titemContent={(index, data): ReactElement => {\\n\\t\\t\\t\\t\\t\\t\\t\\tconst lastMessage = messages[index - 1];\\n\\t\\t\\t\\t\\t\\t\\t\\tconst isSequential = isMessageSequential(data, lastMessage, messageGroupingPeriod);\\n\\t\\t\\t\\t\\t\\t\\t\\tconst isNewDay = isMessageNewDay(data, lastMessage);\\n\\t\\t\\t\\t\\t\\t\\t\\treturn (\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<ContactHistoryMessage message={data} sequential={isSequential} isNewDay={isNewDay} showUserAvatar={showUserAvatar} />\\n\\t\\t\\t\\t\\t\\t\\t\\t);\\n\\t\\t\\t\\t\\t\\t\\t}}\\n\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t</Box>\\n\\t\\t\\t</ContextualbarContent>\\n\\t\\t</>\\n\\t);\\n};\\n\\nexport default ContactHistoryMessagesList;\\n\",null],\"names\":[\"Box\",\"Icon\",\"Margins\",\"States\",\"StatesIcon\",\"StatesSubtitle\",\"StatesTitle\",\"TextInput\",\"Throbber\",\"useSetting\",\"useTranslation\",\"useUserPreference\",\"React\",\"useMemo\",\"useState\",\"Virtuoso\",\"ContextualbarHeader\",\"ContextualbarAction\",\"ContextualbarIcon\",\"ContextualbarTitle\",\"ContextualbarClose\",\"ContextualbarContent\",\"ContextualbarEmptyContent\",\"VirtuosoScrollbars\",\"useRecordList\",\"AsyncStatePhase\",\"isMessageNewDay\",\"isMessageSequential\",\"ContactHistoryMessage\",\"useHistoryMessageList\",\"module\",\"link\",\"v\",\"default\",\"exportDefault\",\"_ref\",\"chatId\",\"setChatId\",\"close\",\"text\",\"setText\",\"t\",\"showUserAvatar\",\"itemsList\",\"messageList\",\"loadMoreItems\",\"roomId\",\"filter\",\"phase\",\"error\",\"items\",\"messages\",\"itemCount\",\"totalItemCount\",\"messageGroupingPeriod\",\"Number\",\"createElement\",\"Fragment\",\"onClick\",\"title\",\"name\",\"paddingInline\",\"display\",\"flexDirection\",\"p\",\"borderBlockEndWidth\",\"borderBlockEndStyle\",\"borderBlockEndColor\",\"flexShrink\",\"flexGrow\",\"mi\",\"inline\",\"placeholder\",\"value\",\"onChange\",\"event\",\"currentTarget\",\"addon\",\"size\",\"LOADING\",\"pi\",\"pb\",\"variation\",\"toString\",\"overflow\",\"history\",\"length\",\"totalCount\",\"endReached\",\"undefined\",\"start\",\"Math\",\"min\",\"overscan\",\"data\",\"components\",\"Scroller\",\"itemContent\",\"index\",\"lastMessage\",\"isSequential\",\"isNewDay\",\"message\",\"sequential\"],\"mappings\":\"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\"}"}