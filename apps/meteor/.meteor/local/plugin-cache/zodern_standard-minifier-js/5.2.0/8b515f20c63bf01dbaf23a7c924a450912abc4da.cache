{"code":"function module(e,n,t){var r,l,o,i,u,a,c,s,f,m,d,v,g,h,k,x,E,b,p,F,_=[\"control\",\"trigger\",\"index\"],w=[\"label\",\"value\",\"onMouseDown\"];t.link(\"@babel/runtime/helpers/extends\",{default:function(e){r=e}},0),t.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default:function(e){l=e}},1),t.export({ActionForm:function(){return D}}),t.link(\"@rocket.chat/fuselage\",{Box:function(e){o=e},Field:function(e){i=e},FieldGroup:function(e){u=e},FieldHint:function(e){a=e},FieldLabel:function(e){c=e},FieldRow:function(e){s=e},Option:function(e){f=e},SelectLegacy:function(e){m=e},Tag:function(e){d=e}},0),t.link(\"@rocket.chat/fuselage-hooks\",{useUniqueId:function(e){v=e}},1),t.link(\"react\",{default:function(e){g=e},useCallback:function(e){h=e},useMemo:function(e){k=e}},2),t.link(\"react-hook-form\",{Controller:function(e){x=e},useWatch:function(e){E=e}},3),t.link(\"react-i18next\",{useTranslation:function(e){b=e}},4),t.link(\"../../../../hooks/useHasLicenseModule\",{useHasLicenseModule:function(e){p=e}},5),t.link(\"../utils\",{getActionFormFields:function(e){F=e}},6);var M={\"use-external-service\":\"External_service_action_hint\"},C=[\"use-external-service\"],D=function(e){var n=e.control,t=e.trigger,D=e.index,L=l(e,_),S=b().t,y=v(),A=\"actions.\"+D+\".name\",H=E({control:n,name:A}),j=p(\"livechat-enterprise\"),G=k(function(){return[[\"send-message\",S(\"Send_a_message\")],[\"use-external-service\",S(\"Send_a_message_external_service\")]]},[S]),I=F(H),P=k(function(){return M[H]||\"\"},[H]),T=h(function(e){return!j&&C.includes(e)},[j]),W=h(function(e,n){return g.createElement(g.Fragment,null,T(n)?g.createElement(o,{justifyContent:\"space-between\",flexDirection:\"row\",display:\"flex\",width:\"100%\"},S(e),g.createElement(d,{variant:\"featured\"},S(\"Premium\"))):S(e))},[T,S]);return g.createElement(u,L,g.createElement(i,null,g.createElement(c,{htmlFor:y},S(\"Action\")),g.createElement(s,null,g.createElement(x,{name:A,control:n,render:function(e){var n=e.field,t=n.onChange,i=n.value,u=n.name,a=n.ref;return g.createElement(m,{ref:a,name:u,onChange:t,value:i,id:y,options:G,renderSelected:function(e){var n=e.label,t=e.value;return g.createElement(o,{flexGrow:\"1\"},W(n,t))},renderItem:function(e){var n=e.label,t=e.value,o=e.onMouseDown,i=l(e,w);return g.createElement(f,r({},i,{onMouseDown:T(t)?function(e){return e.preventDefault()}:o,disabled:T(t),label:W(n,t)}))}})}})),P&&g.createElement(a,null,S(P))),g.createElement(I,{control:n,trigger:t,index:D}))}}","map":"{\"version\":3,\"sources\":[\"client/views/omnichannel/triggers/actions/ActionForm.tsx\",\"<anon>\"],\"sourcesContent\":[\"import {\\n\\tBox,\\n\\tField,\\n\\tFieldGroup,\\n\\tFieldHint,\\n\\tFieldLabel,\\n\\tFieldRow,\\n\\tOption,\\n\\tSelectLegacy,\\n\\tTag,\\n\\ttype SelectOption,\\n} from '@rocket.chat/fuselage';\\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\\nimport type { ComponentProps } from 'react';\\nimport React, { useCallback, useMemo } from 'react';\\nimport type { Control, UseFormTrigger } from 'react-hook-form';\\nimport { Controller, useWatch } from 'react-hook-form';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { useHasLicenseModule } from '../../../../hooks/useHasLicenseModule';\\nimport { type TriggersPayload } from '../EditTrigger';\\nimport { getActionFormFields } from '../utils';\\n\\ntype SendMessageFormType = ComponentProps<typeof Field> & {\\n\\tcontrol: Control<TriggersPayload>;\\n\\ttrigger: UseFormTrigger<TriggersPayload>;\\n\\tindex: number;\\n};\\n\\nconst ACTION_HINTS: Record<string, TranslationKey> = {\\n\\t'use-external-service': 'External_service_action_hint',\\n} as const;\\n\\nconst PREMIUM_ACTIONS = ['use-external-service'];\\n\\nexport const ActionForm = ({ control, trigger, index, ...props }: SendMessageFormType) => {\\n\\tconst { t } = useTranslation();\\n\\n\\tconst actionFieldId = useUniqueId();\\n\\tconst actionFieldName = `actions.${index}.name` as const;\\n\\tconst actionFieldValue = useWatch({ control, name: actionFieldName });\\n\\n\\tconst hasLicense = useHasLicenseModule('livechat-enterprise');\\n\\n\\tconst actionOptions = useMemo<SelectOption[]>(() => {\\n\\t\\treturn [\\n\\t\\t\\t['send-message', t('Send_a_message')],\\n\\t\\t\\t['use-external-service', t('Send_a_message_external_service')],\\n\\t\\t];\\n\\t}, [t]);\\n\\n\\tconst ActionFormFields = getActionFormFields(actionFieldValue);\\n\\tconst actionHint = useMemo(() => ACTION_HINTS[actionFieldValue] || '', [actionFieldValue]);\\n\\tconst isOptionDisabled = useCallback((value: string) => !hasLicense && PREMIUM_ACTIONS.includes(value), [hasLicense]);\\n\\n\\tconst renderOption = useCallback(\\n\\t\\t(label: TranslationKey, value: string) => {\\n\\t\\t\\treturn (\\n\\t\\t\\t\\t<>\\n\\t\\t\\t\\t\\t{isOptionDisabled(value) ? (\\n\\t\\t\\t\\t\\t\\t<Box justifyContent='space-between' flexDirection='row' display='flex' width='100%'>\\n\\t\\t\\t\\t\\t\\t\\t{t(label)}\\n\\t\\t\\t\\t\\t\\t\\t<Tag variant='featured'>{t('Premium')}</Tag>\\n\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t) : (\\n\\t\\t\\t\\t\\t\\tt(label)\\n\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t</>\\n\\t\\t\\t);\\n\\t\\t},\\n\\t\\t[isOptionDisabled, t],\\n\\t);\\n\\n\\treturn (\\n\\t\\t<FieldGroup {...props}>\\n\\t\\t\\t<Field>\\n\\t\\t\\t\\t<FieldLabel htmlFor={actionFieldId}>{t('Action')}</FieldLabel>\\n\\t\\t\\t\\t<FieldRow>\\n\\t\\t\\t\\t\\t<Controller\\n\\t\\t\\t\\t\\t\\tname={actionFieldName}\\n\\t\\t\\t\\t\\t\\tcontrol={control}\\n\\t\\t\\t\\t\\t\\trender={({ field: { onChange, value, name, ref } }) => {\\n\\t\\t\\t\\t\\t\\t\\treturn (\\n\\t\\t\\t\\t\\t\\t\\t\\t// TODO: Remove SelectLegacy once we have a new Select component\\n\\t\\t\\t\\t\\t\\t\\t\\t<SelectLegacy\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tref={ref}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tname={name}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tonChange={onChange}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tvalue={value}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tid={actionFieldId}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\toptions={actionOptions}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\trenderSelected={({ label, value }) => <Box flexGrow='1'>{renderOption(label, value)}</Box>}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\trenderItem={({ label, value, onMouseDown, ...props }) => (\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<Option\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{...props}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tonMouseDown={isOptionDisabled(value) ? (e) => e.preventDefault() : onMouseDown}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tdisabled={isOptionDisabled(value)}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tlabel={renderOption(label, value)}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t\\t);\\n\\t\\t\\t\\t\\t\\t}}\\n\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t\\t{actionHint && <FieldHint>{t(actionHint)}</FieldHint>}\\n\\t\\t\\t</Field>\\n\\n\\t\\t\\t<ActionFormFields control={control} trigger={trigger} index={index} />\\n\\t\\t</FieldGroup>\\n\\t);\\n};\\n\",null],\"names\":[\"_extends\",\"_objectWithoutProperties\",\"Box\",\"Field\",\"FieldGroup\",\"FieldHint\",\"FieldLabel\",\"FieldRow\",\"Option\",\"SelectLegacy\",\"Tag\",\"useUniqueId\",\"React\",\"useCallback\",\"useMemo\",\"Controller\",\"useWatch\",\"useTranslation\",\"useHasLicenseModule\",\"getActionFormFields\",\"module\",\"link\",\"default\",\"v\",\"export\",\"ActionForm\",\"ACTION_HINTS\",\"PREMIUM_ACTIONS\",\"_ref\",\"control\",\"trigger\",\"index\",\"props\",\"_excluded\",\"t\",\"_useTranslation\",\"actionFieldId\",\"actionFieldName\",\"actionFieldValue\",\"name\",\"hasLicense\",\"actionOptions\",\"ActionFormFields\",\"actionHint\",\"isOptionDisabled\",\"value\",\"includes\",\"renderOption\",\"label\",\"createElement\",\"Fragment\",\"justifyContent\",\"flexDirection\",\"display\",\"width\",\"variant\",\"htmlFor\",\"render\",\"_ref2\",\"_ref2$field\",\"field\",\"onChange\",\"ref\",\"id\",\"options\",\"renderSelected\",\"_ref3\",\"flexGrow\",\"renderItem\",\"_ref4\",\"onMouseDown\",\"_excluded2\",\"e\",\"preventDefault\",\"disabled\"],\"mappings\":\"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\"}"}