{"code":"function module(e,s,n){let t,i,l,u,c,a,r,o;n.link(\"@babel/runtime/helpers/objectSpread2\",{default(e){t=e}},0),n.export({useLicenseBase:()=>m,useLicense:()=>v,useHasLicense:()=>f,useLicenseName:()=>k,useInvalidateLicense:()=>p}),n.link(\"@rocket.chat/ui-contexts\",{useEndpoint(e){i=e},useStream(e){l=e},useUserId(e){u=e}},0),n.link(\"@tanstack/react-query\",{useQuery(e){c=e},useQueryClient(e){a=e}},1),n.link(\"react\",{useEffect(e){r=e}},2);let d=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;clearTimeout(o),o=setTimeout(()=>{o=void 0,e.invalidateQueries([\"licenses\"])},s)},m=e=>{let{params:s,select:n}=e,a=u(),o=i(\"GET\",\"/v1/licenses.info\"),d=p(),m=l(\"notify-all\");return r(()=>m(\"license\",()=>d()),[m,d]),c([\"licenses\",\"getLicenses\",s],()=>o(t({},s)),{staleTime:1/0,keepPreviousData:!0,select:n,enabled:!!a})},v=e=>m({params:e,select:e=>e.license}),f=()=>m({select:e=>!!e.license}),k=e=>m({params:e,select:e=>{var s;return(null==e?void 0:null===(s=e.license.tags)||void 0===s?void 0:s.map(e=>e.name).join(\" \"))||\"Community\"}}),p=()=>{let e=a();return s=>d(e,s)}}","map":"{\"version\":3,\"sources\":[\"client/hooks/useLicense.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { Serialized } from '@rocket.chat/core-typings';\\nimport type { OperationResult } from '@rocket.chat/rest-typings';\\nimport { useEndpoint, useStream, useUserId } from '@rocket.chat/ui-contexts';\\nimport type { QueryClient, UseQueryResult } from '@tanstack/react-query';\\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\\nimport { useEffect } from 'react';\\n\\ntype LicenseDataType = Serialized<Awaited<OperationResult<'GET', '/v1/licenses.info'>>>;\\n\\ntype LicenseParams = {\\n\\tloadValues?: boolean;\\n};\\n\\nconst invalidateQueryClientLicenses = (() => {\\n\\tlet timeout: ReturnType<typeof setTimeout> | undefined;\\n\\n\\treturn (queryClient: QueryClient, milliseconds = 5000) => {\\n\\t\\tclearTimeout(timeout);\\n\\t\\ttimeout = setTimeout(() => {\\n\\t\\t\\ttimeout = undefined;\\n\\t\\t\\tqueryClient.invalidateQueries(['licenses']);\\n\\t\\t}, milliseconds);\\n\\t};\\n})();\\n\\nexport const useLicenseBase = <TData = LicenseDataType>({\\n\\tparams,\\n\\tselect,\\n}: {\\n\\tparams?: LicenseParams;\\n\\tselect: (data: LicenseDataType) => TData;\\n}) => {\\n\\tconst uid = useUserId();\\n\\n\\tconst getLicenses = useEndpoint('GET', '/v1/licenses.info');\\n\\n\\tconst invalidateQueries = useInvalidateLicense();\\n\\n\\tconst notify = useStream('notify-all');\\n\\n\\tuseEffect(() => notify('license', () => invalidateQueries()), [notify, invalidateQueries]);\\n\\n\\treturn useQuery(['licenses', 'getLicenses', params], () => getLicenses({ ...params }), {\\n\\t\\tstaleTime: Infinity,\\n\\t\\tkeepPreviousData: true,\\n\\t\\tselect,\\n\\t\\tenabled: !!uid,\\n\\t});\\n};\\n\\nexport const useLicense = (params?: LicenseParams) => {\\n\\treturn useLicenseBase({ params, select: (data) => data.license });\\n};\\n\\nexport const useHasLicense = (): UseQueryResult<boolean> => {\\n\\treturn useLicenseBase({ select: (data) => Boolean(data.license) });\\n};\\n\\nexport const useLicenseName = (params?: LicenseParams) => {\\n\\treturn useLicenseBase({ params, select: (data) => data?.license.tags?.map((tag) => tag.name).join(' ') || 'Community' });\\n};\\n\\nexport const useInvalidateLicense = () => {\\n\\tconst queryClient = useQueryClient();\\n\\treturn (milliseconds?: number) => invalidateQueryClientLicenses(queryClient, milliseconds);\\n};\\n\",null],\"names\":[\"_objectSpread\",\"useEndpoint\",\"useStream\",\"useUserId\",\"useQuery\",\"useQueryClient\",\"useEffect\",\"timeout\",\"module\",\"link\",\"default\",\"v\",\"export\",\"useLicenseBase\",\"useLicense\",\"useHasLicense\",\"useLicenseName\",\"useInvalidateLicense\",\"invalidateQueryClientLicenses\",\"queryClient\",\"milliseconds\",\"arguments\",\"length\",\"undefined\",\"clearTimeout\",\"setTimeout\",\"invalidateQueries\",\"_ref\",\"params\",\"select\",\"uid\",\"getLicenses\",\"notify\",\"staleTime\",\"Infinity\",\"keepPreviousData\",\"enabled\",\"data\",\"license\",\"Boolean\",\"_data$license$tags\",\"tags\",\"map\",\"tag\",\"name\",\"join\"],\"mappings\":\"2BAEAA,EAA6EC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAYxEC,EAZIC,EAAaC,IAAA,CAAA,uCAA4B,CAAAC,QAA2BC,CAAA,EAAAX,EAAAW,CAAA,CAAA,EAAA,GAA7EH,EAAOI,MAAE,CAAA,CAAAC,eAAaA,IAAWA,EAAWC,WAAMA,IAAAA,EAAAC,cAA2BA,IAAAA,EAAAC,eAAAA,IAAAA,EAAAC,qBAAAA,IAAAA,CAAA,GAAAT,EAAAC,IAAA,CAAA,2BAAA,CAAAR,YAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,UAAAS,CAAA,EAAAT,EAAAS,CAAA,EAAAR,UAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,wBAAA,CAAAL,SAAAO,CAAA,EAAAP,EAAAO,CAAA,EAAAN,eAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAAH,UAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAW7E,IAAMO,EAGE,SAACC,CAAwB,EAAyB,IAAvBC,EAAYC,UAAAC,MAAA,CAAA,GAAAD,AAAAE,KAAAA,IAAAF,SAAA,CAAA,EAAA,CAAAA,SAAA,CAAA,EAAA,CAAG,IAChDG,aAAajB,GACbA,EAAUkB,WAAW,KACpBlB,EAAUgB,KAAAA,EACVJ,EAAYO,iBAAiB,CAAC,CAAC,WAAW,CAC3C,EAAGN,EACJ,EAGYP,EAAiBc,IAMzB,GANmD,CACvDC,OAAAA,CAAM,CACNC,OAAAA,CAAAA,CAIA,CAAAF,EACMG,EAAM3B,IAEN4B,EAAc9B,EAAY,MAAO,qBAEjCyB,EAAoBT,IAEpBe,EAAS9B,EAAU,cAIzB,OAFAI,EAAU,IAAM0B,EAAO,UAAW,IAAMN,KAAsB,CAACM,EAAQN,EAAkB,EAElFtB,EAAS,CAAC,WAAY,cAAewB,EAAO,CAAE,IAAMG,EAAW/B,EAAA,CAAA,EAAM4B,IAAW,CACtFK,UAAWC,IACXC,iBAAkB,CAAA,EAClBN,OAAAA,EACAO,QAAS,CAAC,CAACN,GAEb,EAEahB,EAAcc,GACnBf,EAAe,CAAEe,OAAAA,EAAQC,OAASQ,GAASA,EAAKC,OAAAA,AAAO,GAGlDvB,EAAgBA,IACrBF,EAAe,CAAEgB,OAASQ,GAASE,CAAAA,CAAQF,EAAKC,OAAO,AAAC,GAGnDtB,EAAkBY,GACvBf,EAAe,CAAEe,OAAAA,EAAQC,OAASQ,IAAI,IAAAG,EAAA,MAAK,AAAAH,CAAAA,MAAAA,EAAI,KAAA,EAAA,AAAc,OAAdG,CAAAA,EAAJH,EAAMC,OAAO,CAACG,IAAI,AAAJA,GAAID,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAlBA,EAAoBE,GAAG,CAAEC,GAAQA,EAAIC,IAAI,EAAEC,IAAI,CAAC,IAAG,GAAK,WAAW,CAAA,GAGzG5B,EAAuBA,KACnC,IAAME,EAAcd,IACpB,OAAQe,GAA0BF,EAA8BC,EAAaC,EAC9E\"}"}