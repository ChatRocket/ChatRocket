{"code":"function module(e,n,i){var t,s,a,o,r,c,u,l,p;i.link(\"@babel/runtime/regenerator\",{default:function(e){t=e}},0),i.link(\"meteor/meteor\",{Meteor:function(e){s=e}},0),i.link(\"../../../app/authorization/client\",{hasAtLeastOnePermission:function(e){a=e}},1),i.link(\"../../../app/settings/client\",{settings:function(e){o=e}},2),i.link(\"../../../app/ui-utils/client\",{MessageAction:function(e){r=e}},3),i.link(\"../../../app/utils/client/lib/SDKClient\",{sdk:function(e){c=e}},4),i.link(\"../../lib/queryClient\",{queryClient:function(e){u=e}},5),i.link(\"../../lib/toast\",{dispatchToastMessage:function(e){l=e}},6),i.link(\"../../lib/utils/messageArgs\",{messageArgs:function(e){p=e}},7),s.startup(function(){r.addButton({id:\"unpin-message\",icon:\"pin\",label:\"Unpin\",type:\"interaction\",context:[\"pinned\",\"message\",\"message-mobile\",\"threads\",\"direct\",\"videoconf\",\"videoconf-threads\"],action:function(e,n){var i,s;return t.async(function(e){for(;;)switch(e.prev=e.next){case 0:return(s=void 0===(i=n.message)?p(this).msg:i).pinned=!1,e.prev=2,e.next=5,t.awrap(c.call(\"unpinMessage\",s));case 5:u.invalidateQueries([\"rooms\",s.rid,\"pinned-messages\"]),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),l({type:\"error\",message:e.t0});case 11:case\"end\":return e.stop()}},null,this,[[2,8]],Promise)},condition:function(e){var n=e.message;return!!(e.subscription&&o.get(\"Message_AllowPinning\"))&&!!n.pinned&&a(\"pin-message\",n.rid)},order:2,group:\"menu\"})})}","map":"{\"version\":3,\"sources\":[\"client/startup/actionButtons/unpinMessage.ts\",\"<anon>\"],\"sourcesContent\":[\"import { Meteor } from 'meteor/meteor';\\n\\nimport { hasAtLeastOnePermission } from '../../../app/authorization/client';\\nimport { settings } from '../../../app/settings/client';\\nimport { MessageAction } from '../../../app/ui-utils/client';\\nimport { sdk } from '../../../app/utils/client/lib/SDKClient';\\nimport { queryClient } from '../../lib/queryClient';\\nimport { dispatchToastMessage } from '../../lib/toast';\\nimport { messageArgs } from '../../lib/utils/messageArgs';\\n\\nMeteor.startup(() => {\\n\\tMessageAction.addButton({\\n\\t\\tid: 'unpin-message',\\n\\t\\ticon: 'pin',\\n\\t\\tlabel: 'Unpin',\\n\\t\\ttype: 'interaction',\\n\\t\\tcontext: ['pinned', 'message', 'message-mobile', 'threads', 'direct', 'videoconf', 'videoconf-threads'],\\n\\t\\tasync action(_, props) {\\n\\t\\t\\tconst { message = messageArgs(this).msg } = props;\\n\\t\\t\\tmessage.pinned = false;\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tawait sdk.call('unpinMessage', message);\\n\\t\\t\\t\\tqueryClient.invalidateQueries(['rooms', message.rid, 'pinned-messages']);\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\tcondition({ message, subscription }) {\\n\\t\\t\\tif (!subscription || !settings.get('Message_AllowPinning') || !message.pinned) {\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn hasAtLeastOnePermission('pin-message', message.rid);\\n\\t\\t},\\n\\t\\torder: 2,\\n\\t\\tgroup: 'menu',\\n\\t});\\n});\\n\",null],\"names\":[\"_regeneratorRuntime\",\"Meteor\",\"hasAtLeastOnePermission\",\"settings\",\"MessageAction\",\"sdk\",\"queryClient\",\"dispatchToastMessage\",\"messageArgs\",\"module\",\"link\",\"default\",\"v\",\"startup\",\"addButton\",\"id\",\"icon\",\"label\",\"type\",\"context\",\"action\",\"_\",\"props\",\"_props$message\",\"message\",\"async\",\"_context\",\"prev\",\"next\",\"msg\",\"pinned\",\"awrap\",\"call\",\"invalidateQueries\",\"rid\",\"t0\",\"stop\",\"Promise\",\"condition\",\"_ref\",\"subscription\",\"get\",\"order\",\"group\"],\"mappings\":\"2BAAAA,EAAAC,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAhBC,EAAAC,IAAA,CAAA,6BAAgB,CAAAC,QAAA,SAAAC,CAAA,EAAAZ,EAAAY,CAAA,CAAA,EAAA,GAA9BH,EAAQC,IAAA,CAAM,gBAAgB,CAAAT,OAAA,SAAAW,CAAA,EAAAX,EAAAW,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,oCAAA,CAAAR,wBAAA,SAAAU,CAAA,EAAAV,EAAAU,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,+BAAA,CAAAP,SAAA,SAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,+BAAA,CAAAN,cAAA,SAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,0CAAA,CAAAL,IAAA,SAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,wBAAA,CAAAJ,YAAA,SAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,kBAAA,CAAAH,qBAAA,SAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,8BAAA,CAAAF,YAAA,SAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAUvCX,EAAOY,OAAO,CAAC,WACdT,EAAcU,SAAS,CAAC,CACvBC,GAAI,gBACJC,KAAM,MACNC,MAAO,QACPC,KAAM,cACNC,QAAS,CAAC,SAAU,UAAW,iBAAkB,UAAW,SAAU,YAAa,oBAAoB,CACjGC,OAAM,SAACC,CAAC,CAAEC,CAAK,EAAA,IAAAC,EAAAC,EAAA,OAAAxB,EAAAyB,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAEG,MAAvBJ,AADQA,CAAAA,EAAOD,AAAA,KAAA,IADKA,CAAAA,EACwBD,EAApCE,OAAO,AAAPA,EAAUhB,EAAY,IAAI,EAAEqB,GAAG,CAAAN,CAAAA,EAC/BO,MAAM,CAAG,CAAA,EAAMJ,EAAAC,IAAA,CAAA,EAAAD,EAAAE,IAAA,CAAA,EAAA5B,EAAA+B,KAAA,CAEhB1B,EAAI2B,IAAI,CAAC,eAAgBR,GAAQ,MAAA,EACvClB,EAAY2B,iBAAiB,CAAC,CAAC,QAAST,EAAQU,GAAG,CAAE,kBAAkB,EAAER,EAAAE,IAAA,CAAA,GAAA,KAAA,MAAA,EAAAF,EAAAC,IAAA,CAAA,EAAAD,EAAAS,EAAA,CAAAT,EAAA,KAAA,CAAA,GAEzEnB,EAAqB,CAAEW,KAAM,QAASM,QAAOE,EAAAS,EAAAA,AAAO,EAAI,MAAA,GAAA,IAAA,MAAA,OAAAT,EAAAU,IAAA,EAAA,CAAA,EAAA,KAAA,IAAA,CAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAAC,QAAA,EAG1DC,UAAS,SAAAC,CAAA,EAA0B,IAAvBf,EAAOe,EAAPf,OAAO,OAClB,EAAI,CAAA,AAD4Be,EAAZC,YAAY,EACVrC,EAASsC,GAAG,CAAC,uBAAsB,KAAMjB,EAAQM,MAAM,EAItE5B,EAAwB,cAAesB,EAAQU,GAAG,CAC1D,EACAQ,MAAO,EACPC,MAAO,QAET\"}"}