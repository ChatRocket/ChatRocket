{"code":"function module(o,t,n){var l,i,e,r,c;function s(o){var t=i(function(t){if(t){var n=c.getStore(o);null!=n&&n.scroll&&!n.atBottom?t.scrollTo({left:30,top:n.scroll}):t.scrollTo({top:t.scrollHeight})}},[o]),n=i(function(t){if(t){var n=c.getStore(o),l=r({wait:100})(function(){null==n||n.update({scroll:t.scrollTop,atBottom:e(t,50)})});t.addEventListener(\"scroll\",l,{passive:!0})}},[o]);return{innerRef:l(n,t)}}n.export({useRestoreScrollPosition:function(){return s}}),n.link(\"@rocket.chat/fuselage-hooks\",{useMergedRefs:function(o){l=o}},0),n.link(\"react\",{useCallback:function(o){i=o}},1),n.link(\"../../../../../app/ui/client/views/app/lib/scrolling\",{isAtBottom:function(o){e=o}},2),n.link(\"../../../../../lib/utils/highOrderFunctions\",{withThrottling:function(o){r=o}},3),n.link(\"../../../../lib/RoomManager\",{RoomManager:function(o){c=o}},4)}","map":"{\"version\":3,\"sources\":[\"client/views/room/body/hooks/useRestoreScrollPosition.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom } from '@rocket.chat/core-typings';\\nimport { useMergedRefs } from '@rocket.chat/fuselage-hooks';\\nimport type { RefObject } from 'react';\\nimport { useCallback } from 'react';\\n\\nimport { isAtBottom } from '../../../../../app/ui/client/views/app/lib/scrolling';\\nimport { withThrottling } from '../../../../../lib/utils/highOrderFunctions';\\nimport { RoomManager } from '../../../../lib/RoomManager';\\n\\nexport function useRestoreScrollPosition(roomId: IRoom['_id']) {\\n\\tconst ref = useCallback(\\n\\t\\t(node: HTMLElement | null) => {\\n\\t\\t\\tif (!node) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t\\tconst store = RoomManager.getStore(roomId);\\n\\n\\t\\t\\tif (store?.scroll && !store.atBottom) {\\n\\t\\t\\t\\tnode.scrollTo({\\n\\t\\t\\t\\t\\tleft: 30,\\n\\t\\t\\t\\t\\ttop: store.scroll,\\n\\t\\t\\t\\t});\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tnode.scrollTo({\\n\\t\\t\\t\\t\\ttop: node.scrollHeight,\\n\\t\\t\\t\\t});\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t[roomId],\\n\\t);\\n\\n\\tconst refCallback = useCallback(\\n\\t\\t(node: HTMLElement | null) => {\\n\\t\\t\\tif (!node) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tconst store = RoomManager.getStore(roomId);\\n\\n\\t\\t\\tconst handleWrapperScroll = withThrottling({ wait: 100 })(() => {\\n\\t\\t\\t\\tstore?.update({ scroll: node.scrollTop, atBottom: isAtBottom(node, 50) });\\n\\t\\t\\t});\\n\\n\\t\\t\\tnode.addEventListener('scroll', handleWrapperScroll, {\\n\\t\\t\\t\\tpassive: true,\\n\\t\\t\\t});\\n\\t\\t},\\n\\t\\t[roomId],\\n\\t);\\n\\n\\treturn {\\n\\t\\tinnerRef: useMergedRefs(refCallback, ref) as unknown as RefObject<HTMLElement>,\\n\\t};\\n}\\n\",null],\"names\":[\"useMergedRefs\",\"useCallback\",\"isAtBottom\",\"withThrottling\",\"RoomManager\",\"useRestoreScrollPosition\",\"roomId\",\"ref\",\"node\",\"store\",\"getStore\",\"scroll\",\"atBottom\",\"scrollTo\",\"left\",\"top\",\"scrollHeight\",\"refCallback\",\"handleWrapperScroll\",\"wait\",\"update\",\"scrollTop\",\"addEventListener\",\"passive\",\"innerRef\",\"module\",\"export\",\"link\",\"v\"],\"mappings\":\"2BAC4DA,EAAAC,EAAAC,EAAAC,EAAAC,EAQtD,SAAUC,EAAyBC,CAAoB,EAC5D,IAAMC,EAAMN,EACX,SAACO,CAAwB,EACxB,GAAKA,GAGL,IAAMC,EAAQL,EAAYM,QAAQ,CAACJ,EAE/BG,OAAAA,GAAAA,EAAOE,MAAM,EAAI,CAACF,EAAMG,QAAQ,CACnCJ,EAAKK,QAAQ,CAAC,CACbC,KAAM,GACNC,IAAKN,EAAME,MAAAA,GAGZH,EAAKK,QAAQ,CAAC,CACbE,IAAKP,EAAKQ,YAAAA,GAGb,EACA,CAACV,EAAO,EAGHW,EAAchB,EACnB,SAACO,CAAwB,EACxB,GAAKA,GAIL,IAAMC,EAAQL,EAAYM,QAAQ,CAACJ,GAE7BY,EAAsBf,EAAe,CAAEgB,KAAM,GAAG,GAAI,WACzDV,MAAAA,GAAAA,EAAOW,MAAM,CAAC,CAAET,OAAQH,EAAKa,SAAS,CAAET,SAAUV,EAAWM,EAAM,GAAG,EACvE,GAEAA,EAAKc,gBAAgB,CAAC,SAAUJ,EAAqB,CACpDK,QAAS,CAAA,IAEX,EACA,CAACjB,EAAO,EAGT,MAAO,CACNkB,SAAUxB,EAAciB,EAAaV,GAEvC,CApDAkB,EAAOC,MAAE,CAAA,CAAArB,yBAAqB,WAAA,OAAAA,CAA8B,CAAA,GAAAoB,EAAAE,IAAA,CAAA,8BAAA,CAAA3B,cAAA,SAAA4B,CAAA,EAAA5B,EAAA4B,CAAA,CAAA,EAAA,GAAAH,EAAAE,IAAA,CAAA,QAAA,CAAA1B,YAAA,SAAA2B,CAAA,EAAA3B,EAAA2B,CAAA,CAAA,EAAA,GAAAH,EAAAE,IAAA,CAAA,uDAAA,CAAAzB,WAAA,SAAA0B,CAAA,EAAA1B,EAAA0B,CAAA,CAAA,EAAA,GAAAH,EAAAE,IAAA,CAAA,8CAAA,CAAAxB,eAAA,SAAAyB,CAAA,EAAAzB,EAAAyB,CAAA,CAAA,EAAA,GAAAH,EAAAE,IAAA,CAAA,8BAAA,CAAAvB,YAAA,SAAAwB,CAAA,EAAAxB,EAAAwB,CAAA,CAAA,EAAA\"}"}