{"code":"function module(t,n,e){e.link(\"@babel/runtime/regenerator\",{default:function(t){r=t}},0),e.export({useOutlookAuthentication:function(){return l},useOutlookAuthenticationMutation:function(){return f},useOutlookAuthenticationMutationLogout:function(){return k}}),e.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch:function(t){o=t}},0),e.link(\"@tanstack/react-query\",{useMutation:function(t){u=t},useQuery:function(t){a=t},useQueryClient:function(t){i=t}},1),e.link(\"react-i18next\",{useTranslation:function(t){s=t}},2),e.link(\"../lib/NotOnDesktopError\",{NotOnDesktopError:function(t){c=t}},3);var r,o,u,a,i,s,c,l=function(){var t=a([\"outlook\",\"auth\"],function(){var t,n;return r.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=window.RocketChatDesktop)&&n.hasOutlookCredentials){e.next=3;break}throw new c;case 3:return e.t1=Boolean,e.next=6,r.awrap(null==n?void 0:null===(t=n.hasOutlookCredentials)||void 0===t?void 0:t.call(n));case 6:if(e.t2=e.sent,e.t0=(0,e.t1)(e.t2),e.t0){e.next=10;break}e.t0=!1;case 10:return e.abrupt(\"return\",e.t0);case 11:case\"end\":return e.stop()}},null,null,null,Promise)},{onError:function(t){console.error(t)}});return{authEnabled:!!t.data,isError:t.isError,error:t.error}},f=function(){var t=i();return u({mutationFn:function(){return r.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.awrap(t.invalidateQueries([\"outlook\",\"auth\"]));case 2:case\"end\":return n.stop()}},null,null,null,Promise)}})},k=function(){var t=s().t,n=o(),e=f();return u({mutationFn:function(){var t;return r.async(function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=(t=window.RocketChatDesktop)&&t.clearOutlookCredentials){n.next=3;break}throw new c;case 3:return n.next=5,r.awrap(t.clearOutlookCredentials());case 5:return n.abrupt(\"return\",e.mutateAsync());case 6:case\"end\":return n.stop()}},null,null,null,Promise)},onSuccess:function(){n({type:\"success\",message:t(\"Outlook_authentication_disabled\")})}})}}","map":"{\"version\":3,\"sources\":[\"client/views/outlookCalendar/hooks/useOutlookAuthentication.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { NotOnDesktopError } from '../lib/NotOnDesktopError';\\n\\nexport const useOutlookAuthentication = () => {\\n\\tconst {\\n\\t\\tdata: authEnabled,\\n\\t\\tisError,\\n\\t\\terror,\\n\\t} = useQuery(\\n\\t\\t['outlook', 'auth'],\\n\\t\\tasync () => {\\n\\t\\t\\tconst desktopApp = window.RocketChatDesktop;\\n\\t\\t\\tif (!desktopApp?.hasOutlookCredentials) {\\n\\t\\t\\t\\tthrow new NotOnDesktopError();\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn Boolean(await desktopApp?.hasOutlookCredentials?.()) || false;\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\tonError: (error) => {\\n\\t\\t\\t\\tconsole.error(error);\\n\\t\\t\\t},\\n\\t\\t},\\n\\t);\\n\\n\\treturn { authEnabled: Boolean(authEnabled), isError, error };\\n};\\n\\nexport const useOutlookAuthenticationMutation = () => {\\n\\tconst queryClient = useQueryClient();\\n\\treturn useMutation({\\n\\t\\tmutationFn: async () => {\\n\\t\\t\\tawait queryClient.invalidateQueries(['outlook', 'auth']);\\n\\t\\t},\\n\\t});\\n};\\n\\nexport const useOutlookAuthenticationMutationLogout = () => {\\n\\tconst { t } = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst mutation = useOutlookAuthenticationMutation();\\n\\treturn useMutation({\\n\\t\\tmutationFn: async () => {\\n\\t\\t\\tconst desktopApp = window.RocketChatDesktop;\\n\\t\\t\\tif (!desktopApp?.clearOutlookCredentials) {\\n\\t\\t\\t\\tthrow new NotOnDesktopError();\\n\\t\\t\\t}\\n\\n\\t\\t\\tawait desktopApp.clearOutlookCredentials();\\n\\n\\t\\t\\treturn mutation.mutateAsync();\\n\\t\\t},\\n\\t\\tonSuccess: () => {\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Outlook_authentication_disabled') });\\n\\t\\t},\\n\\t});\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"export\",\"useOutlookAuthentication\",\"useOutlookAuthenticationMutation\",\"useOutlookAuthenticationMutationLogout\",\"useToastMessageDispatch\",\"useMutation\",\"useQuery\",\"useQueryClient\",\"useTranslation\",\"NotOnDesktopError\",\"_useQuery\",\"_desktopApp$hasOutloo\",\"desktopApp\",\"async\",\"_context\",\"prev\",\"next\",\"window\",\"RocketChatDesktop\",\"hasOutlookCredentials\",\"t1\",\"Boolean\",\"awrap\",\"call\",\"t2\",\"sent\",\"t0\",\"abrupt\",\"stop\",\"Promise\",\"onError\",\"error\",\"console\",\"authEnabled\",\"data\",\"isError\",\"queryClient\",\"mutationFn\",\"_context2\",\"invalidateQueries\",\"t\",\"_useTranslation\",\"dispatchToastMessage\",\"mutation\",\"_context3\",\"clearOutlookCredentials\",\"mutateAsync\",\"onSuccess\",\"type\",\"message\"],\"mappings\":\"uBAASA,EAAAC,IAAyB,CAAA,6BAAM,CAA0BC,QAAC,SAAAC,CAAA,EAAAC,EAAAD,CAAA,CAAA,EAAA,GAAnEH,EAAOK,MAAE,CAAA,CAAAC,yBAA+B,WAAA,OAAAA,CAA2B,EAAAC,iCAAA,WAAA,OAAAA,CAAA,EAAAC,uCAAA,WAAA,OAAAA,CAAA,CAAA,GAAAR,EAAAC,IAAA,CAAA,2BAAA,CAAAQ,wBAAA,SAAAN,CAAA,EAAAM,EAAAN,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,wBAAA,CAAAS,YAAA,SAAAP,CAAA,EAAAO,EAAAP,CAAA,EAAAQ,SAAA,SAAAR,CAAA,EAAAQ,EAAAR,CAAA,EAAAS,eAAA,SAAAT,CAAA,EAAAS,EAAAT,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,gBAAA,CAAAY,eAAA,SAAAV,CAAA,EAAAU,EAAAV,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,2BAAA,CAAAa,kBAAA,SAAAX,CAAA,EAAAW,EAAAX,CAAA,CAAA,EAAA,GAM5D,IANPC,EAAmEK,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAMtDR,EAA2B,WACvC,IAAAS,EAIIJ,EACH,CAAC,UAAW,OAAO,CACnB,eAAAK,EAAAC,EAAA,OAAAb,EAAAc,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAC4C,GACtCJ,MADCA,CAAAA,EAAaK,OAAOC,iBAAiB,AAAjBA,GACrBN,EAAYO,qBAAqB,CAAA,CAAAL,EAAAE,IAAA,CAAA,EAAA,KAAA,CAAA,MAC/B,IAAIP,CAAmB,MAAA,EAGhB,OAHgBK,EAAAM,EAAA,CAGvBC,QAAOP,EAAAE,IAAA,CAAA,EAAAjB,EAAAuB,KAAA,CAAOV,MAAAA,EAAU,KAAA,EAAA,AAAuB,OAAvBD,CAAAA,EAAVC,EAAYO,qBAAqB,AAArBA,GAAqBR,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAjCA,EAAAY,IAAA,CAAAX,GAAqC,MAAA,EAAA,GAAAE,EAAAU,EAAA,CAAAV,EAAAW,IAAA,CAAAX,EAAAY,EAAA,CAAA,CAAA,EAAAZ,EAAAM,EAAA,AAAAA,EAAAN,EAAAU,EAAA,EAAAV,EAAAY,EAAA,CAAA,CAAAZ,EAAAE,IAAA,CAAA,GAAA,KAAA,CAAAF,EAAAY,EAAA,CAAK,CAAA,CAAK,MAAA,GAAA,OAAAZ,EAAAa,MAAA,CAAA,SAAAb,EAAAY,EAAA,CAAA,MAAA,GAAA,IAAA,MAAA,OAAAZ,EAAAc,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EAErE,CACCC,QAAS,SAACC,CAAK,EACdC,QAAQD,KAAK,CAACA,EACf,IAIF,MAAO,CAAEE,YAAaZ,CAAAA,CApBJX,EAAjBwB,IAAI,CAoBuCC,QAnBpCzB,EAAPyB,OAAO,CAmB6CJ,MAlB/CrB,EAALqB,KAAK,AAkBoD,CAC3D,EAEa7B,EAAmC,WAC/C,IAAMkC,EAAc7B,IACpB,OAAOF,EAAY,CAClBgC,WAAY,WAAA,OAAAtC,EAAAc,KAAA,CAAA,SAAAyB,CAAA,EAAA,OAAA,OAAAA,EAAAvB,IAAA,CAAAuB,EAAAtB,IAAA,EAAA,KAAA,EAAA,OAAAsB,EAAAtB,IAAA,CAAA,EAAAjB,EAAAuB,KAAA,CACLc,EAAYG,iBAAiB,CAAC,CAAC,UAAW,OAAO,EAAC,MAAA,EAAA,IAAA,MAAA,OAAAD,EAAAV,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,GAG3D,EAEa1B,EAAyC,WACrD,IAAQqC,EAACC,AAAKjC,IAANgC,CAAC,CACHE,EAAuBtC,IACvBuC,EAAWzC,IACjB,OAAOG,EAAY,CAClBgC,WAAY,WAAA,IAAAzB,EAAA,OAAAb,EAAAc,KAAA,CAAA,SAAA+B,CAAA,EAAA,OAAA,OAAAA,EAAA7B,IAAA,CAAA6B,EAAA5B,IAAA,EAAA,KAAA,EACgC,GACtCJ,MADCA,CAAAA,EAAaK,OAAOC,iBAAiB,AAAjBA,GACrBN,EAAYiC,uBAAuB,CAAA,CAAAD,EAAA5B,IAAA,CAAA,EAAA,KAAA,CAAA,MACjC,IAAIP,CAAmB,MAAA,EAAA,OAAAmC,EAAA5B,IAAA,CAAA,EAAAjB,EAAAuB,KAAA,CAGxBV,EAAWiC,uBAAuB,GAAE,MAAA,EAAA,OAAAD,EAAAjB,MAAA,CAAA,SAEnCgB,EAASG,WAAW,GAAE,MAAA,EAAA,IAAA,MAAA,OAAAF,EAAAhB,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EAE9BkB,UAAW,WACVL,EAAqB,CAAEM,KAAM,UAAWC,QAAST,EAAE,kCAAkC,EACtF,GAEF\"}"}