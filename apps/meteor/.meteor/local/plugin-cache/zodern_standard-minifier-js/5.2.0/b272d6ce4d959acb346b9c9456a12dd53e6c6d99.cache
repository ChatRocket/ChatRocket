{"code":"function module(e,s,t){let a,i,r,d,n,l;t.link(\"meteor/meteor\",{Meteor(e){a=e}},0),t.link(\"../../app/models/client\",{ChatMessage(e){i=e},ChatSubscription(e){r=e}},1),t.link(\"../../app/settings/client\",{settings(e){d=e}},2),t.link(\"../../app/utils/lib/i18n\",{t(e){n=e}},3),t.link(\"../lib/toast\",{dispatchToastMessage(e){l=e}},4),a.methods({starMessage(e){let s=a.userId();return s&&r.findOne({rid:e.rid})&&i.findOneByRoomIdAndMessageId(e.rid,e._id)&&d.get(\"Message_AllowStarring\")?(e.starred?(i.update({_id:e._id},{$addToSet:{starred:{_id:s}}}),l({type:\"success\",message:n(\"Message_has_been_starred\")})):(i.update({_id:e._id},{$pull:{starred:{_id:s}}}),l({type:\"success\",message:n(\"Message_has_been_unstarred\")})),!0):(l({type:\"error\",message:n(\"error-starring-message\")}),!1)}})}","map":"{\"version\":3,\"sources\":[\"client/methods/starMessage.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { ServerMethods } from '@rocket.chat/ddp-client';\\nimport { Meteor } from 'meteor/meteor';\\n\\nimport { ChatMessage, ChatSubscription } from '../../app/models/client';\\nimport { settings } from '../../app/settings/client';\\nimport { t } from '../../app/utils/lib/i18n';\\nimport { dispatchToastMessage } from '../lib/toast';\\n\\nMeteor.methods<ServerMethods>({\\n\\tstarMessage(message) {\\n\\t\\tconst uid = Meteor.userId();\\n\\n\\t\\tif (!uid) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('error-starring-message') });\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\n\\t\\tif (!ChatSubscription.findOne({ rid: message.rid })) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('error-starring-message') });\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\n\\t\\tif (!ChatMessage.findOneByRoomIdAndMessageId(message.rid, message._id)) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('error-starring-message') });\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\n\\t\\tif (!settings.get('Message_AllowStarring')) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('error-starring-message') });\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\n\\t\\tif (message.starred) {\\n\\t\\t\\tChatMessage.update(\\n\\t\\t\\t\\t{ _id: message._id },\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t$addToSet: {\\n\\t\\t\\t\\t\\t\\tstarred: { _id: uid },\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t},\\n\\t\\t\\t);\\n\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Message_has_been_starred') });\\n\\n\\t\\t\\treturn true;\\n\\t\\t}\\n\\n\\t\\tChatMessage.update(\\n\\t\\t\\t{ _id: message._id },\\n\\t\\t\\t{\\n\\t\\t\\t\\t$pull: {\\n\\t\\t\\t\\t\\tstarred: { _id: uid },\\n\\t\\t\\t\\t},\\n\\t\\t\\t},\\n\\t\\t);\\n\\n\\t\\tdispatchToastMessage({ type: 'success', message: t('Message_has_been_unstarred') });\\n\\t\\treturn true;\\n\\t},\\n});\\n\",null],\"names\":[\"Meteor\",\"ChatMessage\",\"ChatSubscription\",\"settings\",\"t\",\"dispatchToastMessage\",\"module\",\"link\",\"v\",\"methods\",\"starMessage\",\"message\",\"uid\",\"userId\",\"findOne\",\"rid\",\"findOneByRoomIdAndMessageId\",\"_id\",\"get\",\"starred\",\"update\",\"$addToSet\",\"type\",\"$pull\"],\"mappings\":\"2BACAA,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAP,OAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,0BAAA,CAAAN,YAAAO,CAAA,EAAAP,EAAAO,CAAA,EAAAN,iBAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,4BAAA,CAAAJ,SAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,2BAAA,CAAAH,EAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,eAAA,CAAAF,qBAAAG,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,GAOvCR,EAAOS,OAAO,CAAgB,CAC7BC,YAAYC,CAAO,EAClB,IAAMC,EAAMZ,EAAOa,MAAM,UAEzB,AAAKD,GAKAV,EAAiBY,OAAO,CAAC,CAAEC,IAAKJ,EAAQI,GAAAA,AAAG,IAK3Cd,EAAYe,2BAA2B,CAACL,EAAQI,GAAG,CAAEJ,EAAQM,GAAG,GAKhEd,EAASe,GAAG,CAAC,0BAKdP,EAAQQ,OAAO,EAClBlB,EAAYmB,MAAM,CACjB,CAAEH,IAAKN,EAAQM,GAAAA,AAAG,EAClB,CACCI,UAAW,CACVF,QAAS,CAAEF,IAAKL,CAAG,KAKtBP,EAAqB,CAAEiB,KAAM,UAAWX,QAASP,EAAE,2BAA2B,KAK/EH,EAAYmB,MAAM,CACjB,CAAEH,IAAKN,EAAQM,GAAAA,AAAG,EAClB,CACCM,MAAO,CACNJ,QAAS,CAAEF,IAAKL,CAAG,KAKtBP,EAAqB,CAAEiB,KAAM,UAAWX,QAASP,EAAE,6BAA6B,IACzE,CAAA,IA5CNC,EAAqB,CAAEiB,KAAM,QAASX,QAASP,EAAE,yBAAyB,GACnE,CAAA,EA4CT\"}"}