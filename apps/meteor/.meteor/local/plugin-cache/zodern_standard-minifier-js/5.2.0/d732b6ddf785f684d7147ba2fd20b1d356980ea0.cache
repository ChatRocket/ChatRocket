{"code":"function module(e,t,n){n.link(\"@babel/runtime/regenerator\",{default:function(e){r=e}},0),n.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(e){o=e}},1),n.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){a=e}},2),n.export({useCannedResponseList:function(){return f}}),n.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(e){i=e}},0),n.link(\"react\",{useCallback:function(e){u=e},useEffect:function(e){s=e},useState:function(e){c=e}},1),n.link(\"../../hooks/lists/useScrollableRecordList\",{useScrollableRecordList:function(e){l=e}},2),n.link(\"../../hooks/useComponentDidUpdate\",{useComponentDidUpdate:function(e){d=e}},3),n.link(\"../../lib/lists/CannedResponseList\",{CannedResponseList:function(e){p=e}},4);var r,o,a,i,u,s,c,l,d,p,f=function(e){var t=c(function(){return new p(e)}),n=a(t,2),f=n[0],m=n[1],b=u(function(){return m(new p(e))},[e]);d(function(){e&&b()},[e,b]),s(function(){f.options!==e&&f.updateFilters(e)},[f,e]);var k=i(\"GET\",\"/v1/canned-responses\"),y=i(\"GET\",\"/v1/livechat/department\"),C=u(function(t,n){var a,i,u,s;return r.async(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,r.awrap(k(o(o(o(o({},e.filter&&{text:e.filter}),e.type&&[\"global\",\"user\"].find(function(t){return t===e.type})&&{scope:e.type}),e.type&&![\"global\",\"user\",\"all\"].find(function(t){return t===e.type})&&{scope:\"department\",departmentId:e.type}),{},{offset:t,count:n+t})));case 2:return i=(a=c.sent).cannedResponses,u=a.total,c.next=7,r.awrap(y({text:\"\"}));case 7:return s=c.sent.departments,c.abrupt(\"return\",{items:i.map(function(e){return e.departmentId&&s.forEach(function(t){e.departmentId===t._id&&(e.departmentName=t.name)}),e._updatedAt=new Date(e._updatedAt),e._createdAt=new Date(e._createdAt),e}),itemCount:u});case 10:case\"end\":return c.stop()}},null,null,null,Promise)},[k,y,e.filter,e.type]),h=l(f,C);return{reload:b,cannedList:f,loadMoreItems:h.loadMoreItems,initialItemCount:h.initialItemCount}}}","map":"{\"version\":3,\"sources\":[\"client/omnichannel/hooks/useCannedResponseList.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useCallback, useEffect, useState } from 'react';\\n\\nimport { useScrollableRecordList } from '../../hooks/lists/useScrollableRecordList';\\nimport { useComponentDidUpdate } from '../../hooks/useComponentDidUpdate';\\nimport { CannedResponseList } from '../../lib/lists/CannedResponseList';\\n\\nexport const useCannedResponseList = (\\n\\toptions: any,\\n): {\\n\\treload: () => void;\\n\\tcannedList: CannedResponseList;\\n\\tinitialItemCount: number;\\n\\tloadMoreItems: (start: number, end: number) => void;\\n} => {\\n\\tconst [cannedList, setCannedList] = useState(() => new CannedResponseList(options));\\n\\tconst reload = useCallback(() => setCannedList(new CannedResponseList(options)), [options]);\\n\\n\\tuseComponentDidUpdate(() => {\\n\\t\\toptions && reload();\\n\\t}, [options, reload]);\\n\\n\\tuseEffect(() => {\\n\\t\\tif (cannedList.options !== options) {\\n\\t\\t\\tcannedList.updateFilters(options);\\n\\t\\t}\\n\\t}, [cannedList, options]);\\n\\n\\tconst getCannedResponses = useEndpoint('GET', '/v1/canned-responses');\\n\\tconst getDepartments = useEndpoint('GET', '/v1/livechat/department');\\n\\n\\tconst fetchData = useCallback(\\n\\t\\tasync (start, end) => {\\n\\t\\t\\tconst { cannedResponses, total } = await getCannedResponses({\\n\\t\\t\\t\\t...(options.filter && { text: options.filter }),\\n\\t\\t\\t\\t...(options.type && ['global', 'user'].find((option) => option === options.type) && { scope: options.type }),\\n\\t\\t\\t\\t...(options.type &&\\n\\t\\t\\t\\t\\t!['global', 'user', 'all'].find((option) => option === options.type) && {\\n\\t\\t\\t\\t\\t\\tscope: 'department',\\n\\t\\t\\t\\t\\t\\tdepartmentId: options.type,\\n\\t\\t\\t\\t\\t}),\\n\\t\\t\\t\\toffset: start,\\n\\t\\t\\t\\tcount: end + start,\\n\\t\\t\\t});\\n\\n\\t\\t\\tconst { departments } = await getDepartments({ text: '' });\\n\\n\\t\\t\\treturn {\\n\\t\\t\\t\\titems: cannedResponses.map((cannedResponse: any) => {\\n\\t\\t\\t\\t\\tif (cannedResponse.departmentId) {\\n\\t\\t\\t\\t\\t\\tdepartments.forEach((department: any) => {\\n\\t\\t\\t\\t\\t\\t\\tif (cannedResponse.departmentId === department._id) {\\n\\t\\t\\t\\t\\t\\t\\t\\tcannedResponse.departmentName = department.name;\\n\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tcannedResponse._updatedAt = new Date(cannedResponse._updatedAt);\\n\\t\\t\\t\\t\\tcannedResponse._createdAt = new Date(cannedResponse._createdAt);\\n\\t\\t\\t\\t\\treturn cannedResponse;\\n\\t\\t\\t\\t}),\\n\\t\\t\\t\\titemCount: total,\\n\\t\\t\\t};\\n\\t\\t},\\n\\t\\t[getCannedResponses, getDepartments, options.filter, options.type],\\n\\t);\\n\\n\\tconst { loadMoreItems, initialItemCount } = useScrollableRecordList(cannedList, fetchData);\\n\\n\\treturn {\\n\\t\\treload,\\n\\t\\tcannedList,\\n\\t\\tloadMoreItems,\\n\\t\\tinitialItemCount,\\n\\t};\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"_objectSpread\",\"_slicedToArray\",\"export\",\"useCannedResponseList\",\"useEndpoint\",\"useCallback\",\"useEffect\",\"useState\",\"useScrollableRecordList\",\"useComponentDidUpdate\",\"CannedResponseList\",\"options\",\"_useState\",\"_useState2\",\"cannedList\",\"setCannedList\",\"reload\",\"updateFilters\",\"getCannedResponses\",\"getDepartments\",\"fetchData\",\"start\",\"end\",\"_await$getCannedRespo\",\"cannedResponses\",\"total\",\"departments\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"filter\",\"text\",\"type\",\"find\",\"option\",\"scope\",\"departmentId\",\"offset\",\"count\",\"sent\",\"_await$getDepartments\",\"abrupt\",\"items\",\"map\",\"cannedResponse\",\"forEach\",\"department\",\"_id\",\"departmentName\",\"name\",\"_updatedAt\",\"Date\",\"_createdAt\",\"itemCount\",\"stop\",\"Promise\",\"_useScrollableRecordL\",\"loadMoreItems\",\"initialItemCount\"],\"mappings\":\"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\"}"}