{"code":"function module(e,n,t){t.link(\"@babel/runtime/regenerator\",{default:function(e){o=e}},0),t.export({useRoomLeave:function(){return p}}),t.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback:function(e){i=e}},0),t.link(\"@rocket.chat/ui-contexts\",{useRouter:function(e){a=e},useSetModal:function(e){c=e},useToastMessageDispatch:function(e){r=e},useMethod:function(e){u=e},useTranslation:function(e){l=e},usePermission:function(e){s=e}},1),t.link(\"react\",{default:function(e){f=e}},2),t.link(\"../../../../../../../app/ui-utils/client\",{LegacyRoomManager:function(e){m=e}},3),t.link(\"../../../../../../../definition/IRoomTypeConfig\",{UiTextContext:function(e){d=e}},4),t.link(\"../../../../../../components/WarningModal\",{default:function(e){v=e}},5),t.link(\"../../../../../../lib/rooms/roomCoordinator\",{roomCoordinator:function(e){k=e}},6);var o,i,a,c,r,u,l,s,f,m,d,v,k,p=function(e){var n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],t=l(),p=c(),g=r(),x=u(\"leaveRoom\"),h=a(),R=s(\"c\"===e.t?\"leave-c\":\"leave-p\")&&!1!==e.cl&&n,T=i(function(){var n=k.getRoomDirectives(e.t).getUiText(d.LEAVE_WARNING);p(f.createElement(v,{text:t(n,e.fname||e.name),confirmText:t(\"Leave_room\"),close:function(){return p(null)},cancelText:t(\"Cancel\"),confirm:function(){return o.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,o.awrap(x(e._id));case 3:h.navigate(\"/home\"),m.close(e._id),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),g({type:\"error\",message:n.t0});case 10:p(null);case 11:case\"end\":return n.stop()}},null,null,[[0,7]],Promise)}}))});return R?T:null}}","map":"{\"version\":3,\"sources\":[\"client/views/room/contextualBar/Info/hooks/actions/useRoomLeave.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom } from '@rocket.chat/core-typings';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\\nimport { useRouter, useSetModal, useToastMessageDispatch, useMethod, useTranslation, usePermission } from '@rocket.chat/ui-contexts';\\nimport React from 'react';\\n\\nimport { LegacyRoomManager } from '../../../../../../../app/ui-utils/client';\\nimport { UiTextContext } from '../../../../../../../definition/IRoomTypeConfig';\\nimport WarningModal from '../../../../../../components/WarningModal';\\nimport { roomCoordinator } from '../../../../../../lib/rooms/roomCoordinator';\\n\\n// TODO implement joined\\nexport const useRoomLeave = (room: IRoom, joined = true) => {\\n\\tconst t = useTranslation();\\n\\tconst setModal = useSetModal();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst leaveRoom = useMethod('leaveRoom');\\n\\tconst router = useRouter();\\n\\n\\tconst canLeave = usePermission(room.t === 'c' ? 'leave-c' : 'leave-p') && room.cl !== false && joined;\\n\\n\\tconst handleLeave = useMutableCallback(() => {\\n\\t\\tconst leaveAction = async () => {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tawait leaveRoom(room._id);\\n\\t\\t\\t\\trouter.navigate('/home');\\n\\t\\t\\t\\tLegacyRoomManager.close(room._id);\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t}\\n\\t\\t\\tsetModal(null);\\n\\t\\t};\\n\\n\\t\\tconst warnText = roomCoordinator.getRoomDirectives(room.t).getUiText(UiTextContext.LEAVE_WARNING);\\n\\n\\t\\tsetModal(\\n\\t\\t\\t<WarningModal\\n\\t\\t\\t\\ttext={t(warnText as TranslationKey, room.fname || room.name)}\\n\\t\\t\\t\\tconfirmText={t('Leave_room')}\\n\\t\\t\\t\\tclose={() => setModal(null)}\\n\\t\\t\\t\\tcancelText={t('Cancel')}\\n\\t\\t\\t\\tconfirm={leaveAction}\\n\\t\\t\\t/>,\\n\\t\\t);\\n\\t});\\n\\n\\treturn canLeave ? handleLeave : null;\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"export\",\"useRoomLeave\",\"useMutableCallback\",\"useRouter\",\"useSetModal\",\"useToastMessageDispatch\",\"useMethod\",\"useTranslation\",\"usePermission\",\"React\",\"LegacyRoomManager\",\"UiTextContext\",\"WarningModal\",\"roomCoordinator\",\"room\",\"joined\",\"arguments\",\"length\",\"undefined\",\"t\",\"setModal\",\"dispatchToastMessage\",\"leaveRoom\",\"router\",\"canLeave\",\"cl\",\"handleLeave\",\"warnText\",\"getRoomDirectives\",\"getUiText\",\"LEAVE_WARNING\",\"createElement\",\"text\",\"fname\",\"name\",\"confirmText\",\"close\",\"cancelText\",\"confirm\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"_id\",\"navigate\",\"t0\",\"type\",\"message\",\"stop\",\"Promise\"],\"mappings\":\"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\"}"}