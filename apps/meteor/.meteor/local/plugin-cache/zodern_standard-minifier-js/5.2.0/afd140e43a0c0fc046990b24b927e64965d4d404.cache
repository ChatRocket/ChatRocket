{"code":"function module(e,t,i){let s,a,o,n;i.export({requestMessageDeletion:()=>r}),i.link(\"../../../../app/utils/lib/i18n\",{t(e){s=e}},0),i.link(\"../../../components/GenericModal\",{default(e){a=e}},1),i.link(\"../../imperativeModal\",{imperativeModal(e){o=e}},2),i.link(\"../../toast\",{dispatchToastMessage(e){n=e}},3);let r=async(e,t)=>{if(!await e.data.canDeleteMessage(t)){n({type:\"error\",message:s(\"Message_deleting_blocked\")});return}let i=t.drid?await e.data.getDiscussionByID(t.drid):void 0;await new Promise((r,l)=>{let d=async()=>{try{var i,a;if(!await e.data.canDeleteMessage(t)){n({type:\"error\",message:s(\"Message_deleting_blocked\")});return}await e.data.deleteMessage(t),o.close(),(null===(i=e.currentEditing)||void 0===i?void 0:i.mid)===t._id&&e.currentEditing.stop(),null===(a=e.composer)||void 0===a||a.focus(),n({type:\"success\",message:s(\"Your_entry_has_been_deleted\")}),r()}catch(e){n({type:\"error\",message:e}),l(e)}},c=async()=>{var i,s;o.close(),(null===(i=e.currentEditing)||void 0===i?void 0:i.mid)===t._id&&e.currentEditing.stop(),null===(s=e.composer)||void 0===s||s.focus(),r()};o.open({component:a,props:{title:s(\"Are_you_sure\"),children:i?s(\"The_message_is_a_discussion_you_will_not_be_able_to_recover\"):s(\"You_will_not_be_able_to_recover\"),variant:\"danger\",confirmText:s(\"Yes_delete_it\"),onConfirm:d,onClose:c,onCancel:c}})})}}","map":"{\"version\":3,\"sources\":[\"client/lib/chats/flows/requestMessageDeletion.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IMessage } from '@rocket.chat/core-typings';\\n\\nimport { t } from '../../../../app/utils/lib/i18n';\\nimport GenericModal from '../../../components/GenericModal';\\nimport { imperativeModal } from '../../imperativeModal';\\nimport { dispatchToastMessage } from '../../toast';\\nimport type { ChatAPI } from '../ChatAPI';\\n\\nexport const requestMessageDeletion = async (chat: ChatAPI, message: IMessage): Promise<void> => {\\n\\tif (!(await chat.data.canDeleteMessage(message))) {\\n\\t\\tdispatchToastMessage({ type: 'error', message: t('Message_deleting_blocked') });\\n\\t\\treturn;\\n\\t}\\n\\n\\tconst room = message.drid ? await chat.data.getDiscussionByID(message.drid) : undefined;\\n\\n\\tawait new Promise<void>((resolve, reject) => {\\n\\t\\tconst onConfirm = async (): Promise<void> => {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tif (!(await chat.data.canDeleteMessage(message))) {\\n\\t\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('Message_deleting_blocked') });\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tawait chat.data.deleteMessage(message);\\n\\n\\t\\t\\t\\timperativeModal.close();\\n\\n\\t\\t\\t\\tif (chat.currentEditing?.mid === message._id) {\\n\\t\\t\\t\\t\\tchat.currentEditing.stop();\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tchat.composer?.focus();\\n\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Your_entry_has_been_deleted') });\\n\\t\\t\\t\\tresolve();\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t\\treject(error);\\n\\t\\t\\t}\\n\\t\\t};\\n\\n\\t\\tconst onCloseModal = async (): Promise<void> => {\\n\\t\\t\\timperativeModal.close();\\n\\n\\t\\t\\tif (chat.currentEditing?.mid === message._id) {\\n\\t\\t\\t\\tchat.currentEditing.stop();\\n\\t\\t\\t}\\n\\t\\t\\tchat.composer?.focus();\\n\\n\\t\\t\\tresolve();\\n\\t\\t};\\n\\n\\t\\timperativeModal.open({\\n\\t\\t\\tcomponent: GenericModal,\\n\\t\\t\\tprops: {\\n\\t\\t\\t\\ttitle: t('Are_you_sure'),\\n\\t\\t\\t\\tchildren: room ? t('The_message_is_a_discussion_you_will_not_be_able_to_recover') : t('You_will_not_be_able_to_recover'),\\n\\t\\t\\t\\tvariant: 'danger',\\n\\t\\t\\t\\tconfirmText: t('Yes_delete_it'),\\n\\t\\t\\t\\tonConfirm,\\n\\t\\t\\t\\tonClose: onCloseModal,\\n\\t\\t\\t\\tonCancel: onCloseModal,\\n\\t\\t\\t},\\n\\t\\t});\\n\\t});\\n};\\n\",null],\"names\":[\"t\",\"GenericModal\",\"imperativeModal\",\"dispatchToastMessage\",\"module\",\"export\",\"requestMessageDeletion\",\"link\",\"v\",\"default\",\"chat\",\"message\",\"data\",\"canDeleteMessage\",\"type\",\"room\",\"drid\",\"getDiscussionByID\",\"undefined\",\"Promise\",\"resolve\",\"reject\",\"onConfirm\",\"_chat$currentEditing\",\"_chat$composer\",\"deleteMessage\",\"close\",\"currentEditing\",\"mid\",\"_id\",\"stop\",\"composer\",\"focus\",\"error\",\"onCloseModal\",\"_chat$currentEditing2\",\"_chat$composer2\",\"open\",\"component\",\"props\",\"title\",\"children\",\"variant\",\"confirmText\",\"onClose\",\"onCancel\"],\"mappings\":\"2BAEmDA,EAAAC,EAAAC,EAAAC,EAAnDC,EAAOC,MAAK,CAAA,CAAAC,uBAAMA,IAAAA,CAAiC,GAAAF,EAAAG,IAAA,CAAA,iCAAA,CAAAP,EAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,mCAAA,CAAAE,QAAAD,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,wBAAA,CAAAL,gBAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,cAAA,CAAAJ,qBAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAM5C,IAAMF,EAAyB,MAAOI,EAAeC,KAC3D,GAAI,CAAE,MAAMD,EAAKE,IAAI,CAACC,gBAAgB,CAACF,GAAW,CACjDR,EAAqB,CAAEW,KAAM,QAASH,QAASX,EAAE,2BAA2B,GAC5E,MACD,CAEA,IAAMe,EAAOJ,EAAQK,IAAI,CAAG,MAAMN,EAAKE,IAAI,CAACK,iBAAiB,CAACN,EAAQK,IAAI,EAAIE,KAAAA,CAE9E,OAAM,IAAIC,QAAc,CAACC,EAASC,KACjC,IAAMC,EAAY,UACjB,GAAI,CAAA,IAAAC,EAAAC,EACH,GAAI,CAAE,MAAMd,EAAKE,IAAI,CAACC,gBAAgB,CAACF,GAAW,CACjDR,EAAqB,CAAEW,KAAM,QAASH,QAASX,EAAE,2BAA2B,GAC5E,MACD,CACA,MAAMU,EAAKE,IAAI,CAACa,aAAa,CAACd,GAE9BT,EAAgBwB,KAAK,GAEjB,CAAA,AAAmB,OAAnBH,CAAAA,EAAAb,EAAKiB,cAAc,AAAdA,GAAcJ,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAnBA,EAAqBK,GAAG,AAAHA,IAAQjB,EAAQkB,GAAG,EAC3CnB,EAAKiB,cAAc,CAACG,IAAI,GAEzB,AAAa,OAAbN,CAAAA,EAAAd,EAAKqB,QAAQ,AAARA,GAAQP,AAAA,KAAA,IAAAA,GAAbA,EAAeQ,KAAK,GAEpB7B,EAAqB,CAAEW,KAAM,UAAWH,QAASX,EAAE,8BAA8B,GACjFoB,GACD,CAAE,MAAOa,EAAO,CACf9B,EAAqB,CAAEW,KAAM,QAASH,QAASsB,CAAK,GACpDZ,EAAOY,EACR,CACD,EAEMC,EAAe,UAA0B,IAAAC,EAAAC,EAC9ClC,EAAgBwB,KAAK,GAEjB,CAAA,AAAmB,OAAnBS,CAAAA,EAAAzB,EAAKiB,cAAc,AAAdA,GAAcQ,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAnBA,EAAqBP,GAAG,AAAHA,IAAQjB,EAAQkB,GAAG,EAC3CnB,EAAKiB,cAAc,CAACG,IAAI,GAEzB,AAAa,OAAbM,CAAAA,EAAA1B,EAAKqB,QAAQ,AAARA,GAAQK,AAAA,KAAA,IAAAA,GAAbA,EAAeJ,KAAK,GAEpBZ,GACD,EAEAlB,EAAgBmC,IAAI,CAAC,CACpBC,UAAWrC,EACXsC,MAAO,CACNC,MAAOxC,EAAE,gBACTyC,SAAU1B,EAAOf,EAAE,+DAAiEA,EAAE,mCACtF0C,QAAS,SACTC,YAAa3C,EAAE,iBACfsB,UAAAA,EACAsB,QAASV,EACTW,SAAUX,IAGb,EACD\"}"}