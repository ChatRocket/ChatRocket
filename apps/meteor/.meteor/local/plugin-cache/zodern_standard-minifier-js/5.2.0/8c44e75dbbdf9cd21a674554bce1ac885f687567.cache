{"code":"function module(e,n,t){var r,i,a,l,o,u,c,s,d,f,m,v,E,k,S,x,p,g,y,C,F,M,_;t.link(\"@babel/runtime/regenerator\",{default:function(e){r=e}},0),t.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){i=e}},1),t.link(\"@rocket.chat/fuselage\",{Divider:function(e){a=e},Modal:function(e){l=e},ButtonGroup:function(e){o=e},Button:function(e){u=e},Field:function(e){c=e},TextInput:function(e){s=e},FieldLabel:function(e){d=e},FieldRow:function(e){f=e},FieldError:function(e){m=e},FieldHint:function(e){v=e}},0),t.link(\"@rocket.chat/ui-contexts\",{useSetModal:function(e){E=e},useTranslation:function(e){k=e},useEndpoint:function(e){S=e},useToastMessageDispatch:function(e){x=e}},1),t.link(\"@tanstack/react-query\",{useMutation:function(e){p=e},useQueryClient:function(e){g=e}},2),t.link(\"react\",{default:function(e){y=e},useState:function(e){C=e}},3),t.link(\"./MatrixFederationRemoveServerList\",{default:function(e){F=e}},4),t.link(\"./MatrixFederationSearch\",{default:function(e){M=e}},5),t.link(\"./useMatrixServerList\",{useMatrixServerList:function(e){_=e}},6),t.exportDefault(function(e){var n=e.onClickClose,t=k(),h=S(\"POST\",\"/v1/federation/addServerByUser\"),b=C(\"\"),T=i(b,2),L=T[0],B=T[1],w=C(),D=i(w,2),H=D[0],U=D[1],A=E(),P=g(),Q=x(),R=p([\"v1/federation/addServerByUser\",L],function(){return h({serverName:L})},{onSuccess:function(){return r.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.awrap(P.invalidateQueries([\"federation/listServersByUsers\"]));case 2:A(y.createElement(M,{defaultSelectedServer:L,onClose:n,key:L}));case 3:case\"end\":return e.stop()}},null,null,null,Promise)},onError:function(e){var n=e?\"invalid-server-name\"===e.error?\"Server_doesnt_exist\":\"invalid-server-name\"===e.error?\"Server_already_added\":void 0:void 0;if(!n){Q({type:\"error\",message:e});return}U(n)}}),q=R.mutate,G=R.isLoading,I=R.isError,N=_(),O=N.data,j=N.isLoading;return y.createElement(l,{maxHeight:\"x600\"},y.createElement(l.Header,null,y.createElement(l.Title,null,t(\"Manage_servers\")),y.createElement(l.Close,{onClick:n})),y.createElement(l.Content,null,y.createElement(c,null,y.createElement(d,null,t(\"Server_name\")),y.createElement(f,null,y.createElement(s,{disabled:G,value:L,onChange:function(e){B(e.currentTarget.value),H&&U(void 0)},mie:4}),y.createElement(u,{onClick:function(){return q()},primary:!0,loading:G},t(\"Add\"))),I&&H&&y.createElement(m,null,t(H)),y.createElement(v,null,t(\"Federation_Example_matrix_server\"))),y.createElement(a,{mb:16}),!j&&(null==O?void 0:O.servers)&&y.createElement(F,{servers:O.servers})),y.createElement(l.Footer,null,y.createElement(o,null,y.createElement(u,{onClick:n},t(\"Cancel\")))))})}","map":"{\"version\":3,\"sources\":[\"client/sidebarv2/header/MatrixFederationSearch/MatrixFederationManageServerModal.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Divider, Modal, ButtonGroup, Button, Field, TextInput, FieldLabel, FieldRow, FieldError, FieldHint } from '@rocket.chat/fuselage';\\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\\nimport { useSetModal, useTranslation, useEndpoint, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\\nimport type { FormEvent } from 'react';\\nimport React, { useState } from 'react';\\n\\nimport MatrixFederationRemoveServerList from './MatrixFederationRemoveServerList';\\nimport MatrixFederationSearch from './MatrixFederationSearch';\\nimport { useMatrixServerList } from './useMatrixServerList';\\n\\ntype MatrixFederationAddServerModalProps = {\\n\\tonClickClose: () => void;\\n};\\n\\nconst getErrorKey = (error: any): TranslationKey | undefined => {\\n\\tif (!error) {\\n\\t\\treturn;\\n\\t}\\n\\tif (error.error === 'invalid-server-name') {\\n\\t\\treturn 'Server_doesnt_exist';\\n\\t}\\n\\tif (error.error === 'invalid-server-name') {\\n\\t\\treturn 'Server_already_added';\\n\\t}\\n};\\n\\nconst MatrixFederationAddServerModal = ({ onClickClose }: MatrixFederationAddServerModalProps) => {\\n\\tconst t = useTranslation();\\n\\tconst addMatrixServer = useEndpoint('POST', '/v1/federation/addServerByUser');\\n\\tconst [serverName, setServerName] = useState('');\\n\\tconst [errorKey, setErrorKey] = useState<TranslationKey | undefined>();\\n\\tconst setModal = useSetModal();\\n\\tconst queryClient = useQueryClient();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst {\\n\\t\\tmutate: addServer,\\n\\t\\tisLoading,\\n\\t\\tisError,\\n\\t} = useMutation(['v1/federation/addServerByUser', serverName], () => addMatrixServer({ serverName }), {\\n\\t\\tonSuccess: async () => {\\n\\t\\t\\tawait queryClient.invalidateQueries(['federation/listServersByUsers']);\\n\\t\\t\\tsetModal(<MatrixFederationSearch defaultSelectedServer={serverName} onClose={onClickClose} key={serverName} />);\\n\\t\\t},\\n\\t\\tonError: (error) => {\\n\\t\\t\\tconst errorKey = getErrorKey(error);\\n\\t\\t\\tif (!errorKey) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t\\tsetErrorKey(errorKey);\\n\\t\\t},\\n\\t});\\n\\n\\tconst { data, isLoading: isLoadingServerList } = useMatrixServerList();\\n\\n\\treturn (\\n\\t\\t<Modal maxHeight='x600'>\\n\\t\\t\\t<Modal.Header>\\n\\t\\t\\t\\t<Modal.Title>{t('Manage_servers')}</Modal.Title>\\n\\t\\t\\t\\t<Modal.Close onClick={onClickClose} />\\n\\t\\t\\t</Modal.Header>\\n\\t\\t\\t<Modal.Content>\\n\\t\\t\\t\\t<Field>\\n\\t\\t\\t\\t\\t<FieldLabel>{t('Server_name')}</FieldLabel>\\n\\t\\t\\t\\t\\t<FieldRow>\\n\\t\\t\\t\\t\\t\\t<TextInput\\n\\t\\t\\t\\t\\t\\t\\tdisabled={isLoading}\\n\\t\\t\\t\\t\\t\\t\\tvalue={serverName}\\n\\t\\t\\t\\t\\t\\t\\tonChange={(e: FormEvent<HTMLInputElement>) => {\\n\\t\\t\\t\\t\\t\\t\\t\\tsetServerName(e.currentTarget.value);\\n\\t\\t\\t\\t\\t\\t\\t\\tif (errorKey) {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tsetErrorKey(undefined);\\n\\t\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t\\t}}\\n\\t\\t\\t\\t\\t\\t\\tmie={4}\\n\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t<Button onClick={() => addServer()} primary loading={isLoading}>\\n\\t\\t\\t\\t\\t\\t\\t{t('Add')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t\\t\\t{isError && errorKey && <FieldError>{t(errorKey)}</FieldError>}\\n\\t\\t\\t\\t\\t<FieldHint>{t('Federation_Example_matrix_server')}</FieldHint>\\n\\t\\t\\t\\t</Field>\\n\\t\\t\\t\\t<Divider mb={16} />\\n\\t\\t\\t\\t{!isLoadingServerList && data?.servers && <MatrixFederationRemoveServerList servers={data.servers} />}\\n\\t\\t\\t</Modal.Content>\\n\\t\\t\\t<Modal.Footer>\\n\\t\\t\\t\\t<ButtonGroup>\\n\\t\\t\\t\\t\\t<Button onClick={onClickClose}>{t('Cancel')}</Button>\\n\\t\\t\\t\\t</ButtonGroup>\\n\\t\\t\\t</Modal.Footer>\\n\\t\\t</Modal>\\n\\t);\\n};\\n\\nexport default MatrixFederationAddServerModal;\\n\",null],\"names\":[\"_regeneratorRuntime\",\"_slicedToArray\",\"Divider\",\"Modal\",\"ButtonGroup\",\"Button\",\"Field\",\"TextInput\",\"FieldLabel\",\"FieldRow\",\"FieldError\",\"FieldHint\",\"useSetModal\",\"useTranslation\",\"useEndpoint\",\"useToastMessageDispatch\",\"useMutation\",\"useQueryClient\",\"React\",\"useState\",\"MatrixFederationRemoveServerList\",\"MatrixFederationSearch\",\"useMatrixServerList\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"onClickClose\",\"t\",\"addMatrixServer\",\"_useState\",\"_useState2\",\"serverName\",\"setServerName\",\"_useState3\",\"_useState4\",\"errorKey\",\"setErrorKey\",\"setModal\",\"queryClient\",\"dispatchToastMessage\",\"_useMutation\",\"onSuccess\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"invalidateQueries\",\"createElement\",\"defaultSelectedServer\",\"onClose\",\"key\",\"stop\",\"Promise\",\"onError\",\"error\",\"type\",\"message\",\"addServer\",\"mutate\",\"isLoading\",\"isError\",\"_useMatrixServerList\",\"data\",\"isLoadingServerList\",\"maxHeight\",\"Header\",\"Title\",\"Close\",\"onClick\",\"Content\",\"disabled\",\"value\",\"onChange\",\"e\",\"currentTarget\",\"undefined\",\"mie\",\"primary\",\"loading\",\"mb\",\"servers\",\"Footer\"],\"mappings\":\"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\"}"}