{"code":"function module(e,n,u){u.export({onToggledFeature:function(){return c}}),u.link(\"@tanstack/react-query\",{QueryObserver:function(e){t=e}},0),u.link(\"./fetchFeatures\",{fetchFeatures:function(e){r=e}},1),u.link(\"./queryClient\",{queryClient:function(e){i=e}},2);var t,r,i,c=function(e,n){var u=n.up,c=n.down,a=new t(i,{queryKey:[\"ee.features\"],queryFn:r,staleTime:1/0}),l=!1;return a.subscribe(function(n){if(n.isSuccess){var t=n.data.includes(e);!l&&t&&(null==u||u(),l=!0),l&&!t&&(null==c||c(),l=!1)}})}}","map":"{\"version\":3,\"sources\":[\"client/lib/onToggledFeature.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { LicenseModule } from '@rocket.chat/core-typings';\\nimport { QueryObserver } from '@tanstack/react-query';\\n\\nimport { fetchFeatures } from './fetchFeatures';\\nimport { queryClient } from './queryClient';\\n\\nexport const onToggledFeature = (\\n\\tfeature: LicenseModule,\\n\\t{\\n\\t\\tup,\\n\\t\\tdown,\\n\\t}: {\\n\\t\\tup?: () => void;\\n\\t\\tdown?: () => void;\\n\\t},\\n): (() => void) => {\\n\\tconst observer = new QueryObserver(queryClient, {\\n\\t\\tqueryKey: ['ee.features'],\\n\\t\\tqueryFn: fetchFeatures,\\n\\t\\tstaleTime: Infinity,\\n\\t});\\n\\n\\tlet enabled = false;\\n\\n\\treturn observer.subscribe((result) => {\\n\\t\\tif (!result.isSuccess) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tconst features = result.data;\\n\\t\\tconst hasFeature = features.includes(feature);\\n\\n\\t\\tif (!enabled && hasFeature) {\\n\\t\\t\\tup?.();\\n\\t\\t\\tenabled = true;\\n\\t\\t}\\n\\n\\t\\tif (enabled && !hasFeature) {\\n\\t\\t\\tdown?.();\\n\\t\\t\\tenabled = false;\\n\\t\\t}\\n\\t});\\n};\\n\",null],\"names\":[\"module\",\"export\",\"onToggledFeature\",\"link\",\"QueryObserver\",\"v\",\"fetchFeatures\",\"queryClient\",\"feature\",\"_ref\",\"up\",\"down\",\"observer\",\"queryKey\",\"queryFn\",\"staleTime\",\"Infinity\",\"enabled\",\"subscribe\",\"result\",\"isSuccess\",\"hasFeature\",\"features\",\"data\",\"includes\"],\"mappings\":\"uBACAA,EAAOC,MAAE,CAAA,CAAAC,iBAAqB,WAAA,OAAAA,CAAwB,CAAA,GAAAF,EAAAG,IAAA,CAAA,wBAAA,CAAAC,cAAA,SAAAC,CAAA,EAAAD,EAAAC,CAAA,CAAA,EAAA,GAAAL,EAAAG,IAAA,CAAA,kBAAA,CAAAG,cAAA,SAAAD,CAAA,EAAAC,EAAAD,CAAA,CAAA,EAAA,GAAAL,EAAAG,IAAA,CAAA,gBAAA,CAAAI,YAAA,SAAAF,CAAA,EAAAE,EAAAF,CAAA,CAAA,EAAA,GAK/C,IAL+CD,EAAAE,EAAAC,EAKzCL,EAAmB,SAC/BM,CAAsB,CAAAC,CAAA,EAQL,IANhBC,EAAED,EAAFC,EAAE,CACFC,EAAIF,EAAJE,IAAI,CAMCC,EAAW,IAAIR,EAAcG,EAAa,CAC/CM,SAAU,CAAC,cAAc,CACzBC,QAASR,EACTS,UAAWC,MAGRC,EAAU,CAAA,EAEd,OAAOL,EAASM,SAAS,CAAC,SAACC,CAAM,EAChC,GAAKA,EAAOC,SAAS,EAKrB,IAAMC,EAAaC,AADFH,EAAOI,IAAI,CACAC,QAAQ,CAAChB,EAEjC,EAACS,GAAWI,IACfX,MAAAA,GAAAA,IACAO,EAAU,CAAA,GAGPA,GAAW,CAACI,IACfV,MAAAA,GAAAA,IACAM,EAAU,CAAA,GAEZ,EACD\"}"}