{"code":"function module(e,t,n){var i,r,o,a,s,u,c,l,f,p,d,h,m,v,k,P,g,x,y,b,E,w,C=[\"reset\"];n.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default:function(e){i=e}},0),n.link(\"@babel/runtime/regenerator\",{default:function(e){r=e}},1),n.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){o=e}},2),n.export({PrioritiesPage:function(){return R}}),n.link(\"@rocket.chat/fuselage\",{Button:function(e){a=e},ButtonGroup:function(e){s=e}},0),n.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback:function(e){u=e}},1),n.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(e){c=e},useRoute:function(e){l=e},useSetModal:function(e){f=e},useToastMessageDispatch:function(e){p=e},useTranslation:function(e){d=e}},2),n.link(\"@tanstack/react-query\",{useQueryClient:function(e){h=e}},3),n.link(\"react\",{default:function(e){m=e},useMemo:function(e){v=e},useState:function(e){k=e}},4),n.link(\"../../components/Page\",{Page:function(e){P=e},PageHeader:function(e){g=e},PageContent:function(e){x=e}},5),n.link(\"../hooks/useOmnichannelPriorities\",{useOmnichannelPriorities:function(e){y=e}},6),n.link(\"./PrioritiesResetModal\",{PrioritiesResetModal:function(e){b=e}},7),n.link(\"./PrioritiesTable\",{PrioritiesTable:function(e){E=e}},8),n.link(\"./PriorityList\",{default:function(e){w=e}},9);var R=function(e){var t=e.priorityId,n=e.context,R=d(),T=h(),M=l(\"omnichannel-priorities\"),I=p(),Q=f(),S=k(!1),L=o(S,2),O=L[0],B=L[1],D=c(\"PUT\",\"/v1/livechat/priorities/:priorityId\",{priorityId:t}),_=c(\"POST\",\"/v1/livechat/priorities.reset\"),j=y(),q=j.data,A=j.isLoading,G=v(function(){return!!q.length&&q.some(function(e){return e.dirty})},[q]),H=u(function(e){M.push({context:\"edit\",id:e})});return m.createElement(P,{flexDirection:\"row\"},m.createElement(P,null,m.createElement(g,{title:R(\"Priorities\")},m.createElement(s,null,m.createElement(a,{onClick:function(){Q(m.createElement(b,{onReset:function(){return r.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,B(!0),Q(null),e.next=5,r.awrap(_());case 5:return e.next=7,r.awrap(T.invalidateQueries([\"/v1/livechat/priorities\"],{exact:!0}));case 7:M.push({}),I({type:\"success\",message:R(\"Priorities_restored\")}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),I({type:\"error\",message:e.t0});case 14:return e.prev=14,B(!1),e.finish(14);case 17:case\"end\":return e.stop()}},null,null,[[0,11,14,17]],Promise)},onCancel:function(){return Q(null)}}))},title:R(\"Reset\"),disabled:!G,loading:O},R(\"Reset\")))),m.createElement(x,null,m.createElement(E,{priorities:q,isLoading:A,onRowClick:H}))),\"edit\"===n&&m.createElement(w,{priorityId:t,context:n,onSave:function(e){var t,n;return r.async(function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.reset,n=i(e,C),o.next=3,r.awrap(D(t?{reset:t}:n));case 3:return o.next=5,r.awrap(T.invalidateQueries([\"/v1/livechat/priorities\"]));case 5:return I({type:\"success\",message:R(\"Priority_saved\")}),o.next=8,r.awrap(T.invalidateQueries([\"/v1/livechat/priorities\"],{exact:!0}));case 8:M.push({});case 9:case\"end\":return o.stop()}},null,null,null,Promise)},onClose:function(){M.push({})}}))}}","map":"{\"version\":3,\"sources\":[\"client/omnichannel/priorities/PrioritiesPage.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Button, ButtonGroup } from '@rocket.chat/fuselage';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useEndpoint, useRoute, useSetModal, useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\\nimport { useQueryClient } from '@tanstack/react-query';\\nimport type { ReactElement } from 'react';\\nimport React, { useMemo, useState } from 'react';\\n\\nimport { Page, PageHeader, PageContent } from '../../components/Page';\\nimport { useOmnichannelPriorities } from '../hooks/useOmnichannelPriorities';\\nimport { PrioritiesResetModal } from './PrioritiesResetModal';\\nimport { PrioritiesTable } from './PrioritiesTable';\\nimport type { PriorityFormData } from './PriorityEditForm';\\nimport PriorityList from './PriorityList';\\n\\ntype PrioritiesPageProps = {\\n\\tpriorityId: string;\\n\\tcontext: 'edit' | undefined;\\n};\\n\\nexport const PrioritiesPage = ({ priorityId, context }: PrioritiesPageProps): ReactElement => {\\n\\tconst t = useTranslation();\\n\\tconst queryClient = useQueryClient();\\n\\tconst prioritiesRoute = useRoute('omnichannel-priorities');\\n\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst setModal = useSetModal();\\n\\n\\tconst [isResetting, setResetting] = useState(false);\\n\\n\\tconst savePriority = useEndpoint('PUT', `/v1/livechat/priorities/:priorityId`, { priorityId });\\n\\tconst resetPriorities = useEndpoint('POST', '/v1/livechat/priorities.reset');\\n\\n\\tconst { data: priorities, isLoading } = useOmnichannelPriorities();\\n\\n\\tconst isPrioritiesDirty = useMemo(() => !!priorities.length && priorities.some((p) => p.dirty), [priorities]);\\n\\n\\tconst handleReset = (): void => {\\n\\t\\tconst onReset = async (): Promise<void> => {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tsetResetting(true);\\n\\t\\t\\t\\tsetModal(null);\\n\\n\\t\\t\\t\\tawait resetPriorities();\\n\\t\\t\\t\\tawait queryClient.invalidateQueries(['/v1/livechat/priorities'], { exact: true });\\n\\n\\t\\t\\t\\tprioritiesRoute.push({});\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Priorities_restored') });\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t} finally {\\n\\t\\t\\t\\tsetResetting(false);\\n\\t\\t\\t}\\n\\t\\t};\\n\\n\\t\\tsetModal(<PrioritiesResetModal onReset={onReset} onCancel={(): void => setModal(null)} />);\\n\\t};\\n\\n\\tconst onRowClick = useMutableCallback((id: string): void => {\\n\\t\\tprioritiesRoute.push({ context: 'edit', id });\\n\\t});\\n\\n\\tconst onContextualbarClose = (): void => {\\n\\t\\tprioritiesRoute.push({});\\n\\t};\\n\\n\\tconst onSavePriority = async ({ reset, ...payload }: PriorityFormData): Promise<void> => {\\n\\t\\tawait savePriority(reset ? { reset } : payload);\\n\\t\\tawait queryClient.invalidateQueries(['/v1/livechat/priorities']);\\n\\n\\t\\tdispatchToastMessage({ type: 'success', message: t('Priority_saved') });\\n\\t\\tawait queryClient.invalidateQueries(['/v1/livechat/priorities'], { exact: true });\\n\\t\\tprioritiesRoute.push({});\\n\\t};\\n\\n\\treturn (\\n\\t\\t<Page flexDirection='row'>\\n\\t\\t\\t<Page>\\n\\t\\t\\t\\t<PageHeader title={t('Priorities')}>\\n\\t\\t\\t\\t\\t<ButtonGroup>\\n\\t\\t\\t\\t\\t\\t<Button onClick={handleReset} title={t('Reset')} disabled={!isPrioritiesDirty} loading={isResetting}>\\n\\t\\t\\t\\t\\t\\t\\t{t('Reset')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t</ButtonGroup>\\n\\t\\t\\t\\t</PageHeader>\\n\\t\\t\\t\\t<PageContent>\\n\\t\\t\\t\\t\\t<PrioritiesTable priorities={priorities} isLoading={isLoading} onRowClick={onRowClick} />\\n\\t\\t\\t\\t</PageContent>\\n\\t\\t\\t</Page>\\n\\t\\t\\t{context === 'edit' && (\\n\\t\\t\\t\\t<PriorityList priorityId={priorityId} context={context} onSave={onSavePriority} onClose={onContextualbarClose} />\\n\\t\\t\\t)}\\n\\t\\t</Page>\\n\\t);\\n};\\n\",null],\"names\":[\"_objectWithoutProperties\",\"_regeneratorRuntime\",\"_slicedToArray\",\"Button\",\"ButtonGroup\",\"useMutableCallback\",\"useEndpoint\",\"useRoute\",\"useSetModal\",\"useToastMessageDispatch\",\"useTranslation\",\"useQueryClient\",\"React\",\"useMemo\",\"useState\",\"Page\",\"PageHeader\",\"PageContent\",\"useOmnichannelPriorities\",\"PrioritiesResetModal\",\"PrioritiesTable\",\"PriorityList\",\"module\",\"link\",\"default\",\"v\",\"export\",\"PrioritiesPage\",\"_ref\",\"priorityId\",\"context\",\"t\",\"queryClient\",\"prioritiesRoute\",\"dispatchToastMessage\",\"setModal\",\"_useState\",\"_useState2\",\"isResetting\",\"setResetting\",\"savePriority\",\"resetPriorities\",\"_useOmnichannelPriori\",\"priorities\",\"data\",\"isLoading\",\"isPrioritiesDirty\",\"length\",\"some\",\"p\",\"dirty\",\"onRowClick\",\"id\",\"push\",\"createElement\",\"flexDirection\",\"title\",\"onClick\",\"onReset\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"invalidateQueries\",\"exact\",\"type\",\"message\",\"t0\",\"finish\",\"stop\",\"Promise\",\"onCancel\",\"disabled\",\"loading\",\"onSave\",\"_ref2\",\"reset\",\"payload\",\"_context2\",\"_excluded\",\"onClose\"],\"mappings\":\"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\"}"}