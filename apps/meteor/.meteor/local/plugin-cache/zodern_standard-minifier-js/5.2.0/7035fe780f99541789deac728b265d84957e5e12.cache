{"code":"function module(e,t,r){let a,l,n,i,o,s,d,u,c,m,v,E,k,S,f,x,y,g,F,h,p,C;r.link(\"@rocket.chat/fuselage\",{Divider(e){a=e},Modal(e){l=e},ButtonGroup(e){n=e},Button(e){i=e},Field(e){o=e},FieldLabel(e){s=e},FieldRow(e){d=e},FieldError(e){u=e},FieldHint(e){c=e},TextInput(e){m=e}},0),r.link(\"@rocket.chat/fuselage-hooks\",{useUniqueId(e){v=e}},1),r.link(\"@rocket.chat/ui-contexts\",{useSetModal(e){E=e},useTranslation(e){k=e},useEndpoint(e){S=e},useToastMessageDispatch(e){f=e}},2),r.link(\"@tanstack/react-query\",{useMutation(e){x=e},useQueryClient(e){y=e}},3),r.link(\"react\",{default(e){g=e},useState(e){F=e}},4),r.link(\"./MatrixFederationRemoveServerList\",{default(e){h=e}},5),r.link(\"./MatrixFederationSearch\",{default(e){p=e}},6),r.link(\"./useMatrixServerList\",{useMatrixServerList(e){C=e}},7);let M=e=>e?\"invalid-server-name\"===e.error?\"Server_doesnt_exist\":\"invalid-server-name\"===e.error?\"Server_already_added\":void 0:void 0;r.exportDefault(e=>{let{onClickClose:t}=e,r=k(),_=S(\"POST\",\"/v1/federation/addServerByUser\"),[T,b]=F(\"\"),[B,L]=F(),U=E(),D=y(),H=f(),{mutate:q,isLoading:w,isError:I}=x([\"v1/federation/addServerByUser\",T],()=>_({serverName:T}),{onSuccess:async()=>{await D.invalidateQueries([\"federation/listServersByUsers\"]),U(g.createElement(p,{defaultSelectedServer:T,onClose:t,key:T}))},onError:e=>{let t=M(e);if(!t){H({type:\"error\",message:e});return}L(t)}}),{data:Q,isLoading:R}=C(),A=v(),G=v();return g.createElement(l,{maxHeight:\"x600\",open:!0,\"aria-labelledby\":A},g.createElement(l.Header,null,g.createElement(l.Title,{id:A},r(\"Manage_servers\")),g.createElement(l.Close,{onClick:t})),g.createElement(l.Content,null,g.createElement(o,null,g.createElement(s,{htmlFor:G},r(\"Server_name\")),g.createElement(d,null,g.createElement(m,{id:G,disabled:w,value:T,onChange:e=>{b(e.currentTarget.value),B&&L(void 0)},mie:4}),g.createElement(i,{primary:!0,loading:w,onClick:()=>q()},r(\"Add\"))),I&&B&&g.createElement(u,null,r(B)),g.createElement(c,null,r(\"Federation_Example_matrix_server\"))),g.createElement(a,{mb:16}),!R&&(null==Q?void 0:Q.servers)&&g.createElement(h,{servers:Q.servers})),g.createElement(l.Footer,null,g.createElement(n,null,g.createElement(i,{onClick:t},r(\"Cancel\")))))})}","map":"{\"version\":3,\"sources\":[\"client/sidebar/header/MatrixFederationSearch/MatrixFederationManageServerModal.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Divider, Modal, ButtonGroup, Button, Field, FieldLabel, FieldRow, FieldError, FieldHint, TextInput } from '@rocket.chat/fuselage';\\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\\nimport { useSetModal, useTranslation, useEndpoint, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\\nimport type { FormEvent } from 'react';\\nimport React, { useState } from 'react';\\n\\nimport MatrixFederationRemoveServerList from './MatrixFederationRemoveServerList';\\nimport MatrixFederationSearch from './MatrixFederationSearch';\\nimport { useMatrixServerList } from './useMatrixServerList';\\n\\ntype MatrixFederationAddServerModalProps = {\\n\\tonClickClose: () => void;\\n};\\n\\nconst getErrorKey = (error: any): TranslationKey | undefined => {\\n\\tif (!error) {\\n\\t\\treturn;\\n\\t}\\n\\tif (error.error === 'invalid-server-name') {\\n\\t\\treturn 'Server_doesnt_exist';\\n\\t}\\n\\tif (error.error === 'invalid-server-name') {\\n\\t\\treturn 'Server_already_added';\\n\\t}\\n};\\n\\nconst MatrixFederationAddServerModal = ({ onClickClose }: MatrixFederationAddServerModalProps) => {\\n\\tconst t = useTranslation();\\n\\tconst addMatrixServer = useEndpoint('POST', '/v1/federation/addServerByUser');\\n\\tconst [serverName, setServerName] = useState('');\\n\\tconst [errorKey, setErrorKey] = useState<TranslationKey | undefined>();\\n\\tconst setModal = useSetModal();\\n\\tconst queryClient = useQueryClient();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst {\\n\\t\\tmutate: addServer,\\n\\t\\tisLoading,\\n\\t\\tisError,\\n\\t} = useMutation(['v1/federation/addServerByUser', serverName], () => addMatrixServer({ serverName }), {\\n\\t\\tonSuccess: async () => {\\n\\t\\t\\tawait queryClient.invalidateQueries(['federation/listServersByUsers']);\\n\\t\\t\\tsetModal(<MatrixFederationSearch defaultSelectedServer={serverName} onClose={onClickClose} key={serverName} />);\\n\\t\\t},\\n\\t\\tonError: (error) => {\\n\\t\\t\\tconst errorKey = getErrorKey(error);\\n\\t\\t\\tif (!errorKey) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t\\tsetErrorKey(errorKey);\\n\\t\\t},\\n\\t});\\n\\n\\tconst { data, isLoading: isLoadingServerList } = useMatrixServerList();\\n\\n\\tconst titleId = useUniqueId();\\n\\tconst serverNameId = useUniqueId();\\n\\n\\treturn (\\n\\t\\t<Modal maxHeight='x600' open aria-labelledby={titleId}>\\n\\t\\t\\t<Modal.Header>\\n\\t\\t\\t\\t<Modal.Title id={titleId}>{t('Manage_servers')}</Modal.Title>\\n\\t\\t\\t\\t<Modal.Close onClick={onClickClose} />\\n\\t\\t\\t</Modal.Header>\\n\\t\\t\\t<Modal.Content>\\n\\t\\t\\t\\t<Field>\\n\\t\\t\\t\\t\\t<FieldLabel htmlFor={serverNameId}>{t('Server_name')}</FieldLabel>\\n\\t\\t\\t\\t\\t<FieldRow>\\n\\t\\t\\t\\t\\t\\t<TextInput\\n\\t\\t\\t\\t\\t\\t\\tid={serverNameId}\\n\\t\\t\\t\\t\\t\\t\\tdisabled={isLoading}\\n\\t\\t\\t\\t\\t\\t\\tvalue={serverName}\\n\\t\\t\\t\\t\\t\\t\\tonChange={(e: FormEvent<HTMLInputElement>) => {\\n\\t\\t\\t\\t\\t\\t\\t\\tsetServerName(e.currentTarget.value);\\n\\t\\t\\t\\t\\t\\t\\t\\tif (errorKey) {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tsetErrorKey(undefined);\\n\\t\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t\\t}}\\n\\t\\t\\t\\t\\t\\t\\tmie={4}\\n\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t<Button primary loading={isLoading} onClick={() => addServer()}>\\n\\t\\t\\t\\t\\t\\t\\t{t('Add')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t\\t\\t{isError && errorKey && <FieldError>{t(errorKey)}</FieldError>}\\n\\t\\t\\t\\t\\t<FieldHint>{t('Federation_Example_matrix_server')}</FieldHint>\\n\\t\\t\\t\\t</Field>\\n\\t\\t\\t\\t<Divider mb={16} />\\n\\t\\t\\t\\t{!isLoadingServerList && data?.servers && <MatrixFederationRemoveServerList servers={data.servers} />}\\n\\t\\t\\t</Modal.Content>\\n\\t\\t\\t<Modal.Footer>\\n\\t\\t\\t\\t<ButtonGroup>\\n\\t\\t\\t\\t\\t<Button onClick={onClickClose}>{t('Cancel')}</Button>\\n\\t\\t\\t\\t</ButtonGroup>\\n\\t\\t\\t</Modal.Footer>\\n\\t\\t</Modal>\\n\\t);\\n};\\n\\nexport default MatrixFederationAddServerModal;\\n\",null],\"names\":[\"Divider\",\"Modal\",\"ButtonGroup\",\"Button\",\"Field\",\"FieldLabel\",\"FieldRow\",\"FieldError\",\"FieldHint\",\"TextInput\",\"useUniqueId\",\"useSetModal\",\"useTranslation\",\"useEndpoint\",\"useToastMessageDispatch\",\"useMutation\",\"useQueryClient\",\"React\",\"useState\",\"MatrixFederationRemoveServerList\",\"MatrixFederationSearch\",\"useMatrixServerList\",\"module\",\"link\",\"v\",\"default\",\"getErrorKey\",\"error\",\"exportDefault\",\"_ref\",\"onClickClose\",\"t\",\"addMatrixServer\",\"serverName\",\"setServerName\",\"errorKey\",\"setErrorKey\",\"setModal\",\"queryClient\",\"dispatchToastMessage\",\"mutate\",\"addServer\",\"isLoading\",\"isError\",\"onSuccess\",\"invalidateQueries\",\"createElement\",\"defaultSelectedServer\",\"onClose\",\"key\",\"onError\",\"type\",\"message\",\"data\",\"isLoadingServerList\",\"titleId\",\"serverNameId\",\"maxHeight\",\"open\",\"Header\",\"Title\",\"id\",\"Close\",\"onClick\",\"Content\",\"htmlFor\",\"disabled\",\"value\",\"onChange\",\"e\",\"currentTarget\",\"undefined\",\"mie\",\"primary\",\"loading\",\"mb\",\"servers\",\"Footer\"],\"mappings\":\"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\"}"}