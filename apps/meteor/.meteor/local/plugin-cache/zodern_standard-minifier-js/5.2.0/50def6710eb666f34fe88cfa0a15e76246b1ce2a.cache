{"code":"function module(o,n,t){var e,u,r,i,a,c,s,l,f,m,d,b,R,k,p,v;t.link(\"@babel/runtime/helpers/toConsumableArray\",{default:function(o){e=o}},0),t.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(o){u=o}},1),t.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback:function(o){r=o},useStableArray:function(o){i=o}},0),t.link(\"@rocket.chat/ui-contexts\",{useUserId:function(o){a=o},useSetting:function(o){c=o},useRouter:function(o){s=o},useRouteParameter:function(o){l=o},useLayoutHiddenActions:function(o){f=o}},1),t.link(\"react\",{default:function(o){m=o},useMemo:function(o){d=o}},2),t.link(\"../contexts/RoomContext\",{useRoom:function(o){b=o}},3),t.link(\"../contexts/RoomToolboxContext\",{RoomToolboxContext:function(o){R=o}},4),t.link(\"../lib/getRoomGroup\",{getRoomGroup:function(o){k=o}},5),t.link(\"./hooks/useAppsRoomActions\",{useAppsRoomActions:function(o){p=o}},6),t.link(\"./hooks/useCoreRoomActions\",{useCoreRoomActions:function(o){v=o}},7),t.exportDefault(function(o){var n=o.children,t=b(),g=s(),h=r(function(o,n){if(o===(null==G?void 0:G.id)&&void 0===n)return x();var t=g.getRouteName();if(!t)throw Error(\"Route name is not defined\");var e=g.getSearchParameters().layout;g.navigate({name:t,params:u(u({},g.getRouteParameters()),{},{tab:o,context:null!=n?n:\"\"}),search:e?{layout:e}:void 0})}),x=r(function(){var o=g.getRouteName();if(!o)throw Error(\"Route name is not defined\");g.navigate({name:o,params:u(u({},g.getRouteParameters()),{},{tab:\"\",context:\"\"}),search:g.getSearchParameters()})}),A=l(\"context\"),y=v(),C=p(),P=c(\"Accounts_AllowAnonymousRead\",!1),S=a(),T=f().roomToolbox,w=i([].concat(e(y),e(C)).filter(function(o){return S||P&&\"anonymous\"in o&&o.anonymous}).filter(function(o){return!o.groups||o.groups.includes(k(t))}).filter(function(o){return!T.includes(o.id)}).sort(function(o,n){var t,e;return(null!==(t=o.order)&&void 0!==t?t:0)-(null!==(e=n.order)&&void 0!==e?e:0)})),E=l(\"tab\"),G=d(function(){if(E)return w.find(function(o){return o.id===E})},[w,E]),M=d(function(){return{actions:w,tab:G,context:A,openTab:h,closeTab:x}},[w,G,A,h,x]);return m.createElement(R.Provider,{value:M},n)})}","map":"{\"version\":3,\"sources\":[\"client/views/room/providers/RoomToolboxProvider.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { useMutableCallback, useStableArray } from '@rocket.chat/fuselage-hooks';\\nimport { useUserId, useSetting, useRouter, useRouteParameter, useLayoutHiddenActions } from '@rocket.chat/ui-contexts';\\nimport type { ReactNode } from 'react';\\nimport React, { useMemo } from 'react';\\n\\nimport { useRoom } from '../contexts/RoomContext';\\nimport { RoomToolboxContext } from '../contexts/RoomToolboxContext';\\nimport type { RoomToolboxContextValue } from '../contexts/RoomToolboxContext';\\nimport { getRoomGroup } from '../lib/getRoomGroup';\\nimport { useAppsRoomActions } from './hooks/useAppsRoomActions';\\nimport { useCoreRoomActions } from './hooks/useCoreRoomActions';\\n\\ntype RoomToolboxProviderProps = { children: ReactNode };\\n\\nconst RoomToolboxProvider = ({ children }: RoomToolboxProviderProps) => {\\n\\tconst room = useRoom();\\n\\n\\tconst router = useRouter();\\n\\n\\tconst openTab = useMutableCallback((actionId: string, context?: string) => {\\n\\t\\tif (actionId === tab?.id && context === undefined) {\\n\\t\\t\\treturn closeTab();\\n\\t\\t}\\n\\n\\t\\tconst routeName = router.getRouteName();\\n\\n\\t\\tif (!routeName) {\\n\\t\\t\\tthrow new Error('Route name is not defined');\\n\\t\\t}\\n\\n\\t\\tconst { layout } = router.getSearchParameters();\\n\\n\\t\\trouter.navigate({\\n\\t\\t\\tname: routeName,\\n\\t\\t\\tparams: {\\n\\t\\t\\t\\t...router.getRouteParameters(),\\n\\t\\t\\t\\ttab: actionId,\\n\\t\\t\\t\\tcontext: context ?? '',\\n\\t\\t\\t},\\n\\t\\t\\tsearch: layout ? { layout } : undefined,\\n\\t\\t});\\n\\t});\\n\\n\\tconst closeTab = useMutableCallback(() => {\\n\\t\\tconst routeName = router.getRouteName();\\n\\n\\t\\tif (!routeName) {\\n\\t\\t\\tthrow new Error('Route name is not defined');\\n\\t\\t}\\n\\n\\t\\trouter.navigate({\\n\\t\\t\\tname: routeName,\\n\\t\\t\\tparams: {\\n\\t\\t\\t\\t...router.getRouteParameters(),\\n\\t\\t\\t\\ttab: '',\\n\\t\\t\\t\\tcontext: '',\\n\\t\\t\\t},\\n\\t\\t\\tsearch: router.getSearchParameters(),\\n\\t\\t});\\n\\t});\\n\\n\\tconst context = useRouteParameter('context');\\n\\n\\tconst coreRoomActions = useCoreRoomActions();\\n\\tconst appsRoomActions = useAppsRoomActions();\\n\\n\\tconst allowAnonymousRead = useSetting<boolean>('Accounts_AllowAnonymousRead', false);\\n\\tconst uid = useUserId();\\n\\n\\tconst { roomToolbox: hiddenActions } = useLayoutHiddenActions();\\n\\n\\tconst actions = useStableArray(\\n\\t\\t[...coreRoomActions, ...appsRoomActions]\\n\\t\\t\\t.filter((action) => uid || (allowAnonymousRead && 'anonymous' in action && action.anonymous))\\n\\t\\t\\t.filter((action) => !action.groups || action.groups.includes(getRoomGroup(room)))\\n\\t\\t\\t.filter((action) => !hiddenActions.includes(action.id))\\n\\t\\t\\t.sort((a, b) => (a.order ?? 0) - (b.order ?? 0)),\\n\\t);\\n\\n\\tconst tabActionId = useRouteParameter('tab');\\n\\tconst tab = useMemo(() => {\\n\\t\\tif (!tabActionId) {\\n\\t\\t\\treturn undefined;\\n\\t\\t}\\n\\n\\t\\treturn actions.find((action) => action.id === tabActionId);\\n\\t}, [actions, tabActionId]);\\n\\n\\tconst contextValue = useMemo(\\n\\t\\t(): RoomToolboxContextValue => ({\\n\\t\\t\\tactions,\\n\\t\\t\\ttab,\\n\\t\\t\\tcontext,\\n\\t\\t\\topenTab,\\n\\t\\t\\tcloseTab,\\n\\t\\t}),\\n\\t\\t[actions, tab, context, openTab, closeTab],\\n\\t);\\n\\n\\treturn <RoomToolboxContext.Provider value={contextValue}>{children}</RoomToolboxContext.Provider>;\\n};\\n\\nexport default RoomToolboxProvider;\\n\",null],\"names\":[\"_toConsumableArray\",\"_objectSpread\",\"useMutableCallback\",\"useStableArray\",\"useUserId\",\"useSetting\",\"useRouter\",\"useRouteParameter\",\"useLayoutHiddenActions\",\"React\",\"useMemo\",\"useRoom\",\"RoomToolboxContext\",\"getRoomGroup\",\"useAppsRoomActions\",\"useCoreRoomActions\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"children\",\"room\",\"router\",\"openTab\",\"actionId\",\"context\",\"tab\",\"id\",\"undefined\",\"closeTab\",\"routeName\",\"getRouteName\",\"Error\",\"layout\",\"_router$getSearchPara\",\"getSearchParameters\",\"navigate\",\"name\",\"params\",\"getRouteParameters\",\"search\",\"coreRoomActions\",\"appsRoomActions\",\"allowAnonymousRead\",\"uid\",\"hiddenActions\",\"_useLayoutHiddenActio\",\"roomToolbox\",\"actions\",\"concat\",\"filter\",\"action\",\"anonymous\",\"groups\",\"includes\",\"sort\",\"a\",\"b\",\"_a$order\",\"_b$order\",\"order\",\"tabActionId\",\"find\",\"contextValue\",\"createElement\",\"Provider\",\"value\"],\"mappings\":\"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\"}"}