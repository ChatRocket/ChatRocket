{"code":"function module(e,t,r){let n,a,l,o,i,s,c,u,m,d,E,g,k,p,h,_,f,C,F,b,x;r.link(\"@babel/runtime/helpers/extends\",{default(e){n=e}},0),r.link(\"@rocket.chat/fuselage\",{Box(e){a=e},Modal(e){l=e},Button(e){o=e},FieldGroup(e){i=e},Field(e){s=e},FieldRow(e){c=e},FieldError(e){u=e},FieldHint(e){m=e}},0),r.link(\"@rocket.chat/fuselage-hooks\",{useUniqueId(e){d=e}},1),r.link(\"@rocket.chat/ui-contexts\",{useTranslation(e){E=e},useEndpoint(e){g=e},useToastMessageDispatch(e){k=e},useSetting(e){p=e}},2),r.link(\"@tanstack/react-query\",{useMutation(e){h=e}},3),r.link(\"react\",{default(e){_=e},memo(e){f=e}},4),r.link(\"react-hook-form\",{useForm(e){C=e},Controller(e){F=e}},5),r.link(\"../../components/UserAutoCompleteMultiple/UserAutoCompleteMultipleFederated\",{default(e){b=e}},6),r.link(\"../../lib/utils/goToRoomById\",{goToRoomById(e){x=e}},7),r.exportDefault(f(e=>{let{onClose:t}=e,r=E(),f=p(\"DirectMesssage_maxUsers\")||1,y=d(),v=k(),B=g(\"POST\",\"/v1/dm.create\"),{control:D,handleSubmit:M,formState:{isSubmitting:S,isValidating:T,errors:q}}=C({mode:\"onBlur\",defaultValues:{users:[]}}),U=h({mutationFn:B,onSuccess:e=>{let{room:{rid:t}}=e;x(t)},onError:e=>{v({type:\"error\",message:e})},onSettled:()=>{t()}}),I=async e=>{let{users:t}=e;return U.mutateAsync({usernames:t.join(\",\")})};return _.createElement(l,{\"data-qa\":\"create-direct-modal\",wrapperFunction:e=>_.createElement(a,n({is:\"form\",onSubmit:M(I)},e))},_.createElement(l.Header,null,_.createElement(l.Title,null,r(\"Create_direct_message\")),_.createElement(l.Close,{tabIndex:-1,onClick:t})),_.createElement(l.Content,{mbe:2},_.createElement(i,null,_.createElement(s,null,_.createElement(a,{htmlFor:y},r(\"Direct_message_creation_description\")),_.createElement(c,null,_.createElement(F,{name:\"users\",rules:{required:r(\"Direct_message_creation_error\"),validate:e=>e.length+1>f?r(\"error-direct-message-max-user-exceeded\",{maxUsers:f}):void 0},control:D,render:e=>{let{field:{name:t,onChange:r,value:n,onBlur:a}}=e;return _.createElement(b,{name:t,onChange:r,value:n,onBlur:a,id:y,\"aria-describedby\":\"\".concat(y,\"-hint \").concat(y,\"-error\"),\"aria-required\":\"true\",\"aria-invalid\":!!q.users})}})),q.users&&_.createElement(u,{\"aria-live\":\"assertive\",id:\"\".concat(y,\"-error\")},q.users.message),_.createElement(m,{id:\"\".concat(y,\"-hint\")},r(\"Direct_message_creation_description_hint\"))))),_.createElement(l.Footer,null,_.createElement(l.FooterControllers,null,_.createElement(o,{onClick:t},r(\"Cancel\")),_.createElement(o,{loading:S||T,type:\"submit\",primary:!0},r(\"Create\")))))}))}","map":"{\"version\":3,\"sources\":[\"client/sidebarv2/header/CreateDirectMessage.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IUser } from '@rocket.chat/core-typings';\\nimport { Box, Modal, Button, FieldGroup, Field, FieldRow, FieldError, FieldHint } from '@rocket.chat/fuselage';\\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\\nimport { useTranslation, useEndpoint, useToastMessageDispatch, useSetting } from '@rocket.chat/ui-contexts';\\nimport { useMutation } from '@tanstack/react-query';\\nimport React, { memo } from 'react';\\nimport { useForm, Controller } from 'react-hook-form';\\n\\nimport UserAutoCompleteMultipleFederated from '../../components/UserAutoCompleteMultiple/UserAutoCompleteMultipleFederated';\\nimport { goToRoomById } from '../../lib/utils/goToRoomById';\\n\\ntype CreateDirectMessageProps = { onClose: () => void };\\n\\nconst CreateDirectMessage = ({ onClose }: CreateDirectMessageProps) => {\\n\\tconst t = useTranslation();\\n\\tconst directMaxUsers = useSetting<number>('DirectMesssage_maxUsers') || 1;\\n\\tconst membersFieldId = useUniqueId();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst createDirectAction = useEndpoint('POST', '/v1/dm.create');\\n\\n\\tconst {\\n\\t\\tcontrol,\\n\\t\\thandleSubmit,\\n\\t\\tformState: { isSubmitting, isValidating, errors },\\n\\t} = useForm({ mode: 'onBlur', defaultValues: { users: [] } });\\n\\n\\tconst mutateDirectMessage = useMutation({\\n\\t\\tmutationFn: createDirectAction,\\n\\t\\tonSuccess: ({ room: { rid } }) => {\\n\\t\\t\\tgoToRoomById(rid);\\n\\t\\t},\\n\\t\\tonError: (error) => {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t},\\n\\t\\tonSettled: () => {\\n\\t\\t\\tonClose();\\n\\t\\t},\\n\\t});\\n\\n\\tconst handleCreate = async ({ users }: { users: IUser['username'][] }) => {\\n\\t\\treturn mutateDirectMessage.mutateAsync({ usernames: users.join(',') });\\n\\t};\\n\\n\\treturn (\\n\\t\\t<Modal data-qa='create-direct-modal' wrapperFunction={(props) => <Box is='form' onSubmit={handleSubmit(handleCreate)} {...props} />}>\\n\\t\\t\\t<Modal.Header>\\n\\t\\t\\t\\t<Modal.Title>{t('Create_direct_message')}</Modal.Title>\\n\\t\\t\\t\\t<Modal.Close tabIndex={-1} onClick={onClose} />\\n\\t\\t\\t</Modal.Header>\\n\\t\\t\\t<Modal.Content mbe={2}>\\n\\t\\t\\t\\t<FieldGroup>\\n\\t\\t\\t\\t\\t<Field>\\n\\t\\t\\t\\t\\t\\t<Box htmlFor={membersFieldId}>{t('Direct_message_creation_description')}</Box>\\n\\t\\t\\t\\t\\t\\t<FieldRow>\\n\\t\\t\\t\\t\\t\\t\\t<Controller\\n\\t\\t\\t\\t\\t\\t\\t\\tname='users'\\n\\t\\t\\t\\t\\t\\t\\t\\trules={{\\n\\t\\t\\t\\t\\t\\t\\t\\t\\trequired: t('Direct_message_creation_error'),\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tvalidate: (users) =>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tusers.length + 1 > directMaxUsers\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t? t('error-direct-message-max-user-exceeded', { maxUsers: directMaxUsers })\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t: undefined,\\n\\t\\t\\t\\t\\t\\t\\t\\t}}\\n\\t\\t\\t\\t\\t\\t\\t\\tcontrol={control}\\n\\t\\t\\t\\t\\t\\t\\t\\trender={({ field: { name, onChange, value, onBlur } }) => (\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<UserAutoCompleteMultipleFederated\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tname={name}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tonChange={onChange}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tvalue={value}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tonBlur={onBlur}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tid={membersFieldId}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\taria-describedby={`${membersFieldId}-hint ${membersFieldId}-error`}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\taria-required='true'\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\taria-invalid={Boolean(errors.users)}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t\\t\\t\\t{errors.users && (\\n\\t\\t\\t\\t\\t\\t\\t<FieldError aria-live='assertive' id={`${membersFieldId}-error`}>\\n\\t\\t\\t\\t\\t\\t\\t\\t{errors.users.message}\\n\\t\\t\\t\\t\\t\\t\\t</FieldError>\\n\\t\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t\\t<FieldHint id={`${membersFieldId}-hint`}>{t('Direct_message_creation_description_hint')}</FieldHint>\\n\\t\\t\\t\\t\\t</Field>\\n\\t\\t\\t\\t</FieldGroup>\\n\\t\\t\\t</Modal.Content>\\n\\t\\t\\t<Modal.Footer>\\n\\t\\t\\t\\t<Modal.FooterControllers>\\n\\t\\t\\t\\t\\t<Button onClick={onClose}>{t('Cancel')}</Button>\\n\\t\\t\\t\\t\\t<Button loading={isSubmitting || isValidating} type='submit' primary>\\n\\t\\t\\t\\t\\t\\t{t('Create')}\\n\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t</Modal.FooterControllers>\\n\\t\\t\\t</Modal.Footer>\\n\\t\\t</Modal>\\n\\t);\\n};\\n\\nexport default memo(CreateDirectMessage);\\n\",null],\"names\":[\"_extends\",\"Box\",\"Modal\",\"Button\",\"FieldGroup\",\"Field\",\"FieldRow\",\"FieldError\",\"FieldHint\",\"useUniqueId\",\"useTranslation\",\"useEndpoint\",\"useToastMessageDispatch\",\"useSetting\",\"useMutation\",\"React\",\"memo\",\"useForm\",\"Controller\",\"UserAutoCompleteMultipleFederated\",\"goToRoomById\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"onClose\",\"t\",\"directMaxUsers\",\"membersFieldId\",\"dispatchToastMessage\",\"createDirectAction\",\"control\",\"handleSubmit\",\"formState\",\"isSubmitting\",\"isValidating\",\"errors\",\"mode\",\"defaultValues\",\"users\",\"mutateDirectMessage\",\"mutationFn\",\"onSuccess\",\"_ref2\",\"room\",\"rid\",\"onError\",\"error\",\"type\",\"message\",\"onSettled\",\"handleCreate\",\"_ref3\",\"mutateAsync\",\"usernames\",\"join\",\"createElement\",\"wrapperFunction\",\"props\",\"is\",\"onSubmit\",\"Header\",\"Title\",\"Close\",\"tabIndex\",\"onClick\",\"Content\",\"mbe\",\"htmlFor\",\"name\",\"rules\",\"required\",\"validate\",\"length\",\"maxUsers\",\"undefined\",\"render\",\"_ref4\",\"field\",\"onChange\",\"value\",\"onBlur\",\"id\",\"concat\",\"Boolean\",\"Footer\",\"FooterControllers\",\"loading\",\"primary\"],\"mappings\":\"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\"}"}