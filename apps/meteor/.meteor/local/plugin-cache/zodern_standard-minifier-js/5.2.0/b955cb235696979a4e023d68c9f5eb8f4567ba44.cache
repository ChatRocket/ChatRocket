{"code":"function module(e,s,t){let n,a,l,o,r,i,u,c,h;t.link(\"@babel/runtime/helpers/objectSpread2\",{default(e){n=e}},0),t.export({useMessages:()=>d}),t.link(\"@rocket.chat/fuselage-hooks\",{useStableArray(e){a=e}},0),t.link(\"@rocket.chat/ui-contexts\",{useSetting(e){l=e},useUserPreference(e){o=e}},1),t.link(\"react\",{useCallback(e){r=e},useMemo(e){i=e}},2),t.link(\"../../../../../app/models/client\",{ChatMessage(e){u=e}},3),t.link(\"../../../../hooks/useReactiveValue\",{useReactiveValue(e){c=e}},4),t.link(\"../../contexts/RoomContext\",{useRoom(e){h=e}},5);let k=(e,s)=>Array.from(new Set([...e,...s])),d=e=>{var s;let{rid:t}=e,d=o(\"showThreadsInMainChannel\",!1),m=null!==(s=l(\"Hide_System_Messages\"))&&void 0!==s?s:[],f=h(),y=Array.isArray(f.sysMes)?f.sysMes:[],M=a(k(m,y)),b=i(()=>n({rid:t,_hidden:{$ne:!0},t:{$nin:M}},!d&&{$or:[{tmid:{$exists:!1}},{tshow:{$eq:!0}}]}),[t,M,d]);return c(r(()=>u.find(b,{sort:{ts:1}}).fetch(),[b]))}}","map":"{\"version\":3,\"sources\":[\"client/views/room/MessageList/hooks/useMessages.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom, IMessage, MessageTypesValues } from '@rocket.chat/core-typings';\\nimport { useStableArray } from '@rocket.chat/fuselage-hooks';\\nimport { useSetting, useUserPreference } from '@rocket.chat/ui-contexts';\\nimport type { Mongo } from 'meteor/mongo';\\nimport { useCallback, useMemo } from 'react';\\n\\nimport { ChatMessage } from '../../../../../app/models/client';\\nimport { useReactiveValue } from '../../../../hooks/useReactiveValue';\\nimport { useRoom } from '../../contexts/RoomContext';\\n\\nconst mergeHideSysMessages = (\\n\\tsysMesArray1: Array<MessageTypesValues>,\\n\\tsysMesArray2: Array<MessageTypesValues>,\\n): Array<MessageTypesValues> => {\\n\\treturn Array.from(new Set([...sysMesArray1, ...sysMesArray2]));\\n};\\n\\nexport const useMessages = ({ rid }: { rid: IRoom['_id'] }): IMessage[] => {\\n\\tconst showThreadsInMainChannel = useUserPreference<boolean>('showThreadsInMainChannel', false);\\n\\tconst hideSysMesSetting = useSetting<MessageTypesValues[]>('Hide_System_Messages') ?? [];\\n\\tconst room = useRoom();\\n\\tconst hideRoomSysMes: Array<MessageTypesValues> = Array.isArray(room.sysMes) ? room.sysMes : [];\\n\\n\\tconst hideSysMessages = useStableArray(mergeHideSysMessages(hideSysMesSetting, hideRoomSysMes));\\n\\n\\tconst query: Mongo.Selector<IMessage> = useMemo(\\n\\t\\t() => ({\\n\\t\\t\\trid,\\n\\t\\t\\t_hidden: { $ne: true },\\n\\t\\t\\tt: { $nin: hideSysMessages },\\n\\t\\t\\t...(!showThreadsInMainChannel && {\\n\\t\\t\\t\\t$or: [{ tmid: { $exists: false } }, { tshow: { $eq: true } }],\\n\\t\\t\\t}),\\n\\t\\t}),\\n\\t\\t[rid, hideSysMessages, showThreadsInMainChannel],\\n\\t);\\n\\n\\treturn useReactiveValue(\\n\\t\\tuseCallback(\\n\\t\\t\\t() =>\\n\\t\\t\\t\\tChatMessage.find(query, {\\n\\t\\t\\t\\t\\tsort: {\\n\\t\\t\\t\\t\\t\\tts: 1,\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t}).fetch(),\\n\\t\\t\\t[query],\\n\\t\\t),\\n\\t);\\n};\\n\",null],\"names\":[\"_objectSpread\",\"useStableArray\",\"useSetting\",\"useUserPreference\",\"useCallback\",\"useMemo\",\"ChatMessage\",\"useReactiveValue\",\"useRoom\",\"module\",\"link\",\"default\",\"v\",\"export\",\"useMessages\",\"mergeHideSysMessages\",\"sysMesArray1\",\"sysMesArray2\",\"Array\",\"from\",\"Set\",\"_ref\",\"_useSetting\",\"rid\",\"showThreadsInMainChannel\",\"hideSysMesSetting\",\"room\",\"hideRoomSysMes\",\"isArray\",\"sysMes\",\"hideSysMessages\",\"query\",\"_hidden\",\"$ne\",\"t\",\"$nin\",\"$or\",\"tmid\",\"$exists\",\"tshow\",\"$eq\",\"find\",\"sort\",\"ts\",\"fetch\"],\"mappings\":\"2BACAA,EAA+BC,EAA8BC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAApDC,EAAgBC,IAAA,CAAA,uCAAoC,CAAAC,QAAAC,CAAA,EAAAZ,EAAAY,CAAA,CAAA,EAAA,GAA7DH,EAAOI,MAAE,CAAA,CAAAC,YAAgBA,IAAMA,CAAA,GAA8BL,EAAAC,IAAA,CAAA,8BAAA,CAAAT,eAAAW,CAAA,EAAAX,EAAAW,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,2BAAA,CAAAR,WAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,kBAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAAN,YAAAQ,CAAA,EAAAR,EAAAQ,CAAA,EAAAP,QAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,mCAAA,CAAAJ,YAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,qCAAA,CAAAH,iBAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,6BAAA,CAAAF,QAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAS7D,IAAMG,EAAuBA,CAC5BC,EACAC,IAEOC,MAAMC,IAAI,CAAC,IAAIC,IAAI,IAAIJ,KAAiBC,EAAa,GAGhDH,EAAcO,IAA+C,IAAAC,EAAA,GAA9C,CAAEC,IAAAA,CAAAA,CAA4B,CAAAF,EACnDG,EAA2BrB,EAA2B,2BAA4B,CAAA,GAClFsB,EAAiB,AAA2D,OAA3DH,CAAAA,EAAGpB,EAAiC,uBAAsB,GAACoB,AAAA,KAAA,IAAAA,EAAAA,EAAI,EAAE,CAClFI,EAAOlB,IACPmB,EAA4CT,MAAMU,OAAO,CAACF,EAAKG,MAAM,EAAIH,EAAKG,MAAM,CAAG,EAAE,CAEzFC,EAAkB7B,EAAec,EAAqBU,EAAmBE,IAEzEI,EAAkC1B,EACvC,IAAAL,EAAA,CACCuB,IAAAA,EACAS,QAAS,CAAEC,IAAK,CAAA,CAAI,EACpBC,EAAG,CAAEC,KAAML,CAAe,CAAE,EACxB,CAACN,GAA4B,CAChCY,IAAK,CAAC,CAAEC,KAAM,CAAEC,QAAS,CAAA,CAAK,CAAE,EAAI,CAAEC,MAAO,CAAEC,IAAK,CAAA,CAAI,CAAE,EAAE,GAG9D,CAACjB,EAAKO,EAAiBN,EAAyB,EAGjD,OAAOjB,EACNH,EACC,IACCE,EAAYmC,IAAI,CAACV,EAAO,CACvBW,KAAM,CACLC,GAAI,KAEHC,KAAK,GACT,CAACb,EAAM,EAGV\"}"}