{"code":"function module(t,e,n){var i,r,u,o,a,l,s,c,d,f,m,p=[\"_id\",\"name\",\"_updatedAt\"];n.link(\"@babel/runtime/regenerator\",{default:function(t){i=t}},0),n.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(t){r=t}},1),n.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default:function(t){u=t}},2),n.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(t){o=t}},3),n.export({useDepartmentsByUnitsList:function(){return b}}),n.link(\"@rocket.chat/ui-contexts\",{useTranslation:function(t){a=t},useEndpoint:function(t){l=t}},0),n.link(\"react\",{useCallback:function(t){s=t},useState:function(t){c=t}},1),n.link(\"../../hooks/lists/useScrollableRecordList\",{useScrollableRecordList:function(t){d=t}},2),n.link(\"../../hooks/useComponentDidUpdate\",{useComponentDidUpdate:function(t){f=t}},3),n.link(\"../../lib/lists/RecordList\",{RecordList:function(t){m=t}},4);var b=function(t){var e=a(),n=c(function(){return new m}),b=o(n,2),k=b[0],v=b[1],h=s(function(){return v(new m)},[]),I=l(\"GET\",\"/v1/livechat/units/:unitId/departments/available\",{unitId:t.unitId||\"none\"});f(function(){t&&h()},[t,h]);var C=s(function(n,o){var a,l,s;return i.async(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,i.awrap(I({text:t.filter,offset:n,count:o+n}));case 2:return l=(a=c.sent).departments,s=a.total,c.abrupt(\"return\",{items:l.map(function(t){var n=t._id,i=t.name,o=(t._updatedAt,u(t,p));return r(r({},o),{},{_id:n,name:o.archived?i+\" [\"+e(\"Archived\")+\"]\":i,label:i,value:n})}),itemCount:s});case 6:case\"end\":return c.stop()}},null,null,null,Promise)},[I,t.filter,e]),L=d(k,C,25);return{reload:h,itemsList:k,loadMoreItems:L.loadMoreItems,initialItemCount:L.initialItemCount}}}","map":"{\"version\":3,\"sources\":[\"client/views/hooks/useDepartmentsByUnitsList.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { ILivechatDepartment, IOmnichannelBusinessUnit } from '@rocket.chat/core-typings';\\nimport { useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useCallback, useState } from 'react';\\n\\nimport { useScrollableRecordList } from '../../hooks/lists/useScrollableRecordList';\\nimport { useComponentDidUpdate } from '../../hooks/useComponentDidUpdate';\\nimport { RecordList } from '../../lib/lists/RecordList';\\n\\ntype DepartmentsListOptions = {\\n\\tunitId?: IOmnichannelBusinessUnit['_id'];\\n\\tfilter: string;\\n};\\n\\nexport const useDepartmentsByUnitsList = (\\n\\toptions: DepartmentsListOptions,\\n): {\\n\\titemsList: RecordList<ILivechatDepartment>;\\n\\tinitialItemCount: number;\\n\\treload: () => void;\\n\\tloadMoreItems: (start: number, end: number) => void;\\n} => {\\n\\tconst t = useTranslation();\\n\\tconst [itemsList, setItemsList] = useState(() => new RecordList<ILivechatDepartment>());\\n\\tconst reload = useCallback(() => setItemsList(new RecordList<ILivechatDepartment>()), []);\\n\\n\\tconst getDepartments = useEndpoint('GET', '/v1/livechat/units/:unitId/departments/available', { unitId: options.unitId || 'none' });\\n\\n\\tuseComponentDidUpdate(() => {\\n\\t\\toptions && reload();\\n\\t}, [options, reload]);\\n\\n\\tconst fetchData = useCallback(\\n\\t\\tasync (start, end) => {\\n\\t\\t\\tconst { departments, total } = await getDepartments({\\n\\t\\t\\t\\ttext: options.filter,\\n\\t\\t\\t\\toffset: start,\\n\\t\\t\\t\\tcount: end + start,\\n\\t\\t\\t});\\n\\n\\t\\t\\treturn {\\n\\t\\t\\t\\titems: departments.map(({ _id, name, _updatedAt, ...department }) => {\\n\\t\\t\\t\\t\\treturn {\\n\\t\\t\\t\\t\\t\\t...department,\\n\\t\\t\\t\\t\\t\\t_id,\\n\\t\\t\\t\\t\\t\\tname: department.archived ? `${name} [${t('Archived')}]` : name,\\n\\t\\t\\t\\t\\t\\tlabel: name,\\n\\t\\t\\t\\t\\t\\tvalue: _id,\\n\\t\\t\\t\\t\\t};\\n\\t\\t\\t\\t}),\\n\\t\\t\\t\\titemCount: total,\\n\\t\\t\\t};\\n\\t\\t},\\n\\t\\t[getDepartments, options.filter, t],\\n\\t);\\n\\n\\tconst { loadMoreItems, initialItemCount } = useScrollableRecordList(itemsList, fetchData, 25);\\n\\n\\treturn {\\n\\t\\treload,\\n\\t\\titemsList,\\n\\t\\tloadMoreItems,\\n\\t\\tinitialItemCount,\\n\\t};\\n};\\n\",null],\"names\":[\"_regeneratorRuntime\",\"_objectSpread\",\"_objectWithoutProperties\",\"_slicedToArray\",\"useTranslation\",\"useEndpoint\",\"useCallback\",\"useState\",\"useScrollableRecordList\",\"useComponentDidUpdate\",\"RecordList\",\"module\",\"link\",\"default\",\"v\",\"export\",\"useDepartmentsByUnitsList\",\"options\",\"t\",\"_useState\",\"_useState2\",\"itemsList\",\"setItemsList\",\"reload\",\"getDepartments\",\"unitId\",\"fetchData\",\"start\",\"end\",\"_await$getDepartments\",\"departments\",\"total\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"text\",\"filter\",\"offset\",\"count\",\"sent\",\"abrupt\",\"items\",\"map\",\"_ref\",\"_id\",\"name\",\"department\",\"_updatedAt\",\"_excluded\",\"archived\",\"label\",\"value\",\"itemCount\",\"stop\",\"Promise\",\"_useScrollableRecordL\",\"loadMoreItems\",\"initialItemCount\"],\"mappings\":\"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\"}"}