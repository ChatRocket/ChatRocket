{"code":"function module(e,t,n){let r,i,l,s,a,o,m,u,c,d;function p(e){let t=l({},(i(e),e));if(t.msg){var n;let e=m(s(t.msg));if(!t.channels&&!t.mentions)return e;let i=a.userId(),l=i&&(null===(n=c.findOne(i,{fields:{username:1}}))||void 0===n?void 0:n.username)||\"\",p=d.get(\"UTF8_User_Names_Validation\"),f=d.get(\"UI_Use_Real_Name\"),k=new u({pattern:()=>p,useRealName:()=>f,me:()=>l,userTemplate:e=>{let{label:t}=e;return\"<strong> \".concat(t,\" </strong>\")},roomTemplate:e=>{let{prefix:t,mention:n}=e;return\"\".concat(t,\"<strong> \").concat(n,\" </strong>\")}}),{html:g}=o({html:e});return k.parse(r(r({},t),{},{msg:e,html:g})).html}if(t.attachments){let e=t.attachments.find(e=>e.title||e.description);if(null!=e&&e.description)return s(e.description);if(null!=e&&e.title)return s(e.title)}}n.link(\"@babel/runtime/helpers/objectSpread2\",{default(e){r=e}},0),n.link(\"@babel/runtime/helpers/objectDestructuringEmpty\",{default(e){i=e}},1),n.link(\"@babel/runtime/helpers/extends\",{default(e){l=e}},2),n.export({normalizeThreadTitle:()=>p}),n.link(\"@rocket.chat/string-helpers\",{escapeHTML(e){s=e}},0),n.link(\"meteor/meteor\",{Meteor(e){a=e}},1),n.link(\"../../../emoji/client/emojiParser.js\",{emojiParser(e){o=e}},2),n.link(\"../../../markdown/lib/markdown\",{filterMarkdown(e){m=e}},3),n.link(\"../../../mentions/lib/MentionsParser\",{MentionsParser(e){u=e}},4),n.link(\"../../../models/client\",{Users(e){c=e}},5),n.link(\"../../../settings/client\",{settings(e){d=e}},6)}","map":"{\"version\":3,\"sources\":[\"app/threads/client/lib/normalizeThreadTitle.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IMessage } from '@rocket.chat/core-typings';\\nimport { escapeHTML } from '@rocket.chat/string-helpers';\\nimport { Meteor } from 'meteor/meteor';\\n\\nimport { emojiParser } from '../../../emoji/client/emojiParser.js';\\nimport { filterMarkdown } from '../../../markdown/lib/markdown';\\nimport { MentionsParser } from '../../../mentions/lib/MentionsParser';\\nimport { Users } from '../../../models/client';\\nimport { settings } from '../../../settings/client';\\n\\nexport function normalizeThreadTitle({ ...message }: Readonly<IMessage>) {\\n\\tif (message.msg) {\\n\\t\\tconst filteredMessage = filterMarkdown(escapeHTML(message.msg));\\n\\t\\tif (!message.channels && !message.mentions) {\\n\\t\\t\\treturn filteredMessage;\\n\\t\\t}\\n\\t\\tconst uid = Meteor.userId();\\n\\t\\tconst me = (uid && Users.findOne(uid, { fields: { username: 1 } })?.username) || '';\\n\\t\\tconst pattern = settings.get('UTF8_User_Names_Validation');\\n\\t\\tconst useRealName = settings.get('UI_Use_Real_Name');\\n\\n\\t\\tconst instance = new MentionsParser({\\n\\t\\t\\tpattern: () => pattern,\\n\\t\\t\\tuseRealName: () => useRealName,\\n\\t\\t\\tme: () => me,\\n\\t\\t\\tuserTemplate: ({ label }) => `<strong> ${label} </strong>`,\\n\\t\\t\\troomTemplate: ({ prefix, mention }) => `${prefix}<strong> ${mention} </strong>`,\\n\\t\\t});\\n\\t\\tconst { html } = emojiParser({ html: filteredMessage });\\n\\t\\treturn instance.parse({ ...message, msg: filteredMessage, html }).html;\\n\\t}\\n\\n\\tif (message.attachments) {\\n\\t\\tconst attachment = message.attachments.find((attachment) => attachment.title || attachment.description);\\n\\n\\t\\tif (attachment?.description) {\\n\\t\\t\\treturn escapeHTML(attachment.description);\\n\\t\\t}\\n\\n\\t\\tif (attachment?.title) {\\n\\t\\t\\treturn escapeHTML(attachment.title);\\n\\t\\t}\\n\\t}\\n}\\n\",null],\"names\":[\"_objectSpread\",\"_objectDestructuringEmpty\",\"_extends\",\"escapeHTML\",\"Meteor\",\"emojiParser\",\"filterMarkdown\",\"MentionsParser\",\"Users\",\"settings\",\"normalizeThreadTitle\",\"_ref\",\"message\",\"msg\",\"_Users$findOne\",\"filteredMessage\",\"channels\",\"mentions\",\"uid\",\"userId\",\"me\",\"findOne\",\"fields\",\"username\",\"pattern\",\"get\",\"useRealName\",\"instance\",\"userTemplate\",\"_ref2\",\"label\",\"concat\",\"roomTemplate\",\"_ref3\",\"prefix\",\"mention\",\"html\",\"parse\",\"attachments\",\"attachment\",\"find\",\"title\",\"description\",\"module\",\"link\",\"default\",\"v\",\"export\"],\"mappings\":\"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\"}"}