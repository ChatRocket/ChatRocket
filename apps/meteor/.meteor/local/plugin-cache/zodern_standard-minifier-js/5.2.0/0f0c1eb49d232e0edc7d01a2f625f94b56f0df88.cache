{"code":"function module(e,o,t){let r,n,a,u,s,i,l,m,c,d,R,f,k,g,b;t.link(\"@babel/runtime/helpers/objectSpread2\",{default(e){r=e}},0),t.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback(e){n=e},useStableArray(e){a=e}},0),t.link(\"@rocket.chat/ui-contexts\",{useUserId(e){u=e},useSetting(e){s=e},useRouter(e){i=e},useRouteParameter(e){l=e},useLayoutHiddenActions(e){m=e}},1),t.link(\"react\",{default(e){c=e},useMemo(e){d=e}},2),t.link(\"../contexts/RoomContext\",{useRoom(e){R=e}},3),t.link(\"../contexts/RoomToolboxContext\",{RoomToolboxContext(e){f=e}},4),t.link(\"../lib/getRoomGroup\",{getRoomGroup(e){k=e}},5),t.link(\"./hooks/useAppsRoomActions\",{useAppsRoomActions(e){g=e}},6),t.link(\"./hooks/useCoreRoomActions\",{useCoreRoomActions(e){b=e}},7),t.exportDefault(e=>{let{children:o}=e,t=R(),p=i(),x=n((e,o)=>{if(e===(null==T?void 0:T.id)&&void 0===o)return h();let t=p.getRouteName();if(!t)throw Error(\"Route name is not defined\");let{layout:n}=p.getSearchParameters();p.navigate({name:t,params:r(r({},p.getRouteParameters()),{},{tab:e,context:null!=o?o:\"\"}),search:n?{layout:n}:void 0})}),h=n(()=>{let e=p.getRouteName();if(!e)throw Error(\"Route name is not defined\");p.navigate({name:e,params:r(r({},p.getRouteParameters()),{},{tab:\"\",context:\"\"}),search:p.getSearchParameters()})}),A=l(\"context\"),v=b(),C=g(),P=s(\"Accounts_AllowAnonymousRead\",!1),y=u(),{roomToolbox:S}=m(),w=a([...v,...C].filter(e=>y||P&&\"anonymous\"in e&&e.anonymous).filter(e=>!e.groups||e.groups.includes(k(t))).filter(e=>!S.includes(e.id)).sort((e,o)=>{var t,r;return(null!==(t=e.order)&&void 0!==t?t:0)-(null!==(r=o.order)&&void 0!==r?r:0)})),E=l(\"tab\"),T=d(()=>{if(E)return w.find(e=>e.id===E)},[w,E]),G=d(()=>({actions:w,tab:T,context:A,openTab:x,closeTab:h}),[w,T,A,x,h]);return c.createElement(f.Provider,{value:G},o)})}","map":"{\"version\":3,\"sources\":[\"client/views/room/providers/RoomToolboxProvider.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { useMutableCallback, useStableArray } from '@rocket.chat/fuselage-hooks';\\nimport { useUserId, useSetting, useRouter, useRouteParameter, useLayoutHiddenActions } from '@rocket.chat/ui-contexts';\\nimport type { ReactNode } from 'react';\\nimport React, { useMemo } from 'react';\\n\\nimport { useRoom } from '../contexts/RoomContext';\\nimport { RoomToolboxContext } from '../contexts/RoomToolboxContext';\\nimport type { RoomToolboxContextValue } from '../contexts/RoomToolboxContext';\\nimport { getRoomGroup } from '../lib/getRoomGroup';\\nimport { useAppsRoomActions } from './hooks/useAppsRoomActions';\\nimport { useCoreRoomActions } from './hooks/useCoreRoomActions';\\n\\ntype RoomToolboxProviderProps = { children: ReactNode };\\n\\nconst RoomToolboxProvider = ({ children }: RoomToolboxProviderProps) => {\\n\\tconst room = useRoom();\\n\\n\\tconst router = useRouter();\\n\\n\\tconst openTab = useMutableCallback((actionId: string, context?: string) => {\\n\\t\\tif (actionId === tab?.id && context === undefined) {\\n\\t\\t\\treturn closeTab();\\n\\t\\t}\\n\\n\\t\\tconst routeName = router.getRouteName();\\n\\n\\t\\tif (!routeName) {\\n\\t\\t\\tthrow new Error('Route name is not defined');\\n\\t\\t}\\n\\n\\t\\tconst { layout } = router.getSearchParameters();\\n\\n\\t\\trouter.navigate({\\n\\t\\t\\tname: routeName,\\n\\t\\t\\tparams: {\\n\\t\\t\\t\\t...router.getRouteParameters(),\\n\\t\\t\\t\\ttab: actionId,\\n\\t\\t\\t\\tcontext: context ?? '',\\n\\t\\t\\t},\\n\\t\\t\\tsearch: layout ? { layout } : undefined,\\n\\t\\t});\\n\\t});\\n\\n\\tconst closeTab = useMutableCallback(() => {\\n\\t\\tconst routeName = router.getRouteName();\\n\\n\\t\\tif (!routeName) {\\n\\t\\t\\tthrow new Error('Route name is not defined');\\n\\t\\t}\\n\\n\\t\\trouter.navigate({\\n\\t\\t\\tname: routeName,\\n\\t\\t\\tparams: {\\n\\t\\t\\t\\t...router.getRouteParameters(),\\n\\t\\t\\t\\ttab: '',\\n\\t\\t\\t\\tcontext: '',\\n\\t\\t\\t},\\n\\t\\t\\tsearch: router.getSearchParameters(),\\n\\t\\t});\\n\\t});\\n\\n\\tconst context = useRouteParameter('context');\\n\\n\\tconst coreRoomActions = useCoreRoomActions();\\n\\tconst appsRoomActions = useAppsRoomActions();\\n\\n\\tconst allowAnonymousRead = useSetting<boolean>('Accounts_AllowAnonymousRead', false);\\n\\tconst uid = useUserId();\\n\\n\\tconst { roomToolbox: hiddenActions } = useLayoutHiddenActions();\\n\\n\\tconst actions = useStableArray(\\n\\t\\t[...coreRoomActions, ...appsRoomActions]\\n\\t\\t\\t.filter((action) => uid || (allowAnonymousRead && 'anonymous' in action && action.anonymous))\\n\\t\\t\\t.filter((action) => !action.groups || action.groups.includes(getRoomGroup(room)))\\n\\t\\t\\t.filter((action) => !hiddenActions.includes(action.id))\\n\\t\\t\\t.sort((a, b) => (a.order ?? 0) - (b.order ?? 0)),\\n\\t);\\n\\n\\tconst tabActionId = useRouteParameter('tab');\\n\\tconst tab = useMemo(() => {\\n\\t\\tif (!tabActionId) {\\n\\t\\t\\treturn undefined;\\n\\t\\t}\\n\\n\\t\\treturn actions.find((action) => action.id === tabActionId);\\n\\t}, [actions, tabActionId]);\\n\\n\\tconst contextValue = useMemo(\\n\\t\\t(): RoomToolboxContextValue => ({\\n\\t\\t\\tactions,\\n\\t\\t\\ttab,\\n\\t\\t\\tcontext,\\n\\t\\t\\topenTab,\\n\\t\\t\\tcloseTab,\\n\\t\\t}),\\n\\t\\t[actions, tab, context, openTab, closeTab],\\n\\t);\\n\\n\\treturn <RoomToolboxContext.Provider value={contextValue}>{children}</RoomToolboxContext.Provider>;\\n};\\n\\nexport default RoomToolboxProvider;\\n\",null],\"names\":[\"_objectSpread\",\"useMutableCallback\",\"useStableArray\",\"useUserId\",\"useSetting\",\"useRouter\",\"useRouteParameter\",\"useLayoutHiddenActions\",\"React\",\"useMemo\",\"useRoom\",\"RoomToolboxContext\",\"getRoomGroup\",\"useAppsRoomActions\",\"useCoreRoomActions\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"children\",\"room\",\"router\",\"openTab\",\"actionId\",\"context\",\"tab\",\"id\",\"undefined\",\"closeTab\",\"routeName\",\"getRouteName\",\"Error\",\"layout\",\"getSearchParameters\",\"navigate\",\"name\",\"params\",\"getRouteParameters\",\"search\",\"coreRoomActions\",\"appsRoomActions\",\"allowAnonymousRead\",\"uid\",\"roomToolbox\",\"hiddenActions\",\"actions\",\"filter\",\"action\",\"anonymous\",\"groups\",\"includes\",\"sort\",\"a\",\"b\",\"_a$order\",\"_b$order\",\"order\",\"tabActionId\",\"find\",\"contextValue\",\"createElement\",\"Provider\",\"value\"],\"mappings\":\"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\"}"}