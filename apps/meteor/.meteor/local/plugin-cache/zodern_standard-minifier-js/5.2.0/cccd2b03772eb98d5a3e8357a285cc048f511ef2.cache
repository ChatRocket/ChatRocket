{"code":"function module(n,e,t){var a,u,r,i,l,c,s,o,f,d,v,h,p=[\"params\",\"reloadRef\"];t.link(\"@babel/runtime/regenerator\",{default:function(n){a=n}},0),t.link(\"@babel/runtime/helpers/extends\",{default:function(n){u=n}},1),t.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default:function(n){r=n}},2),t.link(\"react\",{default:function(n){i=n},useRef:function(n){l=n},useEffect:function(n){c=n}},0),t.link(\"react-i18next\",{useTranslation:function(n){s=n}},1),t.link(\"../../../../../app/livechat/client/lib/chartHandler\",{drawDoughnutChart:function(n){o=n}},2),t.link(\"../../../../hooks/useAsyncState\",{AsyncStatePhase:function(n){f=n}},3),t.link(\"../../../../hooks/useEndpointData\",{useEndpointData:function(n){d=n}},4),t.link(\"./Chart\",{default:function(n){v=n}},5),t.link(\"./useUpdateChartData\",{useUpdateChartData:function(n){h=n}},6);var b=[\"Available\",\"Away\",\"Busy\",\"Offline\"],k={available:0,away:0,busy:0,offline:0},y=function(n,e,t){return o(n,t(\"Agents\"),e,b.map(function(n){return t(n)}),Object.values(k))};t.exportDefault(function(n){var e=n.params,t=n.reloadRef,o=r(n,p),b=s().t,m=l(null),w=l(),x=h({context:w,canvas:m,t:b,init:y}),A=d(\"/v1/livechat/analytics/dashboards/charts/agents-status\",{params:e}),D=A.value,E=A.phase,g=A.reload;t.current.agentStatusChart=g;var C=null!=D?D:k,R=C.offline,O=void 0===R?0:R,S=C.available,P=void 0===S?0:S,j=C.away,B=void 0===j?0:j,U=C.busy,H=void 0===U?0:U;return c(function(){a.async(function(n){for(;;)switch(n.prev=n.next){case 0:if(m.current){n.next=2;break}return n.abrupt(\"return\");case 2:return n.next=4,a.awrap(y(m.current,w.current,b));case 4:w.current=n.sent;case 5:case\"end\":return n.stop()}},null,null,null,Promise)},[b]),c(function(){E===f.RESOLVED&&(x(b(\"Offline\"),[O]),x(b(\"Available\"),[P]),x(b(\"Away\"),[B]),x(b(\"Busy\"),[H]))},[P,B,H,O,E,b,x]),i.createElement(v,u({canvasRef:m},o))})}","map":"{\"version\":3,\"sources\":[\"client/views/omnichannel/realTimeMonitoring/charts/AgentStatusChart.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { Box } from '@rocket.chat/fuselage';\\nimport type { OperationParams } from '@rocket.chat/rest-typings';\\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\\nimport type * as chartjs from 'chart.js';\\nimport type { TFunction } from 'i18next';\\nimport type { ComponentPropsWithoutRef, MutableRefObject } from 'react';\\nimport React, { useRef, useEffect } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { drawDoughnutChart } from '../../../../../app/livechat/client/lib/chartHandler';\\nimport { AsyncStatePhase } from '../../../../hooks/useAsyncState';\\nimport { useEndpointData } from '../../../../hooks/useEndpointData';\\nimport Chart from './Chart';\\nimport { useUpdateChartData } from './useUpdateChartData';\\n\\nconst labels = ['Available', 'Away', 'Busy', 'Offline'];\\n\\nconst initialData = {\\n\\tavailable: 0,\\n\\taway: 0,\\n\\tbusy: 0,\\n\\toffline: 0,\\n};\\n\\nconst init = (canvas: HTMLCanvasElement, context: chartjs.Chart<'doughnut'> | undefined, t: TFunction) =>\\n\\tdrawDoughnutChart(\\n\\t\\tcanvas,\\n\\t\\tt('Agents'),\\n\\t\\tcontext,\\n\\t\\tlabels.map((l) => t(l as TranslationKey)),\\n\\t\\tObject.values(initialData),\\n\\t);\\n\\ntype AgentStatusChartsProps = {\\n\\tparams: OperationParams<'GET', '/v1/livechat/analytics/dashboards/charts/agents-status'>;\\n\\treloadRef: MutableRefObject<{ [x: string]: () => void }>;\\n} & Omit<ComponentPropsWithoutRef<typeof Box>, 'data'>;\\n\\nconst AgentStatusChart = ({ params, reloadRef, ...props }: AgentStatusChartsProps) => {\\n\\tconst { t } = useTranslation();\\n\\n\\tconst canvas: MutableRefObject<HTMLCanvasElement | null> = useRef(null);\\n\\tconst context: MutableRefObject<chartjs.Chart<'doughnut'> | undefined> = useRef();\\n\\n\\tconst updateChartData = useUpdateChartData({\\n\\t\\tcontext,\\n\\t\\tcanvas,\\n\\t\\tt,\\n\\t\\tinit,\\n\\t});\\n\\n\\tconst { value: data, phase: state, reload } = useEndpointData('/v1/livechat/analytics/dashboards/charts/agents-status', { params });\\n\\n\\treloadRef.current.agentStatusChart = reload;\\n\\n\\tconst { offline = 0, available = 0, away = 0, busy = 0 } = data ?? initialData;\\n\\n\\tuseEffect(() => {\\n\\t\\tconst initChart = async () => {\\n\\t\\t\\tif (!canvas.current) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tcontext.current = await init(canvas.current, context.current, t);\\n\\t\\t};\\n\\t\\tinitChart();\\n\\t}, [t]);\\n\\n\\tuseEffect(() => {\\n\\t\\tif (state === AsyncStatePhase.RESOLVED) {\\n\\t\\t\\tupdateChartData(t('Offline'), [offline]);\\n\\t\\t\\tupdateChartData(t('Available'), [available]);\\n\\t\\t\\tupdateChartData(t('Away'), [away]);\\n\\t\\t\\tupdateChartData(t('Busy'), [busy]);\\n\\t\\t}\\n\\t}, [available, away, busy, offline, state, t, updateChartData]);\\n\\n\\treturn <Chart canvasRef={canvas} {...props} />;\\n};\\n\\nexport default AgentStatusChart;\\n\",null],\"names\":[\"_regeneratorRuntime\",\"_extends\",\"_objectWithoutProperties\",\"React\",\"useRef\",\"useEffect\",\"useTranslation\",\"drawDoughnutChart\",\"AsyncStatePhase\",\"useEndpointData\",\"Chart\",\"useUpdateChartData\",\"module\",\"link\",\"default\",\"v\",\"labels\",\"initialData\",\"available\",\"away\",\"busy\",\"offline\",\"init\",\"canvas\",\"context\",\"t\",\"map\",\"l\",\"Object\",\"values\",\"exportDefault\",\"_ref\",\"params\",\"reloadRef\",\"props\",\"_excluded\",\"_useTranslation\",\"updateChartData\",\"_useEndpointData\",\"data\",\"value\",\"state\",\"phase\",\"reload\",\"current\",\"agentStatusChart\",\"_ref2\",\"_ref2$offline\",\"_ref2$available\",\"_ref2$away\",\"_ref2$busy\",\"async\",\"_context\",\"prev\",\"next\",\"abrupt\",\"awrap\",\"sent\",\"stop\",\"Promise\",\"RESOLVED\",\"createElement\",\"canvasRef\"],\"mappings\":\"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\"}"}