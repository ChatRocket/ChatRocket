{"code":"function module(e,t,r){let n,o,i,u,a,s,c,l;r.export({useVoipClient:()=>f},!0),r.link(\"@rocket.chat/ui-contexts\",{useUser(e){n=e},useEndpoint(e){o=e},useSetting(e){i=e}},0),r.link(\"@tanstack/react-query\",{useQuery(e){u=e}},1),r.link(\"react\",{useEffect(e){a=e},useRef(e){s=e}},2),r.link(\"../lib/VoipClient\",{default(e){c=e}},3),r.link(\"./useWebRtcServers\",{useWebRtcServers(e){l=e}},4);var d=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(u,a)}s((n=n.apply(e,t||[])).next())})};let f=({enabled:e=!0,autoRegister:t=!0}={})=>{let{_id:r}=n()||{},f=i(\"VoIP_TeamCollab_Enabled\"),h=s(null),v=o(\"GET\",\"/v1/voip-freeswitch.extension.getRegistrationInfoByUserId\"),w=l(),{data:p,error:b}=u([\"voip-client\",f,r,w],()=>d(void 0,void 0,void 0,function*(){if(h.current&&h.current.clear(),!r)throw Error(\"error-user-not-found\");let e=yield v({userId:r}).then(e=>{if(!e)throw Error(\"error-registration-not-found\");return e}).catch(e=>{throw Error(e.error||\"error-registration-not-found\")}),{extension:{extension:n},credentials:{websocketPath:o,password:i}}=e,u={iceServers:w,authUserName:n,authPassword:i,sipRegistrarHostnameOrIP:new URL(o).host,webSocketURI:o,connectionRetryCount:Number(10),enableKeepAliveUsingOptionsForUnstableNetworks:!0},a=yield c.create(u);return t&&a.register(),a}),{initialData:null,enabled:e});return a(()=>(h.current=p,()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.clear()}),[p]),{voipClient:p,error:b}}}","map":"{\"version\":3,\"sources\":[\"<anon>\"],\"names\":[],\"mappings\":\"\"}"}