{"code":"function module(e,s,t){let a,i,l,n,o,r,u,c;t.export({useLegacyThreadMessages:()=>d}),t.link(\"@rocket.chat/core-typings\",{isThreadMessage(e){a=e}},0),t.link(\"@rocket.chat/ui-contexts\",{useMethod(e){i=e}},1),t.link(\"react\",{useEffect(e){l=e},useState(e){n=e},useCallback(e){o=e}},2),t.link(\"../../../../../../app/models/client\",{Messages(e){r=e}},3),t.link(\"../../../../../../app/ui-utils/client/lib/RoomHistoryManager\",{upsertMessageBulk(e){u=e}},4),t.link(\"../../../../../hooks/useReactiveValue\",{useReactiveValue(e){c=e}},5);let d=e=>{let s=c(o(()=>r.find({$or:[{tmid:e},{_id:e}],_hidden:{$ne:!0},tmid:e,_id:{$ne:e}},{fields:{collapsed:0,threadMsg:0,repliesCount:0},sort:{ts:1}}).fetch().filter(a),[e])),[t,d]=n(!1),g=i(\"getThreadMessages\");return l(()=>{d(!0),g({tmid:e}).then(e=>{u({msgs:e},r),d(!1)})},[g,e]),{messages:s,loading:t}}}","map":"{\"version\":3,\"sources\":[\"client/views/room/contextualBar/Threads/hooks/useLegacyThreadMessages.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IThreadMessage, IThreadMainMessage } from '@rocket.chat/core-typings';\\nimport { isThreadMessage } from '@rocket.chat/core-typings';\\nimport { useMethod } from '@rocket.chat/ui-contexts';\\nimport { useEffect, useState, useCallback } from 'react';\\n\\nimport { Messages } from '../../../../../../app/models/client';\\nimport { upsertMessageBulk } from '../../../../../../app/ui-utils/client/lib/RoomHistoryManager';\\nimport { useReactiveValue } from '../../../../../hooks/useReactiveValue';\\n\\nexport const useLegacyThreadMessages = (\\n\\ttmid: IThreadMainMessage['_id'],\\n): {\\n\\tmessages: Array<IThreadMessage | IThreadMainMessage>;\\n\\tloading: boolean;\\n} => {\\n\\tconst messages = useReactiveValue(\\n\\t\\tuseCallback(() => {\\n\\t\\t\\treturn Messages.find(\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t$or: [{ tmid }, { _id: tmid }],\\n\\t\\t\\t\\t\\t_hidden: { $ne: true },\\n\\t\\t\\t\\t\\ttmid,\\n\\t\\t\\t\\t\\t_id: { $ne: tmid },\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\tfields: {\\n\\t\\t\\t\\t\\t\\tcollapsed: 0,\\n\\t\\t\\t\\t\\t\\tthreadMsg: 0,\\n\\t\\t\\t\\t\\t\\trepliesCount: 0,\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\tsort: { ts: 1 },\\n\\t\\t\\t\\t},\\n\\t\\t\\t)\\n\\t\\t\\t\\t.fetch()\\n\\t\\t\\t\\t.filter(isThreadMessage);\\n\\t\\t}, [tmid]),\\n\\t);\\n\\n\\tconst [loading, setLoading] = useState(false);\\n\\n\\tconst getThreadMessages = useMethod('getThreadMessages');\\n\\n\\tuseEffect(() => {\\n\\t\\tsetLoading(true);\\n\\t\\tgetThreadMessages({ tmid }).then((messages) => {\\n\\t\\t\\tupsertMessageBulk({ msgs: messages }, Messages);\\n\\t\\t\\tsetLoading(false);\\n\\t\\t});\\n\\t}, [getThreadMessages, tmid]);\\n\\n\\treturn { messages, loading };\\n};\\n\",null],\"names\":[\"isThreadMessage\",\"useMethod\",\"useEffect\",\"useState\",\"useCallback\",\"Messages\",\"upsertMessageBulk\",\"useReactiveValue\",\"module\",\"export\",\"useLegacyThreadMessages\",\"link\",\"v\",\"tmid\",\"messages\",\"find\",\"$or\",\"_id\",\"_hidden\",\"$ne\",\"fields\",\"collapsed\",\"threadMsg\",\"repliesCount\",\"sort\",\"ts\",\"fetch\",\"filter\",\"loading\",\"setLoading\",\"getThreadMessages\",\"then\",\"msgs\"],\"mappings\":\"2BAC4DA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA5DC,EAAOC,MAAE,CAAA,CAAAC,wBAAuBA,IAAAA,CAA4B,GAAAF,EAAAG,IAAA,CAAA,4BAAA,CAAAX,gBAAAY,CAAA,EAAAZ,EAAAY,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,2BAAA,CAAAV,UAAAW,CAAA,EAAAX,EAAAW,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,QAAA,CAAAT,UAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,SAAAS,CAAA,EAAAT,EAAAS,CAAA,EAAAR,YAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,sCAAA,CAAAN,SAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,+DAAA,CAAAL,kBAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,wCAAA,CAAAJ,iBAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAQrD,IAAMF,EACZG,IAKA,IAAMC,EAAWP,EAChBH,EAAY,IACJC,EAASU,IAAI,CACnB,CACCC,IAAK,CAAC,CAAEH,KAAAA,CAAI,EAAI,CAAEI,IAAKJ,CAAI,EAAG,CAC9BK,QAAS,CAAEC,IAAK,CAAA,CAAI,EACpBN,KAAAA,EACAI,IAAK,CAAEE,IAAKN,CAAI,GAEjB,CACCO,OAAQ,CACPC,UAAW,EACXC,UAAW,EACXC,aAAc,GAEfC,KAAM,CAAEC,GAAI,CAAC,IAGbC,KAAK,GACLC,MAAM,CAAC3B,GACP,CAACa,EAAK,GAGJ,CAACe,EAASC,EAAW,CAAG1B,EAAS,CAAA,GAEjC2B,EAAoB7B,EAAU,qBAUpC,OARAC,EAAU,KACT2B,EAAW,CAAA,GACXC,EAAkB,CAAEjB,KAAAA,CAAI,GAAIkB,IAAI,CAAEjB,IACjCR,EAAkB,CAAE0B,KAAMlB,CAAQ,EAAIT,GACtCwB,EAAW,CAAA,EACZ,EACD,EAAG,CAACC,EAAmBjB,EAAK,EAErB,CAAEC,SAAAA,EAAUc,QAAAA,CAAO,CAC3B\"}"}