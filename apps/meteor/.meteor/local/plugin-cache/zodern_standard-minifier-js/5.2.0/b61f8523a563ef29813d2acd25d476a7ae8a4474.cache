{"code":"function module(e,t,a){let r,l,n,i,s,c,u,o,d,h,f,b,m;let g=[\"departmentId\",\"dateRange\",\"chartName\"];a.link(\"@babel/runtime/helpers/extends\",{default(e){r=e}},0),a.link(\"@babel/runtime/helpers/objectSpread2\",{default(e){l=e}},1),a.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default(e){n=e}},2),a.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback(e){i=e}},0),a.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch(e){s=e},useMethod(e){c=e},useTranslation(e){u=e}},1),a.link(\"react\",{default(e){o=e},useRef(e){d=e},useEffect(e){h=e}},2),a.link(\"../../../../app/livechat/client/lib/chartHandler\",{drawLineChart(e){f=e}},3),a.link(\"../../../../lib/utils/secondsToHHMMSS\",{secondsToHHMMSS(e){b=e}},4),a.link(\"../realTimeMonitoring/charts/Chart\",{default(e){m=e}},5);let p=e=>{switch(e){case\"Avg_chat_duration\":case\"Avg_first_response_time\":case\"Best_first_response_time\":case\"Avg_response_time\":case\"Avg_reaction_time\":return{callbacks:{title(e){let[t]=e,{dataset:a}=t;return a.label},label(e){let{dataset:t,dataIndex:a}=e,r=t.data[a];return b(\"number\"==typeof r?r:0)}}};default:return{}}};a.exportDefault(e=>{let{departmentId:t,dateRange:a,chartName:b}=e,k=n(e,g),v=u(),_=s(),M=d(null),y=d(),{start:A,end:D}=a,w=c(\"livechat:getAnalyticsChartData\"),C=i(async e=>{try{var t,a;let r=p(b);if(!(null!=e&&null!==(t=e.daterange)&&void 0!==t&&t.from)||!(null!=e&&null!==(a=e.daterange)&&void 0!==a&&a.to))return;let l=await w(e);if(!(null!=l&&l.chartLabel)||!(null!=l&&l.dataLabels)||!(null!=l&&l.dataPoints))throw Error(\"Error! fetching chart data. Details: livechat:getAnalyticsChartData => Missing Data\");(y.current||void 0===y.current)&&M.current&&(y.current=await f(M.current,y.current,[l.chartLabel],l.dataLabels,[l.dataPoints],{tooltipCallbacks:r}))}catch(e){_({type:\"error\",message:e})}});return h(()=>{C(l({daterange:{from:A,to:D},chartOptions:{name:b}},t&&{departmentId:t}))},[b,t,C,D,A,v,w]),o.createElement(m,r({canvasRef:M},k))})}","map":"{\"version\":3,\"sources\":[\"client/views/omnichannel/analytics/InterchangeableChart.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useToastMessageDispatch, useMethod, useTranslation } from '@rocket.chat/ui-contexts';\\nimport type * as chartjs from 'chart.js';\\nimport React, { useRef, useEffect } from 'react';\\n\\nimport { drawLineChart } from '../../../../app/livechat/client/lib/chartHandler';\\nimport { secondsToHHMMSS } from '../../../../lib/utils/secondsToHHMMSS';\\nimport Chart from '../realTimeMonitoring/charts/Chart';\\n\\nconst getChartTooltips = (chartName: string) => {\\n\\tswitch (chartName) {\\n\\t\\tcase 'Avg_chat_duration':\\n\\t\\tcase 'Avg_first_response_time':\\n\\t\\tcase 'Best_first_response_time':\\n\\t\\tcase 'Avg_response_time':\\n\\t\\tcase 'Avg_reaction_time':\\n\\t\\t\\treturn {\\n\\t\\t\\t\\tcallbacks: {\\n\\t\\t\\t\\t\\ttitle([ctx]: [chartjs.TooltipItem<'line'>]) {\\n\\t\\t\\t\\t\\t\\tconst { dataset } = ctx;\\n\\t\\t\\t\\t\\t\\treturn dataset.label;\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\tlabel(ctx: chartjs.TooltipItem<'line'>) {\\n\\t\\t\\t\\t\\t\\tconst { dataset, dataIndex } = ctx;\\n\\t\\t\\t\\t\\t\\tconst item = dataset.data[dataIndex];\\n\\t\\t\\t\\t\\t\\treturn secondsToHHMMSS(typeof item === 'number' ? item : 0);\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t},\\n\\t\\t\\t};\\n\\t\\tdefault:\\n\\t\\t\\treturn {};\\n\\t}\\n};\\n\\nconst InterchangeableChart = ({\\n\\tdepartmentId,\\n\\tdateRange,\\n\\tchartName,\\n\\t...props\\n}: {\\n\\tdepartmentId: string;\\n\\tdateRange: { start: string; end: string };\\n\\tchartName: string;\\n\\tflexShrink: number;\\n\\th: string;\\n\\tw: string;\\n\\talignSelf: string;\\n}) => {\\n\\tconst t = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst canvas = useRef<HTMLCanvasElement | null>(null);\\n\\tconst context = useRef<chartjs.Chart<'line', number[], string>>();\\n\\n\\tconst { start, end } = dateRange;\\n\\n\\tconst loadData = useMethod('livechat:getAnalyticsChartData');\\n\\n\\tconst draw = useMutableCallback(async (params) => {\\n\\t\\ttry {\\n\\t\\t\\tconst tooltipCallbacks = getChartTooltips(chartName);\\n\\t\\t\\tif (!params?.daterange?.from || !params?.daterange?.to) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t\\tconst result = await loadData(params);\\n\\t\\t\\tif (!result?.chartLabel || !result?.dataLabels || !result?.dataPoints) {\\n\\t\\t\\t\\tthrow new Error('Error! fetching chart data. Details: livechat:getAnalyticsChartData => Missing Data');\\n\\t\\t\\t}\\n\\t\\t\\t(context.current || typeof context.current === 'undefined') &&\\n\\t\\t\\t\\tcanvas.current &&\\n\\t\\t\\t\\t(context.current = await drawLineChart(\\n\\t\\t\\t\\t\\tcanvas.current,\\n\\t\\t\\t\\t\\tcontext.current,\\n\\t\\t\\t\\t\\t[result.chartLabel],\\n\\t\\t\\t\\t\\tresult.dataLabels,\\n\\t\\t\\t\\t\\t[result.dataPoints],\\n\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\ttooltipCallbacks,\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t));\\n\\t\\t} catch (error) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t}\\n\\t});\\n\\n\\tuseEffect(() => {\\n\\t\\tdraw({\\n\\t\\t\\tdaterange: {\\n\\t\\t\\t\\tfrom: start,\\n\\t\\t\\t\\tto: end,\\n\\t\\t\\t},\\n\\t\\t\\tchartOptions: { name: chartName },\\n\\t\\t\\t...(departmentId && { departmentId }),\\n\\t\\t});\\n\\t}, [chartName, departmentId, draw, end, start, t, loadData]);\\n\\n\\treturn <Chart canvasRef={canvas} {...props} />;\\n};\\n\\nexport default InterchangeableChart;\\n\",null],\"names\":[\"_extends\",\"_objectSpread\",\"_objectWithoutProperties\",\"useMutableCallback\",\"useToastMessageDispatch\",\"useMethod\",\"useTranslation\",\"React\",\"useRef\",\"useEffect\",\"drawLineChart\",\"secondsToHHMMSS\",\"Chart\",\"module\",\"link\",\"default\",\"v\",\"getChartTooltips\",\"chartName\",\"callbacks\",\"title\",\"_ref\",\"ctx\",\"dataset\",\"label\",\"dataIndex\",\"item\",\"data\",\"exportDefault\",\"_ref2\",\"departmentId\",\"dateRange\",\"props\",\"_excluded\",\"t\",\"dispatchToastMessage\",\"canvas\",\"context\",\"start\",\"end\",\"loadData\",\"draw\",\"params\",\"_params$daterange\",\"_params$daterange2\",\"tooltipCallbacks\",\"daterange\",\"from\",\"to\",\"result\",\"chartLabel\",\"dataLabels\",\"dataPoints\",\"Error\",\"current\",\"error\",\"type\",\"message\",\"chartOptions\",\"name\",\"createElement\",\"canvasRef\"],\"mappings\":\"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\"}"}