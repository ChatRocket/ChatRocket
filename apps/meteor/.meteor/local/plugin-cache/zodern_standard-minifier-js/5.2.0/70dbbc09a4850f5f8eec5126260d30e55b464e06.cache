{"code":"function module(e,n,t){t.link(\"@babel/runtime/regenerator\",{default:function(e){r=e}},0),t.export({useResetTOTPAction:function(){return d}}),t.link(\"@rocket.chat/ui-contexts\",{useSetModal:function(e){s=e},usePermission:function(e){o=e},useSetting:function(e){c=e},useEndpoint:function(e){u=e},useTranslation:function(e){i=e},useToastMessageDispatch:function(e){a=e}},0),t.link(\"react\",{default:function(e){f=e},useCallback:function(e){l=e}},1),t.link(\"../../../../components/GenericModal\",{default:function(e){T=e}},2);var r,s,o,c,u,i,a,f,l,T,d=function(e){var n=i(),t=s(),d=a(),p=o(\"edit-other-user-totp\"),_=c(\"Accounts_TwoFactorAuthentication_Enabled\"),m=u(\"POST\",\"/v1/users.resetTOTP\"),h=l(function(){return r.async(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,r.awrap(m({userId:e}));case 3:d({type:\"success\",message:n(\"Users_TOTP_has_been_reset\")}),s.next=9;break;case 6:s.prev=6,s.t0=s.catch(0),d({type:\"error\",message:s.t0});case 9:return s.prev=9,t(),s.finish(9);case 12:case\"end\":return s.stop()}},null,null,[[0,6,9,12]],Promise)},[m,t,n,e,d]),v=l(function(){t(f.createElement(T,{variant:\"danger\",onConfirm:h,onCancel:function(){return t()},confirmText:n(\"Reset\")},n(\"TOTP_Reset_Other_Key_Warning\")))},[h,n,t]);return p&&_?{icon:\"key\",label:n(\"Reset_TOTP\"),action:v}:void 0}}","map":"{\"version\":3,\"sources\":[\"client/views/admin/users/hooks/useResetTOTPAction.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IUser } from '@rocket.chat/core-typings';\\nimport { useSetModal, usePermission, useSetting, useEndpoint, useTranslation, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport React, { useCallback } from 'react';\\n\\nimport GenericModal from '../../../../components/GenericModal';\\nimport type { Action } from '../../../hooks/useActionSpread';\\n\\nexport const useResetTOTPAction = (userId: IUser['_id']): Action | undefined => {\\n\\tconst t = useTranslation();\\n\\tconst setModal = useSetModal();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst canResetTOTP = usePermission('edit-other-user-totp');\\n\\tconst twoFactorEnabled = useSetting('Accounts_TwoFactorAuthentication_Enabled');\\n\\tconst resetTOTPRequest = useEndpoint('POST', '/v1/users.resetTOTP');\\n\\n\\tconst resetTOTP = useCallback(async () => {\\n\\t\\ttry {\\n\\t\\t\\tawait resetTOTPRequest({ userId });\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Users_TOTP_has_been_reset') });\\n\\t\\t} catch (error) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t} finally {\\n\\t\\t\\tsetModal();\\n\\t\\t}\\n\\t}, [resetTOTPRequest, setModal, t, userId, dispatchToastMessage]);\\n\\n\\tconst confirmResetTOTP = useCallback(() => {\\n\\t\\tsetModal(\\n\\t\\t\\t<GenericModal variant='danger' onConfirm={resetTOTP} onCancel={(): void => setModal()} confirmText={t('Reset')}>\\n\\t\\t\\t\\t{t('TOTP_Reset_Other_Key_Warning')}\\n\\t\\t\\t</GenericModal>,\\n\\t\\t);\\n\\t}, [resetTOTP, t, setModal]);\\n\\n\\treturn canResetTOTP && twoFactorEnabled\\n\\t\\t? {\\n\\t\\t\\t\\ticon: 'key',\\n\\t\\t\\t\\tlabel: t('Reset_TOTP'),\\n\\t\\t\\t\\taction: confirmResetTOTP,\\n\\t\\t  }\\n\\t\\t: undefined;\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"export\",\"useResetTOTPAction\",\"useSetModal\",\"usePermission\",\"useSetting\",\"useEndpoint\",\"useTranslation\",\"useToastMessageDispatch\",\"React\",\"useCallback\",\"GenericModal\",\"userId\",\"t\",\"setModal\",\"dispatchToastMessage\",\"canResetTOTP\",\"twoFactorEnabled\",\"resetTOTPRequest\",\"resetTOTP\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"type\",\"message\",\"t0\",\"finish\",\"stop\",\"Promise\",\"confirmResetTOTP\",\"createElement\",\"variant\",\"onConfirm\",\"onCancel\",\"confirmText\",\"icon\",\"label\",\"action\",\"undefined\"],\"mappings\":\"uBACsBA,EAAAC,IAAa,CAAA,6BAA2B,CAAAC,QAAA,SAAgBC,CAAA,EAAAC,EAAyBD,CAAA,CAAA,EAAM,GAA7GH,EAAOK,MAAE,CAAA,CAAAC,mBAAa,WAAe,OAAYA,CAAa,CAAA,GAA0EN,EAAAC,IAAA,CAAA,2BAAA,CAAAM,YAAA,SAAAJ,CAAA,EAAAI,EAAAJ,CAAA,EAAAK,cAAA,SAAAL,CAAA,EAAAK,EAAAL,CAAA,EAAAM,WAAA,SAAAN,CAAA,EAAAM,EAAAN,CAAA,EAAAO,YAAA,SAAAP,CAAA,EAAAO,EAAAP,CAAA,EAAAQ,eAAA,SAAAR,CAAA,EAAAQ,EAAAR,CAAA,EAAAS,wBAAA,SAAAT,CAAA,EAAAS,EAAAT,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAA,QAAA,SAAAE,CAAA,EAAAU,EAAAV,CAAA,EAAAW,YAAA,SAAAX,CAAA,EAAAW,EAAAX,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,sCAAA,CAAA,QAAA,SAAAE,CAAA,EAAAY,EAAAZ,CAAA,CAAA,EAAA,GAMjI,IANPC,EAA8EG,EAAAC,EAAyBC,EAAMC,EAAAC,EAA2BC,EAAAC,EAAAC,EAAAC,EAM3HT,EAAqB,SAACU,CAAoB,EACtD,IAAMC,EAAIN,IACJO,EAAWX,IACXY,EAAuBP,IACvBQ,EAAeZ,EAAc,wBAC7Ba,EAAmBZ,EAAW,4CAC9Ba,EAAmBZ,EAAY,OAAQ,uBAEvCa,EAAYT,EAAY,WAAA,OAAAV,EAAAoB,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,OAAAF,EAAAC,IAAA,CAAA,EAAAD,EAAAE,IAAA,CAAA,EAAAvB,EAAAwB,KAAA,CAEtBN,EAAiB,CAAEN,OAAAA,CAAM,GAAG,MAAA,EAClCG,EAAqB,CAAEU,KAAM,UAAWC,QAASb,EAAE,4BAA4B,GAAIQ,EAAAE,IAAA,CAAA,EAAA,KAAA,MAAA,EAAAF,EAAAC,IAAA,CAAA,EAAAD,EAAAM,EAAA,CAAAN,EAAA,KAAA,CAAA,GAEnFN,EAAqB,CAAEU,KAAM,QAASC,QAAOL,EAAAM,EAAAA,AAAO,EAAI,MAAA,EAE7C,OAF6CN,EAAAC,IAAA,CAAA,EAExDR,IAAWO,EAAAO,MAAA,CAAA,EAAA,MAAA,GAAA,IAAA,MAAA,OAAAP,EAAAQ,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,CAAA,CAAA,EAAA,EAAA,EAAA,GAAA,CAAA,CAAAC,QAAA,EAEV,CAACZ,EAAkBJ,EAAUD,EAAGD,EAAQG,EAAqB,EAE1DgB,EAAmBrB,EAAY,WACpCI,EACCL,EAAAuB,aAAA,CAACrB,EAAY,CAACsB,QAAQ,SAASC,UAAWf,EAAWgB,SAAU,WAAA,OAAYrB,GAAU,EAAEsB,YAAavB,EAAE,QAAS,EAC7GA,EAAE,iCAGN,EAAG,CAACM,EAAWN,EAAGC,EAAS,EAE3B,OAAOE,GAAgBC,EACpB,CACAoB,KAAM,MACNC,MAAOzB,EAAE,cACT0B,OAAQR,GAERS,KAAAA,CACJ\"}"}