{"code":"function module(e,a,t){let i,n,r;t.export({useMediaPermissions:()=>o}),t.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback(e){i=e}},0),t.link(\"react\",{useEffect(e){n=e},useState(e){r=e}},1);let s=e=>{switch(e){case\"camera\":return\"videoinput\";case\"microphone\":return\"audioinput\"}},o=e=>{let[a,t]=r(!1),o=i(async()=>{var a;if(navigator.permissions)try{let a=await navigator.permissions.query({name:e});t(\"denied\"===a.state),a.onchange=()=>{t(\"denied\"===a.state)};return}catch(e){console.warn(e)}if(!(null!==(a=navigator.mediaDevices)&&void 0!==a&&a.enumerateDevices)){t(!0);return}try{(await navigator.mediaDevices.enumerateDevices()).some(a=>{let{kind:t}=a;return t===s(e)})||t(!0)}catch(e){console.warn(e)}});return n(()=>{o()},[o]),[a,t]}}","map":"{\"version\":3,\"sources\":[\"client/views/room/composer/messageBox/hooks/useMediaPermissions.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useEffect, useState } from 'react';\\n\\ntype MediaDevices = 'camera' | 'microphone';\\n\\nconst getDeviceKind = (name: MediaDevices): MediaDeviceKind => {\\n\\tswitch (name) {\\n\\t\\tcase 'camera':\\n\\t\\t\\treturn 'videoinput';\\n\\t\\tcase 'microphone':\\n\\t\\t\\treturn 'audioinput';\\n\\t}\\n};\\n\\nexport const useMediaPermissions = (name: MediaDevices): [isPermissionDenied: boolean, setIsPermissionDenied: (state: boolean) => void] => {\\n\\tconst [isPermissionDenied, setIsPermissionDenied] = useState(false);\\n\\n\\tconst handleMount = useMutableCallback(async (): Promise<void> => {\\n\\t\\tif (navigator.permissions) {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tconst permissionStatus = await navigator.permissions.query({ name: name as PermissionName });\\n\\t\\t\\t\\tsetIsPermissionDenied(permissionStatus.state === 'denied');\\n\\t\\t\\t\\tpermissionStatus.onchange = (): void => {\\n\\t\\t\\t\\t\\tsetIsPermissionDenied(permissionStatus.state === 'denied');\\n\\t\\t\\t\\t};\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tconsole.warn(error);\\n\\t\\t\\t}\\n\\t\\t}\\n\\n\\t\\tif (!navigator.mediaDevices?.enumerateDevices) {\\n\\t\\t\\tsetIsPermissionDenied(true);\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\ttry {\\n\\t\\t\\tif (!(await navigator.mediaDevices.enumerateDevices()).some(({ kind }) => kind === getDeviceKind(name))) {\\n\\t\\t\\t\\tsetIsPermissionDenied(true);\\n\\t\\t\\t}\\n\\t\\t} catch (error) {\\n\\t\\t\\tconsole.warn(error);\\n\\t\\t}\\n\\t});\\n\\n\\tuseEffect(() => {\\n\\t\\thandleMount();\\n\\t}, [handleMount]);\\n\\n\\treturn [isPermissionDenied, setIsPermissionDenied];\\n};\\n\",null],\"names\":[\"useMutableCallback\",\"useEffect\",\"useState\",\"module\",\"export\",\"useMediaPermissions\",\"link\",\"v\",\"getDeviceKind\",\"name\",\"isPermissionDenied\",\"setIsPermissionDenied\",\"handleMount\",\"_navigator$mediaDevic\",\"navigator\",\"permissions\",\"permissionStatus\",\"query\",\"state\",\"onchange\",\"error\",\"console\",\"warn\",\"mediaDevices\",\"enumerateDevices\",\"some\",\"_ref\",\"kind\"],\"mappings\":\"2BAAiEA,EAAAC,EAAAC,EAAjEC,EAAOC,MAAE,CAAA,CAAAC,oBAA0BA,IAAAA,CAAA,GAA8BF,EAAAG,IAAA,CAAA,8BAAA,CAAAN,mBAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,QAAA,CAAAL,UAAAM,CAAA,EAAAN,EAAAM,CAAA,EAAAL,SAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAKjE,IAAMC,EAAiBC,IACtB,OAAQA,GACP,IAAK,SACJ,MAAO,YACR,KAAK,aACJ,MAAO,YACT,CACD,EAEaJ,EAAuBI,IACnC,GAAM,CAACC,EAAoBC,EAAsB,CAAGT,EAAS,CAAA,GAEvDU,EAAcZ,EAAmB,UAA0B,IAAAa,EAChE,GAAIC,UAAUC,WAAW,CACxB,GAAI,CACH,IAAMC,EAAmB,MAAMF,UAAUC,WAAW,CAACE,KAAK,CAAC,CAAER,KAAMA,CAAsB,GACzFE,EAAsBK,AAA2B,WAA3BA,EAAiBE,KAAK,EAC5CF,EAAiBG,QAAQ,CAAG,KAC3BR,EAAsBK,AAA2B,WAA3BA,EAAiBE,KAAK,CAC7C,EACA,MACD,CAAE,MAAOE,EAAO,CACfC,QAAQC,IAAI,CAACF,EACd,CAGD,GAAI,CAAA,CAAA,AAAuB,OAAvBP,CAAAA,EAACC,UAAUS,YAAY,AAAZA,GAAYV,AAAA,KAAA,IAAAA,GAAtBA,EAAwBW,gBAAgB,AAAhBA,EAAkB,CAC9Cb,EAAsB,CAAA,GACtB,MACD,CAEA,GAAI,CACE,AAAC,CAAA,MAAMG,UAAUS,YAAY,CAACC,gBAAgB,EAAA,EAAIC,IAAI,CAACC,IAAA,GAAC,CAAEC,KAAAA,CAAAA,CAAM,CAAAD,EAAA,OAAKC,IAASnB,EAAcC,EAAK,IACrGE,EAAsB,CAAA,EAExB,CAAE,MAAOS,EAAO,CACfC,QAAQC,IAAI,CAACF,EACd,CACD,GAMA,OAJAnB,EAAU,KACTW,GACD,EAAG,CAACA,EAAY,EAET,CAACF,EAAoBC,EAAsB,AACnD\"}"}