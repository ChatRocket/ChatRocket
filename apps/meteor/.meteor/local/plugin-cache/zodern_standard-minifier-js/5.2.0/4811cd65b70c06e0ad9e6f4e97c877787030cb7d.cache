{"code":"function module(e,n,t){var r,i,a,l,o,u,c,s,d,f,m,v,E,k,S,x,p,g,y,h,C,F,b,M;t.link(\"@babel/runtime/regenerator\",{default:function(e){r=e}},0),t.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){i=e}},1),t.link(\"@rocket.chat/fuselage\",{Divider:function(e){a=e},Modal:function(e){l=e},ButtonGroup:function(e){o=e},Button:function(e){u=e},Field:function(e){c=e},FieldLabel:function(e){s=e},FieldRow:function(e){d=e},FieldError:function(e){f=e},FieldHint:function(e){m=e},TextInput:function(e){v=e}},0),t.link(\"@rocket.chat/fuselage-hooks\",{useUniqueId:function(e){E=e}},1),t.link(\"@rocket.chat/ui-contexts\",{useSetModal:function(e){k=e},useTranslation:function(e){S=e},useEndpoint:function(e){x=e},useToastMessageDispatch:function(e){p=e}},2),t.link(\"@tanstack/react-query\",{useMutation:function(e){g=e},useQueryClient:function(e){y=e}},3),t.link(\"react\",{default:function(e){h=e},useState:function(e){C=e}},4),t.link(\"./MatrixFederationRemoveServerList\",{default:function(e){F=e}},5),t.link(\"./MatrixFederationSearch\",{default:function(e){b=e}},6),t.link(\"./useMatrixServerList\",{useMatrixServerList:function(e){M=e}},7),t.exportDefault(function(e){var n=e.onClickClose,t=S(),_=x(\"POST\",\"/v1/federation/addServerByUser\"),T=C(\"\"),L=i(T,2),B=L[0],U=L[1],w=C(),D=i(w,2),H=D[0],q=D[1],A=k(),I=y(),P=p(),Q=g([\"v1/federation/addServerByUser\",B],function(){return _({serverName:B})},{onSuccess:function(){return r.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.awrap(I.invalidateQueries([\"federation/listServersByUsers\"]));case 2:A(h.createElement(b,{defaultSelectedServer:B,onClose:n,key:B}));case 3:case\"end\":return e.stop()}},null,null,null,Promise)},onError:function(e){var n=e?\"invalid-server-name\"===e.error?\"Server_doesnt_exist\":\"invalid-server-name\"===e.error?\"Server_already_added\":void 0:void 0;if(!n){P({type:\"error\",message:e});return}q(n)}}),R=Q.mutate,G=Q.isLoading,N=Q.isError,O=M(),j=O.data,z=O.isLoading,J=E(),K=E();return h.createElement(l,{maxHeight:\"x600\",open:!0,\"aria-labelledby\":J},h.createElement(l.Header,null,h.createElement(l.Title,{id:J},t(\"Manage_servers\")),h.createElement(l.Close,{onClick:n})),h.createElement(l.Content,null,h.createElement(c,null,h.createElement(s,{htmlFor:K},t(\"Server_name\")),h.createElement(d,null,h.createElement(v,{id:K,disabled:G,value:B,onChange:function(e){U(e.currentTarget.value),H&&q(void 0)},mie:4}),h.createElement(u,{primary:!0,loading:G,onClick:function(){return R()}},t(\"Add\"))),N&&H&&h.createElement(f,null,t(H)),h.createElement(m,null,t(\"Federation_Example_matrix_server\"))),h.createElement(a,{mb:16}),!z&&(null==j?void 0:j.servers)&&h.createElement(F,{servers:j.servers})),h.createElement(l.Footer,null,h.createElement(o,null,h.createElement(u,{onClick:n},t(\"Cancel\")))))})}","map":"{\"version\":3,\"sources\":[\"client/sidebar/header/MatrixFederationSearch/MatrixFederationManageServerModal.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Divider, Modal, ButtonGroup, Button, Field, FieldLabel, FieldRow, FieldError, FieldHint, TextInput } from '@rocket.chat/fuselage';\\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\\nimport { useSetModal, useTranslation, useEndpoint, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\\nimport type { FormEvent } from 'react';\\nimport React, { useState } from 'react';\\n\\nimport MatrixFederationRemoveServerList from './MatrixFederationRemoveServerList';\\nimport MatrixFederationSearch from './MatrixFederationSearch';\\nimport { useMatrixServerList } from './useMatrixServerList';\\n\\ntype MatrixFederationAddServerModalProps = {\\n\\tonClickClose: () => void;\\n};\\n\\nconst getErrorKey = (error: any): TranslationKey | undefined => {\\n\\tif (!error) {\\n\\t\\treturn;\\n\\t}\\n\\tif (error.error === 'invalid-server-name') {\\n\\t\\treturn 'Server_doesnt_exist';\\n\\t}\\n\\tif (error.error === 'invalid-server-name') {\\n\\t\\treturn 'Server_already_added';\\n\\t}\\n};\\n\\nconst MatrixFederationAddServerModal = ({ onClickClose }: MatrixFederationAddServerModalProps) => {\\n\\tconst t = useTranslation();\\n\\tconst addMatrixServer = useEndpoint('POST', '/v1/federation/addServerByUser');\\n\\tconst [serverName, setServerName] = useState('');\\n\\tconst [errorKey, setErrorKey] = useState<TranslationKey | undefined>();\\n\\tconst setModal = useSetModal();\\n\\tconst queryClient = useQueryClient();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst {\\n\\t\\tmutate: addServer,\\n\\t\\tisLoading,\\n\\t\\tisError,\\n\\t} = useMutation(['v1/federation/addServerByUser', serverName], () => addMatrixServer({ serverName }), {\\n\\t\\tonSuccess: async () => {\\n\\t\\t\\tawait queryClient.invalidateQueries(['federation/listServersByUsers']);\\n\\t\\t\\tsetModal(<MatrixFederationSearch defaultSelectedServer={serverName} onClose={onClickClose} key={serverName} />);\\n\\t\\t},\\n\\t\\tonError: (error) => {\\n\\t\\t\\tconst errorKey = getErrorKey(error);\\n\\t\\t\\tif (!errorKey) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t\\tsetErrorKey(errorKey);\\n\\t\\t},\\n\\t});\\n\\n\\tconst { data, isLoading: isLoadingServerList } = useMatrixServerList();\\n\\n\\tconst titleId = useUniqueId();\\n\\tconst serverNameId = useUniqueId();\\n\\n\\treturn (\\n\\t\\t<Modal maxHeight='x600' open aria-labelledby={titleId}>\\n\\t\\t\\t<Modal.Header>\\n\\t\\t\\t\\t<Modal.Title id={titleId}>{t('Manage_servers')}</Modal.Title>\\n\\t\\t\\t\\t<Modal.Close onClick={onClickClose} />\\n\\t\\t\\t</Modal.Header>\\n\\t\\t\\t<Modal.Content>\\n\\t\\t\\t\\t<Field>\\n\\t\\t\\t\\t\\t<FieldLabel htmlFor={serverNameId}>{t('Server_name')}</FieldLabel>\\n\\t\\t\\t\\t\\t<FieldRow>\\n\\t\\t\\t\\t\\t\\t<TextInput\\n\\t\\t\\t\\t\\t\\t\\tid={serverNameId}\\n\\t\\t\\t\\t\\t\\t\\tdisabled={isLoading}\\n\\t\\t\\t\\t\\t\\t\\tvalue={serverName}\\n\\t\\t\\t\\t\\t\\t\\tonChange={(e: FormEvent<HTMLInputElement>) => {\\n\\t\\t\\t\\t\\t\\t\\t\\tsetServerName(e.currentTarget.value);\\n\\t\\t\\t\\t\\t\\t\\t\\tif (errorKey) {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tsetErrorKey(undefined);\\n\\t\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t\\t}}\\n\\t\\t\\t\\t\\t\\t\\tmie={4}\\n\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t<Button primary loading={isLoading} onClick={() => addServer()}>\\n\\t\\t\\t\\t\\t\\t\\t{t('Add')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t\\t\\t{isError && errorKey && <FieldError>{t(errorKey)}</FieldError>}\\n\\t\\t\\t\\t\\t<FieldHint>{t('Federation_Example_matrix_server')}</FieldHint>\\n\\t\\t\\t\\t</Field>\\n\\t\\t\\t\\t<Divider mb={16} />\\n\\t\\t\\t\\t{!isLoadingServerList && data?.servers && <MatrixFederationRemoveServerList servers={data.servers} />}\\n\\t\\t\\t</Modal.Content>\\n\\t\\t\\t<Modal.Footer>\\n\\t\\t\\t\\t<ButtonGroup>\\n\\t\\t\\t\\t\\t<Button onClick={onClickClose}>{t('Cancel')}</Button>\\n\\t\\t\\t\\t</ButtonGroup>\\n\\t\\t\\t</Modal.Footer>\\n\\t\\t</Modal>\\n\\t);\\n};\\n\\nexport default MatrixFederationAddServerModal;\\n\",null],\"names\":[\"_regeneratorRuntime\",\"_slicedToArray\",\"Divider\",\"Modal\",\"ButtonGroup\",\"Button\",\"Field\",\"FieldLabel\",\"FieldRow\",\"FieldError\",\"FieldHint\",\"TextInput\",\"useUniqueId\",\"useSetModal\",\"useTranslation\",\"useEndpoint\",\"useToastMessageDispatch\",\"useMutation\",\"useQueryClient\",\"React\",\"useState\",\"MatrixFederationRemoveServerList\",\"MatrixFederationSearch\",\"useMatrixServerList\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"onClickClose\",\"t\",\"addMatrixServer\",\"_useState\",\"_useState2\",\"serverName\",\"setServerName\",\"_useState3\",\"_useState4\",\"errorKey\",\"setErrorKey\",\"setModal\",\"queryClient\",\"dispatchToastMessage\",\"_useMutation\",\"onSuccess\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"invalidateQueries\",\"createElement\",\"defaultSelectedServer\",\"onClose\",\"key\",\"stop\",\"Promise\",\"onError\",\"error\",\"type\",\"message\",\"addServer\",\"mutate\",\"isLoading\",\"isError\",\"_useMatrixServerList\",\"data\",\"isLoadingServerList\",\"titleId\",\"serverNameId\",\"maxHeight\",\"open\",\"Header\",\"Title\",\"id\",\"Close\",\"onClick\",\"Content\",\"htmlFor\",\"disabled\",\"value\",\"onChange\",\"e\",\"currentTarget\",\"undefined\",\"mie\",\"primary\",\"loading\",\"mb\",\"servers\",\"Footer\"],\"mappings\":\"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\"}"}