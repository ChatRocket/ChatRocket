{"code":"function module(e,n,t){var o,i,u,s,a,l,r,c,d,f,m,k,b,v,I,T,p,g,C,h,x,y,D,L,E;t.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){i=e}},0),t.link(\"@rocket.chat/core-typings\",{isRoomFederated:function(e){u=e},isDirectMessageRoom:function(e){s=e},isTeamRoom:function(e){a=e}},0),t.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback:function(e){l=e},useDebouncedValue:function(e){r=e},useLocalStorage:function(e){c=e}},1),t.link(\"@rocket.chat/ui-contexts\",{useUserRoom:function(e){d=e},useAtLeastOnePermission:function(e){f=e},useUser:function(e){m=e},usePermission:function(e){k=e},useUserSubscription:function(e){b=e}},2),t.link(\"react\",{default:function(e){v=e},useCallback:function(e){I=e},useMemo:function(e){T=e},useState:function(e){p=e}},3),t.link(\"../../../../lib/federation/Federation\",{\"*\":function(e){g=e}},4),t.link(\"../../../hooks/useMembersList\",{useMembersList:function(e){C=e}},5),t.link(\"../../contexts/RoomToolboxContext\",{useRoomToolbox:function(e){h=e}},6),t.link(\"../UserInfo\",{default:function(e){x=e}},7),t.link(\"./AddUsers\",{default:function(e){y=e}},8),t.link(\"./InviteUsers\",{default:function(e){D=e}},9),t.link(\"./RoomMembers\",{default:function(e){L=e}},10),(o=E||(E={})).INFO=\"user-info\",o.INVITE=\"invite-users\",o.ADD=\"add-users\",o.LIST=\"users-list\",t.exportDefault(function(e){var n,t,o,M=e.rid,N=m(),A=d(M),R=h().closeTab,U=c(\"members-list-type\",\"online\"),S=i(U,2),F=S[0],V=S[1],B=p(\"\"),O=i(B,2),P=O[0],j=O[1],w=b(M),q=A&&a(A),z=A&&s(A),G=k(\"create-invite-links\",M),H=A&&u(A),J=A&&N&&H?g.canCreateInviteLinks(N,A,w):G,K=p({tab:E.LIST,userId:void 0}),Q=i(K,2),W=Q[0],X=Q[1],Y=r(P,800),Z=C(T(function(){return{rid:M,type:F,limit:50,debouncedText:Y,roomType:null==A?void 0:A.t}},[M,F,Y,null==A?void 0:A.t])),$=Z.data,_=Z.fetchNextPage,ee=Z.isLoading,en=Z.refetch,et=Z.hasNextPage,eo=f(T(function(){return[(null==A?void 0:A.t)===\"p\"?\"add-user-to-any-p-room\":\"add-user-to-any-c-room\",\"add-user-to-joined-room\"]},[null==A?void 0:A.t]),M),ei=A&&N&&H?g.isEditableByTheUser(N,A,w):eo,eu=I(function(e){j(e.currentTarget.value)},[]),es=l(function(e){var n=e.currentTarget.dataset.userid;X({tab:E.INFO,userId:n})}),ea=l(function(){X({tab:E.INVITE})}),el=l(function(){X({tab:E.ADD})}),er=I(function(){X({tab:E.LIST})},[X]);return W.tab===E.INFO&&W.userId?v.createElement(x,{rid:M,uid:W.userId,onClose:R,onClickBack:er}):W.tab===E.INVITE?v.createElement(D,{rid:M,onClickBack:er}):W.tab===E.ADD?v.createElement(y,{rid:M,onClickBack:er,reload:en}):v.createElement(L,{rid:M,isTeam:q,isDirect:z,loading:ee,type:F,text:P,setText:eu,setType:V,members:null!==(n=null==$?void 0:null===(t=$.pages)||void 0===t?void 0:t.flatMap(function(e){return e.members}))&&void 0!==n?n:[],total:null!==(o=null==$?void 0:$.pages[$.pages.length-1].total)&&void 0!==o?o:0,onClickClose:R,onClickView:es,loadMoreItems:et?_:function(){},reload:en,onClickInvite:J&&ei?ea:void 0,onClickAdd:ei?el:void 0})})}","map":"{\"version\":3,\"sources\":[\"client/views/room/contextualBar/RoomMembers/RoomMembersWithData.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom, IUser } from '@rocket.chat/core-typings';\\nimport { isRoomFederated, isDirectMessageRoom, isTeamRoom } from '@rocket.chat/core-typings';\\nimport { useMutableCallback, useDebouncedValue, useLocalStorage } from '@rocket.chat/fuselage-hooks';\\nimport { useUserRoom, useAtLeastOnePermission, useUser, usePermission, useUserSubscription } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement } from 'react';\\nimport React, { useCallback, useMemo, useState } from 'react';\\n\\nimport * as Federation from '../../../../lib/federation/Federation';\\nimport { useMembersList } from '../../../hooks/useMembersList';\\nimport { useRoomToolbox } from '../../contexts/RoomToolboxContext';\\nimport UserInfoWithData from '../UserInfo';\\nimport AddUsers from './AddUsers';\\nimport InviteUsers from './InviteUsers';\\nimport RoomMembers from './RoomMembers';\\n\\nenum ROOM_MEMBERS_TABS {\\n\\tINFO = 'user-info',\\n\\tINVITE = 'invite-users',\\n\\tADD = 'add-users',\\n\\tLIST = 'users-list',\\n}\\n\\ntype validRoomType = 'd' | 'p' | 'c';\\n\\nconst RoomMembersWithData = ({ rid }: { rid: IRoom['_id'] }): ReactElement => {\\n\\tconst user = useUser();\\n\\tconst room = useUserRoom(rid);\\n\\tconst { closeTab } = useRoomToolbox();\\n\\tconst [type, setType] = useLocalStorage<'online' | 'all'>('members-list-type', 'online');\\n\\tconst [text, setText] = useState('');\\n\\tconst subscription = useUserSubscription(rid);\\n\\n\\tconst isTeam = room && isTeamRoom(room);\\n\\tconst isDirect = room && isDirectMessageRoom(room);\\n\\tconst hasPermissionToCreateInviteLinks = usePermission('create-invite-links', rid);\\n\\tconst isFederated = room && isRoomFederated(room);\\n\\n\\tconst canCreateInviteLinks =\\n\\t\\troom && user && isFederated ? Federation.canCreateInviteLinks(user, room, subscription) : hasPermissionToCreateInviteLinks;\\n\\n\\tconst [state, setState] = useState<{ tab: ROOM_MEMBERS_TABS; userId?: IUser['_id'] }>({\\n\\t\\ttab: ROOM_MEMBERS_TABS.LIST,\\n\\t\\tuserId: undefined,\\n\\t});\\n\\n\\tconst debouncedText = useDebouncedValue(text, 800);\\n\\n\\tconst { data, fetchNextPage, isLoading, refetch, hasNextPage } = useMembersList(\\n\\t\\tuseMemo(() => ({ rid, type, limit: 50, debouncedText, roomType: room?.t as validRoomType }), [rid, type, debouncedText, room?.t]),\\n\\t);\\n\\n\\tconst hasPermissionToAddUsers = useAtLeastOnePermission(\\n\\t\\tuseMemo(() => [room?.t === 'p' ? 'add-user-to-any-p-room' : 'add-user-to-any-c-room', 'add-user-to-joined-room'], [room?.t]),\\n\\t\\trid,\\n\\t);\\n\\n\\tconst canAddUsers = room && user && isFederated ? Federation.isEditableByTheUser(user, room, subscription) : hasPermissionToAddUsers;\\n\\n\\tconst handleTextChange = useCallback((event) => {\\n\\t\\tsetText(event.currentTarget.value);\\n\\t}, []);\\n\\n\\tconst openUserInfo = useMutableCallback((e) => {\\n\\t\\tconst { userid } = e.currentTarget.dataset;\\n\\t\\tsetState({\\n\\t\\t\\ttab: ROOM_MEMBERS_TABS.INFO,\\n\\t\\t\\tuserId: userid,\\n\\t\\t});\\n\\t});\\n\\n\\tconst openInvite = useMutableCallback(() => {\\n\\t\\tsetState({ tab: ROOM_MEMBERS_TABS.INVITE });\\n\\t});\\n\\n\\tconst openAddUser = useMutableCallback(() => {\\n\\t\\tsetState({ tab: ROOM_MEMBERS_TABS.ADD });\\n\\t});\\n\\n\\tconst handleBack = useCallback(() => {\\n\\t\\tsetState({ tab: ROOM_MEMBERS_TABS.LIST });\\n\\t}, [setState]);\\n\\n\\tif (state.tab === ROOM_MEMBERS_TABS.INFO && state.userId) {\\n\\t\\treturn <UserInfoWithData rid={rid} uid={state.userId} onClose={closeTab} onClickBack={handleBack} />;\\n\\t}\\n\\n\\tif (state.tab === ROOM_MEMBERS_TABS.INVITE) {\\n\\t\\treturn <InviteUsers rid={rid} onClickBack={handleBack} />;\\n\\t}\\n\\n\\tif (state.tab === ROOM_MEMBERS_TABS.ADD) {\\n\\t\\treturn <AddUsers rid={rid} onClickBack={handleBack} reload={refetch} />;\\n\\t}\\n\\n\\treturn (\\n\\t\\t<RoomMembers\\n\\t\\t\\trid={rid}\\n\\t\\t\\tisTeam={isTeam}\\n\\t\\t\\tisDirect={isDirect}\\n\\t\\t\\tloading={isLoading}\\n\\t\\t\\ttype={type}\\n\\t\\t\\ttext={text}\\n\\t\\t\\tsetText={handleTextChange}\\n\\t\\t\\tsetType={setType}\\n\\t\\t\\tmembers={data?.pages?.flatMap((page) => page.members) ?? []}\\n\\t\\t\\ttotal={data?.pages[data.pages.length - 1].total ?? 0}\\n\\t\\t\\tonClickClose={closeTab}\\n\\t\\t\\tonClickView={openUserInfo}\\n\\t\\t\\tloadMoreItems={hasNextPage ? fetchNextPage : () => undefined}\\n\\t\\t\\treload={refetch}\\n\\t\\t\\tonClickInvite={canCreateInviteLinks && canAddUsers ? openInvite : undefined}\\n\\t\\t\\tonClickAdd={canAddUsers ? openAddUser : undefined}\\n\\t\\t/>\\n\\t);\\n};\\n\\nexport default RoomMembersWithData;\\n\",null],\"names\":[\"ROOM_MEMBERS_TABS\",\"_slicedToArray\",\"isRoomFederated\",\"isDirectMessageRoom\",\"isTeamRoom\",\"useMutableCallback\",\"useDebouncedValue\",\"useLocalStorage\",\"useUserRoom\",\"useAtLeastOnePermission\",\"useUser\",\"usePermission\",\"useUserSubscription\",\"React\",\"useCallback\",\"useMemo\",\"useState\",\"Federation\",\"useMembersList\",\"useRoomToolbox\",\"UserInfoWithData\",\"AddUsers\",\"InviteUsers\",\"RoomMembers\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"_data$pages$flatMap\",\"_data$pages\",\"_data$pages$total\",\"rid\",\"user\",\"room\",\"closeTab\",\"_useRoomToolbox\",\"_useLocalStorage\",\"_useLocalStorage2\",\"type\",\"setType\",\"_useState\",\"_useState2\",\"text\",\"setText\",\"subscription\",\"isTeam\",\"isDirect\",\"hasPermissionToCreateInviteLinks\",\"isFederated\",\"canCreateInviteLinks\",\"_useState3\",\"tab\",\"LIST\",\"userId\",\"undefined\",\"_useState4\",\"state\",\"setState\",\"debouncedText\",\"_useMembersList\",\"limit\",\"roomType\",\"t\",\"data\",\"fetchNextPage\",\"isLoading\",\"refetch\",\"hasNextPage\",\"hasPermissionToAddUsers\",\"canAddUsers\",\"isEditableByTheUser\",\"handleTextChange\",\"event\",\"currentTarget\",\"value\",\"openUserInfo\",\"e\",\"userid\",\"dataset\",\"INFO\",\"openInvite\",\"INVITE\",\"openAddUser\",\"ADD\",\"handleBack\",\"createElement\",\"uid\",\"onClose\",\"onClickBack\",\"reload\",\"loading\",\"members\",\"pages\",\"flatMap\",\"page\",\"total\",\"length\",\"onClickClose\",\"onClickView\",\"loadMoreItems\",\"onClickInvite\",\"onClickAdd\"],\"mappings\":\"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\"}"}