{"code":"function module(e,o,t){let r,n,s,i,a,l,m,c,d,u,k,_,v,f,b,h,p,g;t.link(\"@babel/runtime/helpers/objectSpread2\",{default(e){r=e}},0),t.export({useRemoveUserAction:()=>I}),t.link(\"@rocket.chat/core-typings\",{isRoomFederated(e){n=e}},0),t.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback(e){s=e}},1),t.link(\"@rocket.chat/string-helpers\",{escapeHTML(e){i=e}},2),t.link(\"@rocket.chat/ui-contexts\",{usePermission(e){a=e},useSetModal(e){l=e},useTranslation(e){m=e},useUser(e){c=e},useUserRoom(e){d=e},useUserSubscription(e){u=e}},3),t.link(\"react\",{default(e){k=e},useMemo(e){_=e}},4),t.link(\"../../../../../components/GenericModal\",{default(e){v=e}},5),t.link(\"../../../../../hooks/useEndpointAction\",{useEndpointAction(e){f=e}},6),t.link(\"../../../../../lib/federation/Federation\",{\"*\"(e){b=e}},7),t.link(\"../../../../../lib/rooms/roomCoordinator\",{roomCoordinator(e){h=e}},8),t.link(\"../../../../teams/contextualBar/members/RemoveUsersModal\",{default(e){p=e}},9),t.link(\"../../../lib/getRoomDirectives\",{getRoomDirectives(e){g=e}},10);let I=(e,o,t)=>{let I=d(o);if(!I)throw Error(\"Room not provided\");let M=m(),C=c(),R=u(o),{_id:U}=e,T=a(\"remove-user\",o),y=n(I)?b.isEditableByTheUser(C||void 0,I,R):T,E=l(),S=s(()=>E(null)),w=(null==I?void 0:I.t)&&i(h.getRoomName(I.t,I)),{roomCanRemove:x}=g({room:I,showingUserId:U,userSubscription:R}),A=f(\"POST\",\"/v1/teams.removeMember\",{successMessage:M(\"User_has_been_removed_from_team\")}),O=\"p\"===I.t?\"/v1/groups.kick\":\"/v1/channels.kick\",P=f(\"POST\",O,{successMessage:M(\"User_has_been_removed_from_s\",w)}),j=s(()=>{let e=async e=>{if(I.teamId){let o=Object.keys(e);await A(r({teamId:I.teamId,userId:U},o.length&&{rooms:o})),S(),null==t||t()}},n=async(e,o)=>{await P({roomId:e,userId:o}),S(),null==t||t()};if(I.teamMain&&I.teamId)return E(k.createElement(p,{teamId:null==I?void 0:I.teamId,userId:U,onClose:S,onCancel:S,onConfirm:e}));E(k.createElement(v,{variant:\"danger\",confirmText:M(\"Yes_remove_user\"),onClose:S,onCancel:S,onConfirm:()=>n(o,U)},M(\"The_user_will_be_removed_from_s\",w)))}),B=_(()=>x&&y?{content:null!=I&&I.teamMain?M(\"Remove_from_team\"):M(\"Remove_from_room\"),icon:\"cross\",onClick:j,type:\"moderation\",variant:\"danger\"}:void 0,[I,x,y,j,M]);return B}}","map":"{\"version\":3,\"sources\":[\"client/views/room/hooks/useUserInfoActions/actions/useRemoveUserAction.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom, IUser, Serialized } from '@rocket.chat/core-typings';\\nimport { isRoomFederated } from '@rocket.chat/core-typings';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { escapeHTML } from '@rocket.chat/string-helpers';\\nimport { usePermission, useSetModal, useTranslation, useUser, useUserRoom, useUserSubscription } from '@rocket.chat/ui-contexts';\\nimport React, { useMemo } from 'react';\\n\\nimport GenericModal from '../../../../../components/GenericModal';\\nimport { useEndpointAction } from '../../../../../hooks/useEndpointAction';\\nimport * as Federation from '../../../../../lib/federation/Federation';\\nimport { roomCoordinator } from '../../../../../lib/rooms/roomCoordinator';\\nimport RemoveUsersModal from '../../../../teams/contextualBar/members/RemoveUsersModal';\\nimport { getRoomDirectives } from '../../../lib/getRoomDirectives';\\nimport type { UserInfoAction } from '../useUserInfoActions';\\n\\nexport const useRemoveUserAction = (\\n\\tuser: Pick<IUser, '_id' | 'username'>,\\n\\trid: IRoom['_id'],\\n\\treload?: () => void,\\n): UserInfoAction | undefined => {\\n\\tconst room = useUserRoom(rid);\\n\\n\\tif (!room) {\\n\\t\\tthrow Error('Room not provided');\\n\\t}\\n\\n\\tconst t = useTranslation();\\n\\tconst currentUser = useUser();\\n\\tconst subscription = useUserSubscription(rid);\\n\\n\\tconst { _id: uid } = user;\\n\\n\\tconst hasPermissionToRemove = usePermission('remove-user', rid);\\n\\tconst userCanRemove = isRoomFederated(room)\\n\\t\\t? Federation.isEditableByTheUser(currentUser || undefined, room, subscription)\\n\\t\\t: hasPermissionToRemove;\\n\\tconst setModal = useSetModal();\\n\\tconst closeModal = useMutableCallback(() => setModal(null));\\n\\tconst roomName = room?.t && escapeHTML(roomCoordinator.getRoomName(room.t, room));\\n\\n\\tconst { roomCanRemove } = getRoomDirectives({ room, showingUserId: uid, userSubscription: subscription });\\n\\n\\tconst removeFromTeam = useEndpointAction('POST', '/v1/teams.removeMember', {\\n\\t\\tsuccessMessage: t('User_has_been_removed_from_team'),\\n\\t});\\n\\n\\tconst removeFromRoomEndpoint = room.t === 'p' ? '/v1/groups.kick' : '/v1/channels.kick';\\n\\tconst removeFromRoom = useEndpointAction('POST', removeFromRoomEndpoint, {\\n\\t\\tsuccessMessage: t('User_has_been_removed_from_s', roomName),\\n\\t});\\n\\n\\tconst removeUserOptionAction = useMutableCallback(() => {\\n\\t\\tconst handleRemoveFromTeam = async (rooms: Record<string, Serialized<IRoom>>): Promise<void> => {\\n\\t\\t\\tif (room.teamId) {\\n\\t\\t\\t\\tconst roomKeys = Object.keys(rooms);\\n\\t\\t\\t\\tawait removeFromTeam({\\n\\t\\t\\t\\t\\tteamId: room.teamId,\\n\\t\\t\\t\\t\\tuserId: uid,\\n\\t\\t\\t\\t\\t...(roomKeys.length && { rooms: roomKeys }),\\n\\t\\t\\t\\t});\\n\\t\\t\\t\\tcloseModal();\\n\\t\\t\\t\\treload?.();\\n\\t\\t\\t}\\n\\t\\t};\\n\\n\\t\\tconst handleRemoveFromRoom = async (rid: IRoom['_id'], uid: IUser['_id']): Promise<void> => {\\n\\t\\t\\tawait removeFromRoom({ roomId: rid, userId: uid });\\n\\t\\t\\tcloseModal();\\n\\t\\t\\treload?.();\\n\\t\\t};\\n\\n\\t\\tif (room.teamMain && room.teamId) {\\n\\t\\t\\treturn setModal(\\n\\t\\t\\t\\t<RemoveUsersModal teamId={room?.teamId} userId={uid} onClose={closeModal} onCancel={closeModal} onConfirm={handleRemoveFromTeam} />,\\n\\t\\t\\t);\\n\\t\\t}\\n\\n\\t\\tsetModal(\\n\\t\\t\\t<GenericModal\\n\\t\\t\\t\\tvariant='danger'\\n\\t\\t\\t\\tconfirmText={t('Yes_remove_user')}\\n\\t\\t\\t\\tonClose={closeModal}\\n\\t\\t\\t\\tonCancel={closeModal}\\n\\t\\t\\t\\tonConfirm={(): Promise<void> => handleRemoveFromRoom(rid, uid)}\\n\\t\\t\\t>\\n\\t\\t\\t\\t{t('The_user_will_be_removed_from_s', roomName)}\\n\\t\\t\\t</GenericModal>,\\n\\t\\t);\\n\\t});\\n\\n\\tconst removeUserOption = useMemo(\\n\\t\\t() =>\\n\\t\\t\\troomCanRemove && userCanRemove\\n\\t\\t\\t\\t? {\\n\\t\\t\\t\\t\\t\\tcontent: room?.teamMain ? t('Remove_from_team') : t('Remove_from_room'),\\n\\t\\t\\t\\t\\t\\ticon: 'cross' as const,\\n\\t\\t\\t\\t\\t\\tonClick: removeUserOptionAction,\\n\\t\\t\\t\\t\\t\\ttype: 'moderation' as const,\\n\\t\\t\\t\\t\\t\\tvariant: 'danger' as const,\\n\\t\\t\\t\\t  }\\n\\t\\t\\t\\t: undefined,\\n\\t\\t[room, roomCanRemove, userCanRemove, removeUserOptionAction, t],\\n\\t);\\n\\n\\treturn removeUserOption;\\n};\\n\",null],\"names\":[\"_objectSpread\",\"isRoomFederated\",\"useMutableCallback\",\"escapeHTML\",\"usePermission\",\"useSetModal\",\"useTranslation\",\"useUser\",\"useUserRoom\",\"useUserSubscription\",\"React\",\"useMemo\",\"GenericModal\",\"useEndpointAction\",\"Federation\",\"roomCoordinator\",\"RemoveUsersModal\",\"getRoomDirectives\",\"module\",\"link\",\"default\",\"v\",\"export\",\"useRemoveUserAction\",\"user\",\"rid\",\"reload\",\"room\",\"Error\",\"t\",\"currentUser\",\"subscription\",\"_id\",\"uid\",\"hasPermissionToRemove\",\"userCanRemove\",\"isEditableByTheUser\",\"undefined\",\"setModal\",\"closeModal\",\"roomName\",\"getRoomName\",\"roomCanRemove\",\"showingUserId\",\"userSubscription\",\"removeFromTeam\",\"successMessage\",\"removeFromRoomEndpoint\",\"removeFromRoom\",\"removeUserOptionAction\",\"handleRemoveFromTeam\",\"rooms\",\"teamId\",\"roomKeys\",\"Object\",\"keys\",\"userId\",\"length\",\"handleRemoveFromRoom\",\"roomId\",\"teamMain\",\"createElement\",\"onClose\",\"onCancel\",\"onConfirm\",\"variant\",\"confirmText\",\"removeUserOption\",\"content\",\"icon\",\"onClick\",\"type\"],\"mappings\":\"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\"}"}