{"code":"function module(e,i,n){let t,s,o,a,l,r,d,p,c,m,g;n.link(\"meteor/meteor\",{Meteor(e){t=e}},0),n.link(\"../../../app/authorization/client\",{hasAtLeastOnePermission(e){s=e}},1),n.link(\"../../../app/settings/client\",{settings(e){o=e}},2),n.link(\"../../../app/ui-utils/client\",{MessageAction(e){a=e}},3),n.link(\"../../../app/utils/client/lib/SDKClient\",{sdk(e){l=e}},4),n.link(\"../../lib/imperativeModal\",{imperativeModal(e){r=e}},5),n.link(\"../../lib/queryClient\",{queryClient(e){d=e}},6),n.link(\"../../lib/rooms/roomCoordinator\",{roomCoordinator(e){p=e}},7),n.link(\"../../lib/toast\",{dispatchToastMessage(e){c=e}},8),n.link(\"../../lib/utils/messageArgs\",{messageArgs(e){m=e}},9),n.link(\"../../views/room/modals/PinMessageModal\",{default(e){g=e}},10),t.startup(()=>{a.addButton({id:\"pin-message\",icon:\"pin\",label:\"Pin\",type:\"interaction\",context:[\"pinned\",\"message\",\"message-mobile\",\"threads\",\"direct\",\"videoconf\",\"videoconf-threads\"],async action(e,i){let{message:n=m(this).msg}=i,t=async()=>{n.pinned=!0;try{await l.call(\"pinMessage\",n),d.invalidateQueries([\"rooms\",n.rid,\"pinned-messages\"])}catch(e){c({type:\"error\",message:e})}r.close()};r.open({component:g,props:{message:n,onConfirm:t,onCancel:()=>r.close()}})},condition(e){let{message:i,subscription:n,room:t}=e;if(!o.get(\"Message_AllowPinning\")||i.pinned||!n)return!1;let a=p.isLivechatRoom(t.t);return!a&&s(\"pin-message\",i.rid)},order:2,group:\"menu\"})})}","map":"{\"version\":3,\"sources\":[\"client/startup/actionButtons/pinMessage.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Meteor } from 'meteor/meteor';\\n\\nimport { hasAtLeastOnePermission } from '../../../app/authorization/client';\\nimport { settings } from '../../../app/settings/client';\\nimport { MessageAction } from '../../../app/ui-utils/client';\\nimport { sdk } from '../../../app/utils/client/lib/SDKClient';\\nimport { imperativeModal } from '../../lib/imperativeModal';\\nimport { queryClient } from '../../lib/queryClient';\\nimport { roomCoordinator } from '../../lib/rooms/roomCoordinator';\\nimport { dispatchToastMessage } from '../../lib/toast';\\nimport { messageArgs } from '../../lib/utils/messageArgs';\\nimport PinMessageModal from '../../views/room/modals/PinMessageModal';\\n\\nMeteor.startup(() => {\\n\\tMessageAction.addButton({\\n\\t\\tid: 'pin-message',\\n\\t\\ticon: 'pin',\\n\\t\\tlabel: 'Pin',\\n\\t\\ttype: 'interaction',\\n\\t\\tcontext: ['pinned', 'message', 'message-mobile', 'threads', 'direct', 'videoconf', 'videoconf-threads'],\\n\\t\\tasync action(_, props) {\\n\\t\\t\\tconst { message = messageArgs(this).msg } = props;\\n\\t\\t\\tconst onConfirm = async () => {\\n\\t\\t\\t\\tmessage.pinned = true;\\n\\t\\t\\t\\ttry {\\n\\t\\t\\t\\t\\tawait sdk.call('pinMessage', message);\\n\\t\\t\\t\\t\\tqueryClient.invalidateQueries(['rooms', message.rid, 'pinned-messages']);\\n\\t\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\timperativeModal.close();\\n\\t\\t\\t};\\n\\n\\t\\t\\timperativeModal.open({\\n\\t\\t\\t\\tcomponent: PinMessageModal,\\n\\t\\t\\t\\tprops: {\\n\\t\\t\\t\\t\\tmessage,\\n\\t\\t\\t\\t\\tonConfirm,\\n\\t\\t\\t\\t\\tonCancel: () => imperativeModal.close(),\\n\\t\\t\\t\\t},\\n\\t\\t\\t});\\n\\t\\t},\\n\\t\\tcondition({ message, subscription, room }) {\\n\\t\\t\\tif (!settings.get('Message_AllowPinning') || message.pinned || !subscription) {\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t}\\n\\t\\t\\tconst isLivechatRoom = roomCoordinator.isLivechatRoom(room.t);\\n\\t\\t\\tif (isLivechatRoom) {\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t}\\n\\t\\t\\treturn hasAtLeastOnePermission('pin-message', message.rid);\\n\\t\\t},\\n\\t\\torder: 2,\\n\\t\\tgroup: 'menu',\\n\\t});\\n});\\n\",null],\"names\":[\"Meteor\",\"hasAtLeastOnePermission\",\"settings\",\"MessageAction\",\"sdk\",\"imperativeModal\",\"queryClient\",\"roomCoordinator\",\"dispatchToastMessage\",\"messageArgs\",\"PinMessageModal\",\"module\",\"link\",\"v\",\"default\",\"startup\",\"addButton\",\"id\",\"icon\",\"label\",\"type\",\"context\",\"action\",\"_\",\"props\",\"message\",\"msg\",\"onConfirm\",\"pinned\",\"call\",\"invalidateQueries\",\"rid\",\"error\",\"close\",\"open\",\"component\",\"onCancel\",\"condition\",\"_ref\",\"subscription\",\"room\",\"get\",\"isLivechatRoom\",\"t\",\"order\",\"group\"],\"mappings\":\"2BAAAA,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAZ,OAAAa,CAAA,EAAAb,EAAAa,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,oCAAA,CAAAX,wBAAAY,CAAA,EAAAZ,EAAAY,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,+BAAA,CAAAV,SAAAW,CAAA,EAAAX,EAAAW,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,+BAAA,CAAAT,cAAAU,CAAA,EAAAV,EAAAU,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,0CAAA,CAAAR,IAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,4BAAA,CAAAP,gBAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,wBAAA,CAAAN,YAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,kCAAA,CAAAL,gBAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,kBAAA,CAAAJ,qBAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,8BAAA,CAAAH,YAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,0CAAA,CAAAE,QAAAD,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,IAavCb,EAAOe,OAAO,CAAC,KACdZ,EAAca,SAAS,CAAC,CACvBC,GAAI,cACJC,KAAM,MACNC,MAAO,MACPC,KAAM,cACNC,QAAS,CAAC,SAAU,UAAW,iBAAkB,UAAW,SAAU,YAAa,oBAAoB,CACvG,MAAMC,OAAOC,CAAC,CAAEC,CAAK,EACpB,GAAM,CAAEC,QAAAA,EAAUhB,EAAY,IAAI,EAAEiB,GAAAA,CAAK,CAAGF,EACtCG,EAAY,UACjBF,EAAQG,MAAM,CAAG,CAAA,EACjB,GAAI,CACH,MAAMxB,EAAIyB,IAAI,CAAC,aAAcJ,GAC7BnB,EAAYwB,iBAAiB,CAAC,CAAC,QAASL,EAAQM,GAAG,CAAE,kBAAkB,CACxE,CAAE,MAAOC,EAAO,CACfxB,EAAqB,CAAEY,KAAM,QAASK,QAASO,CAAK,EACrD,CACA3B,EAAgB4B,KAAK,EACtB,EAEA5B,EAAgB6B,IAAI,CAAC,CACpBC,UAAWzB,EACXc,MAAO,CACNC,QAAAA,EACAE,UAAAA,EACAS,SAAUA,IAAM/B,EAAgB4B,KAAK,KAGxC,EACAI,UAASC,CAAA,EAAgC,GAA/B,CAAEb,QAAAA,CAAO,CAAEc,aAAAA,CAAY,CAAEC,KAAAA,CAAAA,CAAM,CAAAF,EACxC,GAAI,CAACpC,EAASuC,GAAG,CAAC,yBAA2BhB,EAAQG,MAAM,EAAI,CAACW,EAC/D,MAAO,CAAA,EAER,IAAMG,EAAiBnC,EAAgBmC,cAAc,CAACF,EAAKG,CAAC,QAC5D,CAAID,GAGGzC,EAAwB,cAAewB,EAAQM,GAAG,CAC1D,EACAa,MAAO,EACPC,MAAO,QAET\"}"}