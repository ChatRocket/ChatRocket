{"code":"function module(t,n,o){o.link(\"@babel/runtime/regenerator\",{default:function(t){e=t}},0),o.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(t){r=t}},1),o.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(t){a=t}},2),o.export({useTagsSection:function(){return m}}),o.link(\"@rocket.chat/fuselage\",{Palette:function(t){i=t}},0),o.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(t){s=t}},1),o.link(\"@tanstack/react-query\",{useQuery:function(t){u=t}},2),o.link(\"react\",{useMemo:function(t){c=t}},3),o.link(\"react-i18next\",{useTranslation:function(t){l=t}},4),o.link(\"../../../components/dashboards/periods\",{getPeriodRange:function(t){d=t}},5),o.link(\"../../../components/dashboards/usePeriodSelectorStorage\",{usePeriodSelectorStorage:function(t){f=t}},6),o.link(\"../components/constants\",{PERIOD_OPTIONS:function(t){g=t}},7),o.link(\"../utils/formatPeriodDescription\",{formatPeriodDescription:function(t){p=t}},8),o.link(\"./useDefaultDownload\",{useDefaultDownload:function(t){_=t}},9);var e,r,a,i,s,u,c,l,d,f,g,p,_,S={warning:i.statusColor[\"status-font-on-warning\"].toString(),danger:i.statusColor[\"status-font-on-danger\"].toString(),success:i.statusColor[\"status-font-on-success\"].toString(),info:i.statusColor[\"status-font-on-info\"].toString()},b=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map(function(t){return a(a({},t),{},{color:S.info})})},m=function(){var t=l().t,n=f(\"reports-tags-period\",g),o=r(n,2),i=o[0],S=o[1],m=s(\"GET\",\"/v1/livechat/analytics/dashboards/conversations-by-tags\"),v=u([\"omnichannel-reports\",\"conversations-by-tags\",i],function(){var t,n,o,r;return e.async(function(s){for(;;)switch(s.prev=s.next){case 0:return n=(t=d(i)).start,o=t.end,s.next=3,e.awrap(m({start:n.toISOString(),end:o.toISOString()}));case 3:return r=s.sent,s.abrupt(\"return\",a(a({},r),{},{data:b(r.data)}));case 5:case\"end\":return s.stop()}},null,null,null,Promise)},{refetchInterval:3e5}),h=v.data,k=(h=void 0===h?{data:[],total:0}:h).data,y=h.total,P=void 0===y?0:y,w=h.unspecified,D=void 0===w?0:w,T=v.refetch,E=v.isLoading,O=v.isError,x=v.isSuccess,C=t(\"Conversations_by_tag\"),I=t(\"__count__tags__and__count__conversations__period__\",{count:k.length,conversations:P,period:p(i,t)})+\" \"+(D>0?\"(\"+t(\"__count__without__tags__\",{count:D})+\")\":\"\"),R=t(\"Omnichannel_Reports_Tags_Empty_Subtitle\"),L=_({columnName:t(\"Tags\"),title:C,data:k,period:i});return c(function(){return{id:\"conversations-by-tags\",title:C,subtitle:I,emptyStateSubtitle:R,data:k,total:P,period:i,periodSelectorProps:S,downloadProps:L,isError:O,isLoading:E,isDataFound:x&&k.length>0,onRetry:T}},[C,I,R,k,P,O,E,x,S,i,L,T])}}","map":"{\"version\":3,\"sources\":[\"client/omnichannel/reports/hooks/useTagsSection.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Palette } from '@rocket.chat/fuselage';\\nimport { useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useQuery } from '@tanstack/react-query';\\nimport { useMemo } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { getPeriodRange } from '../../../components/dashboards/periods';\\nimport { usePeriodSelectorStorage } from '../../../components/dashboards/usePeriodSelectorStorage';\\nimport { PERIOD_OPTIONS } from '../components/constants';\\nimport { formatPeriodDescription } from '../utils/formatPeriodDescription';\\nimport { useDefaultDownload } from './useDefaultDownload';\\n\\nconst colors = {\\n\\twarning: Palette.statusColor['status-font-on-warning'].toString(),\\n\\tdanger: Palette.statusColor['status-font-on-danger'].toString(),\\n\\tsuccess: Palette.statusColor['status-font-on-success'].toString(),\\n\\tinfo: Palette.statusColor['status-font-on-info'].toString(),\\n};\\n\\nconst formatChartData = (data: { label: string; value: number }[] | undefined = []) =>\\n\\tdata.map((item) => ({\\n\\t\\t...item,\\n\\t\\tcolor: colors.info,\\n\\t}));\\n\\nexport const useTagsSection = () => {\\n\\tconst { t } = useTranslation();\\n\\tconst [period, periodSelectorProps] = usePeriodSelectorStorage('reports-tags-period', PERIOD_OPTIONS);\\n\\tconst getConversationsByTags = useEndpoint('GET', '/v1/livechat/analytics/dashboards/conversations-by-tags');\\n\\n\\tconst {\\n\\t\\tdata: { data, total = 0, unspecified = 0 } = { data: [], total: 0 },\\n\\t\\trefetch,\\n\\t\\tisLoading,\\n\\t\\tisError,\\n\\t\\tisSuccess,\\n\\t} = useQuery(\\n\\t\\t['omnichannel-reports', 'conversations-by-tags', period],\\n\\t\\tasync () => {\\n\\t\\t\\tconst { start, end } = getPeriodRange(period);\\n\\t\\t\\tconst response = await getConversationsByTags({ start: start.toISOString(), end: end.toISOString() });\\n\\t\\t\\treturn { ...response, data: formatChartData(response.data) };\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\trefetchInterval: 5 * 60 * 1000,\\n\\t\\t},\\n\\t);\\n\\n\\tconst title = t('Conversations_by_tag');\\n\\tconst subtitleTotals = t('__count__tags__and__count__conversations__period__', {\\n\\t\\tcount: data.length,\\n\\t\\tconversations: total,\\n\\t\\tperiod: formatPeriodDescription(period, t),\\n\\t});\\n\\tconst subtitleUnspecified = unspecified > 0 ? `(${t('__count__without__tags__', { count: unspecified })})` : '';\\n\\tconst subtitle = `${subtitleTotals} ${subtitleUnspecified}`;\\n\\tconst emptyStateSubtitle = t('Omnichannel_Reports_Tags_Empty_Subtitle');\\n\\n\\tconst downloadProps = useDefaultDownload({ columnName: t('Tags'), title, data, period });\\n\\n\\treturn useMemo(\\n\\t\\t() => ({\\n\\t\\t\\tid: 'conversations-by-tags',\\n\\t\\t\\ttitle,\\n\\t\\t\\tsubtitle,\\n\\t\\t\\temptyStateSubtitle,\\n\\t\\t\\tdata,\\n\\t\\t\\ttotal,\\n\\t\\t\\tperiod,\\n\\t\\t\\tperiodSelectorProps,\\n\\t\\t\\tdownloadProps,\\n\\t\\t\\tisError,\\n\\t\\t\\tisLoading,\\n\\t\\t\\tisDataFound: isSuccess && data.length > 0,\\n\\t\\t\\tonRetry: refetch,\\n\\t\\t}),\\n\\t\\t[title, subtitle, emptyStateSubtitle, data, total, isError, isLoading, isSuccess, periodSelectorProps, period, downloadProps, refetch],\\n\\t);\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"_slicedToArray\",\"_objectSpread\",\"export\",\"useTagsSection\",\"Palette\",\"useEndpoint\",\"useQuery\",\"useMemo\",\"useTranslation\",\"getPeriodRange\",\"usePeriodSelectorStorage\",\"PERIOD_OPTIONS\",\"formatPeriodDescription\",\"useDefaultDownload\",\"colors\",\"warning\",\"statusColor\",\"toString\",\"danger\",\"success\",\"info\",\"formatChartData\",\"data\",\"arguments\",\"length\",\"undefined\",\"map\",\"item\",\"color\",\"t\",\"_useTranslation\",\"_usePeriodSelectorSto\",\"_usePeriodSelectorSto2\",\"period\",\"periodSelectorProps\",\"getConversationsByTags\",\"_useQuery\",\"_getPeriodRange\",\"start\",\"end\",\"response\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"toISOString\",\"sent\",\"abrupt\",\"stop\",\"Promise\",\"refetchInterval\",\"_useQuery$data\",\"total\",\"_useQuery$data$total\",\"_useQuery$data$unspec\",\"unspecified\",\"refetch\",\"isLoading\",\"isError\",\"isSuccess\",\"title\",\"subtitle\",\"subtitleTotals\",\"count\",\"conversations\",\"emptyStateSubtitle\",\"downloadProps\",\"columnName\",\"id\",\"isDataFound\",\"onRetry\"],\"mappings\":\"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\"}"}