{"code":"function module(e,t,s){let n,a,o,r,i,c,l,u,T;s.export({useResetTOTPAction:()=>_}),s.link(\"@rocket.chat/ui-contexts\",{useSetModal(e){n=e},usePermission(e){a=e},useSetting(e){o=e},useEndpoint(e){r=e},useTranslation(e){i=e},useToastMessageDispatch(e){c=e}},0),s.link(\"react\",{default(e){l=e},useCallback(e){u=e}},1),s.link(\"../../../../components/GenericModal\",{default(e){T=e}},2);let _=e=>{let t=i(),s=n(),_=c(),d=a(\"edit-other-user-totp\"),m=o(\"Accounts_TwoFactorAuthentication_Enabled\"),h=r(\"POST\",\"/v1/users.resetTOTP\"),p=u(async()=>{try{await h({userId:e}),_({type:\"success\",message:t(\"Users_TOTP_has_been_reset\")})}catch(e){_({type:\"error\",message:e})}finally{s()}},[h,s,t,e,_]),y=u(()=>{s(l.createElement(T,{variant:\"danger\",onConfirm:p,onCancel:()=>s(),confirmText:t(\"Reset\")},t(\"TOTP_Reset_Other_Key_Warning\")))},[p,t,s]);return d&&m?{icon:\"key\",label:t(\"Reset_TOTP\"),action:y}:void 0}}","map":"{\"version\":3,\"sources\":[\"client/views/admin/users/hooks/useResetTOTPAction.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IUser } from '@rocket.chat/core-typings';\\nimport { useSetModal, usePermission, useSetting, useEndpoint, useTranslation, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport React, { useCallback } from 'react';\\n\\nimport GenericModal from '../../../../components/GenericModal';\\nimport type { Action } from '../../../hooks/useActionSpread';\\n\\nexport const useResetTOTPAction = (userId: IUser['_id']): Action | undefined => {\\n\\tconst t = useTranslation();\\n\\tconst setModal = useSetModal();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst canResetTOTP = usePermission('edit-other-user-totp');\\n\\tconst twoFactorEnabled = useSetting('Accounts_TwoFactorAuthentication_Enabled');\\n\\tconst resetTOTPRequest = useEndpoint('POST', '/v1/users.resetTOTP');\\n\\n\\tconst resetTOTP = useCallback(async () => {\\n\\t\\ttry {\\n\\t\\t\\tawait resetTOTPRequest({ userId });\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Users_TOTP_has_been_reset') });\\n\\t\\t} catch (error) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t} finally {\\n\\t\\t\\tsetModal();\\n\\t\\t}\\n\\t}, [resetTOTPRequest, setModal, t, userId, dispatchToastMessage]);\\n\\n\\tconst confirmResetTOTP = useCallback(() => {\\n\\t\\tsetModal(\\n\\t\\t\\t<GenericModal variant='danger' onConfirm={resetTOTP} onCancel={(): void => setModal()} confirmText={t('Reset')}>\\n\\t\\t\\t\\t{t('TOTP_Reset_Other_Key_Warning')}\\n\\t\\t\\t</GenericModal>,\\n\\t\\t);\\n\\t}, [resetTOTP, t, setModal]);\\n\\n\\treturn canResetTOTP && twoFactorEnabled\\n\\t\\t? {\\n\\t\\t\\t\\ticon: 'key',\\n\\t\\t\\t\\tlabel: t('Reset_TOTP'),\\n\\t\\t\\t\\taction: confirmResetTOTP,\\n\\t\\t  }\\n\\t\\t: undefined;\\n};\\n\",null],\"names\":[\"useSetModal\",\"usePermission\",\"useSetting\",\"useEndpoint\",\"useTranslation\",\"useToastMessageDispatch\",\"React\",\"useCallback\",\"GenericModal\",\"module\",\"export\",\"useResetTOTPAction\",\"link\",\"v\",\"default\",\"userId\",\"t\",\"setModal\",\"dispatchToastMessage\",\"canResetTOTP\",\"twoFactorEnabled\",\"resetTOTPRequest\",\"resetTOTP\",\"type\",\"message\",\"error\",\"confirmResetTOTP\",\"createElement\",\"variant\",\"onConfirm\",\"onCancel\",\"confirmText\",\"icon\",\"label\",\"action\",\"undefined\"],\"mappings\":\"2BAC8DA,EAAAC,EAAgBC,EAAAC,EAA+BC,EAAAC,EAA2BC,EAAAC,EAAAC,EAAxIC,EAAOC,MAAE,CAAA,CAAAC,mBAAaA,IAAeA,CAAY,GAAuFF,EAAAG,IAAA,CAAA,2BAAA,CAAAZ,YAAAa,CAAA,EAAAb,EAAAa,CAAA,EAAAZ,cAAAY,CAAA,EAAAZ,EAAAY,CAAA,EAAAX,WAAAW,CAAA,EAAAX,EAAAW,CAAA,EAAAV,YAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,eAAAS,CAAA,EAAAT,EAAAS,CAAA,EAAAR,wBAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,QAAA,CAAAE,QAAAD,CAAA,EAAAP,EAAAO,CAAA,EAAAN,YAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,sCAAA,CAAAE,QAAAD,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAMjI,IAAMF,EAAsBI,IAClC,IAAMC,EAAIZ,IACJa,EAAWjB,IACXkB,EAAuBb,IACvBc,EAAelB,EAAc,wBAC7BmB,EAAmBlB,EAAW,4CAC9BmB,EAAmBlB,EAAY,OAAQ,uBAEvCmB,EAAYf,EAAY,UAC7B,GAAI,CACH,MAAMc,EAAiB,CAAEN,OAAAA,CAAM,GAC/BG,EAAqB,CAAEK,KAAM,UAAWC,QAASR,EAAE,4BAA4B,EAChF,CAAE,MAAOS,EAAO,CACfP,EAAqB,CAAEK,KAAM,QAASC,QAASC,CAAK,EACrD,QAAU,CACTR,GACD,CACD,EAAG,CAACI,EAAkBJ,EAAUD,EAAGD,EAAQG,EAAqB,EAE1DQ,EAAmBnB,EAAY,KACpCU,EACCX,EAAAqB,aAAA,CAACnB,EAAY,CAACoB,QAAQ,SAASC,UAAWP,EAAWQ,SAAUA,IAAYb,IAAYc,YAAaf,EAAE,QAAS,EAC7GA,EAAE,iCAGN,EAAG,CAACM,EAAWN,EAAGC,EAAS,EAE3B,OAAOE,GAAgBC,EACpB,CACAY,KAAM,MACNC,MAAOjB,EAAE,cACTkB,OAAQR,GAERS,KAAAA,CACJ\"}"}