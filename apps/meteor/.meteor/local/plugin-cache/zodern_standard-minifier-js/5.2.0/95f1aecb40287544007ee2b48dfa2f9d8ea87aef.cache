{"code":"function module(e,n,t){t.link(\"@babel/runtime/regenerator\",{default:function(e){r=e}},0),t.export({useValidateInviteQuery:function(){return f}}),t.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(e){u=e},useSessionDispatch:function(e){i=e},useSetting:function(e){a=e},useToastMessageDispatch:function(e){s=e},useTranslation:function(e){o=e}},0),t.link(\"@tanstack/react-query\",{useQuery:function(e){c=e}},1),t.link(\"./useInviteTokenMutation\",{useInviteTokenMutation:function(e){l=e}},2);var r,u,i,a,s,o,c,l,f=function(e,n){var t=o(),f=a(\"Accounts_RegistrationForm\"),p=i(\"loginDefaultState\"),v=s(),k=l(),b=u(\"POST\",\"/v1/validateInviteToken\");return c([\"invite\",n],function(){var e;return r.async(function(u){for(;;)switch(u.prev=u.next){case 0:if(n){u.next=2;break}return u.abrupt(\"return\",!1);case 2:return u.prev=2,u.next=5,r.awrap(b({token:n}));case 5:return e=u.sent.valid,u.abrupt(\"return\",e);case 10:return u.prev=10,u.t0=u.catch(2),v({type:\"error\",message:t(\"Failed_to_validate_invite_token\")}),u.abrupt(\"return\",!1);case 14:case\"end\":return u.stop()}},null,null,[[2,10]],Promise)},{onSuccess:function(t){return r.async(function(r){for(;;)switch(r.prev=r.next){case 0:if(n){r.next=2;break}return r.abrupt(\"return\");case 2:if(\"Disabled\"!==f?p(\"invite-register\"):p(\"login\"),!(!t||!e)){r.next=5;break}return r.abrupt(\"return\");case 5:return r.abrupt(\"return\",k(n));case 6:case\"end\":return r.stop()}},null,null,null,Promise)}})}}","map":"{\"version\":3,\"sources\":[\"client/views/invite/hooks/useValidateInviteQuery.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useEndpoint, useSessionDispatch, useSetting, useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\\nimport { useQuery } from '@tanstack/react-query';\\n\\nimport { useInviteTokenMutation } from './useInviteTokenMutation';\\n\\nexport const useValidateInviteQuery = (userId: string | null, token: string | undefined) => {\\n\\tconst t = useTranslation();\\n\\n\\tconst registrationForm = useSetting('Accounts_RegistrationForm');\\n\\n\\tconst setLoginDefaultState = useSessionDispatch('loginDefaultState');\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst getInviteRoomMutation = useInviteTokenMutation();\\n\\n\\tconst handleValidateInviteToken = useEndpoint('POST', '/v1/validateInviteToken');\\n\\n\\treturn useQuery(\\n\\t\\t['invite', token],\\n\\t\\tasync () => {\\n\\t\\t\\tif (!token) {\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t}\\n\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tconst { valid } = await handleValidateInviteToken({ token });\\n\\n\\t\\t\\t\\treturn valid;\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('Failed_to_validate_invite_token') });\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\tonSuccess: async (valid) => {\\n\\t\\t\\t\\tif (!token) {\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tif (registrationForm !== 'Disabled') {\\n\\t\\t\\t\\t\\tsetLoginDefaultState('invite-register');\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tsetLoginDefaultState('login');\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tif (!valid || !userId) {\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\treturn getInviteRoomMutation(token);\\n\\t\\t\\t},\\n\\t\\t},\\n\\t);\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"export\",\"useValidateInviteQuery\",\"useEndpoint\",\"useSessionDispatch\",\"useSetting\",\"useToastMessageDispatch\",\"useTranslation\",\"useQuery\",\"useInviteTokenMutation\",\"userId\",\"token\",\"t\",\"registrationForm\",\"setLoginDefaultState\",\"dispatchToastMessage\",\"getInviteRoomMutation\",\"handleValidateInviteToken\",\"valid\",\"async\",\"_context\",\"prev\",\"next\",\"abrupt\",\"awrap\",\"_await$handleValidate\",\"sent\",\"t0\",\"type\",\"message\",\"stop\",\"Promise\",\"onSuccess\",\"_context2\"],\"mappings\":\"uBAAsBA,EAAAC,IAAA,CAAA,6BAAgC,CAAAC,QAAA,SAAyBC,CAAA,EAAAC,EAAsBD,CAAA,CAAA,EAAA,GAArGH,EAAOK,MAAE,CAAA,CAAAC,uBAAa,WAAoB,OAAYA,CAAuB,CAAE,GAAiDN,EAAAC,IAAA,CAAA,2BAAA,CAAAM,YAAA,SAAAJ,CAAA,EAAAI,EAAAJ,CAAA,EAAAK,mBAAA,SAAAL,CAAA,EAAAK,EAAAL,CAAA,EAAAM,WAAA,SAAAN,CAAA,EAAAM,EAAAN,CAAA,EAAAO,wBAAA,SAAAP,CAAA,EAAAO,EAAAP,CAAA,EAAAQ,eAAA,SAAAR,CAAA,EAAAQ,EAAAR,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,wBAAA,CAAAW,SAAA,SAAAT,CAAA,EAAAS,EAAAT,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,2BAAA,CAAAY,uBAAA,SAAAV,CAAA,EAAAU,EAAAV,CAAA,CAAA,EAAA,GAKzH,IALPC,EAA+EG,EAAgBC,EAAMC,EAA2BC,EAAAC,EAAAC,EAAAC,EAKnHP,EAAyB,SAACQ,CAAqB,CAAEC,CAAyB,EACtF,IAAMC,EAAIL,IAEJM,EAAmBR,EAAW,6BAE9BS,EAAuBV,EAAmB,qBAC1CW,EAAuBT,IACvBU,EAAwBP,IAExBQ,EAA4Bd,EAAY,OAAQ,2BAEtD,OAAOK,EACN,CAAC,SAAUG,EAAM,CACjB,WAAA,IAAAO,EAAA,OAAAlB,EAAAmB,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,GACMX,EAAK,CAAAS,EAAAE,IAAA,CAAA,EAAA,KAAA,CAAA,OAAAF,EAAAG,MAAA,CAAA,SACF,CAAA,EAAK,MAAA,EAAA,OAAAH,EAAAC,IAAA,CAAA,EAAAD,EAAAE,IAAA,CAAA,EAAAtB,EAAAwB,KAAA,CAIYP,EAA0B,CAAEN,MAAAA,CAAK,GAAG,MAAA,EAA/C,OAALO,EAAKO,AAA+CL,EAAAM,IAAA,CAApDR,KAAK,CAAAE,EAAAG,MAAA,CAAA,SAENL,EAAK,MAAA,GAE2E,OAF3EE,EAAAC,IAAA,CAAA,GAAAD,EAAAO,EAAA,CAAAP,EAAA,KAAA,CAAA,GAEZL,EAAqB,CAAEa,KAAM,QAASC,QAASjB,EAAE,kCAAkC,GAAIQ,EAAAG,MAAA,CAAA,SAChF,CAAA,EAAK,MAAA,GAAA,IAAA,MAAA,OAAAH,EAAAU,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,CAAA,CAAA,EAAA,GAAA,CAAA,CAAAC,QAAA,EAGd,CACCC,UAAW,SAAOd,CAAK,EAAA,OAAAlB,EAAAmB,KAAA,CAAA,SAAAc,CAAA,EAAA,OAAA,OAAAA,EAAAZ,IAAA,CAAAY,EAAAX,IAAA,EAAA,KAAA,EAAA,GACjBX,EAAK,CAAAsB,EAAAX,IAAA,CAAA,EAAA,KAAA,CAAA,OAAAW,EAAAV,MAAA,CAAA,SAAA,MAAA,EAQT,GAJGV,AAAqB,aAArBA,EACHC,EAAqB,mBAErBA,EAAqB,SACrB,CAEG,CAAA,CAACI,GAAS,CAACR,CAAAA,EAAM,CAAAuB,EAAAX,IAAA,CAAA,EAAA,KAAA,CAAA,OAAAW,EAAAV,MAAA,CAAA,SAAA,MAAA,EAAA,OAAAU,EAAAV,MAAA,CAAA,SAIdP,EAAsBL,GAAM,MAAA,EAAA,IAAA,MAAA,OAAAsB,EAAAH,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,GAIvC\"}"}