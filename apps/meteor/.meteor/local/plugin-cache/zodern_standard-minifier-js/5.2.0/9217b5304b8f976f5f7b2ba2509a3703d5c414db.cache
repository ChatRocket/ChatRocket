{"code":"function module(e,t,a){var l;let n,o,i,r,s,d,c,u,m,k,x,h,p,g,C,f,T,b,E,v,w,M,L,S,y,B;a.link(\"@babel/runtime/helpers/taggedTemplateLiteral\",{default(e){n=e}},0),a.link(\"@rocket.chat/css-in-js\",{css(e){o=e}},0),a.link(\"@rocket.chat/fuselage\",{Box(e){i=e},Modal(e){r=e},Skeleton(e){s=e}},1),a.link(\"@rocket.chat/fuselage-hooks\",{useLocalStorage(e){d=e}},2),a.link(\"@rocket.chat/ui-contexts\",{useLayoutContextualBarExpanded(e){c=e},useToastMessageDispatch(e){u=e},useTranslation(e){m=e},useUserId(e){k=e}},3),a.link(\"react\",{default(e){x=e}},4),a.link(\"../../../../components/Contextualbar\",{Contextualbar(e){h=e},ContextualbarHeader(e){p=e},ContextualbarAction(e){g=e},ContextualbarActions(e){C=e},ContextualbarClose(e){f=e},ContextualbarBack(e){T=e},ContextualbarInnerContent(e){b=e}},5),a.link(\"../../contexts/RoomToolboxContext\",{useRoomToolbox(e){E=e}},6),a.link(\"../../hooks/useGoToThreadList\",{useGoToThreadList(e){v=e}},7),a.link(\"../../providers/ChatProvider\",{default(e){w=e}},8),a.link(\"./components/ThreadChat\",{default(e){M=e}},9),a.link(\"./components/ThreadSkeleton\",{default(e){L=e}},10),a.link(\"./components/ThreadTitle\",{default(e){S=e}},11),a.link(\"./hooks/useThreadMainMessageQuery\",{useThreadMainMessageQuery(e){y=e}},12),a.link(\"./hooks/useToggleFollowingThreadMutation\",{useToggleFollowingThreadMutation(e){B=e}},13),a.exportDefault(e=>{var t,a,D;let{tmid:F}=e,G=v({replace:!0}),{closeTab:I}=E(),A=y(F,{onDelete:()=>{I()}}),N=m(),Q=u(),R=c(),[j,z]=d(\"expand-threads\",!1),H=k(),P=!!H&&null!==(t=null===(a=A.data)||void 0===a?void 0:null===(D=a.replies)||void 0===D?void 0:D.includes(H))&&void 0!==t&&t,U=B({onError:e=>{Q({type:\"error\",message:e})}});return x.createElement(b,null,R&&j&&x.createElement(r.Backdrop,{onClick:()=>{I()}}),x.createElement(i,{flexGrow:1,position:j?\"static\":\"relative\"},x.createElement(h,{\"rcx-thread-view\":!0,className:R&&j?o(l||(l=n([\"\\n\t\t\t\t\t\t\t\t\tmax-width: 855px !important;\\n\t\t\t\t\t\t\t\t\t@media (min-width: 780px) and (max-width: 1135px) {\\n\t\t\t\t\t\t\t\t\t\tmax-width: calc(100% - var(--sidebar-width)) !important;\\n\t\t\t\t\t\t\t\t\t}\\n\t\t\t\t\t\t\t  \"]))):void 0,position:j?\"fixed\":\"absolute\",display:\"flex\",flexDirection:\"column\",width:\"full\",overflow:\"hidden\",zIndex:100,insetBlock:0,border:\"none\"},x.createElement(p,{expanded:j},x.createElement(T,{onClick:()=>{G()}}),A.isLoading&&x.createElement(s,{width:\"100%\"})||A.isSuccess&&x.createElement(S,{mainMessage:A.data})||null,x.createElement(C,null,R&&x.createElement(g,{name:j?\"arrow-collapse\":\"arrow-expand\",title:N(j?\"Collapse\":\"Expand\"),onClick:()=>{z(e=>!e)}}),x.createElement(g,{name:P?\"bell\":\"bell-off\",title:N(P?\"Following\":\"Not_Following\"),disabled:!A.isSuccess||U.isLoading,onClick:()=>{var e;let t=null===(e=A.data)||void 0===e?void 0:e.rid;t&&U.mutate({rid:t,tmid:F,follow:!P})}}),x.createElement(f,{onClick:()=>{I()}}))),A.isLoading&&x.createElement(L,null)||A.isSuccess&&x.createElement(w,{tmid:F},x.createElement(M,{mainMessage:A.data}))||null)))})}","map":"{\"version\":3,\"sources\":[\"client/views/room/contextualBar/Threads/Thread.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IMessage } from '@rocket.chat/core-typings';\\nimport { css } from '@rocket.chat/css-in-js';\\nimport { Box, Modal, Skeleton } from '@rocket.chat/fuselage';\\nimport { useLocalStorage } from '@rocket.chat/fuselage-hooks';\\nimport { useLayoutContextualBarExpanded, useToastMessageDispatch, useTranslation, useUserId } from '@rocket.chat/ui-contexts';\\nimport React from 'react';\\n\\nimport {\\n\\tContextualbar,\\n\\tContextualbarHeader,\\n\\tContextualbarAction,\\n\\tContextualbarActions,\\n\\tContextualbarClose,\\n\\tContextualbarBack,\\n\\tContextualbarInnerContent,\\n} from '../../../../components/Contextualbar';\\nimport { useRoomToolbox } from '../../contexts/RoomToolboxContext';\\nimport { useGoToThreadList } from '../../hooks/useGoToThreadList';\\nimport ChatProvider from '../../providers/ChatProvider';\\nimport ThreadChat from './components/ThreadChat';\\nimport ThreadSkeleton from './components/ThreadSkeleton';\\nimport ThreadTitle from './components/ThreadTitle';\\nimport { useThreadMainMessageQuery } from './hooks/useThreadMainMessageQuery';\\nimport { useToggleFollowingThreadMutation } from './hooks/useToggleFollowingThreadMutation';\\n\\ntype ThreadProps = {\\n\\ttmid: IMessage['_id'];\\n};\\n\\nconst Thread = ({ tmid }: ThreadProps) => {\\n\\tconst goToThreadList = useGoToThreadList({ replace: true });\\n\\tconst { closeTab } = useRoomToolbox();\\n\\n\\tconst mainMessageQueryResult = useThreadMainMessageQuery(tmid, {\\n\\t\\tonDelete: () => {\\n\\t\\t\\tcloseTab();\\n\\t\\t},\\n\\t});\\n\\n\\tconst t = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst canExpand = useLayoutContextualBarExpanded();\\n\\tconst [expanded, setExpanded] = useLocalStorage('expand-threads', false);\\n\\n\\tconst uid = useUserId();\\n\\tconst following = uid ? mainMessageQueryResult.data?.replies?.includes(uid) ?? false : false;\\n\\tconst toggleFollowingMutation = useToggleFollowingThreadMutation({\\n\\t\\tonError: (error) => {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t},\\n\\t});\\n\\n\\tconst handleBackdropClick = () => {\\n\\t\\tcloseTab();\\n\\t};\\n\\n\\tconst handleGoBack = () => {\\n\\t\\tgoToThreadList();\\n\\t};\\n\\n\\tconst handleToggleExpand = () => {\\n\\t\\tsetExpanded((expanded) => !expanded);\\n\\t};\\n\\n\\tconst handleToggleFollowing = () => {\\n\\t\\tconst rid = mainMessageQueryResult.data?.rid;\\n\\n\\t\\tif (!rid) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\ttoggleFollowingMutation.mutate({ rid, tmid, follow: !following });\\n\\t};\\n\\n\\tconst handleClose = () => {\\n\\t\\tcloseTab();\\n\\t};\\n\\n\\treturn (\\n\\t\\t<ContextualbarInnerContent>\\n\\t\\t\\t{canExpand && expanded && <Modal.Backdrop onClick={handleBackdropClick} />}\\n\\t\\t\\t<Box flexGrow={1} position={expanded ? 'static' : 'relative'}>\\n\\t\\t\\t\\t<Contextualbar\\n\\t\\t\\t\\t\\trcx-thread-view\\n\\t\\t\\t\\t\\tclassName={\\n\\t\\t\\t\\t\\t\\tcanExpand && expanded\\n\\t\\t\\t\\t\\t\\t\\t? css`\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tmax-width: 855px !important;\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t@media (min-width: 780px) and (max-width: 1135px) {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tmax-width: calc(100% - var(--sidebar-width)) !important;\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t\\t  `\\n\\t\\t\\t\\t\\t\\t\\t: undefined\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tposition={expanded ? 'fixed' : 'absolute'}\\n\\t\\t\\t\\t\\tdisplay='flex'\\n\\t\\t\\t\\t\\tflexDirection='column'\\n\\t\\t\\t\\t\\twidth='full'\\n\\t\\t\\t\\t\\toverflow='hidden'\\n\\t\\t\\t\\t\\tzIndex={100}\\n\\t\\t\\t\\t\\tinsetBlock={0}\\n\\t\\t\\t\\t\\tborder='none'\\n\\t\\t\\t\\t>\\n\\t\\t\\t\\t\\t<ContextualbarHeader expanded={expanded}>\\n\\t\\t\\t\\t\\t\\t<ContextualbarBack onClick={handleGoBack} />\\n\\t\\t\\t\\t\\t\\t{(mainMessageQueryResult.isLoading && <Skeleton width='100%' />) ||\\n\\t\\t\\t\\t\\t\\t\\t(mainMessageQueryResult.isSuccess && <ThreadTitle mainMessage={mainMessageQueryResult.data} />) ||\\n\\t\\t\\t\\t\\t\\t\\tnull}\\n\\t\\t\\t\\t\\t\\t<ContextualbarActions>\\n\\t\\t\\t\\t\\t\\t\\t{canExpand && (\\n\\t\\t\\t\\t\\t\\t\\t\\t<ContextualbarAction\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tname={expanded ? 'arrow-collapse' : 'arrow-expand'}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\ttitle={expanded ? t('Collapse') : t('Expand')}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tonClick={handleToggleExpand}\\n\\t\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t\\t\\t<ContextualbarAction\\n\\t\\t\\t\\t\\t\\t\\t\\tname={following ? 'bell' : 'bell-off'}\\n\\t\\t\\t\\t\\t\\t\\t\\ttitle={following ? t('Following') : t('Not_Following')}\\n\\t\\t\\t\\t\\t\\t\\t\\tdisabled={!mainMessageQueryResult.isSuccess || toggleFollowingMutation.isLoading}\\n\\t\\t\\t\\t\\t\\t\\t\\tonClick={handleToggleFollowing}\\n\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t\\t<ContextualbarClose onClick={handleClose} />\\n\\t\\t\\t\\t\\t\\t</ContextualbarActions>\\n\\t\\t\\t\\t\\t</ContextualbarHeader>\\n\\n\\t\\t\\t\\t\\t{(mainMessageQueryResult.isLoading && <ThreadSkeleton />) ||\\n\\t\\t\\t\\t\\t\\t(mainMessageQueryResult.isSuccess && (\\n\\t\\t\\t\\t\\t\\t\\t<ChatProvider tmid={tmid}>\\n\\t\\t\\t\\t\\t\\t\\t\\t<ThreadChat mainMessage={mainMessageQueryResult.data} />\\n\\t\\t\\t\\t\\t\\t\\t</ChatProvider>\\n\\t\\t\\t\\t\\t\\t)) ||\\n\\t\\t\\t\\t\\t\\tnull}\\n\\t\\t\\t\\t</Contextualbar>\\n\\t\\t\\t</Box>\\n\\t\\t</ContextualbarInnerContent>\\n\\t);\\n};\\n\\nexport default Thread;\\n\",null],\"names\":[\"_taggedTemplateLiteral\",\"css\",\"Box\",\"Modal\",\"Skeleton\",\"useLocalStorage\",\"useLayoutContextualBarExpanded\",\"useToastMessageDispatch\",\"useTranslation\",\"useUserId\",\"React\",\"Contextualbar\",\"ContextualbarHeader\",\"ContextualbarAction\",\"ContextualbarActions\",\"ContextualbarClose\",\"ContextualbarBack\",\"ContextualbarInnerContent\",\"useRoomToolbox\",\"useGoToThreadList\",\"ChatProvider\",\"ThreadChat\",\"ThreadSkeleton\",\"ThreadTitle\",\"useThreadMainMessageQuery\",\"useToggleFollowingThreadMutation\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"_mainMessageQueryResu\",\"_mainMessageQueryResu2\",\"_mainMessageQueryResu3\",\"tmid\",\"goToThreadList\",\"replace\",\"closeTab\",\"mainMessageQueryResult\",\"onDelete\",\"t\",\"dispatchToastMessage\",\"canExpand\",\"expanded\",\"setExpanded\",\"uid\",\"following\",\"data\",\"replies\",\"includes\",\"toggleFollowingMutation\",\"onError\",\"error\",\"type\",\"message\",\"createElement\",\"Backdrop\",\"onClick\",\"handleBackdropClick\",\"flexGrow\",\"position\",\"className\",\"_templateObject\",\"undefined\",\"display\",\"flexDirection\",\"width\",\"overflow\",\"zIndex\",\"insetBlock\",\"border\",\"handleGoBack\",\"isLoading\",\"isSuccess\",\"mainMessage\",\"name\",\"title\",\"handleToggleExpand\",\"disabled\",\"handleToggleFollowing\",\"_mainMessageQueryResu4\",\"rid\",\"mutate\",\"follow\",\"handleClose\"],\"mappings\":\"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\"}"}