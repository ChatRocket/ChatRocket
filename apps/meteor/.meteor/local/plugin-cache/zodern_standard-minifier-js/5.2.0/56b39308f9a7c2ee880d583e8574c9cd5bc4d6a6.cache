{"code":"function module(e,t,n){n.link(\"@babel/runtime/regenerator\",{default:function(e){i=e}},0),n.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(e){s=e}},1),n.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){r=e}},2),n.export({useHistoryMessageList:function(){return m}}),n.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(e){o=e}},0),n.link(\"react\",{useCallback:function(e){u=e},useState:function(e){a=e}},1),n.link(\"../../../../hooks/lists/useScrollableMessageList\",{useScrollableMessageList:function(e){l=e}},2),n.link(\"../../../../hooks/useComponentDidUpdate\",{useComponentDidUpdate:function(e){c=e}},3),n.link(\"../../../../lib/lists/MessageList\",{MessageList:function(e){f=e}},4);var i,s,r,o,u,a,l,c,f,m=function(e){var t=a(function(){return new f}),n=r(t,2),m=n[0],d=n[1],p=u(function(){return d(new f)},[]),b=o(\"GET\",\"/v1/livechat/:rid/messages\",{rid:e.roomId});c(function(){e&&p()},[e,p]);var k=u(function(t,n){var r,o,u;return i.async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i.awrap(b(s(s({},e.filter&&{searchTerm:e.filter}),{},{offset:t,count:n,sort:'{ \"ts\": 1 }'})));case 2:return o=(r=a.sent).messages,u=r.total,a.abrupt(\"return\",{items:o,itemCount:u});case 6:case\"end\":return a.stop()}},null,null,null,Promise)},[b,e.filter]),g=l(m,k,25);return{itemsList:m,loadMoreItems:g.loadMoreItems,initialItemCount:g.initialItemCount}}}","map":"{\"version\":3,\"sources\":[\"client/views/omnichannel/contactHistory/MessageList/useHistoryMessageList.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useCallback, useState } from 'react';\\n\\nimport { useScrollableMessageList } from '../../../../hooks/lists/useScrollableMessageList';\\nimport { useComponentDidUpdate } from '../../../../hooks/useComponentDidUpdate';\\nimport { MessageList } from '../../../../lib/lists/MessageList';\\n\\ntype HistoryMessageListOptions = {\\n\\tfilter: string;\\n\\troomId: string;\\n};\\n\\nexport const useHistoryMessageList = (\\n\\toptions: HistoryMessageListOptions,\\n): {\\n\\titemsList: MessageList;\\n\\tinitialItemCount: number;\\n\\tloadMoreItems: (start: number, end: number) => void;\\n} => {\\n\\tconst [itemsList, setItemsList] = useState(() => new MessageList());\\n\\tconst reload = useCallback(() => setItemsList(new MessageList()), []);\\n\\n\\tconst getMessages = useEndpoint('GET', '/v1/livechat/:rid/messages', { rid: options.roomId });\\n\\n\\tuseComponentDidUpdate(() => {\\n\\t\\toptions && reload();\\n\\t}, [options, reload]);\\n\\n\\tconst fetchMessages = useCallback(\\n\\t\\tasync (start, end) => {\\n\\t\\t\\tconst { messages, total } = await getMessages({\\n\\t\\t\\t\\t...(options.filter && { searchTerm: options.filter }),\\n\\t\\t\\t\\toffset: start,\\n\\t\\t\\t\\tcount: end,\\n\\t\\t\\t\\tsort: `{ \\\"ts\\\": 1 }`,\\n\\t\\t\\t});\\n\\t\\t\\treturn {\\n\\t\\t\\t\\titems: messages,\\n\\t\\t\\t\\titemCount: total,\\n\\t\\t\\t};\\n\\t\\t},\\n\\t\\t[getMessages, options.filter],\\n\\t);\\n\\n\\tconst { loadMoreItems, initialItemCount } = useScrollableMessageList(itemsList, fetchMessages, 25);\\n\\n\\treturn {\\n\\t\\titemsList,\\n\\t\\tloadMoreItems,\\n\\t\\tinitialItemCount,\\n\\t};\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"_objectSpread\",\"_slicedToArray\",\"export\",\"useHistoryMessageList\",\"useEndpoint\",\"useCallback\",\"useState\",\"useScrollableMessageList\",\"useComponentDidUpdate\",\"MessageList\",\"options\",\"_useState\",\"_useState2\",\"itemsList\",\"setItemsList\",\"reload\",\"getMessages\",\"rid\",\"roomId\",\"fetchMessages\",\"start\",\"end\",\"_await$getMessages\",\"messages\",\"total\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"filter\",\"searchTerm\",\"offset\",\"count\",\"sort\",\"sent\",\"abrupt\",\"items\",\"itemCount\",\"stop\",\"Promise\",\"_useScrollableMessage\",\"loadMoreItems\",\"initialItemCount\"],\"mappings\":\"uBAAsBA,EAAMC,IAAA,CAAA,6BAA2B,CAAAC,QAAA,SAAAC,CAAA,EAAAC,EAAAD,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,uCAAA,CAAAC,QAAA,SAAAC,CAAA,EAAAE,EAAAF,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,uCAAA,CAAAC,QAAA,SAAAC,CAAA,EAAAG,EAAAH,CAAA,CAAA,EAAA,GAAvDH,EAAOO,MAAE,CAAA,CAAAC,sBAAmB,WAAA,OAA2BA,CAAA,CAAA,GAAAR,EAAAC,IAAA,CAAA,2BAAA,CAAAQ,YAAA,SAAAN,CAAA,EAAAM,EAAAN,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAAS,YAAA,SAAAP,CAAA,EAAAO,EAAAP,CAAA,EAAAQ,SAAA,SAAAR,CAAA,EAAAQ,EAAAR,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,mDAAA,CAAAW,yBAAA,SAAAT,CAAA,EAAAS,EAAAT,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,0CAAA,CAAAY,sBAAA,SAAAV,CAAA,EAAAU,EAAAV,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,oCAAA,CAAAa,YAAA,SAAAX,CAAA,EAAAW,EAAAX,CAAA,CAAA,EAAA,GAYhD,IAZPC,EAAuDC,EAAAC,EAAAG,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAY1CN,EAAwB,SACpCO,CAAkC,EAMlC,IAAAC,EAAkCL,EAAS,WAAA,OAAM,IAAIG,CAAa,GAACG,EAAAX,EAAAU,EAAA,GAA5DE,EAASD,CAAA,CAAA,EAAA,CAAEE,EAAYF,CAAA,CAAA,EAAA,CACxBG,EAASV,EAAY,WAAA,OAAMS,EAAa,IAAIL,EAAc,EAAE,EAAE,EAE9DO,EAAcZ,EAAY,MAAO,6BAA8B,CAAEa,IAAKP,EAAQQ,MAAAA,AAAM,GAE1FV,EAAsB,WACrBE,GAAWK,GACZ,EAAG,CAACL,EAASK,EAAO,EAEpB,IAAMI,EAAgBd,EACrB,SAAOe,CAAK,CAAEC,CAAG,EAAA,IAAAC,EAAAC,EAAAC,EAAA,OAAAzB,EAAA0B,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,OAAAF,EAAAE,IAAA,CAAA,EAAA7B,EAAA8B,KAAA,CACkBb,EAAWhB,EAAAA,EAAA,CAAA,EACxCU,EAAQoB,MAAM,EAAI,CAAEC,WAAYrB,EAAQoB,MAAAA,AAAM,GAAE,CAAA,EAAA,CACpDE,OAAQZ,EACRa,MAAOZ,EACPa,KAAI,aAAe,IAClB,MAAA,EALqB,OAAfX,EAAQD,AAKdA,CAAAA,EAAAI,EAAAS,IAAA,AAAAA,EALMZ,QAAQ,CAAEC,EAAKF,EAALE,KAAK,CAAAE,EAAAU,MAAA,CAAA,SAMhB,CACNC,MAAOd,EACPe,UAAWd,GACX,MAAA,EAAA,IAAA,MAAA,OAAAE,EAAAa,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EAEF,CAACxB,EAAaN,EAAQoB,MAAM,CAAC,EAG9BW,EAA4ClC,EAAyBM,EAAWM,EAAe,IAE/F,MAAO,CACNN,UAAAA,EACA6B,cAJoBD,EAAbC,aAAa,CAKpBC,iBALsCF,EAAhBE,gBAAgB,CAOxC\"}"}