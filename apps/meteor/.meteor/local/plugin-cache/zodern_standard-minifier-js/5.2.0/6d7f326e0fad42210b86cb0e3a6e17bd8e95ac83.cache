{"code":"function module(e,n,t){let s,r,i,a,o,l,c;let d=[\"type\"];t.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default(e){s=e}},0),t.link(\"meteor/meteor\",{Meteor(e){r=e}},0),t.link(\"meteor/tracker\",{Tracker(e){i=e}},1),t.link(\"../../../authorization/client\",{hasPermission(e){a=e}},2),t.link(\"../../../settings/client\",{settings(e){o=e}},3),t.link(\"../../../utils/client/lib/SDKClient\",{sdk(e){l=e}},4),t.link(\"../collections/CannedResponse\",{CannedResponse(e){c=e}},5),r.startup(()=>{i.autorun(async e=>{if(!r.userId()||!o.get(\"Canned_Responses_Enable\")||!a(\"view-canned-responses\"))return;i.afterFlush(()=>{try{l.stream(\"canned-responses\",[\"canned-responses\"],function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];let[i,a]=n,{agentsId:o}=a||{};if(!Array.isArray(o)||o.includes(r.userId()))switch(i.type){case\"changed\":{let{type:e}=i,n=s(i,d);c.upsert({_id:i._id},n);break}case\"removed\":c.remove({_id:i._id})}})}catch(e){console.log(e)}});let{responses:n}=await l.rest.get(\"/v1/canned-responses.get\");n.forEach(e=>c.insert(e)),e.stop()})})}","map":"{\"version\":3,\"sources\":[\"app/canned-responses/client/startup/responses.ts\",\"<anon>\"],\"sourcesContent\":[\"import { Meteor } from 'meteor/meteor';\\nimport { Tracker } from 'meteor/tracker';\\n\\nimport { hasPermission } from '../../../authorization/client';\\nimport { settings } from '../../../settings/client';\\nimport { sdk } from '../../../utils/client/lib/SDKClient';\\nimport { CannedResponse } from '../collections/CannedResponse';\\n\\nMeteor.startup(() => {\\n\\tTracker.autorun(async (c) => {\\n\\t\\tif (!Meteor.userId()) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tif (!settings.get('Canned_Responses_Enable')) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tif (!hasPermission('view-canned-responses')) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tTracker.afterFlush(() => {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\t// TODO: check options\\n\\t\\t\\t\\tsdk.stream('canned-responses', ['canned-responses'], (...[response, options]) => {\\n\\t\\t\\t\\t\\tconst { agentsId } = options || {};\\n\\t\\t\\t\\t\\tif (Array.isArray(agentsId) && !agentsId.includes(Meteor.userId())) {\\n\\t\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\tswitch (response.type) {\\n\\t\\t\\t\\t\\t\\tcase 'changed': {\\n\\t\\t\\t\\t\\t\\t\\tconst { type, ...fields } = response;\\n\\t\\t\\t\\t\\t\\t\\tCannedResponse.upsert({ _id: response._id }, fields);\\n\\t\\t\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\t\\tcase 'removed': {\\n\\t\\t\\t\\t\\t\\t\\tCannedResponse.remove({ _id: response._id });\\n\\t\\t\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t});\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tconsole.log(error);\\n\\t\\t\\t}\\n\\t\\t});\\n\\n\\t\\tconst { responses } = await sdk.rest.get('/v1/canned-responses.get');\\n\\t\\tresponses.forEach((response) => CannedResponse.insert(response));\\n\\t\\tc.stop();\\n\\t});\\n});\\n\",null],\"names\":[\"_objectWithoutProperties\",\"Meteor\",\"Tracker\",\"hasPermission\",\"settings\",\"sdk\",\"CannedResponse\",\"module\",\"link\",\"default\",\"v\",\"startup\",\"autorun\",\"c\",\"userId\",\"get\",\"afterFlush\",\"stream\",\"_len\",\"arguments\",\"length\",\"_ref\",\"Array\",\"_key\",\"response\",\"options\",\"agentsId\",\"isArray\",\"includes\",\"type\",\"fields\",\"_excluded\",\"upsert\",\"_id\",\"remove\",\"error\",\"console\",\"log\",\"responses\",\"rest\",\"forEach\",\"insert\",\"stop\"],\"mappings\":\"2BAAAA,EAAAC,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,iBAAhBC,EAAAC,IAAgB,CAAA,iDAAA,CAAAC,QAAAC,CAAA,EAAAV,EAAAU,CAAA,CAAA,EAAA,GAA9BH,EAAQC,IAAA,CAAM,gBAAgB,CAAAP,OAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,iBAAA,CAAAN,QAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,gCAAA,CAAAL,cAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,2BAAA,CAAAJ,SAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,sCAAA,CAAAH,IAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,gCAAA,CAAAF,eAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAQvCT,EAAOU,OAAO,CAAC,KACdT,EAAQU,OAAO,CAAC,MAAOC,IACtB,GAAI,CAACZ,EAAOa,MAAM,IAGd,CAACV,EAASW,GAAG,CAAC,4BAGd,CAACZ,EAAc,yBALlB,OAQDD,EAAQc,UAAU,CAAC,KAClB,GAAI,CAEHX,EAAIY,MAAM,CAAC,mBAAoB,CAAC,mBAAmB,CAAE,WAA2B,IAAA,IAAAC,EAAAC,UAAAC,MAAA,CAAAC,EAAA,AAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAAAF,CAAA,CAAAE,EAAA,CAAAJ,SAAA,CAAAI,EAAA,CAAA,GAAvB,CAACC,EAAUC,EAAQ,CAAAJ,EACrE,CAAEK,SAAAA,CAAAA,CAAU,CAAGD,GAAW,CAAA,EAChC,GAAIH,CAAAA,MAAMK,OAAO,CAACD,IAAcA,EAASE,QAAQ,CAAC3B,EAAOa,MAAM,IAI/D,OAAQU,EAASK,IAAI,EACpB,IAAK,UAAW,CACf,GAAM,CAAEA,KAAAA,CAAAA,CAAiB,CAAGL,EAAXM,EAAM9B,EAAKwB,EAAQO,GACpCzB,EAAe0B,MAAM,CAAC,CAAEC,IAAKT,EAASS,GAAAA,AAAG,EAAIH,GAC7C,KACD,CAEA,IAAK,UACJxB,EAAe4B,MAAM,CAAC,CAAED,IAAKT,EAASS,GAAAA,AAAG,EAG3C,CACD,EACD,CAAE,MAAOE,EAAO,CACfC,QAAQC,GAAG,CAACF,EACb,CACD,GAEA,GAAM,CAAEG,UAAAA,CAAAA,CAAW,CAAG,MAAMjC,EAAIkC,IAAI,CAACxB,GAAG,CAAC,4BACzCuB,EAAUE,OAAO,CAAEhB,GAAalB,EAAemC,MAAM,CAACjB,IACtDX,EAAE6B,IAAI,EACP,EACD\"}"}