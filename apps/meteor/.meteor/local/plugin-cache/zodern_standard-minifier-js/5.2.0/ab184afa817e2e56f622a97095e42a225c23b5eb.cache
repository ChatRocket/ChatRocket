{"code":"function module(e,t,n){var r,o,a,s,i,u,c,d,f,l,m;n.link(\"@babel/runtime/regenerator\",{default:function(e){r=e}},0),n.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(e){o=e},useRouteParameter:function(e){a=e},useRouter:function(e){s=e},useSetModal:function(e){i=e},useToastMessageDispatch:function(e){u=e}},0),n.link(\"@tanstack/react-query\",{useMutation:function(e){c=e},useQueryClient:function(e){d=e}},1),n.link(\"react\",{default:function(e){f=e}},2),n.link(\"react-i18next\",{useTranslation:function(e){l=e}},3),n.link(\"../../../../components/GenericModal\",{default:function(e){m=e}},4),n.exportDefault(function(e,t){var n=l().t,_=i(),p=u(),v=d(),y=o(\"POST\",\"/v1/users.setActiveStatus\"),M=o(\"POST\",\"/v1/moderation.user.deleteReportedMessages\"),g=o(\"POST\",\"/v1/moderation.dismissUserReports\"),k=s(),x=a(\"tab\"),S=c({mutationFn:y,onError:function(e){p({type:\"error\",message:e})},onSuccess:function(){p({type:\"success\",message:n(\"Moderation_User_deactivated\")})}}),R=c({mutationFn:M,onError:function(e){p({type:\"error\",message:e})},onSuccess:function(){p({type:\"success\",message:n(\"Moderation_Messages_deleted\")})}}),T=c({mutationFn:g,onError:function(e){p({type:\"error\",message:e})},onSuccess:function(){p({type:\"success\",message:n(\"Moderation_Reports_dismissed\")})}}),U=function(){_(f.createElement(m,{title:n(\"Moderation_Deactivate_User\"),confirmText:n(\"Moderation_Deactivate_User\"),variant:\"danger\",onConfirm:function(){return r.async(function(n){for(;;)switch(n.prev=n.next){case 0:if(_(),n.t0=!t,!n.t0){n.next=5;break}return n.next=5,r.awrap(R.mutateAsync({userId:e}));case 5:return n.next=7,r.awrap(S.mutateAsync({userId:e,activeStatus:!1,confirmRelinquish:!0}));case 7:return n.next=9,r.awrap(T.mutateAsync({userId:e}));case 9:v.invalidateQueries({queryKey:[\"moderation\"]}),k.navigate(\"/admin/moderation/\"+x);case 11:case\"end\":return n.stop()}},null,null,null,Promise)},onCancel:function(){return _()}},n(\"Moderation_Are_you_sure_you_want_to_deactivate_this_user\")))};return{id:\"deactiveUser\",content:n(\"Moderation_Deactivate_User\"),icon:\"ban\",onClick:function(){return U()}}})}","map":"{\"version\":3,\"sources\":[\"client/views/admin/moderation/hooks/useDeactivateUserAction.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { GenericMenuItemProps } from '@rocket.chat/ui-client';\\nimport { useEndpoint, useRouteParameter, useRouter, useSetModal, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\\nimport React from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport GenericModal from '../../../../components/GenericModal';\\n\\nconst useDeactivateUserAction = (userId: string, isUserReport?: boolean): GenericMenuItemProps => {\\n\\tconst { t } = useTranslation();\\n\\tconst setModal = useSetModal();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst queryClient = useQueryClient();\\n\\n\\tconst deactiveUser = useEndpoint('POST', '/v1/users.setActiveStatus');\\n\\tconst deleteMessages = useEndpoint('POST', '/v1/moderation.user.deleteReportedMessages');\\n\\tconst dismissUserReports = useEndpoint('POST', '/v1/moderation.dismissUserReports');\\n\\n\\tconst router = useRouter();\\n\\n\\tconst tab = useRouteParameter('tab');\\n\\n\\tconst handleDeactivateUser = useMutation({\\n\\t\\tmutationFn: deactiveUser,\\n\\t\\tonError: (error) => {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t},\\n\\t\\tonSuccess: () => {\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Moderation_User_deactivated') });\\n\\t\\t},\\n\\t});\\n\\n\\tconst handleDeleteMessages = useMutation({\\n\\t\\tmutationFn: deleteMessages,\\n\\t\\tonError: (error) => {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t},\\n\\t\\tonSuccess: () => {\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Moderation_Messages_deleted') });\\n\\t\\t},\\n\\t});\\n\\n\\tconst handleDismissUserReports = useMutation({\\n\\t\\tmutationFn: dismissUserReports,\\n\\t\\tonError: (error) => {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t},\\n\\t\\tonSuccess: () => {\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Moderation_Reports_dismissed') });\\n\\t\\t},\\n\\t});\\n\\n\\tconst onDeactivateUser = async () => {\\n\\t\\tsetModal();\\n\\t\\t!isUserReport && (await handleDeleteMessages.mutateAsync({ userId }));\\n\\t\\tawait handleDeactivateUser.mutateAsync({ userId, activeStatus: false, confirmRelinquish: true });\\n\\t\\tawait handleDismissUserReports.mutateAsync({ userId });\\n\\t\\tqueryClient.invalidateQueries({ queryKey: ['moderation'] });\\n\\t\\trouter.navigate(`/admin/moderation/${tab}`);\\n\\t};\\n\\n\\tconst confirmDeactivateUser = (): void => {\\n\\t\\tsetModal(\\n\\t\\t\\t<GenericModal\\n\\t\\t\\t\\ttitle={t('Moderation_Deactivate_User')}\\n\\t\\t\\t\\tconfirmText={t('Moderation_Deactivate_User')}\\n\\t\\t\\t\\tvariant='danger'\\n\\t\\t\\t\\tonConfirm={() => onDeactivateUser()}\\n\\t\\t\\t\\tonCancel={() => setModal()}\\n\\t\\t\\t>\\n\\t\\t\\t\\t{t('Moderation_Are_you_sure_you_want_to_deactivate_this_user')}\\n\\t\\t\\t</GenericModal>,\\n\\t\\t);\\n\\t};\\n\\n\\treturn {\\n\\t\\tid: 'deactiveUser',\\n\\t\\tcontent: t('Moderation_Deactivate_User'),\\n\\t\\ticon: 'ban',\\n\\t\\tonClick: () => confirmDeactivateUser(),\\n\\t};\\n};\\n\\nexport default useDeactivateUserAction;\\n\",null],\"names\":[\"_regeneratorRuntime\",\"useEndpoint\",\"useRouteParameter\",\"useRouter\",\"useSetModal\",\"useToastMessageDispatch\",\"useMutation\",\"useQueryClient\",\"React\",\"useTranslation\",\"GenericModal\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"userId\",\"isUserReport\",\"t\",\"_useTranslation\",\"setModal\",\"dispatchToastMessage\",\"queryClient\",\"deactiveUser\",\"deleteMessages\",\"dismissUserReports\",\"router\",\"tab\",\"handleDeactivateUser\",\"mutationFn\",\"onError\",\"error\",\"type\",\"message\",\"onSuccess\",\"handleDeleteMessages\",\"handleDismissUserReports\",\"confirmDeactivateUser\",\"createElement\",\"title\",\"confirmText\",\"variant\",\"onConfirm\",\"async\",\"_context\",\"prev\",\"next\",\"t0\",\"awrap\",\"mutateAsync\",\"activeStatus\",\"confirmRelinquish\",\"invalidateQueries\",\"queryKey\",\"navigate\",\"stop\",\"Promise\",\"onCancel\",\"id\",\"content\",\"icon\",\"onClick\"],\"mappings\":\"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\"}"}