{"code":"function module(e,t,o){let i,n,s,r,a,c,l,d,h,m,u,g,p;o.export({WebRTC:()=>b}),o.link(\"@rocket.chat/emitter\",{Emitter(e){i=e}},0),o.link(\"meteor/meteor\",{Meteor(e){n=e}},1),o.link(\"meteor/reactive-var\",{ReactiveVar(e){s=e}},2),o.link(\"meteor/tracker\",{Tracker(e){r=e}},3),o.link(\"../../../client/components/GenericModal\",{default(e){a=e}},4),o.link(\"../../../client/lib/imperativeModal\",{imperativeModal(e){c=e}},5),o.link(\"../../../client/lib/utils/goToRoomById\",{goToRoomById(e){l=e}},6),o.link(\"../../models/client\",{ChatSubscription(e){d=e}},7),o.link(\"../../settings/client\",{settings(e){h=e}},8),o.link(\"../../utils/client/lib/SDKClient\",{sdk(e){m=e}},9),o.link(\"../../utils/lib/i18n\",{t(e){u=e}},10),o.link(\"../lib/constants\",{WEB_RTC_EVENTS(e){g=e}},11),o.link(\"./screenShare\",{ChromeScreenShare(e){p=e}},12);class f extends i{constructor(e){super(),this.debug=!1,this.webrtcInstance=e,m.stream(\"notify-room\",[\"\".concat(this.webrtcInstance.room,\"/\").concat(g.WEB_RTC)],(e,t)=>{this.log(\"WebRTCTransportClass - onRoom\",e,t),this.emit(e,t)})}log(){!0===this.debug&&console.log(...arguments)}onUserStream(e,t){t.room===this.webrtcInstance.room&&(this.log(\"WebRTCTransportClass - onUser\",e,t),this.emit(e,t))}startCall(e){this.log(\"WebRTCTransportClass - startCall\",this.webrtcInstance.room,this.webrtcInstance.selfId),m.publish(\"notify-room-users\",[\"\".concat(this.webrtcInstance.room,\"/\").concat(g.WEB_RTC),g.CALL,{from:this.webrtcInstance.selfId,room:this.webrtcInstance.room,media:e.media,monitor:e.monitor}])}joinCall(e){this.log(\"WebRTCTransportClass - joinCall\",this.webrtcInstance.room,this.webrtcInstance.selfId),!0===e.monitor?m.publish(\"notify-user\",[\"\".concat(e.to,\"/\").concat(g.WEB_RTC),g.JOIN,{from:this.webrtcInstance.selfId,room:this.webrtcInstance.room,media:e.media,monitor:e.monitor}]):m.publish(\"notify-room-users\",[\"\".concat(this.webrtcInstance.room,\"/\").concat(g.WEB_RTC),g.JOIN,{from:this.webrtcInstance.selfId,room:this.webrtcInstance.room,media:e.media,monitor:e.monitor}])}sendCandidate(e){e.from=this.webrtcInstance.selfId,e.room=this.webrtcInstance.room,this.log(\"WebRTCTransportClass - sendCandidate\",e),m.publish(\"notify-user\",[\"\".concat(e.to,\"/\").concat(g.WEB_RTC),g.CANDIDATE,e])}sendDescription(e){e.from=this.webrtcInstance.selfId,e.room=this.webrtcInstance.room,this.log(\"WebRTCTransportClass - sendDescription\",e),m.publish(\"notify-user\",[\"\".concat(e.to,\"/\").concat(g.WEB_RTC),g.DESCRIPTION,e])}sendStatus(e){this.log(\"WebRTCTransportClass - sendStatus\",e,this.webrtcInstance.room),e.from=this.webrtcInstance.selfId,m.publish(\"notify-room\",[\"\".concat(this.webrtcInstance.room,\"/\").concat(g.WEB_RTC),g.STATUS,e])}onRemoteCall(e){return this.on(g.CALL,e)}onRemoteJoin(e){return this.on(g.JOIN,e)}onRemoteCandidate(e){return this.on(g.CANDIDATE,e)}onRemoteDescription(e){return this.on(g.DESCRIPTION,e)}onRemoteStatus(e){return this.on(g.STATUS,e)}}class C{constructor(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.resetCallInProgress=()=>{this.callInProgress.set(!1)},this.stopPeerConnection=e=>{let t=this.peerConnections[e];null!=t&&(delete this.peerConnections[e],t.close(),this.updateRemoteItems())},this.config={iceServers:[]},this.debug=!1,this.TransportClass=f,this.selfId=e,this.room=t;let i=h.get(\"WebRTC_Servers\");i&&\"\"!==i.trim()&&(i=(i=i.replace(/\\s/g,\"\")).split(\",\")).forEach(e=>{e=e.split(\"@\");let t={urls:e.pop()};1===e.length&&(e=e[0].split(\":\"),t.username=decodeURIComponent(e[0]),t.credential=decodeURIComponent(e[1])),this.config.iceServers.push(t)}),this.peerConnections={},this.remoteItems=new s([]),this.remoteItemsById=new s({}),this.callInProgress=new s(!1),this.audioEnabled=new s(!1),this.videoEnabled=new s(!1),this.overlayEnabled=new s(!1),this.screenShareEnabled=new s(!1),this.localUrl=new s,this.active=!1,this.remoteMonitoring=!1,this.monitor=!1,this.autoAccept=o,this.navigator=void 0;let n=navigator.userAgent.toLocaleLowerCase();-1!==n.indexOf(\"electron\")?this.navigator=\"electron\":-1!==n.indexOf(\"chrome\")?this.navigator=\"chrome\":-1!==n.indexOf(\"firefox\")?this.navigator=\"firefox\":-1!==n.indexOf(\"safari\")&&(this.navigator=\"safari\"),this.screenShareAvailable=[\"chrome\",\"firefox\",\"electron\"].includes(this.navigator),this.media={video:!0,audio:!0},this.transport=new this.TransportClass(this),this.transport.onRemoteCall(this.onRemoteCall.bind(this)),this.transport.onRemoteJoin(this.onRemoteJoin.bind(this)),this.transport.onRemoteCandidate(this.onRemoteCandidate.bind(this)),this.transport.onRemoteDescription(this.onRemoteDescription.bind(this)),this.transport.onRemoteStatus(this.onRemoteStatus.bind(this)),setInterval(this.checkPeerConnections.bind(this),1e3)}onUserStream(){return this.transport.onUserStream(...arguments)}log(){if(!0===this.debug){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];console.log.apply(console,t)}}onError(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];console.error.apply(console,t)}checkPeerConnections(){let{peerConnections:e}=this,t=Date.now();Object.entries(e).some(e=>{let[o,i]=e;return![\"connected\",\"completed\"].includes(i.iceConnectionState)&&i.createdAt+5e3<t&&(this.stopPeerConnection(o),!0)})}updateRemoteItems(){let e=[],t={},{peerConnections:o}=this;Object.entries(o).forEach(o=>{let[i,n]=o;n.getRemoteStreams().forEach(o=>{let s={id:i,url:o,state:n.iceConnectionState};switch(n.iceConnectionState){case\"checking\":s.stateText=\"Connecting...\";break;case\"connected\":case\"completed\":s.stateText=\"Connected\",s.connected=!0;break;case\"disconnected\":s.stateText=\"Disconnected\";break;case\"failed\":s.stateText=\"Failed\";break;case\"closed\":s.stateText=\"Closed\"}e.push(s),t[i]=s})}),this.remoteItems.set(e),this.remoteItemsById.set(t)}broadcastStatus(){if(!0!==this.active||!0===this.monitor||!0===this.remoteMonitoring)return;let e=[],{peerConnections:t}=this;Object.keys(t).entries(t=>{let[o,{remoteMedia:i}]=t;e.push({id:o,media:i})}),this.transport.sendStatus({media:this.media,remoteConnections:e})}onRemoteStatus(e){if(this.callInProgress.set(!0),clearTimeout(this.callInProgressTimeout),this.callInProgressTimeout=setTimeout(this.resetCallInProgress,2e3),!0!==this.active)return;let t=[{id:e.from,media:e.media},...e.remoteConnections];t.forEach(e=>{e.id!==this.selfId&&null==this.peerConnections[e.id]&&(this.log(\"reconnecting with\",e.id),this.onRemoteJoin({from:e.id,media:e.media}))})}getPeerConnection(e){if(null!=this.peerConnections[e])return this.peerConnections[e];let t=new RTCPeerConnection(this.config);return t.createdAt=Date.now(),t.remoteMedia={},this.peerConnections[e]=t,[\"icecandidate\",\"addstream\",\"removestream\",\"iceconnectionstatechange\",\"datachannel\",\"identityresult\",\"idpassertionerror\",\"idpvalidationerror\",\"negotiationneeded\",\"peeridentity\",\"signalingstatechange\"].forEach(o=>{t.addEventListener(o,t=>{this.log(e,t.type,t)})}),t.addEventListener(\"icecandidate\",t=>{null!=t.candidate&&this.transport.sendCandidate({to:e,candidate:{candidate:t.candidate.candidate,sdpMLineIndex:t.candidate.sdpMLineIndex,sdpMid:t.candidate.sdpMid}})}),t.addEventListener(\"addstream\",()=>{this.updateRemoteItems()}),t.addEventListener(\"removestream\",()=>{this.updateRemoteItems()}),t.addEventListener(\"iceconnectionstatechange\",()=>{(\"disconnected\"===t.iceConnectionState||\"closed\"===t.iceConnectionState)&&t===this.peerConnections[e]&&(this.stopPeerConnection(e),setTimeout(()=>{0===Object.keys(this.peerConnections).length&&this.stop()},3e3)),this.updateRemoteItems()}),t}_getUserMedia(e,t,o){let i=e=>{if(AudioContext&&e.getAudioTracks().length>0){let t=new AudioContext,o=t.createMediaStreamSource(e),i=t.createGain();o.connect(i);let n=t.createMediaStreamDestination();i.connect(n),i.gain.value=.6,e.removeTrack(e.getAudioTracks()[0]),e.addTrack(n.stream.getAudioTracks()[0]),e.volume=i,this.audioContext=t}t(e)};if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)return navigator.mediaDevices.getUserMedia(e).then(i).catch(o);navigator.getUserMedia(e,i,o)}getUserMedia(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.onError;if(!0!==e.desktop){this._getUserMedia(e,t,o);return}if(!0!==this.screenShareAvailable){console.log(\"Screen share is not avaliable\");return}let i=i=>{let n=function(){c.open({component:a,props:{variant:\"warning\",title:u(\"Refresh_your_page_after_install_to_enable_screen_sharing\")}})},s=\"chrome\"===this.navigator&&p.installed,r=\"firefox\"===this.navigator&&null!=window.rocketchatscreenshare;if(!s&&!r)return c.open({component:a,props:{title:u(\"Screen_Share\"),variant:\"warning\",confirmText:u(\"Install_Extension\"),cancelText:u(\"Cancel\"),children:u(\"You_need_install_an_extension_to_allow_screen_sharing\"),onConfirm:()=>{if(\"chrome\"===this.navigator){let e=\"https://chrome.google.com/webstore/detail/rocketchat-screen-share/nocfbnnmjnndkbipkabodnheejiegccf\";try{chrome.webstore.install(e,n,()=>{window.open(e),n()})}catch(t){console.log(t),window.open(e),n()}}else\"firefox\"===this.navigator&&(window.open(\"https://addons.mozilla.org/en-GB/firefox/addon/rocketchat-screen-share/\"),n())}}}),o(!1);let l=e=>{null!=i&&e.addTrack(i.getAudioTracks()[0]),t(e)};\"firefox\"===this.navigator?(e={audio:e.audio,video:{mozMediaSource:\"window\",mediaSource:\"window\"}},this._getUserMedia(e,l,o)):p.getSourceId(this.navigator,t=>{e={audio:!1,video:{mandatory:{chromeMediaSource:\"desktop\",chromeMediaSourceId:t,maxWidth:1280,maxHeight:720}}},this._getUserMedia(e,l,o)})};\"firefox\"===this.navigator||null==e.audio||!1===e.audio?i():this._getUserMedia({audio:e.audio},e=>{i(e)},()=>{i()})}getLocalUserMedia(e){for(var t=arguments.length,o=Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];if(this.log(\"getLocalUserMedia\",[e,...o]),null!=this.localStream)return e(null,this.localStream);this.getUserMedia(this.media,t=>{this.localStream=t,this.audioEnabled.get()||this.disableAudio(),this.videoEnabled.get()||this.disableVideo(),this.localUrl.set(t);let{peerConnections:o}=this;Object.entries(o).forEach(e=>{let[,o]=e;return o.addStream(t)}),document.querySelector(\"video#localVideo\").srcObject=t,e(null,this.localStream)},t=>{e(!1),this.onError(t)})}stopAllPeerConnections(){let{peerConnections:e}=this;Object.keys(e).forEach(this.stopPeerConnection),window.audioContext&&window.audioContext.close()}setAudioEnabled(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];null!=this.localStream&&(this.localStream.getAudioTracks().forEach(t=>{t.enabled=e}),this.audioEnabled.set(e))}disableAudio(){this.setAudioEnabled(!1)}enableAudio(){this.setAudioEnabled(!0)}toggleAudio(){return this.audioEnabled.get()?this.disableAudio():this.enableAudio()}setVideoEnabled(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];null!=this.localStream&&(this.localStream.getVideoTracks().forEach(t=>{t.enabled=e}),this.videoEnabled.set(e))}disableScreenShare(){this.setScreenShareEnabled(!1)}enableScreenShare(){this.setScreenShareEnabled(!0)}setScreenShareEnabled(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];null!=this.localStream&&(this.media.desktop=e,delete this.localStream,this.getLocalUserMedia(t=>{null==t&&(this.screenShareEnabled.set(e),this.stopAllPeerConnections(),this.joinCall())}))}disableVideo(){this.setVideoEnabled(!1)}enableVideo(){this.setVideoEnabled(!0)}toggleVideo(){return this.videoEnabled.get()?this.disableVideo():this.enableVideo()}stop(){this.active=!1,this.monitor=!1,this.remoteMonitoring=!1,null!=this.localStream&&void 0!==this.localStream&&this.localStream.getTracks().forEach(e=>e.stop()),this.localUrl.set(void 0),delete this.localStream,this.stopAllPeerConnections()}startCall(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var t=arguments.length,o=Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];this.log(\"startCall\",[e,...o]),this.media=e,this.getLocalUserMedia(()=>{this.active=!0,this.transport.startCall({media:this.media})})}startCallAsMonitor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var t=arguments.length,o=Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];this.log(\"startCallAsMonitor\",[e,...o]),this.media=e,this.active=!0,this.monitor=!0,this.transport.startCall({media:this.media,monitor:!0})}onRemoteCall(e){let t,o,i;if(!0===this.autoAccept){setTimeout(()=>{this.joinCall({to:e.from,monitor:e.monitor,media:e.media})},0);return}let s=n.users.findOne(e.from);s&&s.username&&(i=s.username);let r=d.findOne({rid:e.room});!0===e.monitor?(t=\"eye\",o=u(\"WebRTC_monitor_call_from_%s\",i)):r&&\"d\"===r.t?e.media&&e.media.video?(t=\"videocam\",o=u(\"WebRTC_direct_video_call_from_%s\",i)):(t=\"phone\",o=u(\"WebRTC_direct_audio_call_from_%s\",i)):e.media&&e.media.video?(t=\"videocam\",o=u(\"WebRTC_group_video_call_from_%s\",r.name)):(t=\"phone\",o=u(\"WebRTC_group_audio_call_from_%s\",r.name)),c.open({component:a,props:{title:o,icon:t,confirmText:u(\"Yes\"),cancelText:u(\"No\"),children:u(\"Do_you_want_to_accept\"),onConfirm:()=>(l(e.room),this.joinCall({to:e.from,monitor:e.monitor,media:e.media})),onCancel:()=>this.stop(),onClose:()=>this.stop()}})}joinCall(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.media=this.media;for(var t=arguments.length,o=Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];this.log(\"joinCall\",[e,...o]),this.getLocalUserMedia(()=>{this.remoteMonitoring=e.monitor,this.active=!0,this.transport.joinCall(e)})}onRemoteJoin(e){if(!0!==this.active)return;for(var t=arguments.length,o=Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];this.log(\"onRemoteJoin\",[e,...o]);let n=this.getPeerConnection(e.from);if(\"checking\"!==n.signalingState&&(this.stopPeerConnection(e.from),n=this.getPeerConnection(e.from)),\"new\"!==n.iceConnectionState)return;n.remoteMedia=e.media,this.localStream&&n.addStream(this.localStream);let s=t=>{n.setLocalDescription(new RTCSessionDescription(t),()=>{this.transport.sendDescription({to:e.from,type:\"offer\",ts:n.createdAt,media:this.media,description:{sdp:t.sdp,type:t.type}})},this.onError)};!0===e.monitor?n.createOffer(s,this.onError,{mandatory:{OfferToReceiveAudio:e.media.audio,OfferToReceiveVideo:e.media.video}}):n.createOffer(s,this.onError)}onRemoteOffer(e){if(!0!==this.active)return;for(var t=arguments.length,o=Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];this.log(\"onRemoteOffer\",[e,...o]);let n=this.getPeerConnection(e.from);if([\"have-local-offer\",\"stable\"].includes(n.signalingState)&&n.createdAt<e.ts&&(this.stopPeerConnection(e.from),n=this.getPeerConnection(e.from)),\"new\"===n.iceConnectionState){n.setRemoteDescription(new RTCSessionDescription(e.description));try{this.localStream&&n.addStream(this.localStream)}catch(e){console.log(e)}n.createAnswer(t=>{n.setLocalDescription(new RTCSessionDescription(t),()=>{this.transport.sendDescription({to:e.from,type:\"answer\",ts:n.createdAt,description:{sdp:t.sdp,type:t.type}})},this.onError)},this.onError)}}onRemoteCandidate(e){var t;if(!0!==this.active||e.to!==this.selfId)return;for(var o=arguments.length,i=Array(o>1?o-1:0),n=1;n<o;n++)i[n-1]=arguments[n];this.log(\"onRemoteCandidate\",[e,...i]);let s=this.getPeerConnection(e.from);\"closed\"!==s.iceConnectionState&&\"failed\"!==s.iceConnectionState&&\"disconnected\"!==s.iceConnectionState&&\"completed\"!==s.iceConnectionState&&s.addIceCandidate(new RTCIceCandidate(e.candidate)),document.querySelector(\"video#remoteVideo\").srcObject=null===(t=this.remoteItems.get()[0])||void 0===t?void 0:t.url}onRemoteDescription(e){if(!0!==this.active||e.to!==this.selfId)return;for(var t=arguments.length,o=Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];this.log(\"onRemoteDescription\",[e,...o]);let n=this.getPeerConnection(e.from);\"offer\"===e.type?(n.remoteMedia=e.media,this.onRemoteOffer({from:e.from,ts:e.ts,description:e.description})):n.setRemoteDescription(new RTCSessionDescription(e.description))}}let b=new class{constructor(){this.instancesByRoomId={}}getInstanceByRoomId(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=!1;if(t)o=\"WebRTC\"===h.get(\"Omnichannel_call_provider\");else{let t=d.findOne({rid:e});if(!t)return;switch(t.t){case\"d\":o=h.get(\"WebRTC_Enable_Direct\");break;case\"p\":o=h.get(\"WebRTC_Enable_Private\");break;case\"c\":o=h.get(\"WebRTC_Enable_Channel\");break;case\"l\":o=\"WebRTC\"===h.get(\"Omnichannel_call_provider\")}}if(!1!==(o=o&&h.get(\"WebRTC_Enabled\"))){if(null==this.instancesByRoomId[e]){let o=n.userId(),i=!1;t&&(o=t,i=!0),this.instancesByRoomId[e]=new C(o,e,i)}return this.instancesByRoomId[e]}}};n.startup(()=>{r.autorun(()=>{n.userId()&&m.stream(\"notify-user\",[\"\".concat(n.userId(),\"/\").concat(g.WEB_RTC)],(e,t)=>{if(null==t.room)return;let o=b.getInstanceByRoomId(t.room);o.onUserStream(e,t)})})})}","map":"{\"version\":3,\"sources\":[\"app/webrtc/client/WebRTCClass.js\",\"<anon>\"],\"sourcesContent\":[\"import { Emitter } from '@rocket.chat/emitter';\\nimport { Meteor } from 'meteor/meteor';\\nimport { ReactiveVar } from 'meteor/reactive-var';\\nimport { Tracker } from 'meteor/tracker';\\n\\nimport GenericModal from '../../../client/components/GenericModal';\\nimport { imperativeModal } from '../../../client/lib/imperativeModal';\\nimport { goToRoomById } from '../../../client/lib/utils/goToRoomById';\\nimport { ChatSubscription } from '../../models/client';\\nimport { settings } from '../../settings/client';\\nimport { sdk } from '../../utils/client/lib/SDKClient';\\nimport { t } from '../../utils/lib/i18n';\\nimport { WEB_RTC_EVENTS } from '../lib/constants';\\nimport { ChromeScreenShare } from './screenShare';\\n\\nclass WebRTCTransportClass extends Emitter {\\n\\tconstructor(webrtcInstance) {\\n\\t\\tsuper();\\n\\t\\tthis.debug = false;\\n\\t\\tthis.webrtcInstance = webrtcInstance;\\n\\t\\tsdk.stream('notify-room', [`${this.webrtcInstance.room}/${WEB_RTC_EVENTS.WEB_RTC}`], (type, data) => {\\n\\t\\t\\tthis.log('WebRTCTransportClass - onRoom', type, data);\\n\\t\\t\\tthis.emit(type, data);\\n\\t\\t});\\n\\t}\\n\\n\\tlog(...args) {\\n\\t\\tif (this.debug === true) {\\n\\t\\t\\tconsole.log(...args);\\n\\t\\t}\\n\\t}\\n\\n\\tonUserStream(type, data) {\\n\\t\\tif (data.room !== this.webrtcInstance.room) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tthis.log('WebRTCTransportClass - onUser', type, data);\\n\\t\\tthis.emit(type, data);\\n\\t}\\n\\n\\tstartCall(data) {\\n\\t\\tthis.log('WebRTCTransportClass - startCall', this.webrtcInstance.room, this.webrtcInstance.selfId);\\n\\t\\tsdk.publish('notify-room-users', [\\n\\t\\t\\t`${this.webrtcInstance.room}/${WEB_RTC_EVENTS.WEB_RTC}`,\\n\\t\\t\\tWEB_RTC_EVENTS.CALL,\\n\\t\\t\\t{\\n\\t\\t\\t\\tfrom: this.webrtcInstance.selfId,\\n\\t\\t\\t\\troom: this.webrtcInstance.room,\\n\\t\\t\\t\\tmedia: data.media,\\n\\t\\t\\t\\tmonitor: data.monitor,\\n\\t\\t\\t},\\n\\t\\t]);\\n\\t}\\n\\n\\tjoinCall(data) {\\n\\t\\tthis.log('WebRTCTransportClass - joinCall', this.webrtcInstance.room, this.webrtcInstance.selfId);\\n\\t\\tif (data.monitor === true) {\\n\\t\\t\\tsdk.publish('notify-user', [\\n\\t\\t\\t\\t`${data.to}/${WEB_RTC_EVENTS.WEB_RTC}`,\\n\\t\\t\\t\\tWEB_RTC_EVENTS.JOIN,\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\tfrom: this.webrtcInstance.selfId,\\n\\t\\t\\t\\t\\troom: this.webrtcInstance.room,\\n\\t\\t\\t\\t\\tmedia: data.media,\\n\\t\\t\\t\\t\\tmonitor: data.monitor,\\n\\t\\t\\t\\t},\\n\\t\\t\\t]);\\n\\t\\t} else {\\n\\t\\t\\tsdk.publish('notify-room-users', [\\n\\t\\t\\t\\t`${this.webrtcInstance.room}/${WEB_RTC_EVENTS.WEB_RTC}`,\\n\\t\\t\\t\\tWEB_RTC_EVENTS.JOIN,\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\tfrom: this.webrtcInstance.selfId,\\n\\t\\t\\t\\t\\troom: this.webrtcInstance.room,\\n\\t\\t\\t\\t\\tmedia: data.media,\\n\\t\\t\\t\\t\\tmonitor: data.monitor,\\n\\t\\t\\t\\t},\\n\\t\\t\\t]);\\n\\t\\t}\\n\\t}\\n\\n\\tsendCandidate(data) {\\n\\t\\tdata.from = this.webrtcInstance.selfId;\\n\\t\\tdata.room = this.webrtcInstance.room;\\n\\t\\tthis.log('WebRTCTransportClass - sendCandidate', data);\\n\\t\\tsdk.publish('notify-user', [`${data.to}/${WEB_RTC_EVENTS.WEB_RTC}`, WEB_RTC_EVENTS.CANDIDATE, data]);\\n\\t}\\n\\n\\tsendDescription(data) {\\n\\t\\tdata.from = this.webrtcInstance.selfId;\\n\\t\\tdata.room = this.webrtcInstance.room;\\n\\t\\tthis.log('WebRTCTransportClass - sendDescription', data);\\n\\t\\tsdk.publish('notify-user', [`${data.to}/${WEB_RTC_EVENTS.WEB_RTC}`, WEB_RTC_EVENTS.DESCRIPTION, data]);\\n\\t}\\n\\n\\tsendStatus(data) {\\n\\t\\tthis.log('WebRTCTransportClass - sendStatus', data, this.webrtcInstance.room);\\n\\t\\tdata.from = this.webrtcInstance.selfId;\\n\\t\\tsdk.publish('notify-room', [`${this.webrtcInstance.room}/${WEB_RTC_EVENTS.WEB_RTC}`, WEB_RTC_EVENTS.STATUS, data]);\\n\\t}\\n\\n\\tonRemoteCall(fn) {\\n\\t\\treturn this.on(WEB_RTC_EVENTS.CALL, fn);\\n\\t}\\n\\n\\tonRemoteJoin(fn) {\\n\\t\\treturn this.on(WEB_RTC_EVENTS.JOIN, fn);\\n\\t}\\n\\n\\tonRemoteCandidate(fn) {\\n\\t\\treturn this.on(WEB_RTC_EVENTS.CANDIDATE, fn);\\n\\t}\\n\\n\\tonRemoteDescription(fn) {\\n\\t\\treturn this.on(WEB_RTC_EVENTS.DESCRIPTION, fn);\\n\\t}\\n\\n\\tonRemoteStatus(fn) {\\n\\t\\treturn this.on(WEB_RTC_EVENTS.STATUS, fn);\\n\\t}\\n}\\n\\nclass WebRTCClass {\\n\\t/*\\n  \\t\\t@param seldId {String}\\n  \\t\\t@param room {String}\\n   */\\n\\n\\tconstructor(selfId, room, autoAccept = false) {\\n\\t\\tthis.config = {\\n\\t\\t\\ticeServers: [],\\n\\t\\t};\\n\\t\\tthis.debug = false;\\n\\t\\tthis.TransportClass = WebRTCTransportClass;\\n\\t\\tthis.selfId = selfId;\\n\\t\\tthis.room = room;\\n\\t\\tlet servers = settings.get('WebRTC_Servers');\\n\\t\\tif (servers && servers.trim() !== '') {\\n\\t\\t\\tservers = servers.replace(/\\\\s/g, '');\\n\\t\\t\\tservers = servers.split(',');\\n\\n\\t\\t\\tservers.forEach((server) => {\\n\\t\\t\\t\\tserver = server.split('@');\\n\\t\\t\\t\\tconst serverConfig = {\\n\\t\\t\\t\\t\\turls: server.pop(),\\n\\t\\t\\t\\t};\\n\\t\\t\\t\\tif (server.length === 1) {\\n\\t\\t\\t\\t\\tserver = server[0].split(':');\\n\\t\\t\\t\\t\\tserverConfig.username = decodeURIComponent(server[0]);\\n\\t\\t\\t\\t\\tserverConfig.credential = decodeURIComponent(server[1]);\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tthis.config.iceServers.push(serverConfig);\\n\\t\\t\\t});\\n\\t\\t}\\n\\t\\tthis.peerConnections = {};\\n\\t\\tthis.remoteItems = new ReactiveVar([]);\\n\\t\\tthis.remoteItemsById = new ReactiveVar({});\\n\\t\\tthis.callInProgress = new ReactiveVar(false);\\n\\t\\tthis.audioEnabled = new ReactiveVar(false);\\n\\t\\tthis.videoEnabled = new ReactiveVar(false);\\n\\t\\tthis.overlayEnabled = new ReactiveVar(false);\\n\\t\\tthis.screenShareEnabled = new ReactiveVar(false);\\n\\t\\tthis.localUrl = new ReactiveVar();\\n\\t\\tthis.active = false;\\n\\t\\tthis.remoteMonitoring = false;\\n\\t\\tthis.monitor = false;\\n\\t\\tthis.autoAccept = autoAccept;\\n\\t\\tthis.navigator = undefined;\\n\\t\\tconst userAgent = navigator.userAgent.toLocaleLowerCase();\\n\\n\\t\\tif (userAgent.indexOf('electron') !== -1) {\\n\\t\\t\\tthis.navigator = 'electron';\\n\\t\\t} else if (userAgent.indexOf('chrome') !== -1) {\\n\\t\\t\\tthis.navigator = 'chrome';\\n\\t\\t} else if (userAgent.indexOf('firefox') !== -1) {\\n\\t\\t\\tthis.navigator = 'firefox';\\n\\t\\t} else if (userAgent.indexOf('safari') !== -1) {\\n\\t\\t\\tthis.navigator = 'safari';\\n\\t\\t}\\n\\n\\t\\tthis.screenShareAvailable = ['chrome', 'firefox', 'electron'].includes(this.navigator);\\n\\t\\tthis.media = {\\n\\t\\t\\tvideo: true,\\n\\t\\t\\taudio: true,\\n\\t\\t};\\n\\t\\tthis.transport = new this.TransportClass(this);\\n\\t\\tthis.transport.onRemoteCall(this.onRemoteCall.bind(this));\\n\\t\\tthis.transport.onRemoteJoin(this.onRemoteJoin.bind(this));\\n\\t\\tthis.transport.onRemoteCandidate(this.onRemoteCandidate.bind(this));\\n\\t\\tthis.transport.onRemoteDescription(this.onRemoteDescription.bind(this));\\n\\t\\tthis.transport.onRemoteStatus(this.onRemoteStatus.bind(this));\\n\\n\\t\\tsetInterval(this.checkPeerConnections.bind(this), 1000);\\n\\t}\\n\\n\\tonUserStream(...args) {\\n\\t\\treturn this.transport.onUserStream(...args);\\n\\t}\\n\\n\\tlog(...args) {\\n\\t\\tif (this.debug === true) {\\n\\t\\t\\tconsole.log.apply(console, args);\\n\\t\\t}\\n\\t}\\n\\n\\tonError(...args) {\\n\\t\\tconsole.error.apply(console, args);\\n\\t}\\n\\n\\tcheckPeerConnections() {\\n\\t\\tconst { peerConnections } = this;\\n\\t\\tconst date = Date.now();\\n\\t\\tObject.entries(peerConnections).some(([id, peerConnection]) => {\\n\\t\\t\\tif (!['connected', 'completed'].includes(peerConnection.iceConnectionState) && peerConnection.createdAt + 5000 < date) {\\n\\t\\t\\t\\tthis.stopPeerConnection(id);\\n\\t\\t\\t\\treturn true;\\n\\t\\t\\t}\\n\\t\\t\\treturn false;\\n\\t\\t});\\n\\t}\\n\\n\\tupdateRemoteItems() {\\n\\t\\tconst items = [];\\n\\t\\tconst itemsById = {};\\n\\t\\tconst { peerConnections } = this;\\n\\n\\t\\tObject.entries(peerConnections).forEach(([id, peerConnection]) => {\\n\\t\\t\\tpeerConnection.getRemoteStreams().forEach((remoteStream) => {\\n\\t\\t\\t\\tconst item = {\\n\\t\\t\\t\\t\\tid,\\n\\t\\t\\t\\t\\turl: remoteStream,\\n\\t\\t\\t\\t\\tstate: peerConnection.iceConnectionState,\\n\\t\\t\\t\\t};\\n\\t\\t\\t\\tswitch (peerConnection.iceConnectionState) {\\n\\t\\t\\t\\t\\tcase 'checking':\\n\\t\\t\\t\\t\\t\\titem.stateText = 'Connecting...';\\n\\t\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t\\tcase 'connected':\\n\\t\\t\\t\\t\\tcase 'completed':\\n\\t\\t\\t\\t\\t\\titem.stateText = 'Connected';\\n\\t\\t\\t\\t\\t\\titem.connected = true;\\n\\t\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t\\tcase 'disconnected':\\n\\t\\t\\t\\t\\t\\titem.stateText = 'Disconnected';\\n\\t\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t\\tcase 'failed':\\n\\t\\t\\t\\t\\t\\titem.stateText = 'Failed';\\n\\t\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t\\tcase 'closed':\\n\\t\\t\\t\\t\\t\\titem.stateText = 'Closed';\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\titems.push(item);\\n\\t\\t\\t\\titemsById[id] = item;\\n\\t\\t\\t});\\n\\t\\t});\\n\\t\\tthis.remoteItems.set(items);\\n\\t\\tthis.remoteItemsById.set(itemsById);\\n\\t}\\n\\n\\tresetCallInProgress = () => {\\n\\t\\tthis.callInProgress.set(false);\\n\\t};\\n\\n\\tbroadcastStatus() {\\n\\t\\tif (this.active !== true || this.monitor === true || this.remoteMonitoring === true) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tconst remoteConnections = [];\\n\\t\\tconst { peerConnections } = this;\\n\\t\\tObject.keys(peerConnections).entries(([id, { remoteMedia: media }]) => {\\n\\t\\t\\tremoteConnections.push({\\n\\t\\t\\t\\tid,\\n\\t\\t\\t\\tmedia,\\n\\t\\t\\t});\\n\\t\\t});\\n\\n\\t\\tthis.transport.sendStatus({\\n\\t\\t\\tmedia: this.media,\\n\\t\\t\\tremoteConnections,\\n\\t\\t});\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param data {Object}\\n  \\t\\t\\tfrom {String}\\n  \\t\\t\\tmedia {Object}\\n  \\t\\t\\tremoteConnections {Array[Object]}\\n  \\t\\t\\t\\tid {String}\\n  \\t\\t\\t\\tmedia {Object}\\n   */\\n\\n\\tonRemoteStatus(data) {\\n\\t\\t// this.log(onRemoteStatus, arguments);\\n\\t\\tthis.callInProgress.set(true);\\n\\t\\tclearTimeout(this.callInProgressTimeout);\\n\\t\\tthis.callInProgressTimeout = setTimeout(this.resetCallInProgress, 2000);\\n\\t\\tif (this.active !== true) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tconst remoteConnections = [\\n\\t\\t\\t{\\n\\t\\t\\t\\tid: data.from,\\n\\t\\t\\t\\tmedia: data.media,\\n\\t\\t\\t},\\n\\t\\t\\t...data.remoteConnections,\\n\\t\\t];\\n\\n\\t\\tremoteConnections.forEach((remoteConnection) => {\\n\\t\\t\\tif (remoteConnection.id !== this.selfId && this.peerConnections[remoteConnection.id] == null) {\\n\\t\\t\\t\\tthis.log('reconnecting with', remoteConnection.id);\\n\\t\\t\\t\\tthis.onRemoteJoin({\\n\\t\\t\\t\\t\\tfrom: remoteConnection.id,\\n\\t\\t\\t\\t\\tmedia: remoteConnection.media,\\n\\t\\t\\t\\t});\\n\\t\\t\\t}\\n\\t\\t});\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param id {String}\\n   */\\n\\n\\tgetPeerConnection(id) {\\n\\t\\tif (this.peerConnections[id] != null) {\\n\\t\\t\\treturn this.peerConnections[id];\\n\\t\\t}\\n\\t\\tconst peerConnection = new RTCPeerConnection(this.config);\\n\\n\\t\\tpeerConnection.createdAt = Date.now();\\n\\t\\tpeerConnection.remoteMedia = {};\\n\\t\\tthis.peerConnections[id] = peerConnection;\\n\\t\\tconst eventNames = [\\n\\t\\t\\t'icecandidate',\\n\\t\\t\\t'addstream',\\n\\t\\t\\t'removestream',\\n\\t\\t\\t'iceconnectionstatechange',\\n\\t\\t\\t'datachannel',\\n\\t\\t\\t'identityresult',\\n\\t\\t\\t'idpassertionerror',\\n\\t\\t\\t'idpvalidationerror',\\n\\t\\t\\t'negotiationneeded',\\n\\t\\t\\t'peeridentity',\\n\\t\\t\\t'signalingstatechange',\\n\\t\\t];\\n\\n\\t\\teventNames.forEach((eventName) => {\\n\\t\\t\\tpeerConnection.addEventListener(eventName, (e) => {\\n\\t\\t\\t\\tthis.log(id, e.type, e);\\n\\t\\t\\t});\\n\\t\\t});\\n\\n\\t\\tpeerConnection.addEventListener('icecandidate', (e) => {\\n\\t\\t\\tif (e.candidate == null) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t\\tthis.transport.sendCandidate({\\n\\t\\t\\t\\tto: id,\\n\\t\\t\\t\\tcandidate: {\\n\\t\\t\\t\\t\\tcandidate: e.candidate.candidate,\\n\\t\\t\\t\\t\\tsdpMLineIndex: e.candidate.sdpMLineIndex,\\n\\t\\t\\t\\t\\tsdpMid: e.candidate.sdpMid,\\n\\t\\t\\t\\t},\\n\\t\\t\\t});\\n\\t\\t});\\n\\t\\tpeerConnection.addEventListener('addstream', () => {\\n\\t\\t\\tthis.updateRemoteItems();\\n\\t\\t});\\n\\t\\tpeerConnection.addEventListener('removestream', () => {\\n\\t\\t\\tthis.updateRemoteItems();\\n\\t\\t});\\n\\t\\tpeerConnection.addEventListener('iceconnectionstatechange', () => {\\n\\t\\t\\tif (\\n\\t\\t\\t\\t(peerConnection.iceConnectionState === 'disconnected' || peerConnection.iceConnectionState === 'closed') &&\\n\\t\\t\\t\\tpeerConnection === this.peerConnections[id]\\n\\t\\t\\t) {\\n\\t\\t\\t\\tthis.stopPeerConnection(id);\\n\\t\\t\\t\\tsetTimeout(() => {\\n\\t\\t\\t\\t\\tif (Object.keys(this.peerConnections).length === 0) {\\n\\t\\t\\t\\t\\t\\tthis.stop();\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}, 3000);\\n\\t\\t\\t}\\n\\t\\t\\tthis.updateRemoteItems();\\n\\t\\t});\\n\\t\\treturn peerConnection;\\n\\t}\\n\\n\\t_getUserMedia(media, onSuccess, onError) {\\n\\t\\tconst onSuccessLocal = (stream) => {\\n\\t\\t\\tif (AudioContext && stream.getAudioTracks().length > 0) {\\n\\t\\t\\t\\tconst audioContext = new AudioContext();\\n\\t\\t\\t\\tconst source = audioContext.createMediaStreamSource(stream);\\n\\t\\t\\t\\tconst volume = audioContext.createGain();\\n\\t\\t\\t\\tsource.connect(volume);\\n\\t\\t\\t\\tconst peer = audioContext.createMediaStreamDestination();\\n\\t\\t\\t\\tvolume.connect(peer);\\n\\t\\t\\t\\tvolume.gain.value = 0.6;\\n\\t\\t\\t\\tstream.removeTrack(stream.getAudioTracks()[0]);\\n\\t\\t\\t\\tstream.addTrack(peer.stream.getAudioTracks()[0]);\\n\\t\\t\\t\\tstream.volume = volume;\\n\\t\\t\\t\\tthis.audioContext = audioContext;\\n\\t\\t\\t}\\n\\t\\t\\tonSuccess(stream);\\n\\t\\t};\\n\\t\\tif (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\\n\\t\\t\\treturn navigator.mediaDevices.getUserMedia(media).then(onSuccessLocal).catch(onError);\\n\\t\\t}\\n\\n\\t\\tnavigator.getUserMedia(media, onSuccessLocal, onError);\\n\\t}\\n\\n\\tgetUserMedia(media, onSuccess, onError = this.onError) {\\n\\t\\tif (media.desktop !== true) {\\n\\t\\t\\tthis._getUserMedia(media, onSuccess, onError);\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tif (this.screenShareAvailable !== true) {\\n\\t\\t\\tconsole.log('Screen share is not avaliable');\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tconst getScreen = (audioStream) => {\\n\\t\\t\\tconst refresh = function () {\\n\\t\\t\\t\\timperativeModal.open({\\n\\t\\t\\t\\t\\tcomponent: GenericModal,\\n\\t\\t\\t\\t\\tprops: {\\n\\t\\t\\t\\t\\t\\tvariant: 'warning',\\n\\t\\t\\t\\t\\t\\ttitle: t('Refresh_your_page_after_install_to_enable_screen_sharing'),\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t});\\n\\t\\t\\t};\\n\\n\\t\\t\\tconst isChromeExtensionInstalled = this.navigator === 'chrome' && ChromeScreenShare.installed;\\n\\t\\t\\tconst isFirefoxExtensionInstalled = this.navigator === 'firefox' && window.rocketchatscreenshare != null;\\n\\n\\t\\t\\tif (!isChromeExtensionInstalled && !isFirefoxExtensionInstalled) {\\n\\t\\t\\t\\timperativeModal.open({\\n\\t\\t\\t\\t\\tcomponent: GenericModal,\\n\\t\\t\\t\\t\\tprops: {\\n\\t\\t\\t\\t\\t\\ttitle: t('Screen_Share'),\\n\\t\\t\\t\\t\\t\\tvariant: 'warning',\\n\\t\\t\\t\\t\\t\\tconfirmText: t('Install_Extension'),\\n\\t\\t\\t\\t\\t\\tcancelText: t('Cancel'),\\n\\t\\t\\t\\t\\t\\tchildren: t('You_need_install_an_extension_to_allow_screen_sharing'),\\n\\t\\t\\t\\t\\t\\tonConfirm: () => {\\n\\t\\t\\t\\t\\t\\t\\tif (this.navigator === 'chrome') {\\n\\t\\t\\t\\t\\t\\t\\t\\tconst url = 'https://chrome.google.com/webstore/detail/rocketchat-screen-share/nocfbnnmjnndkbipkabodnheejiegccf';\\n\\t\\t\\t\\t\\t\\t\\t\\ttry {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tchrome.webstore.install(url, refresh, () => {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\twindow.open(url);\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\trefresh();\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t\\t\\t\\t\\t} catch (_error) {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tconsole.log(_error);\\n\\t\\t\\t\\t\\t\\t\\t\\t\\twindow.open(url);\\n\\t\\t\\t\\t\\t\\t\\t\\t\\trefresh();\\n\\t\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t\\t} else if (this.navigator === 'firefox') {\\n\\t\\t\\t\\t\\t\\t\\t\\twindow.open('https://addons.mozilla.org/en-GB/firefox/addon/rocketchat-screen-share/');\\n\\t\\t\\t\\t\\t\\t\\t\\trefresh();\\n\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\t\\treturn onError(false);\\n\\t\\t\\t}\\n\\n\\t\\t\\tconst getScreenSuccess = (stream) => {\\n\\t\\t\\t\\tif (audioStream != null) {\\n\\t\\t\\t\\t\\tstream.addTrack(audioStream.getAudioTracks()[0]);\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tonSuccess(stream);\\n\\t\\t\\t};\\n\\t\\t\\tif (this.navigator === 'firefox') {\\n\\t\\t\\t\\tmedia = {\\n\\t\\t\\t\\t\\taudio: media.audio,\\n\\t\\t\\t\\t\\tvideo: {\\n\\t\\t\\t\\t\\t\\tmozMediaSource: 'window',\\n\\t\\t\\t\\t\\t\\tmediaSource: 'window',\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t};\\n\\t\\t\\t\\tthis._getUserMedia(media, getScreenSuccess, onError);\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tChromeScreenShare.getSourceId(this.navigator, (id) => {\\n\\t\\t\\t\\t\\tmedia = {\\n\\t\\t\\t\\t\\t\\taudio: false,\\n\\t\\t\\t\\t\\t\\tvideo: {\\n\\t\\t\\t\\t\\t\\t\\tmandatory: {\\n\\t\\t\\t\\t\\t\\t\\t\\tchromeMediaSource: 'desktop',\\n\\t\\t\\t\\t\\t\\t\\t\\tchromeMediaSourceId: id,\\n\\t\\t\\t\\t\\t\\t\\t\\tmaxWidth: 1280,\\n\\t\\t\\t\\t\\t\\t\\t\\tmaxHeight: 720,\\n\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t};\\n\\t\\t\\t\\t\\tthis._getUserMedia(media, getScreenSuccess, onError);\\n\\t\\t\\t\\t});\\n\\t\\t\\t}\\n\\t\\t};\\n\\t\\tif (this.navigator === 'firefox' || media.audio == null || media.audio === false) {\\n\\t\\t\\tgetScreen();\\n\\t\\t} else {\\n\\t\\t\\tconst getAudioSuccess = (audioStream) => {\\n\\t\\t\\t\\tgetScreen(audioStream);\\n\\t\\t\\t};\\n\\t\\t\\tconst getAudioError = () => {\\n\\t\\t\\t\\tgetScreen();\\n\\t\\t\\t};\\n\\n\\t\\t\\tthis._getUserMedia(\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\taudio: media.audio,\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\tgetAudioSuccess,\\n\\t\\t\\t\\tgetAudioError,\\n\\t\\t\\t);\\n\\t\\t}\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param callback {Function}\\n   */\\n\\n\\tgetLocalUserMedia(callback, ...args) {\\n\\t\\tthis.log('getLocalUserMedia', [callback, ...args]);\\n\\t\\tif (this.localStream != null) {\\n\\t\\t\\treturn callback(null, this.localStream);\\n\\t\\t}\\n\\t\\tconst onSuccess = (stream) => {\\n\\t\\t\\tthis.localStream = stream;\\n\\t\\t\\t!this.audioEnabled.get() && this.disableAudio();\\n\\t\\t\\t!this.videoEnabled.get() && this.disableVideo();\\n\\t\\t\\tthis.localUrl.set(stream);\\n\\t\\t\\tconst { peerConnections } = this;\\n\\t\\t\\tObject.entries(peerConnections).forEach(([, peerConnection]) => peerConnection.addStream(stream));\\n\\t\\t\\tdocument.querySelector('video#localVideo').srcObject = stream;\\n\\t\\t\\tcallback(null, this.localStream);\\n\\t\\t};\\n\\t\\tconst onError = (error) => {\\n\\t\\t\\tcallback(false);\\n\\t\\t\\tthis.onError(error);\\n\\t\\t};\\n\\t\\tthis.getUserMedia(this.media, onSuccess, onError);\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param id {String}\\n   */\\n\\n\\tstopPeerConnection = (id) => {\\n\\t\\tconst peerConnection = this.peerConnections[id];\\n\\t\\tif (peerConnection == null) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tdelete this.peerConnections[id];\\n\\t\\tpeerConnection.close();\\n\\t\\tthis.updateRemoteItems();\\n\\t};\\n\\n\\tstopAllPeerConnections() {\\n\\t\\tconst { peerConnections } = this;\\n\\n\\t\\tObject.keys(peerConnections).forEach(this.stopPeerConnection);\\n\\n\\t\\twindow.audioContext && window.audioContext.close();\\n\\t}\\n\\n\\tsetAudioEnabled(enabled = true) {\\n\\t\\tif (this.localStream != null) {\\n\\t\\t\\tthis.localStream.getAudioTracks().forEach((audio) => {\\n\\t\\t\\t\\taudio.enabled = enabled;\\n\\t\\t\\t});\\n\\t\\t\\tthis.audioEnabled.set(enabled);\\n\\t\\t}\\n\\t}\\n\\n\\tdisableAudio() {\\n\\t\\tthis.setAudioEnabled(false);\\n\\t}\\n\\n\\tenableAudio() {\\n\\t\\tthis.setAudioEnabled(true);\\n\\t}\\n\\n\\ttoggleAudio() {\\n\\t\\tif (this.audioEnabled.get()) {\\n\\t\\t\\treturn this.disableAudio();\\n\\t\\t}\\n\\t\\treturn this.enableAudio();\\n\\t}\\n\\n\\tsetVideoEnabled(enabled = true) {\\n\\t\\tif (this.localStream != null) {\\n\\t\\t\\tthis.localStream.getVideoTracks().forEach((video) => {\\n\\t\\t\\t\\tvideo.enabled = enabled;\\n\\t\\t\\t});\\n\\t\\t\\tthis.videoEnabled.set(enabled);\\n\\t\\t}\\n\\t}\\n\\n\\tdisableScreenShare() {\\n\\t\\tthis.setScreenShareEnabled(false);\\n\\t}\\n\\n\\tenableScreenShare() {\\n\\t\\tthis.setScreenShareEnabled(true);\\n\\t}\\n\\n\\tsetScreenShareEnabled(enabled = true) {\\n\\t\\tif (this.localStream != null) {\\n\\t\\t\\tthis.media.desktop = enabled;\\n\\t\\t\\tdelete this.localStream;\\n\\t\\t\\tthis.getLocalUserMedia((err) => {\\n\\t\\t\\t\\tif (err != null) {\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tthis.screenShareEnabled.set(enabled);\\n\\t\\t\\t\\tthis.stopAllPeerConnections();\\n\\t\\t\\t\\tthis.joinCall();\\n\\t\\t\\t});\\n\\t\\t}\\n\\t}\\n\\n\\tdisableVideo() {\\n\\t\\tthis.setVideoEnabled(false);\\n\\t}\\n\\n\\tenableVideo() {\\n\\t\\tthis.setVideoEnabled(true);\\n\\t}\\n\\n\\ttoggleVideo() {\\n\\t\\tif (this.videoEnabled.get()) {\\n\\t\\t\\treturn this.disableVideo();\\n\\t\\t}\\n\\t\\treturn this.enableVideo();\\n\\t}\\n\\n\\tstop() {\\n\\t\\tthis.active = false;\\n\\t\\tthis.monitor = false;\\n\\t\\tthis.remoteMonitoring = false;\\n\\t\\tif (this.localStream != null && typeof this.localStream !== 'undefined') {\\n\\t\\t\\tthis.localStream.getTracks().forEach((track) => track.stop());\\n\\t\\t}\\n\\t\\tthis.localUrl.set(undefined);\\n\\t\\tdelete this.localStream;\\n\\t\\tthis.stopAllPeerConnections();\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param media {Object}\\n  \\t\\t\\taudio {Boolean}\\n  \\t\\t\\tvideo {Boolean}\\n   */\\n\\n\\tstartCall(media = {}, ...args) {\\n\\t\\tthis.log('startCall', [media, ...args]);\\n\\t\\tthis.media = media;\\n\\t\\tthis.getLocalUserMedia(() => {\\n\\t\\t\\tthis.active = true;\\n\\t\\t\\tthis.transport.startCall({\\n\\t\\t\\t\\tmedia: this.media,\\n\\t\\t\\t});\\n\\t\\t});\\n\\t}\\n\\n\\tstartCallAsMonitor(media = {}, ...args) {\\n\\t\\tthis.log('startCallAsMonitor', [media, ...args]);\\n\\t\\tthis.media = media;\\n\\t\\tthis.active = true;\\n\\t\\tthis.monitor = true;\\n\\t\\tthis.transport.startCall({\\n\\t\\t\\tmedia: this.media,\\n\\t\\t\\tmonitor: true,\\n\\t\\t});\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param data {Object}\\n  \\t\\t\\tfrom {String}\\n  \\t\\t\\tmonitor {Boolean}\\n  \\t\\t\\tmedia {Object}\\n  \\t\\t\\t\\taudio {Boolean}\\n  \\t\\t\\t\\tvideo {Boolean}\\n   */\\n\\n\\tonRemoteCall(data) {\\n\\t\\tif (this.autoAccept === true) {\\n\\t\\t\\tsetTimeout(() => {\\n\\t\\t\\t\\tthis.joinCall({\\n\\t\\t\\t\\t\\tto: data.from,\\n\\t\\t\\t\\t\\tmonitor: data.monitor,\\n\\t\\t\\t\\t\\tmedia: data.media,\\n\\t\\t\\t\\t});\\n\\t\\t\\t}, 0);\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tconst user = Meteor.users.findOne(data.from);\\n\\t\\tlet fromUsername = undefined;\\n\\t\\tif (user && user.username) {\\n\\t\\t\\tfromUsername = user.username;\\n\\t\\t}\\n\\t\\tconst subscription = ChatSubscription.findOne({\\n\\t\\t\\trid: data.room,\\n\\t\\t});\\n\\n\\t\\tlet icon;\\n\\t\\tlet title;\\n\\t\\tif (data.monitor === true) {\\n\\t\\t\\ticon = 'eye';\\n\\t\\t\\ttitle = t('WebRTC_monitor_call_from_%s', fromUsername);\\n\\t\\t} else if (subscription && subscription.t === 'd') {\\n\\t\\t\\tif (data.media && data.media.video) {\\n\\t\\t\\t\\ticon = 'videocam';\\n\\t\\t\\t\\ttitle = t('WebRTC_direct_video_call_from_%s', fromUsername);\\n\\t\\t\\t} else {\\n\\t\\t\\t\\ticon = 'phone';\\n\\t\\t\\t\\ttitle = t('WebRTC_direct_audio_call_from_%s', fromUsername);\\n\\t\\t\\t}\\n\\t\\t} else if (data.media && data.media.video) {\\n\\t\\t\\ticon = 'videocam';\\n\\t\\t\\ttitle = t('WebRTC_group_video_call_from_%s', subscription.name);\\n\\t\\t} else {\\n\\t\\t\\ticon = 'phone';\\n\\t\\t\\ttitle = t('WebRTC_group_audio_call_from_%s', subscription.name);\\n\\t\\t}\\n\\n\\t\\timperativeModal.open({\\n\\t\\t\\tcomponent: GenericModal,\\n\\t\\t\\tprops: {\\n\\t\\t\\t\\ttitle,\\n\\t\\t\\t\\ticon,\\n\\t\\t\\t\\tconfirmText: t('Yes'),\\n\\t\\t\\t\\tcancelText: t('No'),\\n\\t\\t\\t\\tchildren: t('Do_you_want_to_accept'),\\n\\t\\t\\t\\tonConfirm: () => {\\n\\t\\t\\t\\t\\tgoToRoomById(data.room);\\n\\t\\t\\t\\t\\treturn this.joinCall({\\n\\t\\t\\t\\t\\t\\tto: data.from,\\n\\t\\t\\t\\t\\t\\tmonitor: data.monitor,\\n\\t\\t\\t\\t\\t\\tmedia: data.media,\\n\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\tonCancel: () => this.stop(),\\n\\t\\t\\t\\tonClose: () => this.stop(),\\n\\t\\t\\t},\\n\\t\\t});\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param data {Object}\\n  \\t\\t\\tto {String}\\n  \\t\\t\\tmonitor {Boolean}\\n  \\t\\t\\tmedia {Object}\\n  \\t\\t\\t\\taudio {Boolean}\\n  \\t\\t\\t\\tvideo {Boolean}\\n  \\t\\t\\t\\tdesktop {Boolean}\\n   */\\n\\n\\tjoinCall(data = {}, ...args) {\\n\\t\\tdata.media = this.media;\\n\\t\\tthis.log('joinCall', [data, ...args]);\\n\\t\\tthis.getLocalUserMedia(() => {\\n\\t\\t\\tthis.remoteMonitoring = data.monitor;\\n\\t\\t\\tthis.active = true;\\n\\t\\t\\tthis.transport.joinCall(data);\\n\\t\\t});\\n\\t}\\n\\n\\tonRemoteJoin(data, ...args) {\\n\\t\\tif (this.active !== true) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tthis.log('onRemoteJoin', [data, ...args]);\\n\\t\\tlet peerConnection = this.getPeerConnection(data.from);\\n\\n\\t\\t// needsRefresh = false\\n\\t\\t// if peerConnection.iceConnectionState isnt 'new'\\n\\t\\t// needsAudio = data.media.audio is true and peerConnection.remoteMedia.audio isnt true\\n\\t\\t// needsVideo = data.media.video is true and peerConnection.remoteMedia.video isnt true\\n\\t\\t// needsRefresh = needsAudio or needsVideo or data.media.desktop isnt peerConnection.remoteMedia.desktop\\n\\n\\t\\t// # if peerConnection.signalingState is \\\"have-local-offer\\\" or needsRefresh\\n\\n\\t\\tif (peerConnection.signalingState !== 'checking') {\\n\\t\\t\\tthis.stopPeerConnection(data.from);\\n\\t\\t\\tpeerConnection = this.getPeerConnection(data.from);\\n\\t\\t}\\n\\t\\tif (peerConnection.iceConnectionState !== 'new') {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tpeerConnection.remoteMedia = data.media;\\n\\t\\tif (this.localStream) {\\n\\t\\t\\tpeerConnection.addStream(this.localStream);\\n\\t\\t}\\n\\t\\tconst onOffer = (offer) => {\\n\\t\\t\\tconst onLocalDescription = () => {\\n\\t\\t\\t\\tthis.transport.sendDescription({\\n\\t\\t\\t\\t\\tto: data.from,\\n\\t\\t\\t\\t\\ttype: 'offer',\\n\\t\\t\\t\\t\\tts: peerConnection.createdAt,\\n\\t\\t\\t\\t\\tmedia: this.media,\\n\\t\\t\\t\\t\\tdescription: {\\n\\t\\t\\t\\t\\t\\tsdp: offer.sdp,\\n\\t\\t\\t\\t\\t\\ttype: offer.type,\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t});\\n\\t\\t\\t};\\n\\n\\t\\t\\tpeerConnection.setLocalDescription(new RTCSessionDescription(offer), onLocalDescription, this.onError);\\n\\t\\t};\\n\\n\\t\\tif (data.monitor === true) {\\n\\t\\t\\tpeerConnection.createOffer(onOffer, this.onError, {\\n\\t\\t\\t\\tmandatory: {\\n\\t\\t\\t\\t\\tOfferToReceiveAudio: data.media.audio,\\n\\t\\t\\t\\t\\tOfferToReceiveVideo: data.media.video,\\n\\t\\t\\t\\t},\\n\\t\\t\\t});\\n\\t\\t} else {\\n\\t\\t\\tpeerConnection.createOffer(onOffer, this.onError);\\n\\t\\t}\\n\\t}\\n\\n\\tonRemoteOffer(data, ...args) {\\n\\t\\tif (this.active !== true) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tthis.log('onRemoteOffer', [data, ...args]);\\n\\t\\tlet peerConnection = this.getPeerConnection(data.from);\\n\\n\\t\\tif (['have-local-offer', 'stable'].includes(peerConnection.signalingState) && peerConnection.createdAt < data.ts) {\\n\\t\\t\\tthis.stopPeerConnection(data.from);\\n\\t\\t\\tpeerConnection = this.getPeerConnection(data.from);\\n\\t\\t}\\n\\n\\t\\tif (peerConnection.iceConnectionState !== 'new') {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tpeerConnection.setRemoteDescription(new RTCSessionDescription(data.description));\\n\\n\\t\\ttry {\\n\\t\\t\\tif (this.localStream) {\\n\\t\\t\\t\\tpeerConnection.addStream(this.localStream);\\n\\t\\t\\t}\\n\\t\\t} catch (error) {\\n\\t\\t\\tconsole.log(error);\\n\\t\\t}\\n\\n\\t\\tconst onAnswer = (answer) => {\\n\\t\\t\\tconst onLocalDescription = () => {\\n\\t\\t\\t\\tthis.transport.sendDescription({\\n\\t\\t\\t\\t\\tto: data.from,\\n\\t\\t\\t\\t\\ttype: 'answer',\\n\\t\\t\\t\\t\\tts: peerConnection.createdAt,\\n\\t\\t\\t\\t\\tdescription: {\\n\\t\\t\\t\\t\\t\\tsdp: answer.sdp,\\n\\t\\t\\t\\t\\t\\ttype: answer.type,\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t});\\n\\t\\t\\t};\\n\\n\\t\\t\\tpeerConnection.setLocalDescription(new RTCSessionDescription(answer), onLocalDescription, this.onError);\\n\\t\\t};\\n\\n\\t\\tpeerConnection.createAnswer(onAnswer, this.onError);\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param data {Object}\\n  \\t\\t\\tto {String}\\n  \\t\\t\\tfrom {String}\\n  \\t\\t\\tcandidate {RTCIceCandidate JSON encoded}\\n   */\\n\\n\\tonRemoteCandidate(data, ...args) {\\n\\t\\tif (this.active !== true) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tif (data.to !== this.selfId) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tthis.log('onRemoteCandidate', [data, ...args]);\\n\\t\\tconst peerConnection = this.getPeerConnection(data.from);\\n\\t\\tif (\\n\\t\\t\\tpeerConnection.iceConnectionState !== 'closed' &&\\n\\t\\t\\tpeerConnection.iceConnectionState !== 'failed' &&\\n\\t\\t\\tpeerConnection.iceConnectionState !== 'disconnected' &&\\n\\t\\t\\tpeerConnection.iceConnectionState !== 'completed'\\n\\t\\t) {\\n\\t\\t\\tpeerConnection.addIceCandidate(new RTCIceCandidate(data.candidate));\\n\\t\\t}\\n\\t\\tdocument.querySelector('video#remoteVideo').srcObject = this.remoteItems.get()[0]?.url;\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param data {Object}\\n  \\t\\t\\tto {String}\\n  \\t\\t\\tfrom {String}\\n  \\t\\t\\ttype {String} [offer, answer]\\n  \\t\\t\\tdescription {RTCSessionDescription JSON encoded}\\n  \\t\\t\\tts {Integer}\\n  \\t\\t\\tmedia {Object}\\n  \\t\\t\\t\\taudio {Boolean}\\n  \\t\\t\\t\\tvideo {Boolean}\\n  \\t\\t\\t\\tdesktop {Boolean}\\n   */\\n\\n\\tonRemoteDescription(data, ...args) {\\n\\t\\tif (this.active !== true) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tif (data.to !== this.selfId) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tthis.log('onRemoteDescription', [data, ...args]);\\n\\t\\tconst peerConnection = this.getPeerConnection(data.from);\\n\\t\\tif (data.type === 'offer') {\\n\\t\\t\\tpeerConnection.remoteMedia = data.media;\\n\\t\\t\\tthis.onRemoteOffer({\\n\\t\\t\\t\\tfrom: data.from,\\n\\t\\t\\t\\tts: data.ts,\\n\\t\\t\\t\\tdescription: data.description,\\n\\t\\t\\t});\\n\\t\\t} else {\\n\\t\\t\\tpeerConnection.setRemoteDescription(new RTCSessionDescription(data.description));\\n\\t\\t}\\n\\t}\\n}\\n\\nconst WebRTC = new (class {\\n\\tconstructor() {\\n\\t\\tthis.instancesByRoomId = {};\\n\\t}\\n\\n\\tgetInstanceByRoomId(rid, visitorId = null) {\\n\\t\\tlet enabled = false;\\n\\t\\tif (!visitorId) {\\n\\t\\t\\tconst subscription = ChatSubscription.findOne({ rid });\\n\\t\\t\\tif (!subscription) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t\\tswitch (subscription.t) {\\n\\t\\t\\t\\tcase 'd':\\n\\t\\t\\t\\t\\tenabled = settings.get('WebRTC_Enable_Direct');\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\tcase 'p':\\n\\t\\t\\t\\t\\tenabled = settings.get('WebRTC_Enable_Private');\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\tcase 'c':\\n\\t\\t\\t\\t\\tenabled = settings.get('WebRTC_Enable_Channel');\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\tcase 'l':\\n\\t\\t\\t\\t\\tenabled = settings.get('Omnichannel_call_provider') === 'WebRTC';\\n\\t\\t\\t}\\n\\t\\t} else {\\n\\t\\t\\tenabled = settings.get('Omnichannel_call_provider') === 'WebRTC';\\n\\t\\t}\\n\\t\\tenabled = enabled && settings.get('WebRTC_Enabled');\\n\\t\\tif (enabled === false) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tif (this.instancesByRoomId[rid] == null) {\\n\\t\\t\\tlet uid = Meteor.userId();\\n\\t\\t\\tlet autoAccept = false;\\n\\t\\t\\tif (visitorId) {\\n\\t\\t\\t\\tuid = visitorId;\\n\\t\\t\\t\\tautoAccept = true;\\n\\t\\t\\t}\\n\\t\\t\\tthis.instancesByRoomId[rid] = new WebRTCClass(uid, rid, autoAccept);\\n\\t\\t}\\n\\t\\treturn this.instancesByRoomId[rid];\\n\\t}\\n})();\\n\\nMeteor.startup(() => {\\n\\tTracker.autorun(() => {\\n\\t\\tif (Meteor.userId()) {\\n\\t\\t\\tsdk.stream('notify-user', [`${Meteor.userId()}/${WEB_RTC_EVENTS.WEB_RTC}`], (type, data) => {\\n\\t\\t\\t\\tif (data.room == null) {\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tconst webrtc = WebRTC.getInstanceByRoomId(data.room);\\n\\t\\t\\t\\twebrtc.onUserStream(type, data);\\n\\t\\t\\t});\\n\\t\\t}\\n\\t});\\n});\\n\\nexport { WebRTC };\\n\",null],\"names\":[\"Emitter\",\"Meteor\",\"ReactiveVar\",\"Tracker\",\"GenericModal\",\"imperativeModal\",\"goToRoomById\",\"ChatSubscription\",\"settings\",\"sdk\",\"t\",\"WEB_RTC_EVENTS\",\"ChromeScreenShare\",\"module\",\"export\",\"WebRTC\",\"link\",\"v\",\"default\",\"WebRTCTransportClass\",\"constructor\",\"webrtcInstance\",\"debug\",\"stream\",\"concat\",\"room\",\"WEB_RTC\",\"type\",\"data\",\"log\",\"emit\",\"console\",\"arguments\",\"onUserStream\",\"startCall\",\"selfId\",\"publish\",\"CALL\",\"from\",\"media\",\"monitor\",\"joinCall\",\"to\",\"JOIN\",\"sendCandidate\",\"CANDIDATE\",\"sendDescription\",\"DESCRIPTION\",\"sendStatus\",\"STATUS\",\"onRemoteCall\",\"fn\",\"on\",\"onRemoteJoin\",\"onRemoteCandidate\",\"onRemoteDescription\",\"onRemoteStatus\",\"WebRTCClass\",\"autoAccept\",\"length\",\"undefined\",\"resetCallInProgress\",\"callInProgress\",\"set\",\"stopPeerConnection\",\"id\",\"peerConnection\",\"peerConnections\",\"close\",\"updateRemoteItems\",\"config\",\"iceServers\",\"TransportClass\",\"servers\",\"get\",\"trim\",\"replace\",\"split\",\"forEach\",\"server\",\"serverConfig\",\"urls\",\"pop\",\"username\",\"decodeURIComponent\",\"credential\",\"push\",\"remoteItems\",\"remoteItemsById\",\"audioEnabled\",\"videoEnabled\",\"overlayEnabled\",\"screenShareEnabled\",\"localUrl\",\"active\",\"remoteMonitoring\",\"navigator\",\"userAgent\",\"toLocaleLowerCase\",\"indexOf\",\"screenShareAvailable\",\"includes\",\"video\",\"audio\",\"transport\",\"bind\",\"setInterval\",\"checkPeerConnections\",\"_len\",\"args\",\"Array\",\"_key\",\"apply\",\"onError\",\"_len2\",\"_key2\",\"error\",\"date\",\"Date\",\"now\",\"Object\",\"entries\",\"some\",\"_ref\",\"iceConnectionState\",\"createdAt\",\"items\",\"itemsById\",\"_ref2\",\"getRemoteStreams\",\"remoteStream\",\"item\",\"url\",\"state\",\"stateText\",\"connected\",\"broadcastStatus\",\"remoteConnections\",\"keys\",\"_ref3\",\"remoteMedia\",\"clearTimeout\",\"callInProgressTimeout\",\"setTimeout\",\"remoteConnection\",\"getPeerConnection\",\"RTCPeerConnection\",\"eventNames\",\"eventName\",\"addEventListener\",\"e\",\"candidate\",\"sdpMLineIndex\",\"sdpMid\",\"stop\",\"_getUserMedia\",\"onSuccess\",\"onSuccessLocal\",\"AudioContext\",\"getAudioTracks\",\"audioContext\",\"source\",\"createMediaStreamSource\",\"volume\",\"createGain\",\"connect\",\"peer\",\"createMediaStreamDestination\",\"gain\",\"value\",\"removeTrack\",\"addTrack\",\"mediaDevices\",\"getUserMedia\",\"then\",\"catch\",\"desktop\",\"getScreen\",\"audioStream\",\"refresh\",\"open\",\"component\",\"props\",\"variant\",\"title\",\"isChromeExtensionInstalled\",\"installed\",\"isFirefoxExtensionInstalled\",\"window\",\"rocketchatscreenshare\",\"confirmText\",\"cancelText\",\"children\",\"onConfirm\",\"chrome\",\"webstore\",\"install\",\"_error\",\"getScreenSuccess\",\"mozMediaSource\",\"mediaSource\",\"getSourceId\",\"mandatory\",\"chromeMediaSource\",\"chromeMediaSourceId\",\"maxWidth\",\"maxHeight\",\"getAudioError\",\"getLocalUserMedia\",\"callback\",\"_len3\",\"_key3\",\"localStream\",\"disableAudio\",\"disableVideo\",\"_ref4\",\"addStream\",\"document\",\"querySelector\",\"srcObject\",\"stopAllPeerConnections\",\"setAudioEnabled\",\"enabled\",\"enableAudio\",\"toggleAudio\",\"setVideoEnabled\",\"getVideoTracks\",\"disableScreenShare\",\"setScreenShareEnabled\",\"enableScreenShare\",\"err\",\"enableVideo\",\"toggleVideo\",\"getTracks\",\"track\",\"_len4\",\"_key4\",\"startCallAsMonitor\",\"_len5\",\"_key5\",\"icon\",\"fromUsername\",\"user\",\"users\",\"findOne\",\"subscription\",\"rid\",\"name\",\"onCancel\",\"onClose\",\"_len6\",\"_key6\",\"_len7\",\"_key7\",\"signalingState\",\"onOffer\",\"offer\",\"setLocalDescription\",\"RTCSessionDescription\",\"onLocalDescription\",\"ts\",\"description\",\"sdp\",\"createOffer\",\"OfferToReceiveAudio\",\"OfferToReceiveVideo\",\"onRemoteOffer\",\"_len8\",\"_key8\",\"setRemoteDescription\",\"createAnswer\",\"answer\",\"_this$remoteItems$get\",\"_len9\",\"_key9\",\"addIceCandidate\",\"RTCIceCandidate\",\"_len10\",\"_key10\",\"instancesByRoomId\",\"getInstanceByRoomId\",\"visitorId\",\"uid\",\"userId\",\"startup\",\"autorun\",\"webrtc\"],\"mappings\":\"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\"}"}