{"code":"function module(e,t,a){let i,s,n,c,r,l,o,u,d;a.link(\"@rocket.chat/onboarding-ui\",{AwaitingConfirmationPage(e){i=e}},0),a.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch(e){s=e},useSettingSetValue(e){n=e},useEndpoint(e){c=e},useTranslation(e){r=e}},1),a.link(\"react\",{default(e){l=e},useEffect(e){o=e},useCallback(e){u=e}},2),a.link(\"../contexts/SetupWizardContext\",{useSetupWizardContext(e){d=e}},3);let m=e=>e?1e3*e:0;a.exportDefault(()=>{let{registerServer:e,currentStep:t,maxSteps:a,goToStep:p,setupWizardData:{registrationData:f},saveWorkspaceData:v}=d(),_=n(\"Show_Setup_Wizard\"),g=c(\"GET\",\"/v1/cloud.confirmationPoll\"),k=s(),C=r(),E=u(async()=>{try{if(f.device_code){let{pollData:e}=await g({deviceCode:f.device_code});if(\"successful\"in e&&e.successful)return await v(),k({type:\"success\",message:C(\"Your_workspace_is_ready\")}),_(\"completed\")}}catch(e){k({type:\"error\",message:e})}},[g,f.device_code,_,v,k,C]);return o(()=>{let e=setInterval(()=>E(),m(f.interval));return()=>clearInterval(e)},[E,f.interval]),l.createElement(i,{currentStep:t,stepCount:a,emailAddress:f.cloudEmail,securityCode:f.user_code,onResendEmailRequest:()=>e({email:f.cloudEmail,resend:!0}),onChangeEmailRequest:()=>p(3)})})}","map":"{\"version\":3,\"sources\":[\"client/views/setupWizard/steps/CloudAccountConfirmation.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { AwaitingConfirmationPage } from '@rocket.chat/onboarding-ui';\\nimport { useToastMessageDispatch, useSettingSetValue, useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement } from 'react';\\nimport React, { useEffect, useCallback } from 'react';\\n\\nimport { useSetupWizardContext } from '../contexts/SetupWizardContext';\\n\\nconst setIntervalTime = (interval?: number): number => (interval ? interval * 1000 : 0);\\n\\nconst CloudAccountConfirmation = (): ReactElement => {\\n\\tconst {\\n\\t\\tregisterServer,\\n\\t\\tcurrentStep,\\n\\t\\tmaxSteps,\\n\\t\\tgoToStep,\\n\\t\\tsetupWizardData: { registrationData },\\n\\t\\tsaveWorkspaceData,\\n\\t} = useSetupWizardContext();\\n\\tconst setShowSetupWizard = useSettingSetValue('Show_Setup_Wizard');\\n\\tconst cloudConfirmationPoll = useEndpoint('GET', '/v1/cloud.confirmationPoll');\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst t = useTranslation();\\n\\n\\tconst getConfirmation = useCallback(async () => {\\n\\t\\ttry {\\n\\t\\t\\tif (registrationData.device_code) {\\n\\t\\t\\t\\tconst { pollData } = await cloudConfirmationPoll({\\n\\t\\t\\t\\t\\tdeviceCode: registrationData.device_code,\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\t\\tif ('successful' in pollData && pollData.successful) {\\n\\t\\t\\t\\t\\tawait saveWorkspaceData();\\n\\t\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Your_workspace_is_ready') });\\n\\t\\t\\t\\t\\treturn setShowSetupWizard('completed');\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t} catch (error: unknown) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t}\\n\\t}, [cloudConfirmationPoll, registrationData.device_code, setShowSetupWizard, saveWorkspaceData, dispatchToastMessage, t]);\\n\\n\\tuseEffect(() => {\\n\\t\\tconst pollInterval = setInterval(() => getConfirmation(), setIntervalTime(registrationData.interval));\\n\\n\\t\\treturn (): void => clearInterval(pollInterval);\\n\\t}, [getConfirmation, registrationData.interval]);\\n\\n\\treturn (\\n\\t\\t<AwaitingConfirmationPage\\n\\t\\t\\tcurrentStep={currentStep}\\n\\t\\t\\tstepCount={maxSteps}\\n\\t\\t\\temailAddress={registrationData.cloudEmail}\\n\\t\\t\\tsecurityCode={registrationData.user_code}\\n\\t\\t\\tonResendEmailRequest={(): Promise<void> => registerServer({ email: registrationData.cloudEmail, resend: true })}\\n\\t\\t\\tonChangeEmailRequest={(): void => goToStep(3)}\\n\\t\\t/>\\n\\t);\\n};\\n\\nexport default CloudAccountConfirmation;\\n\",null],\"names\":[\"AwaitingConfirmationPage\",\"useToastMessageDispatch\",\"useSettingSetValue\",\"useEndpoint\",\"useTranslation\",\"React\",\"useEffect\",\"useCallback\",\"useSetupWizardContext\",\"module\",\"link\",\"v\",\"default\",\"setIntervalTime\",\"interval\",\"exportDefault\",\"CloudAccountConfirmation\",\"registerServer\",\"currentStep\",\"maxSteps\",\"goToStep\",\"setupWizardData\",\"registrationData\",\"saveWorkspaceData\",\"setShowSetupWizard\",\"cloudConfirmationPoll\",\"dispatchToastMessage\",\"t\",\"getConfirmation\",\"device_code\",\"pollData\",\"deviceCode\",\"successful\",\"type\",\"message\",\"error\",\"pollInterval\",\"setInterval\",\"clearInterval\",\"createElement\",\"stepCount\",\"emailAddress\",\"cloudEmail\",\"securityCode\",\"user_code\",\"onResendEmailRequest\",\"email\",\"resend\",\"onChangeEmailRequest\"],\"mappings\":\"2BAAAA,EAAsEC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA7DC,EAA0BC,IAAA,CAAM,6BAA6B,CAAAV,yBAAAW,CAAA,EAAAX,EAAAW,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,2BAAA,CAAAT,wBAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,mBAAAS,CAAA,EAAAT,EAAAS,CAAA,EAAAR,YAAAQ,CAAA,EAAAR,EAAAQ,CAAA,EAAAP,eAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,QAAA,CAAAE,QAAAD,CAAA,EAAAN,EAAAM,CAAA,EAAAL,UAAAK,CAAA,EAAAL,EAAAK,CAAA,EAAAJ,YAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,iCAAA,CAAAF,sBAAAG,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,GAOtE,IAAME,EAAmBC,GAA+BA,EAAWA,AAAW,IAAXA,EAAkB,EAPrFL,EAAOM,aAAE,CASwBC,KAChC,GAAM,CACLC,eAAAA,CAAc,CACdC,YAAAA,CAAW,CACXC,SAAAA,CAAQ,CACRC,SAAAA,CAAQ,CACRC,gBAAiB,CAAEC,iBAAAA,CAAAA,CAAkB,CACrCC,kBAAAA,CAAAA,CACA,CAAGf,IACEgB,EAAqBtB,EAAmB,qBACxCuB,EAAwBtB,EAAY,MAAO,8BAC3CuB,EAAuBzB,IACvB0B,EAAIvB,IAEJwB,EAAkBrB,EAAY,UACnC,GAAI,CACH,GAAIe,EAAiBO,WAAW,CAAE,CACjC,GAAM,CAAEC,SAAAA,CAAAA,CAAU,CAAG,MAAML,EAAsB,CAChDM,WAAYT,EAAiBO,WAAAA,GAG9B,GAAI,eAAgBC,GAAYA,EAASE,UAAU,CAGlD,OAFA,MAAMT,IACNG,EAAqB,CAAEO,KAAM,UAAWC,QAASP,EAAE,0BAA0B,GACtEH,EAAmB,YAE5B,CACD,CAAE,MAAOW,EAAgB,CACxBT,EAAqB,CAAEO,KAAM,QAASC,QAASC,CAAK,EACrD,CACD,EAAG,CAACV,EAAuBH,EAAiBO,WAAW,CAAEL,EAAoBD,EAAmBG,EAAsBC,EAAE,EAQxH,OANArB,EAAU,KACT,IAAM8B,EAAeC,YAAY,IAAMT,IAAmBf,EAAgBS,EAAiBR,QAAQ,GAEnG,MAAO,IAAYwB,cAAcF,EAClC,EAAG,CAACR,EAAiBN,EAAiBR,QAAQ,CAAC,EAG9CT,EAAAkC,aAAA,CAACvC,EAAwB,CACxBkB,YAAaA,EACbsB,UAAWrB,EACXsB,aAAcnB,EAAiBoB,UAAW,CAC1CC,aAAcrB,EAAiBsB,SAAU,CACzCC,qBAAsBA,IAAqB5B,EAAe,CAAE6B,MAAOxB,EAAiBoB,UAAU,CAAEK,OAAQ,CAAA,CAAI,GAC5GC,qBAAsBA,IAAY5B,EAAS,EAAG,EAGjD\"}"}