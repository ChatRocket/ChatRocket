{"code":"function module(t,e,n){let o,a,s,r,i,c,l,u,d,_,g,p;n.link(\"@babel/runtime/helpers/objectSpread2\",{default(t){o=t}},0),n.export({useAgentsSection:()=>m}),n.link(\"@rocket.chat/ui-contexts\",{useEndpoint(t){a=t}},0),n.link(\"@tanstack/react-query\",{useQuery(t){s=t}},1),n.link(\"react\",{useMemo(t){r=t}},2),n.link(\"react-i18next\",{useTranslation(t){i=t}},3),n.link(\"../../../components/GenericTable/hooks/useSort\",{useSort(t){c=t}},4),n.link(\"../../../components/dashboards/periods\",{getPeriodRange(t){l=t}},5),n.link(\"../../../components/dashboards/usePeriodSelectorStorage\",{usePeriodSelectorStorage(t){u=t}},6),n.link(\"../components/constants\",{COLORS(t){d=t},PERIOD_OPTIONS(t){_=t}},7),n.link(\"../utils/formatPeriodDescription\",{formatPeriodDescription(t){g=t}},8),n.link(\"./useDefaultDownload\",{useDefaultDownload(t){p=t}},9);let S=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map(t=>o(o({},t),{},{color:d.info}))},m=()=>{var t;let{t:e}=i(),[n,d]=u(\"reports-agents-period\",_),m=a(\"GET\",\"/v1/livechat/analytics/dashboards/conversations-by-agent\"),{sortBy:h,sortDirection:k,setSort:b}=c(\"total\",\"desc\"),{data:{data:v,total:y=0,unspecified:f=0}={data:[],total:0},refetch:O,isLoading:D,isError:P,isSuccess:I}=s([\"omnichannel-reports\",\"conversations-by-agent\",n,h,k],async()=>{let{start:t,end:e}=l(n),a=await m({start:t.toISOString(),end:e.toISOString(),sort:JSON.stringify({[h]:\"asc\"===k?1:-1})});return o(o({},a),{},{data:S(a.data)})},{refetchInterval:3e5}),R=e(\"Conversations_by_agents\"),w=e(\"__agents__agents_and__count__conversations__period__\",{agents:null!==(t=v.length)&&void 0!==t?t:0,count:y,period:g(n,e)}),E=f>0?\"(\".concat(e(\"__count__without__assignee__\",{count:f}),\")\"):\"\",T=\"\".concat(w,\" \").concat(E),x=e(\"Omnichannel_Reports_Agents_Empty_Subtitle\"),A=p({columnName:e(\"Agents\"),title:R,data:v,period:n});return r(()=>({id:\"conversations-by-agent\",title:R,subtitle:T,emptyStateSubtitle:x,data:v,total:y,isLoading:D,isError:P,isDataFound:I&&v.length>0,periodSelectorProps:d,period:n,downloadProps:A,sortBy:h,sortDirection:k,setSort:b,onRetry:O}),[R,T,x,v,y,D,P,I,d,n,A,h,k,b,O])}}","map":"{\"version\":3,\"sources\":[\"client/omnichannel/reports/hooks/useAgentsSection.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useQuery } from '@tanstack/react-query';\\nimport { useMemo } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { useSort } from '../../../components/GenericTable/hooks/useSort';\\nimport { getPeriodRange } from '../../../components/dashboards/periods';\\nimport { usePeriodSelectorStorage } from '../../../components/dashboards/usePeriodSelectorStorage';\\nimport { COLORS, PERIOD_OPTIONS } from '../components/constants';\\nimport { formatPeriodDescription } from '../utils/formatPeriodDescription';\\nimport { useDefaultDownload } from './useDefaultDownload';\\n\\nconst formatChartData = (data: { label: string; value: number }[] | undefined = []) =>\\n\\tdata.map((item) => ({\\n\\t\\t...item,\\n\\t\\tcolor: COLORS.info,\\n\\t}));\\n\\nexport const useAgentsSection = () => {\\n\\tconst { t } = useTranslation();\\n\\tconst [period, periodSelectorProps] = usePeriodSelectorStorage('reports-agents-period', PERIOD_OPTIONS);\\n\\tconst getConversationsByAgent = useEndpoint('GET', '/v1/livechat/analytics/dashboards/conversations-by-agent');\\n\\tconst { sortBy, sortDirection, setSort } = useSort<'name' | 'total'>('total', 'desc');\\n\\n\\tconst {\\n\\t\\tdata: { data, total = 0, unspecified = 0 } = { data: [], total: 0 },\\n\\t\\trefetch,\\n\\t\\tisLoading,\\n\\t\\tisError,\\n\\t\\tisSuccess,\\n\\t} = useQuery(\\n\\t\\t['omnichannel-reports', 'conversations-by-agent', period, sortBy, sortDirection],\\n\\t\\tasync () => {\\n\\t\\t\\tconst { start, end } = getPeriodRange(period);\\n\\t\\t\\tconst response = await getConversationsByAgent({\\n\\t\\t\\t\\tstart: start.toISOString(),\\n\\t\\t\\t\\tend: end.toISOString(),\\n\\t\\t\\t\\tsort: JSON.stringify({ [sortBy]: sortDirection === 'asc' ? 1 : -1 }),\\n\\t\\t\\t});\\n\\t\\t\\treturn { ...response, data: formatChartData(response.data) };\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\trefetchInterval: 5 * 60 * 1000,\\n\\t\\t},\\n\\t);\\n\\n\\tconst title = t('Conversations_by_agents');\\n\\n\\tconst subtitleTotals = t('__agents__agents_and__count__conversations__period__', {\\n\\t\\tagents: data.length ?? 0,\\n\\t\\tcount: total,\\n\\t\\tperiod: formatPeriodDescription(period, t),\\n\\t});\\n\\tconst subtitleUnspecified = unspecified > 0 ? `(${t('__count__without__assignee__', { count: unspecified })})` : '';\\n\\tconst subtitle = `${subtitleTotals} ${subtitleUnspecified}`;\\n\\tconst emptyStateSubtitle = t('Omnichannel_Reports_Agents_Empty_Subtitle');\\n\\n\\tconst downloadProps = useDefaultDownload({ columnName: t('Agents'), title, data, period });\\n\\n\\treturn useMemo(\\n\\t\\t() => ({\\n\\t\\t\\tid: 'conversations-by-agent',\\n\\t\\t\\ttitle,\\n\\t\\t\\tsubtitle,\\n\\t\\t\\temptyStateSubtitle,\\n\\t\\t\\tdata,\\n\\t\\t\\ttotal,\\n\\t\\t\\tisLoading,\\n\\t\\t\\tisError,\\n\\t\\t\\tisDataFound: isSuccess && data.length > 0,\\n\\t\\t\\tperiodSelectorProps,\\n\\t\\t\\tperiod,\\n\\t\\t\\tdownloadProps,\\n\\t\\t\\tsortBy,\\n\\t\\t\\tsortDirection,\\n\\t\\t\\tsetSort,\\n\\t\\t\\tonRetry: refetch,\\n\\t\\t}),\\n\\t\\t[\\n\\t\\t\\ttitle,\\n\\t\\t\\tsubtitle,\\n\\t\\t\\temptyStateSubtitle,\\n\\t\\t\\tdata,\\n\\t\\t\\ttotal,\\n\\t\\t\\tisLoading,\\n\\t\\t\\tisError,\\n\\t\\t\\tisSuccess,\\n\\t\\t\\tperiodSelectorProps,\\n\\t\\t\\tperiod,\\n\\t\\t\\tdownloadProps,\\n\\t\\t\\tsortBy,\\n\\t\\t\\tsortDirection,\\n\\t\\t\\tsetSort,\\n\\t\\t\\trefetch,\\n\\t\\t],\\n\\t);\\n};\\n\",null],\"names\":[\"_objectSpread\",\"useEndpoint\",\"useQuery\",\"useMemo\",\"useTranslation\",\"useSort\",\"getPeriodRange\",\"usePeriodSelectorStorage\",\"COLORS\",\"PERIOD_OPTIONS\",\"formatPeriodDescription\",\"useDefaultDownload\",\"module\",\"link\",\"default\",\"v\",\"export\",\"useAgentsSection\",\"formatChartData\",\"data\",\"arguments\",\"length\",\"undefined\",\"map\",\"item\",\"color\",\"info\",\"_data$length\",\"t\",\"period\",\"periodSelectorProps\",\"getConversationsByAgent\",\"sortBy\",\"sortDirection\",\"setSort\",\"total\",\"unspecified\",\"refetch\",\"isLoading\",\"isError\",\"isSuccess\",\"start\",\"end\",\"response\",\"toISOString\",\"sort\",\"JSON\",\"stringify\",\"refetchInterval\",\"title\",\"subtitleTotals\",\"agents\",\"count\",\"subtitleUnspecified\",\"concat\",\"subtitle\",\"emptyStateSubtitle\",\"downloadProps\",\"columnName\",\"id\",\"isDataFound\",\"onRetry\"],\"mappings\":\"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\"}"}