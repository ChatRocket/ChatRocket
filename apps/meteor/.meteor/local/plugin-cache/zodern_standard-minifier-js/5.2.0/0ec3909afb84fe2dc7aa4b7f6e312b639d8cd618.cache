{"code":"function module(e,t,l){let n,a,r,o,s,i,c,u,d,m,p,k,f,v,_,g,y;l.link(\"@rocket.chat/fuselage\",{Box(e){n=e},ButtonGroup(e){a=e},Button(e){r=e},Margins(e){o=e}},0),l.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback(e){s=e}},1),l.link(\"@rocket.chat/ui-contexts\",{useSetModal(e){i=e},useToastMessageDispatch(e){c=e},useRoute(e){u=e},useEndpoint(e){d=e}},2),l.link(\"react\",{default(e){m=e}},3),l.link(\"react-hook-form\",{FormProvider(e){p=e},useForm(e){k=e}},4),l.link(\"react-i18next\",{useTranslation(e){f=e}},5),l.link(\"../../../components/Contextualbar\",{ContextualbarFooter(e){v=e},ContextualbarScrollableContent(e){_=e}},6),l.link(\"../../../components/GenericModal\",{default(e){g=e}},7),l.link(\"./RoleForm\",{default(e){y=e}},8),l.exportDefault(e=>{let{role:t,isEnterprise:l}=e,{t:h}=f(),E=c(),b=i(),C=u(\"admin-permissions\"),S=u(\"admin-permissions\"),x=d(\"POST\",\"/v1/roles.create\"),D=d(\"POST\",\"/v1/roles.update\"),T=d(\"POST\",\"/v1/roles.delete\"),F=k({defaultValues:{roleId:null==t?void 0:t._id,name:null==t?void 0:t.name,description:null==t?void 0:t.description,scope:(null==t?void 0:t.scope)||\"Users\",mandatory2fa:!!(null!=t&&t.mandatory2fa)}}),M=s(()=>{null!=t&&t._id&&C.push({context:\"users-in-role\",_id:t._id})}),P=s(async e=>{try{if(e.roleId)return await D(e),E({type:\"success\",message:h(\"Saved\")}),S.push({});await x(e),E({type:\"success\",message:h(\"Saved\")}),S.push({})}catch(e){E({type:\"error\",message:e})}}),R=s(async()=>{if(!(null!=t&&t._id))return;let e=async()=>{try{await T({roleId:t._id}),E({type:\"success\",message:h(\"Role_removed\")}),b(),S.push({})}catch(e){E({type:\"error\",message:e}),b()}},n=l?h(\"Delete_Role_Warning\"):h(\"Delete_Role_Warning_Not_Enterprise\");b(m.createElement(g,{variant:\"danger\",onConfirm:e,onClose:()=>b(),onCancel:()=>b(),confirmText:h(\"Delete\")},n))});return m.createElement(m.Fragment,null,m.createElement(_,null,m.createElement(n,{w:\"full\",alignSelf:\"center\",mb:\"neg-x8\"},m.createElement(o,{block:8},m.createElement(p,F,m.createElement(y,{editing:!!(null==t?void 0:t._id),isProtected:null==t?void 0:t.protected,isDisabled:!l}))))),m.createElement(v,null,m.createElement(a,{vertical:!0,stretch:!0},m.createElement(r,{primary:!0,disabled:!F.formState.isDirty||!l,onClick:F.handleSubmit(P)},h(\"Save\")),!(null!=t&&t.protected)&&(null==t?void 0:t._id)&&m.createElement(r,{secondary:!0,danger:!0,onClick:R},h(\"Delete\")),(null==t?void 0:t._id)&&m.createElement(r,{onClick:M},h(\"Users_in_role\")))))})}","map":"{\"version\":3,\"sources\":[\"client/views/admin/permissions/EditRolePage.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IRole } from '@rocket.chat/core-typings';\\nimport { Box, ButtonGroup, Button, Margins } from '@rocket.chat/fuselage';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useSetModal, useToastMessageDispatch, useRoute, useEndpoint } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement } from 'react';\\nimport React from 'react';\\nimport { FormProvider, useForm } from 'react-hook-form';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { ContextualbarFooter, ContextualbarScrollableContent } from '../../../components/Contextualbar';\\nimport GenericModal from '../../../components/GenericModal';\\nimport RoleForm from './RoleForm';\\n\\nconst EditRolePage = ({ role, isEnterprise }: { role?: IRole; isEnterprise: boolean }): ReactElement => {\\n\\tconst { t } = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst setModal = useSetModal();\\n\\tconst usersInRoleRouter = useRoute('admin-permissions');\\n\\tconst router = useRoute('admin-permissions');\\n\\n\\tconst createRole = useEndpoint('POST', '/v1/roles.create');\\n\\tconst updateRole = useEndpoint('POST', '/v1/roles.update');\\n\\tconst deleteRole = useEndpoint('POST', '/v1/roles.delete');\\n\\n\\tconst methods = useForm({\\n\\t\\tdefaultValues: {\\n\\t\\t\\troleId: role?._id,\\n\\t\\t\\tname: role?.name,\\n\\t\\t\\tdescription: role?.description,\\n\\t\\t\\tscope: role?.scope || 'Users',\\n\\t\\t\\tmandatory2fa: !!role?.mandatory2fa,\\n\\t\\t},\\n\\t});\\n\\n\\tconst handleManageUsers = useMutableCallback(() => {\\n\\t\\tif (role?._id) {\\n\\t\\t\\tusersInRoleRouter.push({\\n\\t\\t\\t\\tcontext: 'users-in-role',\\n\\t\\t\\t\\t_id: role._id,\\n\\t\\t\\t});\\n\\t\\t}\\n\\t});\\n\\n\\tconst handleSave = useMutableCallback(async (data) => {\\n\\t\\ttry {\\n\\t\\t\\tif (data.roleId) {\\n\\t\\t\\t\\tawait updateRole(data);\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Saved') });\\n\\t\\t\\t\\treturn router.push({});\\n\\t\\t\\t}\\n\\n\\t\\t\\tawait createRole(data);\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Saved') });\\n\\t\\t\\trouter.push({});\\n\\t\\t} catch (error) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t}\\n\\t});\\n\\n\\tconst handleDelete = useMutableCallback(async () => {\\n\\t\\tif (!role?._id) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tconst deleteRoleAction = async (): Promise<void> => {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tawait deleteRole({ roleId: role._id });\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Role_removed') });\\n\\t\\t\\t\\tsetModal();\\n\\n\\t\\t\\t\\trouter.push({});\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t\\tsetModal();\\n\\t\\t\\t}\\n\\t\\t};\\n\\n\\t\\tconst deleteRoleMessage = isEnterprise ? t('Delete_Role_Warning') : t('Delete_Role_Warning_Not_Enterprise');\\n\\n\\t\\tsetModal(\\n\\t\\t\\t<GenericModal\\n\\t\\t\\t\\tvariant='danger'\\n\\t\\t\\t\\tonConfirm={deleteRoleAction}\\n\\t\\t\\t\\tonClose={(): void => setModal()}\\n\\t\\t\\t\\tonCancel={(): void => setModal()}\\n\\t\\t\\t\\tconfirmText={t('Delete')}\\n\\t\\t\\t>\\n\\t\\t\\t\\t{deleteRoleMessage}\\n\\t\\t\\t</GenericModal>,\\n\\t\\t);\\n\\t});\\n\\n\\treturn (\\n\\t\\t<>\\n\\t\\t\\t<ContextualbarScrollableContent>\\n\\t\\t\\t\\t<Box w='full' alignSelf='center' mb='neg-x8'>\\n\\t\\t\\t\\t\\t<Margins block={8}>\\n\\t\\t\\t\\t\\t\\t<FormProvider {...methods}>\\n\\t\\t\\t\\t\\t\\t\\t<RoleForm editing={Boolean(role?._id)} isProtected={role?.protected} isDisabled={!isEnterprise} />\\n\\t\\t\\t\\t\\t\\t</FormProvider>\\n\\t\\t\\t\\t\\t</Margins>\\n\\t\\t\\t\\t</Box>\\n\\t\\t\\t</ContextualbarScrollableContent>\\n\\t\\t\\t<ContextualbarFooter>\\n\\t\\t\\t\\t<ButtonGroup vertical stretch>\\n\\t\\t\\t\\t\\t<Button primary disabled={!methods.formState.isDirty || !isEnterprise} onClick={methods.handleSubmit(handleSave)}>\\n\\t\\t\\t\\t\\t\\t{t('Save')}\\n\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t{!role?.protected && role?._id && (\\n\\t\\t\\t\\t\\t\\t<Button secondary danger onClick={handleDelete}>\\n\\t\\t\\t\\t\\t\\t\\t{t('Delete')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t{role?._id && <Button onClick={handleManageUsers}>{t('Users_in_role')}</Button>}\\n\\t\\t\\t\\t</ButtonGroup>\\n\\t\\t\\t</ContextualbarFooter>\\n\\t\\t</>\\n\\t);\\n};\\n\\nexport default EditRolePage;\\n\",null],\"names\":[\"Box\",\"ButtonGroup\",\"Button\",\"Margins\",\"useMutableCallback\",\"useSetModal\",\"useToastMessageDispatch\",\"useRoute\",\"useEndpoint\",\"React\",\"FormProvider\",\"useForm\",\"useTranslation\",\"ContextualbarFooter\",\"ContextualbarScrollableContent\",\"GenericModal\",\"RoleForm\",\"module\",\"link\",\"v\",\"default\",\"exportDefault\",\"_ref\",\"role\",\"isEnterprise\",\"t\",\"dispatchToastMessage\",\"setModal\",\"usersInRoleRouter\",\"router\",\"createRole\",\"updateRole\",\"deleteRole\",\"methods\",\"defaultValues\",\"roleId\",\"_id\",\"name\",\"description\",\"scope\",\"mandatory2fa\",\"handleManageUsers\",\"push\",\"context\",\"handleSave\",\"data\",\"type\",\"message\",\"error\",\"handleDelete\",\"deleteRoleAction\",\"deleteRoleMessage\",\"createElement\",\"variant\",\"onConfirm\",\"onClose\",\"onCancel\",\"confirmText\",\"Fragment\",\"w\",\"alignSelf\",\"mb\",\"block\",\"editing\",\"Boolean\",\"isProtected\",\"protected\",\"isDisabled\",\"vertical\",\"stretch\",\"primary\",\"disabled\",\"formState\",\"isDirty\",\"onClick\",\"handleSubmit\",\"secondary\",\"danger\"],\"mappings\":\"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\"}"}