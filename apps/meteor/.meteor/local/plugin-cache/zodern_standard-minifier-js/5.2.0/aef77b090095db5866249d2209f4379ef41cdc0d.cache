{"code":"function module(e,n,t){t.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(e){o=e}},0),t.link(\"@babel/runtime/regenerator\",{default:function(e){a=e}},1),t.export({useDeleteRoom:function(){return h}}),t.link(\"@rocket.chat/core-typings\",{isRoomFederated:function(e){r=e}},0),t.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback:function(e){u=e}},1),t.link(\"@rocket.chat/ui-contexts\",{useSetModal:function(e){i=e},useToastMessageDispatch:function(e){c=e},useRouter:function(e){l=e},usePermission:function(e){s=e},useEndpoint:function(e){m=e}},2),t.link(\"@tanstack/react-query\",{useMutation:function(e){d=e},useQuery:function(e){f=e}},3),t.link(\"react\",{default:function(e){p=e}},4),t.link(\"react-i18next\",{useTranslation:function(e){g=e}},5),t.link(\"../../../components/GenericModal\",{default:function(e){k=e}},6),t.link(\"../../teams/contextualBar/info/DeleteTeam\",{default:function(e){y=e}},7);var o,a,r,u,i,c,l,s,m,d,f,p,g,k,y,h=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.reload,h=g().t,v=l(),I=i(),T=c(),b=\"prid\"in e?\"discussion\":e.teamId&&e.teamMain?\"team\":\"channel\",_=\"admin-rooms\"===v.getRouteName(),D=m(\"POST\",\"/v1/rooms.delete\"),x=m(\"POST\",\"/v1/teams.delete\"),S=m(\"GET\",\"/v1/teams.info\"),M=e.teamId||\"\",P=f([\"teamId\",M],function(){return a.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",S({teamId:M}));case 1:case\"end\":return e.stop()}},null,null,null,Promise)},{keepPreviousData:!0,retry:!1,enabled:\"\"!==e.teamId}).data,R=s(\"delete-\"+e.t,e._id),E=s(\"delete-team-\"+(\"c\"===e.t?\"channel\":\"group\"),null==P?void 0:P.teamInfo.roomId),C=e.teamId,w=!r(e)&&R&&(!C||E),F=d({mutationFn:D,onSuccess:function(){return(T({type:\"success\",message:h(\"Deleted_roomType\",{roomName:e.name,roomType:b})}),_)?v.navigate(\"/admin/rooms\"):v.navigate(\"/home\")},onError:function(e){T({type:\"error\",message:e})},onSettled:function(){I(null),null==t||t()}}),A=d({mutationFn:x,onSuccess:function(){return(T({type:\"success\",message:h(\"Team_has_been_deleted\")}),_)?v.navigate(\"/admin/rooms\"):v.navigate(\"/home\")},onError:function(e){T({type:\"error\",message:e})},onSettled:function(){I(null),null==t||t()}}),G=A.isLoading||F.isLoading;return{handleDelete:u(function(){if(e.teamMain&&e.teamId)return I(p.createElement(y,{onConfirm:function(n){return a.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.teamId){t.next=2;break}return t.abrupt(\"return\");case 2:A.mutateAsync(o({teamId:e.teamId},n.length&&{roomsToRemove:n}));case 3:case\"end\":return t.stop()}},null,null,null,Promise)},onCancel:function(){return I(null)},teamId:e.teamId}));I(p.createElement(k,{title:h(\"Delete_roomType\",{roomType:b}),variant:\"danger\",onConfirm:function(){return a.async(function(n){for(;;)switch(n.prev=n.next){case 0:F.mutateAsync({roomId:e._id});case 1:case\"end\":return n.stop()}},null,null,null,Promise)},onCancel:function(){return I(null)},confirmText:h(\"Yes_delete_it\")},h(\"Delete_Room_Warning\",{roomType:b})))}),canDeleteRoom:w,isDeleting:G}}}","map":"{\"version\":3,\"sources\":[\"client/views/hooks/roomActions/useDeleteRoom.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom, RoomAdminFieldsType } from '@rocket.chat/core-typings';\\nimport { isRoomFederated } from '@rocket.chat/core-typings';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useSetModal, useToastMessageDispatch, useRouter, usePermission, useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useMutation, useQuery } from '@tanstack/react-query';\\nimport React from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport GenericModal from '../../../components/GenericModal';\\nimport DeleteTeamModal from '../../teams/contextualBar/info/DeleteTeam';\\n\\nexport const useDeleteRoom = (room: IRoom | Pick<IRoom, RoomAdminFieldsType>, { reload }: { reload?: () => void } = {}) => {\\n\\tconst { t } = useTranslation();\\n\\tconst router = useRouter();\\n\\tconst setModal = useSetModal();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\t// eslint-disable-next-line no-nested-ternary\\n\\tconst roomType = 'prid' in room ? 'discussion' : room.teamId && room.teamMain ? 'team' : 'channel';\\n\\tconst isAdminRoute = router.getRouteName() === 'admin-rooms';\\n\\n\\tconst deleteRoomEndpoint = useEndpoint('POST', '/v1/rooms.delete');\\n\\tconst deleteTeamEndpoint = useEndpoint('POST', '/v1/teams.delete');\\n\\tconst teamsInfoEndpoint = useEndpoint('GET', '/v1/teams.info');\\n\\n\\tconst teamId = room.teamId || '';\\n\\tconst { data: teamInfoData } = useQuery(['teamId', teamId], async () => teamsInfoEndpoint({ teamId }), {\\n\\t\\tkeepPreviousData: true,\\n\\t\\tretry: false,\\n\\t\\tenabled: room.teamId !== '',\\n\\t});\\n\\n\\tconst hasPermissionToDeleteRoom = usePermission(`delete-${room.t}`, room._id);\\n\\tconst hasPermissionToDeleteTeamRoom = usePermission(`delete-team-${room.t === 'c' ? 'channel' : 'group'}`, teamInfoData?.teamInfo.roomId);\\n\\tconst isTeamRoom = room.teamId;\\n\\tconst canDeleteRoom = isRoomFederated(room) ? false : hasPermissionToDeleteRoom && (!isTeamRoom || hasPermissionToDeleteTeamRoom);\\n\\n\\tconst deleteRoomMutation = useMutation({\\n\\t\\tmutationFn: deleteRoomEndpoint,\\n\\t\\tonSuccess: () => {\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Deleted_roomType', { roomName: room.name, roomType }) });\\n\\t\\t\\tif (isAdminRoute) {\\n\\t\\t\\t\\treturn router.navigate('/admin/rooms');\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn router.navigate('/home');\\n\\t\\t},\\n\\t\\tonError: (error) => {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t},\\n\\t\\tonSettled: () => {\\n\\t\\t\\tsetModal(null);\\n\\t\\t\\treload?.();\\n\\t\\t},\\n\\t});\\n\\n\\tconst deleteTeamMutation = useMutation({\\n\\t\\tmutationFn: deleteTeamEndpoint,\\n\\t\\tonSuccess: () => {\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Team_has_been_deleted') });\\n\\t\\t\\tif (isAdminRoute) {\\n\\t\\t\\t\\treturn router.navigate('/admin/rooms');\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn router.navigate('/home');\\n\\t\\t},\\n\\t\\tonError: (error) => {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t},\\n\\t\\tonSettled: () => {\\n\\t\\t\\tsetModal(null);\\n\\t\\t\\treload?.();\\n\\t\\t},\\n\\t});\\n\\n\\tconst isDeleting = deleteTeamMutation.isLoading || deleteRoomMutation.isLoading;\\n\\n\\tconst handleDelete = useMutableCallback(() => {\\n\\t\\tconst handleDeleteTeam = async (roomsToRemove: IRoom['_id'][]) => {\\n\\t\\t\\tif (!room.teamId) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tdeleteTeamMutation.mutateAsync({ teamId: room.teamId, ...(roomsToRemove.length && { roomsToRemove }) });\\n\\t\\t};\\n\\n\\t\\tif (room.teamMain && room.teamId) {\\n\\t\\t\\treturn setModal(<DeleteTeamModal onConfirm={handleDeleteTeam} onCancel={(): void => setModal(null)} teamId={room.teamId} />);\\n\\t\\t}\\n\\n\\t\\tconst handleDeleteRoom = async () => {\\n\\t\\t\\tdeleteRoomMutation.mutateAsync({ roomId: room._id });\\n\\t\\t};\\n\\n\\t\\tsetModal(\\n\\t\\t\\t<GenericModal\\n\\t\\t\\t\\ttitle={t('Delete_roomType', { roomType })}\\n\\t\\t\\t\\tvariant='danger'\\n\\t\\t\\t\\tonConfirm={handleDeleteRoom}\\n\\t\\t\\t\\tonCancel={(): void => setModal(null)}\\n\\t\\t\\t\\tconfirmText={t('Yes_delete_it')}\\n\\t\\t\\t>\\n\\t\\t\\t\\t{t('Delete_Room_Warning', { roomType })}\\n\\t\\t\\t</GenericModal>,\\n\\t\\t);\\n\\t});\\n\\n\\treturn { handleDelete, canDeleteRoom, isDeleting };\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_objectSpread\",\"_regeneratorRuntime\",\"export\",\"useDeleteRoom\",\"isRoomFederated\",\"useMutableCallback\",\"useSetModal\",\"useToastMessageDispatch\",\"useRouter\",\"usePermission\",\"useEndpoint\",\"useMutation\",\"useQuery\",\"React\",\"useTranslation\",\"GenericModal\",\"DeleteTeamModal\",\"room\",\"_ref\",\"arguments\",\"length\",\"undefined\",\"reload\",\"t\",\"_useTranslation\",\"router\",\"setModal\",\"dispatchToastMessage\",\"roomType\",\"teamId\",\"teamMain\",\"isAdminRoute\",\"getRouteName\",\"deleteRoomEndpoint\",\"deleteTeamEndpoint\",\"teamsInfoEndpoint\",\"teamInfoData\",\"_useQuery\",\"async\",\"_context\",\"prev\",\"next\",\"abrupt\",\"stop\",\"Promise\",\"keepPreviousData\",\"retry\",\"enabled\",\"data\",\"hasPermissionToDeleteRoom\",\"_id\",\"hasPermissionToDeleteTeamRoom\",\"teamInfo\",\"roomId\",\"isTeamRoom\",\"canDeleteRoom\",\"deleteRoomMutation\",\"mutationFn\",\"onSuccess\",\"type\",\"message\",\"roomName\",\"name\",\"navigate\",\"onError\",\"error\",\"onSettled\",\"deleteTeamMutation\",\"isDeleting\",\"isLoading\",\"handleDelete\",\"createElement\",\"onConfirm\",\"roomsToRemove\",\"_context2\",\"mutateAsync\",\"onCancel\",\"title\",\"variant\",\"_context3\",\"confirmText\"],\"mappings\":\"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\"}"}