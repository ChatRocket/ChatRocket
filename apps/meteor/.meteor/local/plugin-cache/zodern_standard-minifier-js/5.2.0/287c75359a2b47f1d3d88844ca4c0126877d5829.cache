{"code":"function module(t,n,i){i.export({LoginPresence:function(){return o}}),i.link(\"meteor/meteor\",{Meteor:function(t){e=t}},0),i.link(\"../../../settings/client\",{settings:function(t){s=t}},1);var e,s,o=new(function(){function t(){this.awayTime=6e5,this.started=!1,this.timer=void 0}var n=t.prototype;return n.startTimer=function(){var t=this;this.stopTimer(),this.awayTime&&(this.timer=setTimeout(function(){return t.disconnect()},this.awayTime))},n.stopTimer=function(){clearTimeout(this.timer)},n.disconnect=function(){var t=e.status();t&&\"offline\"!==t.status&&!e.userId()&&!0!==s.get(\"Accounts_AllowAnonymousRead\")&&e.disconnect(),this.stopTimer()},n.connect=function(){var t=e.status();t&&\"offline\"===t.status&&e.reconnect()},n.start=function(){var t=this;this.started||(window.addEventListener(\"focus\",function(){t.stopTimer(),t.connect()}),window.addEventListener(\"blur\",function(){t.startTimer()}),window.document.hasFocus()||this.startTimer(),this.started=!0)},t}());o.start()}","map":"{\"version\":3,\"sources\":[\"app/lib/client/lib/LoginPresence.ts\",\"<anon>\"],\"sourcesContent\":[\"import { Meteor } from 'meteor/meteor';\\n\\nimport { settings } from '../../../settings/client';\\n\\nclass LoginPresence {\\n\\tprivate awayTime = 600_000; // 10 minutes\\n\\n\\tprivate started = false;\\n\\n\\tprivate timer: ReturnType<typeof setTimeout>;\\n\\n\\tprivate startTimer(): void {\\n\\t\\tthis.stopTimer();\\n\\t\\tif (!this.awayTime) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tthis.timer = setTimeout(() => this.disconnect(), this.awayTime);\\n\\t}\\n\\n\\tprivate stopTimer(): void {\\n\\t\\tclearTimeout(this.timer);\\n\\t}\\n\\n\\tprivate disconnect(): void {\\n\\t\\tconst status = Meteor.status();\\n\\t\\tif (status && status.status !== 'offline') {\\n\\t\\t\\tif (!Meteor.userId() && settings.get('Accounts_AllowAnonymousRead') !== true) {\\n\\t\\t\\t\\tMeteor.disconnect();\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tthis.stopTimer();\\n\\t}\\n\\n\\tprivate connect(): void {\\n\\t\\tconst status = Meteor.status();\\n\\t\\tif (status && status.status === 'offline') {\\n\\t\\t\\tMeteor.reconnect();\\n\\t\\t}\\n\\t}\\n\\n\\tpublic start(): void {\\n\\t\\tif (this.started) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\twindow.addEventListener('focus', () => {\\n\\t\\t\\tthis.stopTimer();\\n\\t\\t\\tthis.connect();\\n\\t\\t});\\n\\n\\t\\twindow.addEventListener('blur', () => {\\n\\t\\t\\tthis.startTimer();\\n\\t\\t});\\n\\n\\t\\tif (!window.document.hasFocus()) {\\n\\t\\t\\tthis.startTimer();\\n\\t\\t}\\n\\n\\t\\tthis.started = true;\\n\\t}\\n}\\n\\nconst instance = new LoginPresence();\\n\\ninstance.start();\\n\\nexport { instance as LoginPresence };\\n\",null],\"names\":[\"module\",\"export\",\"LoginPresence\",\"instance\",\"link\",\"Meteor\",\"v\",\"settings\",\"awayTime\",\"started\",\"timer\",\"_proto\",\"prototype\",\"startTimer\",\"_this\",\"stopTimer\",\"setTimeout\",\"disconnect\",\"clearTimeout\",\"status\",\"userId\",\"get\",\"connect\",\"reconnect\",\"start\",\"_this2\",\"window\",\"addEventListener\",\"document\",\"hasFocus\"],\"mappings\":\"uBAAAA,EAAOC,MAAE,CAAA,CAAMC,cAAQ,WAAgB,OAAAC,CAAA,CAAA,GAAAH,EAAAI,IAAA,CAAA,gBAAA,CAAAC,OAAA,SAAAC,CAAA,EAAAD,EAAAC,CAAA,CAAA,EAAA,GAAAN,EAAAI,IAAA,CAAA,2BAAA,CAAAG,SAAA,SAAAD,CAAA,EAAAC,EAAAD,CAAA,CAAA,EAAA,GA8DvC,IA9DuCD,EAAAE,EA8DjCJ,EAAW,GA1DE,CAAA,WAAA,SAAAD,IAAA,IAAA,CACVM,QAAQ,CAAG,IAAS,IAAA,CAEpBC,OAAO,CAAG,CAAA,EAAK,IAAA,CAEfC,KAAK,CAAA,KAAA,CAAA,CAAA,IAAAC,EAAAT,EAAAU,SAAA,CAkDZ,OAlDYD,EAELE,UAAU,CAAV,WAAU,IAAAC,EAAA,IAAA,CACjB,IAAI,CAACC,SAAS,GACT,IAAI,CAACP,QAAQ,EAGlB,CAAA,IAAI,CAACE,KAAK,CAAGM,WAAW,WAAA,OAAMF,EAAKG,UAAU,EAAE,EAAE,IAAI,CAACT,QAAQ,CAAA,CAC/D,EAACG,EAEOI,SAAS,CAAT,WACPG,aAAa,IAAI,CAACR,KAAK,CACxB,EAACC,EAEOM,UAAU,CAAV,WACP,IAAME,EAASd,EAAOc,MAAM,GACxBA,GAAUA,AAAkB,YAAlBA,EAAOA,MAAM,EACtB,CAACd,EAAOe,MAAM,IAAMb,AAAgD,CAAA,IAAhDA,EAASc,GAAG,CAAC,gCACpChB,EAAOY,UAAU,GAGnB,IAAI,CAACF,SAAS,EACf,EAACJ,EAEOW,OAAO,CAAP,WACP,IAAMH,EAASd,EAAOc,MAAM,GACxBA,GAAUA,AAAkB,YAAlBA,EAAOA,MAAM,EAC1Bd,EAAOkB,SAAS,EAElB,EAACZ,EAEMa,KAAK,CAAL,WAAK,IAAAC,EAAA,IAAA,AACP,CAAA,IAAI,CAAChB,OAAO,GAIhBiB,OAAOC,gBAAgB,CAAC,QAAS,WAChCF,EAAKV,SAAS,GACdU,EAAKH,OAAO,EACb,GAEAI,OAAOC,gBAAgB,CAAC,OAAQ,WAC/BF,EAAKZ,UAAU,EAChB,GAEKa,OAAOE,QAAQ,CAACC,QAAQ,IAC5B,IAAI,CAAChB,UAAU,GAGhB,IAAI,CAACJ,OAAO,CAAG,CAAA,EAChB,EAACP,CAAA,GAAA,EAKFC,EAASqB,KAAK\"}"}