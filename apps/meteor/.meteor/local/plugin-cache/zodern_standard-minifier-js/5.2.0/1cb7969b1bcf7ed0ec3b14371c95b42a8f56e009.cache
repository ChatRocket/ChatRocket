{"code":"function module(e,t,i){let a,r,l,s,n,o,c,u,d,p,h,k,m,P,v,g,y,E,b,f;let w=[\"reset\"];i.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default(e){a=e}},0),i.export({PrioritiesPage:()=>x}),i.link(\"@rocket.chat/fuselage\",{Button(e){r=e},ButtonGroup(e){l=e}},0),i.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback(e){s=e}},1),i.link(\"@rocket.chat/ui-contexts\",{useEndpoint(e){n=e},useRoute(e){o=e},useSetModal(e){c=e},useToastMessageDispatch(e){u=e},useTranslation(e){d=e}},2),i.link(\"@tanstack/react-query\",{useQueryClient(e){p=e}},3),i.link(\"react\",{default(e){h=e},useMemo(e){k=e},useState(e){m=e}},4),i.link(\"../../components/Page\",{Page(e){P=e},PageHeader(e){v=e},PageContent(e){g=e}},5),i.link(\"../hooks/useOmnichannelPriorities\",{useOmnichannelPriorities(e){y=e}},6),i.link(\"./PrioritiesResetModal\",{PrioritiesResetModal(e){E=e}},7),i.link(\"./PrioritiesTable\",{PrioritiesTable(e){b=e}},8),i.link(\"./PriorityList\",{default(e){f=e}},9);let x=e=>{let{priorityId:t,context:i}=e,x=d(),C=p(),R=o(\"omnichannel-priorities\"),M=u(),T=c(),[Q,S]=m(!1),O=n(\"PUT\",\"/v1/livechat/priorities/:priorityId\",{priorityId:t}),B=n(\"POST\",\"/v1/livechat/priorities.reset\"),{data:D,isLoading:I}=y(),L=k(()=>!!D.length&&D.some(e=>e.dirty),[D]),_=s(e=>{R.push({context:\"edit\",id:e})}),j=async e=>{let{reset:t}=e,i=a(e,w);await O(t?{reset:t}:i),await C.invalidateQueries([\"/v1/livechat/priorities\"]),M({type:\"success\",message:x(\"Priority_saved\")}),await C.invalidateQueries([\"/v1/livechat/priorities\"],{exact:!0}),R.push({})};return h.createElement(P,{flexDirection:\"row\"},h.createElement(P,null,h.createElement(v,{title:x(\"Priorities\")},h.createElement(l,null,h.createElement(r,{onClick:()=>{let e=async()=>{try{S(!0),T(null),await B(),await C.invalidateQueries([\"/v1/livechat/priorities\"],{exact:!0}),R.push({}),M({type:\"success\",message:x(\"Priorities_restored\")})}catch(e){M({type:\"error\",message:e})}finally{S(!1)}};T(h.createElement(E,{onReset:e,onCancel:()=>T(null)}))},title:x(\"Reset\"),disabled:!L,loading:Q},x(\"Reset\")))),h.createElement(g,null,h.createElement(b,{priorities:D,isLoading:I,onRowClick:_}))),\"edit\"===i&&h.createElement(f,{priorityId:t,context:i,onSave:j,onClose:()=>{R.push({})}}))}}","map":"{\"version\":3,\"sources\":[\"client/omnichannel/priorities/PrioritiesPage.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Button, ButtonGroup } from '@rocket.chat/fuselage';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useEndpoint, useRoute, useSetModal, useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\\nimport { useQueryClient } from '@tanstack/react-query';\\nimport type { ReactElement } from 'react';\\nimport React, { useMemo, useState } from 'react';\\n\\nimport { Page, PageHeader, PageContent } from '../../components/Page';\\nimport { useOmnichannelPriorities } from '../hooks/useOmnichannelPriorities';\\nimport { PrioritiesResetModal } from './PrioritiesResetModal';\\nimport { PrioritiesTable } from './PrioritiesTable';\\nimport type { PriorityFormData } from './PriorityEditForm';\\nimport PriorityList from './PriorityList';\\n\\ntype PrioritiesPageProps = {\\n\\tpriorityId: string;\\n\\tcontext: 'edit' | undefined;\\n};\\n\\nexport const PrioritiesPage = ({ priorityId, context }: PrioritiesPageProps): ReactElement => {\\n\\tconst t = useTranslation();\\n\\tconst queryClient = useQueryClient();\\n\\tconst prioritiesRoute = useRoute('omnichannel-priorities');\\n\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst setModal = useSetModal();\\n\\n\\tconst [isResetting, setResetting] = useState(false);\\n\\n\\tconst savePriority = useEndpoint('PUT', `/v1/livechat/priorities/:priorityId`, { priorityId });\\n\\tconst resetPriorities = useEndpoint('POST', '/v1/livechat/priorities.reset');\\n\\n\\tconst { data: priorities, isLoading } = useOmnichannelPriorities();\\n\\n\\tconst isPrioritiesDirty = useMemo(() => !!priorities.length && priorities.some((p) => p.dirty), [priorities]);\\n\\n\\tconst handleReset = (): void => {\\n\\t\\tconst onReset = async (): Promise<void> => {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tsetResetting(true);\\n\\t\\t\\t\\tsetModal(null);\\n\\n\\t\\t\\t\\tawait resetPriorities();\\n\\t\\t\\t\\tawait queryClient.invalidateQueries(['/v1/livechat/priorities'], { exact: true });\\n\\n\\t\\t\\t\\tprioritiesRoute.push({});\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Priorities_restored') });\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t} finally {\\n\\t\\t\\t\\tsetResetting(false);\\n\\t\\t\\t}\\n\\t\\t};\\n\\n\\t\\tsetModal(<PrioritiesResetModal onReset={onReset} onCancel={(): void => setModal(null)} />);\\n\\t};\\n\\n\\tconst onRowClick = useMutableCallback((id: string): void => {\\n\\t\\tprioritiesRoute.push({ context: 'edit', id });\\n\\t});\\n\\n\\tconst onContextualbarClose = (): void => {\\n\\t\\tprioritiesRoute.push({});\\n\\t};\\n\\n\\tconst onSavePriority = async ({ reset, ...payload }: PriorityFormData): Promise<void> => {\\n\\t\\tawait savePriority(reset ? { reset } : payload);\\n\\t\\tawait queryClient.invalidateQueries(['/v1/livechat/priorities']);\\n\\n\\t\\tdispatchToastMessage({ type: 'success', message: t('Priority_saved') });\\n\\t\\tawait queryClient.invalidateQueries(['/v1/livechat/priorities'], { exact: true });\\n\\t\\tprioritiesRoute.push({});\\n\\t};\\n\\n\\treturn (\\n\\t\\t<Page flexDirection='row'>\\n\\t\\t\\t<Page>\\n\\t\\t\\t\\t<PageHeader title={t('Priorities')}>\\n\\t\\t\\t\\t\\t<ButtonGroup>\\n\\t\\t\\t\\t\\t\\t<Button onClick={handleReset} title={t('Reset')} disabled={!isPrioritiesDirty} loading={isResetting}>\\n\\t\\t\\t\\t\\t\\t\\t{t('Reset')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t</ButtonGroup>\\n\\t\\t\\t\\t</PageHeader>\\n\\t\\t\\t\\t<PageContent>\\n\\t\\t\\t\\t\\t<PrioritiesTable priorities={priorities} isLoading={isLoading} onRowClick={onRowClick} />\\n\\t\\t\\t\\t</PageContent>\\n\\t\\t\\t</Page>\\n\\t\\t\\t{context === 'edit' && (\\n\\t\\t\\t\\t<PriorityList priorityId={priorityId} context={context} onSave={onSavePriority} onClose={onContextualbarClose} />\\n\\t\\t\\t)}\\n\\t\\t</Page>\\n\\t);\\n};\\n\",null],\"names\":[\"_objectWithoutProperties\",\"Button\",\"ButtonGroup\",\"useMutableCallback\",\"useEndpoint\",\"useRoute\",\"useSetModal\",\"useToastMessageDispatch\",\"useTranslation\",\"useQueryClient\",\"React\",\"useMemo\",\"useState\",\"Page\",\"PageHeader\",\"PageContent\",\"useOmnichannelPriorities\",\"PrioritiesResetModal\",\"PrioritiesTable\",\"PriorityList\",\"module\",\"link\",\"default\",\"v\",\"export\",\"PrioritiesPage\",\"_ref\",\"priorityId\",\"context\",\"t\",\"queryClient\",\"prioritiesRoute\",\"dispatchToastMessage\",\"setModal\",\"isResetting\",\"setResetting\",\"savePriority\",\"resetPriorities\",\"data\",\"priorities\",\"isLoading\",\"isPrioritiesDirty\",\"length\",\"some\",\"p\",\"dirty\",\"onRowClick\",\"id\",\"push\",\"onSavePriority\",\"_ref2\",\"reset\",\"payload\",\"_excluded\",\"invalidateQueries\",\"type\",\"message\",\"exact\",\"createElement\",\"flexDirection\",\"title\",\"onClick\",\"handleReset\",\"onReset\",\"error\",\"onCancel\",\"disabled\",\"loading\",\"onSave\",\"onClose\",\"onContextualbarClose\"],\"mappings\":\"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\"}"}