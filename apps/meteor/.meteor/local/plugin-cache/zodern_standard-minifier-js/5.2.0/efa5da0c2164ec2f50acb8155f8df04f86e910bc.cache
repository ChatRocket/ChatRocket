{"code":"function module(n,e,t){var i,r,u,o,c,l,a,f,s,d;t.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(n){i=n}},0),t.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(n){r=n}},1),t.link(\"react\",{default:function(n){u=n},useState:function(n){o=n},useMemo:function(n){c=n},useEffect:function(n){l=n}},0),t.link(\"../contexts/VideoConfContext\",{VideoConfContext:function(n){a=n}},1),t.link(\"../lib/VideoConfManager\",{VideoConfManager:function(n){f=n}},2),t.link(\"../views/room/contextualBar/VideoConference/VideoConfPopups\",{default:function(n){s=n}},3),t.link(\"../views/room/contextualBar/VideoConference/hooks/useVideoConfOpenCall\",{useVideoConfOpenCall:function(n){d=n}},4),t.exportDefault(function(n){var e=n.children,t=o(),g=r(t,2),C=g[0],b=g[1],m=d();l(function(){return f.on(\"call/join\",function(n){m(n.url,n.providerName)})},[m]),l(function(){f.on(\"direct/stopped\",function(){return b(void 0)}),f.on(\"calling/ended\",function(){return b(void 0)})},[]);var p=c(function(){return{manager:f,dispatchOutgoing:function(n){return b(i(i({},n),{},{id:n.rid}))},dismissOutgoing:function(){return b(void 0)},startCall:function(n,e){return f.startCall(n,e)},acceptCall:function(n){return f.acceptIncomingCall(n)},joinCall:function(n){return f.joinCall(n)},dismissCall:function(n){f.dismissIncomingCall(n)},rejectIncomingCall:function(n){return f.rejectIncomingCall(n)},abortCall:function(){return f.abortCall()},setPreferences:function(n){return f.setPreferences(n)},queryIncomingCalls:{getCurrentValue:function(){return f.getIncomingDirectCalls()},subscribe:function(n){return f.on(\"incoming/changed\",n)}},queryRinging:{getCurrentValue:function(){return f.isRinging()},subscribe:function(n){return f.on(\"ringing/changed\",n)}},queryCalling:{getCurrentValue:function(){return f.isCalling()},subscribe:function(n){return f.on(\"calling/changed\",n)}},queryCapabilities:{getCurrentValue:function(){return f.capabilities},subscribe:function(n){return f.on(\"capabilities/changed\",n)}},queryPreferences:{getCurrentValue:function(){return f.preferences},subscribe:function(n){return f.on(\"preference/changed\",n)}}}},[]);return u.createElement(a.Provider,{value:p},e,u.createElement(s,null,C))})}","map":"{\"version\":3,\"sources\":[\"client/providers/VideoConfProvider.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom } from '@rocket.chat/core-typings';\\nimport type { ReactElement, ReactNode } from 'react';\\nimport React, { useState, useMemo, useEffect } from 'react';\\nimport type { Unsubscribe } from 'use-subscription';\\n\\nimport type { VideoConfPopupPayload } from '../contexts/VideoConfContext';\\nimport { VideoConfContext } from '../contexts/VideoConfContext';\\nimport type { DirectCallData, ProviderCapabilities, CallPreferences } from '../lib/VideoConfManager';\\nimport { VideoConfManager } from '../lib/VideoConfManager';\\nimport VideoConfPopups from '../views/room/contextualBar/VideoConference/VideoConfPopups';\\nimport { useVideoConfOpenCall } from '../views/room/contextualBar/VideoConference/hooks/useVideoConfOpenCall';\\n\\nconst VideoConfContextProvider = ({ children }: { children: ReactNode }): ReactElement => {\\n\\tconst [outgoing, setOutgoing] = useState<VideoConfPopupPayload | undefined>();\\n\\tconst handleOpenCall = useVideoConfOpenCall();\\n\\n\\tuseEffect(\\n\\t\\t() =>\\n\\t\\t\\tVideoConfManager.on('call/join', (props) => {\\n\\t\\t\\t\\thandleOpenCall(props.url, props.providerName);\\n\\t\\t\\t}),\\n\\t\\t[handleOpenCall],\\n\\t);\\n\\n\\tuseEffect(() => {\\n\\t\\tVideoConfManager.on('direct/stopped', () => setOutgoing(undefined));\\n\\t\\tVideoConfManager.on('calling/ended', () => setOutgoing(undefined));\\n\\t}, []);\\n\\n\\tconst contextValue = useMemo(\\n\\t\\t() => ({\\n\\t\\t\\tmanager: VideoConfManager,\\n\\t\\t\\tdispatchOutgoing: (option: Omit<VideoConfPopupPayload, 'id'>): void => setOutgoing({ ...option, id: option.rid }),\\n\\t\\t\\tdismissOutgoing: (): void => setOutgoing(undefined),\\n\\t\\t\\tstartCall: (rid: IRoom['_id'], confTitle?: string): Promise<void> => VideoConfManager.startCall(rid, confTitle),\\n\\t\\t\\tacceptCall: (callId: string): void => VideoConfManager.acceptIncomingCall(callId),\\n\\t\\t\\tjoinCall: (callId: string): Promise<void> => VideoConfManager.joinCall(callId),\\n\\t\\t\\tdismissCall: (callId: string): void => {\\n\\t\\t\\t\\tVideoConfManager.dismissIncomingCall(callId);\\n\\t\\t\\t},\\n\\t\\t\\trejectIncomingCall: (callId: string): void => VideoConfManager.rejectIncomingCall(callId),\\n\\t\\t\\tabortCall: (): void => VideoConfManager.abortCall(),\\n\\t\\t\\tsetPreferences: (prefs: Partial<(typeof VideoConfManager)['preferences']>): void => VideoConfManager.setPreferences(prefs),\\n\\t\\t\\tqueryIncomingCalls: {\\n\\t\\t\\t\\tgetCurrentValue: (): DirectCallData[] => VideoConfManager.getIncomingDirectCalls(),\\n\\t\\t\\t\\tsubscribe: (cb: () => void): Unsubscribe => VideoConfManager.on('incoming/changed', cb),\\n\\t\\t\\t},\\n\\t\\t\\tqueryRinging: {\\n\\t\\t\\t\\tgetCurrentValue: (): boolean => VideoConfManager.isRinging(),\\n\\t\\t\\t\\tsubscribe: (cb: () => void): Unsubscribe => VideoConfManager.on('ringing/changed', cb),\\n\\t\\t\\t},\\n\\t\\t\\tqueryCalling: {\\n\\t\\t\\t\\tgetCurrentValue: (): boolean => VideoConfManager.isCalling(),\\n\\t\\t\\t\\tsubscribe: (cb: () => void): Unsubscribe => VideoConfManager.on('calling/changed', cb),\\n\\t\\t\\t},\\n\\t\\t\\tqueryCapabilities: {\\n\\t\\t\\t\\tgetCurrentValue: (): ProviderCapabilities => VideoConfManager.capabilities,\\n\\t\\t\\t\\tsubscribe: (cb: () => void): Unsubscribe => VideoConfManager.on('capabilities/changed', cb),\\n\\t\\t\\t},\\n\\t\\t\\tqueryPreferences: {\\n\\t\\t\\t\\tgetCurrentValue: (): CallPreferences => VideoConfManager.preferences,\\n\\t\\t\\t\\tsubscribe: (cb: () => void): Unsubscribe => VideoConfManager.on('preference/changed', cb),\\n\\t\\t\\t},\\n\\t\\t}),\\n\\t\\t[],\\n\\t);\\n\\n\\treturn (\\n\\t\\t<VideoConfContext.Provider value={contextValue}>\\n\\t\\t\\t{children}\\n\\t\\t\\t<VideoConfPopups>{outgoing}</VideoConfPopups>\\n\\t\\t</VideoConfContext.Provider>\\n\\t);\\n};\\n\\nexport default VideoConfContextProvider;\\n\",null],\"names\":[\"_objectSpread\",\"_slicedToArray\",\"React\",\"useState\",\"useMemo\",\"useEffect\",\"VideoConfContext\",\"VideoConfManager\",\"VideoConfPopups\",\"useVideoConfOpenCall\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"children\",\"_useState\",\"_useState2\",\"outgoing\",\"setOutgoing\",\"handleOpenCall\",\"on\",\"props\",\"url\",\"providerName\",\"undefined\",\"contextValue\",\"manager\",\"dispatchOutgoing\",\"option\",\"id\",\"rid\",\"dismissOutgoing\",\"startCall\",\"confTitle\",\"acceptCall\",\"callId\",\"acceptIncomingCall\",\"joinCall\",\"dismissCall\",\"dismissIncomingCall\",\"rejectIncomingCall\",\"abortCall\",\"setPreferences\",\"prefs\",\"queryIncomingCalls\",\"getCurrentValue\",\"getIncomingDirectCalls\",\"subscribe\",\"cb\",\"queryRinging\",\"isRinging\",\"queryCalling\",\"isCalling\",\"queryCapabilities\",\"capabilities\",\"queryPreferences\",\"preferences\",\"createElement\",\"Provider\",\"value\"],\"mappings\":\"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\"}"}