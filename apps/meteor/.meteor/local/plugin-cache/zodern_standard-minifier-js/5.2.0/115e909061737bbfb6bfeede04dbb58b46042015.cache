{"code":"function module(t,n,i){i.export({isLegacyPayload:function(){return u},firstSubscription:function(){return c},open:function(){return f},closeById:function(){return d},close:function(){return a},clear:function(){return l}}),i.link(\"@rocket.chat/emitter\",{Emitter:function(t){e=t}},0);var e,u=function(t){return!(\"blocks\"in t)},r=[],o=new e,c=[function(t){return o.on(\"update-first\",t)},function(){var t;return null!==(t=r[0])&&void 0!==t?t:null}],f=function(t){var n=r.findIndex(function(n){return u(n)&&u(t)?n.id===t.id:!(u(n)||u(t))&&n.viewId===t.viewId});-1===n&&(n=r.length),r[n]=t,o.emit(\"update\"),0===n&&o.emit(\"update-first\")},d=function(t){var n=r.findIndex(function(n){return u(n)?n.id===t:n.viewId===t});n<0||(r.splice(n,1),o.emit(\"update\"),0===n&&o.emit(\"update-first\"))},a=function(){r.shift(),o.emit(\"update\"),o.emit(\"update-first\")},l=function(){r.splice(0,r.length),o.emit(\"update\"),o.emit(\"update-first\")}}","map":"{\"version\":3,\"sources\":[\"client/lib/banners.ts\",\"<anon>\"],\"sourcesContent\":[\"import { Emitter } from '@rocket.chat/emitter';\\nimport type { Keys as IconName } from '@rocket.chat/icons';\\nimport type * as UiKit from '@rocket.chat/ui-kit';\\n\\nexport type LegacyBannerPayload = {\\n\\tid: string;\\n\\tclosable?: boolean;\\n\\ttitle?: string | (() => string);\\n\\ttext?: string | (() => string);\\n\\thtml?: string | (() => string);\\n\\ticon?: IconName;\\n\\tmodifiers?: ('large' | 'danger')[];\\n\\ttimer?: number;\\n\\taction?: () => Promise<void> | void;\\n\\tonClose?: () => Promise<void> | void;\\n};\\n\\ntype BannerPayload = LegacyBannerPayload | UiKit.BannerView;\\n\\nexport const isLegacyPayload = (payload: BannerPayload): payload is LegacyBannerPayload => !('blocks' in payload);\\n\\nconst queue: BannerPayload[] = [];\\nconst emitter = new Emitter<{\\n\\t'update': undefined;\\n\\t'update-first': undefined;\\n}>();\\n\\nexport const firstSubscription = [\\n\\t(callback: () => void): (() => void) => emitter.on('update-first', callback),\\n\\t(): BannerPayload | null => queue[0] ?? null,\\n] as const;\\n\\nexport const open = (payload: BannerPayload): void => {\\n\\tlet index = queue.findIndex((_payload) => {\\n\\t\\tif (isLegacyPayload(_payload) && isLegacyPayload(payload)) {\\n\\t\\t\\treturn _payload.id === payload.id;\\n\\t\\t}\\n\\n\\t\\tif (!isLegacyPayload(_payload) && !isLegacyPayload(payload)) {\\n\\t\\t\\treturn _payload.viewId === payload.viewId;\\n\\t\\t}\\n\\n\\t\\treturn false;\\n\\t});\\n\\n\\tif (index === -1) {\\n\\t\\tindex = queue.length;\\n\\t}\\n\\n\\tqueue[index] = payload;\\n\\n\\temitter.emit('update');\\n\\n\\tif (index === 0) {\\n\\t\\temitter.emit('update-first');\\n\\t}\\n};\\n\\nexport const closeById = (id: string): void => {\\n\\tconst index = queue.findIndex((banner) => {\\n\\t\\tif (!isLegacyPayload(banner)) {\\n\\t\\t\\treturn banner.viewId === id;\\n\\t\\t}\\n\\t\\treturn banner.id === id;\\n\\t});\\n\\n\\tif (index < 0) {\\n\\t\\treturn;\\n\\t}\\n\\n\\tqueue.splice(index, 1);\\n\\temitter.emit('update');\\n\\tindex === 0 && emitter.emit('update-first');\\n};\\n\\nexport const close = (): void => {\\n\\tqueue.shift();\\n\\temitter.emit('update');\\n\\temitter.emit('update-first');\\n};\\n\\nexport const clear = (): void => {\\n\\tqueue.splice(0, queue.length);\\n\\temitter.emit('update');\\n\\temitter.emit('update-first');\\n};\\n\",null],\"names\":[\"module\",\"export\",\"isLegacyPayload\",\"firstSubscription\",\"open\",\"closeById\",\"close\",\"clear\",\"link\",\"Emitter\",\"v\",\"payload\",\"queue\",\"emitter\",\"callback\",\"on\",\"_queue$\",\"index\",\"findIndex\",\"_payload\",\"id\",\"viewId\",\"length\",\"emit\",\"banner\",\"splice\",\"shift\"],\"mappings\":\"uBAAAA,EAAOC,MAAE,CAAA,CAAAC,gBAAe,WAAA,OAAuBA,CAAA,EAAAC,kBAAA,WAAA,OAAAA,CAAA,EAAAC,KAAA,WAAA,OAAAA,CAAA,EAAAC,UAAA,WAAA,OAAAA,CAAA,EAAAC,MAAA,WAAA,OAAAA,CAAA,EAAAC,MAAA,WAAA,OAAAA,CAAA,CAAA,GAAAP,EAAAQ,IAAA,CAAA,uBAAA,CAAAC,QAAA,SAAAC,CAAA,EAAAD,EAAAC,CAAA,CAAA,EAAA,GAmBxC,IAnBwCD,EAmBlCP,EAAkB,SAACS,CAAsB,EAAA,MAAqC,CAAE,CAAA,WAAYA,CAAAA,CAAQ,EAE3GC,EAAyB,EAAE,CAC3BC,EAAU,IAAIJ,EAKPN,EAAoB,CAChC,SAACW,CAAoB,EAAA,OAAmBD,EAAQE,EAAE,CAAC,eAAgBD,EAAS,EAC5E,WAAA,IAAAE,EAAA,OAAA,AAAoC,OAApCA,CAAAA,EAA4BJ,CAAK,CAAC,EAAE,AAAD,GAACI,AAAA,KAAA,IAAAA,EAAAA,EAAI,IAAI,EACnC,CAEGZ,EAAO,SAACO,CAAsB,EAC1C,IAAIM,EAAQL,EAAMM,SAAS,CAAC,SAACC,CAAQ,SACpC,AAAIjB,EAAgBiB,IAAajB,EAAgBS,GACzCQ,EAASC,EAAE,GAAKT,EAAQS,EAAE,EAG9B,CAAA,AAAClB,EAAgBiB,IAAcjB,EAAgBS,EAAO,GAClDQ,EAASE,MAAM,GAAKV,EAAQU,MAAM,AAI3C,EAEc,CAAA,KAAVJ,GACHA,CAAAA,EAAQL,EAAMU,MAAM,AAANA,EAGfV,CAAK,CAACK,EAAM,CAAGN,EAEfE,EAAQU,IAAI,CAAC,UAEC,IAAVN,GACHJ,EAAQU,IAAI,CAAC,eAEf,EAEalB,EAAY,SAACe,CAAU,EACnC,IAAMH,EAAQL,EAAMM,SAAS,CAAC,SAACM,CAAM,SACpC,AAAKtB,EAAgBsB,GAGdA,EAAOJ,EAAE,GAAKA,EAFbI,EAAOH,MAAM,GAAKD,CAG3B,GAEIH,EAAQ,IAIZL,EAAMa,MAAM,CAACR,EAAO,GACpBJ,EAAQU,IAAI,CAAC,UACbN,AAAU,IAAVA,GAAeJ,EAAQU,IAAI,CAAC,gBAC7B,EAEajB,EAAQ,WACpBM,EAAMc,KAAK,GACXb,EAAQU,IAAI,CAAC,UACbV,EAAQU,IAAI,CAAC,eACd,EAEahB,EAAQ,WACpBK,EAAMa,MAAM,CAAC,EAAGb,EAAMU,MAAM,EAC5BT,EAAQU,IAAI,CAAC,UACbV,EAAQU,IAAI,CAAC,eACd\"}"}