{"code":"function module(e,o,n){let t,i,l,a,u,c,r,d,s,p,f;n.link(\"@rocket.chat/ui-contexts\",{useCustomSound(e){t=e}},0),n.link(\"@rocket.chat/ui-video-conf\",{VideoConfPopupBackdrop(e){i=e}},1),n.link(\"react\",{default(e){l=e},useEffect(e){a=e},useMemo(e){u=e}},2),n.link(\"react-aria\",{FocusScope(e){c=e}},3),n.link(\"../../../../../contexts/VideoConfContext\",{useVideoConfIsCalling(e){r=e},useVideoConfIsRinging(e){d=e},useVideoConfIncomingCalls(e){s=e}},4),n.link(\"../../../../../portals/VideoConfPopupPortal\",{default(e){p=e}},5),n.link(\"./VideoConfPopup\",{default(e){f=e}},6),n.exportDefault(e=>{let{children:o}=e,n=t(),m=s(),g=d(),C=r(),k=u(()=>m.filter(e=>!e.dismissed).map(e=>({id:e.callId,rid:e.rid,isReceiving:!0})),[m]);return a(()=>(g&&n.play(\"ringtone\",{loop:!0}),C&&n.play(\"dialtone\",{loop:!0}),()=>{n.stop(\"ringtone\"),n.stop(\"dialtone\")}),[n,g,C]),l.createElement(l.Fragment,null,(o||(null==k?void 0:k.length)>0)&&l.createElement(p,null,l.createElement(c,{autoFocus:!0,contain:!0,restoreFocus:!0},l.createElement(i,null,(o?[o,...k]:k).map(function(e){let{id:o,rid:n,isReceiving:t}=e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return l.createElement(f,{key:o,id:o,rid:n,isReceiving:t,isCalling:C,position:10*i})})))))})}","map":"{\"version\":3,\"sources\":[\"client/views/room/contextualBar/VideoConference/VideoConfPopups/VideoConfPopups.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { useCustomSound } from '@rocket.chat/ui-contexts';\\nimport { VideoConfPopupBackdrop } from '@rocket.chat/ui-video-conf';\\nimport type { ReactElement } from 'react';\\nimport React, { useEffect, useMemo } from 'react';\\nimport { FocusScope } from 'react-aria';\\n\\nimport type { VideoConfPopupPayload } from '../../../../../contexts/VideoConfContext';\\nimport { useVideoConfIsCalling, useVideoConfIsRinging, useVideoConfIncomingCalls } from '../../../../../contexts/VideoConfContext';\\nimport VideoConfPopupPortal from '../../../../../portals/VideoConfPopupPortal';\\nimport VideoConfPopup from './VideoConfPopup';\\n\\nconst VideoConfPopups = ({ children }: { children?: VideoConfPopupPayload }): ReactElement => {\\n\\tconst customSound = useCustomSound();\\n\\tconst incomingCalls = useVideoConfIncomingCalls();\\n\\tconst isRinging = useVideoConfIsRinging();\\n\\tconst isCalling = useVideoConfIsCalling();\\n\\n\\tconst popups = useMemo(\\n\\t\\t() =>\\n\\t\\t\\tincomingCalls\\n\\t\\t\\t\\t.filter((incomingCall) => !incomingCall.dismissed)\\n\\t\\t\\t\\t.map((incomingCall) => ({ id: incomingCall.callId, rid: incomingCall.rid, isReceiving: true })),\\n\\t\\t[incomingCalls],\\n\\t);\\n\\n\\tuseEffect(() => {\\n\\t\\tif (isRinging) {\\n\\t\\t\\tcustomSound.play('ringtone', { loop: true });\\n\\t\\t}\\n\\n\\t\\tif (isCalling) {\\n\\t\\t\\tcustomSound.play('dialtone', { loop: true });\\n\\t\\t}\\n\\n\\t\\treturn (): void => {\\n\\t\\t\\tcustomSound.stop('ringtone');\\n\\t\\t\\tcustomSound.stop('dialtone');\\n\\t\\t};\\n\\t}, [customSound, isRinging, isCalling]);\\n\\n\\treturn (\\n\\t\\t<>\\n\\t\\t\\t{(children || popups?.length > 0) && (\\n\\t\\t\\t\\t<VideoConfPopupPortal>\\n\\t\\t\\t\\t\\t<FocusScope autoFocus contain restoreFocus>\\n\\t\\t\\t\\t\\t\\t<VideoConfPopupBackdrop>\\n\\t\\t\\t\\t\\t\\t\\t{(children ? [children, ...popups] : popups).map(({ id, rid, isReceiving }, index = 1) => (\\n\\t\\t\\t\\t\\t\\t\\t\\t<VideoConfPopup key={id} id={id} rid={rid} isReceiving={isReceiving} isCalling={isCalling} position={index * 10} />\\n\\t\\t\\t\\t\\t\\t\\t))}\\n\\t\\t\\t\\t\\t\\t</VideoConfPopupBackdrop>\\n\\t\\t\\t\\t\\t</FocusScope>\\n\\t\\t\\t\\t</VideoConfPopupPortal>\\n\\t\\t\\t)}\\n\\t\\t</>\\n\\t);\\n};\\n\\nexport default VideoConfPopups;\\n\",null],\"names\":[\"useCustomSound\",\"VideoConfPopupBackdrop\",\"React\",\"useEffect\",\"useMemo\",\"FocusScope\",\"useVideoConfIsCalling\",\"useVideoConfIsRinging\",\"useVideoConfIncomingCalls\",\"VideoConfPopupPortal\",\"VideoConfPopup\",\"module\",\"link\",\"v\",\"default\",\"exportDefault\",\"_ref\",\"children\",\"customSound\",\"incomingCalls\",\"isRinging\",\"isCalling\",\"popups\",\"filter\",\"incomingCall\",\"dismissed\",\"map\",\"id\",\"callId\",\"rid\",\"isReceiving\",\"play\",\"loop\",\"stop\",\"createElement\",\"Fragment\",\"length\",\"autoFocus\",\"contain\",\"restoreFocus\",\"_ref2\",\"index\",\"arguments\",\"undefined\",\"key\",\"position\"],\"mappings\":\"2BAAAA,EAA0DC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAjDC,EAAgBC,IAAA,CAAM,2BAA2B,CAAAZ,eAAAa,CAAA,EAAAb,EAAAa,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,6BAAA,CAAAX,uBAAAY,CAAA,EAAAZ,EAAAY,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,QAAA,CAAAE,QAAAD,CAAA,EAAAX,EAAAW,CAAA,EAAAV,UAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,QAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,aAAA,CAAAP,WAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,2CAAA,CAAAN,sBAAAO,CAAA,EAAAP,EAAAO,CAAA,EAAAN,sBAAAM,CAAA,EAAAN,EAAAM,CAAA,EAAAL,0BAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,8CAAA,CAAAE,QAAAD,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,mBAAA,CAAAE,QAAAD,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,GAA1DF,EAAOI,aAAE,CAWeC,IAAqE,GAApE,CAAEC,SAAAA,CAAAA,CAAgD,CAAAD,EACpEE,EAAclB,IACdmB,EAAgBX,IAChBY,EAAYb,IACZc,EAAYf,IAEZgB,EAASlB,EACd,IACCe,EACEI,MAAM,CAAEC,GAAiB,CAACA,EAAaC,SAAS,EAChDC,GAAG,CAAEF,GAAkB,CAAA,CAAEG,GAAIH,EAAaI,MAAM,CAAEC,IAAKL,EAAaK,GAAG,CAAEC,YAAa,CAAA,CAAI,CAAA,GAC7F,CAACX,EAAc,EAkBhB,OAfAhB,EAAU,KACLiB,GACHF,EAAYa,IAAI,CAAC,WAAY,CAAEC,KAAM,CAAA,CAAI,GAGtCX,GACHH,EAAYa,IAAI,CAAC,WAAY,CAAEC,KAAM,CAAA,CAAI,GAGnC,KACNd,EAAYe,IAAI,CAAC,YACjBf,EAAYe,IAAI,CAAC,WAClB,GACE,CAACf,EAAaE,EAAWC,EAAU,EAGrCnB,EAAAgC,aAAA,CAAAhC,EAAAiC,QAAA,CAAA,KACE,AAAClB,CAAAA,GAAY,AAAAK,CAAAA,MAAAA,EAAM,KAAA,EAANA,EAAQc,MAAM,AAANA,EAAS,CAAA,GAC9BlC,EAAAgC,aAAA,CAACzB,EAAoB,KACpBP,EAAAgC,aAAA,CAAC7B,EAAU,CAACgC,UAAS,CAAA,EAACC,QAAO,CAAA,EAACC,aAAY,CAAA,CAAA,EACzCrC,EAAAgC,aAAA,CAACjC,EAAsB,KACrB,AAACgB,CAAAA,EAAW,CAACA,KAAaK,EAAO,CAAGA,CAAAA,EAAQI,GAAG,CAAC,SAAAc,CAAA,EAAA,GAAC,CAAEb,GAAAA,CAAE,CAAEE,IAAAA,CAAG,CAAEC,YAAAA,CAAAA,CAAa,CAAAU,EAAEC,EAAKC,UAAAN,MAAA,CAAA,GAAAM,AAAAC,KAAAA,IAAAD,SAAA,CAAA,EAAA,CAAAA,SAAA,CAAA,EAAA,CAAG,EAAC,OACpFxC,EAAAgC,aAAA,CAACxB,EAAc,CAACkC,IAAKjB,EAAIA,GAAIA,EAAIE,IAAKA,EAAKC,YAAaA,EAAaT,UAAWA,EAAWwB,SAAUJ,AAAQ,GAARA,CAAW,EAAG,MAQ3H\"}"}