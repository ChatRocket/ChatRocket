{"code":"function module(e,o,n){n.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(e){t=e}},0),n.link(\"@babel/runtime/helpers/toConsumableArray\",{default:function(e){i=e}},1),n.link(\"@rocket.chat/random\",{Random:function(e){r=e}},0),n.link(\"meteor/accounts-base\",{Accounts:function(e){l=e}},1),n.link(\"meteor/google-oauth\",{Google:function(e){a=e}},2),n.link(\"meteor/meteor\",{Meteor:function(e){c=e}},3),n.link(\"meteor/oauth\",{OAuth:function(e){s=e}},4),n.link(\"../../lib/2fa/overrideLoginMethod\",{overrideLoginMethod:function(e){u=e}},5),n.link(\"../../lib/wrapRequestCredentialFn\",{wrapRequestCredentialFn:function(e){g=e}},6),n.link(\"./oauth\",{createOAuthTotpLoginMethod:function(e){p=e}},7);var t,i,r,l,a,c,s,u,g,p,d=c.loginWithGoogle,m=p(a),f=function(e,o,n){if(c.isCordova&&a.signIn){a.signIn(e,n);return}\"string\"==typeof l._options.restrictCreationByEmailDomain&&((e=Object.assign({},e||{})).loginUrlParameters=Object.assign({},e.loginUrlParameters||{}),e.loginUrlParameters.hd=l._options.restrictCreationByEmailDomain),m(e,o,n)};c.loginWithGoogle=function(e,o){u(d,[e],o,f)},a.requestCredential=g(\"google\",function(e){var o=e.config,n=e.loginStyle,l=e.options,a=e.credentialRequestCompleteCallback,c=r.secret(),u=[\"email\"].concat(i(l.requestPermissions||[\"profile\"])).join(\" \"),g=t(t(t(t(t({},l.loginUrlParameters),void 0!==l.requestOfflineToken&&{access_type:l.requestOfflineToken?\"offline\":\"online\"}),(l.prompt||l.forceApprovalPrompt)&&{prompt:l.prompt||\"consent\"}),l.loginHint&&{login_hint:l.loginHint}),{},{response_type:\"code\",client_id:o.clientId,scope:u,redirect_uri:s._redirectUri(\"google\",o),state:s._stateParam(n,c,l.redirectUrl)});Object.assign(g,{response_type:\"code\",client_id:o.clientId,scope:u,redirect_uri:s._redirectUri(\"google\",o),state:s._stateParam(n,c,l.redirectUrl)});var p=\"https://accounts.google.com/o/oauth2/auth?\"+Object.keys(g).map(function(e){return encodeURIComponent(e)+\"=\"+encodeURIComponent(g[e])}).join(\"&\");s.launchLogin({loginService:\"google\",loginStyle:n,loginUrl:p,credentialRequestCompleteCallback:a,credentialToken:c,popupOptions:{height:600}})})}","map":"{\"version\":3,\"sources\":[\"client/meteorOverrides/login/google.ts\",\"<anon>\"],\"sourcesContent\":[\"import { Random } from '@rocket.chat/random';\\nimport { Accounts } from 'meteor/accounts-base';\\nimport { Google } from 'meteor/google-oauth';\\nimport { Meteor } from 'meteor/meteor';\\nimport { OAuth } from 'meteor/oauth';\\n\\nimport { overrideLoginMethod, type LoginCallback } from '../../lib/2fa/overrideLoginMethod';\\nimport { wrapRequestCredentialFn } from '../../lib/wrapRequestCredentialFn';\\nimport { createOAuthTotpLoginMethod } from './oauth';\\n\\ndeclare module 'meteor/meteor' {\\n\\t// eslint-disable-next-line @typescript-eslint/no-namespace\\n\\tnamespace Meteor {\\n\\t\\tfunction loginWithGoogle(\\n\\t\\t\\toptions?:\\n\\t\\t\\t\\t| Meteor.LoginWithExternalServiceOptions & {\\n\\t\\t\\t\\t\\t\\tloginUrlParameters?: {\\n\\t\\t\\t\\t\\t\\t\\tinclude_granted_scopes?: boolean;\\n\\t\\t\\t\\t\\t\\t\\thd?: string;\\n\\t\\t\\t\\t\\t\\t};\\n\\t\\t\\t\\t  },\\n\\t\\t\\tcallback?: LoginCallback,\\n\\t\\t): void;\\n\\t}\\n}\\n\\nconst { loginWithGoogle } = Meteor;\\n\\nconst innerLoginWithGoogleAndTOTP = createOAuthTotpLoginMethod(Google);\\n\\nconst loginWithGoogleAndTOTP = (\\n\\toptions:\\n\\t\\t| (Meteor.LoginWithExternalServiceOptions & {\\n\\t\\t\\t\\tloginUrlParameters?: {\\n\\t\\t\\t\\t\\tinclude_granted_scopes?: boolean;\\n\\t\\t\\t\\t\\thd?: string;\\n\\t\\t\\t\\t};\\n\\t\\t  })\\n\\t\\t| undefined,\\n\\tcode: string,\\n\\tcallback?: LoginCallback,\\n) => {\\n\\tif (Meteor.isCordova && Google.signIn) {\\n\\t\\t// After 20 April 2017, Google OAuth login will no longer work from\\n\\t\\t// a WebView, so Cordova apps must use Google Sign-In instead.\\n\\t\\t// https://github.com/meteor/meteor/issues/8253\\n\\t\\tGoogle.signIn(options, callback);\\n\\t\\treturn;\\n\\t} // Use Google's domain-specific login page if we want to restrict creation to\\n\\n\\t// a particular email domain. (Don't use it if restrictCreationByEmailDomain\\n\\t// is a function.) Note that all this does is change Google's UI ---\\n\\t// accounts-base/accounts_server.js still checks server-side that the server\\n\\t// has the proper email address after the OAuth conversation.\\n\\tif (typeof Accounts._options.restrictCreationByEmailDomain === 'string') {\\n\\t\\toptions = Object.assign({}, options || {});\\n\\t\\toptions.loginUrlParameters = Object.assign({}, options.loginUrlParameters || {});\\n\\t\\toptions.loginUrlParameters.hd = Accounts._options.restrictCreationByEmailDomain;\\n\\t}\\n\\n\\tinnerLoginWithGoogleAndTOTP(options, code, callback);\\n};\\n\\nMeteor.loginWithGoogle = (options, callback) => {\\n\\toverrideLoginMethod(loginWithGoogle, [options], callback, loginWithGoogleAndTOTP);\\n};\\n\\nGoogle.requestCredential = wrapRequestCredentialFn(\\n\\t'google',\\n\\t({ config, loginStyle, options: requestOptions, credentialRequestCompleteCallback }) => {\\n\\t\\tconst credentialToken = Random.secret();\\n\\t\\tconst options = requestOptions as Meteor.LoginWithExternalServiceOptions & {\\n\\t\\t\\tloginUrlParameters?: {\\n\\t\\t\\t\\tinclude_granted_scopes?: boolean;\\n\\t\\t\\t\\thd?: string;\\n\\t\\t\\t};\\n\\t\\t\\tprompt?: string;\\n\\t\\t};\\n\\n\\t\\tconst scope = ['email', ...(options.requestPermissions || ['profile'])].join(' ');\\n\\n\\t\\tconst loginUrlParameters: Record<string, any> = {\\n\\t\\t\\t...options.loginUrlParameters,\\n\\t\\t\\t...(options.requestOfflineToken !== undefined && {\\n\\t\\t\\t\\taccess_type: options.requestOfflineToken ? 'offline' : 'online',\\n\\t\\t\\t}),\\n\\t\\t\\t...((options.prompt || options.forceApprovalPrompt) && { prompt: options.prompt || 'consent' }),\\n\\t\\t\\t...(options.loginHint && { login_hint: options.loginHint }),\\n\\t\\t\\tresponse_type: 'code',\\n\\t\\t\\tclient_id: config.clientId,\\n\\t\\t\\tscope,\\n\\t\\t\\tredirect_uri: OAuth._redirectUri('google', config),\\n\\t\\t\\tstate: OAuth._stateParam(loginStyle, credentialToken, options.redirectUrl),\\n\\t\\t};\\n\\n\\t\\tObject.assign(loginUrlParameters, {\\n\\t\\t\\tresponse_type: 'code',\\n\\t\\t\\tclient_id: config.clientId,\\n\\t\\t\\tscope,\\n\\t\\t\\tredirect_uri: OAuth._redirectUri('google', config),\\n\\t\\t\\tstate: OAuth._stateParam(loginStyle, credentialToken, options.redirectUrl),\\n\\t\\t});\\n\\t\\tconst loginUrl = `https://accounts.google.com/o/oauth2/auth?${Object.keys(loginUrlParameters)\\n\\t\\t\\t.map((param) => `${encodeURIComponent(param)}=${encodeURIComponent(loginUrlParameters[param])}`)\\n\\t\\t\\t.join('&')}`;\\n\\n\\t\\tOAuth.launchLogin({\\n\\t\\t\\tloginService: 'google',\\n\\t\\t\\tloginStyle,\\n\\t\\t\\tloginUrl,\\n\\t\\t\\tcredentialRequestCompleteCallback,\\n\\t\\t\\tcredentialToken,\\n\\t\\t\\tpopupOptions: { height: 600 },\\n\\t\\t});\\n\\t},\\n);\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_objectSpread\",\"_toConsumableArray\",\"Random\",\"Accounts\",\"Google\",\"Meteor\",\"OAuth\",\"overrideLoginMethod\",\"wrapRequestCredentialFn\",\"createOAuthTotpLoginMethod\",\"loginWithGoogle\",\"_Meteor\",\"innerLoginWithGoogleAndTOTP\",\"loginWithGoogleAndTOTP\",\"options\",\"code\",\"callback\",\"isCordova\",\"signIn\",\"_options\",\"restrictCreationByEmailDomain\",\"Object\",\"assign\",\"loginUrlParameters\",\"hd\",\"requestCredential\",\"_ref\",\"config\",\"loginStyle\",\"requestOptions\",\"credentialRequestCompleteCallback\",\"credentialToken\",\"secret\",\"scope\",\"concat\",\"requestPermissions\",\"join\",\"undefined\",\"requestOfflineToken\",\"access_type\",\"prompt\",\"forceApprovalPrompt\",\"loginHint\",\"login_hint\",\"response_type\",\"client_id\",\"clientId\",\"redirect_uri\",\"_redirectUri\",\"state\",\"_stateParam\",\"redirectUrl\",\"loginUrl\",\"keys\",\"map\",\"param\",\"encodeURIComponent\",\"launchLogin\",\"loginService\",\"popupOptions\",\"height\"],\"mappings\":\"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\"}"}