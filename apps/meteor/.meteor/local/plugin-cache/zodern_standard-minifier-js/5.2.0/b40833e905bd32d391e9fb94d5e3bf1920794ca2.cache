{"code":"function module(e,n,t){t.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){u=e}},0),t.export({useRouteLock:function(){return d}}),t.link(\"@rocket.chat/fuselage-hooks\",{useDebouncedValue:function(e){o=e}},0),t.link(\"@rocket.chat/ui-contexts\",{useUserId:function(e){i=e},useUser:function(e){c=e},useSetting:function(e){r=e},useRole:function(e){f=e},useRouter:function(e){s=e}},1),t.link(\"react\",{useEffect:function(e){a=e},useState:function(e){l=e}},2);var u,o,i,c,r,f,s,a,l,d=function(){var e=l(!0),n=u(e,2),t=n[0],d=n[1],k=r(\"Show_Setup_Wizard\"),h=i(),m=o(c(),100),p=f(\"admin\"),g=s();return a(function(){if(k&&(!h||null!=m&&m.status)){var e=\"completed\"===k,n=t&&!m&&\"pending\"!==k,u=!!m&&!p;if(e||n||u){g.navigate(\"/home\");return}d(!1)}},[g,k,h,m,p,t]),t}}","map":"{\"version\":3,\"sources\":[\"client/views/setupWizard/hooks/useRouteLock.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useDebouncedValue } from '@rocket.chat/fuselage-hooks';\\nimport { useUserId, useUser, useSetting, useRole, useRouter } from '@rocket.chat/ui-contexts';\\nimport { useEffect, useState } from 'react';\\n\\nexport const useRouteLock = (): boolean => {\\n\\tconst [locked, setLocked] = useState(true);\\n\\tconst setupWizardState = useSetting('Show_Setup_Wizard');\\n\\tconst userId = useUserId();\\n\\tconst user = useDebouncedValue(useUser(), 100);\\n\\tconst hasAdminRole = useRole('admin');\\n\\tconst router = useRouter();\\n\\n\\tuseEffect(() => {\\n\\t\\tif (!setupWizardState) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tif (userId && !user?.status) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tconst isComplete = setupWizardState === 'completed';\\n\\t\\tconst noUserLoggedInAndIsNotPending = locked && !user && setupWizardState !== 'pending';\\n\\t\\tconst userIsLoggedInButIsNotAdmin = !!user && !hasAdminRole;\\n\\n\\t\\tconst mustRedirect = isComplete || noUserLoggedInAndIsNotPending || userIsLoggedInButIsNotAdmin;\\n\\n\\t\\tif (mustRedirect) {\\n\\t\\t\\trouter.navigate('/home');\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tsetLocked(false);\\n\\t}, [router, setupWizardState, userId, user, hasAdminRole, locked]);\\n\\n\\treturn locked;\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_slicedToArray\",\"export\",\"useRouteLock\",\"useDebouncedValue\",\"useUserId\",\"useUser\",\"useSetting\",\"useRole\",\"useRouter\",\"useEffect\",\"useState\",\"_useState\",\"_useState2\",\"locked\",\"setLocked\",\"setupWizardState\",\"userId\",\"user\",\"hasAdminRole\",\"router\",\"status\",\"isComplete\",\"noUserLoggedInAndIsNotPending\",\"userIsLoggedInButIsNotAdmin\",\"navigate\"],\"mappings\":\"uBAASA,EAAiBC,IAAE,CAAA,uCAAoC,CAAAC,QAAA,SAAAC,CAAA,EAAAC,EAAAD,CAAA,CAAA,EAAA,GAAhEH,EAAOK,MAAE,CAAA,CAAAC,aAAmB,WAAM,OAAAA,CAAA,CAAA,GAA8BN,EAAAC,IAAA,CAAA,8BAAA,CAAAM,kBAAA,SAAAJ,CAAA,EAAAI,EAAAJ,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,2BAAA,CAAAO,UAAA,SAAAL,CAAA,EAAAK,EAAAL,CAAA,EAAAM,QAAA,SAAAN,CAAA,EAAAM,EAAAN,CAAA,EAAAO,WAAA,SAAAP,CAAA,EAAAO,EAAAP,CAAA,EAAAQ,QAAA,SAAAR,CAAA,EAAAQ,EAAAR,CAAA,EAAAS,UAAA,SAAAT,CAAA,EAAAS,EAAAT,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAAY,UAAA,SAAAV,CAAA,EAAAU,EAAAV,CAAA,EAAAW,SAAA,SAAAX,CAAA,EAAAW,EAAAX,CAAA,CAAA,EAAA,GAIzD,IAJPC,EAAgEG,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAInDR,EAAe,WAC3B,IAAAS,EAA4BD,EAAS,CAAA,GAAKE,EAAAZ,EAAAW,EAAA,GAAnCE,EAAMD,CAAA,CAAA,EAAA,CAAEE,EAASF,CAAA,CAAA,EAAA,CAClBG,EAAmBT,EAAW,qBAC9BU,EAASZ,IACTa,EAAOd,EAAkBE,IAAW,KACpCa,EAAeX,EAAQ,SACvBY,EAASX,IAyBf,OAvBAC,EAAU,WACT,GAAKM,GAIDC,CAAAA,CAAAA,GAAWC,MAAAA,GAAAA,EAAMG,MAAM,GAI3B,IAAMC,EAAaN,AAAqB,cAArBA,EACbO,EAAgCT,GAAU,CAACI,GAAQF,AAAqB,YAArBA,EACnDQ,EAA8B,CAAC,CAACN,GAAQ,CAACC,EAI/C,GAFqBG,GAAcC,GAAiCC,EAElD,CACjBJ,EAAOK,QAAQ,CAAC,SAChB,MACD,CAEAV,EAAU,CAAA,GACX,EAAG,CAACK,EAAQJ,EAAkBC,EAAQC,EAAMC,EAAcL,EAAO,EAE1DA,CACR\"}"}