{"code":"function module(e,n,t){var o,i,r,u,a,s,l,c,f,h,d,g,m,k,x,v,p,S,R,w,E;t.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(e){o=e}},0),t.link(\"@rocket.chat/core-typings\",{isThreadMainMessage:function(e){i=e}},0),t.link(\"@rocket.chat/ui-contexts\",{useLayout:function(e){r=e},useUser:function(e){u=e},useUserPreference:function(e){a=e},useSetting:function(e){s=e},useEndpoint:function(e){l=e},useSearchParameter:function(e){c=e}},1),t.link(\"react\",{default:function(e){f=e},useMemo:function(e){h=e},memo:function(e){d=e}},2),t.link(\"../../../../../app/highlight-words/client/helper\",{getRegexHighlight:function(e){g=e},getRegexHighlightUrl:function(e){m=e}},3),t.link(\"../../../../components/message/list/MessageListContext\",{MessageListContext:function(e){k=e}},4),t.link(\"../../../../providers/AttachmentProvider\",{default:function(e){x=e}},5),t.link(\"../../contexts/ChatContext\",{useChat:function(e){v=e}},6),t.link(\"../../contexts/RoomContext\",{useRoom:function(e){p=e},useRoomSubscription:function(e){S=e}},7),t.link(\"../hooks/useAutoTranslate\",{useAutoTranslate:function(e){R=e}},8),t.link(\"../hooks/useKatex\",{useKatex:function(e){w=e}},9),t.link(\"../hooks/useLoadSurroundingMessages\",{useLoadSurroundingMessages:function(e){E=e}},10),t.exportDefault(d(function(e){var n=e.children,t=e.messageListRef,d=e.attachmentDimension;if(!p())throw Error(\"Room not found\");var P=l(\"POST\",\"/v1/chat.react\"),b=u(),L=null==b?void 0:b._id,M=null==b?void 0:b.username,T=S(),y=r().isMobile,U=!!s(\"UI_Use_Real_Name\"),C=s(\"HexColorPreview_Enabled\"),_=!!s(\"UI_DisplayRoles\"),A=!!(!a(\"hideRoles\")&&!y),j=_&&A,D=!!(!a(\"hideUsernames\")&&!y),H=a(\"highlights\"),I=R(T),O=I.showAutoTranslate,F=I.autoTranslateLanguage,K=w(),N=K.katexEnabled,q=K.katexDollarSyntaxEnabled,z=K.katexParenthesisSyntaxEnabled,B=!!T,G=c(\"msg\");E(G);var J=v(),Q=h(function(){return o(o({showColors:C,useUserHasReacted:M?function(e){return function(n){var t;return!!(null===(t=e.reactions)||void 0===t?void 0:t[n].usernames.includes(M))}}:function(){return function(){return!1}},useShowFollowing:L?function(e){var n=e.message;return!!(n.replies&&n.replies.indexOf(L)>-1&&!i(n))}:function(){return!1},autoTranslateLanguage:F,useShowTranslated:O,useShowStarred:B?function(e){var n=e.message;return!!(Array.isArray(n.starred)&&n.starred.find(function(e){return e._id===L}))}:function(){return!1},useMessageDateFormatter:function(){return function(e){return e.toLocaleString()}},showRoles:j,showRealName:U,showUsername:D,messageListRef:t,jumpToMessageParam:G},N&&{katex:{dollarSyntaxEnabled:q,parenthesisSyntaxEnabled:z}}),{},{highlights:null==H?void 0:H.map(function(e){return e.trim()}).map(function(e){return{highlight:e,regex:g(e),urlRegex:m(e)}}),useOpenEmojiPicker:L?function(e){return function(n){n.nativeEvent.stopImmediatePropagation(),null==J||J.emojiPicker.open(n.currentTarget,function(n){return P({messageId:e._id,reaction:n})})}}:function(){return function(){}},username:M})},[M,L,O,B,F,j,U,D,N,q,z,H,P,C,G,t,null==J?void 0:J.emojiPicker]);return f.createElement(x,{width:null==d?void 0:d.width,height:null==d?void 0:d.height},f.createElement(k.Provider,{value:Q},n))}))}","map":"{\"version\":3,\"sources\":[\"client/views/room/MessageList/providers/MessageListProvider.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { isThreadMainMessage } from '@rocket.chat/core-typings';\\nimport { useLayout, useUser, useUserPreference, useSetting, useEndpoint, useSearchParameter } from '@rocket.chat/ui-contexts';\\nimport type { ReactNode } from 'react';\\nimport React, { useMemo, memo } from 'react';\\n\\nimport { getRegexHighlight, getRegexHighlightUrl } from '../../../../../app/highlight-words/client/helper';\\nimport type { MessageListContextValue } from '../../../../components/message/list/MessageListContext';\\nimport { MessageListContext } from '../../../../components/message/list/MessageListContext';\\nimport AttachmentProvider from '../../../../providers/AttachmentProvider';\\nimport { useChat } from '../../contexts/ChatContext';\\nimport { useRoom, useRoomSubscription } from '../../contexts/RoomContext';\\nimport { useAutoTranslate } from '../hooks/useAutoTranslate';\\nimport { useKatex } from '../hooks/useKatex';\\nimport { useLoadSurroundingMessages } from '../hooks/useLoadSurroundingMessages';\\n\\ntype MessageListProviderProps = {\\n\\tchildren: ReactNode;\\n\\tmessageListRef?: React.RefObject<HTMLElement>;\\n\\tattachmentDimension?: {\\n\\t\\twidth?: number;\\n\\t\\theight?: number;\\n\\t};\\n};\\n\\nconst MessageListProvider = ({ children, messageListRef, attachmentDimension }: MessageListProviderProps) => {\\n\\tconst room = useRoom();\\n\\n\\tif (!room) {\\n\\t\\tthrow new Error('Room not found');\\n\\t}\\n\\n\\tconst reactToMessage = useEndpoint('POST', '/v1/chat.react');\\n\\tconst user = useUser();\\n\\tconst uid = user?._id;\\n\\tconst username = user?.username;\\n\\tconst subscription = useRoomSubscription();\\n\\n\\tconst { isMobile } = useLayout();\\n\\n\\tconst showRealName = Boolean(useSetting('UI_Use_Real_Name'));\\n\\tconst showColors = useSetting('HexColorPreview_Enabled') as boolean;\\n\\n\\tconst displayRolesGlobal = Boolean(useSetting('UI_DisplayRoles'));\\n\\tconst hideRolesPreference = Boolean(!useUserPreference<boolean>('hideRoles') && !isMobile);\\n\\tconst showRoles = displayRolesGlobal && hideRolesPreference;\\n\\tconst showUsername = Boolean(!useUserPreference<boolean>('hideUsernames') && !isMobile);\\n\\tconst highlights = useUserPreference<string[]>('highlights');\\n\\n\\tconst { showAutoTranslate, autoTranslateLanguage } = useAutoTranslate(subscription);\\n\\tconst { katexEnabled, katexDollarSyntaxEnabled, katexParenthesisSyntaxEnabled } = useKatex();\\n\\n\\tconst hasSubscription = Boolean(subscription);\\n\\tconst msgParameter = useSearchParameter('msg');\\n\\n\\tuseLoadSurroundingMessages(msgParameter);\\n\\n\\tconst chat = useChat();\\n\\n\\tconst context: MessageListContextValue = useMemo(\\n\\t\\t() => ({\\n\\t\\t\\tshowColors,\\n\\t\\t\\tuseUserHasReacted: username\\n\\t\\t\\t\\t? (message) =>\\n\\t\\t\\t\\t\\t\\t(reaction): boolean =>\\n\\t\\t\\t\\t\\t\\t\\tBoolean(message.reactions?.[reaction].usernames.includes(username))\\n\\t\\t\\t\\t: () => (): boolean => false,\\n\\t\\t\\tuseShowFollowing: uid\\n\\t\\t\\t\\t? ({ message }): boolean => Boolean(message.replies && message.replies.indexOf(uid) > -1 && !isThreadMainMessage(message))\\n\\t\\t\\t\\t: (): boolean => false,\\n\\t\\t\\tautoTranslateLanguage,\\n\\t\\t\\tuseShowTranslated: showAutoTranslate,\\n\\t\\t\\tuseShowStarred: hasSubscription\\n\\t\\t\\t\\t? ({ message }): boolean => Boolean(Array.isArray(message.starred) && message.starred.find((star) => star._id === uid))\\n\\t\\t\\t\\t: (): boolean => false,\\n\\t\\t\\tuseMessageDateFormatter:\\n\\t\\t\\t\\t() =>\\n\\t\\t\\t\\t(date: Date): string =>\\n\\t\\t\\t\\t\\tdate.toLocaleString(),\\n\\t\\t\\tshowRoles,\\n\\t\\t\\tshowRealName,\\n\\t\\t\\tshowUsername,\\n\\t\\t\\tmessageListRef,\\n\\t\\t\\tjumpToMessageParam: msgParameter,\\n\\t\\t\\t...(katexEnabled && {\\n\\t\\t\\t\\tkatex: {\\n\\t\\t\\t\\t\\tdollarSyntaxEnabled: katexDollarSyntaxEnabled,\\n\\t\\t\\t\\t\\tparenthesisSyntaxEnabled: katexParenthesisSyntaxEnabled,\\n\\t\\t\\t\\t},\\n\\t\\t\\t}),\\n\\t\\t\\thighlights: highlights\\n\\t\\t\\t\\t?.map((str) => str.trim())\\n\\t\\t\\t\\t.map((highlight) => ({\\n\\t\\t\\t\\t\\thighlight,\\n\\t\\t\\t\\t\\tregex: getRegexHighlight(highlight),\\n\\t\\t\\t\\t\\turlRegex: getRegexHighlightUrl(highlight),\\n\\t\\t\\t\\t})),\\n\\n\\t\\t\\tuseOpenEmojiPicker: uid\\n\\t\\t\\t\\t? (message) =>\\n\\t\\t\\t\\t\\t\\t(e): void => {\\n\\t\\t\\t\\t\\t\\t\\te.nativeEvent.stopImmediatePropagation();\\n\\t\\t\\t\\t\\t\\t\\tchat?.emojiPicker.open(e.currentTarget, (emoji: string) => reactToMessage({ messageId: message._id, reaction: emoji }));\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t: () => (): void => undefined,\\n\\t\\t\\tusername,\\n\\t\\t}),\\n\\t\\t[\\n\\t\\t\\tusername,\\n\\t\\t\\tuid,\\n\\t\\t\\tshowAutoTranslate,\\n\\t\\t\\thasSubscription,\\n\\t\\t\\tautoTranslateLanguage,\\n\\t\\t\\tshowRoles,\\n\\t\\t\\tshowRealName,\\n\\t\\t\\tshowUsername,\\n\\t\\t\\tkatexEnabled,\\n\\t\\t\\tkatexDollarSyntaxEnabled,\\n\\t\\t\\tkatexParenthesisSyntaxEnabled,\\n\\t\\t\\thighlights,\\n\\t\\t\\treactToMessage,\\n\\t\\t\\tshowColors,\\n\\t\\t\\tmsgParameter,\\n\\t\\t\\tmessageListRef,\\n\\t\\t\\tchat?.emojiPicker,\\n\\t\\t],\\n\\t);\\n\\n\\treturn (\\n\\t\\t<AttachmentProvider width={attachmentDimension?.width} height={attachmentDimension?.height}>\\n\\t\\t\\t<MessageListContext.Provider value={context}>{children}</MessageListContext.Provider>\\n\\t\\t</AttachmentProvider>\\n\\t);\\n};\\n\\nexport default memo(MessageListProvider);\\n\",null],\"names\":[\"_objectSpread\",\"isThreadMainMessage\",\"useLayout\",\"useUser\",\"useUserPreference\",\"useSetting\",\"useEndpoint\",\"useSearchParameter\",\"React\",\"useMemo\",\"memo\",\"getRegexHighlight\",\"getRegexHighlightUrl\",\"MessageListContext\",\"AttachmentProvider\",\"useChat\",\"useRoom\",\"useRoomSubscription\",\"useAutoTranslate\",\"useKatex\",\"useLoadSurroundingMessages\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"children\",\"messageListRef\",\"attachmentDimension\",\"Error\",\"reactToMessage\",\"user\",\"uid\",\"_id\",\"username\",\"subscription\",\"isMobile\",\"_useLayout\",\"showRealName\",\"Boolean\",\"showColors\",\"displayRolesGlobal\",\"hideRolesPreference\",\"showRoles\",\"showUsername\",\"highlights\",\"_useAutoTranslate\",\"showAutoTranslate\",\"autoTranslateLanguage\",\"_useKatex\",\"katexEnabled\",\"katexDollarSyntaxEnabled\",\"katexParenthesisSyntaxEnabled\",\"hasSubscription\",\"msgParameter\",\"chat\",\"context\",\"useUserHasReacted\",\"message\",\"reaction\",\"_message$reactions\",\"reactions\",\"usernames\",\"includes\",\"useShowFollowing\",\"_ref2\",\"replies\",\"indexOf\",\"useShowTranslated\",\"useShowStarred\",\"_ref3\",\"Array\",\"isArray\",\"starred\",\"find\",\"star\",\"useMessageDateFormatter\",\"date\",\"toLocaleString\",\"jumpToMessageParam\",\"katex\",\"dollarSyntaxEnabled\",\"parenthesisSyntaxEnabled\",\"map\",\"str\",\"trim\",\"highlight\",\"regex\",\"urlRegex\",\"useOpenEmojiPicker\",\"e\",\"nativeEvent\",\"stopImmediatePropagation\",\"emojiPicker\",\"open\",\"currentTarget\",\"emoji\",\"messageId\",\"createElement\",\"width\",\"height\",\"Provider\",\"value\"],\"mappings\":\"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\"}"}