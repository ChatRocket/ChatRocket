{"code":"function module(e,n,t){t.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){i=e}},0),t.link(\"@rocket.chat/fuselage\",{AudioPlayer:function(e){r=e},Box:function(e){l=e},Icon:function(e){u=e}},0),t.link(\"react\",{default:function(e){o=e},useEffect:function(e){a=e},useState:function(e){f=e},memo:function(e){c=e}},1),t.link(\"react-i18next\",{useTranslation:function(e){s=e}},2),t.link(\"../../../../lib/utils/userAgentMIMETypeFallback\",{userAgentMIMETypeFallback:function(e){d=e}},3),t.link(\"./FilePreview\",{FilePreviewType:function(e){m=e}},4),t.link(\"./ImagePreview\",{default:function(e){p=e}},5),t.link(\"./PreviewSkeleton\",{default:function(e){v=e}},6);var i,r,l,u,o,a,f,c,s,d,m,p,v,E=function(e,n){var t=new FileReader;return t.onload=function(e){var t;return n((null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.result)||null)},t.readAsDataURL(e)},k=function(e){var n=f(!1),t=i(n,2),r=t[0],l=t[1],u=f(null),o=i(u,2),c=o[0],s=o[1];return a(function(){l(!1),E(e,function(e){s(e),l(!0)})},[e]),[r,c]};t.exportDefault(c(function(e){var n=e.file,t=e.fileType,a=k(n),f=i(a,2),c=f[0],E=f[1],w=s().t;if(!c)return o.createElement(v,null);if(\"string\"!=typeof E)return o.createElement(l,{display:\"flex\",alignItems:\"center\",w:\"full\"},o.createElement(u,{name:\"image\",size:\"x24\",mie:4}),w(\"FileUpload_Cannot_preview_file\"));if(t===m.IMAGE)return o.createElement(p,{url:E,file:n});if(t===m.VIDEO)return o.createElement(l,{is:\"video\",w:\"full\",controls:!0},o.createElement(\"source\",{src:E,type:d(n.type)}),w(\"Browser_does_not_support_video_element\"));if(t===m.AUDIO)return o.createElement(r,{src:E});throw Error(\"Wrong props provided for MediaPreview\")}))}","map":"{\"version\":3,\"sources\":[\"client/views/room/modals/FileUploadModal/MediaPreview.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { AudioPlayer, Box, Icon } from '@rocket.chat/fuselage';\\nimport type { ReactElement } from 'react';\\nimport React, { useEffect, useState, memo } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { userAgentMIMETypeFallback } from '../../../../lib/utils/userAgentMIMETypeFallback';\\nimport { FilePreviewType } from './FilePreview';\\nimport ImagePreview from './ImagePreview';\\nimport PreviewSkeleton from './PreviewSkeleton';\\n\\ntype ReaderOnloadCallback = (url: FileReader['result']) => void;\\n\\nconst readFileAsDataURL = (file: File, callback: ReaderOnloadCallback): void => {\\n\\tconst reader = new FileReader();\\n\\treader.onload = (e): void => callback(e?.target?.result || null);\\n\\n\\treturn reader.readAsDataURL(file);\\n};\\n\\nconst useFileAsDataURL = (file: File): [loaded: boolean, url: null | FileReader['result']] => {\\n\\tconst [loaded, setLoaded] = useState(false);\\n\\tconst [url, setUrl] = useState<FileReader['result']>(null);\\n\\n\\tuseEffect(() => {\\n\\t\\tsetLoaded(false);\\n\\t\\treadFileAsDataURL(file, (url) => {\\n\\t\\t\\tsetUrl(url);\\n\\t\\t\\tsetLoaded(true);\\n\\t\\t});\\n\\t}, [file]);\\n\\treturn [loaded, url];\\n};\\n\\ntype MediaPreviewProps = {\\n\\tfile: File;\\n\\tfileType: FilePreviewType;\\n};\\n\\nconst MediaPreview = ({ file, fileType }: MediaPreviewProps): ReactElement => {\\n\\tconst [loaded, url] = useFileAsDataURL(file);\\n\\tconst { t } = useTranslation();\\n\\n\\tif (!loaded) {\\n\\t\\treturn <PreviewSkeleton />;\\n\\t}\\n\\n\\tif (typeof url !== 'string') {\\n\\t\\treturn (\\n\\t\\t\\t<Box display='flex' alignItems='center' w='full'>\\n\\t\\t\\t\\t<Icon name='image' size='x24' mie={4} />\\n\\t\\t\\t\\t{t('FileUpload_Cannot_preview_file')}\\n\\t\\t\\t</Box>\\n\\t\\t);\\n\\t}\\n\\n\\tif (fileType === FilePreviewType.IMAGE) {\\n\\t\\treturn <ImagePreview url={url} file={file} />;\\n\\t}\\n\\n\\tif (fileType === FilePreviewType.VIDEO) {\\n\\t\\treturn (\\n\\t\\t\\t<Box is='video' w='full' controls>\\n\\t\\t\\t\\t<source src={url} type={userAgentMIMETypeFallback(file.type)} />\\n\\t\\t\\t\\t{t('Browser_does_not_support_video_element')}\\n\\t\\t\\t</Box>\\n\\t\\t);\\n\\t}\\n\\n\\tif (fileType === FilePreviewType.AUDIO) {\\n\\t\\treturn <AudioPlayer src={url} />;\\n\\t}\\n\\n\\tthrow new Error('Wrong props provided for MediaPreview');\\n};\\n\\nexport default memo(MediaPreview);\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_slicedToArray\",\"AudioPlayer\",\"Box\",\"Icon\",\"React\",\"useEffect\",\"useState\",\"memo\",\"useTranslation\",\"userAgentMIMETypeFallback\",\"FilePreviewType\",\"ImagePreview\",\"PreviewSkeleton\",\"readFileAsDataURL\",\"file\",\"callback\",\"reader\",\"FileReader\",\"onload\",\"e\",\"_e$target\",\"target\",\"result\",\"readAsDataURL\",\"useFileAsDataURL\",\"_useState\",\"_useState2\",\"loaded\",\"setLoaded\",\"_useState3\",\"_useState4\",\"url\",\"setUrl\",\"exportDefault\",\"_ref\",\"fileType\",\"_useFileAsDataURL\",\"_useFileAsDataURL2\",\"t\",\"_useTranslation\",\"createElement\",\"display\",\"alignItems\",\"w\",\"name\",\"size\",\"mie\",\"IMAGE\",\"VIDEO\",\"is\",\"controls\",\"src\",\"type\",\"AUDIO\",\"Error\"],\"mappings\":\"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\"}"}