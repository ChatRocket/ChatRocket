{"code":"function module(e,t,n){n.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){i=e}},0),n.export({useComposerBoxPopup:function(){return f}}),n.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback:function(e){r=e}},0),n.link(\"react\",{useEffect:function(e){o=e},useCallback:function(e){u=e},useState:function(e){l=e},useRef:function(e){s=e}},1),n.link(\"../../contexts/ChatContext\",{useChat:function(e){c=e}},2),n.link(\"./useComposerBoxPopupQueries\",{useComposerBoxPopupQueries:function(e){a=e}},3);var i,r,o,u,l,s,c,a,d={TAB:9,ENTER:13,ESC:27,ARROW_UP:38,ARROW_DOWN:40},f=function(e){var t=e.configurations,n=l(void 0),f=i(n,2),v=f[0],p=f[1],g=l(void 0),m=i(g,2),h=m[0],R=m[1],x=l(\"\"),E=i(x,2),y=E[0],k=E[1],A=s(),w=a(y,v),P=w.queries,C=w.suspended,b=c(),S=h?\"popup-item-\"+h._id:void 0;o(function(){if(v){if(null!=v&&v.preview&&C){R(void 0);return}R(function(e){var t,n=P.filter(function(e){return e.isSuccess}).flatMap(function(e){return e.data}).sort(function(e,t){return(\"sort\"in e&&e.sort||0)-(\"sort\"in t&&t.sort||0)});return null!==(t=n.find(function(t){return t._id===(null==e?void 0:e._id)}))&&void 0!==t?t:n[0]})}},[P,v,C]);var D=r(function(e){var t;if(!v)throw Error(\"No popup is open\");if(null!==(t=A.current)&&void 0!==t&&t.select)A.current.select(e);else{var n,i,r,o,u,l,s,c,a=null==b?void 0:null===(n=b.composer)||void 0===n?void 0:n.substring(0,null==b?void 0:null===(i=b.composer)||void 0===i?void 0:i.selection.start),d=null!==(r=v.matchSelectorRegex)&&void 0!==r?r:v.triggerAnywhere?RegExp(\"(?:^| |\\n)(\"+v.trigger+\")([^\\\\s]*$)\"):RegExp(\"(?:^)(\"+v.trigger+\")([^\\\\s]*$)\"),f=null==a?void 0:a.match(d);if(!f||!a)return;null==b||null===(o=b.composer)||void 0===o||o.replaceText((null!==(u=null!==(l=v.prefix)&&void 0!==l?l:v.trigger)&&void 0!==u?u:\"\")+v.getValue(e)+(null!==(s=v.suffix)&&void 0!==s?s:\"\"),{start:a.lastIndexOf(f[1]+f[2]),end:null==b?void 0:null===(c=b.composer)||void 0===c?void 0:c.selection.start})}p(void 0),R(void 0)}),K=r(function(){var e=null==b?void 0:null===(i=b.composer)||void 0===i?void 0:i.substring(0,null==b?void 0:null===(r=b.composer)||void 0===r?void 0:r.selection.start);if(!e){p(void 0),R(void 0);return}var n=t.find(function(t){var n=t.trigger,i=t.matchSelectorRegex,r=t.triggerAnywhere,o=t.triggerLength,u=null!=i?i:r?RegExp(\"(?:^| |\\n)(\"+n+\")[^\\\\s]*$\"):RegExp(\"(?:^)(\"+n+\")[^\\\\s]*$\"),l=u.test(e);if(!o||!l)return l;var s=e.match(u);return s&&o<s[0].length});if(p(n),n||(R(void 0),k(\"\")),n){var i,r,o,u,l,s,c=null!==(o=n.matchSelectorRegex)&&void 0!==o?o:n.triggerAnywhere?RegExp(\"(?:^| |\\n)(\"+n.trigger+\")([^\\\\s]*$)\"):RegExp(\"(?:^)(\"+n.trigger+\")([^\\\\s]*$)\"),a=e.match(c);k(null!==(u=null===(l=A.current)||void 0===l?void 0:null===(s=l.getFilter)||void 0===s?void 0:s.call(l))&&void 0!==u?u:a?a[2]:\"\")}return n}),O=r(function(){v||K()}),I=r(function(e){K()&&v&&!0===v.closeOnEsc&&e.which===d.ESC&&(p(void 0),R(void 0),e.preventDefault(),e.stopImmediatePropagation())}),_=r(function(e){if(v){if(e.which===d.ENTER||e.which===d.TAB){if(!h)return;return D(h),e.preventDefault(),e.stopImmediatePropagation(),!0}return e.which!==d.ARROW_UP||e.shiftKey||e.ctrlKey||e.altKey||e.metaKey?e.which!==d.ARROW_DOWN||e.shiftKey||e.ctrlKey||e.altKey||e.metaKey?void 0:(R(function(e){var t=P.filter(function(e){return e.isSuccess}).flatMap(function(e){return e.data}).sort(function(e,t){return(\"sort\"in e&&e.sort||0)-(\"sort\"in t&&t.sort||0)});if(t){var n=t.findIndex(function(t){return t===e});return n<t.length-1?t[n+1]:t[0]}}),e.preventDefault(),e.stopImmediatePropagation(),!0):(R(function(e){var t=P.filter(function(e){return e.isSuccess}).flatMap(function(e){return e.data}).sort(function(e,t){return(\"sort\"in e&&e.sort||0)-(\"sort\"in t&&t.sort||0)});if(t){var n=t.findIndex(function(t){return t===e});return n>0?t[n-1]:t[t.length-1]}}),e.preventDefault(),e.stopImmediatePropagation(),!0)}}),T=r(function(){v&&(p(void 0),R(void 0),k(\"\"))}),W=u(function(e){e&&(e.addEventListener(\"keyup\",I),e.addEventListener(\"keydown\",_),e.addEventListener(\"focus\",O))},[I,_,O]);return v?{focused:h,items:P,ariaActiveDescendant:S,popup:v,select:D,filter:y,suspended:C,commandsRef:A,callbackRef:W,clearPopup:T}:{callbackRef:W,focused:void 0,items:void 0,ariaActiveDescendant:void 0,popup:void 0,select:void 0,suspended:!0,commandsRef:A,filter:void 0,clearPopup:T}}}","map":"{\"version\":3,\"sources\":[\"client/views/room/composer/hooks/useComposerBoxPopup.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport type { UseQueryResult } from '@tanstack/react-query';\\nimport type { MutableRefObject } from 'react';\\nimport { useEffect, useCallback, useState, useRef } from 'react';\\n\\nimport { useChat } from '../../contexts/ChatContext';\\nimport type { ComposerPopupOption } from '../../contexts/ComposerPopupContext';\\nimport { useComposerBoxPopupQueries } from './useComposerBoxPopupQueries';\\n\\ntype ComposerBoxPopupImperativeCommands<T> = MutableRefObject<\\n\\t| {\\n\\t\\t\\tgetFilter?: () => unknown;\\n\\t\\t\\tselect?: (s: T) => void;\\n\\t  }\\n\\t| undefined\\n>;\\n\\ntype ComposerBoxPopupOptions<T extends { _id: string; sort?: number | undefined }> = ComposerPopupOption<T>;\\n\\ntype ComposerBoxPopupResult<T extends { _id: string; sort?: number }> =\\n\\t| {\\n\\t\\t\\tpopup: ComposerPopupOption<T>;\\n\\t\\t\\titems: UseQueryResult<T[]>[];\\n\\t\\t\\tfocused: T | undefined;\\n\\t\\t\\tariaActiveDescendant: string | undefined;\\n\\t\\t\\tselect: (item: T) => void;\\n\\t\\t\\tcallbackRef: (node: HTMLElement) => void;\\n\\t\\t\\tcommandsRef: ComposerBoxPopupImperativeCommands<T>;\\n\\t\\t\\tsuspended: boolean;\\n\\t\\t\\tfilter: unknown;\\n\\t\\t\\tclearPopup: () => void;\\n\\t  }\\n\\t| {\\n\\t\\t\\tpopup: undefined;\\n\\t\\t\\titems: undefined;\\n\\t\\t\\tfocused: undefined;\\n\\t\\t\\tariaActiveDescendant: undefined;\\n\\t\\t\\tcallbackRef: (node: HTMLElement) => void;\\n\\t\\t\\tselect: undefined;\\n\\t\\t\\tcommandsRef: ComposerBoxPopupImperativeCommands<T>;\\n\\t\\t\\tsuspended: boolean;\\n\\t\\t\\tfilter: unknown;\\n\\t\\t\\tclearPopup: () => void;\\n\\t  };\\n\\nconst keys = {\\n\\tTAB: 9,\\n\\tENTER: 13,\\n\\tESC: 27,\\n\\tARROW_LEFT: 37,\\n\\tARROW_UP: 38,\\n\\tARROW_RIGHT: 39,\\n\\tARROW_DOWN: 40,\\n};\\n\\nexport const useComposerBoxPopup = <T extends { _id: string; sort?: number }>({\\n\\tconfigurations,\\n}: {\\n\\tconfigurations: ComposerBoxPopupOptions<T>[];\\n}): ComposerBoxPopupResult<T> => {\\n\\tconst [popup, setPopup] = useState<ComposerBoxPopupOptions<T> | undefined>(undefined);\\n\\tconst [focused, setFocused] = useState<T | undefined>(undefined);\\n\\tconst [filter, setFilter] = useState<unknown>('');\\n\\n\\tconst commandsRef: ComposerBoxPopupImperativeCommands<T> = useRef();\\n\\n\\tconst { queries: items, suspended } = useComposerBoxPopupQueries(filter, popup) as {\\n\\t\\tqueries: UseQueryResult<T[]>[];\\n\\t\\tsuspended: boolean;\\n\\t};\\n\\n\\tconst chat = useChat();\\n\\n\\tconst ariaActiveDescendant = focused ? `popup-item-${focused._id}` : undefined;\\n\\n\\tuseEffect(() => {\\n\\t\\tif (!popup) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tif (popup?.preview && suspended) {\\n\\t\\t\\tsetFocused(undefined);\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tsetFocused((focused) => {\\n\\t\\t\\tconst sortedItems = items\\n\\t\\t\\t\\t.filter((item) => item.isSuccess)\\n\\t\\t\\t\\t.flatMap((item) => item.data as T[])\\n\\t\\t\\t\\t.sort((a, b) => (('sort' in a && a.sort) || 0) - (('sort' in b && b.sort) || 0));\\n\\t\\t\\treturn sortedItems.find((item) => item._id === focused?._id) ?? sortedItems[0];\\n\\t\\t});\\n\\t}, [items, popup, suspended]);\\n\\n\\tconst select = useMutableCallback((item: T) => {\\n\\t\\tif (!popup) {\\n\\t\\t\\tthrow new Error('No popup is open');\\n\\t\\t}\\n\\n\\t\\tif (commandsRef.current?.select) {\\n\\t\\t\\tcommandsRef.current.select(item);\\n\\t\\t} else {\\n\\t\\t\\tconst value = chat?.composer?.substring(0, chat?.composer?.selection.start);\\n\\t\\t\\tconst selector =\\n\\t\\t\\t\\tpopup.matchSelectorRegex ??\\n\\t\\t\\t\\t(popup.triggerAnywhere ? new RegExp(`(?:^| |\\\\n)(${popup.trigger})([^\\\\\\\\s]*$)`) : new RegExp(`(?:^)(${popup.trigger})([^\\\\\\\\s]*$)`));\\n\\n\\t\\t\\tconst result = value?.match(selector);\\n\\t\\t\\tif (!result || !value) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tchat?.composer?.replaceText((popup.prefix ?? popup.trigger ?? '') + popup.getValue(item) + (popup.suffix ?? ''), {\\n\\t\\t\\t\\tstart: value.lastIndexOf(result[1] + result[2]),\\n\\t\\t\\t\\tend: chat?.composer?.selection.start,\\n\\t\\t\\t});\\n\\t\\t}\\n\\t\\tsetPopup(undefined);\\n\\t\\tsetFocused(undefined);\\n\\t});\\n\\n\\tconst setConfigByInput = useMutableCallback((): ComposerBoxPopupOptions<T> | undefined => {\\n\\t\\tconst value = chat?.composer?.substring(0, chat?.composer?.selection.start);\\n\\n\\t\\tif (!value) {\\n\\t\\t\\tsetPopup(undefined);\\n\\t\\t\\tsetFocused(undefined);\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tconst configuration = configurations.find(({ trigger, matchSelectorRegex, triggerAnywhere, triggerLength }) => {\\n\\t\\t\\tconst selector =\\n\\t\\t\\t\\tmatchSelectorRegex ?? (triggerAnywhere ? new RegExp(`(?:^| |\\\\n)(${trigger})[^\\\\\\\\s]*$`) : new RegExp(`(?:^)(${trigger})[^\\\\\\\\s]*$`));\\n\\t\\t\\tconst result = selector.test(value);\\n\\t\\t\\tif (!triggerLength || !result) {\\n\\t\\t\\t\\treturn result;\\n\\t\\t\\t}\\n\\t\\t\\tconst filter = value.match(selector);\\n\\t\\t\\treturn filter && triggerLength < filter[0].length;\\n\\t\\t});\\n\\t\\tsetPopup(configuration);\\n\\t\\tif (!configuration) {\\n\\t\\t\\tsetFocused(undefined);\\n\\t\\t\\tsetFilter('');\\n\\t\\t}\\n\\n\\t\\tif (configuration) {\\n\\t\\t\\tconst selector =\\n\\t\\t\\t\\tconfiguration.matchSelectorRegex ??\\n\\t\\t\\t\\t(configuration.triggerAnywhere\\n\\t\\t\\t\\t\\t? new RegExp(`(?:^| |\\\\n)(${configuration.trigger})([^\\\\\\\\s]*$)`)\\n\\t\\t\\t\\t\\t: new RegExp(`(?:^)(${configuration.trigger})([^\\\\\\\\s]*$)`));\\n\\t\\t\\tconst result = value.match(selector);\\n\\t\\t\\tsetFilter(commandsRef.current?.getFilter?.() ?? (result ? result[2] : ''));\\n\\t\\t}\\n\\t\\treturn configuration;\\n\\t});\\n\\n\\tconst onFocus = useMutableCallback(() => {\\n\\t\\tif (popup) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tsetConfigByInput();\\n\\t});\\n\\n\\tconst keyup = useMutableCallback((event: KeyboardEvent) => {\\n\\t\\tif (!setConfigByInput()) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tif (!popup) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tif (popup.closeOnEsc === true && event.which === keys.ESC) {\\n\\t\\t\\tsetPopup(undefined);\\n\\t\\t\\tsetFocused(undefined);\\n\\t\\t\\tevent.preventDefault();\\n\\t\\t\\tevent.stopImmediatePropagation();\\n\\t\\t}\\n\\t});\\n\\n\\tconst keydown = useMutableCallback((event: KeyboardEvent) => {\\n\\t\\tif (!popup) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tif (event.which === keys.ENTER || event.which === keys.TAB) {\\n\\t\\t\\tif (!focused) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tselect(focused);\\n\\n\\t\\t\\tevent.preventDefault();\\n\\t\\t\\tevent.stopImmediatePropagation();\\n\\t\\t\\treturn true;\\n\\t\\t}\\n\\t\\tif (event.which === keys.ARROW_UP && !(event.shiftKey || event.ctrlKey || event.altKey || event.metaKey)) {\\n\\t\\t\\tsetFocused((focused) => {\\n\\t\\t\\t\\tconst list = items\\n\\t\\t\\t\\t\\t.filter((item) => item.isSuccess)\\n\\t\\t\\t\\t\\t.flatMap((item) => item.data as T[])\\n\\t\\t\\t\\t\\t.sort((a, b) => (('sort' in a && a.sort) || 0) - (('sort' in b && b.sort) || 0));\\n\\n\\t\\t\\t\\tif (!list) {\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tconst focusedIndex = list.findIndex((item) => item === focused);\\n\\n\\t\\t\\t\\treturn (focusedIndex > 0 ? list[focusedIndex - 1] : list[list.length - 1]) as T;\\n\\t\\t\\t});\\n\\t\\t\\tevent.preventDefault();\\n\\t\\t\\tevent.stopImmediatePropagation();\\n\\t\\t\\treturn true;\\n\\t\\t}\\n\\t\\tif (event.which === keys.ARROW_DOWN && !(event.shiftKey || event.ctrlKey || event.altKey || event.metaKey)) {\\n\\t\\t\\tsetFocused((focused) => {\\n\\t\\t\\t\\tconst list = items\\n\\t\\t\\t\\t\\t.filter((item) => item.isSuccess)\\n\\t\\t\\t\\t\\t.flatMap((item) => item.data as T[])\\n\\t\\t\\t\\t\\t.sort((a, b) => (('sort' in a && a.sort) || 0) - (('sort' in b && b.sort) || 0));\\n\\n\\t\\t\\t\\tif (!list) {\\n\\t\\t\\t\\t\\treturn undefined;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tconst focusedIndex = list.findIndex((item) => item === focused);\\n\\n\\t\\t\\t\\treturn (focusedIndex < list.length - 1 ? list[focusedIndex + 1] : list[0]) as T;\\n\\t\\t\\t});\\n\\t\\t\\tevent.preventDefault();\\n\\t\\t\\tevent.stopImmediatePropagation();\\n\\t\\t\\treturn true;\\n\\t\\t}\\n\\t});\\n\\n\\tconst clearPopup = useMutableCallback(() => {\\n\\t\\tif (!popup) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tsetPopup(undefined);\\n\\t\\tsetFocused(undefined);\\n\\t\\tsetFilter('');\\n\\t});\\n\\n\\tconst callbackRef = useCallback(\\n\\t\\t(node: HTMLElement | null) => {\\n\\t\\t\\tif (!node) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tnode.addEventListener('keyup', keyup);\\n\\t\\t\\tnode.addEventListener('keydown', keydown);\\n\\t\\t\\tnode.addEventListener('focus', onFocus);\\n\\t\\t},\\n\\t\\t[keyup, keydown, onFocus],\\n\\t);\\n\\n\\tif (!popup) {\\n\\t\\treturn {\\n\\t\\t\\tcallbackRef,\\n\\t\\t\\tfocused: undefined,\\n\\t\\t\\titems: undefined,\\n\\t\\t\\tariaActiveDescendant: undefined,\\n\\t\\t\\tpopup: undefined,\\n\\t\\t\\tselect: undefined,\\n\\t\\t\\tsuspended: true,\\n\\t\\t\\tcommandsRef,\\n\\t\\t\\tfilter: undefined,\\n\\t\\t\\tclearPopup,\\n\\t\\t};\\n\\t}\\n\\n\\treturn {\\n\\t\\tfocused,\\n\\t\\titems,\\n\\t\\tariaActiveDescendant,\\n\\t\\tpopup,\\n\\t\\tselect,\\n\\t\\tfilter,\\n\\t\\tsuspended,\\n\\t\\tcommandsRef,\\n\\t\\tcallbackRef,\\n\\t\\tclearPopup,\\n\\t};\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_slicedToArray\",\"export\",\"useComposerBoxPopup\",\"useMutableCallback\",\"useEffect\",\"useCallback\",\"useState\",\"useRef\",\"useChat\",\"useComposerBoxPopupQueries\",\"keys\",\"TAB\",\"ENTER\",\"ESC\",\"ARROW_UP\",\"ARROW_DOWN\",\"_ref\",\"configurations\",\"_useState\",\"undefined\",\"_useState2\",\"popup\",\"setPopup\",\"_useState3\",\"_useState4\",\"focused\",\"setFocused\",\"_useState5\",\"_useState6\",\"filter\",\"setFilter\",\"commandsRef\",\"_useComposerBoxPopupQ\",\"items\",\"queries\",\"suspended\",\"chat\",\"ariaActiveDescendant\",\"_id\",\"preview\",\"_sortedItems$find\",\"sortedItems\",\"item\",\"isSuccess\",\"flatMap\",\"data\",\"sort\",\"a\",\"b\",\"find\",\"select\",\"_commandsRef$current\",\"Error\",\"current\",\"_chat$composer\",\"_chat$composer2\",\"_popup$matchSelectorR\",\"_chat$composer3\",\"_ref2\",\"_popup$prefix\",\"_popup$suffix\",\"_chat$composer4\",\"value\",\"composer\",\"substring\",\"selection\",\"start\",\"selector\",\"matchSelectorRegex\",\"triggerAnywhere\",\"RegExp\",\"trigger\",\"result\",\"match\",\"replaceText\",\"prefix\",\"getValue\",\"suffix\",\"lastIndexOf\",\"end\",\"setConfigByInput\",\"_chat$composer5\",\"_chat$composer6\",\"configuration\",\"_ref3\",\"triggerLength\",\"test\",\"length\",\"_configuration$matchS\",\"_commandsRef$current$\",\"_commandsRef$current2\",\"_commandsRef$current3\",\"getFilter\",\"call\",\"onFocus\",\"keyup\",\"event\",\"closeOnEsc\",\"which\",\"preventDefault\",\"stopImmediatePropagation\",\"keydown\",\"shiftKey\",\"ctrlKey\",\"altKey\",\"metaKey\",\"list\",\"focusedIndex\",\"findIndex\",\"clearPopup\",\"callbackRef\",\"node\",\"addEventListener\"],\"mappings\":\"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\"}"}