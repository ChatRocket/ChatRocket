{"code":"function module(e,i,t){let a,s,n,o,c,l,r,u;t.export({useVoipItemsSection:()=>g}),t.link(\"@rocket.chat/fuselage\",{Box(e){a=e}},0),t.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch(e){s=e}},1),t.link(\"@rocket.chat/ui-voip\",{useVoipAPI(e){n=e},useVoipState(e){o=e}},2),t.link(\"@tanstack/react-query\",{useMutation(e){c=e}},3),t.link(\"react\",{default(e){l=e},useMemo(e){r=e}},4),t.link(\"react-i18next\",{useTranslation(e){u=e}},5);let g=()=>{let{t:e}=u(),i=s(),{clientError:t,isEnabled:g,isReady:d,isRegistered:p}=o(),{register:k,unregister:m,onRegisteredOnce:_,onUnregisteredOnce:b}=n(),f=c({mutationFn:async()=>p?(await m(),!1):(await k(),!0),onSuccess:t=>{t?_(()=>i({type:\"success\",message:e(\"Voice_calling_enabled\")})):b(()=>i({type:\"success\",message:e(\"Voice_calling_disabled\")}))},onError:()=>{i({type:\"error\",message:e(\"Voice_calling_registration_failed\")})}}),h=r(()=>t?e(t.message):!d||f.isLoading?e(\"Loading\"):\"\",[t,d,f.isLoading,e]);return r(()=>{if(g)return{items:[{id:\"toggle-voip\",icon:p?\"phone-disabled\":\"phone\",disabled:!d||f.isLoading,onClick:()=>f.mutate(),content:l.createElement(a,{is:\"span\",title:h},p?e(\"Disable_voice_calling\"):e(\"Enable_voice_calling\"))}]}},[g,p,d,h,e,f])};t.exportDefault(g)}","map":"{\"version\":3,\"sources\":[\"client/NavBarV2/NavBarSettingsToolbar/UserMenu/hooks/useVoipItemsSection.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Box } from '@rocket.chat/fuselage';\\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\\nimport { useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport { useVoipAPI, useVoipState } from '@rocket.chat/ui-voip';\\nimport { useMutation } from '@tanstack/react-query';\\nimport React, { useMemo } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nexport const useVoipItemsSection = (): { items: GenericMenuItemProps[] } | undefined => {\\n\\tconst { t } = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst { clientError, isEnabled, isReady, isRegistered } = useVoipState();\\n\\tconst { register, unregister, onRegisteredOnce, onUnregisteredOnce } = useVoipAPI();\\n\\n\\tconst toggleVoip = useMutation({\\n\\t\\tmutationFn: async () => {\\n\\t\\t\\tif (!isRegistered) {\\n\\t\\t\\t\\tawait register();\\n\\t\\t\\t\\treturn true;\\n\\t\\t\\t}\\n\\n\\t\\t\\tawait unregister();\\n\\t\\t\\treturn false;\\n\\t\\t},\\n\\t\\tonSuccess: (isEnabled: boolean) => {\\n\\t\\t\\tif (isEnabled) {\\n\\t\\t\\t\\tonRegisteredOnce(() => dispatchToastMessage({ type: 'success', message: t('Voice_calling_enabled') }));\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tonUnregisteredOnce(() => dispatchToastMessage({ type: 'success', message: t('Voice_calling_disabled') }));\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\tonError: () => {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('Voice_calling_registration_failed') });\\n\\t\\t},\\n\\t});\\n\\n\\tconst tooltip = useMemo(() => {\\n\\t\\tif (clientError) {\\n\\t\\t\\treturn t(clientError.message);\\n\\t\\t}\\n\\n\\t\\tif (!isReady || toggleVoip.isLoading) {\\n\\t\\t\\treturn t('Loading');\\n\\t\\t}\\n\\n\\t\\treturn '';\\n\\t}, [clientError, isReady, toggleVoip.isLoading, t]);\\n\\n\\treturn useMemo(() => {\\n\\t\\tif (!isEnabled) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\treturn {\\n\\t\\t\\titems: [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\tid: 'toggle-voip',\\n\\t\\t\\t\\t\\ticon: isRegistered ? 'phone-disabled' : 'phone',\\n\\t\\t\\t\\t\\tdisabled: !isReady || toggleVoip.isLoading,\\n\\t\\t\\t\\t\\tonClick: () => toggleVoip.mutate(),\\n\\t\\t\\t\\t\\tcontent: (\\n\\t\\t\\t\\t\\t\\t<Box is='span' title={tooltip}>\\n\\t\\t\\t\\t\\t\\t\\t{isRegistered ? t('Disable_voice_calling') : t('Enable_voice_calling')}\\n\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t),\\n\\t\\t\\t\\t},\\n\\t\\t\\t],\\n\\t\\t};\\n\\t}, [isEnabled, isRegistered, isReady, tooltip, t, toggleVoip]);\\n};\\n\\nexport default useVoipItemsSection;\\n\",null],\"names\":[\"Box\",\"useToastMessageDispatch\",\"useVoipAPI\",\"useVoipState\",\"useMutation\",\"React\",\"useMemo\",\"useTranslation\",\"module\",\"export\",\"useVoipItemsSection\",\"link\",\"v\",\"default\",\"t\",\"dispatchToastMessage\",\"clientError\",\"isEnabled\",\"isReady\",\"isRegistered\",\"register\",\"unregister\",\"onRegisteredOnce\",\"onUnregisteredOnce\",\"toggleVoip\",\"mutationFn\",\"onSuccess\",\"type\",\"message\",\"onError\",\"tooltip\",\"isLoading\",\"items\",\"id\",\"icon\",\"disabled\",\"onClick\",\"mutate\",\"content\",\"createElement\",\"is\",\"title\",\"exportDefault\"],\"mappings\":\"2BAA4CA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA5CC,EAAOC,MAAK,CAAE,CAAAC,oBAAMA,IAAAA,CAAwB,GAAAF,EAAAG,IAAA,CAAA,wBAAA,CAAAX,IAAAY,CAAA,EAAAZ,EAAAY,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,2BAAA,CAAAV,wBAAAW,CAAA,EAAAX,EAAAW,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,uBAAA,CAAAT,WAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,aAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,wBAAA,CAAAP,YAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,QAAA,CAAAE,QAAAD,CAAA,EAAAP,EAAAO,CAAA,EAAAN,QAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,gBAAA,CAAAJ,eAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAQrC,IAAMF,EAAsBA,KAClC,GAAM,CAAEI,EAAAA,CAAAA,CAAG,CAAGP,IACRQ,EAAuBd,IAEvB,CAAEe,YAAAA,CAAW,CAAEC,UAAAA,CAAS,CAAEC,QAAAA,CAAO,CAAEC,aAAAA,CAAAA,CAAc,CAAGhB,IACpD,CAAEiB,SAAAA,CAAQ,CAAEC,WAAAA,CAAU,CAAEC,iBAAAA,CAAgB,CAAEC,mBAAAA,CAAAA,CAAoB,CAAGrB,IAEjEsB,EAAapB,EAAY,CAC9BqB,WAAY,SACX,AAAKN,GAKL,MAAME,IACC,CAAA,IALN,MAAMD,IACC,CAAA,GAMTM,UAAYT,IACPA,EACHK,EAAiB,IAAMP,EAAqB,CAAEY,KAAM,UAAWC,QAASd,EAAE,wBAAwB,IAElGS,EAAmB,IAAMR,EAAqB,CAAEY,KAAM,UAAWC,QAASd,EAAE,yBAAyB,GAEvG,EACAe,QAASA,KACRd,EAAqB,CAAEY,KAAM,QAASC,QAASd,EAAE,oCAAoC,EACtF,IAGKgB,EAAUxB,EAAQ,IACvB,AAAIU,EACIF,EAAEE,EAAYY,OAAO,EAGzB,CAACV,GAAWM,EAAWO,SAAS,CAC5BjB,EAAE,WAGH,GACL,CAACE,EAAaE,EAASM,EAAWO,SAAS,CAAEjB,EAAE,EAElD,OAAOR,EAAQ,KACd,GAAKW,EAIL,MAAO,CACNe,MAAO,CACN,CACCC,GAAI,cACJC,KAAMf,EAAe,iBAAmB,QACxCgB,SAAU,CAACjB,GAAWM,EAAWO,SAAS,CAC1CK,QAASA,IAAMZ,EAAWa,MAAM,GAChCC,QACCjC,EAAAkC,aAAA,CAACvC,EAAG,CAACwC,GAAG,OAAOC,MAAOX,CAAQ,EAC5BX,EAAeL,EAAE,yBAA2BA,EAAE,0BAGjD,CAGJ,EAAG,CAACG,EAAWE,EAAcD,EAASY,EAAShB,EAAGU,EAAW,CAC9D,EAtEAhB,EAAOkC,aAAa,CAwELhC\"}"}