{"code":"function module(t,i,s){let e,a,n,r,o,d,c,l,h,g,u,p,m,M,v;s.export({ChatMessages:()=>w}),s.link(\"@rocket.chat/core-typings\",{isVideoConfMessage(t){e=t}},0),s.link(\"../../../../client/lib/chats/data\",{createDataAPI(t){a=t}},1),s.link(\"../../../../client/lib/chats/flows/processMessageEditing\",{processMessageEditing(t){n=t}},2),s.link(\"../../../../client/lib/chats/flows/processSetReaction\",{processSetReaction(t){r=t}},3),s.link(\"../../../../client/lib/chats/flows/processSlashCommand\",{processSlashCommand(t){o=t}},4),s.link(\"../../../../client/lib/chats/flows/processTooLongMessage\",{processTooLongMessage(t){d=t}},5),s.link(\"../../../../client/lib/chats/flows/replyBroadcast\",{replyBroadcast(t){c=t}},6),s.link(\"../../../../client/lib/chats/flows/requestMessageDeletion\",{requestMessageDeletion(t){l=t}},7),s.link(\"../../../../client/lib/chats/flows/sendMessage\",{sendMessage(t){h=t}},8),s.link(\"../../../../client/lib/chats/flows/uploadFiles\",{uploadFiles(t){g=t}},9),s.link(\"../../../../client/lib/chats/readStateManager\",{ReadStateManager(t){u=t}},10),s.link(\"../../../../client/lib/chats/uploads\",{createUploadsAPI(t){p=t}},11),s.link(\"../../../../client/views/room/MessageList/providers/messageHighlightSubscription\",{setHighlightMessage(t){m=t},clearHighlightMessage(t){M=t}},12),s.link(\"./UserAction\",{UserAction(t){v=t}},13);class w{constructor(t){var i=this;this.params=void 0,this.uid=void 0,this.composer=void 0,this.setComposerAPI=t=>{var i;null===(i=this.composer)||void 0===i||i.release(),this.composer=t},this.data=void 0,this.readStateManager=void 0,this.uploads=void 0,this.ActionManager=void 0,this.emojiPicker=void 0,this.action=void 0,this.currentEditingMID=void 0,this.messageEditing={toPreviousMessage:async()=>{if(!this.composer)return;if(!this.currentEditing){let t=await this.data.findLastOwnMessage();t&&e(t)&&(t=await this.data.findPreviousOwnMessage(t)),t&&(await this.data.saveDraft(void 0,this.composer.text),await this.messageEditing.editMessage(t));return}let t=await this.data.findMessageByID(this.currentEditing.mid),i=t?await this.data.findPreviousOwnMessage(t):void 0;if(i&&e(i)&&(i=await this.data.findPreviousOwnMessage(i)),i){await this.messageEditing.editMessage(i);return}await this.currentEditing.cancel()},toNextMessage:async()=>{if(!this.composer||!this.currentEditing)return;let t=await this.data.findMessageByID(this.currentEditing.mid),i=t?await this.data.findNextOwnMessage(t):void 0;if(i&&e(i)&&(i=await this.data.findNextOwnMessage(i)),i){await this.messageEditing.editMessage(i,{cursorAtStart:!0});return}await this.currentEditing.cancel()},editMessage:async function(t){var s,e,a;let{cursorAtStart:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=await i.data.getDraft(t._id)||(null===(s=t.attachments)||void 0===s?void 0:null===(e=s[0])||void 0===e?void 0:e.description)||t.msg;await (null===(a=i.currentEditing)||void 0===a?void 0:a.stop()),i.composer&&await i.data.canUpdateMessage(t)&&(i.currentEditingMID=t._id,m(t._id),i.composer.setEditingMode(!0),i.composer.setText(r),n&&i.composer.setCursorToStart(),n||i.composer.setCursorToEnd(),i.composer.focus())}},this.flows=void 0,this.params=t;let{rid:s,tmid:M}=t;this.uid=t.uid,this.data=a({rid:s,tmid:M}),this.uploads=p({rid:s,tmid:M}),this.ActionManager=t.actionManager;let w=()=>{throw Error(\"Flow is not implemented\")};this.readStateManager=new u(s),this.emojiPicker={open:w,close:w},this.action={start:async i=>{v.start(t.rid,\"user-\".concat(i),{tmid:t.tmid})},performContinuously:async i=>{v.performContinuously(t.rid,\"user-\".concat(i),{tmid:t.tmid})},stop:async i=>{v.stop(t.rid,\"user-\".concat(i),{tmid:t.tmid})}},this.flows={uploadFiles:g.bind(null,this),sendMessage:h.bind(this,this),processSlashCommand:o.bind(null,this),processTooLongMessage:d.bind(null,this),processMessageEditing:n.bind(null,this),processSetReaction:r.bind(null,this),requestMessageDeletion:l.bind(this,this),replyBroadcast:c.bind(null,this)}}get currentEditing(){if(this.composer&&this.currentEditingMID)return{mid:this.currentEditingMID,reset:async()=>{if(!this.composer||!this.currentEditingMID)return!1;let t=await this.data.findMessageByID(this.currentEditingMID);if(this.composer.text!==(null==t?void 0:t.msg)){var i;return this.composer.setText(null!==(i=null==t?void 0:t.msg)&&void 0!==i?i:\"\"),!0}return!1},stop:async()=>{if(!this.composer||!this.currentEditingMID)return;let t=await this.data.findMessageByID(this.currentEditingMID),i=this.composer.text;i===(null==t?void 0:t.msg)?await this.data.discardDraft(this.currentEditingMID):await this.data.saveDraft(this.currentEditingMID,await this.data.getDraft(this.currentEditingMID)||i),this.composer.setEditingMode(!1),this.currentEditingMID=void 0,M()},cancel:async()=>{var t,i,s;this.currentEditingMID&&(await this.data.discardDraft(this.currentEditingMID),await (null===(t=this.currentEditing)||void 0===t?void 0:t.stop()),null===(i=this.composer)||void 0===i||i.setText(null!==(s=await this.data.getDraft(void 0))&&void 0!==s?s:\"\"))}}}async release(){if(this.currentEditing){var t;this.params.tmid||await this.currentEditing.cancel(),null===(t=this.composer)||void 0===t||t.clear()}}}}","map":"{\"version\":3,\"sources\":[\"app/ui/client/lib/ChatMessages.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IMessage, IRoom, IUser } from '@rocket.chat/core-typings';\\nimport { isVideoConfMessage } from '@rocket.chat/core-typings';\\nimport type { IActionManager } from '@rocket.chat/ui-contexts';\\n\\nimport type { ChatAPI, ComposerAPI, DataAPI, UploadsAPI } from '../../../../client/lib/chats/ChatAPI';\\nimport { createDataAPI } from '../../../../client/lib/chats/data';\\nimport { processMessageEditing } from '../../../../client/lib/chats/flows/processMessageEditing';\\nimport { processSetReaction } from '../../../../client/lib/chats/flows/processSetReaction';\\nimport { processSlashCommand } from '../../../../client/lib/chats/flows/processSlashCommand';\\nimport { processTooLongMessage } from '../../../../client/lib/chats/flows/processTooLongMessage';\\nimport { replyBroadcast } from '../../../../client/lib/chats/flows/replyBroadcast';\\nimport { requestMessageDeletion } from '../../../../client/lib/chats/flows/requestMessageDeletion';\\nimport { sendMessage } from '../../../../client/lib/chats/flows/sendMessage';\\nimport { uploadFiles } from '../../../../client/lib/chats/flows/uploadFiles';\\nimport { ReadStateManager } from '../../../../client/lib/chats/readStateManager';\\nimport { createUploadsAPI } from '../../../../client/lib/chats/uploads';\\nimport {\\n\\tsetHighlightMessage,\\n\\tclearHighlightMessage,\\n} from '../../../../client/views/room/MessageList/providers/messageHighlightSubscription';\\nimport { UserAction } from './UserAction';\\n\\ntype DeepWritable<T> = T extends (...args: any) => any\\n\\t? T\\n\\t: {\\n\\t\\t\\t-readonly [P in keyof T]: DeepWritable<T[P]>;\\n\\t  };\\n\\nexport class ChatMessages implements ChatAPI {\\n\\tpublic uid: string | null;\\n\\n\\tpublic composer: ComposerAPI | undefined;\\n\\n\\tpublic setComposerAPI = (composer: ComposerAPI): void => {\\n\\t\\tthis.composer?.release();\\n\\t\\tthis.composer = composer;\\n\\t};\\n\\n\\tpublic data: DataAPI;\\n\\n\\tpublic readStateManager: ReadStateManager;\\n\\n\\tpublic uploads: UploadsAPI;\\n\\n\\tpublic ActionManager: any;\\n\\n\\tpublic emojiPicker: {\\n\\t\\topen(el: Element, cb: (emoji: string) => void): void;\\n\\t\\tclose(): void;\\n\\t};\\n\\n\\tpublic action: {\\n\\t\\tstart(action: 'typing'): Promise<void> | void;\\n\\t\\tstop(action: 'typing' | 'recording' | 'uploading' | 'playing'): Promise<void> | void;\\n\\t\\tperformContinuously(action: 'recording' | 'uploading' | 'playing'): Promise<void> | void;\\n\\t};\\n\\n\\tprivate currentEditingMID?: string;\\n\\n\\tpublic messageEditing: ChatAPI['messageEditing'] = {\\n\\t\\ttoPreviousMessage: async () => {\\n\\t\\t\\tif (!this.composer) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (!this.currentEditing) {\\n\\t\\t\\t\\tlet lastMessage = await this.data.findLastOwnMessage();\\n\\n\\t\\t\\t\\t// Videoconf messages should not be edited\\n\\t\\t\\t\\tif (lastMessage && isVideoConfMessage(lastMessage)) {\\n\\t\\t\\t\\t\\tlastMessage = await this.data.findPreviousOwnMessage(lastMessage);\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tif (lastMessage) {\\n\\t\\t\\t\\t\\tawait this.data.saveDraft(undefined, this.composer.text);\\n\\t\\t\\t\\t\\tawait this.messageEditing.editMessage(lastMessage);\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tconst currentMessage = await this.data.findMessageByID(this.currentEditing.mid);\\n\\t\\t\\tlet previousMessage = currentMessage ? await this.data.findPreviousOwnMessage(currentMessage) : undefined;\\n\\n\\t\\t\\t// Videoconf messages should not be edited\\n\\t\\t\\tif (previousMessage && isVideoConfMessage(previousMessage)) {\\n\\t\\t\\t\\tpreviousMessage = await this.data.findPreviousOwnMessage(previousMessage);\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (previousMessage) {\\n\\t\\t\\t\\tawait this.messageEditing.editMessage(previousMessage);\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tawait this.currentEditing.cancel();\\n\\t\\t},\\n\\t\\ttoNextMessage: async () => {\\n\\t\\t\\tif (!this.composer || !this.currentEditing) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tconst currentMessage = await this.data.findMessageByID(this.currentEditing.mid);\\n\\t\\t\\tlet nextMessage = currentMessage ? await this.data.findNextOwnMessage(currentMessage) : undefined;\\n\\n\\t\\t\\t// Videoconf messages should not be edited\\n\\t\\t\\tif (nextMessage && isVideoConfMessage(nextMessage)) {\\n\\t\\t\\t\\tnextMessage = await this.data.findNextOwnMessage(nextMessage);\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (nextMessage) {\\n\\t\\t\\t\\tawait this.messageEditing.editMessage(nextMessage, { cursorAtStart: true });\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tawait this.currentEditing.cancel();\\n\\t\\t},\\n\\t\\teditMessage: async (message: IMessage, { cursorAtStart = false }: { cursorAtStart?: boolean } = {}) => {\\n\\t\\t\\tconst text = (await this.data.getDraft(message._id)) || message.attachments?.[0]?.description || message.msg;\\n\\n\\t\\t\\tawait this.currentEditing?.stop();\\n\\n\\t\\t\\tif (!this.composer || !(await this.data.canUpdateMessage(message))) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tthis.currentEditingMID = message._id;\\n\\t\\t\\tsetHighlightMessage(message._id);\\n\\t\\t\\tthis.composer.setEditingMode(true);\\n\\n\\t\\t\\tthis.composer.setText(text);\\n\\t\\t\\tcursorAtStart && this.composer.setCursorToStart();\\n\\t\\t\\t!cursorAtStart && this.composer.setCursorToEnd();\\n\\t\\t\\tthis.composer.focus();\\n\\t\\t},\\n\\t};\\n\\n\\tpublic flows: DeepWritable<ChatAPI['flows']>;\\n\\n\\tpublic constructor(\\n\\t\\tprivate params: {\\n\\t\\t\\trid: IRoom['_id'];\\n\\t\\t\\ttmid?: IMessage['_id'];\\n\\t\\t\\tuid: IUser['_id'] | null;\\n\\t\\t\\tactionManager: IActionManager;\\n\\t\\t},\\n\\t) {\\n\\t\\tconst { rid, tmid } = params;\\n\\t\\tthis.uid = params.uid;\\n\\t\\tthis.data = createDataAPI({ rid, tmid });\\n\\t\\tthis.uploads = createUploadsAPI({ rid, tmid });\\n\\t\\tthis.ActionManager = params.actionManager;\\n\\n\\t\\tconst unimplemented = () => {\\n\\t\\t\\tthrow new Error('Flow is not implemented');\\n\\t\\t};\\n\\n\\t\\tthis.readStateManager = new ReadStateManager(rid);\\n\\n\\t\\tthis.emojiPicker = {\\n\\t\\t\\topen: unimplemented,\\n\\t\\t\\tclose: unimplemented,\\n\\t\\t};\\n\\n\\t\\tthis.action = {\\n\\t\\t\\tstart: async (action: 'typing') => {\\n\\t\\t\\t\\tUserAction.start(params.rid, `user-${action}`, { tmid: params.tmid });\\n\\t\\t\\t},\\n\\t\\t\\tperformContinuously: async (action: 'recording' | 'uploading' | 'playing') => {\\n\\t\\t\\t\\tUserAction.performContinuously(params.rid, `user-${action}`, { tmid: params.tmid });\\n\\t\\t\\t},\\n\\t\\t\\tstop: async (action: 'typing' | 'recording' | 'uploading' | 'playing') => {\\n\\t\\t\\t\\tUserAction.stop(params.rid, `user-${action}`, { tmid: params.tmid });\\n\\t\\t\\t},\\n\\t\\t};\\n\\n\\t\\tthis.flows = {\\n\\t\\t\\tuploadFiles: uploadFiles.bind(null, this),\\n\\t\\t\\tsendMessage: sendMessage.bind(this, this),\\n\\t\\t\\tprocessSlashCommand: processSlashCommand.bind(null, this),\\n\\t\\t\\tprocessTooLongMessage: processTooLongMessage.bind(null, this),\\n\\t\\t\\tprocessMessageEditing: processMessageEditing.bind(null, this),\\n\\t\\t\\tprocessSetReaction: processSetReaction.bind(null, this),\\n\\t\\t\\trequestMessageDeletion: requestMessageDeletion.bind(this, this),\\n\\t\\t\\treplyBroadcast: replyBroadcast.bind(null, this),\\n\\t\\t};\\n\\t}\\n\\n\\tpublic get currentEditing() {\\n\\t\\tif (!this.composer || !this.currentEditingMID) {\\n\\t\\t\\treturn undefined;\\n\\t\\t}\\n\\n\\t\\treturn {\\n\\t\\t\\tmid: this.currentEditingMID,\\n\\t\\t\\treset: async (): Promise<boolean> => {\\n\\t\\t\\t\\tif (!this.composer || !this.currentEditingMID) {\\n\\t\\t\\t\\t\\treturn false;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tconst message = await this.data.findMessageByID(this.currentEditingMID);\\n\\t\\t\\t\\tif (this.composer.text !== message?.msg) {\\n\\t\\t\\t\\t\\tthis.composer.setText(message?.msg ?? '');\\n\\t\\t\\t\\t\\treturn true;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t},\\n\\t\\t\\tstop: async (): Promise<void> => {\\n\\t\\t\\t\\tif (!this.composer || !this.currentEditingMID) {\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tconst message = await this.data.findMessageByID(this.currentEditingMID);\\n\\t\\t\\t\\tconst draft = this.composer.text;\\n\\n\\t\\t\\t\\tif (draft === message?.msg) {\\n\\t\\t\\t\\t\\tawait this.data.discardDraft(this.currentEditingMID);\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tawait this.data.saveDraft(this.currentEditingMID, (await this.data.getDraft(this.currentEditingMID)) || draft);\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tthis.composer.setEditingMode(false);\\n\\t\\t\\t\\tthis.currentEditingMID = undefined;\\n\\t\\t\\t\\tclearHighlightMessage();\\n\\t\\t\\t},\\n\\t\\t\\tcancel: async (): Promise<void> => {\\n\\t\\t\\t\\tif (!this.currentEditingMID) {\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tawait this.data.discardDraft(this.currentEditingMID);\\n\\t\\t\\t\\tawait this.currentEditing?.stop();\\n\\t\\t\\t\\tthis.composer?.setText((await this.data.getDraft(undefined)) ?? '');\\n\\t\\t\\t},\\n\\t\\t};\\n\\t}\\n\\n\\tpublic async release() {\\n\\t\\tif (this.currentEditing) {\\n\\t\\t\\tif (!this.params.tmid) {\\n\\t\\t\\t\\tawait this.currentEditing.cancel();\\n\\t\\t\\t}\\n\\t\\t\\tthis.composer?.clear();\\n\\t\\t}\\n\\t}\\n}\\n\",null],\"names\":[\"isVideoConfMessage\",\"createDataAPI\",\"processMessageEditing\",\"processSetReaction\",\"processSlashCommand\",\"processTooLongMessage\",\"replyBroadcast\",\"requestMessageDeletion\",\"sendMessage\",\"uploadFiles\",\"ReadStateManager\",\"createUploadsAPI\",\"setHighlightMessage\",\"clearHighlightMessage\",\"UserAction\",\"module\",\"export\",\"ChatMessages\",\"link\",\"v\",\"constructor\",\"params\",\"_this\",\"uid\",\"composer\",\"setComposerAPI\",\"_this$composer\",\"release\",\"data\",\"readStateManager\",\"uploads\",\"ActionManager\",\"emojiPicker\",\"action\",\"currentEditingMID\",\"messageEditing\",\"toPreviousMessage\",\"currentEditing\",\"lastMessage\",\"findLastOwnMessage\",\"findPreviousOwnMessage\",\"saveDraft\",\"undefined\",\"text\",\"editMessage\",\"currentMessage\",\"findMessageByID\",\"mid\",\"previousMessage\",\"cancel\",\"toNextMessage\",\"nextMessage\",\"findNextOwnMessage\",\"cursorAtStart\",\"message\",\"_message$attachments\",\"_message$attachments$\",\"_this$currentEditing\",\"arguments\",\"length\",\"getDraft\",\"_id\",\"attachments\",\"description\",\"msg\",\"stop\",\"canUpdateMessage\",\"setEditingMode\",\"setText\",\"setCursorToStart\",\"setCursorToEnd\",\"focus\",\"flows\",\"rid\",\"tmid\",\"actionManager\",\"unimplemented\",\"Error\",\"open\",\"close\",\"start\",\"concat\",\"performContinuously\",\"bind\",\"reset\",\"_message$msg\",\"draft\",\"discardDraft\",\"_this$currentEditing2\",\"_this$composer2\",\"_await$this$data$getD\",\"_this$composer3\",\"clear\"],\"mappings\":\"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\"}"}