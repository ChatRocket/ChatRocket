{"code":"function module(e,n,t){var r,o,l,a,c,u,i,s,d,f,m,p,v,k,b,x,g,_;t.link(\"@babel/runtime/regenerator\",{default:function(e){r=e}},0),t.link(\"@rocket.chat/fuselage\",{Box:function(e){o=e},ButtonGroup:function(e){l=e},Button:function(e){a=e},Margins:function(e){c=e}},0),t.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback:function(e){u=e}},1),t.link(\"@rocket.chat/ui-contexts\",{useSetModal:function(e){i=e},useToastMessageDispatch:function(e){s=e},useRoute:function(e){d=e},useEndpoint:function(e){f=e},useTranslation:function(e){m=e}},2),t.link(\"react\",{default:function(e){p=e}},3),t.link(\"react-hook-form\",{FormProvider:function(e){v=e},useForm:function(e){k=e}},4),t.link(\"../../../components/Contextualbar\",{ContextualbarFooter:function(e){b=e},ContextualbarScrollableContent:function(e){x=e}},5),t.link(\"../../../components/GenericModal\",{default:function(e){g=e}},6),t.link(\"./RoleForm\",{default:function(e){_=e}},7),t.exportDefault(function(e){var n=e.role,t=e.isEnterprise,h=m(),E=s(),y=i(),C=d(\"admin-permissions\"),S=d(\"admin-permissions\"),D=f(\"POST\",\"/v1/roles.create\"),P=f(\"POST\",\"/v1/roles.update\"),w=f(\"POST\",\"/v1/roles.delete\"),T=k({defaultValues:{roleId:null==n?void 0:n._id,name:null==n?void 0:n.name,description:null==n?void 0:n.description,scope:(null==n?void 0:n.scope)||\"Users\",mandatory2fa:!!(null!=n&&n.mandatory2fa)}}),F=u(function(){null!=n&&n._id&&C.push({context:\"users-in-role\",_id:n._id})}),M=u(function(e){return r.async(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!e.roleId){n.next=6;break}return n.next=4,r.awrap(P(e));case 4:return E({type:\"success\",message:h(\"Saved\")}),n.abrupt(\"return\",S.push({}));case 6:return n.next=8,r.awrap(D(e));case 8:E({type:\"success\",message:h(\"Saved\")}),S.push({}),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(0),E({type:\"error\",message:n.t0});case 15:case\"end\":return n.stop()}},null,null,[[0,12]],Promise)}),R=u(function(){var e,o;return r.async(function(l){for(;;)switch(l.prev=l.next){case 0:if(null!=n&&n._id){l.next=2;break}return l.abrupt(\"return\");case 2:e=function e(){return r.async(function e(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.awrap(w({roleId:n._id}));case 3:E({type:\"success\",message:h(\"Role_removed\")}),y(),S.push({}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),E({type:\"error\",message:e.t0}),y();case 12:case\"end\":return e.stop()}},null,null,[[0,8]],Promise)},o=t?h(\"Delete_Role_Warning\"):h(\"Delete_Role_Warning_Not_Enterprise\"),y(p.createElement(g,{variant:\"danger\",onConfirm:e,onClose:function(){return y()},onCancel:function(){return y()},confirmText:h(\"Delete\")},o));case 5:case\"end\":return l.stop()}},null,null,null,Promise)});return p.createElement(p.Fragment,null,p.createElement(x,null,p.createElement(o,{w:\"full\",alignSelf:\"center\",mb:\"neg-x8\"},p.createElement(c,{block:8},p.createElement(v,T,p.createElement(_,{editing:!!(null==n?void 0:n._id),isProtected:null==n?void 0:n.protected,isDisabled:!t}))))),p.createElement(b,null,p.createElement(l,{vertical:!0,stretch:!0},p.createElement(a,{primary:!0,disabled:!T.formState.isDirty||!t,onClick:T.handleSubmit(M)},h(\"Save\")),!(null!=n&&n.protected)&&(null==n?void 0:n._id)&&p.createElement(a,{secondary:!0,danger:!0,onClick:R},h(\"Delete\")),(null==n?void 0:n._id)&&p.createElement(a,{onClick:F},h(\"Users_in_role\")))))})}","map":"{\"version\":3,\"sources\":[\"client/views/admin/permissions/EditRolePage.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IRole } from '@rocket.chat/core-typings';\\nimport { Box, ButtonGroup, Button, Margins } from '@rocket.chat/fuselage';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useSetModal, useToastMessageDispatch, useRoute, useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement } from 'react';\\nimport React from 'react';\\nimport { FormProvider, useForm } from 'react-hook-form';\\n\\nimport { ContextualbarFooter, ContextualbarScrollableContent } from '../../../components/Contextualbar';\\nimport GenericModal from '../../../components/GenericModal';\\nimport RoleForm from './RoleForm';\\n\\nconst EditRolePage = ({ role, isEnterprise }: { role?: IRole; isEnterprise: boolean }): ReactElement => {\\n\\tconst t = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst setModal = useSetModal();\\n\\tconst usersInRoleRouter = useRoute('admin-permissions');\\n\\tconst router = useRoute('admin-permissions');\\n\\n\\tconst createRole = useEndpoint('POST', '/v1/roles.create');\\n\\tconst updateRole = useEndpoint('POST', '/v1/roles.update');\\n\\tconst deleteRole = useEndpoint('POST', '/v1/roles.delete');\\n\\n\\tconst methods = useForm({\\n\\t\\tdefaultValues: {\\n\\t\\t\\troleId: role?._id,\\n\\t\\t\\tname: role?.name,\\n\\t\\t\\tdescription: role?.description,\\n\\t\\t\\tscope: role?.scope || 'Users',\\n\\t\\t\\tmandatory2fa: !!role?.mandatory2fa,\\n\\t\\t},\\n\\t});\\n\\n\\tconst handleManageUsers = useMutableCallback(() => {\\n\\t\\tif (role?._id) {\\n\\t\\t\\tusersInRoleRouter.push({\\n\\t\\t\\t\\tcontext: 'users-in-role',\\n\\t\\t\\t\\t_id: role._id,\\n\\t\\t\\t});\\n\\t\\t}\\n\\t});\\n\\n\\tconst handleSave = useMutableCallback(async (data) => {\\n\\t\\ttry {\\n\\t\\t\\tif (data.roleId) {\\n\\t\\t\\t\\tawait updateRole(data);\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Saved') });\\n\\t\\t\\t\\treturn router.push({});\\n\\t\\t\\t}\\n\\n\\t\\t\\tawait createRole(data);\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Saved') });\\n\\t\\t\\trouter.push({});\\n\\t\\t} catch (error) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t}\\n\\t});\\n\\n\\tconst handleDelete = useMutableCallback(async () => {\\n\\t\\tif (!role?._id) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tconst deleteRoleAction = async (): Promise<void> => {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tawait deleteRole({ roleId: role._id });\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Role_removed') });\\n\\t\\t\\t\\tsetModal();\\n\\n\\t\\t\\t\\trouter.push({});\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t\\tsetModal();\\n\\t\\t\\t}\\n\\t\\t};\\n\\n\\t\\tconst deleteRoleMessage = isEnterprise ? t('Delete_Role_Warning') : t('Delete_Role_Warning_Not_Enterprise');\\n\\n\\t\\tsetModal(\\n\\t\\t\\t<GenericModal\\n\\t\\t\\t\\tvariant='danger'\\n\\t\\t\\t\\tonConfirm={deleteRoleAction}\\n\\t\\t\\t\\tonClose={(): void => setModal()}\\n\\t\\t\\t\\tonCancel={(): void => setModal()}\\n\\t\\t\\t\\tconfirmText={t('Delete')}\\n\\t\\t\\t>\\n\\t\\t\\t\\t{deleteRoleMessage}\\n\\t\\t\\t</GenericModal>,\\n\\t\\t);\\n\\t});\\n\\n\\treturn (\\n\\t\\t<>\\n\\t\\t\\t<ContextualbarScrollableContent>\\n\\t\\t\\t\\t<Box w='full' alignSelf='center' mb='neg-x8'>\\n\\t\\t\\t\\t\\t<Margins block={8}>\\n\\t\\t\\t\\t\\t\\t<FormProvider {...methods}>\\n\\t\\t\\t\\t\\t\\t\\t<RoleForm editing={Boolean(role?._id)} isProtected={role?.protected} isDisabled={!isEnterprise} />\\n\\t\\t\\t\\t\\t\\t</FormProvider>\\n\\t\\t\\t\\t\\t</Margins>\\n\\t\\t\\t\\t</Box>\\n\\t\\t\\t</ContextualbarScrollableContent>\\n\\t\\t\\t<ContextualbarFooter>\\n\\t\\t\\t\\t<ButtonGroup vertical stretch>\\n\\t\\t\\t\\t\\t<Button primary disabled={!methods.formState.isDirty || !isEnterprise} onClick={methods.handleSubmit(handleSave)}>\\n\\t\\t\\t\\t\\t\\t{t('Save')}\\n\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t{!role?.protected && role?._id && (\\n\\t\\t\\t\\t\\t\\t<Button secondary danger onClick={handleDelete}>\\n\\t\\t\\t\\t\\t\\t\\t{t('Delete')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t{role?._id && <Button onClick={handleManageUsers}>{t('Users_in_role')}</Button>}\\n\\t\\t\\t\\t</ButtonGroup>\\n\\t\\t\\t</ContextualbarFooter>\\n\\t\\t</>\\n\\t);\\n};\\n\\nexport default EditRolePage;\\n\",null],\"names\":[\"_regeneratorRuntime\",\"Box\",\"ButtonGroup\",\"Button\",\"Margins\",\"useMutableCallback\",\"useSetModal\",\"useToastMessageDispatch\",\"useRoute\",\"useEndpoint\",\"useTranslation\",\"React\",\"FormProvider\",\"useForm\",\"ContextualbarFooter\",\"ContextualbarScrollableContent\",\"GenericModal\",\"RoleForm\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"role\",\"isEnterprise\",\"t\",\"dispatchToastMessage\",\"setModal\",\"usersInRoleRouter\",\"router\",\"createRole\",\"updateRole\",\"deleteRole\",\"methods\",\"defaultValues\",\"roleId\",\"_id\",\"name\",\"description\",\"scope\",\"mandatory2fa\",\"handleManageUsers\",\"push\",\"context\",\"handleSave\",\"data\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"type\",\"message\",\"abrupt\",\"t0\",\"stop\",\"Promise\",\"handleDelete\",\"deleteRoleAction\",\"deleteRoleMessage\",\"_context3\",\"_callee2\",\"_callee2$\",\"_context2\",\"createElement\",\"variant\",\"onConfirm\",\"onClose\",\"onCancel\",\"confirmText\",\"Fragment\",\"w\",\"alignSelf\",\"mb\",\"block\",\"editing\",\"Boolean\",\"isProtected\",\"protected\",\"isDisabled\",\"vertical\",\"stretch\",\"primary\",\"disabled\",\"formState\",\"isDirty\",\"onClick\",\"handleSubmit\",\"secondary\",\"danger\"],\"mappings\":\"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\"}"}