{"code":"function module(e,t,a){let s,n,l,u,r,i,o,c,m,d,p,f,k,q,S,g;a.link(\"@rocket.chat/fuselage\",{Box(e){s=e},Pagination(e){n=e},States(e){l=e},StatesSubtitle(e){u=e},StatesTitle(e){r=e}},0),a.link(\"@rocket.chat/ui-contexts\",{useEndpoint(e){i=e},useTranslation(e){o=e}},1),a.link(\"@tanstack/react-query\",{useMutation(e){c=e}},2),a.link(\"react\",{default(e){m=e},useState(e){d=e},useEffect(e){p=e}},3),a.link(\"../../../../../contexts/hooks/useAppsReload\",{useAppsReload(e){f=e}},4),a.link(\"../../../../../lib/queryClient\",{queryClient(e){k=e}},5),a.link(\"../../../hooks/useAppRequests\",{useAppRequests(e){q=e}},6),a.link(\"./AppRequestItem\",{default(e){S=e}},7),a.link(\"./AppRequestsLoading\",{default(e){g=e}},8),a.exportDefault(e=>{var t,a;let{id:h,isAdminUser:x}=e,[E,y]=d(25),[A,v]=d(0),P=q(h,E,A),R=o(),b=f(),w=i(\"POST\",\"/apps/app-request/markAsSeen\"),D=c({mutationKey:[\"mark-app-requests-as-seen\"],mutationFn:e=>w({unseenRequests:e}),retry:!1});return(p(()=>()=>{if(x&&P.isSuccess){let e=P.data.data.filter(e=>{let{seen:t}=e;return!t}).map(e=>{let{id:t}=e;return t});e.length&&D.mutate(e,{onSuccess:()=>{k.refetchQueries({queryKey:[\"app-requests-stats\"]}),b()}})}},[x,P.isSuccess,null==P?void 0:P.data,b]),P.isLoading)?m.createElement(s,{w:\"full\",maxWidth:\"x608\",marginInline:\"auto\",pbs:36},m.createElement(g,null)):m.createElement(s,{h:\"full\",display:\"flex\",flexDirection:\"column\"},m.createElement(s,{w:\"full\",maxWidth:\"x608\",marginInline:\"auto\",pbs:36,flexGrow:\"1\"},P.isSuccess&&null!==(t=P.data.data)&&void 0!==t&&t.length?P.data.data.map(e=>m.createElement(S,{key:e.id,seen:e.seen,name:e.requester.name,createdDate:e.createdDate,message:e.message,username:e.requester.username})):m.createElement(l,null,m.createElement(r,null,R(\"No_requests\")),m.createElement(u,null,R(\"App_requests_by_workspace\")))),P.isSuccess&&(null===(a=P.data.data)||void 0===a?void 0:a.length)&&m.createElement(n,{divider:!0,count:P.data.meta.total,itemsPerPage:P.data.meta.limit,current:P.data.meta.offset,onSetItemsPerPage:e=>y(e),onSetCurrent:e=>v(e)}))})}","map":"{\"version\":3,\"sources\":[\"client/views/marketplace/AppDetailsPage/tabs/AppRequests/AppRequests.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { App } from '@rocket.chat/core-typings';\\nimport { Box, Pagination, States, StatesSubtitle, StatesTitle } from '@rocket.chat/fuselage';\\nimport { useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\\nimport { useMutation } from '@tanstack/react-query';\\nimport type { ReactElement, SetStateAction } from 'react';\\nimport React, { useState, useEffect } from 'react';\\n\\nimport { useAppsReload } from '../../../../../contexts/hooks/useAppsReload';\\nimport { queryClient } from '../../../../../lib/queryClient';\\nimport { useAppRequests } from '../../../hooks/useAppRequests';\\nimport AppRequestItem from './AppRequestItem';\\nimport AppRequestsLoading from './AppRequestsLoading';\\n\\ntype itemsPerPage = 25 | 50 | 100;\\n\\nconst AppRequests = ({ id, isAdminUser }: { id: App['id']; isAdminUser: boolean }): ReactElement => {\\n\\tconst [limit, setLimit] = useState<itemsPerPage>(25);\\n\\tconst [offset, setOffset] = useState<number>(0);\\n\\n\\tconst paginatedAppRequests = useAppRequests(id, limit, offset);\\n\\tconst t = useTranslation();\\n\\n\\tconst onSetItemsPerPage = (itemsPerPageOption: SetStateAction<itemsPerPage>) => setLimit(itemsPerPageOption);\\n\\tconst onSetCurrent = (currentItemsOption: SetStateAction<number>) => setOffset(currentItemsOption);\\n\\n\\tconst reloadApps = useAppsReload();\\n\\tconst markSeen = useEndpoint('POST', '/apps/app-request/markAsSeen');\\n\\tconst markAppRequestsAsSeen = useMutation({\\n\\t\\tmutationKey: ['mark-app-requests-as-seen'],\\n\\t\\tmutationFn: (unseenRequests: Array<string>) => markSeen({ unseenRequests }),\\n\\t\\tretry: false,\\n\\t});\\n\\tuseEffect(() => {\\n\\t\\treturn () => {\\n\\t\\t\\tif (isAdminUser && paginatedAppRequests.isSuccess) {\\n\\t\\t\\t\\tconst unseenRequests = paginatedAppRequests.data.data.filter(({ seen }) => !seen).map(({ id }) => id);\\n\\n\\t\\t\\t\\tif (unseenRequests.length) {\\n\\t\\t\\t\\t\\tmarkAppRequestsAsSeen.mutate(unseenRequests, {\\n\\t\\t\\t\\t\\t\\tonSuccess: () => {\\n\\t\\t\\t\\t\\t\\t\\tqueryClient.refetchQueries({ queryKey: ['app-requests-stats'] });\\n\\t\\t\\t\\t\\t\\t\\treloadApps();\\n\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t};\\n\\t\\t// eslint-disable-next-line react-hooks/exhaustive-deps\\n\\t}, [isAdminUser, paginatedAppRequests.isSuccess, paginatedAppRequests?.data, reloadApps]);\\n\\n\\tif (paginatedAppRequests.isLoading) {\\n\\t\\treturn (\\n\\t\\t\\t<Box w='full' maxWidth='x608' marginInline='auto' pbs={36}>\\n\\t\\t\\t\\t<AppRequestsLoading />\\n\\t\\t\\t</Box>\\n\\t\\t);\\n\\t}\\n\\n\\treturn (\\n\\t\\t<Box h='full' display='flex' flexDirection='column'>\\n\\t\\t\\t<Box w='full' maxWidth='x608' marginInline='auto' pbs={36} flexGrow='1'>\\n\\t\\t\\t\\t{paginatedAppRequests.isSuccess && paginatedAppRequests.data.data?.length ? (\\n\\t\\t\\t\\t\\tpaginatedAppRequests.data.data.map((request) => (\\n\\t\\t\\t\\t\\t\\t<AppRequestItem\\n\\t\\t\\t\\t\\t\\t\\tkey={request.id}\\n\\t\\t\\t\\t\\t\\t\\tseen={request.seen}\\n\\t\\t\\t\\t\\t\\t\\tname={request.requester.name}\\n\\t\\t\\t\\t\\t\\t\\tcreatedDate={request.createdDate}\\n\\t\\t\\t\\t\\t\\t\\tmessage={request.message}\\n\\t\\t\\t\\t\\t\\t\\tusername={request.requester.username}\\n\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t))\\n\\t\\t\\t\\t) : (\\n\\t\\t\\t\\t\\t<States>\\n\\t\\t\\t\\t\\t\\t<StatesTitle>{t('No_requests')}</StatesTitle>\\n\\t\\t\\t\\t\\t\\t<StatesSubtitle>{t('App_requests_by_workspace')}</StatesSubtitle>\\n\\t\\t\\t\\t\\t</States>\\n\\t\\t\\t\\t)}\\n\\t\\t\\t</Box>\\n\\t\\t\\t{paginatedAppRequests.isSuccess && paginatedAppRequests.data.data?.length && (\\n\\t\\t\\t\\t<Pagination\\n\\t\\t\\t\\t\\tdivider\\n\\t\\t\\t\\t\\tcount={paginatedAppRequests.data.meta.total}\\n\\t\\t\\t\\t\\titemsPerPage={paginatedAppRequests.data.meta.limit}\\n\\t\\t\\t\\t\\tcurrent={paginatedAppRequests.data.meta.offset}\\n\\t\\t\\t\\t\\tonSetItemsPerPage={onSetItemsPerPage}\\n\\t\\t\\t\\t\\tonSetCurrent={onSetCurrent}\\n\\t\\t\\t\\t/>\\n\\t\\t\\t)}\\n\\t\\t</Box>\\n\\t);\\n};\\n\\nexport default AppRequests;\\n\",null],\"names\":[\"Box\",\"Pagination\",\"States\",\"StatesSubtitle\",\"StatesTitle\",\"useEndpoint\",\"useTranslation\",\"useMutation\",\"React\",\"useState\",\"useEffect\",\"useAppsReload\",\"queryClient\",\"useAppRequests\",\"AppRequestItem\",\"AppRequestsLoading\",\"module\",\"link\",\"v\",\"default\",\"exportDefault\",\"_ref\",\"_paginatedAppRequests\",\"_paginatedAppRequests2\",\"id\",\"isAdminUser\",\"limit\",\"setLimit\",\"offset\",\"setOffset\",\"paginatedAppRequests\",\"t\",\"reloadApps\",\"markSeen\",\"markAppRequestsAsSeen\",\"mutationKey\",\"mutationFn\",\"unseenRequests\",\"retry\",\"isSuccess\",\"data\",\"filter\",\"_ref2\",\"seen\",\"map\",\"_ref3\",\"length\",\"mutate\",\"onSuccess\",\"refetchQueries\",\"queryKey\",\"isLoading\",\"createElement\",\"w\",\"maxWidth\",\"marginInline\",\"pbs\",\"h\",\"display\",\"flexDirection\",\"flexGrow\",\"request\",\"key\",\"name\",\"requester\",\"createdDate\",\"message\",\"username\",\"divider\",\"count\",\"meta\",\"total\",\"itemsPerPage\",\"current\",\"onSetItemsPerPage\",\"itemsPerPageOption\",\"onSetCurrent\",\"currentItemsOption\"],\"mappings\":\"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\"}"}