{"code":"function module(t,e,n){n.link(\"@babel/runtime/helpers/toConsumableArray\",{default:function(t){u=t}},0),n.link(\"@babel/runtime/regenerator\",{default:function(t){a=t}},1),n.export({useStatusItems:function(){return w}}),n.link(\"@rocket.chat/fuselage\",{Box:function(t){s=t}},0),n.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(t){r=t},useSetting:function(t){i=t}},1),n.link(\"@tanstack/react-query\",{useMutation:function(t){o=t},useQuery:function(t){c=t},useQueryClient:function(t){l=t}},2),n.link(\"react\",{default:function(t){f=t},useEffect:function(t){d=t}},3),n.link(\"react-i18next\",{useTranslation:function(t){m=t}},4),n.link(\"../../../../lib/callbacks\",{callbacks:function(t){k=t}},5),n.link(\"../../../components/MarkdownText\",{default:function(t){b=t}},6),n.link(\"../../../components/UserStatus\",{UserStatus:function(t){p=t}},7),n.link(\"../../../lib/userStatuses\",{userStatuses:function(t){S=t}},8),n.link(\"../../../views/admin/customUserStatus/hooks/useStatusDisabledModal\",{useStatusDisabledModal:function(t){y=t}},9),n.link(\"./useCustomStatusModalHandler\",{useCustomStatusModalHandler:function(t){v=t}},10);var u,a,s,r,i,o,c,l,f,d,m,k,b,p,S,y,v,w=function(){S.invisibleAllowed=i(\"Accounts_AllowInvisibleStatusOption\",!0);var t=l();d(function(){return S.watch(function(){t.setQueryData([\"user-statuses\"],Array.from(S))})},[t]);var e=m().t,n=r(\"POST\",\"/v1/users.setStatus\"),w=o({mutationFn:function(t){return a.async(function(e){for(;;)switch(e.prev=e.next){case 0:n({status:t.statusType,message:S.isValidType(t.id)?\"\":t.name}),k.run(\"userStatusManuallySet\",t);case 2:case\"end\":return e.stop()}},null,null,null,Promise)}}),h=i(\"Presence_broadcast_disabled\",!1),x=c({queryKey:[\"user-statuses\"],queryFn:function(){return a.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.awrap(S.sync());case 2:return t.abrupt(\"return\",Array.from(S));case 3:case\"end\":return t.stop()}},null,null,null,Promise)},staleTime:1/0,select:function(t){return t.map(function(t){var n=t.localizeName?e(t.name):t.name;return{id:t.id,status:f.createElement(p,{status:t.statusType}),content:f.createElement(b,{content:n,parseEmoji:!0,variant:\"inline\"}),disabled:h,onClick:function(){return w.mutate(t)}}})}}).data,C=y(),E=v();return[].concat(u(h?[{id:\"presence-disabled\",content:f.createElement(s,{fontScale:\"p2\"},f.createElement(s,{mbe:4,wordBreak:\"break-word\",style:{whiteSpace:\"normal\"}},e(\"User_status_disabled\")),f.createElement(s,{is:\"a\",color:\"info\",onClick:C},e(\"Learn_more\")))}]:[]),u(null!=x?x:[]),[{id:\"custom-status\",icon:\"emoji\",content:e(\"Custom_Status\"),onClick:E,disabled:h}])}}","map":"{\"version\":3,\"sources\":[\"client/sidebar/header/hooks/useStatusItems.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Box } from '@rocket.chat/fuselage';\\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\\nimport { useEndpoint, useSetting } from '@rocket.chat/ui-contexts';\\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\\nimport React, { useEffect } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { callbacks } from '../../../../lib/callbacks';\\nimport MarkdownText from '../../../components/MarkdownText';\\nimport { UserStatus } from '../../../components/UserStatus';\\nimport { userStatuses } from '../../../lib/userStatuses';\\nimport type { UserStatusDescriptor } from '../../../lib/userStatuses';\\nimport { useStatusDisabledModal } from '../../../views/admin/customUserStatus/hooks/useStatusDisabledModal';\\nimport { useCustomStatusModalHandler } from './useCustomStatusModalHandler';\\n\\nexport const useStatusItems = (): GenericMenuItemProps[] => {\\n\\t// We should lift this up to somewhere else if we want to use it in other places\\n\\n\\tuserStatuses.invisibleAllowed = useSetting('Accounts_AllowInvisibleStatusOption', true);\\n\\n\\tconst queryClient = useQueryClient();\\n\\n\\tuseEffect(\\n\\t\\t() =>\\n\\t\\t\\tuserStatuses.watch(() => {\\n\\t\\t\\t\\tqueryClient.setQueryData(['user-statuses'], Array.from(userStatuses));\\n\\t\\t\\t}),\\n\\t\\t[queryClient],\\n\\t);\\n\\n\\tconst { t } = useTranslation();\\n\\n\\tconst setStatus = useEndpoint('POST', '/v1/users.setStatus');\\n\\tconst setStatusMutation = useMutation({\\n\\t\\tmutationFn: async (status: UserStatusDescriptor) => {\\n\\t\\t\\tvoid setStatus({ status: status.statusType, message: userStatuses.isValidType(status.id) ? '' : status.name });\\n\\t\\t\\tvoid callbacks.run('userStatusManuallySet', status);\\n\\t\\t},\\n\\t});\\n\\n\\tconst presenceDisabled = useSetting('Presence_broadcast_disabled', false);\\n\\n\\tconst { data: statuses } = useQuery({\\n\\t\\tqueryKey: ['user-statuses'],\\n\\t\\tqueryFn: async () => {\\n\\t\\t\\tawait userStatuses.sync();\\n\\t\\t\\treturn Array.from(userStatuses);\\n\\t\\t},\\n\\t\\tstaleTime: Infinity,\\n\\t\\tselect: (statuses) =>\\n\\t\\t\\tstatuses.map((status): GenericMenuItemProps => {\\n\\t\\t\\t\\tconst content = status.localizeName ? t(status.name) : status.name;\\n\\t\\t\\t\\treturn {\\n\\t\\t\\t\\t\\tid: status.id,\\n\\t\\t\\t\\t\\tstatus: <UserStatus status={status.statusType} />,\\n\\t\\t\\t\\t\\tcontent: <MarkdownText content={content} parseEmoji={true} variant='inline' />,\\n\\t\\t\\t\\t\\tdisabled: presenceDisabled,\\n\\t\\t\\t\\t\\tonClick: () => setStatusMutation.mutate(status),\\n\\t\\t\\t\\t};\\n\\t\\t\\t}),\\n\\t});\\n\\n\\tconst handleStatusDisabledModal = useStatusDisabledModal();\\n\\tconst handleCustomStatus = useCustomStatusModalHandler();\\n\\n\\treturn [\\n\\t\\t...(presenceDisabled\\n\\t\\t\\t? [\\n\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\tid: 'presence-disabled',\\n\\t\\t\\t\\t\\t\\tcontent: (\\n\\t\\t\\t\\t\\t\\t\\t<Box fontScale='p2'>\\n\\t\\t\\t\\t\\t\\t\\t\\t<Box mbe={4} wordBreak='break-word' style={{ whiteSpace: 'normal' }}>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t{t('User_status_disabled')}\\n\\t\\t\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t\\t\\t\\t<Box is='a' color='info' onClick={handleStatusDisabledModal}>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t{t('Learn_more')}\\n\\t\\t\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t\\t),\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t  ]\\n\\t\\t\\t: []),\\n\\t\\t...(statuses ?? []),\\n\\t\\t{ id: 'custom-status', icon: 'emoji', content: t('Custom_Status'), onClick: handleCustomStatus, disabled: presenceDisabled },\\n\\t];\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_toConsumableArray\",\"_regeneratorRuntime\",\"export\",\"useStatusItems\",\"Box\",\"useEndpoint\",\"useSetting\",\"useMutation\",\"useQuery\",\"useQueryClient\",\"React\",\"useEffect\",\"useTranslation\",\"callbacks\",\"MarkdownText\",\"UserStatus\",\"userStatuses\",\"useStatusDisabledModal\",\"useCustomStatusModalHandler\",\"invisibleAllowed\",\"queryClient\",\"watch\",\"setQueryData\",\"Array\",\"from\",\"t\",\"_useTranslation\",\"setStatus\",\"setStatusMutation\",\"mutationFn\",\"status\",\"async\",\"_context\",\"prev\",\"next\",\"statusType\",\"message\",\"isValidType\",\"id\",\"name\",\"run\",\"stop\",\"Promise\",\"presenceDisabled\",\"statuses\",\"_useQuery\",\"queryKey\",\"queryFn\",\"_context2\",\"awrap\",\"sync\",\"abrupt\",\"staleTime\",\"Infinity\",\"select\",\"map\",\"content\",\"localizeName\",\"createElement\",\"parseEmoji\",\"variant\",\"disabled\",\"onClick\",\"mutate\",\"data\",\"handleStatusDisabledModal\",\"handleCustomStatus\",\"concat\",\"fontScale\",\"mbe\",\"wordBreak\",\"style\",\"whiteSpace\",\"is\",\"color\",\"icon\"],\"mappings\":\"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\"}"}