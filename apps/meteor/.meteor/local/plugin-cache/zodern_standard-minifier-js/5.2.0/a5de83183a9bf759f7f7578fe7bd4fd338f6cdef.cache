{"code":"function module(e,n,t){t.link(\"@babel/runtime/regenerator\",{default:function(e){i=e}},0),t.export({useVoipItemsSection:function(){return g}}),t.link(\"@rocket.chat/fuselage\",{Box:function(e){r=e}},0),t.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch:function(e){o=e}},1),t.link(\"@rocket.chat/ui-voip\",{useVoipAPI:function(e){c=e},useVoipState:function(e){a=e}},2),t.link(\"@tanstack/react-query\",{useMutation:function(e){u=e}},3),t.link(\"react\",{default:function(e){s=e},useMemo:function(e){l=e}},4),t.link(\"react-i18next\",{useTranslation:function(e){f=e}},5);var i,r,o,c,a,u,s,l,f,g=function(){var e=f().t,n=o(),t=a(),g=t.clientError,d=t.isEnabled,p=t.isReady,k=t.isRegistered,m=c(),b=m.register,_=m.unregister,x=m.onRegisteredOnce,h=m.onUnregisteredOnce,v=u({mutationFn:function(){return i.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(k){e.next=4;break}return e.next=3,i.awrap(b());case 3:return e.abrupt(\"return\",!0);case 4:return e.next=6,i.awrap(_());case 6:return e.abrupt(\"return\",!1);case 7:case\"end\":return e.stop()}},null,null,null,Promise)},onSuccess:function(t){t?x(function(){return n({type:\"success\",message:e(\"Voice_calling_enabled\")})}):h(function(){return n({type:\"success\",message:e(\"Voice_calling_disabled\")})})},onError:function(){n({type:\"error\",message:e(\"Voice_calling_registration_failed\")})}}),y=l(function(){return g?e(g.message):!p||v.isLoading?e(\"Loading\"):\"\"},[g,p,v.isLoading,e]);return l(function(){if(d)return{items:[{id:\"toggle-voip\",icon:k?\"phone-disabled\":\"phone\",disabled:!p||v.isLoading,onClick:function(){return v.mutate()},content:s.createElement(r,{is:\"span\",title:y},k?e(\"Disable_voice_calling\"):e(\"Enable_voice_calling\"))}]}},[d,k,p,y,e,v])};t.exportDefault(g)}","map":"{\"version\":3,\"sources\":[\"client/NavBarV2/NavBarSettingsToolbar/UserMenu/hooks/useVoipItemsSection.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Box } from '@rocket.chat/fuselage';\\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\\nimport { useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport { useVoipAPI, useVoipState } from '@rocket.chat/ui-voip';\\nimport { useMutation } from '@tanstack/react-query';\\nimport React, { useMemo } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nexport const useVoipItemsSection = (): { items: GenericMenuItemProps[] } | undefined => {\\n\\tconst { t } = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst { clientError, isEnabled, isReady, isRegistered } = useVoipState();\\n\\tconst { register, unregister, onRegisteredOnce, onUnregisteredOnce } = useVoipAPI();\\n\\n\\tconst toggleVoip = useMutation({\\n\\t\\tmutationFn: async () => {\\n\\t\\t\\tif (!isRegistered) {\\n\\t\\t\\t\\tawait register();\\n\\t\\t\\t\\treturn true;\\n\\t\\t\\t}\\n\\n\\t\\t\\tawait unregister();\\n\\t\\t\\treturn false;\\n\\t\\t},\\n\\t\\tonSuccess: (isEnabled: boolean) => {\\n\\t\\t\\tif (isEnabled) {\\n\\t\\t\\t\\tonRegisteredOnce(() => dispatchToastMessage({ type: 'success', message: t('Voice_calling_enabled') }));\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tonUnregisteredOnce(() => dispatchToastMessage({ type: 'success', message: t('Voice_calling_disabled') }));\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\tonError: () => {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('Voice_calling_registration_failed') });\\n\\t\\t},\\n\\t});\\n\\n\\tconst tooltip = useMemo(() => {\\n\\t\\tif (clientError) {\\n\\t\\t\\treturn t(clientError.message);\\n\\t\\t}\\n\\n\\t\\tif (!isReady || toggleVoip.isLoading) {\\n\\t\\t\\treturn t('Loading');\\n\\t\\t}\\n\\n\\t\\treturn '';\\n\\t}, [clientError, isReady, toggleVoip.isLoading, t]);\\n\\n\\treturn useMemo(() => {\\n\\t\\tif (!isEnabled) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\treturn {\\n\\t\\t\\titems: [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\tid: 'toggle-voip',\\n\\t\\t\\t\\t\\ticon: isRegistered ? 'phone-disabled' : 'phone',\\n\\t\\t\\t\\t\\tdisabled: !isReady || toggleVoip.isLoading,\\n\\t\\t\\t\\t\\tonClick: () => toggleVoip.mutate(),\\n\\t\\t\\t\\t\\tcontent: (\\n\\t\\t\\t\\t\\t\\t<Box is='span' title={tooltip}>\\n\\t\\t\\t\\t\\t\\t\\t{isRegistered ? t('Disable_voice_calling') : t('Enable_voice_calling')}\\n\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t),\\n\\t\\t\\t\\t},\\n\\t\\t\\t],\\n\\t\\t};\\n\\t}, [isEnabled, isRegistered, isReady, tooltip, t, toggleVoip]);\\n};\\n\\nexport default useVoipItemsSection;\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"export\",\"useVoipItemsSection\",\"Box\",\"useToastMessageDispatch\",\"useVoipAPI\",\"useVoipState\",\"useMutation\",\"React\",\"useMemo\",\"useTranslation\",\"t\",\"_useTranslation\",\"dispatchToastMessage\",\"_useVoipState\",\"clientError\",\"isEnabled\",\"isReady\",\"isRegistered\",\"_useVoipAPI\",\"register\",\"unregister\",\"onRegisteredOnce\",\"onUnregisteredOnce\",\"toggleVoip\",\"mutationFn\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"abrupt\",\"stop\",\"Promise\",\"onSuccess\",\"type\",\"message\",\"onError\",\"tooltip\",\"isLoading\",\"items\",\"id\",\"icon\",\"disabled\",\"onClick\",\"mutate\",\"content\",\"createElement\",\"is\",\"title\",\"exportDefault\"],\"mappings\":\"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\"}"}