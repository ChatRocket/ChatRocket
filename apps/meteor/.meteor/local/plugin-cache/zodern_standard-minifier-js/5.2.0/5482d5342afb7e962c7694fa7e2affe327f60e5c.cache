{"code":"function module(e,t,i){let n,l,d,o,a;i.link(\"../../../client/lib/actionLinks\",{actionLinks(e){n=e}},0),i.link(\"../../../client/lib/toast\",{dispatchToastMessage(e){l=e}},1),i.link(\"../../models/client\",{ChatRoom(e){d=e}},2),i.link(\"../../utils/client/lib/SDKClient\",{sdk(e){o=e}},3),i.link(\"../../utils/lib/i18n\",{t(e){a=e}},4),n.register(\"joinLivechatWebRTCCall\",e=>{let t=d.findOne({_id:e.rid});if(!t)throw Error(\"Room not found\");let{callStatus:i,_id:n}=t;if(\"declined\"===i||\"ended\"===i){l({type:\"info\",message:a(\"Call_Already_Ended\")});return}window.open(\"/meet/\".concat(n),n)}),n.register(\"endLivechatWebRTCCall\",async e=>{let t=d.findOne({_id:e.rid});if(!t)throw Error(\"Room not found\");let{callStatus:i,_id:n}=t;if(\"declined\"===i||\"ended\"===i){l({type:\"info\",message:a(\"Call_Already_Ended\")});return}await o.rest.put(\"/v1/livechat/webrtc.call/\".concat(e._id),{rid:n,status:\"ended\"}),o.publish(\"notify-room\",[\"\".concat(n,\"/webrtc\"),\"callStatus\",{callStatus:\"ended\"}])})}","map":"{\"version\":3,\"sources\":[\"app/webrtc/client/actionLink.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IMessage } from '@rocket.chat/core-typings';\\n\\nimport { actionLinks } from '../../../client/lib/actionLinks';\\nimport { dispatchToastMessage } from '../../../client/lib/toast';\\nimport { ChatRoom } from '../../models/client';\\nimport { sdk } from '../../utils/client/lib/SDKClient';\\nimport { t } from '../../utils/lib/i18n';\\n\\nactionLinks.register('joinLivechatWebRTCCall', (message: IMessage) => {\\n\\tconst room = ChatRoom.findOne({ _id: message.rid });\\n\\tif (!room) {\\n\\t\\tthrow new Error('Room not found');\\n\\t}\\n\\tconst { callStatus, _id } = room;\\n\\tif (callStatus === 'declined' || callStatus === 'ended') {\\n\\t\\tdispatchToastMessage({ type: 'info', message: t('Call_Already_Ended') });\\n\\t\\treturn;\\n\\t}\\n\\twindow.open(`/meet/${_id}`, _id);\\n});\\n\\nactionLinks.register('endLivechatWebRTCCall', async (message: IMessage) => {\\n\\tconst room = ChatRoom.findOne({ _id: message.rid });\\n\\tif (!room) {\\n\\t\\tthrow new Error('Room not found');\\n\\t}\\n\\tconst { callStatus, _id } = room;\\n\\tif (callStatus === 'declined' || callStatus === 'ended') {\\n\\t\\tdispatchToastMessage({ type: 'info', message: t('Call_Already_Ended') });\\n\\t\\treturn;\\n\\t}\\n\\tawait sdk.rest.put(`/v1/livechat/webrtc.call/${message._id}`, { rid: _id, status: 'ended' });\\n\\tsdk.publish('notify-room', [`${_id}/webrtc`, 'callStatus', { callStatus: 'ended' }]);\\n});\\n\",null],\"names\":[\"actionLinks\",\"dispatchToastMessage\",\"ChatRoom\",\"sdk\",\"t\",\"module\",\"link\",\"v\",\"register\",\"message\",\"room\",\"findOne\",\"_id\",\"rid\",\"Error\",\"callStatus\",\"type\",\"window\",\"open\",\"concat\",\"rest\",\"put\",\"status\",\"publish\"],\"mappings\":\"2BAEAA,EAA8DC,EAAAC,EAAAC,EAAAC,EAArDC,EAAaC,IAAA,CAAM,kCAAkC,CAAAN,YAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,4BAAA,CAAAL,qBAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,sBAAA,CAAAJ,SAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,mCAAA,CAAAH,IAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,uBAAA,CAAAF,EAAAG,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,GAM9DP,EAAYQ,QAAQ,CAAC,yBAA2BC,IAC/C,IAAMC,EAAOR,EAASS,OAAO,CAAC,CAAEC,IAAKH,EAAQI,GAAAA,AAAG,GAChD,GAAI,CAACH,EACJ,MAAM,AAAII,MAAM,kBAEjB,GAAM,CAAEC,WAAAA,CAAU,CAAEH,IAAAA,CAAAA,CAAK,CAAGF,EAC5B,GAAIK,AAAe,aAAfA,GAA6BA,AAAe,UAAfA,EAAwB,CACxDd,EAAqB,CAAEe,KAAM,OAAQP,QAASL,EAAE,qBAAqB,GACrE,MACD,CACAa,OAAOC,IAAI,CAAA,SAAAC,MAAA,CAAUP,GAAOA,EAC7B,GAEAZ,EAAYQ,QAAQ,CAAC,wBAAyB,MAAOC,IACpD,IAAMC,EAAOR,EAASS,OAAO,CAAC,CAAEC,IAAKH,EAAQI,GAAAA,AAAG,GAChD,GAAI,CAACH,EACJ,MAAM,AAAII,MAAM,kBAEjB,GAAM,CAAEC,WAAAA,CAAU,CAAEH,IAAAA,CAAAA,CAAK,CAAGF,EAC5B,GAAIK,AAAe,aAAfA,GAA6BA,AAAe,UAAfA,EAAwB,CACxDd,EAAqB,CAAEe,KAAM,OAAQP,QAASL,EAAE,qBAAqB,GACrE,MACD,CACA,MAAMD,EAAIiB,IAAI,CAACC,GAAG,CAAA,4BAAAF,MAAA,CAA6BV,EAAQG,GAAG,EAAI,CAAEC,IAAKD,EAAKU,OAAQ,OAAO,GACzFnB,EAAIoB,OAAO,CAAC,cAAe,CAAA,GAAAJ,MAAA,CAAIP,EAAG,WAAW,aAAc,CAAEG,WAAY,OAAO,EAAG,CACpF\"}"}