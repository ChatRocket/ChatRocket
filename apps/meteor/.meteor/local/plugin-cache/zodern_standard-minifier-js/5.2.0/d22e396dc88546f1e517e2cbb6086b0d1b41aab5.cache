{"code":"function module(t,n,e){e.link(\"@babel/runtime/regenerator\",{default:function(t){o=t}},0),e.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(t){r=t}},1),e.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(t){a=t}},2),e.export({useStatusSection:function(){return h}}),e.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(t){i=t}},0),e.link(\"@tanstack/react-query\",{useQuery:function(t){l=t}},1),e.link(\"react\",{useMemo:function(t){s=t}},2),e.link(\"react-i18next\",{useTranslation:function(t){u=t}},3),e.link(\"../../../components/dashboards/periods\",{getPeriodRange:function(t){c=t}},4),e.link(\"../../../components/dashboards/usePeriodSelectorStorage\",{usePeriodSelectorStorage:function(t){d=t}},5),e.link(\"../components/constants\",{COLORS:function(t){p=t},PERIOD_OPTIONS:function(t){f=t}},6),e.link(\"../utils/formatPeriodDescription\",{formatPeriodDescription:function(t){b=t}},7),e.link(\"../utils/round\",{round:function(t){_=t}},8),e.link(\"./useDefaultDownload\",{useDefaultDownload:function(t){S=t}},9);var o,r,a,i,l,s,u,c,d,p,f,b,_,S,m={Open:{label:\"Omnichannel_Reports_Status_Open\",color:p.success},Queued:{label:\"Queued\",color:p.warning2},On_Hold:{label:\"On_Hold\",color:p.warning},Closed:{label:\"Omnichannel_Reports_Status_Closed\",color:p.danger}},v=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2?arguments[2]:void 0;return t.map(function(t){var o=m[t.label],r=n>0?_(t.value/n*100):0,i=e(o.label);return a(a({},t),{},{id:t.label,label:i+\" \"+t.value+\" (\"+r+\"%)\",rawLabel:i,color:o.color})})},h=function(){var t=u().t,n=d(\"reports-status-period\",f),e=r(n,2),p=e[0],_=e[1],m=i(\"GET\",\"/v1/livechat/analytics/dashboards/conversations-by-status\"),h=c(p),g=h.start,k=h.end,O=l([\"omnichannel-reports\",\"conversations-by-status\",p,t],function(){var n;return o.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.awrap(m({start:g.toISOString(),end:k.toISOString()}));case 2:return n=e.sent,e.abrupt(\"return\",a(a({},n),{},{data:v(n.data,n.total,t)}));case 4:case\"end\":return e.stop()}},null,null,null,Promise)},{refetchInterval:3e5}),y=O.data,P=(y=void 0===y?{data:[],total:0}:y).data,w=y.total,D=O.isLoading,R=O.isError,E=O.isSuccess,x=O.refetch,I=t(\"Conversations_by_status\"),C=t(\"__count__conversations__period__\",{count:null!=w?w:0,period:b(p,t)}),L=t(\"Omnichannel_Reports_Status_Empty_Subtitle\"),T=S({columnName:t(\"Status\"),title:I,data:P,period:p});return s(function(){return{id:\"conversations-by-status\",title:I,subtitle:C,emptyStateSubtitle:L,data:P,total:w,period:p,periodSelectorProps:_,downloadProps:T,isLoading:D,isError:R,isDataFound:E&&P.length>0,onRetry:x}},[I,C,L,P,w,p,_,T,D,R,E,x])}}","map":"{\"version\":3,\"sources\":[\"client/omnichannel/reports/hooks/useStatusSection.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { TranslationKey } from '@rocket.chat/ui-contexts';\\nimport { useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useQuery } from '@tanstack/react-query';\\nimport type { TFunction } from 'i18next';\\nimport { useMemo } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { getPeriodRange } from '../../../components/dashboards/periods';\\nimport { usePeriodSelectorStorage } from '../../../components/dashboards/usePeriodSelectorStorage';\\nimport { COLORS, PERIOD_OPTIONS } from '../components/constants';\\nimport { formatPeriodDescription } from '../utils/formatPeriodDescription';\\nimport { round } from '../utils/round';\\nimport { useDefaultDownload } from './useDefaultDownload';\\n\\nconst STATUSES: Record<string, { label: TranslationKey; color: string }> = {\\n\\tOpen: { label: 'Omnichannel_Reports_Status_Open', color: COLORS.success },\\n\\tQueued: { label: 'Queued', color: COLORS.warning2 },\\n\\tOn_Hold: { label: 'On_Hold', color: COLORS.warning },\\n\\tClosed: { label: 'Omnichannel_Reports_Status_Closed', color: COLORS.danger },\\n};\\n\\nconst formatChartData = (data: { label: string; value: number }[] | undefined = [], total = 0, t: TFunction) => {\\n\\treturn data.map((item) => {\\n\\t\\tconst status = STATUSES[item.label];\\n\\t\\tconst percentage = total > 0 ? round((item.value / total) * 100) : 0;\\n\\t\\tconst label = t(status.label);\\n\\t\\treturn {\\n\\t\\t\\t...item,\\n\\t\\t\\tid: item.label,\\n\\t\\t\\tlabel: `${label} ${item.value} (${percentage}%)`,\\n\\t\\t\\trawLabel: label,\\n\\t\\t\\tcolor: status.color,\\n\\t\\t};\\n\\t});\\n};\\n\\nexport const useStatusSection = () => {\\n\\tconst { t } = useTranslation();\\n\\tconst [period, periodSelectorProps] = usePeriodSelectorStorage('reports-status-period', PERIOD_OPTIONS);\\n\\tconst getConversationsByStatus = useEndpoint('GET', '/v1/livechat/analytics/dashboards/conversations-by-status');\\n\\tconst { start, end } = getPeriodRange(period);\\n\\n\\tconst {\\n\\t\\tdata: { data, total } = { data: [], total: 0 },\\n\\t\\tisLoading,\\n\\t\\tisError,\\n\\t\\tisSuccess,\\n\\t\\trefetch,\\n\\t} = useQuery(\\n\\t\\t['omnichannel-reports', 'conversations-by-status', period, t],\\n\\t\\tasync () => {\\n\\t\\t\\tconst response = await getConversationsByStatus({ start: start.toISOString(), end: end.toISOString() });\\n\\n\\t\\t\\treturn { ...response, data: formatChartData(response.data, response.total, t) };\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\trefetchInterval: 5 * 60 * 1000,\\n\\t\\t},\\n\\t);\\n\\n\\tconst title = t('Conversations_by_status');\\n\\tconst subtitle = t('__count__conversations__period__', {\\n\\t\\tcount: total ?? 0,\\n\\t\\tperiod: formatPeriodDescription(period, t),\\n\\t});\\n\\tconst emptyStateSubtitle = t('Omnichannel_Reports_Status_Empty_Subtitle');\\n\\n\\tconst downloadProps = useDefaultDownload({ columnName: t('Status'), title, data, period });\\n\\n\\treturn useMemo(\\n\\t\\t() => ({\\n\\t\\t\\tid: 'conversations-by-status',\\n\\t\\t\\ttitle,\\n\\t\\t\\tsubtitle,\\n\\t\\t\\temptyStateSubtitle,\\n\\t\\t\\tdata,\\n\\t\\t\\ttotal,\\n\\t\\t\\tperiod,\\n\\t\\t\\tperiodSelectorProps,\\n\\t\\t\\tdownloadProps,\\n\\t\\t\\tisLoading,\\n\\t\\t\\tisError,\\n\\t\\t\\tisDataFound: isSuccess && data.length > 0,\\n\\t\\t\\tonRetry: refetch,\\n\\t\\t}),\\n\\t\\t[title, subtitle, emptyStateSubtitle, data, total, period, periodSelectorProps, downloadProps, isLoading, isError, isSuccess, refetch],\\n\\t);\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"_slicedToArray\",\"_objectSpread\",\"export\",\"useStatusSection\",\"useEndpoint\",\"useQuery\",\"useMemo\",\"useTranslation\",\"getPeriodRange\",\"usePeriodSelectorStorage\",\"COLORS\",\"PERIOD_OPTIONS\",\"formatPeriodDescription\",\"round\",\"useDefaultDownload\",\"STATUSES\",\"Open\",\"label\",\"color\",\"success\",\"Queued\",\"warning2\",\"On_Hold\",\"warning\",\"Closed\",\"danger\",\"formatChartData\",\"data\",\"arguments\",\"length\",\"undefined\",\"total\",\"t\",\"map\",\"item\",\"status\",\"percentage\",\"value\",\"id\",\"rawLabel\",\"_useTranslation\",\"_usePeriodSelectorSto\",\"_usePeriodSelectorSto2\",\"period\",\"periodSelectorProps\",\"getConversationsByStatus\",\"_getPeriodRange\",\"start\",\"end\",\"_useQuery\",\"response\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"toISOString\",\"sent\",\"abrupt\",\"stop\",\"Promise\",\"refetchInterval\",\"_useQuery$data\",\"isLoading\",\"isError\",\"isSuccess\",\"refetch\",\"title\",\"subtitle\",\"count\",\"emptyStateSubtitle\",\"downloadProps\",\"columnName\",\"isDataFound\",\"onRetry\"],\"mappings\":\"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\"}"}