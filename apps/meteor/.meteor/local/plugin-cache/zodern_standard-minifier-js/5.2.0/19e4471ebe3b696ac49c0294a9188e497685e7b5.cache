{"code":"function module(e,i,l){let t,n,s,o,a,r,d,c;l.link(\"meteor/meteor\",{Meteor(e){t=e}},0),l.link(\"meteor/tracker\",{Tracker(e){n=e}},1),l.link(\"../../../../client/lib/toast\",{dispatchToastMessage(e){s=e}},2),l.link(\"../../../../client/lib/utils/callWithErrorHandling\",{callWithErrorHandling(e){o=e}},3),l.link(\"../../../models/client\",{Messages(e){a=e}},4),l.link(\"../../../settings/client\",{settings(e){r=e}},5),l.link(\"../../../ui-utils/client\",{MessageAction(e){d=e}},6),l.link(\"../../../utils/lib/i18n\",{t(e){c=e}},7),t.startup(()=>{n.autorun(()=>{if(!r.get(\"Threads_enabled\"))return d.removeButton(\"unfollow-message\");d.addButton({id:\"unfollow-message\",icon:\"bell-off\",label:\"Unfollow_message\",type:\"interaction\",context:[\"message\",\"message-mobile\",\"threads\",\"federated\",\"videoconf\",\"videoconf-threads\"],async action(e,i){let{message:l}=i;l&&(await o(\"unfollowMessage\",{mid:l._id}),s({type:\"success\",message:c(\"You_unfollowed_this_message\")}))},condition(e){let{message:{_id:i,tmid:l,replies:t=[]},user:n,context:s}=e;if(l||s){let e=a.findOne({_id:l||i},{fields:{replies:1}});e&&(t=e.replies||[])}return null!=n&&!!n._id&&t.includes(n._id)},order:2,group:\"menu\"})})})}","map":"{\"version\":3,\"sources\":[\"app/threads/client/messageAction/unfollow.ts\",\"<anon>\"],\"sourcesContent\":[\"import { Meteor } from 'meteor/meteor';\\nimport { Tracker } from 'meteor/tracker';\\n\\nimport { dispatchToastMessage } from '../../../../client/lib/toast';\\nimport { callWithErrorHandling } from '../../../../client/lib/utils/callWithErrorHandling';\\nimport { Messages } from '../../../models/client';\\nimport { settings } from '../../../settings/client';\\nimport { MessageAction } from '../../../ui-utils/client';\\nimport { t } from '../../../utils/lib/i18n';\\n\\nMeteor.startup(() => {\\n\\tTracker.autorun(() => {\\n\\t\\tif (!settings.get('Threads_enabled')) {\\n\\t\\t\\treturn MessageAction.removeButton('unfollow-message');\\n\\t\\t}\\n\\t\\tMessageAction.addButton({\\n\\t\\t\\tid: 'unfollow-message',\\n\\t\\t\\ticon: 'bell-off',\\n\\t\\t\\tlabel: 'Unfollow_message',\\n\\t\\t\\ttype: 'interaction',\\n\\t\\t\\tcontext: ['message', 'message-mobile', 'threads', 'federated', 'videoconf', 'videoconf-threads'],\\n\\t\\t\\tasync action(_, { message }) {\\n\\t\\t\\t\\tif (!message) {\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tawait callWithErrorHandling('unfollowMessage', { mid: message._id });\\n\\t\\t\\t\\tdispatchToastMessage({\\n\\t\\t\\t\\t\\ttype: 'success',\\n\\t\\t\\t\\t\\tmessage: t('You_unfollowed_this_message'),\\n\\t\\t\\t\\t});\\n\\t\\t\\t},\\n\\t\\t\\tcondition({ message: { _id, tmid, replies = [] }, user, context }) {\\n\\t\\t\\t\\tif (tmid || context) {\\n\\t\\t\\t\\t\\tconst parentMessage = Messages.findOne({ _id: tmid || _id }, { fields: { replies: 1 } });\\n\\t\\t\\t\\t\\tif (parentMessage) {\\n\\t\\t\\t\\t\\t\\treplies = parentMessage.replies || [];\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\treturn user?._id ? replies.includes(user._id) : false;\\n\\t\\t\\t},\\n\\t\\t\\torder: 2,\\n\\t\\t\\tgroup: 'menu',\\n\\t\\t});\\n\\t});\\n});\\n\",null],\"names\":[\"Meteor\",\"Tracker\",\"dispatchToastMessage\",\"callWithErrorHandling\",\"Messages\",\"settings\",\"MessageAction\",\"t\",\"module\",\"link\",\"v\",\"startup\",\"autorun\",\"get\",\"removeButton\",\"addButton\",\"id\",\"icon\",\"label\",\"type\",\"context\",\"action\",\"_\",\"_ref\",\"message\",\"mid\",\"_id\",\"condition\",\"_ref2\",\"tmid\",\"replies\",\"user\",\"parentMessage\",\"findOne\",\"fields\",\"includes\",\"order\",\"group\"],\"mappings\":\"2BAAAA,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAT,OAAAU,CAAA,EAAAV,EAAAU,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,iBAAA,CAAAR,QAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,+BAAA,CAAAP,qBAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,qDAAA,CAAAN,sBAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,yBAAA,CAAAL,SAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,2BAAA,CAAAJ,SAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,2BAAA,CAAAH,cAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,0BAAA,CAAAF,EAAAG,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,GAUvCV,EAAOW,OAAO,CAAC,KACdV,EAAQW,OAAO,CAAC,KACf,GAAI,CAACP,EAASQ,GAAG,CAAC,mBACjB,OAAOP,EAAcQ,YAAY,CAAC,oBAEnCR,EAAcS,SAAS,CAAC,CACvBC,GAAI,mBACJC,KAAM,WACNC,MAAO,mBACPC,KAAM,cACNC,QAAS,CAAC,UAAW,iBAAkB,UAAW,YAAa,YAAa,oBAAoB,CAChG,MAAMC,OAAOC,CAAC,CAAAC,CAAA,EAAa,GAAX,CAAEC,QAAAA,CAAAA,CAAS,CAAAD,EACrBC,IAIL,MAAMrB,EAAsB,kBAAmB,CAAEsB,IAAKD,EAAQE,GAAAA,AAAG,GACjExB,EAAqB,CACpBiB,KAAM,UACNK,QAASjB,EAAE,iCAEb,EACAoB,UAASC,CAAA,EAAwD,GAAvD,CAAEJ,QAAS,CAAEE,IAAAA,CAAG,CAAEG,KAAAA,CAAI,CAAEC,QAAAA,EAAU,EAAA,CAAI,CAAEC,KAAAA,CAAI,CAAEX,QAAAA,CAAAA,CAAS,CAAAQ,EAChE,GAAIC,GAAQT,EAAS,CACpB,IAAMY,EAAgB5B,EAAS6B,OAAO,CAAC,CAAEP,IAAKG,GAAQH,CAAG,EAAI,CAAEQ,OAAQ,CAAEJ,QAAS,CAAC,CAAE,GACjFE,GACHF,CAAAA,EAAUE,EAAcF,OAAO,EAAI,EAAE,AAAF,CAErC,CACA,OAAOC,MAAAA,KAAAA,EAAML,GAAG,EAAGI,EAAQK,QAAQ,CAACJ,EAAKL,GAAG,CAC7C,EACAU,MAAO,EACPC,MAAO,QAET,EACD\"}"}