{"code":"function module(e,n,t){var i,l,r,c,o,u,a,s,f,m,d,g,k,h,P,E,S,p,b,y,A,v,D,F,x,w,B,L,M,T,j=[\"highlights\",\"dontAskAgainList\"];t.link(\"@babel/runtime/regenerator\",{default:function(e){i=e}},0),t.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){l=e}},1),t.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default:function(e){r=e}},2),t.link(\"@rocket.chat/fuselage\",{ButtonGroup:function(e){c=e},Button:function(e){o=e},Box:function(e){u=e},Accordion:function(e){a=e}},0),t.link(\"@rocket.chat/fuselage-hooks\",{useUniqueId:function(e){s=e}},1),t.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch:function(e){f=e},useSetting:function(e){m=e},useTranslation:function(e){d=e},useEndpoint:function(e){g=e}},2),t.link(\"@tanstack/react-query\",{useMutation:function(e){k=e}},3),t.link(\"react\",{default:function(e){h=e}},4),t.link(\"react-hook-form\",{FormProvider:function(e){P=e},useForm:function(e){E=e}},5),t.link(\"../../../components/Page\",{Page:function(e){S=e},PageHeader:function(e){p=e},PageScrollableContentWithShadow:function(e){b=e},PageFooter:function(e){y=e}},6),t.link(\"../../../lib/getDirtyFields\",{getDirtyFields:function(e){A=e}},7),t.link(\"./PreferencesGlobalSection\",{default:function(e){v=e}},8),t.link(\"./PreferencesHighlightsSection\",{default:function(e){D=e}},9),t.link(\"./PreferencesLocalizationSection\",{default:function(e){F=e}},10),t.link(\"./PreferencesMessagesSection\",{default:function(e){x=e}},11),t.link(\"./PreferencesMyDataSection\",{default:function(e){w=e}},12),t.link(\"./PreferencesNotificationsSection\",{default:function(e){B=e}},13),t.link(\"./PreferencesSoundSection\",{default:function(e){L=e}},14),t.link(\"./PreferencesUserPresenceSection\",{default:function(e){M=e}},15),t.link(\"./useAccountPreferencesValues\",{useAccountPreferencesValues:function(e){T=e}},16),t.exportDefault(function(){var e=d(),n=f(),t=m(\"UserData_EnableDownload\"),C=T(),O=E({defaultValues:C}),U=O.handleSubmit,V=O.reset,W=O.watch,_=O.formState,q=_.isDirty,G=_.dirtyFields,H=W(),z=g(\"POST\",\"/v1/users.setPreferences\"),I=k({mutationFn:z,onSuccess:function(){n({type:\"success\",message:e(\"Preferences_saved\")})},onError:function(e){n({type:\"error\",message:e})},onSettled:function(){return V(H)}}),N=s();return h.createElement(S,null,h.createElement(p,{title:e(\"Preferences\")}),h.createElement(b,null,h.createElement(P,O,h.createElement(u,{id:N,is:\"form\",maxWidth:\"x600\",w:\"full\",alignSelf:\"center\",onSubmit:U(function(e){var n,t,c,o;return i.async(function(i){for(;;)switch(i.prev=i.next){case 0:t=(n=A(e,G)).highlights,c=n.dontAskAgainList,o=r(n,j),(t||\"\"===t)&&Object.assign(o,{highlights:\"string\"==typeof t&&t.split(/,|\\n/).map(function(e){return e.trim()}).filter(Boolean)}),c&&Object.assign(o,{dontAskAgainList:Array.isArray(c)&&c.length>0?c.map(function(e){var n=l(e,2);return{action:n[0],label:n[1]}}):[]}),I.mutateAsync({data:o});case 4:case\"end\":return i.stop()}},null,null,null,Promise)})},h.createElement(a,null,h.createElement(F,null),h.createElement(v,null),h.createElement(M,null),h.createElement(B,null),h.createElement(x,null),h.createElement(D,null),h.createElement(L,null),t&&h.createElement(w,null))))),h.createElement(y,{isDirty:q},h.createElement(c,null,h.createElement(o,{onClick:function(){return V(C)}},e(\"Cancel\")),h.createElement(o,{form:N,primary:!0,type:\"submit\"},e(\"Save_changes\")))))})}","map":"{\"version\":3,\"sources\":[\"client/views/account/preferences/AccountPreferencesPage.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { ButtonGroup, Button, Box, Accordion } from '@rocket.chat/fuselage';\\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\\nimport { useToastMessageDispatch, useSetting, useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useMutation } from '@tanstack/react-query';\\nimport type { ReactElement } from 'react';\\nimport React from 'react';\\nimport { FormProvider, useForm } from 'react-hook-form';\\n\\nimport { Page, PageHeader, PageScrollableContentWithShadow, PageFooter } from '../../../components/Page';\\nimport { getDirtyFields } from '../../../lib/getDirtyFields';\\nimport PreferencesGlobalSection from './PreferencesGlobalSection';\\nimport PreferencesHighlightsSection from './PreferencesHighlightsSection';\\nimport PreferencesLocalizationSection from './PreferencesLocalizationSection';\\nimport PreferencesMessagesSection from './PreferencesMessagesSection';\\nimport PreferencesMyDataSection from './PreferencesMyDataSection';\\nimport PreferencesNotificationsSection from './PreferencesNotificationsSection';\\nimport PreferencesSoundSection from './PreferencesSoundSection';\\nimport PreferencesUserPresenceSection from './PreferencesUserPresenceSection';\\nimport type { AccountPreferencesData } from './useAccountPreferencesValues';\\nimport { useAccountPreferencesValues } from './useAccountPreferencesValues';\\n\\nconst AccountPreferencesPage = (): ReactElement => {\\n\\tconst t = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst dataDownloadEnabled = useSetting('UserData_EnableDownload');\\n\\tconst preferencesValues = useAccountPreferencesValues();\\n\\n\\tconst methods = useForm({ defaultValues: preferencesValues });\\n\\tconst {\\n\\t\\thandleSubmit,\\n\\t\\treset,\\n\\t\\twatch,\\n\\t\\tformState: { isDirty, dirtyFields },\\n\\t} = methods;\\n\\n\\tconst currentData = watch();\\n\\n\\tconst setPreferencesEndpoint = useEndpoint('POST', '/v1/users.setPreferences');\\n\\tconst setPreferencesAction = useMutation({\\n\\t\\tmutationFn: setPreferencesEndpoint,\\n\\t\\tonSuccess: () => {\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Preferences_saved') });\\n\\t\\t},\\n\\t\\tonError: (error) => {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t},\\n\\t\\tonSettled: () => reset(currentData),\\n\\t});\\n\\n\\tconst handleSaveData = async (formData: AccountPreferencesData) => {\\n\\t\\tconst { highlights, dontAskAgainList, ...data } = getDirtyFields(formData, dirtyFields);\\n\\t\\tif (highlights || highlights === '') {\\n\\t\\t\\tObject.assign(data, {\\n\\t\\t\\t\\thighlights:\\n\\t\\t\\t\\t\\ttypeof highlights === 'string' &&\\n\\t\\t\\t\\t\\thighlights\\n\\t\\t\\t\\t\\t\\t.split(/,|\\\\n/)\\n\\t\\t\\t\\t\\t\\t.map((val) => val.trim())\\n\\t\\t\\t\\t\\t\\t.filter(Boolean),\\n\\t\\t\\t});\\n\\t\\t}\\n\\n\\t\\tif (dontAskAgainList) {\\n\\t\\t\\tconst list =\\n\\t\\t\\t\\tArray.isArray(dontAskAgainList) && dontAskAgainList.length > 0\\n\\t\\t\\t\\t\\t? dontAskAgainList.map(([action, label]) => ({ action, label }))\\n\\t\\t\\t\\t\\t: [];\\n\\t\\t\\tObject.assign(data, { dontAskAgainList: list });\\n\\t\\t}\\n\\n\\t\\tsetPreferencesAction.mutateAsync({ data });\\n\\t};\\n\\n\\tconst preferencesFormId = useUniqueId();\\n\\n\\treturn (\\n\\t\\t<Page>\\n\\t\\t\\t<PageHeader title={t('Preferences')} />\\n\\t\\t\\t<PageScrollableContentWithShadow>\\n\\t\\t\\t\\t<FormProvider {...methods}>\\n\\t\\t\\t\\t\\t<Box id={preferencesFormId} is='form' maxWidth='x600' w='full' alignSelf='center' onSubmit={handleSubmit(handleSaveData)}>\\n\\t\\t\\t\\t\\t\\t<Accordion>\\n\\t\\t\\t\\t\\t\\t\\t<PreferencesLocalizationSection />\\n\\t\\t\\t\\t\\t\\t\\t<PreferencesGlobalSection />\\n\\t\\t\\t\\t\\t\\t\\t<PreferencesUserPresenceSection />\\n\\t\\t\\t\\t\\t\\t\\t<PreferencesNotificationsSection />\\n\\t\\t\\t\\t\\t\\t\\t<PreferencesMessagesSection />\\n\\t\\t\\t\\t\\t\\t\\t<PreferencesHighlightsSection />\\n\\t\\t\\t\\t\\t\\t\\t<PreferencesSoundSection />\\n\\t\\t\\t\\t\\t\\t\\t{dataDownloadEnabled && <PreferencesMyDataSection />}\\n\\t\\t\\t\\t\\t\\t</Accordion>\\n\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t</FormProvider>\\n\\t\\t\\t</PageScrollableContentWithShadow>\\n\\t\\t\\t<PageFooter isDirty={isDirty}>\\n\\t\\t\\t\\t<ButtonGroup>\\n\\t\\t\\t\\t\\t<Button onClick={() => reset(preferencesValues)}>{t('Cancel')}</Button>\\n\\t\\t\\t\\t\\t<Button form={preferencesFormId} primary type='submit'>\\n\\t\\t\\t\\t\\t\\t{t('Save_changes')}\\n\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t</ButtonGroup>\\n\\t\\t\\t</PageFooter>\\n\\t\\t</Page>\\n\\t);\\n};\\n\\nexport default AccountPreferencesPage;\\n\",null],\"names\":[\"_regeneratorRuntime\",\"_slicedToArray\",\"_objectWithoutProperties\",\"ButtonGroup\",\"Button\",\"Box\",\"Accordion\",\"useUniqueId\",\"useToastMessageDispatch\",\"useSetting\",\"useTranslation\",\"useEndpoint\",\"useMutation\",\"React\",\"FormProvider\",\"useForm\",\"Page\",\"PageHeader\",\"PageScrollableContentWithShadow\",\"PageFooter\",\"getDirtyFields\",\"PreferencesGlobalSection\",\"PreferencesHighlightsSection\",\"PreferencesLocalizationSection\",\"PreferencesMessagesSection\",\"PreferencesMyDataSection\",\"PreferencesNotificationsSection\",\"PreferencesSoundSection\",\"PreferencesUserPresenceSection\",\"useAccountPreferencesValues\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"t\",\"dispatchToastMessage\",\"dataDownloadEnabled\",\"preferencesValues\",\"methods\",\"defaultValues\",\"handleSubmit\",\"reset\",\"watch\",\"_methods$formState\",\"formState\",\"isDirty\",\"dirtyFields\",\"currentData\",\"setPreferencesEndpoint\",\"setPreferencesAction\",\"mutationFn\",\"onSuccess\",\"type\",\"message\",\"onError\",\"error\",\"onSettled\",\"preferencesFormId\",\"createElement\",\"title\",\"id\",\"is\",\"maxWidth\",\"w\",\"alignSelf\",\"onSubmit\",\"formData\",\"_getDirtyFields\",\"highlights\",\"dontAskAgainList\",\"data\",\"async\",\"_context\",\"prev\",\"next\",\"_excluded\",\"Object\",\"assign\",\"split\",\"map\",\"val\",\"trim\",\"filter\",\"Boolean\",\"Array\",\"isArray\",\"length\",\"_ref\",\"_ref2\",\"action\",\"label\",\"mutateAsync\",\"stop\",\"Promise\",\"onClick\",\"form\",\"primary\"],\"mappings\":\"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\"}"}