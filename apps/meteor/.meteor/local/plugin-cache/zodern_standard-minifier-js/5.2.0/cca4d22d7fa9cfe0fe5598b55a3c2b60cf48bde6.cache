{"code":"function module(e,n,t){var r,o,l,a,c,i,u,s,d,f,m,p,v,k,x,b,g,_;t.link(\"@babel/runtime/regenerator\",{default:function(e){r=e}},0),t.link(\"@rocket.chat/fuselage\",{Box:function(e){o=e},ButtonGroup:function(e){l=e},Button:function(e){a=e},Margins:function(e){c=e}},0),t.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback:function(e){i=e}},1),t.link(\"@rocket.chat/ui-contexts\",{useSetModal:function(e){u=e},useToastMessageDispatch:function(e){s=e},useRoute:function(e){d=e},useEndpoint:function(e){f=e}},2),t.link(\"react\",{default:function(e){m=e}},3),t.link(\"react-hook-form\",{FormProvider:function(e){p=e},useForm:function(e){v=e}},4),t.link(\"react-i18next\",{useTranslation:function(e){k=e}},5),t.link(\"../../../components/Contextualbar\",{ContextualbarFooter:function(e){x=e},ContextualbarScrollableContent:function(e){b=e}},6),t.link(\"../../../components/GenericModal\",{default:function(e){g=e}},7),t.link(\"./RoleForm\",{default:function(e){_=e}},8),t.exportDefault(function(e){var n=e.role,t=e.isEnterprise,h=k().t,E=s(),y=u(),C=d(\"admin-permissions\"),S=d(\"admin-permissions\"),D=f(\"POST\",\"/v1/roles.create\"),P=f(\"POST\",\"/v1/roles.update\"),w=f(\"POST\",\"/v1/roles.delete\"),T=v({defaultValues:{roleId:null==n?void 0:n._id,name:null==n?void 0:n.name,description:null==n?void 0:n.description,scope:(null==n?void 0:n.scope)||\"Users\",mandatory2fa:!!(null!=n&&n.mandatory2fa)}}),F=i(function(){null!=n&&n._id&&C.push({context:\"users-in-role\",_id:n._id})}),M=i(function(e){return r.async(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!e.roleId){n.next=6;break}return n.next=4,r.awrap(P(e));case 4:return E({type:\"success\",message:h(\"Saved\")}),n.abrupt(\"return\",S.push({}));case 6:return n.next=8,r.awrap(D(e));case 8:E({type:\"success\",message:h(\"Saved\")}),S.push({}),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(0),E({type:\"error\",message:n.t0});case 15:case\"end\":return n.stop()}},null,null,[[0,12]],Promise)}),R=i(function(){var e,o;return r.async(function(l){for(;;)switch(l.prev=l.next){case 0:if(null!=n&&n._id){l.next=2;break}return l.abrupt(\"return\");case 2:e=function e(){return r.async(function e(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.awrap(w({roleId:n._id}));case 3:E({type:\"success\",message:h(\"Role_removed\")}),y(),S.push({}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),E({type:\"error\",message:e.t0}),y();case 12:case\"end\":return e.stop()}},null,null,[[0,8]],Promise)},o=t?h(\"Delete_Role_Warning\"):h(\"Delete_Role_Warning_Not_Enterprise\"),y(m.createElement(g,{variant:\"danger\",onConfirm:e,onClose:function(){return y()},onCancel:function(){return y()},confirmText:h(\"Delete\")},o));case 5:case\"end\":return l.stop()}},null,null,null,Promise)});return m.createElement(m.Fragment,null,m.createElement(b,null,m.createElement(o,{w:\"full\",alignSelf:\"center\",mb:\"neg-x8\"},m.createElement(c,{block:8},m.createElement(p,T,m.createElement(_,{editing:!!(null==n?void 0:n._id),isProtected:null==n?void 0:n.protected,isDisabled:!t}))))),m.createElement(x,null,m.createElement(l,{vertical:!0,stretch:!0},m.createElement(a,{primary:!0,disabled:!T.formState.isDirty||!t,onClick:T.handleSubmit(M)},h(\"Save\")),!(null!=n&&n.protected)&&(null==n?void 0:n._id)&&m.createElement(a,{secondary:!0,danger:!0,onClick:R},h(\"Delete\")),(null==n?void 0:n._id)&&m.createElement(a,{onClick:F},h(\"Users_in_role\")))))})}","map":"{\"version\":3,\"sources\":[\"client/views/admin/permissions/EditRolePage.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IRole } from '@rocket.chat/core-typings';\\nimport { Box, ButtonGroup, Button, Margins } from '@rocket.chat/fuselage';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useSetModal, useToastMessageDispatch, useRoute, useEndpoint } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement } from 'react';\\nimport React from 'react';\\nimport { FormProvider, useForm } from 'react-hook-form';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { ContextualbarFooter, ContextualbarScrollableContent } from '../../../components/Contextualbar';\\nimport GenericModal from '../../../components/GenericModal';\\nimport RoleForm from './RoleForm';\\n\\nconst EditRolePage = ({ role, isEnterprise }: { role?: IRole; isEnterprise: boolean }): ReactElement => {\\n\\tconst { t } = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst setModal = useSetModal();\\n\\tconst usersInRoleRouter = useRoute('admin-permissions');\\n\\tconst router = useRoute('admin-permissions');\\n\\n\\tconst createRole = useEndpoint('POST', '/v1/roles.create');\\n\\tconst updateRole = useEndpoint('POST', '/v1/roles.update');\\n\\tconst deleteRole = useEndpoint('POST', '/v1/roles.delete');\\n\\n\\tconst methods = useForm({\\n\\t\\tdefaultValues: {\\n\\t\\t\\troleId: role?._id,\\n\\t\\t\\tname: role?.name,\\n\\t\\t\\tdescription: role?.description,\\n\\t\\t\\tscope: role?.scope || 'Users',\\n\\t\\t\\tmandatory2fa: !!role?.mandatory2fa,\\n\\t\\t},\\n\\t});\\n\\n\\tconst handleManageUsers = useMutableCallback(() => {\\n\\t\\tif (role?._id) {\\n\\t\\t\\tusersInRoleRouter.push({\\n\\t\\t\\t\\tcontext: 'users-in-role',\\n\\t\\t\\t\\t_id: role._id,\\n\\t\\t\\t});\\n\\t\\t}\\n\\t});\\n\\n\\tconst handleSave = useMutableCallback(async (data) => {\\n\\t\\ttry {\\n\\t\\t\\tif (data.roleId) {\\n\\t\\t\\t\\tawait updateRole(data);\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Saved') });\\n\\t\\t\\t\\treturn router.push({});\\n\\t\\t\\t}\\n\\n\\t\\t\\tawait createRole(data);\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Saved') });\\n\\t\\t\\trouter.push({});\\n\\t\\t} catch (error) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t}\\n\\t});\\n\\n\\tconst handleDelete = useMutableCallback(async () => {\\n\\t\\tif (!role?._id) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tconst deleteRoleAction = async (): Promise<void> => {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tawait deleteRole({ roleId: role._id });\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Role_removed') });\\n\\t\\t\\t\\tsetModal();\\n\\n\\t\\t\\t\\trouter.push({});\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t\\tsetModal();\\n\\t\\t\\t}\\n\\t\\t};\\n\\n\\t\\tconst deleteRoleMessage = isEnterprise ? t('Delete_Role_Warning') : t('Delete_Role_Warning_Not_Enterprise');\\n\\n\\t\\tsetModal(\\n\\t\\t\\t<GenericModal\\n\\t\\t\\t\\tvariant='danger'\\n\\t\\t\\t\\tonConfirm={deleteRoleAction}\\n\\t\\t\\t\\tonClose={(): void => setModal()}\\n\\t\\t\\t\\tonCancel={(): void => setModal()}\\n\\t\\t\\t\\tconfirmText={t('Delete')}\\n\\t\\t\\t>\\n\\t\\t\\t\\t{deleteRoleMessage}\\n\\t\\t\\t</GenericModal>,\\n\\t\\t);\\n\\t});\\n\\n\\treturn (\\n\\t\\t<>\\n\\t\\t\\t<ContextualbarScrollableContent>\\n\\t\\t\\t\\t<Box w='full' alignSelf='center' mb='neg-x8'>\\n\\t\\t\\t\\t\\t<Margins block={8}>\\n\\t\\t\\t\\t\\t\\t<FormProvider {...methods}>\\n\\t\\t\\t\\t\\t\\t\\t<RoleForm editing={Boolean(role?._id)} isProtected={role?.protected} isDisabled={!isEnterprise} />\\n\\t\\t\\t\\t\\t\\t</FormProvider>\\n\\t\\t\\t\\t\\t</Margins>\\n\\t\\t\\t\\t</Box>\\n\\t\\t\\t</ContextualbarScrollableContent>\\n\\t\\t\\t<ContextualbarFooter>\\n\\t\\t\\t\\t<ButtonGroup vertical stretch>\\n\\t\\t\\t\\t\\t<Button primary disabled={!methods.formState.isDirty || !isEnterprise} onClick={methods.handleSubmit(handleSave)}>\\n\\t\\t\\t\\t\\t\\t{t('Save')}\\n\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t{!role?.protected && role?._id && (\\n\\t\\t\\t\\t\\t\\t<Button secondary danger onClick={handleDelete}>\\n\\t\\t\\t\\t\\t\\t\\t{t('Delete')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t{role?._id && <Button onClick={handleManageUsers}>{t('Users_in_role')}</Button>}\\n\\t\\t\\t\\t</ButtonGroup>\\n\\t\\t\\t</ContextualbarFooter>\\n\\t\\t</>\\n\\t);\\n};\\n\\nexport default EditRolePage;\\n\",null],\"names\":[\"_regeneratorRuntime\",\"Box\",\"ButtonGroup\",\"Button\",\"Margins\",\"useMutableCallback\",\"useSetModal\",\"useToastMessageDispatch\",\"useRoute\",\"useEndpoint\",\"React\",\"FormProvider\",\"useForm\",\"useTranslation\",\"ContextualbarFooter\",\"ContextualbarScrollableContent\",\"GenericModal\",\"RoleForm\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"role\",\"isEnterprise\",\"t\",\"_useTranslation\",\"dispatchToastMessage\",\"setModal\",\"usersInRoleRouter\",\"router\",\"createRole\",\"updateRole\",\"deleteRole\",\"methods\",\"defaultValues\",\"roleId\",\"_id\",\"name\",\"description\",\"scope\",\"mandatory2fa\",\"handleManageUsers\",\"push\",\"context\",\"handleSave\",\"data\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"type\",\"message\",\"abrupt\",\"t0\",\"stop\",\"Promise\",\"handleDelete\",\"deleteRoleAction\",\"deleteRoleMessage\",\"_context3\",\"_callee2\",\"_callee2$\",\"_context2\",\"createElement\",\"variant\",\"onConfirm\",\"onClose\",\"onCancel\",\"confirmText\",\"Fragment\",\"w\",\"alignSelf\",\"mb\",\"block\",\"editing\",\"Boolean\",\"isProtected\",\"protected\",\"isDisabled\",\"vertical\",\"stretch\",\"primary\",\"disabled\",\"formState\",\"isDirty\",\"onClick\",\"handleSubmit\",\"secondary\",\"danger\"],\"mappings\":\"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\"}"}