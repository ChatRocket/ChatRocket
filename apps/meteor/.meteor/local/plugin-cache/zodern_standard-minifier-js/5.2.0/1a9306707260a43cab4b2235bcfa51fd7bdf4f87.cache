{"code":"function module(t,n,e){e.link(\"@babel/runtime/regenerator\",{default:function(t){o=t}},0),e.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(t){r=t}},1),e.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(t){a=t}},2),e.export({useDepartmentsSection:function(){return v}}),e.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(t){i=t}},0),e.link(\"@tanstack/react-query\",{useQuery:function(t){s=t}},1),e.link(\"react\",{useMemo:function(t){u=t}},2),e.link(\"react-i18next\",{useTranslation:function(t){c=t}},3),e.link(\"../../../components/dashboards/periods\",{getPeriodRange:function(t){d=t}},4),e.link(\"../../../components/dashboards/usePeriodSelectorStorage\",{usePeriodSelectorStorage:function(t){l=t}},5),e.link(\"../components/constants\",{COLORS:function(t){p=t},PERIOD_OPTIONS:function(t){f=t}},6),e.link(\"../utils/formatPeriodDescription\",{formatPeriodDescription:function(t){m=t}},7),e.link(\"./useDefaultDownload\",{useDefaultDownload:function(t){_=t}},8);var o,r,a,i,s,u,c,d,l,p,f,m,_,b=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map(function(t){return a(a({},t),{},{color:p.info})})},v=function(){var t,n=c().t,e=l(\"reports-department-period\",f),p=r(e,2),v=p[0],S=p[1],h=i(\"GET\",\"/v1/livechat/analytics/dashboards/conversations-by-department\"),k=s([\"omnichannel-reports\",\"conversations-by-department\",v],function(){var t,n,e,r;return o.async(function(i){for(;;)switch(i.prev=i.next){case 0:return n=(t=d(v)).start,e=t.end,i.next=3,o.awrap(h({start:n.toISOString(),end:e.toISOString()}));case 3:return r=i.sent,i.abrupt(\"return\",a(a({},r),{},{data:b(r.data)}));case 5:case\"end\":return i.stop()}},null,null,null,Promise)},{refetchInterval:3e5}),g=k.data,y=(g=void 0===g?{data:[],total:0}:g).data,D=g.total,P=void 0===D?0:D,O=g.unspecified,w=void 0===O?0:O,E=k.isLoading,x=k.isError,I=k.isSuccess,R=k.refetch,T=n(\"Conversations_by_department\"),L=n(\"__departments__departments_and__count__conversations__period__\",{departments:null!==(t=y.length)&&void 0!==t?t:0,count:P,period:m(v,n)})+\" \"+(w>0?\"(\"+n(\"__count__without__department__\",{count:w})+\")\":\"\"),C=n(\"Omnichannel_Reports_Departments_Empty_Subtitle\"),N=_({columnName:n(\"Departments\"),title:T,data:y,period:v});return u(function(){return{id:\"conversations-by-department\",title:T,subtitle:L,emptyStateSubtitle:C,data:y,total:P,isLoading:E,isError:x,isDataFound:I&&y.length>0,periodSelectorProps:S,period:v,downloadProps:N,onRetry:R}},[T,L,C,y,P,E,x,I,S,v,N,R])}}","map":"{\"version\":3,\"sources\":[\"client/omnichannel/reports/hooks/useDepartmentsSection.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useQuery } from '@tanstack/react-query';\\nimport { useMemo } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { getPeriodRange } from '../../../components/dashboards/periods';\\nimport { usePeriodSelectorStorage } from '../../../components/dashboards/usePeriodSelectorStorage';\\nimport { COLORS, PERIOD_OPTIONS } from '../components/constants';\\nimport { formatPeriodDescription } from '../utils/formatPeriodDescription';\\nimport { useDefaultDownload } from './useDefaultDownload';\\n\\nconst formatChartData = (data: { label: string; value: number }[] | undefined = []) =>\\n\\tdata.map((item) => ({\\n\\t\\t...item,\\n\\t\\tcolor: COLORS.info,\\n\\t}));\\n\\nexport const useDepartmentsSection = () => {\\n\\tconst { t } = useTranslation();\\n\\tconst [period, periodSelectorProps] = usePeriodSelectorStorage('reports-department-period', PERIOD_OPTIONS);\\n\\tconst getConversationsByDepartment = useEndpoint('GET', '/v1/livechat/analytics/dashboards/conversations-by-department');\\n\\n\\tconst {\\n\\t\\tdata: { data, total = 0, unspecified = 0 } = { data: [], total: 0 },\\n\\t\\tisLoading,\\n\\t\\tisError,\\n\\t\\tisSuccess,\\n\\t\\trefetch,\\n\\t} = useQuery(\\n\\t\\t['omnichannel-reports', 'conversations-by-department', period],\\n\\t\\tasync () => {\\n\\t\\t\\tconst { start, end } = getPeriodRange(period);\\n\\t\\t\\tconst response = await getConversationsByDepartment({ start: start.toISOString(), end: end.toISOString() });\\n\\t\\t\\treturn { ...response, data: formatChartData(response.data) };\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\trefetchInterval: 5 * 60 * 1000,\\n\\t\\t},\\n\\t);\\n\\n\\tconst title = t('Conversations_by_department');\\n\\tconst subtitleTotals = t('__departments__departments_and__count__conversations__period__', {\\n\\t\\tdepartments: data.length ?? 0,\\n\\t\\tcount: total,\\n\\t\\tperiod: formatPeriodDescription(period, t),\\n\\t});\\n\\tconst subtitleUnspecified = unspecified > 0 ? `(${t('__count__without__department__', { count: unspecified })})` : '';\\n\\tconst subtitle = `${subtitleTotals} ${subtitleUnspecified}`;\\n\\tconst emptyStateSubtitle = t('Omnichannel_Reports_Departments_Empty_Subtitle');\\n\\n\\tconst downloadProps = useDefaultDownload({ columnName: t('Departments'), title, data, period });\\n\\n\\treturn useMemo(\\n\\t\\t() => ({\\n\\t\\t\\tid: 'conversations-by-department',\\n\\t\\t\\ttitle,\\n\\t\\t\\tsubtitle,\\n\\t\\t\\temptyStateSubtitle,\\n\\t\\t\\tdata,\\n\\t\\t\\ttotal,\\n\\t\\t\\tisLoading,\\n\\t\\t\\tisError,\\n\\t\\t\\tisDataFound: isSuccess && data.length > 0,\\n\\t\\t\\tperiodSelectorProps,\\n\\t\\t\\tperiod,\\n\\t\\t\\tdownloadProps,\\n\\t\\t\\tonRetry: refetch,\\n\\t\\t}),\\n\\t\\t[title, subtitle, emptyStateSubtitle, data, total, isLoading, isError, isSuccess, periodSelectorProps, period, downloadProps, refetch],\\n\\t);\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"_slicedToArray\",\"_objectSpread\",\"export\",\"useDepartmentsSection\",\"useEndpoint\",\"useQuery\",\"useMemo\",\"useTranslation\",\"getPeriodRange\",\"usePeriodSelectorStorage\",\"COLORS\",\"PERIOD_OPTIONS\",\"formatPeriodDescription\",\"useDefaultDownload\",\"formatChartData\",\"data\",\"arguments\",\"length\",\"undefined\",\"map\",\"item\",\"color\",\"info\",\"_data$length\",\"t\",\"_useTranslation\",\"_usePeriodSelectorSto\",\"_usePeriodSelectorSto2\",\"period\",\"periodSelectorProps\",\"getConversationsByDepartment\",\"_useQuery\",\"_getPeriodRange\",\"start\",\"end\",\"response\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"toISOString\",\"sent\",\"abrupt\",\"stop\",\"Promise\",\"refetchInterval\",\"_useQuery$data\",\"total\",\"_useQuery$data$total\",\"_useQuery$data$unspec\",\"unspecified\",\"isLoading\",\"isError\",\"isSuccess\",\"refetch\",\"title\",\"subtitle\",\"subtitleTotals\",\"departments\",\"count\",\"emptyStateSubtitle\",\"downloadProps\",\"columnName\",\"id\",\"isDataFound\",\"onRetry\"],\"mappings\":\"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\"}"}