{"code":"function module(t,e,r){let n,a,l,s,p;r.export({useMarketplaceActions:()=>u}),r.link(\"@tanstack/react-query\",{useMutation(t){n=t}},0),r.link(\"../helpers/handleAPIError\",{handleAPIError(t){a=t}},1),r.link(\"../helpers/warnAppInstall\",{warnAppInstall(t){l=t}},2),r.link(\"../helpers/warnStatusChange\",{warnStatusChange(t){s=t}},3),r.link(\"./useAppsOrchestration\",{useAppsOrchestration(t){p=t}},4);let u=()=>{let t=p();if(!t)throw Error(\"Apps orchestrator is not available\");let e=n(e=>{let{id:r,marketplaceVersion:n,permissionsGranted:a}=e;return t.installApp(r,n,a)},{onSuccess:(t,e)=>{let{status:r}=t,{name:n}=e;r&&l(n,r)},onError:t=>{a(t)}}),r=n(e=>{let{id:r,marketplaceVersion:n,permissionsGranted:a}=e;return t.updateApp(r,n,a)},{onSuccess:(t,e)=>{let{status:r}=t,{name:n}=e;r&&s(n,r)},onError:t=>{a(t)}});return{purchase:e.mutateAsync,install:e.mutateAsync,update:r.mutateAsync}}}","map":"{\"version\":3,\"sources\":[\"client/views/marketplace/hooks/useMarketplaceActions.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { App, AppPermission } from '@rocket.chat/core-typings';\\nimport { useMutation } from '@tanstack/react-query';\\n\\nimport { handleAPIError } from '../helpers/handleAPIError';\\nimport { warnAppInstall } from '../helpers/warnAppInstall';\\nimport { warnStatusChange } from '../helpers/warnStatusChange';\\nimport { useAppsOrchestration } from './useAppsOrchestration';\\n\\ntype InstallAppParams = App & {\\n\\tpermissionsGranted?: AppPermission[];\\n};\\n\\ntype UpdateAppParams = App & {\\n\\tpermissionsGranted?: AppPermission[];\\n};\\n\\nexport const useMarketplaceActions = () => {\\n\\tconst appsOrchestrator = useAppsOrchestration();\\n\\n\\tif (!appsOrchestrator) {\\n\\t\\tthrow new Error('Apps orchestrator is not available');\\n\\t}\\n\\n\\tconst installAppMutation = useMutation(\\n\\t\\t({ id, marketplaceVersion, permissionsGranted }: InstallAppParams) =>\\n\\t\\t\\tappsOrchestrator.installApp(id, marketplaceVersion, permissionsGranted),\\n\\t\\t{\\n\\t\\t\\tonSuccess: ({ status }, { name }) => {\\n\\t\\t\\t\\tif (!status) return;\\n\\t\\t\\t\\twarnAppInstall(name, status);\\n\\t\\t\\t},\\n\\t\\t\\tonError: (error) => {\\n\\t\\t\\t\\thandleAPIError(error);\\n\\t\\t\\t},\\n\\t\\t},\\n\\t);\\n\\n\\tconst updateAppMutation = useMutation(\\n\\t\\t({ id, marketplaceVersion, permissionsGranted }: UpdateAppParams) =>\\n\\t\\t\\tappsOrchestrator.updateApp(id, marketplaceVersion, permissionsGranted),\\n\\t\\t{\\n\\t\\t\\tonSuccess: ({ status }, { name }) => {\\n\\t\\t\\t\\tif (!status) return;\\n\\t\\t\\t\\twarnStatusChange(name, status);\\n\\t\\t\\t},\\n\\t\\t\\tonError: (error) => {\\n\\t\\t\\t\\thandleAPIError(error);\\n\\t\\t\\t},\\n\\t\\t},\\n\\t);\\n\\n\\treturn {\\n\\t\\tpurchase: installAppMutation.mutateAsync,\\n\\t\\tinstall: installAppMutation.mutateAsync,\\n\\t\\tupdate: updateAppMutation.mutateAsync,\\n\\t} as const;\\n};\\n\",null],\"names\":[\"useMutation\",\"handleAPIError\",\"warnAppInstall\",\"warnStatusChange\",\"useAppsOrchestration\",\"module\",\"export\",\"useMarketplaceActions\",\"link\",\"v\",\"appsOrchestrator\",\"Error\",\"installAppMutation\",\"_ref\",\"id\",\"marketplaceVersion\",\"permissionsGranted\",\"installApp\",\"onSuccess\",\"_ref2\",\"_ref3\",\"status\",\"name\",\"onError\",\"error\",\"updateAppMutation\",\"_ref4\",\"updateApp\",\"_ref5\",\"_ref6\",\"purchase\",\"mutateAsync\",\"install\",\"update\"],\"mappings\":\"2BACoDA,EAAAC,EAAAC,EAAAC,EAAAC,EAApDC,EAAOC,MAAE,CAAA,CAAAC,sBAAmBA,IAAAA,CAAwB,GAAAF,EAAAG,IAAA,CAAA,wBAAA,CAAAR,YAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,4BAAA,CAAAP,eAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,4BAAA,CAAAN,eAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,8BAAA,CAAAL,iBAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,yBAAA,CAAAJ,qBAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAe7C,IAAMF,EAAwBA,KACpC,IAAMG,EAAmBN,IAEzB,GAAI,CAACM,EACJ,MAAM,AAAIC,MAAM,sCAGjB,IAAMC,EAAqBZ,EAC1Ba,IAAA,GAAC,CAAEC,GAAAA,CAAE,CAAEC,mBAAAA,CAAkB,CAAEC,mBAAAA,CAAAA,CAAsC,CAAAH,EAAA,OAChEH,EAAiBO,UAAU,CAACH,EAAIC,EAAoBC,EAAmB,EACxE,CACCE,UAAWA,CAAAC,EAAAC,KAAyB,GAAxB,CAAEC,OAAAA,CAAAA,CAAQ,CAAAF,EAAE,CAAEG,KAAAA,CAAAA,CAAM,CAAAF,EAC1BC,GACLnB,EAAeoB,EAAMD,EACtB,EACAE,QAAUC,IACTvB,EAAeuB,EAChB,IAIIC,EAAoBzB,EACzB0B,IAAA,GAAC,CAAEZ,GAAAA,CAAE,CAAEC,mBAAAA,CAAkB,CAAEC,mBAAAA,CAAAA,CAAqC,CAAAU,EAAA,OAC/DhB,EAAiBiB,SAAS,CAACb,EAAIC,EAAoBC,EAAmB,EACvE,CACCE,UAAWA,CAAAU,EAAAC,KAAyB,GAAxB,CAAER,OAAAA,CAAAA,CAAQ,CAAAO,EAAE,CAAEN,KAAAA,CAAAA,CAAM,CAAAO,EAC1BR,GACLlB,EAAiBmB,EAAMD,EACxB,EACAE,QAAUC,IACTvB,EAAeuB,EAChB,IAIF,MAAO,CACNM,SAAUlB,EAAmBmB,WAAW,CACxCC,QAASpB,EAAmBmB,WAAW,CACvCE,OAAQR,EAAkBM,WAAAA,CAE5B\"}"}