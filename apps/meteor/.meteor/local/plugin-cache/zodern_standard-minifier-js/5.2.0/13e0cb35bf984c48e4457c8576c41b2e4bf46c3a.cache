{"code":"function module(e,a,t){let l,n,r,s,u,i,c,h,f,o,d;let p=[\"params\",\"reloadRef\"];t.link(\"@babel/runtime/helpers/extends\",{default(e){l=e}},0),t.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default(e){n=e}},1),t.link(\"react\",{default(e){r=e},useRef(e){s=e},useEffect(e){u=e}},0),t.link(\"react-i18next\",{useTranslation(e){i=e}},1),t.link(\"../../../../../app/livechat/client/lib/chartHandler\",{drawDoughnutChart(e){c=e}},2),t.link(\"../../../../hooks/useAsyncState\",{AsyncStatePhase(e){h=e}},3),t.link(\"../../../../hooks/useEndpointData\",{useEndpointData(e){f=e}},4),t.link(\"./Chart\",{default(e){o=e}},5),t.link(\"./useUpdateChartData\",{useUpdateChartData(e){d=e}},6);let b=[\"Available\",\"Away\",\"Busy\",\"Offline\"],k={available:0,away:0,busy:0,offline:0},y=(e,a,t)=>c(e,t(\"Agents\"),a,b.map(e=>t(e)),Object.values(k));t.exportDefault(e=>{let{params:a,reloadRef:t}=e,c=n(e,p),{t:b}=i(),v=s(null),A=s(),D=d({context:A,canvas:v,t:b,init:y}),{value:m,phase:E,reload:w}=f(\"/v1/livechat/analytics/dashboards/charts/agents-status\",{params:a});t.current.agentStatusChart=w;let{offline:C=0,available:g=0,away:O=0,busy:R=0}=null!=m?m:k;return u(()=>{let e=async()=>{v.current&&(A.current=await y(v.current,A.current,b))};e()},[b]),u(()=>{E===h.RESOLVED&&(D(b(\"Offline\"),[C]),D(b(\"Available\"),[g]),D(b(\"Away\"),[O]),D(b(\"Busy\"),[R]))},[g,O,R,C,E,b,D]),r.createElement(o,l({canvasRef:v},c))})}","map":"{\"version\":3,\"sources\":[\"client/views/omnichannel/realTimeMonitoring/charts/AgentStatusChart.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { Box } from '@rocket.chat/fuselage';\\nimport type { OperationParams } from '@rocket.chat/rest-typings';\\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\\nimport type * as chartjs from 'chart.js';\\nimport type { TFunction } from 'i18next';\\nimport type { ComponentPropsWithoutRef, MutableRefObject } from 'react';\\nimport React, { useRef, useEffect } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { drawDoughnutChart } from '../../../../../app/livechat/client/lib/chartHandler';\\nimport { AsyncStatePhase } from '../../../../hooks/useAsyncState';\\nimport { useEndpointData } from '../../../../hooks/useEndpointData';\\nimport Chart from './Chart';\\nimport { useUpdateChartData } from './useUpdateChartData';\\n\\nconst labels = ['Available', 'Away', 'Busy', 'Offline'];\\n\\nconst initialData = {\\n\\tavailable: 0,\\n\\taway: 0,\\n\\tbusy: 0,\\n\\toffline: 0,\\n};\\n\\nconst init = (canvas: HTMLCanvasElement, context: chartjs.Chart<'doughnut'> | undefined, t: TFunction) =>\\n\\tdrawDoughnutChart(\\n\\t\\tcanvas,\\n\\t\\tt('Agents'),\\n\\t\\tcontext,\\n\\t\\tlabels.map((l) => t(l as TranslationKey)),\\n\\t\\tObject.values(initialData),\\n\\t);\\n\\ntype AgentStatusChartsProps = {\\n\\tparams: OperationParams<'GET', '/v1/livechat/analytics/dashboards/charts/agents-status'>;\\n\\treloadRef: MutableRefObject<{ [x: string]: () => void }>;\\n} & Omit<ComponentPropsWithoutRef<typeof Box>, 'data'>;\\n\\nconst AgentStatusChart = ({ params, reloadRef, ...props }: AgentStatusChartsProps) => {\\n\\tconst { t } = useTranslation();\\n\\n\\tconst canvas: MutableRefObject<HTMLCanvasElement | null> = useRef(null);\\n\\tconst context: MutableRefObject<chartjs.Chart<'doughnut'> | undefined> = useRef();\\n\\n\\tconst updateChartData = useUpdateChartData({\\n\\t\\tcontext,\\n\\t\\tcanvas,\\n\\t\\tt,\\n\\t\\tinit,\\n\\t});\\n\\n\\tconst { value: data, phase: state, reload } = useEndpointData('/v1/livechat/analytics/dashboards/charts/agents-status', { params });\\n\\n\\treloadRef.current.agentStatusChart = reload;\\n\\n\\tconst { offline = 0, available = 0, away = 0, busy = 0 } = data ?? initialData;\\n\\n\\tuseEffect(() => {\\n\\t\\tconst initChart = async () => {\\n\\t\\t\\tif (!canvas.current) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tcontext.current = await init(canvas.current, context.current, t);\\n\\t\\t};\\n\\t\\tinitChart();\\n\\t}, [t]);\\n\\n\\tuseEffect(() => {\\n\\t\\tif (state === AsyncStatePhase.RESOLVED) {\\n\\t\\t\\tupdateChartData(t('Offline'), [offline]);\\n\\t\\t\\tupdateChartData(t('Available'), [available]);\\n\\t\\t\\tupdateChartData(t('Away'), [away]);\\n\\t\\t\\tupdateChartData(t('Busy'), [busy]);\\n\\t\\t}\\n\\t}, [available, away, busy, offline, state, t, updateChartData]);\\n\\n\\treturn <Chart canvasRef={canvas} {...props} />;\\n};\\n\\nexport default AgentStatusChart;\\n\",null],\"names\":[\"_extends\",\"_objectWithoutProperties\",\"React\",\"useRef\",\"useEffect\",\"useTranslation\",\"drawDoughnutChart\",\"AsyncStatePhase\",\"useEndpointData\",\"Chart\",\"useUpdateChartData\",\"module\",\"link\",\"default\",\"v\",\"labels\",\"initialData\",\"available\",\"away\",\"busy\",\"offline\",\"init\",\"canvas\",\"context\",\"t\",\"map\",\"l\",\"Object\",\"values\",\"exportDefault\",\"_ref\",\"params\",\"reloadRef\",\"props\",\"_excluded\",\"updateChartData\",\"value\",\"data\",\"phase\",\"state\",\"reload\",\"current\",\"agentStatusChart\",\"initChart\",\"RESOLVED\",\"createElement\",\"canvasRef\"],\"mappings\":\"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\"}"}