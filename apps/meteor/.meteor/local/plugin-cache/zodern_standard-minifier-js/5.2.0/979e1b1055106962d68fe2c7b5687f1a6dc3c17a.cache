{"code":"function module(e,o,t){let n,i;t.export({openCASLoginPopup:()=>d}),t.link(\"meteor/meteor\",{Meteor(e){n=e}},0),t.link(\"../../app/settings/client\",{settings(e){i=e}},1);let r=(e,o,t)=>{var n,i,r,l;let c=null!==(n=window.screenX)&&void 0!==n?n:window.screenLeft,d=null!==(i=window.screenY)&&void 0!==i?i:window.screenTop,s=null!==(r=window.outerWidth)&&void 0!==r?r:document.body.clientWidth,u=null!==(l=window.outerHeight)&&void 0!==l?l:document.body.clientHeight-22,a=d+(u-t)/2,w=\"width=\".concat(o,\",height=\").concat(t,\",left=\").concat(c+(s-o)/2,\",top=\").concat(a,\",scrollbars=yes\"),p=window.open(e,\"Login\",w);if(!p)throw Error(\"Could not open popup\");return p.focus(),p},l=e=>{let o=i.get(\"CAS_login_url\");if(!o)throw Error(\"CAS_login_url not set\");let t=n.absoluteUrl().replace(/\\/$/,\"\")+__meteor_runtime_config__.ROOT_URL_PATH_PREFIX,r=\"\".concat(t,\"/_cas/\").concat(e),l=new URL(o);return l.searchParams.set(\"service\",r),l.href},c=e=>new Promise(o=>{let t=setInterval(()=>{(e.closed||void 0===e.closed)&&(clearInterval(t),o())},100)}),d=async e=>{let o=i.get(\"CAS_popup_width\")||800,t=i.get(\"CAS_popup_height\")||600,n=l(e),d=r(n,o,t);await c(d)}}","map":"{\"version\":3,\"sources\":[\"client/lib/openCASLoginPopup.ts\",\"<anon>\"],\"sourcesContent\":[\"import { Meteor } from 'meteor/meteor';\\n\\nimport { settings } from '../../app/settings/client';\\n\\nconst openCenteredPopup = (url: string, width: number, height: number) => {\\n\\tconst screenX = window.screenX ?? window.screenLeft;\\n\\tconst screenY = window.screenY ?? window.screenTop;\\n\\tconst outerWidth = window.outerWidth ?? document.body.clientWidth;\\n\\tconst outerHeight = window.outerHeight ?? document.body.clientHeight - 22;\\n\\t// XXX what is the 22? Probably the height of the title bar.\\n\\t// Use `outerWidth - width` and `outerHeight - height` for help in\\n\\t// positioning the popup centered relative to the current window\\n\\tconst left = screenX + (outerWidth - width) / 2;\\n\\tconst top = screenY + (outerHeight - height) / 2;\\n\\tconst features = `width=${width},height=${height},left=${left},top=${top},scrollbars=yes`;\\n\\n\\tconst newwindow = window.open(url, 'Login', features);\\n\\n\\tif (!newwindow) {\\n\\t\\tthrow new Error('Could not open popup');\\n\\t}\\n\\n\\tnewwindow.focus();\\n\\n\\treturn newwindow;\\n};\\n\\nconst getPopupUrl = (credentialToken: string): string => {\\n\\tconst loginUrl = settings.get<string | undefined>('CAS_login_url');\\n\\n\\tif (!loginUrl) {\\n\\t\\tthrow new Error('CAS_login_url not set');\\n\\t}\\n\\n\\tconst appUrl = Meteor.absoluteUrl().replace(/\\\\/$/, '') + __meteor_runtime_config__.ROOT_URL_PATH_PREFIX;\\n\\tconst serviceUrl = `${appUrl}/_cas/${credentialToken}`;\\n\\tconst url = new URL(loginUrl);\\n\\turl.searchParams.set('service', serviceUrl);\\n\\n\\treturn url.href;\\n};\\n\\nconst waitForPopupClose = (popup: Window) => {\\n\\treturn new Promise<void>((resolve) => {\\n\\t\\tconst checkPopupOpen = setInterval(() => {\\n\\t\\t\\tif (popup.closed || popup.closed === undefined) {\\n\\t\\t\\t\\tclearInterval(checkPopupOpen);\\n\\t\\t\\t\\tresolve();\\n\\t\\t\\t}\\n\\t\\t}, 100);\\n\\t});\\n};\\n\\nexport const openCASLoginPopup = async (credentialToken: string) => {\\n\\tconst popupWidth = settings.get<number>('CAS_popup_width') || 800;\\n\\tconst popupHeight = settings.get<number>('CAS_popup_height') || 600;\\n\\n\\tconst popupUrl = getPopupUrl(credentialToken);\\n\\tconst popup = openCenteredPopup(popupUrl, popupWidth, popupHeight);\\n\\n\\tawait waitForPopupClose(popup);\\n};\\n\",null],\"names\":[\"Meteor\",\"settings\",\"module\",\"export\",\"openCASLoginPopup\",\"link\",\"v\",\"openCenteredPopup\",\"url\",\"width\",\"height\",\"_window$screenX\",\"_window$screenY\",\"_window$outerWidth\",\"_window$outerHeight\",\"screenX\",\"window\",\"screenLeft\",\"screenY\",\"screenTop\",\"outerWidth\",\"document\",\"body\",\"clientWidth\",\"outerHeight\",\"clientHeight\",\"top\",\"features\",\"concat\",\"newwindow\",\"open\",\"Error\",\"focus\",\"getPopupUrl\",\"credentialToken\",\"loginUrl\",\"get\",\"appUrl\",\"absoluteUrl\",\"replace\",\"__meteor_runtime_config__\",\"ROOT_URL_PATH_PREFIX\",\"serviceUrl\",\"URL\",\"searchParams\",\"set\",\"href\",\"waitForPopupClose\",\"popup\",\"Promise\",\"resolve\",\"checkPopupOpen\",\"setInterval\",\"closed\",\"undefined\",\"clearInterval\",\"popupWidth\",\"popupHeight\",\"popupUrl\"],\"mappings\":\"2BAAuCA,EAAAC,EAAvCC,EAAOC,MAAE,CAAA,CAAMC,kBAAQA,IAAAA,CAAgB,GAAAF,EAAAG,IAAA,CAAA,gBAAA,CAAAL,OAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,4BAAA,CAAAJ,SAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAIvC,IAAMC,EAAoBA,CAACC,EAAaC,EAAeC,KAAkB,IAAAC,EAAAC,EAAAC,EAAAC,EACxE,IAAMC,EAAO,AAAiB,OAAjBJ,CAAAA,EAAGK,OAAOD,OAAO,AAAPA,GAAOJ,AAAA,KAAA,IAAAA,EAAAA,EAAIK,OAAOC,UAAU,CAC7CC,EAAO,AAAiB,OAAjBN,CAAAA,EAAGI,OAAOE,OAAO,AAAPA,GAAON,AAAA,KAAA,IAAAA,EAAAA,EAAII,OAAOG,SAAS,CAC5CC,EAAU,AAAoB,OAApBP,CAAAA,EAAGG,OAAOI,UAAU,AAAVA,GAAUP,AAAA,KAAA,IAAAA,EAAAA,EAAIQ,SAASC,IAAI,CAACC,WAAW,CAC3DC,EAAW,AAAqB,OAArBV,CAAAA,EAAGE,OAAOQ,WAAW,AAAXA,GAAWV,AAAA,KAAA,IAAAA,EAAAA,EAAIO,SAASC,IAAI,CAACG,YAAY,CAAG,GAKjEC,EAAMR,EAAU,AAACM,CAAAA,EAAcd,CAAAA,EAAU,EACzCiB,EAAQ,SAAAC,MAAA,CAAYnB,EAAK,YAAAmB,MAAA,CAAWlB,EAAM,UAAAkB,MAAA,CAFnCb,EAAU,AAACK,CAAAA,EAAaX,CAAAA,EAAS,EAEe,SAAAmB,MAAA,CAAQF,EAAG,mBAElEG,EAAYb,OAAOc,IAAI,CAACtB,EAAK,QAASmB,GAE5C,GAAI,CAACE,EACJ,MAAM,AAAIE,MAAM,wBAKjB,OAFAF,EAAUG,KAAK,GAERH,CACR,EAEMI,EAAeC,IACpB,IAAMC,EAAWlC,EAASmC,GAAG,CAAqB,iBAElD,GAAI,CAACD,EACJ,MAAM,AAAIJ,MAAM,yBAGjB,IAAMM,EAASrC,EAAOsC,WAAW,GAAGC,OAAO,CAAC,MAAO,IAAMC,0BAA0BC,oBAAoB,CACjGC,EAAU,GAAAd,MAAA,CAAMS,EAAM,UAAAT,MAAA,CAASM,GAC/B1B,EAAM,IAAImC,IAAIR,GAGpB,OAFA3B,EAAIoC,YAAY,CAACC,GAAG,CAAC,UAAWH,GAEzBlC,EAAIsC,IAAI,AAChB,EAEMC,EAAqBC,GACnB,IAAIC,QAAeC,IACzB,IAAMC,EAAiBC,YAAY,KAC9BJ,CAAAA,EAAMK,MAAM,EAAIL,AAAiBM,KAAAA,IAAjBN,EAAMK,MAAM,AAAKC,IACpCC,cAAcJ,GACdD,IAEF,EAAG,IACJ,GAGY9C,EAAoB,MAAO8B,IACvC,IAAMsB,EAAavD,EAASmC,GAAG,CAAS,oBAAsB,IACxDqB,EAAcxD,EAASmC,GAAG,CAAS,qBAAuB,IAE1DsB,EAAWzB,EAAYC,GACvBc,EAAQzC,EAAkBmD,EAAUF,EAAYC,EAEtD,OAAMV,EAAkBC,EACzB\"}"}