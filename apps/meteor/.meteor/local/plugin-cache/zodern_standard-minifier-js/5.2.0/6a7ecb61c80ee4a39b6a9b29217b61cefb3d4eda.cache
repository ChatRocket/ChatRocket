{"code":"function module(t,e,n){var o,a,i,u,l,c,r,s,f,d,k,m,b,h,E,C,p,_;n.link(\"@babel/runtime/helpers/extends\",{default:function(t){o=t}},0),n.link(\"@rocket.chat/fuselage\",{ButtonGroup:function(t){a=t},Button:function(t){i=t}},0),n.link(\"@rocket.chat/ui-contexts\",{useTranslation:function(t){u=t},useUserPreference:function(t){l=t},useEndpoint:function(t){c=t},useToastMessageDispatch:function(t){r=t}},1),n.link(\"react\",{default:function(t){s=t},useCallback:function(t){f=t}},2),n.link(\"../../../components/Contextualbar\",{ContextualbarHeader:function(t){d=t},ContextualbarIcon:function(t){k=t},ContextualbarTitle:function(t){m=t},ContextualbarClose:function(t){b=t},ContextualbarContent:function(t){h=t},ContextualbarFooter:function(t){E=t}},3),n.link(\"../hooks/useOutlookAuthentication\",{useOutlookAuthentication:function(t){C=t},useOutlookAuthenticationMutationLogout:function(t){p=t}},4),n.link(\"./OutlookSettingItem\",{default:function(t){_=t}},5),n.exportDefault(function(t){var e=t.onClose,n=t.changeRoute,g=u(),x=r(),v=c(\"POST\",\"/v1/users.setPreferences\"),O=l(\"notifyCalendarEvents\"),y=C().authEnabled,T=p(),P=f(function(t){try{v({data:{notifyCalendarEvents:t}}),x({type:\"success\",message:g(\"Preferences_saved\")})}catch(t){x({type:\"error\",message:t})}},[v,x,g]),A=[{id:\"notification\",title:g(\"Event_notifications\"),subTitle:g(\"Event_notifications_description\"),enabled:O,handleEnable:P},{id:\"authentication\",title:g(\"Outlook_authentication\"),subTitle:g(\"Outlook_authentication_description\"),enabled:y,handleEnable:function(){return T.mutate(void 0,{onSuccess:n})}}];return s.createElement(s.Fragment,null,s.createElement(d,null,s.createElement(k,{name:\"calendar\"}),s.createElement(m,null,g(\"Outlook_calendar_settings\")),s.createElement(b,{onClick:e})),s.createElement(h,{paddingInline:0,color:\"default\"},A.map(function(t,e){if(\"authentication\"!==t.id||t.enabled)return s.createElement(_,o({key:e},t))})),s.createElement(E,null,s.createElement(a,{stretch:!0},s.createElement(i,{onClick:n},g(\"Back_to_calendar\")))))})}","map":"{\"version\":3,\"sources\":[\"client/views/outlookCalendar/OutlookSettingsList/OutlookSettingsList.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { ButtonGroup, Button } from '@rocket.chat/fuselage';\\nimport { useTranslation, useUserPreference, useEndpoint, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement } from 'react';\\nimport React, { useCallback } from 'react';\\n\\nimport {\\n\\tContextualbarHeader,\\n\\tContextualbarIcon,\\n\\tContextualbarTitle,\\n\\tContextualbarClose,\\n\\tContextualbarContent,\\n\\tContextualbarFooter,\\n} from '../../../components/Contextualbar';\\nimport { useOutlookAuthentication, useOutlookAuthenticationMutationLogout } from '../hooks/useOutlookAuthentication';\\nimport OutlookSettingItem from './OutlookSettingItem';\\n\\ntype OutlookSettingsListProps = {\\n\\tonClose: () => void;\\n\\tchangeRoute: () => void;\\n};\\n\\nconst OutlookSettingsList = ({ onClose, changeRoute }: OutlookSettingsListProps): ReactElement => {\\n\\tconst t = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst saveUserPreferences = useEndpoint('POST', '/v1/users.setPreferences');\\n\\tconst notifyCalendarEvents = useUserPreference('notifyCalendarEvents') as boolean;\\n\\tconst { authEnabled } = useOutlookAuthentication();\\n\\tconst handleDisableAuth = useOutlookAuthenticationMutationLogout();\\n\\n\\tconst handleNotifyCalendarEvents = useCallback(\\n\\t\\t(value: boolean) => {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tsaveUserPreferences({ data: { notifyCalendarEvents: value } });\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Preferences_saved') });\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t[saveUserPreferences, dispatchToastMessage, t],\\n\\t);\\n\\n\\tconst calendarSettings = [\\n\\t\\t{\\n\\t\\t\\tid: 'notification',\\n\\t\\t\\ttitle: t('Event_notifications'),\\n\\t\\t\\tsubTitle: t('Event_notifications_description'),\\n\\t\\t\\tenabled: notifyCalendarEvents,\\n\\t\\t\\thandleEnable: handleNotifyCalendarEvents,\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\tid: 'authentication',\\n\\t\\t\\ttitle: t('Outlook_authentication'),\\n\\t\\t\\tsubTitle: t('Outlook_authentication_description'),\\n\\t\\t\\tenabled: authEnabled,\\n\\t\\t\\thandleEnable: () =>\\n\\t\\t\\t\\thandleDisableAuth.mutate(undefined, {\\n\\t\\t\\t\\t\\tonSuccess: changeRoute,\\n\\t\\t\\t\\t}),\\n\\t\\t},\\n\\t];\\n\\n\\treturn (\\n\\t\\t<>\\n\\t\\t\\t<ContextualbarHeader>\\n\\t\\t\\t\\t<ContextualbarIcon name='calendar' />\\n\\t\\t\\t\\t<ContextualbarTitle>{t('Outlook_calendar_settings')}</ContextualbarTitle>\\n\\t\\t\\t\\t<ContextualbarClose onClick={onClose} />\\n\\t\\t\\t</ContextualbarHeader>\\n\\t\\t\\t<ContextualbarContent paddingInline={0} color='default'>\\n\\t\\t\\t\\t{calendarSettings.map((setting, index) => {\\n\\t\\t\\t\\t\\tif (setting.id === 'authentication' && !setting.enabled) {\\n\\t\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\treturn <OutlookSettingItem key={index} {...setting} />;\\n\\t\\t\\t\\t})}\\n\\t\\t\\t</ContextualbarContent>\\n\\t\\t\\t<ContextualbarFooter>\\n\\t\\t\\t\\t<ButtonGroup stretch>\\n\\t\\t\\t\\t\\t<Button onClick={changeRoute}>{t('Back_to_calendar')}</Button>\\n\\t\\t\\t\\t</ButtonGroup>\\n\\t\\t\\t</ContextualbarFooter>\\n\\t\\t</>\\n\\t);\\n};\\n\\nexport default OutlookSettingsList;\\n\",null],\"names\":[\"_extends\",\"ButtonGroup\",\"Button\",\"useTranslation\",\"useUserPreference\",\"useEndpoint\",\"useToastMessageDispatch\",\"React\",\"useCallback\",\"ContextualbarHeader\",\"ContextualbarIcon\",\"ContextualbarTitle\",\"ContextualbarClose\",\"ContextualbarContent\",\"ContextualbarFooter\",\"useOutlookAuthentication\",\"useOutlookAuthenticationMutationLogout\",\"OutlookSettingItem\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"onClose\",\"changeRoute\",\"t\",\"dispatchToastMessage\",\"saveUserPreferences\",\"notifyCalendarEvents\",\"authEnabled\",\"_useOutlookAuthentica\",\"handleDisableAuth\",\"handleNotifyCalendarEvents\",\"value\",\"data\",\"type\",\"message\",\"error\",\"calendarSettings\",\"id\",\"title\",\"subTitle\",\"enabled\",\"handleEnable\",\"mutate\",\"undefined\",\"onSuccess\",\"createElement\",\"Fragment\",\"name\",\"onClick\",\"paddingInline\",\"color\",\"map\",\"setting\",\"index\",\"key\",\"stretch\"],\"mappings\":\"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\"}"}