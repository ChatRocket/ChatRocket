{"code":"function module(e,t,n){n.link(\"@babel/runtime/regenerator\",{default:function(e){l=e}},0),n.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(e){i=e}},1),n.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){a=e}},2),n.export({useAgentsList:function(){return p}}),n.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(e){o=e}},0),n.link(\"react\",{useCallback:function(e){u=e},useState:function(e){r=e}},1),n.link(\"react-i18next\",{useTranslation:function(e){s=e}},2),n.link(\"../../../hooks/lists/useScrollableRecordList\",{useScrollableRecordList:function(e){c=e}},3),n.link(\"../../../hooks/useComponentDidUpdate\",{useComponentDidUpdate:function(e){d=e}},4),n.link(\"../../../lib/lists/RecordList\",{RecordList:function(e){f=e}},5);var l,i,a,o,u,r,s,c,d,f,p=function(e){var t=s().t,n=r(function(){return new f}),p=a(n,2),m=p[0],b=p[1],v=u(function(){return b(new f)},[]),h=o(\"GET\",\"/v1/livechat/users/agent\"),k=e.text,A=e.onlyAvailable,_=void 0!==A&&A,g=e.showIdleAgents,w=void 0===g||g,x=e.excludeId,I=e.haveAll,C=e.haveNoAgentsSelectedOption;d(function(){e&&v()},[e,v]);var L=u(function(e,n){var a,o,u,r;return l.async(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,l.awrap(h(i(i(i({},k&&{text:k}),x&&{excludeId:x}),{},{showIdleAgents:w,onlyAvailable:_,offset:e,count:n+e,sort:'{ \"name\": 1 }'})));case 2:return o=(a=s.sent).users,u=a.total,r=o.map(function(e){return{_updatedAt:new Date(e._updatedAt),label:(e.name||e._id)+\" (@\"+e.username+\")\",value:e._id,_id:e._id}}),I&&r.unshift({label:t(\"All\"),value:\"all\",_updatedAt:new Date,_id:\"all\"}),C&&r.unshift({label:t(\"Empty_no_agent_selected\"),value:\"no-agent-selected\",_updatedAt:new Date,_id:\"no-agent-selected\"}),s.abrupt(\"return\",{items:r,itemCount:u+1});case 9:case\"end\":return s.stop()}},null,null,null,Promise)},[x,h,I,C,_,w,t,k]),y=c(m,L,25);return{reload:v,itemsList:m,loadMoreItems:y.loadMoreItems,initialItemCount:y.initialItemCount}}}","map":"{\"version\":3,\"sources\":[\"client/components/Omnichannel/hooks/useAgentsList.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useCallback, useState } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { useScrollableRecordList } from '../../../hooks/lists/useScrollableRecordList';\\nimport { useComponentDidUpdate } from '../../../hooks/useComponentDidUpdate';\\nimport { RecordList } from '../../../lib/lists/RecordList';\\n\\ntype AgentsListOptions = {\\n\\ttext: string;\\n\\thaveAll: boolean;\\n\\thaveNoAgentsSelectedOption: boolean;\\n\\texcludeId?: string;\\n\\tshowIdleAgents?: boolean;\\n\\tonlyAvailable?: boolean;\\n};\\n\\ntype AgentOption = { value: string; label: string; _updatedAt: Date; _id: string };\\n\\nexport const useAgentsList = (\\n\\toptions: AgentsListOptions,\\n): {\\n\\titemsList: RecordList<AgentOption>;\\n\\tinitialItemCount: number;\\n\\treload: () => void;\\n\\tloadMoreItems: (start: number, end: number) => void;\\n} => {\\n\\tconst { t } = useTranslation();\\n\\tconst [itemsList, setItemsList] = useState(() => new RecordList<AgentOption>());\\n\\tconst reload = useCallback(() => setItemsList(new RecordList<AgentOption>()), []);\\n\\n\\tconst getAgents = useEndpoint('GET', '/v1/livechat/users/agent');\\n\\tconst { text, onlyAvailable = false, showIdleAgents = true, excludeId, haveAll, haveNoAgentsSelectedOption } = options;\\n\\n\\tuseComponentDidUpdate(() => {\\n\\t\\toptions && reload();\\n\\t}, [options, reload]);\\n\\n\\tconst fetchData = useCallback(\\n\\t\\tasync (start, end) => {\\n\\t\\t\\tconst { users: agents, total } = await getAgents({\\n\\t\\t\\t\\t...(text && { text }),\\n\\t\\t\\t\\t...(excludeId && { excludeId }),\\n\\t\\t\\t\\tshowIdleAgents,\\n\\t\\t\\t\\tonlyAvailable,\\n\\t\\t\\t\\toffset: start,\\n\\t\\t\\t\\tcount: end + start,\\n\\t\\t\\t\\tsort: `{ \\\"name\\\": 1 }`,\\n\\t\\t\\t});\\n\\n\\t\\t\\tconst items = agents.map<AgentOption>((agent) => {\\n\\t\\t\\t\\tconst agentOption = {\\n\\t\\t\\t\\t\\t_updatedAt: new Date(agent._updatedAt),\\n\\t\\t\\t\\t\\tlabel: `${agent.name || agent._id} (@${agent.username})`,\\n\\t\\t\\t\\t\\tvalue: agent._id,\\n\\t\\t\\t\\t\\t_id: agent._id,\\n\\t\\t\\t\\t};\\n\\t\\t\\t\\treturn agentOption;\\n\\t\\t\\t});\\n\\n\\t\\t\\thaveAll &&\\n\\t\\t\\t\\titems.unshift({\\n\\t\\t\\t\\t\\tlabel: t('All'),\\n\\t\\t\\t\\t\\tvalue: 'all',\\n\\t\\t\\t\\t\\t_updatedAt: new Date(),\\n\\t\\t\\t\\t\\t_id: 'all',\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\thaveNoAgentsSelectedOption &&\\n\\t\\t\\t\\titems.unshift({\\n\\t\\t\\t\\t\\tlabel: t('Empty_no_agent_selected'),\\n\\t\\t\\t\\t\\tvalue: 'no-agent-selected',\\n\\t\\t\\t\\t\\t_updatedAt: new Date(),\\n\\t\\t\\t\\t\\t_id: 'no-agent-selected',\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\treturn {\\n\\t\\t\\t\\titems,\\n\\t\\t\\t\\titemCount: total + 1,\\n\\t\\t\\t};\\n\\t\\t},\\n\\t\\t[excludeId, getAgents, haveAll, haveNoAgentsSelectedOption, onlyAvailable, showIdleAgents, t, text],\\n\\t);\\n\\n\\tconst { loadMoreItems, initialItemCount } = useScrollableRecordList(itemsList, fetchData, 25);\\n\\n\\treturn {\\n\\t\\treload,\\n\\t\\titemsList,\\n\\t\\tloadMoreItems,\\n\\t\\tinitialItemCount,\\n\\t};\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"_objectSpread\",\"_slicedToArray\",\"export\",\"useAgentsList\",\"useEndpoint\",\"useCallback\",\"useState\",\"useTranslation\",\"useScrollableRecordList\",\"useComponentDidUpdate\",\"RecordList\",\"options\",\"t\",\"_useTranslation\",\"_useState\",\"_useState2\",\"itemsList\",\"setItemsList\",\"reload\",\"getAgents\",\"text\",\"_options$onlyAvailabl\",\"onlyAvailable\",\"_options$showIdleAgen\",\"showIdleAgents\",\"excludeId\",\"haveAll\",\"haveNoAgentsSelectedOption\",\"fetchData\",\"start\",\"end\",\"_await$getAgents\",\"agents\",\"total\",\"items\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"offset\",\"count\",\"sort\",\"sent\",\"users\",\"map\",\"agent\",\"_updatedAt\",\"Date\",\"label\",\"name\",\"_id\",\"username\",\"value\",\"unshift\",\"abrupt\",\"itemCount\",\"stop\",\"Promise\",\"_useScrollableRecordL\",\"loadMoreItems\",\"initialItemCount\"],\"mappings\":\"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\"}"}