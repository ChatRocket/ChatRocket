{"code":"function module(r,e,t){\"use strict\";var o=r(\"safe-buffer\").Buffer,n=r(\"bn.js\"),a=r(\"elliptic\").ec,u=r(\"parse-asn1\"),d=r(\"./curves.json\");function i(r,e){if(0>=r.cmpn(0)||r.cmp(e)>=0)throw Error(\"invalid sig\")}t.exports=function(r,e,t,c,s){var f,m,l,p,h,g,v,w,y,b,E,R,j=u(t);if(\"ec\"===j.type){if(\"ecdsa\"!==c&&\"ecdsa/rsa\"!==c)throw Error(\"wrong public key type\");return function(r,e,t){var o=d[t.data.algorithm.curve.join(\".\")];if(!o)throw Error(\"unknown curve \"+t.data.algorithm.curve.join(\".\"));var n=new a(o),u=t.data.subjectPrivateKey.data;return n.verify(e,r,u)}(r,e,j)}if(\"dsa\"===j.type){if(\"dsa\"!==c)throw Error(\"wrong public key type\");return f=r,m=e,p=j.data.p,h=j.data.q,g=j.data.g,v=j.data.pub_key,y=(w=u.signature.decode(f,\"der\")).s,b=w.r,i(y,h),i(b,h),E=n.mont(p),R=y.invm(h),0===g.toRed(E).redPow(new n(m).mul(R).mod(h)).fromRed().mul(v.toRed(E).redPow(b.mul(R).mod(h)).fromRed()).mod(p).mod(h).cmp(b)}if(\"rsa\"!==c&&\"ecdsa/rsa\"!==c)throw Error(\"wrong public key type\");e=o.concat([s,e]);for(var k=j.modulus.byteLength(),P=[1],x=0;e.length+P.length+2<k;)P.push(255),x+=1;P.push(0);for(var q=-1;++q<e.length;)P.push(e[q]);P=o.from(P);var A=n.mont(j.modulus);r=(r=new n(r).toRed(A)).redPow(new n(j.publicExponent));var B=x<8?1:0;for(k=Math.min((r=o.from(r.fromRed().toArray())).length,P.length),r.length!==P.length&&(B=1),q=-1;++q<k;)B|=r[q]^P[q];return 0===B}}","map":"{\"version\":3,\"sources\":[\"<anon>\"],\"names\":[],\"mappings\":\"\"}"}