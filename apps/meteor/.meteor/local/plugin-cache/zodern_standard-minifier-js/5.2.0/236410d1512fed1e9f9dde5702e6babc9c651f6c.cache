{"code":"function module(e,t,l){let n,a,c,i,r,s,o,u,m,d,p,E,f,k;let _=[\"email\",\"step\",\"setStep\",\"onClose\",\"intentData\",\"onSuccess\"];l.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default(e){n=e}},0),l.link(\"@rocket.chat/fuselage\",{Modal(e){a=e},Box(e){c=e},Field(e){i=e},FieldLabel(e){r=e},FieldRow(e){s=e},TextInput(e){o=e}},0),l.link(\"@rocket.chat/ui-contexts\",{useEndpoint(e){u=e},useToastMessageDispatch(e){m=e}},1),l.link(\"react\",{default(e){d=e},useCallback(e){p=e},useEffect(e){E=e}},2),l.link(\"react-i18next\",{useTranslation(e){f=e},Trans(e){k=e}},3);let g=e=>e?1e3*e:0;l.exportDefault(e=>{let{email:t,step:l,setStep:S,onClose:y,intentData:v,onSuccess:C}=e,b=n(e,_),{t:h}=f(),T=m(),x=u(\"GET\",\"/v1/cloud.confirmationPoll\"),w=u(\"POST\",\"/v1/cloud.createRegistrationIntent\"),R=async()=>{try{await w({resend:!0,email:t}),T({type:\"success\",message:h(\"Email_sent\")})}catch(e){T({type:\"error\",message:e})}},W=p(async()=>{try{let{pollData:e}=await x({deviceCode:v.device_code});\"successful\"in e&&e.successful&&(T({type:\"success\",message:h(\"Workspace_registered\")}),C())}catch(e){console.log(e)}},[x,v.device_code,T,h,C]);return E(()=>{let e=setInterval(()=>W(),g(v.interval));return()=>clearInterval(e)},[W,v]),d.createElement(a,b,d.createElement(a.Header,null,d.createElement(a.HeaderText,null,d.createElement(a.Tagline,null,h(\"RegisterWorkspace_Setup_Steps\",{step:l,numberOfSteps:2})),d.createElement(a.Title,null,h(\"Awaiting_confirmation\"))),d.createElement(a.Close,{onClick:y})),d.createElement(a.Content,null,d.createElement(c,{fontSize:\"p2\"},d.createElement(c,null,d.createElement(k,{i18nKey:\"RegisterWorkspace_Setup_Email_Confirmation\"},d.createElement(c,{is:\"p\"},\"Email sent to\",\" \",d.createElement(c,{is:\"span\",fontScale:\"p2b\"},t,\" \"),\"with a confirmation link.\"))),d.createElement(c,{is:\"p\"},h(\"RegisterWorkspace_Setup_Email_Verification\")),d.createElement(i,{pbs:10},d.createElement(r,null,h(\"Security_code\")),d.createElement(s,null,d.createElement(o,{defaultValue:v.user_code,disabled:!0}))))),d.createElement(a.Footer,null,d.createElement(c,{is:\"div\",display:\"flex\",justifyContent:\"start\",fontSize:\"c1\",w:\"full\"},\"Didn’t receive email?\",\" \",d.createElement(c,{is:\"a\",pi:4,onClick:R},\"Resend\"),\" \",\"or\",\" \",d.createElement(c,{is:\"a\",pi:4,onClick:()=>S(l-1)},\"change email\"))))})}","map":"{\"version\":3,\"sources\":[\"client/views/admin/workspace/VersionCard/modals/RegisterWorkspaceSetupModal/RegisterWorkspaceSetupStepTwoModal.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Modal, Box, Field, FieldLabel, FieldRow, TextInput } from '@rocket.chat/fuselage';\\nimport { useEndpoint, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport React, { useCallback, useEffect } from 'react';\\nimport { useTranslation, Trans } from 'react-i18next';\\n\\ntype Props = {\\n\\temail: string;\\n\\tstep: number;\\n\\tsetStep: (step: number) => void;\\n\\tonClose: () => void;\\n\\tintentData: {\\n\\t\\tdevice_code: string;\\n\\t\\tinterval: number;\\n\\t\\tuser_code: string;\\n\\t};\\n\\tonSuccess: () => void;\\n};\\n\\nconst setIntervalTime = (interval?: number): number => (interval ? interval * 1000 : 0);\\n\\nconst RegisterWorkspaceSetupStepTwoModal = ({ email, step, setStep, onClose, intentData, onSuccess, ...props }: Props) => {\\n\\tconst { t } = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst cloudConfirmationPoll = useEndpoint('GET', '/v1/cloud.confirmationPoll');\\n\\tconst createRegistrationIntent = useEndpoint('POST', '/v1/cloud.createRegistrationIntent');\\n\\n\\tconst handleBackFromConfirmation = (): void => setStep(step - 1);\\n\\n\\tconst handleResendRegistrationEmail = async () => {\\n\\t\\ttry {\\n\\t\\t\\tawait createRegistrationIntent({ resend: true, email });\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Email_sent') });\\n\\t\\t} catch (error: unknown) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t}\\n\\t};\\n\\n\\tconst getConfirmation = useCallback(async () => {\\n\\t\\ttry {\\n\\t\\t\\tconst { pollData } = await cloudConfirmationPoll({\\n\\t\\t\\t\\tdeviceCode: intentData.device_code,\\n\\t\\t\\t});\\n\\n\\t\\t\\tif ('successful' in pollData && pollData.successful) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Workspace_registered') });\\n\\t\\t\\t\\tonSuccess();\\n\\t\\t\\t}\\n\\t\\t} catch (error: any) {\\n\\t\\t\\tconsole.log(error);\\n\\t\\t}\\n\\t}, [cloudConfirmationPoll, intentData.device_code, dispatchToastMessage, t, onSuccess]);\\n\\n\\tuseEffect(() => {\\n\\t\\tconst pollInterval = setInterval(() => getConfirmation(), setIntervalTime(intentData.interval));\\n\\n\\t\\treturn (): void => clearInterval(pollInterval);\\n\\t}, [getConfirmation, intentData]);\\n\\n\\treturn (\\n\\t\\t<Modal {...props}>\\n\\t\\t\\t<Modal.Header>\\n\\t\\t\\t\\t<Modal.HeaderText>\\n\\t\\t\\t\\t\\t<Modal.Tagline>{t('RegisterWorkspace_Setup_Steps', { step, numberOfSteps: 2 })}</Modal.Tagline>\\n\\t\\t\\t\\t\\t<Modal.Title>{t('Awaiting_confirmation')}</Modal.Title>\\n\\t\\t\\t\\t</Modal.HeaderText>\\n\\t\\t\\t\\t<Modal.Close onClick={onClose} />\\n\\t\\t\\t</Modal.Header>\\n\\t\\t\\t<Modal.Content>\\n\\t\\t\\t\\t<Box fontSize='p2'>\\n\\t\\t\\t\\t\\t<Box>\\n\\t\\t\\t\\t\\t\\t<Trans i18nKey='RegisterWorkspace_Setup_Email_Confirmation'>\\n\\t\\t\\t\\t\\t\\t\\t<Box is='p'>\\n\\t\\t\\t\\t\\t\\t\\t\\tEmail sent to{' '}\\n\\t\\t\\t\\t\\t\\t\\t\\t<Box is='span' fontScale='p2b'>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t{email}{' '}\\n\\t\\t\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t\\t\\t\\twith a confirmation link.\\n\\t\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t\\t</Trans>\\n\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t<Box is='p'>{t('RegisterWorkspace_Setup_Email_Verification')}</Box>\\n\\t\\t\\t\\t\\t<Field pbs={10}>\\n\\t\\t\\t\\t\\t\\t<FieldLabel>{t('Security_code')}</FieldLabel>\\n\\t\\t\\t\\t\\t\\t<FieldRow>\\n\\t\\t\\t\\t\\t\\t\\t<TextInput defaultValue={intentData.user_code} disabled />\\n\\t\\t\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t\\t\\t</Field>\\n\\t\\t\\t\\t</Box>\\n\\t\\t\\t</Modal.Content>\\n\\t\\t\\t<Modal.Footer>\\n\\t\\t\\t\\t{/* FIXME: missing translation */}\\n\\t\\t\\t\\t<Box is='div' display='flex' justifyContent='start' fontSize='c1' w='full'>\\n\\t\\t\\t\\t\\tDidn’t receive email?{' '}\\n\\t\\t\\t\\t\\t<Box is='a' pi={4} onClick={handleResendRegistrationEmail}>\\n\\t\\t\\t\\t\\t\\tResend\\n\\t\\t\\t\\t\\t</Box>{' '}\\n\\t\\t\\t\\t\\tor{' '}\\n\\t\\t\\t\\t\\t<Box is='a' pi={4} onClick={handleBackFromConfirmation}>\\n\\t\\t\\t\\t\\t\\tchange email\\n\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t</Box>\\n\\t\\t\\t</Modal.Footer>\\n\\t\\t</Modal>\\n\\t);\\n};\\n\\nexport default RegisterWorkspaceSetupStepTwoModal;\\n\",null],\"names\":[\"_objectWithoutProperties\",\"Modal\",\"Box\",\"Field\",\"FieldLabel\",\"FieldRow\",\"TextInput\",\"useEndpoint\",\"useToastMessageDispatch\",\"React\",\"useCallback\",\"useEffect\",\"useTranslation\",\"Trans\",\"module\",\"link\",\"default\",\"v\",\"setIntervalTime\",\"interval\",\"exportDefault\",\"_ref\",\"email\",\"step\",\"setStep\",\"onClose\",\"intentData\",\"onSuccess\",\"props\",\"_excluded\",\"t\",\"dispatchToastMessage\",\"cloudConfirmationPoll\",\"createRegistrationIntent\",\"handleResendRegistrationEmail\",\"resend\",\"type\",\"message\",\"error\",\"getConfirmation\",\"pollData\",\"deviceCode\",\"device_code\",\"successful\",\"console\",\"log\",\"pollInterval\",\"setInterval\",\"clearInterval\",\"createElement\",\"Header\",\"HeaderText\",\"Tagline\",\"numberOfSteps\",\"Title\",\"Close\",\"onClick\",\"Content\",\"fontSize\",\"i18nKey\",\"is\",\"fontScale\",\"pbs\",\"defaultValue\",\"user_code\",\"disabled\",\"Footer\",\"display\",\"justifyContent\",\"w\",\"pi\",\"handleBackFromConfirmation\"],\"mappings\":\"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\"}"}