{"code":"function module(t,e,o){let n,a,u,l,i,r;o.export({useOutlookAuthentication:()=>s,useOutlookAuthenticationMutation:()=>c,useOutlookAuthenticationMutationLogout:()=>k}),o.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch(t){n=t}},0),o.link(\"@tanstack/react-query\",{useMutation(t){a=t},useQuery(t){u=t},useQueryClient(t){l=t}},1),o.link(\"react-i18next\",{useTranslation(t){i=t}},2),o.link(\"../lib/NotOnDesktopError\",{NotOnDesktopError(t){r=t}},3);let s=()=>{let{data:t,isError:e,error:o}=u([\"outlook\",\"auth\"],async()=>{var t;let e=window.RocketChatDesktop;if(!(null!=e&&e.hasOutlookCredentials))throw new r;return!!await (null==e?void 0:null===(t=e.hasOutlookCredentials)||void 0===t?void 0:t.call(e))},{onError:t=>{console.error(t)}});return{authEnabled:!!t,isError:e,error:o}},c=()=>{let t=l();return a({mutationFn:async()=>{await t.invalidateQueries([\"outlook\",\"auth\"])}})},k=()=>{let{t}=i(),e=n(),o=c();return a({mutationFn:async()=>{let t=window.RocketChatDesktop;if(!(null!=t&&t.clearOutlookCredentials))throw new r;return await t.clearOutlookCredentials(),o.mutateAsync()},onSuccess:()=>{e({type:\"success\",message:t(\"Outlook_authentication_disabled\")})}})}}","map":"{\"version\":3,\"sources\":[\"client/views/outlookCalendar/hooks/useOutlookAuthentication.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { NotOnDesktopError } from '../lib/NotOnDesktopError';\\n\\nexport const useOutlookAuthentication = () => {\\n\\tconst {\\n\\t\\tdata: authEnabled,\\n\\t\\tisError,\\n\\t\\terror,\\n\\t} = useQuery(\\n\\t\\t['outlook', 'auth'],\\n\\t\\tasync () => {\\n\\t\\t\\tconst desktopApp = window.RocketChatDesktop;\\n\\t\\t\\tif (!desktopApp?.hasOutlookCredentials) {\\n\\t\\t\\t\\tthrow new NotOnDesktopError();\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn Boolean(await desktopApp?.hasOutlookCredentials?.()) || false;\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\tonError: (error) => {\\n\\t\\t\\t\\tconsole.error(error);\\n\\t\\t\\t},\\n\\t\\t},\\n\\t);\\n\\n\\treturn { authEnabled: Boolean(authEnabled), isError, error };\\n};\\n\\nexport const useOutlookAuthenticationMutation = () => {\\n\\tconst queryClient = useQueryClient();\\n\\treturn useMutation({\\n\\t\\tmutationFn: async () => {\\n\\t\\t\\tawait queryClient.invalidateQueries(['outlook', 'auth']);\\n\\t\\t},\\n\\t});\\n};\\n\\nexport const useOutlookAuthenticationMutationLogout = () => {\\n\\tconst { t } = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst mutation = useOutlookAuthenticationMutation();\\n\\treturn useMutation({\\n\\t\\tmutationFn: async () => {\\n\\t\\t\\tconst desktopApp = window.RocketChatDesktop;\\n\\t\\t\\tif (!desktopApp?.clearOutlookCredentials) {\\n\\t\\t\\t\\tthrow new NotOnDesktopError();\\n\\t\\t\\t}\\n\\n\\t\\t\\tawait desktopApp.clearOutlookCredentials();\\n\\n\\t\\t\\treturn mutation.mutateAsync();\\n\\t\\t},\\n\\t\\tonSuccess: () => {\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Outlook_authentication_disabled') });\\n\\t\\t},\\n\\t});\\n};\\n\",null],\"names\":[\"useToastMessageDispatch\",\"useMutation\",\"useQuery\",\"useQueryClient\",\"useTranslation\",\"NotOnDesktopError\",\"module\",\"export\",\"useOutlookAuthentication\",\"useOutlookAuthenticationMutation\",\"useOutlookAuthenticationMutationLogout\",\"link\",\"v\",\"data\",\"authEnabled\",\"isError\",\"error\",\"_desktopApp$hasOutloo\",\"desktopApp\",\"window\",\"RocketChatDesktop\",\"hasOutlookCredentials\",\"Boolean\",\"call\",\"onError\",\"console\",\"queryClient\",\"mutationFn\",\"invalidateQueries\",\"t\",\"dispatchToastMessage\",\"mutation\",\"clearOutlookCredentials\",\"mutateAsync\",\"onSuccess\",\"type\",\"message\"],\"mappings\":\"2BAAmEA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAnEC,EAAOC,MAAE,CAAA,CAAAC,yBAA+BA,IAAAA,EAA2BC,iCAAAA,IAAAA,EAAAC,uCAAAA,IAAAA,CAAA,GAAAJ,EAAAK,IAAA,CAAA,2BAAA,CAAAX,wBAAAY,CAAA,EAAAZ,EAAAY,CAAA,CAAA,EAAA,GAAAN,EAAAK,IAAA,CAAA,wBAAA,CAAAV,YAAAW,CAAA,EAAAX,EAAAW,CAAA,EAAAV,SAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,eAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAN,EAAAK,IAAA,CAAA,gBAAA,CAAAP,eAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAN,EAAAK,IAAA,CAAA,2BAAA,CAAAN,kBAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAM5D,IAAMJ,EAA2BA,KACvC,GAAM,CACLK,KAAMC,CAAW,CACjBC,QAAAA,CAAO,CACPC,MAAAA,CAAAA,CACA,CAAGd,EACH,CAAC,UAAW,OAAO,CACnB,UAAW,IAAAe,EACV,IAAMC,EAAaC,OAAOC,iBAAiB,CAC3C,GAAI,CAACF,CAAAA,MAAAA,GAAAA,EAAYG,qBAAqB,AAArBA,EAChB,MAAM,IAAIhB,EAGX,MAAOiB,CAAAA,CAAQ,MAAMJ,CAAAA,MAAAA,EAAU,KAAA,EAAA,AAAuB,OAAvBD,CAAAA,EAAVC,EAAYG,qBAAqB,AAArBA,GAAqBJ,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAjCA,EAAAM,IAAA,CAAAL,EAAmC,CACzD,EACA,CACCM,QAAUR,IACTS,QAAQT,KAAK,CAACA,EACf,IAIF,MAAO,CAAEF,YAAaQ,CAAAA,CAAQR,EAAcC,QAAAA,EAASC,MAAAA,CAAK,CAC3D,EAEaP,EAAmCA,KAC/C,IAAMiB,EAAcvB,IACpB,OAAOF,EAAY,CAClB0B,WAAY,UACX,MAAMD,EAAYE,iBAAiB,CAAC,CAAC,UAAW,OAAO,CACxD,GAEF,EAEalB,EAAyCA,KACrD,GAAM,CAAEmB,CAAAA,CAAG,CAAGzB,IACR0B,EAAuB9B,IACvB+B,EAAWtB,IACjB,OAAOR,EAAY,CAClB0B,WAAY,UACX,IAAMT,EAAaC,OAAOC,iBAAiB,CAC3C,GAAI,CAACF,CAAAA,MAAAA,GAAAA,EAAYc,uBAAuB,AAAvBA,EAChB,MAAM,IAAI3B,EAKX,OAFA,MAAMa,EAAWc,uBAAuB,GAEjCD,EAASE,WAAW,EAC5B,EACAC,UAAWA,KACVJ,EAAqB,CAAEK,KAAM,UAAWC,QAASP,EAAE,kCAAkC,EACtF,GAEF\"}"}