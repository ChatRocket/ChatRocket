{"code":"function module(e,t,l){let a,n,r,i,d,s,o,c,u;let m=[\"_id\",\"name\"];l.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default(e){a=e}},0),l.export({useDepartmentsList:()=>p}),l.link(\"@rocket.chat/ui-contexts\",{useEndpoint(e){n=e},useTranslation(e){r=e}},0),l.link(\"react\",{useCallback(e){i=e},useState(e){d=e}},1),l.link(\"../../../hooks/lists/useScrollableRecordList\",{useScrollableRecordList(e){s=e}},2),l.link(\"../../../hooks/useComponentDidUpdate\",{useComponentDidUpdate(e){o=e}},3),l.link(\"../../../lib/lists/RecordList\",{RecordList(e){c=e}},4),l.link(\"../utils/normalizeDepartments\",{normalizeDepartments(e){u=e}},5);let p=e=>{var t;let l=r(),[p,h]=d(()=>new c),v=i(()=>h(new c),[]),D=n(\"GET\",\"/v1/livechat/department\"),b=n(\"GET\",\"/v1/livechat/department/:_id\",{_id:null!==(t=e.selectedDepartment)&&void 0!==t?t:\"\"});o(()=>{e&&v()},[e,v]);let f=i(async(t,n)=>{var r;let{departments:i,total:d}=await D({onlyMyDepartments:\"\".concat(!!e.onlyMyDepartments),text:e.filter,offset:t,count:n+t,sort:'{ \"name\": 1 }',excludeDepartmentId:e.excludeDepartmentId,enabled:e.enabled?\"true\":\"false\",showArchived:e.showArchived?\"true\":\"false\"}),s=i.filter(t=>!e.departmentId||t._id!==e.departmentId).map(e=>{let{_id:t,name:n}=e;return{_id:t,label:a(e,m).archived?\"\".concat(n,\" [\").concat(l(\"Archived\"),\"]\"):n,value:t}}),o=await u(s,null!==(r=e.selectedDepartment)&&void 0!==r?r:\"\",b);return e.haveAll&&o.unshift({_id:\"\",label:l(\"All\"),value:\"all\"}),e.haveNone&&o.unshift({_id:\"\",label:l(\"None\"),value:\"\"}),{items:o,itemCount:e.departmentId?d-1:d}},[D,e.onlyMyDepartments,e.filter,e.excludeDepartmentId,e.enabled,e.showArchived,e.selectedDepartment,e.haveAll,e.haveNone,e.departmentId,b,l]),{loadMoreItems:k,initialItemCount:w}=s(p,f,25);return{reload:v,itemsList:p,loadMoreItems:k,initialItemCount:w}}}","map":"{\"version\":3,\"sources\":[\"client/components/Omnichannel/hooks/useDepartmentsList.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\\nimport { useCallback, useState } from 'react';\\n\\nimport { useScrollableRecordList } from '../../../hooks/lists/useScrollableRecordList';\\nimport { useComponentDidUpdate } from '../../../hooks/useComponentDidUpdate';\\nimport { RecordList } from '../../../lib/lists/RecordList';\\nimport type { DepartmentListItem } from '../Definitions/DepartmentsDefinitions';\\nimport { normalizeDepartments } from '../utils/normalizeDepartments';\\n\\ntype DepartmentsListOptions = {\\n\\tfilter: string;\\n\\tdepartmentId?: string;\\n\\tonlyMyDepartments?: boolean;\\n\\thaveAll?: boolean;\\n\\thaveNone?: boolean;\\n\\texcludeDepartmentId?: string;\\n\\tenabled?: boolean;\\n\\tshowArchived?: boolean;\\n\\tselectedDepartment?: string;\\n};\\n\\nexport const useDepartmentsList = (\\n\\toptions: DepartmentsListOptions,\\n): {\\n\\titemsList: RecordList<DepartmentListItem>;\\n\\tinitialItemCount: number;\\n\\treload: () => void;\\n\\tloadMoreItems: (start: number, end: number) => void;\\n} => {\\n\\tconst t = useTranslation();\\n\\tconst [itemsList, setItemsList] = useState(() => new RecordList<DepartmentListItem>());\\n\\tconst reload = useCallback(() => setItemsList(new RecordList<DepartmentListItem>()), []);\\n\\n\\tconst getDepartments = useEndpoint('GET', '/v1/livechat/department');\\n\\tconst getDepartment = useEndpoint('GET', '/v1/livechat/department/:_id', { _id: options.selectedDepartment ?? '' });\\n\\n\\tuseComponentDidUpdate(() => {\\n\\t\\toptions && reload();\\n\\t}, [options, reload]);\\n\\n\\tconst fetchData = useCallback(\\n\\t\\tasync (start, end) => {\\n\\t\\t\\tconst { departments, total } = await getDepartments({\\n\\t\\t\\t\\tonlyMyDepartments: `${!!options.onlyMyDepartments}`,\\n\\t\\t\\t\\ttext: options.filter,\\n\\t\\t\\t\\toffset: start,\\n\\t\\t\\t\\tcount: end + start,\\n\\t\\t\\t\\tsort: `{ \\\"name\\\": 1 }`,\\n\\t\\t\\t\\texcludeDepartmentId: options.excludeDepartmentId,\\n\\t\\t\\t\\tenabled: options.enabled ? 'true' : 'false',\\n\\t\\t\\t\\tshowArchived: options.showArchived ? 'true' : 'false',\\n\\t\\t\\t});\\n\\n\\t\\t\\tconst items = departments\\n\\t\\t\\t\\t.filter((department) => {\\n\\t\\t\\t\\t\\tif (options.departmentId && department._id === options.departmentId) {\\n\\t\\t\\t\\t\\t\\treturn false;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\treturn true;\\n\\t\\t\\t\\t})\\n\\t\\t\\t\\t.map(\\n\\t\\t\\t\\t\\t({ _id, name, ...department }): DepartmentListItem => ({\\n\\t\\t\\t\\t\\t\\t_id,\\n\\t\\t\\t\\t\\t\\tlabel: department.archived ? `${name} [${t('Archived')}]` : name,\\n\\t\\t\\t\\t\\t\\tvalue: _id,\\n\\t\\t\\t\\t\\t}),\\n\\t\\t\\t\\t);\\n\\n\\t\\t\\tconst normalizedItems = await normalizeDepartments(items, options.selectedDepartment ?? '', getDepartment);\\n\\n\\t\\t\\toptions.haveAll &&\\n\\t\\t\\t\\tnormalizedItems.unshift({\\n\\t\\t\\t\\t\\t_id: '',\\n\\t\\t\\t\\t\\tlabel: t('All'),\\n\\t\\t\\t\\t\\tvalue: 'all',\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\toptions.haveNone &&\\n\\t\\t\\t\\tnormalizedItems.unshift({\\n\\t\\t\\t\\t\\t_id: '',\\n\\t\\t\\t\\t\\tlabel: t('None'),\\n\\t\\t\\t\\t\\tvalue: '',\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\treturn {\\n\\t\\t\\t\\titems: normalizedItems,\\n\\t\\t\\t\\titemCount: options.departmentId ? total - 1 : total,\\n\\t\\t\\t};\\n\\t\\t},\\n\\t\\t[\\n\\t\\t\\tgetDepartments,\\n\\t\\t\\toptions.onlyMyDepartments,\\n\\t\\t\\toptions.filter,\\n\\t\\t\\toptions.excludeDepartmentId,\\n\\t\\t\\toptions.enabled,\\n\\t\\t\\toptions.showArchived,\\n\\t\\t\\toptions.selectedDepartment,\\n\\t\\t\\toptions.haveAll,\\n\\t\\t\\toptions.haveNone,\\n\\t\\t\\toptions.departmentId,\\n\\t\\t\\tgetDepartment,\\n\\t\\t\\tt,\\n\\t\\t],\\n\\t);\\n\\n\\tconst { loadMoreItems, initialItemCount } = useScrollableRecordList(itemsList, fetchData, 25);\\n\\n\\treturn {\\n\\t\\treload,\\n\\t\\titemsList,\\n\\t\\tloadMoreItems,\\n\\t\\tinitialItemCount,\\n\\t};\\n};\\n\",null],\"names\":[\"_objectWithoutProperties\",\"useEndpoint\",\"useTranslation\",\"useCallback\",\"useState\",\"useScrollableRecordList\",\"useComponentDidUpdate\",\"RecordList\",\"normalizeDepartments\",\"module\",\"link\",\"default\",\"v\",\"export\",\"useDepartmentsList\",\"options\",\"_options$selectedDepa\",\"t\",\"itemsList\",\"setItemsList\",\"reload\",\"getDepartments\",\"getDepartment\",\"_id\",\"selectedDepartment\",\"fetchData\",\"start\",\"end\",\"_options$selectedDepa2\",\"departments\",\"total\",\"onlyMyDepartments\",\"concat\",\"text\",\"filter\",\"offset\",\"count\",\"sort\",\"excludeDepartmentId\",\"enabled\",\"showArchived\",\"items\",\"department\",\"departmentId\",\"map\",\"_ref\",\"name\",\"label\",\"_excluded\",\"archived\",\"value\",\"normalizedItems\",\"haveAll\",\"unshift\",\"haveNone\",\"itemCount\",\"loadMoreItems\",\"initialItemCount\"],\"mappings\":\"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\"}"}