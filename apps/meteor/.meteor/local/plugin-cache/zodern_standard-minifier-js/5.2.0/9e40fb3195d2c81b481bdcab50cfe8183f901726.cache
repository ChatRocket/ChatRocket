{"code":"function module(e,t,n){n.link(\"@babel/runtime/helpers/toConsumableArray\",{default:function(e){o=e}},0),n.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){i=e}},1),n.link(\"@babel/runtime/helpers/inheritsLoose\",{default:function(e){r=e}},2),n.export({WebRTC:function(){return R}}),n.link(\"@rocket.chat/emitter\",{Emitter:function(e){a=e}},0),n.link(\"meteor/meteor\",{Meteor:function(e){s=e}},1),n.link(\"meteor/reactive-var\",{ReactiveVar:function(e){c=e}},2),n.link(\"meteor/tracker\",{Tracker:function(e){l=e}},3),n.link(\"../../../client/components/GenericModal\",{default:function(e){d=e}},4),n.link(\"../../../client/lib/imperativeModal\",{imperativeModal:function(e){h=e}},5),n.link(\"../../../client/lib/utils/goToRoomById\",{goToRoomById:function(e){m=e}},6),n.link(\"../../models/client\",{ChatSubscription:function(e){u=e}},7),n.link(\"../../settings/client\",{settings:function(e){f=e}},8),n.link(\"../../utils/client/lib/SDKClient\",{sdk:function(e){p=e}},9),n.link(\"../../utils/lib/i18n\",{t:function(e){g=e}},10),n.link(\"../lib/constants\",{WEB_RTC_EVENTS:function(e){v=e}},11),n.link(\"./screenShare\",{ChromeScreenShare:function(e){C=e}},12);var o,i,r,a,s,c,l,d,h,m,u,f,p,g,v,C,b=function(e){function t(t){var n;return(n=e.call(this)||this).debug=!1,n.webrtcInstance=t,p.stream(\"notify-room\",[n.webrtcInstance.room+\"/\"+v.WEB_RTC],function(e,t){n.log(\"WebRTCTransportClass - onRoom\",e,t),n.emit(e,t)}),n}r(t,e);var n=t.prototype;return n.log=function(){if(!0===this.debug){var e;(e=console).log.apply(e,arguments)}},n.onUserStream=function(e,t){t.room===this.webrtcInstance.room&&(this.log(\"WebRTCTransportClass - onUser\",e,t),this.emit(e,t))},n.startCall=function(e){this.log(\"WebRTCTransportClass - startCall\",this.webrtcInstance.room,this.webrtcInstance.selfId),p.publish(\"notify-room-users\",[this.webrtcInstance.room+\"/\"+v.WEB_RTC,v.CALL,{from:this.webrtcInstance.selfId,room:this.webrtcInstance.room,media:e.media,monitor:e.monitor}])},n.joinCall=function(e){this.log(\"WebRTCTransportClass - joinCall\",this.webrtcInstance.room,this.webrtcInstance.selfId),!0===e.monitor?p.publish(\"notify-user\",[e.to+\"/\"+v.WEB_RTC,v.JOIN,{from:this.webrtcInstance.selfId,room:this.webrtcInstance.room,media:e.media,monitor:e.monitor}]):p.publish(\"notify-room-users\",[this.webrtcInstance.room+\"/\"+v.WEB_RTC,v.JOIN,{from:this.webrtcInstance.selfId,room:this.webrtcInstance.room,media:e.media,monitor:e.monitor}])},n.sendCandidate=function(e){e.from=this.webrtcInstance.selfId,e.room=this.webrtcInstance.room,this.log(\"WebRTCTransportClass - sendCandidate\",e),p.publish(\"notify-user\",[e.to+\"/\"+v.WEB_RTC,v.CANDIDATE,e])},n.sendDescription=function(e){e.from=this.webrtcInstance.selfId,e.room=this.webrtcInstance.room,this.log(\"WebRTCTransportClass - sendDescription\",e),p.publish(\"notify-user\",[e.to+\"/\"+v.WEB_RTC,v.DESCRIPTION,e])},n.sendStatus=function(e){this.log(\"WebRTCTransportClass - sendStatus\",e,this.webrtcInstance.room),e.from=this.webrtcInstance.selfId,p.publish(\"notify-room\",[this.webrtcInstance.room+\"/\"+v.WEB_RTC,v.STATUS,e])},n.onRemoteCall=function(e){return this.on(v.CALL,e)},n.onRemoteJoin=function(e){return this.on(v.JOIN,e)},n.onRemoteCandidate=function(e){return this.on(v.CANDIDATE,e)},n.onRemoteDescription=function(e){return this.on(v.DESCRIPTION,e)},n.onRemoteStatus=function(e){return this.on(v.STATUS,e)},t}(a),S=function(){function e(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.resetCallInProgress=function(){n.callInProgress.set(!1)},this.stopPeerConnection=function(e){var t=n.peerConnections[e];null!=t&&(delete n.peerConnections[e],t.close(),n.updateRemoteItems())},this.config={iceServers:[]},this.debug=!1,this.TransportClass=b,this.selfId=e,this.room=t;var i=f.get(\"WebRTC_Servers\");i&&\"\"!==i.trim()&&(i=(i=i.replace(/\\s/g,\"\")).split(\",\")).forEach(function(e){var t={urls:(e=e.split(\"@\")).pop()};1===e.length&&(e=e[0].split(\":\"),t.username=decodeURIComponent(e[0]),t.credential=decodeURIComponent(e[1])),n.config.iceServers.push(t)}),this.peerConnections={},this.remoteItems=new c([]),this.remoteItemsById=new c({}),this.callInProgress=new c(!1),this.audioEnabled=new c(!1),this.videoEnabled=new c(!1),this.overlayEnabled=new c(!1),this.screenShareEnabled=new c(!1),this.localUrl=new c,this.active=!1,this.remoteMonitoring=!1,this.monitor=!1,this.autoAccept=o,this.navigator=void 0;var r=navigator.userAgent.toLocaleLowerCase();-1!==r.indexOf(\"electron\")?this.navigator=\"electron\":-1!==r.indexOf(\"chrome\")?this.navigator=\"chrome\":-1!==r.indexOf(\"firefox\")?this.navigator=\"firefox\":-1!==r.indexOf(\"safari\")&&(this.navigator=\"safari\"),this.screenShareAvailable=[\"chrome\",\"firefox\",\"electron\"].includes(this.navigator),this.media={video:!0,audio:!0},this.transport=new this.TransportClass(this),this.transport.onRemoteCall(this.onRemoteCall.bind(this)),this.transport.onRemoteJoin(this.onRemoteJoin.bind(this)),this.transport.onRemoteCandidate(this.onRemoteCandidate.bind(this)),this.transport.onRemoteDescription(this.onRemoteDescription.bind(this)),this.transport.onRemoteStatus(this.onRemoteStatus.bind(this)),setInterval(this.checkPeerConnections.bind(this),1e3)}var t=e.prototype;return t.onUserStream=function(){var e;return(e=this.transport).onUserStream.apply(e,arguments)},t.log=function(){if(!0===this.debug){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log.apply(console,t)}},t.onError=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];console.error.apply(console,t)},t.checkPeerConnections=function(){var e=this,t=this.peerConnections,n=Date.now();Object.entries(t).some(function(t){var o=i(t,2),r=o[0],a=o[1];return![\"connected\",\"completed\"].includes(a.iceConnectionState)&&a.createdAt+5e3<n&&(e.stopPeerConnection(r),!0)})},t.updateRemoteItems=function(){var e=[],t={};Object.entries(this.peerConnections).forEach(function(n){var o=i(n,2),r=o[0],a=o[1];a.getRemoteStreams().forEach(function(n){var o={id:r,url:n,state:a.iceConnectionState};switch(a.iceConnectionState){case\"checking\":o.stateText=\"Connecting...\";break;case\"connected\":case\"completed\":o.stateText=\"Connected\",o.connected=!0;break;case\"disconnected\":o.stateText=\"Disconnected\";break;case\"failed\":o.stateText=\"Failed\";break;case\"closed\":o.stateText=\"Closed\"}e.push(o),t[r]=o})}),this.remoteItems.set(e),this.remoteItemsById.set(t)},t.broadcastStatus=function(){if(!0===this.active&&!0!==this.monitor&&!0!==this.remoteMonitoring){var e=[];Object.keys(this.peerConnections).entries(function(t){var n=i(t,2),o=n[0],r=n[1].remoteMedia;e.push({id:o,media:r})}),this.transport.sendStatus({media:this.media,remoteConnections:e})}},t.onRemoteStatus=function(e){var t=this;this.callInProgress.set(!0),clearTimeout(this.callInProgressTimeout),this.callInProgressTimeout=setTimeout(this.resetCallInProgress,2e3),!0===this.active&&[{id:e.from,media:e.media}].concat(o(e.remoteConnections)).forEach(function(e){e.id!==t.selfId&&null==t.peerConnections[e.id]&&(t.log(\"reconnecting with\",e.id),t.onRemoteJoin({from:e.id,media:e.media}))})},t.getPeerConnection=function(e){var t=this;if(null!=this.peerConnections[e])return this.peerConnections[e];var n=new RTCPeerConnection(this.config);return n.createdAt=Date.now(),n.remoteMedia={},this.peerConnections[e]=n,[\"icecandidate\",\"addstream\",\"removestream\",\"iceconnectionstatechange\",\"datachannel\",\"identityresult\",\"idpassertionerror\",\"idpvalidationerror\",\"negotiationneeded\",\"peeridentity\",\"signalingstatechange\"].forEach(function(o){n.addEventListener(o,function(n){t.log(e,n.type,n)})}),n.addEventListener(\"icecandidate\",function(n){null!=n.candidate&&t.transport.sendCandidate({to:e,candidate:{candidate:n.candidate.candidate,sdpMLineIndex:n.candidate.sdpMLineIndex,sdpMid:n.candidate.sdpMid}})}),n.addEventListener(\"addstream\",function(){t.updateRemoteItems()}),n.addEventListener(\"removestream\",function(){t.updateRemoteItems()}),n.addEventListener(\"iceconnectionstatechange\",function(){(\"disconnected\"===n.iceConnectionState||\"closed\"===n.iceConnectionState)&&n===t.peerConnections[e]&&(t.stopPeerConnection(e),setTimeout(function(){0===Object.keys(t.peerConnections).length&&t.stop()},3e3)),t.updateRemoteItems()}),n},t._getUserMedia=function(e,t,n){var o=this,i=function(e){if(AudioContext&&e.getAudioTracks().length>0){var n=new AudioContext,i=n.createMediaStreamSource(e),r=n.createGain();i.connect(r);var a=n.createMediaStreamDestination();r.connect(a),r.gain.value=.6,e.removeTrack(e.getAudioTracks()[0]),e.addTrack(a.stream.getAudioTracks()[0]),e.volume=r,o.audioContext=n}t(e)};if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)return navigator.mediaDevices.getUserMedia(e).then(i).catch(n);navigator.getUserMedia(e,i,n)},t.getUserMedia=function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.onError;if(!0!==e.desktop){this._getUserMedia(e,t,o);return}if(!0!==this.screenShareAvailable){console.log(\"Screen share is not avaliable\");return}var i=function(i){var r=function(){h.open({component:d,props:{variant:\"warning\",title:g(\"Refresh_your_page_after_install_to_enable_screen_sharing\")}})},a=\"chrome\"===n.navigator&&C.installed,s=\"firefox\"===n.navigator&&null!=window.rocketchatscreenshare;if(!a&&!s)return h.open({component:d,props:{title:g(\"Screen_Share\"),variant:\"warning\",confirmText:g(\"Install_Extension\"),cancelText:g(\"Cancel\"),children:g(\"You_need_install_an_extension_to_allow_screen_sharing\"),onConfirm:function(){if(\"chrome\"===n.navigator){var e=\"https://chrome.google.com/webstore/detail/rocketchat-screen-share/nocfbnnmjnndkbipkabodnheejiegccf\";try{chrome.webstore.install(e,r,function(){window.open(e),r()})}catch(t){console.log(t),window.open(e),r()}}else\"firefox\"===n.navigator&&(window.open(\"https://addons.mozilla.org/en-GB/firefox/addon/rocketchat-screen-share/\"),r())}}}),o(!1);var c=function(e){null!=i&&e.addTrack(i.getAudioTracks()[0]),t(e)};\"firefox\"===n.navigator?(e={audio:e.audio,video:{mozMediaSource:\"window\",mediaSource:\"window\"}},n._getUserMedia(e,c,o)):C.getSourceId(n.navigator,function(t){e={audio:!1,video:{mandatory:{chromeMediaSource:\"desktop\",chromeMediaSourceId:t,maxWidth:1280,maxHeight:720}}},n._getUserMedia(e,c,o)})};\"firefox\"===this.navigator||null==e.audio||!1===e.audio?i():this._getUserMedia({audio:e.audio},function(e){i(e)},function(){i()})},t.getLocalUserMedia=function(e){for(var t=this,n=arguments.length,o=Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];if(this.log(\"getLocalUserMedia\",[e].concat(o)),null!=this.localStream)return e(null,this.localStream);this.getUserMedia(this.media,function(n){t.localStream=n,t.audioEnabled.get()||t.disableAudio(),t.videoEnabled.get()||t.disableVideo(),t.localUrl.set(n),Object.entries(t.peerConnections).forEach(function(e){return i(e,2)[1].addStream(n)}),document.querySelector(\"video#localVideo\").srcObject=n,e(null,t.localStream)},function(n){e(!1),t.onError(n)})},t.stopAllPeerConnections=function(){Object.keys(this.peerConnections).forEach(this.stopPeerConnection),window.audioContext&&window.audioContext.close()},t.setAudioEnabled=function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];null!=this.localStream&&(this.localStream.getAudioTracks().forEach(function(t){t.enabled=e}),this.audioEnabled.set(e))},t.disableAudio=function(){this.setAudioEnabled(!1)},t.enableAudio=function(){this.setAudioEnabled(!0)},t.toggleAudio=function(){return this.audioEnabled.get()?this.disableAudio():this.enableAudio()},t.setVideoEnabled=function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];null!=this.localStream&&(this.localStream.getVideoTracks().forEach(function(t){t.enabled=e}),this.videoEnabled.set(e))},t.disableScreenShare=function(){this.setScreenShareEnabled(!1)},t.enableScreenShare=function(){this.setScreenShareEnabled(!0)},t.setScreenShareEnabled=function(){var e=this,t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];null!=this.localStream&&(this.media.desktop=t,delete this.localStream,this.getLocalUserMedia(function(n){null==n&&(e.screenShareEnabled.set(t),e.stopAllPeerConnections(),e.joinCall())}))},t.disableVideo=function(){this.setVideoEnabled(!1)},t.enableVideo=function(){this.setVideoEnabled(!0)},t.toggleVideo=function(){return this.videoEnabled.get()?this.disableVideo():this.enableVideo()},t.stop=function(){this.active=!1,this.monitor=!1,this.remoteMonitoring=!1,null!=this.localStream&&void 0!==this.localStream&&this.localStream.getTracks().forEach(function(e){return e.stop()}),this.localUrl.set(void 0),delete this.localStream,this.stopAllPeerConnections()},t.startCall=function(){for(var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];this.log(\"startCall\",[t].concat(o)),this.media=t,this.getLocalUserMedia(function(){e.active=!0,e.transport.startCall({media:e.media})})},t.startCallAsMonitor=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];this.log(\"startCallAsMonitor\",[e].concat(n)),this.media=e,this.active=!0,this.monitor=!0,this.transport.startCall({media:this.media,monitor:!0})},t.onRemoteCall=function(e){var t,n,o=this;if(!0===this.autoAccept){setTimeout(function(){o.joinCall({to:e.from,monitor:e.monitor,media:e.media})},0);return}var i=s.users.findOne(e.from),r=void 0;i&&i.username&&(r=i.username);var a=u.findOne({rid:e.room});!0===e.monitor?(t=\"eye\",n=g(\"WebRTC_monitor_call_from_%s\",r)):a&&\"d\"===a.t?e.media&&e.media.video?(t=\"videocam\",n=g(\"WebRTC_direct_video_call_from_%s\",r)):(t=\"phone\",n=g(\"WebRTC_direct_audio_call_from_%s\",r)):e.media&&e.media.video?(t=\"videocam\",n=g(\"WebRTC_group_video_call_from_%s\",a.name)):(t=\"phone\",n=g(\"WebRTC_group_audio_call_from_%s\",a.name)),h.open({component:d,props:{title:n,icon:t,confirmText:g(\"Yes\"),cancelText:g(\"No\"),children:g(\"Do_you_want_to_accept\"),onConfirm:function(){return m(e.room),o.joinCall({to:e.from,monitor:e.monitor,media:e.media})},onCancel:function(){return o.stop()},onClose:function(){return o.stop()}}})},t.joinCall=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.media=this.media;for(var n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];this.log(\"joinCall\",[t].concat(o)),this.getLocalUserMedia(function(){e.remoteMonitoring=t.monitor,e.active=!0,e.transport.joinCall(t)})},t.onRemoteJoin=function(e){var t=this;if(!0===this.active){for(var n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];this.log(\"onRemoteJoin\",[e].concat(o));var r=this.getPeerConnection(e.from);if(\"checking\"!==r.signalingState&&(this.stopPeerConnection(e.from),r=this.getPeerConnection(e.from)),\"new\"===r.iceConnectionState){r.remoteMedia=e.media,this.localStream&&r.addStream(this.localStream);var a=function(n){r.setLocalDescription(new RTCSessionDescription(n),function(){t.transport.sendDescription({to:e.from,type:\"offer\",ts:r.createdAt,media:t.media,description:{sdp:n.sdp,type:n.type}})},t.onError)};!0===e.monitor?r.createOffer(a,this.onError,{mandatory:{OfferToReceiveAudio:e.media.audio,OfferToReceiveVideo:e.media.video}}):r.createOffer(a,this.onError)}}},t.onRemoteOffer=function(e){var t=this;if(!0===this.active){for(var n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];this.log(\"onRemoteOffer\",[e].concat(o));var r=this.getPeerConnection(e.from);if([\"have-local-offer\",\"stable\"].includes(r.signalingState)&&r.createdAt<e.ts&&(this.stopPeerConnection(e.from),r=this.getPeerConnection(e.from)),\"new\"===r.iceConnectionState){r.setRemoteDescription(new RTCSessionDescription(e.description));try{this.localStream&&r.addStream(this.localStream)}catch(e){console.log(e)}r.createAnswer(function(n){r.setLocalDescription(new RTCSessionDescription(n),function(){t.transport.sendDescription({to:e.from,type:\"answer\",ts:r.createdAt,description:{sdp:n.sdp,type:n.type}})},t.onError)},this.onError)}}},t.onRemoteCandidate=function(e){if(!0===this.active&&e.to===this.selfId){for(var t,n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];this.log(\"onRemoteCandidate\",[e].concat(o));var r=this.getPeerConnection(e.from);\"closed\"!==r.iceConnectionState&&\"failed\"!==r.iceConnectionState&&\"disconnected\"!==r.iceConnectionState&&\"completed\"!==r.iceConnectionState&&r.addIceCandidate(new RTCIceCandidate(e.candidate)),document.querySelector(\"video#remoteVideo\").srcObject=null===(t=this.remoteItems.get()[0])||void 0===t?void 0:t.url}},t.onRemoteDescription=function(e){if(!0===this.active&&e.to===this.selfId){for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];this.log(\"onRemoteDescription\",[e].concat(n));var i=this.getPeerConnection(e.from);\"offer\"===e.type?(i.remoteMedia=e.media,this.onRemoteOffer({from:e.from,ts:e.ts,description:e.description})):i.setRemoteDescription(new RTCSessionDescription(e.description))}},e}(),R=new(function(){function e(){this.instancesByRoomId={}}return e.prototype.getInstanceByRoomId=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=!1;if(t)n=\"WebRTC\"===f.get(\"Omnichannel_call_provider\");else{var o=u.findOne({rid:e});if(!o)return;switch(o.t){case\"d\":n=f.get(\"WebRTC_Enable_Direct\");break;case\"p\":n=f.get(\"WebRTC_Enable_Private\");break;case\"c\":n=f.get(\"WebRTC_Enable_Channel\");break;case\"l\":n=\"WebRTC\"===f.get(\"Omnichannel_call_provider\")}}if(!1!==(n=n&&f.get(\"WebRTC_Enabled\"))){if(null==this.instancesByRoomId[e]){var i=s.userId(),r=!1;t&&(i=t,r=!0),this.instancesByRoomId[e]=new S(i,e,r)}return this.instancesByRoomId[e]}},e}());s.startup(function(){l.autorun(function(){s.userId()&&p.stream(\"notify-user\",[s.userId()+\"/\"+v.WEB_RTC],function(e,t){null!=t.room&&R.getInstanceByRoomId(t.room).onUserStream(e,t)})})})}","map":"{\"version\":3,\"sources\":[\"app/webrtc/client/WebRTCClass.js\",\"<anon>\"],\"sourcesContent\":[\"import { Emitter } from '@rocket.chat/emitter';\\nimport { Meteor } from 'meteor/meteor';\\nimport { ReactiveVar } from 'meteor/reactive-var';\\nimport { Tracker } from 'meteor/tracker';\\n\\nimport GenericModal from '../../../client/components/GenericModal';\\nimport { imperativeModal } from '../../../client/lib/imperativeModal';\\nimport { goToRoomById } from '../../../client/lib/utils/goToRoomById';\\nimport { ChatSubscription } from '../../models/client';\\nimport { settings } from '../../settings/client';\\nimport { sdk } from '../../utils/client/lib/SDKClient';\\nimport { t } from '../../utils/lib/i18n';\\nimport { WEB_RTC_EVENTS } from '../lib/constants';\\nimport { ChromeScreenShare } from './screenShare';\\n\\nclass WebRTCTransportClass extends Emitter {\\n\\tconstructor(webrtcInstance) {\\n\\t\\tsuper();\\n\\t\\tthis.debug = false;\\n\\t\\tthis.webrtcInstance = webrtcInstance;\\n\\t\\tsdk.stream('notify-room', [`${this.webrtcInstance.room}/${WEB_RTC_EVENTS.WEB_RTC}`], (type, data) => {\\n\\t\\t\\tthis.log('WebRTCTransportClass - onRoom', type, data);\\n\\t\\t\\tthis.emit(type, data);\\n\\t\\t});\\n\\t}\\n\\n\\tlog(...args) {\\n\\t\\tif (this.debug === true) {\\n\\t\\t\\tconsole.log(...args);\\n\\t\\t}\\n\\t}\\n\\n\\tonUserStream(type, data) {\\n\\t\\tif (data.room !== this.webrtcInstance.room) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tthis.log('WebRTCTransportClass - onUser', type, data);\\n\\t\\tthis.emit(type, data);\\n\\t}\\n\\n\\tstartCall(data) {\\n\\t\\tthis.log('WebRTCTransportClass - startCall', this.webrtcInstance.room, this.webrtcInstance.selfId);\\n\\t\\tsdk.publish('notify-room-users', [\\n\\t\\t\\t`${this.webrtcInstance.room}/${WEB_RTC_EVENTS.WEB_RTC}`,\\n\\t\\t\\tWEB_RTC_EVENTS.CALL,\\n\\t\\t\\t{\\n\\t\\t\\t\\tfrom: this.webrtcInstance.selfId,\\n\\t\\t\\t\\troom: this.webrtcInstance.room,\\n\\t\\t\\t\\tmedia: data.media,\\n\\t\\t\\t\\tmonitor: data.monitor,\\n\\t\\t\\t},\\n\\t\\t]);\\n\\t}\\n\\n\\tjoinCall(data) {\\n\\t\\tthis.log('WebRTCTransportClass - joinCall', this.webrtcInstance.room, this.webrtcInstance.selfId);\\n\\t\\tif (data.monitor === true) {\\n\\t\\t\\tsdk.publish('notify-user', [\\n\\t\\t\\t\\t`${data.to}/${WEB_RTC_EVENTS.WEB_RTC}`,\\n\\t\\t\\t\\tWEB_RTC_EVENTS.JOIN,\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\tfrom: this.webrtcInstance.selfId,\\n\\t\\t\\t\\t\\troom: this.webrtcInstance.room,\\n\\t\\t\\t\\t\\tmedia: data.media,\\n\\t\\t\\t\\t\\tmonitor: data.monitor,\\n\\t\\t\\t\\t},\\n\\t\\t\\t]);\\n\\t\\t} else {\\n\\t\\t\\tsdk.publish('notify-room-users', [\\n\\t\\t\\t\\t`${this.webrtcInstance.room}/${WEB_RTC_EVENTS.WEB_RTC}`,\\n\\t\\t\\t\\tWEB_RTC_EVENTS.JOIN,\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\tfrom: this.webrtcInstance.selfId,\\n\\t\\t\\t\\t\\troom: this.webrtcInstance.room,\\n\\t\\t\\t\\t\\tmedia: data.media,\\n\\t\\t\\t\\t\\tmonitor: data.monitor,\\n\\t\\t\\t\\t},\\n\\t\\t\\t]);\\n\\t\\t}\\n\\t}\\n\\n\\tsendCandidate(data) {\\n\\t\\tdata.from = this.webrtcInstance.selfId;\\n\\t\\tdata.room = this.webrtcInstance.room;\\n\\t\\tthis.log('WebRTCTransportClass - sendCandidate', data);\\n\\t\\tsdk.publish('notify-user', [`${data.to}/${WEB_RTC_EVENTS.WEB_RTC}`, WEB_RTC_EVENTS.CANDIDATE, data]);\\n\\t}\\n\\n\\tsendDescription(data) {\\n\\t\\tdata.from = this.webrtcInstance.selfId;\\n\\t\\tdata.room = this.webrtcInstance.room;\\n\\t\\tthis.log('WebRTCTransportClass - sendDescription', data);\\n\\t\\tsdk.publish('notify-user', [`${data.to}/${WEB_RTC_EVENTS.WEB_RTC}`, WEB_RTC_EVENTS.DESCRIPTION, data]);\\n\\t}\\n\\n\\tsendStatus(data) {\\n\\t\\tthis.log('WebRTCTransportClass - sendStatus', data, this.webrtcInstance.room);\\n\\t\\tdata.from = this.webrtcInstance.selfId;\\n\\t\\tsdk.publish('notify-room', [`${this.webrtcInstance.room}/${WEB_RTC_EVENTS.WEB_RTC}`, WEB_RTC_EVENTS.STATUS, data]);\\n\\t}\\n\\n\\tonRemoteCall(fn) {\\n\\t\\treturn this.on(WEB_RTC_EVENTS.CALL, fn);\\n\\t}\\n\\n\\tonRemoteJoin(fn) {\\n\\t\\treturn this.on(WEB_RTC_EVENTS.JOIN, fn);\\n\\t}\\n\\n\\tonRemoteCandidate(fn) {\\n\\t\\treturn this.on(WEB_RTC_EVENTS.CANDIDATE, fn);\\n\\t}\\n\\n\\tonRemoteDescription(fn) {\\n\\t\\treturn this.on(WEB_RTC_EVENTS.DESCRIPTION, fn);\\n\\t}\\n\\n\\tonRemoteStatus(fn) {\\n\\t\\treturn this.on(WEB_RTC_EVENTS.STATUS, fn);\\n\\t}\\n}\\n\\nclass WebRTCClass {\\n\\t/*\\n  \\t\\t@param seldId {String}\\n  \\t\\t@param room {String}\\n   */\\n\\n\\tconstructor(selfId, room, autoAccept = false) {\\n\\t\\tthis.config = {\\n\\t\\t\\ticeServers: [],\\n\\t\\t};\\n\\t\\tthis.debug = false;\\n\\t\\tthis.TransportClass = WebRTCTransportClass;\\n\\t\\tthis.selfId = selfId;\\n\\t\\tthis.room = room;\\n\\t\\tlet servers = settings.get('WebRTC_Servers');\\n\\t\\tif (servers && servers.trim() !== '') {\\n\\t\\t\\tservers = servers.replace(/\\\\s/g, '');\\n\\t\\t\\tservers = servers.split(',');\\n\\n\\t\\t\\tservers.forEach((server) => {\\n\\t\\t\\t\\tserver = server.split('@');\\n\\t\\t\\t\\tconst serverConfig = {\\n\\t\\t\\t\\t\\turls: server.pop(),\\n\\t\\t\\t\\t};\\n\\t\\t\\t\\tif (server.length === 1) {\\n\\t\\t\\t\\t\\tserver = server[0].split(':');\\n\\t\\t\\t\\t\\tserverConfig.username = decodeURIComponent(server[0]);\\n\\t\\t\\t\\t\\tserverConfig.credential = decodeURIComponent(server[1]);\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tthis.config.iceServers.push(serverConfig);\\n\\t\\t\\t});\\n\\t\\t}\\n\\t\\tthis.peerConnections = {};\\n\\t\\tthis.remoteItems = new ReactiveVar([]);\\n\\t\\tthis.remoteItemsById = new ReactiveVar({});\\n\\t\\tthis.callInProgress = new ReactiveVar(false);\\n\\t\\tthis.audioEnabled = new ReactiveVar(false);\\n\\t\\tthis.videoEnabled = new ReactiveVar(false);\\n\\t\\tthis.overlayEnabled = new ReactiveVar(false);\\n\\t\\tthis.screenShareEnabled = new ReactiveVar(false);\\n\\t\\tthis.localUrl = new ReactiveVar();\\n\\t\\tthis.active = false;\\n\\t\\tthis.remoteMonitoring = false;\\n\\t\\tthis.monitor = false;\\n\\t\\tthis.autoAccept = autoAccept;\\n\\t\\tthis.navigator = undefined;\\n\\t\\tconst userAgent = navigator.userAgent.toLocaleLowerCase();\\n\\n\\t\\tif (userAgent.indexOf('electron') !== -1) {\\n\\t\\t\\tthis.navigator = 'electron';\\n\\t\\t} else if (userAgent.indexOf('chrome') !== -1) {\\n\\t\\t\\tthis.navigator = 'chrome';\\n\\t\\t} else if (userAgent.indexOf('firefox') !== -1) {\\n\\t\\t\\tthis.navigator = 'firefox';\\n\\t\\t} else if (userAgent.indexOf('safari') !== -1) {\\n\\t\\t\\tthis.navigator = 'safari';\\n\\t\\t}\\n\\n\\t\\tthis.screenShareAvailable = ['chrome', 'firefox', 'electron'].includes(this.navigator);\\n\\t\\tthis.media = {\\n\\t\\t\\tvideo: true,\\n\\t\\t\\taudio: true,\\n\\t\\t};\\n\\t\\tthis.transport = new this.TransportClass(this);\\n\\t\\tthis.transport.onRemoteCall(this.onRemoteCall.bind(this));\\n\\t\\tthis.transport.onRemoteJoin(this.onRemoteJoin.bind(this));\\n\\t\\tthis.transport.onRemoteCandidate(this.onRemoteCandidate.bind(this));\\n\\t\\tthis.transport.onRemoteDescription(this.onRemoteDescription.bind(this));\\n\\t\\tthis.transport.onRemoteStatus(this.onRemoteStatus.bind(this));\\n\\n\\t\\tsetInterval(this.checkPeerConnections.bind(this), 1000);\\n\\t}\\n\\n\\tonUserStream(...args) {\\n\\t\\treturn this.transport.onUserStream(...args);\\n\\t}\\n\\n\\tlog(...args) {\\n\\t\\tif (this.debug === true) {\\n\\t\\t\\tconsole.log.apply(console, args);\\n\\t\\t}\\n\\t}\\n\\n\\tonError(...args) {\\n\\t\\tconsole.error.apply(console, args);\\n\\t}\\n\\n\\tcheckPeerConnections() {\\n\\t\\tconst { peerConnections } = this;\\n\\t\\tconst date = Date.now();\\n\\t\\tObject.entries(peerConnections).some(([id, peerConnection]) => {\\n\\t\\t\\tif (!['connected', 'completed'].includes(peerConnection.iceConnectionState) && peerConnection.createdAt + 5000 < date) {\\n\\t\\t\\t\\tthis.stopPeerConnection(id);\\n\\t\\t\\t\\treturn true;\\n\\t\\t\\t}\\n\\t\\t\\treturn false;\\n\\t\\t});\\n\\t}\\n\\n\\tupdateRemoteItems() {\\n\\t\\tconst items = [];\\n\\t\\tconst itemsById = {};\\n\\t\\tconst { peerConnections } = this;\\n\\n\\t\\tObject.entries(peerConnections).forEach(([id, peerConnection]) => {\\n\\t\\t\\tpeerConnection.getRemoteStreams().forEach((remoteStream) => {\\n\\t\\t\\t\\tconst item = {\\n\\t\\t\\t\\t\\tid,\\n\\t\\t\\t\\t\\turl: remoteStream,\\n\\t\\t\\t\\t\\tstate: peerConnection.iceConnectionState,\\n\\t\\t\\t\\t};\\n\\t\\t\\t\\tswitch (peerConnection.iceConnectionState) {\\n\\t\\t\\t\\t\\tcase 'checking':\\n\\t\\t\\t\\t\\t\\titem.stateText = 'Connecting...';\\n\\t\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t\\tcase 'connected':\\n\\t\\t\\t\\t\\tcase 'completed':\\n\\t\\t\\t\\t\\t\\titem.stateText = 'Connected';\\n\\t\\t\\t\\t\\t\\titem.connected = true;\\n\\t\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t\\tcase 'disconnected':\\n\\t\\t\\t\\t\\t\\titem.stateText = 'Disconnected';\\n\\t\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t\\tcase 'failed':\\n\\t\\t\\t\\t\\t\\titem.stateText = 'Failed';\\n\\t\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t\\tcase 'closed':\\n\\t\\t\\t\\t\\t\\titem.stateText = 'Closed';\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\titems.push(item);\\n\\t\\t\\t\\titemsById[id] = item;\\n\\t\\t\\t});\\n\\t\\t});\\n\\t\\tthis.remoteItems.set(items);\\n\\t\\tthis.remoteItemsById.set(itemsById);\\n\\t}\\n\\n\\tresetCallInProgress = () => {\\n\\t\\tthis.callInProgress.set(false);\\n\\t};\\n\\n\\tbroadcastStatus() {\\n\\t\\tif (this.active !== true || this.monitor === true || this.remoteMonitoring === true) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tconst remoteConnections = [];\\n\\t\\tconst { peerConnections } = this;\\n\\t\\tObject.keys(peerConnections).entries(([id, { remoteMedia: media }]) => {\\n\\t\\t\\tremoteConnections.push({\\n\\t\\t\\t\\tid,\\n\\t\\t\\t\\tmedia,\\n\\t\\t\\t});\\n\\t\\t});\\n\\n\\t\\tthis.transport.sendStatus({\\n\\t\\t\\tmedia: this.media,\\n\\t\\t\\tremoteConnections,\\n\\t\\t});\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param data {Object}\\n  \\t\\t\\tfrom {String}\\n  \\t\\t\\tmedia {Object}\\n  \\t\\t\\tremoteConnections {Array[Object]}\\n  \\t\\t\\t\\tid {String}\\n  \\t\\t\\t\\tmedia {Object}\\n   */\\n\\n\\tonRemoteStatus(data) {\\n\\t\\t// this.log(onRemoteStatus, arguments);\\n\\t\\tthis.callInProgress.set(true);\\n\\t\\tclearTimeout(this.callInProgressTimeout);\\n\\t\\tthis.callInProgressTimeout = setTimeout(this.resetCallInProgress, 2000);\\n\\t\\tif (this.active !== true) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tconst remoteConnections = [\\n\\t\\t\\t{\\n\\t\\t\\t\\tid: data.from,\\n\\t\\t\\t\\tmedia: data.media,\\n\\t\\t\\t},\\n\\t\\t\\t...data.remoteConnections,\\n\\t\\t];\\n\\n\\t\\tremoteConnections.forEach((remoteConnection) => {\\n\\t\\t\\tif (remoteConnection.id !== this.selfId && this.peerConnections[remoteConnection.id] == null) {\\n\\t\\t\\t\\tthis.log('reconnecting with', remoteConnection.id);\\n\\t\\t\\t\\tthis.onRemoteJoin({\\n\\t\\t\\t\\t\\tfrom: remoteConnection.id,\\n\\t\\t\\t\\t\\tmedia: remoteConnection.media,\\n\\t\\t\\t\\t});\\n\\t\\t\\t}\\n\\t\\t});\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param id {String}\\n   */\\n\\n\\tgetPeerConnection(id) {\\n\\t\\tif (this.peerConnections[id] != null) {\\n\\t\\t\\treturn this.peerConnections[id];\\n\\t\\t}\\n\\t\\tconst peerConnection = new RTCPeerConnection(this.config);\\n\\n\\t\\tpeerConnection.createdAt = Date.now();\\n\\t\\tpeerConnection.remoteMedia = {};\\n\\t\\tthis.peerConnections[id] = peerConnection;\\n\\t\\tconst eventNames = [\\n\\t\\t\\t'icecandidate',\\n\\t\\t\\t'addstream',\\n\\t\\t\\t'removestream',\\n\\t\\t\\t'iceconnectionstatechange',\\n\\t\\t\\t'datachannel',\\n\\t\\t\\t'identityresult',\\n\\t\\t\\t'idpassertionerror',\\n\\t\\t\\t'idpvalidationerror',\\n\\t\\t\\t'negotiationneeded',\\n\\t\\t\\t'peeridentity',\\n\\t\\t\\t'signalingstatechange',\\n\\t\\t];\\n\\n\\t\\teventNames.forEach((eventName) => {\\n\\t\\t\\tpeerConnection.addEventListener(eventName, (e) => {\\n\\t\\t\\t\\tthis.log(id, e.type, e);\\n\\t\\t\\t});\\n\\t\\t});\\n\\n\\t\\tpeerConnection.addEventListener('icecandidate', (e) => {\\n\\t\\t\\tif (e.candidate == null) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t\\tthis.transport.sendCandidate({\\n\\t\\t\\t\\tto: id,\\n\\t\\t\\t\\tcandidate: {\\n\\t\\t\\t\\t\\tcandidate: e.candidate.candidate,\\n\\t\\t\\t\\t\\tsdpMLineIndex: e.candidate.sdpMLineIndex,\\n\\t\\t\\t\\t\\tsdpMid: e.candidate.sdpMid,\\n\\t\\t\\t\\t},\\n\\t\\t\\t});\\n\\t\\t});\\n\\t\\tpeerConnection.addEventListener('addstream', () => {\\n\\t\\t\\tthis.updateRemoteItems();\\n\\t\\t});\\n\\t\\tpeerConnection.addEventListener('removestream', () => {\\n\\t\\t\\tthis.updateRemoteItems();\\n\\t\\t});\\n\\t\\tpeerConnection.addEventListener('iceconnectionstatechange', () => {\\n\\t\\t\\tif (\\n\\t\\t\\t\\t(peerConnection.iceConnectionState === 'disconnected' || peerConnection.iceConnectionState === 'closed') &&\\n\\t\\t\\t\\tpeerConnection === this.peerConnections[id]\\n\\t\\t\\t) {\\n\\t\\t\\t\\tthis.stopPeerConnection(id);\\n\\t\\t\\t\\tsetTimeout(() => {\\n\\t\\t\\t\\t\\tif (Object.keys(this.peerConnections).length === 0) {\\n\\t\\t\\t\\t\\t\\tthis.stop();\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}, 3000);\\n\\t\\t\\t}\\n\\t\\t\\tthis.updateRemoteItems();\\n\\t\\t});\\n\\t\\treturn peerConnection;\\n\\t}\\n\\n\\t_getUserMedia(media, onSuccess, onError) {\\n\\t\\tconst onSuccessLocal = (stream) => {\\n\\t\\t\\tif (AudioContext && stream.getAudioTracks().length > 0) {\\n\\t\\t\\t\\tconst audioContext = new AudioContext();\\n\\t\\t\\t\\tconst source = audioContext.createMediaStreamSource(stream);\\n\\t\\t\\t\\tconst volume = audioContext.createGain();\\n\\t\\t\\t\\tsource.connect(volume);\\n\\t\\t\\t\\tconst peer = audioContext.createMediaStreamDestination();\\n\\t\\t\\t\\tvolume.connect(peer);\\n\\t\\t\\t\\tvolume.gain.value = 0.6;\\n\\t\\t\\t\\tstream.removeTrack(stream.getAudioTracks()[0]);\\n\\t\\t\\t\\tstream.addTrack(peer.stream.getAudioTracks()[0]);\\n\\t\\t\\t\\tstream.volume = volume;\\n\\t\\t\\t\\tthis.audioContext = audioContext;\\n\\t\\t\\t}\\n\\t\\t\\tonSuccess(stream);\\n\\t\\t};\\n\\t\\tif (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\\n\\t\\t\\treturn navigator.mediaDevices.getUserMedia(media).then(onSuccessLocal).catch(onError);\\n\\t\\t}\\n\\n\\t\\tnavigator.getUserMedia(media, onSuccessLocal, onError);\\n\\t}\\n\\n\\tgetUserMedia(media, onSuccess, onError = this.onError) {\\n\\t\\tif (media.desktop !== true) {\\n\\t\\t\\tthis._getUserMedia(media, onSuccess, onError);\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tif (this.screenShareAvailable !== true) {\\n\\t\\t\\tconsole.log('Screen share is not avaliable');\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tconst getScreen = (audioStream) => {\\n\\t\\t\\tconst refresh = function () {\\n\\t\\t\\t\\timperativeModal.open({\\n\\t\\t\\t\\t\\tcomponent: GenericModal,\\n\\t\\t\\t\\t\\tprops: {\\n\\t\\t\\t\\t\\t\\tvariant: 'warning',\\n\\t\\t\\t\\t\\t\\ttitle: t('Refresh_your_page_after_install_to_enable_screen_sharing'),\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t});\\n\\t\\t\\t};\\n\\n\\t\\t\\tconst isChromeExtensionInstalled = this.navigator === 'chrome' && ChromeScreenShare.installed;\\n\\t\\t\\tconst isFirefoxExtensionInstalled = this.navigator === 'firefox' && window.rocketchatscreenshare != null;\\n\\n\\t\\t\\tif (!isChromeExtensionInstalled && !isFirefoxExtensionInstalled) {\\n\\t\\t\\t\\timperativeModal.open({\\n\\t\\t\\t\\t\\tcomponent: GenericModal,\\n\\t\\t\\t\\t\\tprops: {\\n\\t\\t\\t\\t\\t\\ttitle: t('Screen_Share'),\\n\\t\\t\\t\\t\\t\\tvariant: 'warning',\\n\\t\\t\\t\\t\\t\\tconfirmText: t('Install_Extension'),\\n\\t\\t\\t\\t\\t\\tcancelText: t('Cancel'),\\n\\t\\t\\t\\t\\t\\tchildren: t('You_need_install_an_extension_to_allow_screen_sharing'),\\n\\t\\t\\t\\t\\t\\tonConfirm: () => {\\n\\t\\t\\t\\t\\t\\t\\tif (this.navigator === 'chrome') {\\n\\t\\t\\t\\t\\t\\t\\t\\tconst url = 'https://chrome.google.com/webstore/detail/rocketchat-screen-share/nocfbnnmjnndkbipkabodnheejiegccf';\\n\\t\\t\\t\\t\\t\\t\\t\\ttry {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tchrome.webstore.install(url, refresh, () => {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\twindow.open(url);\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\trefresh();\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t\\t\\t\\t\\t} catch (_error) {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tconsole.log(_error);\\n\\t\\t\\t\\t\\t\\t\\t\\t\\twindow.open(url);\\n\\t\\t\\t\\t\\t\\t\\t\\t\\trefresh();\\n\\t\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t\\t} else if (this.navigator === 'firefox') {\\n\\t\\t\\t\\t\\t\\t\\t\\twindow.open('https://addons.mozilla.org/en-GB/firefox/addon/rocketchat-screen-share/');\\n\\t\\t\\t\\t\\t\\t\\t\\trefresh();\\n\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\t\\treturn onError(false);\\n\\t\\t\\t}\\n\\n\\t\\t\\tconst getScreenSuccess = (stream) => {\\n\\t\\t\\t\\tif (audioStream != null) {\\n\\t\\t\\t\\t\\tstream.addTrack(audioStream.getAudioTracks()[0]);\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tonSuccess(stream);\\n\\t\\t\\t};\\n\\t\\t\\tif (this.navigator === 'firefox') {\\n\\t\\t\\t\\tmedia = {\\n\\t\\t\\t\\t\\taudio: media.audio,\\n\\t\\t\\t\\t\\tvideo: {\\n\\t\\t\\t\\t\\t\\tmozMediaSource: 'window',\\n\\t\\t\\t\\t\\t\\tmediaSource: 'window',\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t};\\n\\t\\t\\t\\tthis._getUserMedia(media, getScreenSuccess, onError);\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tChromeScreenShare.getSourceId(this.navigator, (id) => {\\n\\t\\t\\t\\t\\tmedia = {\\n\\t\\t\\t\\t\\t\\taudio: false,\\n\\t\\t\\t\\t\\t\\tvideo: {\\n\\t\\t\\t\\t\\t\\t\\tmandatory: {\\n\\t\\t\\t\\t\\t\\t\\t\\tchromeMediaSource: 'desktop',\\n\\t\\t\\t\\t\\t\\t\\t\\tchromeMediaSourceId: id,\\n\\t\\t\\t\\t\\t\\t\\t\\tmaxWidth: 1280,\\n\\t\\t\\t\\t\\t\\t\\t\\tmaxHeight: 720,\\n\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t};\\n\\t\\t\\t\\t\\tthis._getUserMedia(media, getScreenSuccess, onError);\\n\\t\\t\\t\\t});\\n\\t\\t\\t}\\n\\t\\t};\\n\\t\\tif (this.navigator === 'firefox' || media.audio == null || media.audio === false) {\\n\\t\\t\\tgetScreen();\\n\\t\\t} else {\\n\\t\\t\\tconst getAudioSuccess = (audioStream) => {\\n\\t\\t\\t\\tgetScreen(audioStream);\\n\\t\\t\\t};\\n\\t\\t\\tconst getAudioError = () => {\\n\\t\\t\\t\\tgetScreen();\\n\\t\\t\\t};\\n\\n\\t\\t\\tthis._getUserMedia(\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\taudio: media.audio,\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\tgetAudioSuccess,\\n\\t\\t\\t\\tgetAudioError,\\n\\t\\t\\t);\\n\\t\\t}\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param callback {Function}\\n   */\\n\\n\\tgetLocalUserMedia(callback, ...args) {\\n\\t\\tthis.log('getLocalUserMedia', [callback, ...args]);\\n\\t\\tif (this.localStream != null) {\\n\\t\\t\\treturn callback(null, this.localStream);\\n\\t\\t}\\n\\t\\tconst onSuccess = (stream) => {\\n\\t\\t\\tthis.localStream = stream;\\n\\t\\t\\t!this.audioEnabled.get() && this.disableAudio();\\n\\t\\t\\t!this.videoEnabled.get() && this.disableVideo();\\n\\t\\t\\tthis.localUrl.set(stream);\\n\\t\\t\\tconst { peerConnections } = this;\\n\\t\\t\\tObject.entries(peerConnections).forEach(([, peerConnection]) => peerConnection.addStream(stream));\\n\\t\\t\\tdocument.querySelector('video#localVideo').srcObject = stream;\\n\\t\\t\\tcallback(null, this.localStream);\\n\\t\\t};\\n\\t\\tconst onError = (error) => {\\n\\t\\t\\tcallback(false);\\n\\t\\t\\tthis.onError(error);\\n\\t\\t};\\n\\t\\tthis.getUserMedia(this.media, onSuccess, onError);\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param id {String}\\n   */\\n\\n\\tstopPeerConnection = (id) => {\\n\\t\\tconst peerConnection = this.peerConnections[id];\\n\\t\\tif (peerConnection == null) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tdelete this.peerConnections[id];\\n\\t\\tpeerConnection.close();\\n\\t\\tthis.updateRemoteItems();\\n\\t};\\n\\n\\tstopAllPeerConnections() {\\n\\t\\tconst { peerConnections } = this;\\n\\n\\t\\tObject.keys(peerConnections).forEach(this.stopPeerConnection);\\n\\n\\t\\twindow.audioContext && window.audioContext.close();\\n\\t}\\n\\n\\tsetAudioEnabled(enabled = true) {\\n\\t\\tif (this.localStream != null) {\\n\\t\\t\\tthis.localStream.getAudioTracks().forEach((audio) => {\\n\\t\\t\\t\\taudio.enabled = enabled;\\n\\t\\t\\t});\\n\\t\\t\\tthis.audioEnabled.set(enabled);\\n\\t\\t}\\n\\t}\\n\\n\\tdisableAudio() {\\n\\t\\tthis.setAudioEnabled(false);\\n\\t}\\n\\n\\tenableAudio() {\\n\\t\\tthis.setAudioEnabled(true);\\n\\t}\\n\\n\\ttoggleAudio() {\\n\\t\\tif (this.audioEnabled.get()) {\\n\\t\\t\\treturn this.disableAudio();\\n\\t\\t}\\n\\t\\treturn this.enableAudio();\\n\\t}\\n\\n\\tsetVideoEnabled(enabled = true) {\\n\\t\\tif (this.localStream != null) {\\n\\t\\t\\tthis.localStream.getVideoTracks().forEach((video) => {\\n\\t\\t\\t\\tvideo.enabled = enabled;\\n\\t\\t\\t});\\n\\t\\t\\tthis.videoEnabled.set(enabled);\\n\\t\\t}\\n\\t}\\n\\n\\tdisableScreenShare() {\\n\\t\\tthis.setScreenShareEnabled(false);\\n\\t}\\n\\n\\tenableScreenShare() {\\n\\t\\tthis.setScreenShareEnabled(true);\\n\\t}\\n\\n\\tsetScreenShareEnabled(enabled = true) {\\n\\t\\tif (this.localStream != null) {\\n\\t\\t\\tthis.media.desktop = enabled;\\n\\t\\t\\tdelete this.localStream;\\n\\t\\t\\tthis.getLocalUserMedia((err) => {\\n\\t\\t\\t\\tif (err != null) {\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tthis.screenShareEnabled.set(enabled);\\n\\t\\t\\t\\tthis.stopAllPeerConnections();\\n\\t\\t\\t\\tthis.joinCall();\\n\\t\\t\\t});\\n\\t\\t}\\n\\t}\\n\\n\\tdisableVideo() {\\n\\t\\tthis.setVideoEnabled(false);\\n\\t}\\n\\n\\tenableVideo() {\\n\\t\\tthis.setVideoEnabled(true);\\n\\t}\\n\\n\\ttoggleVideo() {\\n\\t\\tif (this.videoEnabled.get()) {\\n\\t\\t\\treturn this.disableVideo();\\n\\t\\t}\\n\\t\\treturn this.enableVideo();\\n\\t}\\n\\n\\tstop() {\\n\\t\\tthis.active = false;\\n\\t\\tthis.monitor = false;\\n\\t\\tthis.remoteMonitoring = false;\\n\\t\\tif (this.localStream != null && typeof this.localStream !== 'undefined') {\\n\\t\\t\\tthis.localStream.getTracks().forEach((track) => track.stop());\\n\\t\\t}\\n\\t\\tthis.localUrl.set(undefined);\\n\\t\\tdelete this.localStream;\\n\\t\\tthis.stopAllPeerConnections();\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param media {Object}\\n  \\t\\t\\taudio {Boolean}\\n  \\t\\t\\tvideo {Boolean}\\n   */\\n\\n\\tstartCall(media = {}, ...args) {\\n\\t\\tthis.log('startCall', [media, ...args]);\\n\\t\\tthis.media = media;\\n\\t\\tthis.getLocalUserMedia(() => {\\n\\t\\t\\tthis.active = true;\\n\\t\\t\\tthis.transport.startCall({\\n\\t\\t\\t\\tmedia: this.media,\\n\\t\\t\\t});\\n\\t\\t});\\n\\t}\\n\\n\\tstartCallAsMonitor(media = {}, ...args) {\\n\\t\\tthis.log('startCallAsMonitor', [media, ...args]);\\n\\t\\tthis.media = media;\\n\\t\\tthis.active = true;\\n\\t\\tthis.monitor = true;\\n\\t\\tthis.transport.startCall({\\n\\t\\t\\tmedia: this.media,\\n\\t\\t\\tmonitor: true,\\n\\t\\t});\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param data {Object}\\n  \\t\\t\\tfrom {String}\\n  \\t\\t\\tmonitor {Boolean}\\n  \\t\\t\\tmedia {Object}\\n  \\t\\t\\t\\taudio {Boolean}\\n  \\t\\t\\t\\tvideo {Boolean}\\n   */\\n\\n\\tonRemoteCall(data) {\\n\\t\\tif (this.autoAccept === true) {\\n\\t\\t\\tsetTimeout(() => {\\n\\t\\t\\t\\tthis.joinCall({\\n\\t\\t\\t\\t\\tto: data.from,\\n\\t\\t\\t\\t\\tmonitor: data.monitor,\\n\\t\\t\\t\\t\\tmedia: data.media,\\n\\t\\t\\t\\t});\\n\\t\\t\\t}, 0);\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tconst user = Meteor.users.findOne(data.from);\\n\\t\\tlet fromUsername = undefined;\\n\\t\\tif (user && user.username) {\\n\\t\\t\\tfromUsername = user.username;\\n\\t\\t}\\n\\t\\tconst subscription = ChatSubscription.findOne({\\n\\t\\t\\trid: data.room,\\n\\t\\t});\\n\\n\\t\\tlet icon;\\n\\t\\tlet title;\\n\\t\\tif (data.monitor === true) {\\n\\t\\t\\ticon = 'eye';\\n\\t\\t\\ttitle = t('WebRTC_monitor_call_from_%s', fromUsername);\\n\\t\\t} else if (subscription && subscription.t === 'd') {\\n\\t\\t\\tif (data.media && data.media.video) {\\n\\t\\t\\t\\ticon = 'videocam';\\n\\t\\t\\t\\ttitle = t('WebRTC_direct_video_call_from_%s', fromUsername);\\n\\t\\t\\t} else {\\n\\t\\t\\t\\ticon = 'phone';\\n\\t\\t\\t\\ttitle = t('WebRTC_direct_audio_call_from_%s', fromUsername);\\n\\t\\t\\t}\\n\\t\\t} else if (data.media && data.media.video) {\\n\\t\\t\\ticon = 'videocam';\\n\\t\\t\\ttitle = t('WebRTC_group_video_call_from_%s', subscription.name);\\n\\t\\t} else {\\n\\t\\t\\ticon = 'phone';\\n\\t\\t\\ttitle = t('WebRTC_group_audio_call_from_%s', subscription.name);\\n\\t\\t}\\n\\n\\t\\timperativeModal.open({\\n\\t\\t\\tcomponent: GenericModal,\\n\\t\\t\\tprops: {\\n\\t\\t\\t\\ttitle,\\n\\t\\t\\t\\ticon,\\n\\t\\t\\t\\tconfirmText: t('Yes'),\\n\\t\\t\\t\\tcancelText: t('No'),\\n\\t\\t\\t\\tchildren: t('Do_you_want_to_accept'),\\n\\t\\t\\t\\tonConfirm: () => {\\n\\t\\t\\t\\t\\tgoToRoomById(data.room);\\n\\t\\t\\t\\t\\treturn this.joinCall({\\n\\t\\t\\t\\t\\t\\tto: data.from,\\n\\t\\t\\t\\t\\t\\tmonitor: data.monitor,\\n\\t\\t\\t\\t\\t\\tmedia: data.media,\\n\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\tonCancel: () => this.stop(),\\n\\t\\t\\t\\tonClose: () => this.stop(),\\n\\t\\t\\t},\\n\\t\\t});\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param data {Object}\\n  \\t\\t\\tto {String}\\n  \\t\\t\\tmonitor {Boolean}\\n  \\t\\t\\tmedia {Object}\\n  \\t\\t\\t\\taudio {Boolean}\\n  \\t\\t\\t\\tvideo {Boolean}\\n  \\t\\t\\t\\tdesktop {Boolean}\\n   */\\n\\n\\tjoinCall(data = {}, ...args) {\\n\\t\\tdata.media = this.media;\\n\\t\\tthis.log('joinCall', [data, ...args]);\\n\\t\\tthis.getLocalUserMedia(() => {\\n\\t\\t\\tthis.remoteMonitoring = data.monitor;\\n\\t\\t\\tthis.active = true;\\n\\t\\t\\tthis.transport.joinCall(data);\\n\\t\\t});\\n\\t}\\n\\n\\tonRemoteJoin(data, ...args) {\\n\\t\\tif (this.active !== true) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tthis.log('onRemoteJoin', [data, ...args]);\\n\\t\\tlet peerConnection = this.getPeerConnection(data.from);\\n\\n\\t\\t// needsRefresh = false\\n\\t\\t// if peerConnection.iceConnectionState isnt 'new'\\n\\t\\t// needsAudio = data.media.audio is true and peerConnection.remoteMedia.audio isnt true\\n\\t\\t// needsVideo = data.media.video is true and peerConnection.remoteMedia.video isnt true\\n\\t\\t// needsRefresh = needsAudio or needsVideo or data.media.desktop isnt peerConnection.remoteMedia.desktop\\n\\n\\t\\t// # if peerConnection.signalingState is \\\"have-local-offer\\\" or needsRefresh\\n\\n\\t\\tif (peerConnection.signalingState !== 'checking') {\\n\\t\\t\\tthis.stopPeerConnection(data.from);\\n\\t\\t\\tpeerConnection = this.getPeerConnection(data.from);\\n\\t\\t}\\n\\t\\tif (peerConnection.iceConnectionState !== 'new') {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tpeerConnection.remoteMedia = data.media;\\n\\t\\tif (this.localStream) {\\n\\t\\t\\tpeerConnection.addStream(this.localStream);\\n\\t\\t}\\n\\t\\tconst onOffer = (offer) => {\\n\\t\\t\\tconst onLocalDescription = () => {\\n\\t\\t\\t\\tthis.transport.sendDescription({\\n\\t\\t\\t\\t\\tto: data.from,\\n\\t\\t\\t\\t\\ttype: 'offer',\\n\\t\\t\\t\\t\\tts: peerConnection.createdAt,\\n\\t\\t\\t\\t\\tmedia: this.media,\\n\\t\\t\\t\\t\\tdescription: {\\n\\t\\t\\t\\t\\t\\tsdp: offer.sdp,\\n\\t\\t\\t\\t\\t\\ttype: offer.type,\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t});\\n\\t\\t\\t};\\n\\n\\t\\t\\tpeerConnection.setLocalDescription(new RTCSessionDescription(offer), onLocalDescription, this.onError);\\n\\t\\t};\\n\\n\\t\\tif (data.monitor === true) {\\n\\t\\t\\tpeerConnection.createOffer(onOffer, this.onError, {\\n\\t\\t\\t\\tmandatory: {\\n\\t\\t\\t\\t\\tOfferToReceiveAudio: data.media.audio,\\n\\t\\t\\t\\t\\tOfferToReceiveVideo: data.media.video,\\n\\t\\t\\t\\t},\\n\\t\\t\\t});\\n\\t\\t} else {\\n\\t\\t\\tpeerConnection.createOffer(onOffer, this.onError);\\n\\t\\t}\\n\\t}\\n\\n\\tonRemoteOffer(data, ...args) {\\n\\t\\tif (this.active !== true) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tthis.log('onRemoteOffer', [data, ...args]);\\n\\t\\tlet peerConnection = this.getPeerConnection(data.from);\\n\\n\\t\\tif (['have-local-offer', 'stable'].includes(peerConnection.signalingState) && peerConnection.createdAt < data.ts) {\\n\\t\\t\\tthis.stopPeerConnection(data.from);\\n\\t\\t\\tpeerConnection = this.getPeerConnection(data.from);\\n\\t\\t}\\n\\n\\t\\tif (peerConnection.iceConnectionState !== 'new') {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tpeerConnection.setRemoteDescription(new RTCSessionDescription(data.description));\\n\\n\\t\\ttry {\\n\\t\\t\\tif (this.localStream) {\\n\\t\\t\\t\\tpeerConnection.addStream(this.localStream);\\n\\t\\t\\t}\\n\\t\\t} catch (error) {\\n\\t\\t\\tconsole.log(error);\\n\\t\\t}\\n\\n\\t\\tconst onAnswer = (answer) => {\\n\\t\\t\\tconst onLocalDescription = () => {\\n\\t\\t\\t\\tthis.transport.sendDescription({\\n\\t\\t\\t\\t\\tto: data.from,\\n\\t\\t\\t\\t\\ttype: 'answer',\\n\\t\\t\\t\\t\\tts: peerConnection.createdAt,\\n\\t\\t\\t\\t\\tdescription: {\\n\\t\\t\\t\\t\\t\\tsdp: answer.sdp,\\n\\t\\t\\t\\t\\t\\ttype: answer.type,\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t});\\n\\t\\t\\t};\\n\\n\\t\\t\\tpeerConnection.setLocalDescription(new RTCSessionDescription(answer), onLocalDescription, this.onError);\\n\\t\\t};\\n\\n\\t\\tpeerConnection.createAnswer(onAnswer, this.onError);\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param data {Object}\\n  \\t\\t\\tto {String}\\n  \\t\\t\\tfrom {String}\\n  \\t\\t\\tcandidate {RTCIceCandidate JSON encoded}\\n   */\\n\\n\\tonRemoteCandidate(data, ...args) {\\n\\t\\tif (this.active !== true) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tif (data.to !== this.selfId) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tthis.log('onRemoteCandidate', [data, ...args]);\\n\\t\\tconst peerConnection = this.getPeerConnection(data.from);\\n\\t\\tif (\\n\\t\\t\\tpeerConnection.iceConnectionState !== 'closed' &&\\n\\t\\t\\tpeerConnection.iceConnectionState !== 'failed' &&\\n\\t\\t\\tpeerConnection.iceConnectionState !== 'disconnected' &&\\n\\t\\t\\tpeerConnection.iceConnectionState !== 'completed'\\n\\t\\t) {\\n\\t\\t\\tpeerConnection.addIceCandidate(new RTCIceCandidate(data.candidate));\\n\\t\\t}\\n\\t\\tdocument.querySelector('video#remoteVideo').srcObject = this.remoteItems.get()[0]?.url;\\n\\t}\\n\\n\\t/*\\n  \\t\\t@param data {Object}\\n  \\t\\t\\tto {String}\\n  \\t\\t\\tfrom {String}\\n  \\t\\t\\ttype {String} [offer, answer]\\n  \\t\\t\\tdescription {RTCSessionDescription JSON encoded}\\n  \\t\\t\\tts {Integer}\\n  \\t\\t\\tmedia {Object}\\n  \\t\\t\\t\\taudio {Boolean}\\n  \\t\\t\\t\\tvideo {Boolean}\\n  \\t\\t\\t\\tdesktop {Boolean}\\n   */\\n\\n\\tonRemoteDescription(data, ...args) {\\n\\t\\tif (this.active !== true) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tif (data.to !== this.selfId) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tthis.log('onRemoteDescription', [data, ...args]);\\n\\t\\tconst peerConnection = this.getPeerConnection(data.from);\\n\\t\\tif (data.type === 'offer') {\\n\\t\\t\\tpeerConnection.remoteMedia = data.media;\\n\\t\\t\\tthis.onRemoteOffer({\\n\\t\\t\\t\\tfrom: data.from,\\n\\t\\t\\t\\tts: data.ts,\\n\\t\\t\\t\\tdescription: data.description,\\n\\t\\t\\t});\\n\\t\\t} else {\\n\\t\\t\\tpeerConnection.setRemoteDescription(new RTCSessionDescription(data.description));\\n\\t\\t}\\n\\t}\\n}\\n\\nconst WebRTC = new (class {\\n\\tconstructor() {\\n\\t\\tthis.instancesByRoomId = {};\\n\\t}\\n\\n\\tgetInstanceByRoomId(rid, visitorId = null) {\\n\\t\\tlet enabled = false;\\n\\t\\tif (!visitorId) {\\n\\t\\t\\tconst subscription = ChatSubscription.findOne({ rid });\\n\\t\\t\\tif (!subscription) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t\\tswitch (subscription.t) {\\n\\t\\t\\t\\tcase 'd':\\n\\t\\t\\t\\t\\tenabled = settings.get('WebRTC_Enable_Direct');\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\tcase 'p':\\n\\t\\t\\t\\t\\tenabled = settings.get('WebRTC_Enable_Private');\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\tcase 'c':\\n\\t\\t\\t\\t\\tenabled = settings.get('WebRTC_Enable_Channel');\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\tcase 'l':\\n\\t\\t\\t\\t\\tenabled = settings.get('Omnichannel_call_provider') === 'WebRTC';\\n\\t\\t\\t}\\n\\t\\t} else {\\n\\t\\t\\tenabled = settings.get('Omnichannel_call_provider') === 'WebRTC';\\n\\t\\t}\\n\\t\\tenabled = enabled && settings.get('WebRTC_Enabled');\\n\\t\\tif (enabled === false) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tif (this.instancesByRoomId[rid] == null) {\\n\\t\\t\\tlet uid = Meteor.userId();\\n\\t\\t\\tlet autoAccept = false;\\n\\t\\t\\tif (visitorId) {\\n\\t\\t\\t\\tuid = visitorId;\\n\\t\\t\\t\\tautoAccept = true;\\n\\t\\t\\t}\\n\\t\\t\\tthis.instancesByRoomId[rid] = new WebRTCClass(uid, rid, autoAccept);\\n\\t\\t}\\n\\t\\treturn this.instancesByRoomId[rid];\\n\\t}\\n})();\\n\\nMeteor.startup(() => {\\n\\tTracker.autorun(() => {\\n\\t\\tif (Meteor.userId()) {\\n\\t\\t\\tsdk.stream('notify-user', [`${Meteor.userId()}/${WEB_RTC_EVENTS.WEB_RTC}`], (type, data) => {\\n\\t\\t\\t\\tif (data.room == null) {\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tconst webrtc = WebRTC.getInstanceByRoomId(data.room);\\n\\t\\t\\t\\twebrtc.onUserStream(type, data);\\n\\t\\t\\t});\\n\\t\\t}\\n\\t});\\n});\\n\\nexport { WebRTC };\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_toConsumableArray\",\"_slicedToArray\",\"_inheritsLoose\",\"export\",\"WebRTC\",\"Emitter\",\"Meteor\",\"ReactiveVar\",\"Tracker\",\"GenericModal\",\"imperativeModal\",\"goToRoomById\",\"ChatSubscription\",\"settings\",\"sdk\",\"t\",\"WEB_RTC_EVENTS\",\"ChromeScreenShare\",\"WebRTCTransportClass\",\"_Emitter\",\"webrtcInstance\",\"_this\",\"call\",\"debug\",\"stream\",\"room\",\"WEB_RTC\",\"type\",\"data\",\"log\",\"emit\",\"_proto\",\"prototype\",\"_console\",\"console\",\"apply\",\"arguments\",\"onUserStream\",\"startCall\",\"selfId\",\"publish\",\"CALL\",\"from\",\"media\",\"monitor\",\"joinCall\",\"to\",\"JOIN\",\"sendCandidate\",\"CANDIDATE\",\"sendDescription\",\"DESCRIPTION\",\"sendStatus\",\"STATUS\",\"onRemoteCall\",\"fn\",\"on\",\"onRemoteJoin\",\"onRemoteCandidate\",\"onRemoteDescription\",\"onRemoteStatus\",\"WebRTCClass\",\"_this2\",\"autoAccept\",\"length\",\"undefined\",\"resetCallInProgress\",\"callInProgress\",\"set\",\"stopPeerConnection\",\"id\",\"peerConnection\",\"peerConnections\",\"close\",\"updateRemoteItems\",\"config\",\"iceServers\",\"TransportClass\",\"servers\",\"get\",\"trim\",\"replace\",\"split\",\"forEach\",\"server\",\"serverConfig\",\"urls\",\"pop\",\"username\",\"decodeURIComponent\",\"credential\",\"push\",\"remoteItems\",\"remoteItemsById\",\"audioEnabled\",\"videoEnabled\",\"overlayEnabled\",\"screenShareEnabled\",\"localUrl\",\"active\",\"remoteMonitoring\",\"navigator\",\"userAgent\",\"toLocaleLowerCase\",\"indexOf\",\"screenShareAvailable\",\"includes\",\"video\",\"audio\",\"transport\",\"bind\",\"setInterval\",\"checkPeerConnections\",\"_proto2\",\"_this$transport\",\"_len\",\"args\",\"Array\",\"_key\",\"onError\",\"_len2\",\"_key2\",\"error\",\"_this3\",\"date\",\"Date\",\"now\",\"Object\",\"entries\",\"some\",\"_ref\",\"_ref2\",\"iceConnectionState\",\"createdAt\",\"items\",\"itemsById\",\"_ref3\",\"_ref4\",\"getRemoteStreams\",\"remoteStream\",\"item\",\"url\",\"state\",\"stateText\",\"connected\",\"broadcastStatus\",\"remoteConnections\",\"keys\",\"_ref5\",\"_ref6\",\"remoteMedia\",\"_this4\",\"clearTimeout\",\"callInProgressTimeout\",\"setTimeout\",\"concat\",\"remoteConnection\",\"getPeerConnection\",\"_this5\",\"RTCPeerConnection\",\"eventNames\",\"eventName\",\"addEventListener\",\"e\",\"candidate\",\"sdpMLineIndex\",\"sdpMid\",\"stop\",\"_getUserMedia\",\"onSuccess\",\"_this6\",\"onSuccessLocal\",\"AudioContext\",\"getAudioTracks\",\"audioContext\",\"source\",\"createMediaStreamSource\",\"volume\",\"createGain\",\"connect\",\"peer\",\"createMediaStreamDestination\",\"gain\",\"value\",\"removeTrack\",\"addTrack\",\"mediaDevices\",\"getUserMedia\",\"then\",\"catch\",\"_this7\",\"desktop\",\"getScreen\",\"audioStream\",\"refresh\",\"open\",\"component\",\"props\",\"variant\",\"title\",\"isChromeExtensionInstalled\",\"installed\",\"isFirefoxExtensionInstalled\",\"window\",\"rocketchatscreenshare\",\"confirmText\",\"cancelText\",\"children\",\"onConfirm\",\"chrome\",\"webstore\",\"install\",\"_error\",\"getScreenSuccess\",\"mozMediaSource\",\"mediaSource\",\"getSourceId\",\"mandatory\",\"chromeMediaSource\",\"chromeMediaSourceId\",\"maxWidth\",\"maxHeight\",\"getLocalUserMedia\",\"callback\",\"_this8\",\"_len3\",\"_key3\",\"localStream\",\"disableAudio\",\"disableVideo\",\"_ref7\",\"_ref8\",\"addStream\",\"document\",\"querySelector\",\"srcObject\",\"stopAllPeerConnections\",\"setAudioEnabled\",\"enabled\",\"enableAudio\",\"toggleAudio\",\"setVideoEnabled\",\"getVideoTracks\",\"disableScreenShare\",\"setScreenShareEnabled\",\"enableScreenShare\",\"_this9\",\"err\",\"enableVideo\",\"toggleVideo\",\"getTracks\",\"track\",\"_this10\",\"_len4\",\"_key4\",\"startCallAsMonitor\",\"_len5\",\"_key5\",\"icon\",\"_this11\",\"user\",\"users\",\"findOne\",\"fromUsername\",\"subscription\",\"rid\",\"name\",\"onCancel\",\"onClose\",\"_this12\",\"_len6\",\"_key6\",\"_this13\",\"_len7\",\"_key7\",\"signalingState\",\"onOffer\",\"offer\",\"setLocalDescription\",\"RTCSessionDescription\",\"ts\",\"description\",\"sdp\",\"createOffer\",\"OfferToReceiveAudio\",\"OfferToReceiveVideo\",\"onRemoteOffer\",\"_this14\",\"_len8\",\"_key8\",\"setRemoteDescription\",\"createAnswer\",\"answer\",\"_this$remoteItems$get\",\"_len9\",\"_key9\",\"addIceCandidate\",\"RTCIceCandidate\",\"_len10\",\"_key10\",\"_class\",\"instancesByRoomId\",\"_proto3\",\"getInstanceByRoomId\",\"visitorId\",\"uid\",\"userId\",\"startup\",\"autorun\",\"webrtc\"],\"mappings\":\"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\"}"}