{"code":"function module(e,n,u){u.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){o=e}},0),u.export({useComposerBoxPopupQueries:function(){return a}}),u.link(\"@tanstack/react-query\",{useQueries:function(e){r=e}},0),u.link(\"react\",{useEffect:function(e){t=e},useState:function(e){i=e}},1),u.link(\"../../../../../app/utils/client/slashCommand\",{slashCommands:function(e){s=e}},2),u.link(\"./useEnablePopupPreview\",{useEnablePopupPreview:function(e){l=e}},3);var o,r,t,i,s,l,a=function(e,n){var u=i(0),a=o(u,2),c=a[0],m=a[1];t(function(){m(0)},[n,e]);var p=l(e,n),d=!n||n.preview&&!!s.commands[null==e?void 0:e.cmd]&&s.commands[null==e?void 0:e.cmd].providesPreview||p;return{queries:r({queries:[(null==n?void 0:n.getItemsFromLocal)&&{keepPreviousData:!0,queryKey:[\"message-popup\",\"local\",e,n],queryFn:function(){return(null==n?void 0:n.getItemsFromLocal)&&n.getItemsFromLocal(e)},onSuccess:function(e){e.length<5&&m(1)},enabled:d},(null==n?void 0:n.getItemsFromServer)&&{keepPreviousData:!0,queryKey:[\"message-popup\",\"server\",e,n],queryFn:function(){return(null==n?void 0:n.getItemsFromServer)&&n.getItemsFromServer(e)},enabled:c>0}].filter(Boolean)}),suspended:!d}}}","map":"{\"version\":3,\"sources\":[\"client/views/room/composer/hooks/useComposerBoxPopupQueries.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { QueriesResults } from '@tanstack/react-query';\\nimport { useQueries } from '@tanstack/react-query';\\nimport { useEffect, useState } from 'react';\\n\\nimport { slashCommands } from '../../../../../app/utils/client/slashCommand';\\nimport type { ComposerPopupOption } from '../../contexts/ComposerPopupContext';\\nimport { useEnablePopupPreview } from './useEnablePopupPreview';\\n\\nexport const useComposerBoxPopupQueries = <T extends { _id: string; sort?: number }>(filter: unknown, popup?: ComposerPopupOption<T>) => {\\n\\tconst [counter, setCounter] = useState(0);\\n\\n\\tuseEffect(() => {\\n\\t\\tsetCounter(0);\\n\\t}, [popup, filter]);\\n\\n\\tconst shouldPopupPreview = useEnablePopupPreview(filter, popup);\\n\\n\\tconst enableQuery =\\n\\t\\t!popup ||\\n\\t\\t(popup.preview &&\\n\\t\\t\\tBoolean(slashCommands.commands[(filter as any)?.cmd]) &&\\n\\t\\t\\tslashCommands.commands[(filter as any)?.cmd].providesPreview) ||\\n\\t\\tshouldPopupPreview;\\n\\n\\treturn {\\n\\t\\tqueries: useQueries({\\n\\t\\t\\tqueries: [\\n\\t\\t\\t\\tpopup?.getItemsFromLocal && {\\n\\t\\t\\t\\t\\tkeepPreviousData: true,\\n\\t\\t\\t\\t\\tqueryKey: ['message-popup', 'local', filter, popup],\\n\\t\\t\\t\\t\\tqueryFn: () => popup?.getItemsFromLocal && popup.getItemsFromLocal(filter),\\n\\t\\t\\t\\t\\tonSuccess: (args: T[]) => {\\n\\t\\t\\t\\t\\t\\tif (args.length < 5) {\\n\\t\\t\\t\\t\\t\\t\\tsetCounter(1);\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\tenabled: enableQuery,\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\tpopup?.getItemsFromServer && {\\n\\t\\t\\t\\t\\tkeepPreviousData: true,\\n\\t\\t\\t\\t\\tqueryKey: ['message-popup', 'server', filter, popup],\\n\\t\\t\\t\\t\\tqueryFn: () => popup?.getItemsFromServer && popup.getItemsFromServer(filter),\\n\\t\\t\\t\\t\\tenabled: counter > 0,\\n\\t\\t\\t\\t},\\n\\t\\t\\t].filter(Boolean) as any,\\n\\t\\t}) as QueriesResults<T[]>,\\n\\t\\tsuspended: !enableQuery,\\n\\t};\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_slicedToArray\",\"export\",\"useComposerBoxPopupQueries\",\"useQueries\",\"useEffect\",\"useState\",\"slashCommands\",\"useEnablePopupPreview\",\"filter\",\"popup\",\"_useState\",\"_useState2\",\"counter\",\"setCounter\",\"shouldPopupPreview\",\"enableQuery\",\"preview\",\"Boolean\",\"commands\",\"cmd\",\"providesPreview\",\"queries\",\"getItemsFromLocal\",\"keepPreviousData\",\"queryKey\",\"queryFn\",\"onSuccess\",\"args\",\"length\",\"enabled\",\"getItemsFromServer\",\"suspended\"],\"mappings\":\"uBACmBA,EAAEC,IAAM,CAAA,uCAAwB,CAAAC,QAAA,SAAAC,CAAA,EAAAC,EAAAD,CAAA,CAAA,EAAA,GAAnDH,EAAOK,MAAE,CAAA,CAAAC,2BAAkB,WAAwB,OAAAA,CAAA,CAAA,GAAAN,EAAAC,IAAA,CAAA,wBAAA,CAAAM,WAAA,SAAAJ,CAAA,EAAAI,EAAAJ,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAAO,UAAA,SAAAL,CAAA,EAAAK,EAAAL,CAAA,EAAAM,SAAA,SAAAN,CAAA,EAAAM,EAAAN,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,+CAAA,CAAAS,cAAA,SAAAP,CAAA,EAAAO,EAAAP,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,0BAAA,CAAAU,sBAAA,SAAAR,CAAA,EAAAQ,EAAAR,CAAA,CAAA,EAAA,GAO5C,IAPPC,EAAmDG,EAAAC,EAAAC,EAAAC,EAAAC,EAOtCL,EAA6B,SAA2CM,CAAe,CAAEC,CAA8B,EACnI,IAAAC,EAA8BL,EAAS,GAAEM,EAAAX,EAAAU,EAAA,GAAlCE,EAAOD,CAAA,CAAA,EAAA,CAAEE,EAAUF,CAAA,CAAA,EAAA,CAE1BP,EAAU,WACTS,EAAW,EACZ,EAAG,CAACJ,EAAOD,EAAO,EAElB,IAAMM,EAAqBP,EAAsBC,EAAQC,GAEnDM,EACL,CAACN,GACAA,EAAMO,OAAO,EACbC,CAAAA,CAAQX,EAAcY,QAAQ,CAAEV,MAAAA,EAAc,KAAA,EAAdA,EAAgBW,GAAG,CAAC,EACpDb,EAAcY,QAAQ,CAAEV,MAAAA,EAAc,KAAA,EAAdA,EAAgBW,GAAG,CAAC,CAACC,eAAgB,EAC9DN,EAED,MAAO,CACNO,QAASlB,EAAW,CACnBkB,QAAS,CACR,AAAAZ,CAAAA,MAAAA,EAAK,KAAA,EAALA,EAAOa,iBAAiB,AAAjBA,GAAqB,CAC3BC,iBAAkB,CAAA,EAClBC,SAAU,CAAC,gBAAiB,QAAShB,EAAQC,EAAM,CACnDgB,QAAS,WAAA,MAAM,AAAAhB,CAAAA,MAAAA,EAAK,KAAA,EAALA,EAAOa,iBAAiB,AAAjBA,GAAqBb,EAAMa,iBAAiB,CAACd,EAAO,EAC1EkB,UAAW,SAACC,CAAS,EAChBA,EAAKC,MAAM,CAAG,GACjBf,EAAW,EAEb,EACAgB,QAASd,GAEV,AAAAN,CAAAA,MAAAA,EAAK,KAAA,EAALA,EAAOqB,kBAAkB,AAAlBA,GAAsB,CAC5BP,iBAAkB,CAAA,EAClBC,SAAU,CAAC,gBAAiB,SAAUhB,EAAQC,EAAM,CACpDgB,QAAS,WAAA,MAAM,AAAAhB,CAAAA,MAAAA,EAAK,KAAA,EAALA,EAAOqB,kBAAkB,AAAlBA,GAAsBrB,EAAMqB,kBAAkB,CAACtB,EAAO,EAC5EqB,QAASjB,EAAU,GAEpB,CAACJ,MAAM,CAACS,WAEVc,UAAW,CAAChB,EAEd\"}"}