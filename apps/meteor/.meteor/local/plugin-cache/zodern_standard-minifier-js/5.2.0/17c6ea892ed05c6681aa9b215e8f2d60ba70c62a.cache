{"code":"function module(e,n,t){t.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){o=e}},0),t.link(\"@babel/runtime/regenerator\",{default:function(e){i=e}},1),t.export({useEditRoomPermissions:function(){return R}}),t.link(\"@rocket.chat/ui-contexts\",{usePermission:function(e){a=e},useAtLeastOnePermission:function(e){r=e},useRole:function(e){c=e},useEndpoint:function(e){u=e}},0),t.link(\"@tanstack/react-query\",{useQuery:function(e){l=e}},1),t.link(\"react\",{useMemo:function(e){d=e}},2),t.link(\"../../../../../../app/e2e/client/E2EEState\",{E2EEState:function(e){s=e}},3),t.link(\"../../../../../../definition/IRoomTypeConfig\",{RoomSettingsEnum:function(e){E=e}},4),t.link(\"../../../../../lib/rooms/roomCoordinator\",{roomCoordinator:function(e){m=e}},5),t.link(\"../../../hooks/useE2EEState\",{useE2EEState:function(e){f=e}},6);var o,i,a,r,c,u,l,d,s,E,m,f,R=function(e){var n,t,R=c(\"admin\"),p=f(),y=p===s.READY||p===s.SAVE_PASSWORD,S=a(\"create-c\"),v=a(\"create-p\"),A=u(\"GET\",\"/v1/teams.info\"),h=e.teamId||\"\",I=l([\"teamId\",h],function(){return i.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",A({teamId:h}));case 1:case\"end\":return e.stop()}},null,null,null,Promise)},{keepPreviousData:!0,retry:!1,enabled:\"\"!==e.teamId}).data,O=a(\"create-team-channel\",null==I?void 0:I.teamInfo.roomId),w=a(\"create-team-group\",null==I?void 0:I.teamInfo.roomId),V=(n=h?O:S,t=h?w:v,(!e.default||R)&&(\"p\"===e.t&&n||\"c\"===e.t&&t)),_=a(\"set-readonly\",e._id),k=a(\"set-react-when-readonly\",e._id),C=a(\"edit-room-retention-policy\",e._id),T=r(d(function(){return[\"archive-room\",\"unarchive-room\"]},[]),e._id),g=a(\"toggle-room-e2e-encryption\",e._id)&&(e.encrypted||y),N=d(function(){var n,t=(null===(n=m.getRoomDirectives(e.t))||void 0===n?void 0:n.allowRoomSettingChange)||function(){};return[t(e,E.NAME),t(e,E.TOPIC),t(e,E.ANNOUNCEMENT),t(e,E.ARCHIVE_OR_UNARCHIVE),t(e,E.DESCRIPTION),t(e,E.TYPE),t(e,E.READ_ONLY),t(e,E.SYSTEM_MESSAGES),t(e,E.JOIN_CODE),t(e,E.REACT_WHEN_READ_ONLY),t(e,E.E2E)]},[e]),P=o(N,11);return{canChangeType:V,canSetReadOnly:_,canSetReactWhenReadOnly:k,canEditRoomRetentionPolicy:C,canArchiveOrUnarchive:T,canToggleEncryption:g,canViewName:P[0],canViewTopic:P[1],canViewAnnouncement:P[2],canViewArchived:P[3],canViewDescription:P[4],canViewType:P[5],canViewReadOnly:P[6],canViewHideSysMes:P[7],canViewJoinCode:P[8],canViewReactWhenReadOnly:P[9],canViewEncrypted:P[10]}}}","map":"{\"version\":3,\"sources\":[\"client/views/room/contextualBar/Info/EditRoomInfo/useEditRoomPermissions.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom, IRoomWithRetentionPolicy } from '@rocket.chat/core-typings';\\nimport { usePermission, useAtLeastOnePermission, useRole, useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useQuery } from '@tanstack/react-query';\\nimport { useMemo } from 'react';\\n\\nimport { E2EEState } from '../../../../../../app/e2e/client/E2EEState';\\nimport { RoomSettingsEnum } from '../../../../../../definition/IRoomTypeConfig';\\nimport { roomCoordinator } from '../../../../../lib/rooms/roomCoordinator';\\nimport { useE2EEState } from '../../../hooks/useE2EEState';\\n\\nconst getCanChangeType = (room: IRoom | IRoomWithRetentionPolicy, canCreateChannel: boolean, canCreateGroup: boolean, isAdmin: boolean) =>\\n\\t(!room.default || isAdmin) && ((room.t === 'p' && canCreateChannel) || (room.t === 'c' && canCreateGroup));\\n\\nexport const useEditRoomPermissions = (room: IRoom | IRoomWithRetentionPolicy) => {\\n\\tconst isAdmin = useRole('admin');\\n\\tconst e2eeState = useE2EEState();\\n\\tconst isE2EEReady = e2eeState === E2EEState.READY || e2eeState === E2EEState.SAVE_PASSWORD;\\n\\tconst canCreateChannel = usePermission('create-c');\\n\\tconst canCreateGroup = usePermission('create-p');\\n\\tconst teamsInfoEndpoint = useEndpoint('GET', '/v1/teams.info');\\n\\n\\tconst teamId = room.teamId || '';\\n\\tconst { data: teamInfoData } = useQuery(['teamId', teamId], async () => teamsInfoEndpoint({ teamId }), {\\n\\t\\tkeepPreviousData: true,\\n\\t\\tretry: false,\\n\\t\\tenabled: room.teamId !== '',\\n\\t});\\n\\n\\tconst canCreateTeamChannel = usePermission('create-team-channel', teamInfoData?.teamInfo.roomId);\\n\\tconst canCreateTeamGroup = usePermission('create-team-group', teamInfoData?.teamInfo.roomId);\\n\\n\\tconst canChangeType = getCanChangeType(\\n\\t\\troom,\\n\\t\\tteamId ? canCreateTeamChannel : canCreateChannel,\\n\\t\\tteamId ? canCreateTeamGroup : canCreateGroup,\\n\\t\\tisAdmin,\\n\\t);\\n\\tconst canSetReadOnly = usePermission('set-readonly', room._id);\\n\\tconst canSetReactWhenReadOnly = usePermission('set-react-when-readonly', room._id);\\n\\tconst canEditRoomRetentionPolicy = usePermission('edit-room-retention-policy', room._id);\\n\\tconst canArchiveOrUnarchive = useAtLeastOnePermission(\\n\\t\\tuseMemo(() => ['archive-room', 'unarchive-room'], []),\\n\\t\\troom._id,\\n\\t);\\n\\tconst canToggleEncryption = usePermission('toggle-room-e2e-encryption', room._id) && (room.encrypted || isE2EEReady);\\n\\n\\tconst [\\n\\t\\tcanViewName,\\n\\t\\tcanViewTopic,\\n\\t\\tcanViewAnnouncement,\\n\\t\\tcanViewArchived,\\n\\t\\tcanViewDescription,\\n\\t\\tcanViewType,\\n\\t\\tcanViewReadOnly,\\n\\t\\tcanViewHideSysMes,\\n\\t\\tcanViewJoinCode,\\n\\t\\tcanViewReactWhenReadOnly,\\n\\t\\tcanViewEncrypted,\\n\\t] = useMemo(() => {\\n\\t\\tconst isAllowed =\\n\\t\\t\\troomCoordinator.getRoomDirectives(room.t)?.allowRoomSettingChange ||\\n\\t\\t\\t(() => {\\n\\t\\t\\t\\tundefined;\\n\\t\\t\\t});\\n\\t\\treturn [\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.NAME),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.TOPIC),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.ANNOUNCEMENT),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.ARCHIVE_OR_UNARCHIVE),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.DESCRIPTION),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.TYPE),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.READ_ONLY),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.SYSTEM_MESSAGES),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.JOIN_CODE),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.REACT_WHEN_READ_ONLY),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.E2E),\\n\\t\\t];\\n\\t}, [room]);\\n\\n\\treturn {\\n\\t\\tcanChangeType,\\n\\t\\tcanSetReadOnly,\\n\\t\\tcanSetReactWhenReadOnly,\\n\\t\\tcanEditRoomRetentionPolicy,\\n\\t\\tcanArchiveOrUnarchive,\\n\\t\\tcanToggleEncryption,\\n\\t\\tcanViewName,\\n\\t\\tcanViewTopic,\\n\\t\\tcanViewAnnouncement,\\n\\t\\tcanViewArchived,\\n\\t\\tcanViewDescription,\\n\\t\\tcanViewType,\\n\\t\\tcanViewReadOnly,\\n\\t\\tcanViewHideSysMes,\\n\\t\\tcanViewJoinCode,\\n\\t\\tcanViewReactWhenReadOnly,\\n\\t\\tcanViewEncrypted,\\n\\t};\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_slicedToArray\",\"_regeneratorRuntime\",\"export\",\"useEditRoomPermissions\",\"usePermission\",\"useAtLeastOnePermission\",\"useRole\",\"useEndpoint\",\"useQuery\",\"useMemo\",\"E2EEState\",\"RoomSettingsEnum\",\"roomCoordinator\",\"useE2EEState\",\"room\",\"canCreateChannel\",\"canCreateGroup\",\"isAdmin\",\"e2eeState\",\"isE2EEReady\",\"READY\",\"SAVE_PASSWORD\",\"teamsInfoEndpoint\",\"teamId\",\"teamInfoData\",\"_useQuery\",\"async\",\"_context\",\"prev\",\"next\",\"abrupt\",\"stop\",\"Promise\",\"keepPreviousData\",\"retry\",\"enabled\",\"data\",\"canCreateTeamChannel\",\"teamInfo\",\"roomId\",\"canCreateTeamGroup\",\"canChangeType\",\"t\",\"canSetReadOnly\",\"_id\",\"canSetReactWhenReadOnly\",\"canEditRoomRetentionPolicy\",\"canArchiveOrUnarchive\",\"canToggleEncryption\",\"encrypted\",\"_useMemo\",\"_roomCoordinator$getR\",\"isAllowed\",\"getRoomDirectives\",\"allowRoomSettingChange\",\"NAME\",\"TOPIC\",\"ANNOUNCEMENT\",\"ARCHIVE_OR_UNARCHIVE\",\"DESCRIPTION\",\"TYPE\",\"READ_ONLY\",\"SYSTEM_MESSAGES\",\"JOIN_CODE\",\"REACT_WHEN_READ_ONLY\",\"E2E\",\"_useMemo2\",\"canViewName\",\"canViewTopic\",\"canViewAnnouncement\",\"canViewArchived\",\"canViewDescription\",\"canViewType\",\"canViewReadOnly\",\"canViewHideSysMes\",\"canViewJoinCode\",\"canViewReactWhenReadOnly\",\"canViewEncrypted\"],\"mappings\":\"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\"}"}