{"code":"function module(e,o,n){let i,t,l,a,r,s,d,u,c,f,_,m,C,g,k,h,V;n.link(\"@rocket.chat/core-typings\",{isOmnichannelRoom(e){i=e},isRoomFederated(e){t=e}},0),n.link(\"@rocket.chat/fuselage\",{Box(e){l=e}},1),n.link(\"@rocket.chat/fuselage-hooks\",{useEffectEvent(e){a=e},useStableArray(e){r=e}},2),n.link(\"@rocket.chat/ui-contexts\",{usePermission(e){s=e},useSetting(e){d=e},useUser(e){u=e}},3),n.link(\"react\",{default(e){c=e},useMemo(e){f=e}},4),n.link(\"react-i18next\",{useTranslation(e){_=e}},5),n.link(\"../../../contexts/VideoConfContext\",{useVideoConfDispatchOutgoing(e){m=e},useVideoConfIsCalling(e){C=e},useVideoConfIsRinging(e){g=e}},6),n.link(\"../../../lib/VideoConfManager\",{VideoConfManager(e){k=e}},7),n.link(\"../../../views/room/contexts/RoomContext\",{useRoom(e){h=e}},8),n.link(\"../../../views/room/contextualBar/VideoConference/hooks/useVideoConfWarning\",{useVideoConfWarning(e){V=e}},9),n.exportDefault(()=>{var e,o;let{t:n}=_(),v=h(),p=u(),x=t(v),b=(null===(e=v.uids)||void 0===e?void 0:e.length)===1,E=s(\"post-readonly\",v._id),y=s(\"call-management\",v._id),R=V(),M=m(),w=C(),D=g(),O=d(\"VideoConf_Enable_DMs\",!0),B=d(\"VideoConf_Enable_Channels\",!0),I=d(\"VideoConf_Enable_Teams\",!0),S=d(\"VideoConf_Enable_Groups\",!0),T=\"default-provider\"===d(\"Omnichannel_call_provider\",\"default-provider\"),W=r([O&&\"direct\",O&&\"direct_multiple\",S&&\"group\",T&&\"live\",I&&\"team\",B&&\"channel\"].filter(e=>!!e)),A=W.length>0,F=A&&y&&(!(null!=p&&p.username)||!(null!==(o=v.muted)&&void 0!==o&&o.includes(p.username)))&&!b,G=x||!!v.ro&&!E,P=G?n(\"core.Video_Call_unavailable_for_this_type_of_room\"):\"\",U=i(v)?-1:4,j=a(async()=>{if(!w&&!D)try{await k.loadCapabilities(),M({rid:v._id})}catch(e){R(e.error)}});return f(()=>{let e=[{id:\"start-video-call\",icon:\"video\",disabled:G,onClick:j,content:c.createElement(l,{is:\"span\",title:P},n(\"Video_call\"))}];return{items:e,disabled:G,allowed:F,order:U,groups:W}},[F,G,W,j,U,n,P])})}","map":"{\"version\":3,\"sources\":[\"client/hooks/roomActions/useStartCallRoomAction/useVideoConfMenuOptions.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { isOmnichannelRoom, isRoomFederated } from '@rocket.chat/core-typings';\\nimport { Box } from '@rocket.chat/fuselage';\\nimport { useEffectEvent, useStableArray } from '@rocket.chat/fuselage-hooks';\\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\\nimport { usePermission, useSetting, useUser } from '@rocket.chat/ui-contexts';\\nimport React, { useMemo } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { useVideoConfDispatchOutgoing, useVideoConfIsCalling, useVideoConfIsRinging } from '../../../contexts/VideoConfContext';\\nimport { VideoConfManager } from '../../../lib/VideoConfManager';\\nimport { useRoom } from '../../../views/room/contexts/RoomContext';\\nimport type { RoomToolboxActionConfig } from '../../../views/room/contexts/RoomToolboxContext';\\nimport { useVideoConfWarning } from '../../../views/room/contextualBar/VideoConference/hooks/useVideoConfWarning';\\n\\nconst useVideoConfMenuOptions = () => {\\n\\tconst { t } = useTranslation();\\n\\tconst room = useRoom();\\n\\tconst user = useUser();\\n\\tconst federated = isRoomFederated(room);\\n\\n\\tconst ownUser = room.uids?.length === 1 || false;\\n\\n\\tconst permittedToPostReadonly = usePermission('post-readonly', room._id);\\n\\tconst permittedToCallManagement = usePermission('call-management', room._id);\\n\\n\\tconst dispatchWarning = useVideoConfWarning();\\n\\tconst dispatchPopup = useVideoConfDispatchOutgoing();\\n\\tconst isCalling = useVideoConfIsCalling();\\n\\tconst isRinging = useVideoConfIsRinging();\\n\\n\\tconst enabledForDMs = useSetting('VideoConf_Enable_DMs', true);\\n\\tconst enabledForChannels = useSetting('VideoConf_Enable_Channels', true);\\n\\tconst enabledForTeams = useSetting('VideoConf_Enable_Teams', true);\\n\\tconst enabledForGroups = useSetting('VideoConf_Enable_Groups', true);\\n\\tconst enabledForLiveChat = useSetting('Omnichannel_call_provider', 'default-provider') === 'default-provider';\\n\\n\\tconst groups = useStableArray(\\n\\t\\t[\\n\\t\\t\\tenabledForDMs && 'direct',\\n\\t\\t\\tenabledForDMs && 'direct_multiple',\\n\\t\\t\\tenabledForGroups && 'group',\\n\\t\\t\\tenabledForLiveChat && 'live',\\n\\t\\t\\tenabledForTeams && 'team',\\n\\t\\t\\tenabledForChannels && 'channel',\\n\\t\\t].filter((group): group is RoomToolboxActionConfig['groups'][number] => !!group),\\n\\t);\\n\\n\\tconst visible = groups.length > 0;\\n\\tconst allowed = visible && permittedToCallManagement && (!user?.username || !room.muted?.includes(user.username)) && !ownUser;\\n\\tconst disabled = federated || (!!room.ro && !permittedToPostReadonly);\\n\\tconst tooltip = disabled ? t('core.Video_Call_unavailable_for_this_type_of_room') : '';\\n\\tconst order = isOmnichannelRoom(room) ? -1 : 4;\\n\\n\\tconst handleOpenVideoConf = useEffectEvent(async () => {\\n\\t\\tif (isCalling || isRinging) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\ttry {\\n\\t\\t\\tawait VideoConfManager.loadCapabilities();\\n\\t\\t\\tdispatchPopup({ rid: room._id });\\n\\t\\t} catch (error: any) {\\n\\t\\t\\tdispatchWarning(error.error);\\n\\t\\t}\\n\\t});\\n\\n\\treturn useMemo(() => {\\n\\t\\tconst items: GenericMenuItemProps[] = [\\n\\t\\t\\t{\\n\\t\\t\\t\\tid: 'start-video-call',\\n\\t\\t\\t\\ticon: 'video',\\n\\t\\t\\t\\tdisabled,\\n\\t\\t\\t\\tonClick: handleOpenVideoConf,\\n\\t\\t\\t\\tcontent: (\\n\\t\\t\\t\\t\\t<Box is='span' title={tooltip}>\\n\\t\\t\\t\\t\\t\\t{t('Video_call')}\\n\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t),\\n\\t\\t\\t},\\n\\t\\t];\\n\\n\\t\\treturn {\\n\\t\\t\\titems,\\n\\t\\t\\tdisabled,\\n\\t\\t\\tallowed,\\n\\t\\t\\torder,\\n\\t\\t\\tgroups,\\n\\t\\t};\\n\\t}, [allowed, disabled, groups, handleOpenVideoConf, order, t, tooltip]);\\n};\\n\\nexport default useVideoConfMenuOptions;\\n\",null],\"names\":[\"isOmnichannelRoom\",\"isRoomFederated\",\"Box\",\"useEffectEvent\",\"useStableArray\",\"usePermission\",\"useSetting\",\"useUser\",\"React\",\"useMemo\",\"useTranslation\",\"useVideoConfDispatchOutgoing\",\"useVideoConfIsCalling\",\"useVideoConfIsRinging\",\"VideoConfManager\",\"useRoom\",\"useVideoConfWarning\",\"module\",\"link\",\"v\",\"default\",\"exportDefault\",\"useVideoConfMenuOptions\",\"_room$uids\",\"_room$muted\",\"t\",\"room\",\"user\",\"federated\",\"ownUser\",\"uids\",\"length\",\"permittedToPostReadonly\",\"_id\",\"permittedToCallManagement\",\"dispatchWarning\",\"dispatchPopup\",\"isCalling\",\"isRinging\",\"enabledForDMs\",\"enabledForChannels\",\"enabledForTeams\",\"enabledForGroups\",\"enabledForLiveChat\",\"groups\",\"filter\",\"group\",\"visible\",\"allowed\",\"username\",\"muted\",\"includes\",\"disabled\",\"ro\",\"tooltip\",\"order\",\"handleOpenVideoConf\",\"loadCapabilities\",\"rid\",\"error\",\"items\",\"id\",\"icon\",\"onClick\",\"content\",\"createElement\",\"is\",\"title\"],\"mappings\":\"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\"}"}