{"code":"function module(e,t,s){let i,l,a,n,r,o,u,c,m,f,k,d;s.link(\"meteor/meteor\",{Meteor(e){i=e}},0),s.link(\"meteor/rocketchat:user-presence\",{UserPresence(e){l=e}},1),s.link(\"meteor/session\",{Session(e){a=e}},2),s.link(\"meteor/tracker\",{Tracker(e){n=e}},3),s.link(\"moment\",{default(e){r=e}},4),s.link(\"../../app/markdown/lib/hljs\",{register(e){o=e}},5),s.link(\"../../app/settings/client\",{settings(e){u=e}},6),s.link(\"../../app/utils/client\",{getUserPreference(e){c=e}},7),s.link(\"hljs9/styles/github.css\"),s.link(\"../../app/utils/client/lib/SDKClient\",{sdk(e){m=e}},8),s.link(\"../lib/userData\",{synchronizeUserData(e){f=e},removeLocalUserData(e){k=e}},9),s.link(\"../lib/utils/fireGlobalEvent\",{fireGlobalEvent(e){d=e}},10),i.startup(()=>{let e;d(\"startup\",!0),a.setDefault(\"AvatarRandom\",0),window.lastMessageWindow={},window.lastMessageWindowHistory={},n.autorun(async()=>{let t=i.userId();if(!t){k();return}if(!i.status().connected||i.loggingIn())return;let s=await f(t);if(!s)return;let a=r().utcOffset()/60;if(s.utcOffset!==a&&m.call(\"userSetUtcOffset\",a),c(s,\"enableAutoAway\")){let e=c(s,\"idleTimeLimit\")||300;l.awayTime=1e3*e}else delete l.awayTime,l.stopTimer();l.start(),s.status!==e&&(e=s.status,d(\"status-changed\",e))})}),i.startup(()=>{n.autorun(()=>{let e=u.get(\"Message_Code_highlight\");null==e||e.split(\",\").forEach(e=>{e.trim()&&o(e.trim())})})})}","map":"{\"version\":3,\"sources\":[\"client/startup/startup.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { UserStatus } from '@rocket.chat/core-typings';\\nimport { Meteor } from 'meteor/meteor';\\nimport { UserPresence } from 'meteor/rocketchat:user-presence';\\nimport { Session } from 'meteor/session';\\nimport { Tracker } from 'meteor/tracker';\\nimport moment from 'moment';\\n\\nimport { register } from '../../app/markdown/lib/hljs';\\nimport { settings } from '../../app/settings/client';\\nimport { getUserPreference } from '../../app/utils/client';\\nimport 'hljs9/styles/github.css';\\nimport { sdk } from '../../app/utils/client/lib/SDKClient';\\nimport { synchronizeUserData, removeLocalUserData } from '../lib/userData';\\nimport { fireGlobalEvent } from '../lib/utils/fireGlobalEvent';\\n\\nMeteor.startup(() => {\\n\\tfireGlobalEvent('startup', true);\\n\\n\\tSession.setDefault('AvatarRandom', 0);\\n\\n\\twindow.lastMessageWindow = {};\\n\\twindow.lastMessageWindowHistory = {};\\n\\n\\tlet status: UserStatus | undefined = undefined;\\n\\tTracker.autorun(async () => {\\n\\t\\tconst uid = Meteor.userId();\\n\\t\\tif (!uid) {\\n\\t\\t\\tremoveLocalUserData();\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tif (!Meteor.status().connected) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tif (Meteor.loggingIn()) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tconst user = await synchronizeUserData(uid);\\n\\t\\tif (!user) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tconst utcOffset = moment().utcOffset() / 60;\\n\\t\\tif (user.utcOffset !== utcOffset) {\\n\\t\\t\\tsdk.call('userSetUtcOffset', utcOffset);\\n\\t\\t}\\n\\n\\t\\tif (getUserPreference(user, 'enableAutoAway')) {\\n\\t\\t\\tconst idleTimeLimit = (getUserPreference(user, 'idleTimeLimit') as number | null | undefined) || 300;\\n\\t\\t\\tUserPresence.awayTime = idleTimeLimit * 1000;\\n\\t\\t} else {\\n\\t\\t\\tdelete UserPresence.awayTime;\\n\\t\\t\\tUserPresence.stopTimer();\\n\\t\\t}\\n\\n\\t\\tUserPresence.start();\\n\\n\\t\\tif (user.status !== status) {\\n\\t\\t\\tstatus = user.status;\\n\\t\\t\\tfireGlobalEvent('status-changed', status);\\n\\t\\t}\\n\\t});\\n});\\nMeteor.startup(() => {\\n\\tTracker.autorun(() => {\\n\\t\\tconst code = settings.get('Message_Code_highlight') as string | undefined;\\n\\t\\tcode?.split(',').forEach((language: string) => {\\n\\t\\t\\tlanguage.trim() && register(language.trim());\\n\\t\\t});\\n\\t});\\n});\\n\",null],\"names\":[\"Meteor\",\"UserPresence\",\"Session\",\"Tracker\",\"moment\",\"register\",\"settings\",\"getUserPreference\",\"sdk\",\"synchronizeUserData\",\"removeLocalUserData\",\"fireGlobalEvent\",\"module\",\"link\",\"v\",\"default\",\"startup\",\"status\",\"setDefault\",\"window\",\"lastMessageWindow\",\"lastMessageWindowHistory\",\"autorun\",\"uid\",\"userId\",\"connected\",\"loggingIn\",\"user\",\"utcOffset\",\"call\",\"idleTimeLimit\",\"awayTime\",\"stopTimer\",\"start\",\"code\",\"get\",\"split\",\"forEach\",\"language\",\"trim\"],\"mappings\":\"2BACAA,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAb,OAAAc,CAAA,EAAAd,EAAAc,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,kCAAA,CAAAZ,aAAAa,CAAA,EAAAb,EAAAa,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,iBAAA,CAAAX,QAAAY,CAAA,EAAAZ,EAAAY,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,iBAAA,CAAAV,QAAAW,CAAA,EAAAX,EAAAW,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,SAAA,CAAAE,QAAAD,CAAA,EAAAV,EAAAU,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,8BAAA,CAAAR,SAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,4BAAA,CAAAP,SAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,yBAAA,CAAAN,kBAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,2BAAAD,EAAAC,IAAA,CAAA,uCAAA,CAAAL,IAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,kBAAA,CAAAJ,oBAAAK,CAAA,EAAAL,EAAAK,CAAA,EAAAJ,oBAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,+BAAA,CAAAF,gBAAAG,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,IAcvCd,EAAOgB,OAAO,CAAC,SAQVC,EAPJN,EAAgB,UAAW,CAAA,GAE3BT,EAAQgB,UAAU,CAAC,eAAgB,GAEnCC,OAAOC,iBAAiB,CAAG,CAAA,EAC3BD,OAAOE,wBAAwB,CAAG,CAAA,EAGlClB,EAAQmB,OAAO,CAAC,UACf,IAAMC,EAAMvB,EAAOwB,MAAM,GACzB,GAAI,CAACD,EAAK,CACTb,IACA,MACD,CAEA,GAAI,CAACV,EAAOiB,MAAM,GAAGQ,SAAS,EAI1BzB,EAAO0B,SAAS,GAHnB,OAOD,IAAMC,EAAO,MAAMlB,EAAoBc,GACvC,GAAI,CAACI,EACJ,OAGD,IAAMC,EAAYxB,IAASwB,SAAS,GAAK,GAKzC,GAJID,EAAKC,SAAS,GAAKA,GACtBpB,EAAIqB,IAAI,CAAC,mBAAoBD,GAG1BrB,EAAkBoB,EAAM,kBAAmB,CAC9C,IAAMG,EAAiBvB,EAAkBoB,EAAM,kBAAkD,GACjG1B,CAAAA,EAAa8B,QAAQ,CAAGD,AAAgB,IAAhBA,CACzB,MACC,OAAO7B,EAAa8B,QAAQ,CAC5B9B,EAAa+B,SAAS,GAGvB/B,EAAagC,KAAK,GAEdN,EAAKV,MAAM,GAAKA,IACnBA,EAASU,EAAKV,MAAM,CACpBN,EAAgB,iBAAkBM,GAEpC,EACD,GACAjB,EAAOgB,OAAO,CAAC,KACdb,EAAQmB,OAAO,CAAC,KACf,IAAMY,EAAO5B,EAAS6B,GAAG,CAAC,yBAC1BD,OAAAA,GAAAA,EAAME,KAAK,CAAC,KAAKC,OAAO,CAAEC,IACzBA,EAASC,IAAI,IAAMlC,EAASiC,EAASC,IAAI,GAC1C,EACD,EACD\"}"}