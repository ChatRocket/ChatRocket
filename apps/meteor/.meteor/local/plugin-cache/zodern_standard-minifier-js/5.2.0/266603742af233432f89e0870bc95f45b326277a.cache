{"code":"function module(n,e,a){a.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(n){t=n}},0),a.export({useAppSlashCommands:function(){return m}}),a.link(\"@rocket.chat/fuselage-hooks\",{useDebouncedCallback:function(n){o=n}},0),a.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(n){u=n},useStream:function(n){s=n},useUserId:function(n){c=n}},1),a.link(\"@tanstack/react-query\",{useQuery:function(n){i=n},useQueryClient:function(n){d=n}},2),a.link(\"react\",{useEffect:function(n){r=n}},3),a.link(\"../../app/utils/client/slashCommand\",{slashCommands:function(n){l=n}},4);var t,o,u,s,c,i,d,r,l,m=function(){var n=d(),e=s(\"apps\"),a=c(),m=o(function(){n.invalidateQueries([\"apps\",\"slashCommands\"])},100,[]);r(function(){if(a)return e(\"apps\",function(n){var e=t(n,2),a=e[0],o=t(e[1],1)[0];[\"command/added\",\"command/updated\",\"command/disabled\",\"command/removed\"].includes(a)&&(\"string\"==typeof o&&delete l.commands[o],m())})},[e,a,m]);var f=u(\"GET\",\"/v1/commands.list\");i([\"apps\",\"slashCommands\"],function(){return f()},{enabled:!!a,onSuccess:function(n){n.commands.forEach(function(n){return l.add(n)})}})}}","map":"{\"version\":3,\"sources\":[\"client/hooks/useAppSlashCommands.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useDebouncedCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useEndpoint, useStream, useUserId } from '@rocket.chat/ui-contexts';\\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\\nimport { useEffect } from 'react';\\n\\nimport { slashCommands } from '../../app/utils/client/slashCommand';\\n\\nexport const useAppSlashCommands = () => {\\n\\tconst queryClient = useQueryClient();\\n\\n\\tconst apps = useStream('apps');\\n\\tconst uid = useUserId();\\n\\n\\tconst invalidate = useDebouncedCallback(\\n\\t\\t() => {\\n\\t\\t\\tqueryClient.invalidateQueries(['apps', 'slashCommands']);\\n\\t\\t},\\n\\t\\t100,\\n\\t\\t[],\\n\\t);\\n\\n\\tuseEffect(() => {\\n\\t\\tif (!uid) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\treturn apps('apps', ([key, [command]]) => {\\n\\t\\t\\tif (['command/added', 'command/updated', 'command/disabled', 'command/removed'].includes(key)) {\\n\\t\\t\\t\\tif (typeof command === 'string') {\\n\\t\\t\\t\\t\\tdelete slashCommands.commands[command];\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tinvalidate();\\n\\t\\t\\t}\\n\\t\\t});\\n\\t}, [apps, uid, invalidate]);\\n\\n\\tconst getSlashCommands = useEndpoint('GET', '/v1/commands.list');\\n\\n\\tuseQuery(['apps', 'slashCommands'], () => getSlashCommands(), {\\n\\t\\tenabled: !!uid,\\n\\t\\tonSuccess(data) {\\n\\t\\t\\tdata.commands.forEach((command) => slashCommands.add(command));\\n\\t\\t},\\n\\t});\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_slicedToArray\",\"export\",\"useAppSlashCommands\",\"useDebouncedCallback\",\"useEndpoint\",\"useStream\",\"useUserId\",\"useQuery\",\"useQueryClient\",\"useEffect\",\"slashCommands\",\"queryClient\",\"apps\",\"uid\",\"invalidate\",\"invalidateQueries\",\"_ref\",\"_ref2\",\"key\",\"command\",\"_ref2$\",\"includes\",\"commands\",\"getSlashCommands\",\"enabled\",\"onSuccess\",\"data\",\"forEach\",\"add\"],\"mappings\":\"uBAASA,EAAAC,IAAoB,CAAE,uCAAoC,CAAAC,QAAA,SAAAC,CAAA,EAAAC,EAAAD,CAAA,CAAA,EAAA,GAAnEH,EAAOK,MAAE,CAAA,CAAAC,oBAAsB,WAAM,OAAAA,CAA8B,CAAA,GAAAN,EAAAC,IAAA,CAAA,8BAAA,CAAAM,qBAAA,SAAAJ,CAAA,EAAAI,EAAAJ,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,2BAAA,CAAAO,YAAA,SAAAL,CAAA,EAAAK,EAAAL,CAAA,EAAAM,UAAA,SAAAN,CAAA,EAAAM,EAAAN,CAAA,EAAAO,UAAA,SAAAP,CAAA,EAAAO,EAAAP,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,wBAAA,CAAAU,SAAA,SAAAR,CAAA,EAAAQ,EAAAR,CAAA,EAAAS,eAAA,SAAAT,CAAA,EAAAS,EAAAT,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAAY,UAAA,SAAAV,CAAA,EAAAU,EAAAV,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,sCAAA,CAAAa,cAAA,SAAAX,CAAA,EAAAW,EAAAX,CAAA,CAAA,EAAA,GAO5D,IAPPC,EAAmEG,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAOtDR,EAAsB,WAClC,IAAMS,EAAcH,IAEdI,EAAOP,EAAU,QACjBQ,EAAMP,IAENQ,EAAaX,EAClB,WACCQ,EAAYI,iBAAiB,CAAC,CAAC,OAAQ,gBAAgB,CACxD,EACA,IACA,EAAE,EAGHN,EAAU,WACT,GAAKI,EAGL,OAAOD,EAAK,OAAQ,SAAAI,CAAA,EAAqB,IAAAC,EAAAjB,EAAAgB,EAAA,GAAnBE,EAAGD,CAAA,CAAA,EAAA,CAAGE,EAAOC,AAAVpB,EAAAiB,CAAA,CAAA,EAAA,CAAA,EAAU,CAAA,EAAA,CAC9B,CAAC,gBAAiB,kBAAmB,mBAAoB,kBAAkB,CAACI,QAAQ,CAACH,KACjE,UAAnB,OAAOC,GACV,OAAOT,EAAcY,QAAQ,CAACH,EAAQ,CAEvCL,IAEF,EACD,EAAG,CAACF,EAAMC,EAAKC,EAAW,EAE1B,IAAMS,EAAmBnB,EAAY,MAAO,qBAE5CG,EAAS,CAAC,OAAQ,gBAAgB,CAAE,WAAA,OAAMgB,GAAkB,EAAE,CAC7DC,QAAS,CAAC,CAACX,EACXY,UAAS,SAACC,CAAI,EACbA,EAAKJ,QAAQ,CAACK,OAAO,CAAC,SAACR,CAAO,EAAA,OAAKT,EAAckB,GAAG,CAACT,EAAQ,EAC9D,GAEF\"}"}