{"code":"function module(e,n,i){let r,s,o,t;i.link(\"meteor/meteor\",{Meteor(e){r=e}},0),i.link(\"../../app/models/client\",{ChatMessage(e){s=e},ChatSubscription(e){o=e}},1),i.link(\"../../app/settings/client\",{settings(e){t=e}},2),r.methods({pinMessage(e){if(!r.userId())throw new r.Error(\"error-not-authorized\",\"Not authorized\",{method:\"pinMessage\"});if(!t.get(\"Message_AllowPinning\"))throw new r.Error(\"pinning-not-allowed\",\"Pinning messages is not allowed\",{method:\"pinMessage\"});if(!o.findOne({rid:e.rid}))throw new r.Error(\"error-pinning-message\",\"Pinning messages is not allowed\",{method:\"pinMessage\"});if(\"string\"!=typeof e._id)throw new r.Error(\"error-pinning-message\",\"Invalid message\",{method:\"pinMessage\"});s.update({_id:e._id,rid:e.rid},{$set:{pinned:!0}});let n=s.findOne({_id:e._id});if(!n)throw new r.Error(\"error-pinning-message\",\"Error pinning message\",{method:\"pinMessage\"});return n}})}","map":"{\"version\":3,\"sources\":[\"client/methods/pinMessage.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IMessage } from '@rocket.chat/core-typings';\\nimport type { ServerMethods } from '@rocket.chat/ddp-client';\\nimport { Meteor } from 'meteor/meteor';\\n\\nimport { ChatMessage, ChatSubscription } from '../../app/models/client';\\nimport { settings } from '../../app/settings/client';\\n\\nMeteor.methods<ServerMethods>({\\n\\tpinMessage(message: IMessage) {\\n\\t\\tif (!Meteor.userId()) {\\n\\t\\t\\tthrow new Meteor.Error('error-not-authorized', 'Not authorized', {\\n\\t\\t\\t\\tmethod: 'pinMessage',\\n\\t\\t\\t});\\n\\t\\t}\\n\\t\\tif (!settings.get('Message_AllowPinning')) {\\n\\t\\t\\tthrow new Meteor.Error('pinning-not-allowed', 'Pinning messages is not allowed', {\\n\\t\\t\\t\\tmethod: 'pinMessage',\\n\\t\\t\\t});\\n\\t\\t}\\n\\t\\tif (!ChatSubscription.findOne({ rid: message.rid })) {\\n\\t\\t\\tthrow new Meteor.Error('error-pinning-message', 'Pinning messages is not allowed', {\\n\\t\\t\\t\\tmethod: 'pinMessage',\\n\\t\\t\\t});\\n\\t\\t}\\n\\t\\tif (typeof message._id !== 'string') {\\n\\t\\t\\tthrow new Meteor.Error('error-pinning-message', 'Invalid message', {\\n\\t\\t\\t\\tmethod: 'pinMessage',\\n\\t\\t\\t});\\n\\t\\t}\\n\\n\\t\\tChatMessage.update(\\n\\t\\t\\t{\\n\\t\\t\\t\\t_id: message._id,\\n\\t\\t\\t\\trid: message.rid,\\n\\t\\t\\t},\\n\\t\\t\\t{\\n\\t\\t\\t\\t$set: {\\n\\t\\t\\t\\t\\tpinned: true,\\n\\t\\t\\t\\t},\\n\\t\\t\\t},\\n\\t\\t);\\n\\n\\t\\tconst msg = ChatMessage.findOne({ _id: message._id });\\n\\n\\t\\tif (!msg) {\\n\\t\\t\\tthrow new Meteor.Error('error-pinning-message', 'Error pinning message', {\\n\\t\\t\\t\\tmethod: 'pinMessage',\\n\\t\\t\\t});\\n\\t\\t}\\n\\n\\t\\treturn msg;\\n\\t},\\n});\\n\",null],\"names\":[\"Meteor\",\"ChatMessage\",\"ChatSubscription\",\"settings\",\"module\",\"link\",\"v\",\"methods\",\"pinMessage\",\"message\",\"userId\",\"Error\",\"method\",\"get\",\"findOne\",\"rid\",\"_id\",\"update\",\"$set\",\"pinned\",\"msg\"],\"mappings\":\"2BAEAA,EAAuCC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAL,OAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,0BAAA,CAAAJ,YAAAK,CAAA,EAAAL,EAAAK,CAAA,EAAAJ,iBAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,4BAAA,CAAAF,SAAAG,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,GAKvCN,EAAOO,OAAO,CAAgB,CAC7BC,WAAWC,CAAiB,EAC3B,GAAI,CAACT,EAAOU,MAAM,GACjB,MAAM,IAAIV,EAAOW,KAAK,CAAC,uBAAwB,iBAAkB,CAChEC,OAAQ,eAGV,GAAI,CAACT,EAASU,GAAG,CAAC,wBACjB,MAAM,IAAIb,EAAOW,KAAK,CAAC,sBAAuB,kCAAmC,CAChFC,OAAQ,eAGV,GAAI,CAACV,EAAiBY,OAAO,CAAC,CAAEC,IAAKN,EAAQM,GAAAA,AAAG,GAC/C,MAAM,IAAIf,EAAOW,KAAK,CAAC,wBAAyB,kCAAmC,CAClFC,OAAQ,eAGV,GAAI,AAAuB,UAAvB,OAAOH,EAAQO,GAAG,CACrB,MAAM,IAAIhB,EAAOW,KAAK,CAAC,wBAAyB,kBAAmB,CAClEC,OAAQ,eAIVX,EAAYgB,MAAM,CACjB,CACCD,IAAKP,EAAQO,GAAG,CAChBD,IAAKN,EAAQM,GAAAA,EAEd,CACCG,KAAM,CACLC,OAAQ,CAAA,KAKX,IAAMC,EAAMnB,EAAYa,OAAO,CAAC,CAAEE,IAAKP,EAAQO,GAAAA,AAAG,GAElD,GAAI,CAACI,EACJ,MAAM,IAAIpB,EAAOW,KAAK,CAAC,wBAAyB,wBAAyB,CACxEC,OAAQ,eAIV,OAAOQ,CACR\"}"}