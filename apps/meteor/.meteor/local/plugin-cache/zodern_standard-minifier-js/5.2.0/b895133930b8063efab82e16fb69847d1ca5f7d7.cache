{"code":"function module(e,t,n){var r,i,a,l,o,u,s,c,d,m,f,p=[\"_id\",\"name\"];n.link(\"@babel/runtime/regenerator\",{default:function(e){r=e}},0),n.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default:function(e){i=e}},1),n.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){a=e}},2),n.export({useDepartmentsList:function(){return v}}),n.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(e){l=e}},0),n.link(\"react\",{useCallback:function(e){o=e},useState:function(e){u=e}},1),n.link(\"react-i18next\",{useTranslation:function(e){s=e}},2),n.link(\"../../../hooks/lists/useScrollableRecordList\",{useScrollableRecordList:function(e){c=e}},3),n.link(\"../../../hooks/useComponentDidUpdate\",{useComponentDidUpdate:function(e){d=e}},4),n.link(\"../../../lib/lists/RecordList\",{RecordList:function(e){m=e}},5),n.link(\"../utils/normalizeDepartments\",{normalizeDepartments:function(e){f=e}},6);var v=function(e){var t,n=s().t,v=u(function(){return new m}),h=a(v,2),b=h[0],k=h[1],D=o(function(){return k(new m)},[]),I=l(\"GET\",\"/v1/livechat/department\"),x=l(\"GET\",\"/v1/livechat/department/:_id\",{_id:null!==(t=e.selectedDepartment)&&void 0!==t?t:\"\"});d(function(){e&&D()},[e,D]);var w=o(function(t,a){var l,o,u,s,c,d;return r.async(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,r.awrap(I({onlyMyDepartments:\"\"+!!e.onlyMyDepartments,text:e.filter,offset:t,count:a+t,sort:'{ \"name\": 1 }',excludeDepartmentId:e.excludeDepartmentId,enabled:e.enabled?\"true\":\"false\",showArchived:e.showArchived?\"true\":\"false\"}));case 2:return u=(o=m.sent).departments,s=o.total,c=u.filter(function(t){return!e.departmentId||t._id!==e.departmentId}).map(function(e){var t=e._id,r=e.name;return{_id:t,label:i(e,p).archived?r+\" [\"+n(\"Archived\")+\"]\":r,value:t}}),m.next=8,r.awrap(f(c,null!==(l=e.selectedDepartment)&&void 0!==l?l:\"\",x));case 8:return d=m.sent,e.haveAll&&d.unshift({_id:\"\",label:n(\"All\"),value:\"all\"}),e.haveNone&&d.unshift({_id:\"\",label:n(\"None\"),value:\"\"}),m.abrupt(\"return\",{items:d,itemCount:e.departmentId?s-1:s});case 12:case\"end\":return m.stop()}},null,null,null,Promise)},[I,e.onlyMyDepartments,e.filter,e.excludeDepartmentId,e.enabled,e.showArchived,e.selectedDepartment,e.haveAll,e.haveNone,e.departmentId,x,n]),y=c(b,w,25);return{reload:D,itemsList:b,loadMoreItems:y.loadMoreItems,initialItemCount:y.initialItemCount}}}","map":"{\"version\":3,\"sources\":[\"client/components/Omnichannel/hooks/useDepartmentsList.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useCallback, useState } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { useScrollableRecordList } from '../../../hooks/lists/useScrollableRecordList';\\nimport { useComponentDidUpdate } from '../../../hooks/useComponentDidUpdate';\\nimport { RecordList } from '../../../lib/lists/RecordList';\\nimport type { DepartmentListItem } from '../Definitions/DepartmentsDefinitions';\\nimport { normalizeDepartments } from '../utils/normalizeDepartments';\\n\\ntype DepartmentsListOptions = {\\n\\tfilter: string;\\n\\tdepartmentId?: string;\\n\\tonlyMyDepartments?: boolean;\\n\\thaveAll?: boolean;\\n\\thaveNone?: boolean;\\n\\texcludeDepartmentId?: string;\\n\\tenabled?: boolean;\\n\\tshowArchived?: boolean;\\n\\tselectedDepartment?: string;\\n};\\n\\nexport const useDepartmentsList = (\\n\\toptions: DepartmentsListOptions,\\n): {\\n\\titemsList: RecordList<DepartmentListItem>;\\n\\tinitialItemCount: number;\\n\\treload: () => void;\\n\\tloadMoreItems: (start: number, end: number) => void;\\n} => {\\n\\tconst { t } = useTranslation();\\n\\tconst [itemsList, setItemsList] = useState(() => new RecordList<DepartmentListItem>());\\n\\tconst reload = useCallback(() => setItemsList(new RecordList<DepartmentListItem>()), []);\\n\\n\\tconst getDepartments = useEndpoint('GET', '/v1/livechat/department');\\n\\tconst getDepartment = useEndpoint('GET', '/v1/livechat/department/:_id', { _id: options.selectedDepartment ?? '' });\\n\\n\\tuseComponentDidUpdate(() => {\\n\\t\\toptions && reload();\\n\\t}, [options, reload]);\\n\\n\\tconst fetchData = useCallback(\\n\\t\\tasync (start, end) => {\\n\\t\\t\\tconst { departments, total } = await getDepartments({\\n\\t\\t\\t\\tonlyMyDepartments: `${!!options.onlyMyDepartments}`,\\n\\t\\t\\t\\ttext: options.filter,\\n\\t\\t\\t\\toffset: start,\\n\\t\\t\\t\\tcount: end + start,\\n\\t\\t\\t\\tsort: `{ \\\"name\\\": 1 }`,\\n\\t\\t\\t\\texcludeDepartmentId: options.excludeDepartmentId,\\n\\t\\t\\t\\tenabled: options.enabled ? 'true' : 'false',\\n\\t\\t\\t\\tshowArchived: options.showArchived ? 'true' : 'false',\\n\\t\\t\\t});\\n\\n\\t\\t\\tconst items = departments\\n\\t\\t\\t\\t.filter((department) => {\\n\\t\\t\\t\\t\\tif (options.departmentId && department._id === options.departmentId) {\\n\\t\\t\\t\\t\\t\\treturn false;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\treturn true;\\n\\t\\t\\t\\t})\\n\\t\\t\\t\\t.map(\\n\\t\\t\\t\\t\\t({ _id, name, ...department }): DepartmentListItem => ({\\n\\t\\t\\t\\t\\t\\t_id,\\n\\t\\t\\t\\t\\t\\tlabel: department.archived ? `${name} [${t('Archived')}]` : name,\\n\\t\\t\\t\\t\\t\\tvalue: _id,\\n\\t\\t\\t\\t\\t}),\\n\\t\\t\\t\\t);\\n\\n\\t\\t\\tconst normalizedItems = await normalizeDepartments(items, options.selectedDepartment ?? '', getDepartment);\\n\\n\\t\\t\\toptions.haveAll &&\\n\\t\\t\\t\\tnormalizedItems.unshift({\\n\\t\\t\\t\\t\\t_id: '',\\n\\t\\t\\t\\t\\tlabel: t('All'),\\n\\t\\t\\t\\t\\tvalue: 'all',\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\toptions.haveNone &&\\n\\t\\t\\t\\tnormalizedItems.unshift({\\n\\t\\t\\t\\t\\t_id: '',\\n\\t\\t\\t\\t\\tlabel: t('None'),\\n\\t\\t\\t\\t\\tvalue: '',\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\treturn {\\n\\t\\t\\t\\titems: normalizedItems,\\n\\t\\t\\t\\titemCount: options.departmentId ? total - 1 : total,\\n\\t\\t\\t};\\n\\t\\t},\\n\\t\\t[\\n\\t\\t\\tgetDepartments,\\n\\t\\t\\toptions.onlyMyDepartments,\\n\\t\\t\\toptions.filter,\\n\\t\\t\\toptions.excludeDepartmentId,\\n\\t\\t\\toptions.enabled,\\n\\t\\t\\toptions.showArchived,\\n\\t\\t\\toptions.selectedDepartment,\\n\\t\\t\\toptions.haveAll,\\n\\t\\t\\toptions.haveNone,\\n\\t\\t\\toptions.departmentId,\\n\\t\\t\\tgetDepartment,\\n\\t\\t\\tt,\\n\\t\\t],\\n\\t);\\n\\n\\tconst { loadMoreItems, initialItemCount } = useScrollableRecordList(itemsList, fetchData, 25);\\n\\n\\treturn {\\n\\t\\treload,\\n\\t\\titemsList,\\n\\t\\tloadMoreItems,\\n\\t\\tinitialItemCount,\\n\\t};\\n};\\n\",null],\"names\":[\"_regeneratorRuntime\",\"_objectWithoutProperties\",\"_slicedToArray\",\"useEndpoint\",\"useCallback\",\"useState\",\"useTranslation\",\"useScrollableRecordList\",\"useComponentDidUpdate\",\"RecordList\",\"normalizeDepartments\",\"module\",\"link\",\"default\",\"v\",\"export\",\"useDepartmentsList\",\"options\",\"_options$selectedDepa\",\"t\",\"_useTranslation\",\"_useState\",\"_useState2\",\"itemsList\",\"setItemsList\",\"reload\",\"getDepartments\",\"getDepartment\",\"_id\",\"selectedDepartment\",\"fetchData\",\"start\",\"end\",\"_options$selectedDepa2\",\"_await$getDepartments\",\"departments\",\"total\",\"items\",\"normalizedItems\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"onlyMyDepartments\",\"text\",\"filter\",\"offset\",\"count\",\"sort\",\"excludeDepartmentId\",\"enabled\",\"showArchived\",\"sent\",\"department\",\"departmentId\",\"map\",\"_ref\",\"name\",\"label\",\"_excluded\",\"archived\",\"value\",\"haveAll\",\"unshift\",\"haveNone\",\"abrupt\",\"itemCount\",\"stop\",\"Promise\",\"_useScrollableRecordL\",\"loadMoreItems\",\"initialItemCount\"],\"mappings\":\"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\"}"}