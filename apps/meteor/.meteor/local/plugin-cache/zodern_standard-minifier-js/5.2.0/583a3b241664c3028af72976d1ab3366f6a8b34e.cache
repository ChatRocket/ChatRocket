{"code":"Package[\"core-runtime\"].queue(\"callback-hook\",function(){var e,t=Package.meteor.Meteor;Package.meteor.global,Package.meteor.meteorEnv;var n=Package.modules.meteorInstall;Package.modules.meteorBabelHelpers;var a=Package.promise.Promise;return Package[\"ecmascript-runtime-client\"].Symbol,Package[\"ecmascript-runtime-client\"].Map,Package[\"ecmascript-runtime-client\"].Set,{export:function(){return{Hook:e}},require:n({node_modules:{meteor:{\"callback-hook\":{\"hook.js\":function e(e,n,r){r.link(\"@babel/runtime/regenerator\",{default:function(e){c=e}},0),r.export({Hook:function(){return i}});var c,o=Object.prototype.hasOwnProperty,i=function(){function e(e){if(e=e||{},this.nextCallbackId=0,this.callbacks=Object.create(null),this.bindEnvironment=!0,!1===e.bindEnvironment&&(this.bindEnvironment=!1),this.wrapAsync=!0,!1===e.wrapAsync&&(this.wrapAsync=!1),e.exceptionHandler)this.exceptionHandler=e.exceptionHandler;else if(e.debugPrintExceptions){if(\"string\"!=typeof e.debugPrintExceptions)throw Error(\"Hook option debugPrintExceptions should be a string\");this.exceptionHandler=e.debugPrintExceptions}}var n=e.prototype;return n.register=function(e){var n=this,a=this.exceptionHandler||function(e){throw e};e=this.bindEnvironment?t.bindEnvironment(e,a):function(e,n,a){if(!n||\"string\"==typeof n){var r=n||\"callback of async function\";n=function(e){t._debug(\"Exception in \"+r,e)}}return function(){var t;try{for(var a=arguments.length,r=Array(a),c=0;c<a;c++)r[c]=arguments[c];t=e.apply(void 0,r)}catch(e){n(e)}return t}}(e,a),this.wrapAsync&&(e=t.wrapFn(e));var r=this.nextCallbackId++;return this.callbacks[r]=e,{callback:e,stop:function(){delete n.callbacks[r]}}},n.clear=function(){this.nextCallbackId=0,this.callbacks=[]},n.forEach=function(e){for(var t=Object.keys(this.callbacks),n=0;n<t.length;++n){var a=t[n];if(o.call(this.callbacks,a)&&!e(this.callbacks[a]))break}},n.forEachAsync=function(e){var t,n,r,i;return c.async(function(a){for(;;)switch(a.prev=a.next){case 0:t=Object.keys(this.callbacks),n=0;case 2:if(!(n<t.length)){a.next=13;break}if(r=t[n],!o.call(this.callbacks,r)){a.next=10;break}return i=this.callbacks[r],a.next=8,c.awrap(e(i));case 8:if(a.sent){a.next=10;break}return a.abrupt(\"break\",13);case 10:++n,a.next=2;break;case 13:case\"end\":return a.stop()}},null,this,null,a)},n.forEachAsync=function(e){var t,n,r,i;return c.async(function(a){for(;;)switch(a.prev=a.next){case 0:t=Object.keys(this.callbacks),n=0;case 2:if(!(n<t.length)){a.next=13;break}if(r=t[n],!o.call(this.callbacks,r)){a.next=10;break}return i=this.callbacks[r],a.next=8,c.awrap(e(i));case 8:if(a.sent){a.next=10;break}return a.abrupt(\"break\",13);case 10:++n,a.next=2;break;case 13:case\"end\":return a.stop()}},null,this,null,a)},n.each=function(e){return this.forEach(e)},e}()}}}}},{extensions:[\".js\",\".json\"]}),eagerModulePaths:[\"/node_modules/meteor/callback-hook/hook.js\"],mainModulePath:\"/node_modules/meteor/callback-hook/hook.js\"}});","map":"{\"version\":3,\"sources\":[\"packages/callback-hook/hook.js\",\"<anon>\"],\"sourcesContent\":[\"// XXX This pattern is under development. Do not add more callsites\\n// using this package for now. See:\\n// https://meteor.hackpad.com/Design-proposal-Hooks-YxvgEW06q6f\\n//\\n// Encapsulates the pattern of registering callbacks on a hook.\\n//\\n// The `each` method of the hook calls its iterator function argument\\n// with each registered callback.  This allows the hook to\\n// conditionally decide not to call the callback (if, for example, the\\n// observed object has been closed or terminated).\\n//\\n// By default, callbacks are bound with `Meteor.bindEnvironment`, so they will be\\n// called with the Meteor environment of the calling code that\\n// registered the callback. Override by passing { bindEnvironment: false }\\n// to the constructor.\\n//\\n// Registering a callback returns an object with a single `stop`\\n// method which unregisters the callback.\\n//\\n// The code is careful to allow a callback to be safely unregistered\\n// while the callbacks are being iterated over.\\n//\\n// If the hook is configured with the `exceptionHandler` option, the\\n// handler will be called if a called callback throws an exception.\\n// By default (if the exception handler doesn't itself throw an\\n// exception, or if the iterator function doesn't return a falsy value\\n// to terminate the calling of callbacks), the remaining callbacks\\n// will still be called.\\n//\\n// Alternatively, the `debugPrintExceptions` option can be specified\\n// as string describing the callback.  On an exception the string and\\n// the exception will be printed to the console log with\\n// `Meteor._debug`, and the exception otherwise ignored.\\n//\\n// If an exception handler isn't specified, exceptions thrown in the\\n// callback will propagate up to the iterator function, and will\\n// terminate calling the remaining callbacks if not caught.\\n\\nconst hasOwn = Object.prototype.hasOwnProperty;\\n\\nexport class Hook {\\n  constructor(options) {\\n    options = options || {};\\n    this.nextCallbackId = 0;\\n    this.callbacks = Object.create(null);\\n    // Whether to wrap callbacks with Meteor.bindEnvironment\\n    this.bindEnvironment = true;\\n    if (options.bindEnvironment === false) {\\n      this.bindEnvironment = false;\\n    }\\n\\n    this.wrapAsync = true;\\n    if (options.wrapAsync === false) {\\n      this.wrapAsync = false;\\n    }\\n\\n    if (options.exceptionHandler) {\\n      this.exceptionHandler = options.exceptionHandler;\\n    } else if (options.debugPrintExceptions) {\\n      if (typeof options.debugPrintExceptions !== \\\"string\\\") {\\n        throw new Error(\\\"Hook option debugPrintExceptions should be a string\\\");\\n      }\\n      this.exceptionHandler = options.debugPrintExceptions;\\n    }\\n  }\\n\\n  register(callback) {\\n    const exceptionHandler = this.exceptionHandler || function (exception) {\\n      // Note: this relies on the undocumented fact that if bindEnvironment's\\n      // onException throws, and you are invoking the callback either in the\\n      // browser or from within a Fiber in Node, the exception is propagated.\\n      throw exception;\\n    };\\n\\n    if (this.bindEnvironment) {\\n      callback = Meteor.bindEnvironment(callback, exceptionHandler);\\n    } else {\\n      callback = dontBindEnvironment(callback, exceptionHandler);\\n    }\\n\\n    if (this.wrapAsync) {\\n      callback = Meteor.wrapFn(callback);\\n    }\\n\\n    const id = this.nextCallbackId++;\\n    this.callbacks[id] = callback;\\n\\n    return {\\n      callback,\\n      stop: () => {\\n        delete this.callbacks[id];\\n      }\\n    };\\n  }\\n\\n  clear() {\\n    this.nextCallbackId = 0;\\n    this.callbacks = [];\\n  }\\n\\n  /**\\n   * For each registered callback, call the passed iterator function with the callback.\\n   *\\n   * The iterator function can choose whether or not to call the\\n   * callback.  (For example, it might not call the callback if the\\n   * observed object has been closed or terminated).\\n   * The iteration is stopped if the iterator function returns a falsy\\n   * value or throws an exception.\\n   *\\n   * @param iterator\\n   */\\n  forEach(iterator) {\\n\\n    const ids = Object.keys(this.callbacks);\\n    for (let i = 0;  i < ids.length;  ++i) {\\n      const id = ids[i];\\n      // check to see if the callback was removed during iteration\\n      if (hasOwn.call(this.callbacks, id)) {\\n        const callback = this.callbacks[id];\\n        if (! iterator(callback)) {\\n          break;\\n        }\\n      }\\n    }\\n  }\\n\\n  async forEachAsync(iterator) {\\n    const ids = Object.keys(this.callbacks);\\n    for (let i = 0;  i < ids.length;  ++i) {\\n      const id = ids[i];\\n      // check to see if the callback was removed during iteration\\n      if (hasOwn.call(this.callbacks, id)) {\\n        const callback = this.callbacks[id];\\n        if (!await iterator(callback)) {\\n          break;\\n        }\\n      }\\n    }\\n  }\\n\\n  /**\\n   * For each registered callback, call the passed iterator function with the callback.\\n   *\\n   * it is a counterpart of forEach, but it is async and returns a promise\\n   * @param iterator\\n   * @return {Promise<void>}\\n   * @see forEach\\n   */\\n  async forEachAsync(iterator) {\\n    const ids = Object.keys(this.callbacks);\\n    for (let i = 0;  i < ids.length;  ++i) {\\n      const id = ids[i];\\n      // check to see if the callback was removed during iteration\\n      if (hasOwn.call(this.callbacks, id)) {\\n        const callback = this.callbacks[id];\\n        if (!await iterator(callback)) {\\n          break;\\n        }\\n      }\\n    }\\n  }\\n\\n  /**\\n   * @deprecated use forEach\\n   * @param iterator\\n   */\\n  each(iterator) {\\n    return this.forEach(iterator);\\n  }\\n}\\n\\n// Copied from Meteor.bindEnvironment and removed all the env stuff.\\nfunction dontBindEnvironment(func, onException, _this) {\\n  if (!onException || typeof(onException) === 'string') {\\n    const description = onException || \\\"callback of async function\\\";\\n    onException = function (error) {\\n      Meteor._debug(\\n        \\\"Exception in \\\" + description,\\n        error\\n      );\\n    };\\n  }\\n\\n  return function (...args) {\\n    let ret;\\n    try {\\n      ret = func.apply(_this, args);\\n    } catch (e) {\\n      onException(e);\\n    }\\n    return ret;\\n  };\\n}\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"export\",\"Hook\",\"hasOwn\",\"Object\",\"prototype\",\"hasOwnProperty\",\"options\",\"nextCallbackId\",\"callbacks\",\"create\",\"bindEnvironment\",\"wrapAsync\",\"exceptionHandler\",\"debugPrintExceptions\",\"Error\",\"_proto\",\"register\",\"callback\",\"_this2\",\"exception\",\"Meteor\",\"dontBindEnvironment\",\"func\",\"onException\",\"_this\",\"description\",\"error\",\"_debug\",\"ret\",\"_len\",\"arguments\",\"length\",\"args\",\"Array\",\"_key\",\"apply\",\"e\",\"wrapFn\",\"id\",\"stop\",\"clear\",\"forEach\",\"iterator\",\"ids\",\"keys\",\"i\",\"call\",\"forEachAsync\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"sent\",\"abrupt\",\"Promise\",\"_context2\",\"each\"],\"mappings\":\"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\"}"}