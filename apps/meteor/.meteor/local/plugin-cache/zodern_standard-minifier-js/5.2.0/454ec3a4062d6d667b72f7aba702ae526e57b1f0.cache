{"code":"function module(e,t,n){var l,r,i,a,o,u,c,m,s,d,f,b,E,p,v,k,g=[\"email\",\"room\",\"onRequest\",\"onSend\",\"onCancel\",\"onDiscard\"];n.link(\"@babel/runtime/helpers/extends\",{default:function(e){l=e}},0),n.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default:function(e){r=e}},1),n.link(\"@rocket.chat/fuselage\",{Field:function(e){i=e},Button:function(e){a=e},TextInput:function(e){o=e},Modal:function(e){u=e},Box:function(e){c=e},FieldGroup:function(e){m=e},FieldLabel:function(e){s=e},FieldRow:function(e){d=e},FieldError:function(e){f=e}},0),n.link(\"react\",{default:function(e){b=e},useCallback:function(e){E=e},useEffect:function(e){p=e}},1),n.link(\"react-hook-form\",{useForm:function(e){v=e}},2),n.link(\"react-i18next\",{useTranslation:function(e){k=e}},3),n.exportDefault(function(e){var t,n,j,q,_,C=e.email,F=void 0===C?\"\":C,S=e.room,h=e.onRequest,x=e.onSend,R=e.onCancel,w=e.onDiscard,y=r(e,g),T=k().t,D=v({defaultValues:{email:F||\"\",subject:T(\"Transcript_of_your_livechat_conversation\")}}),G=D.register,B=D.handleSubmit,I=D.setValue,L=D.setFocus,V=D.formState,H=V.errors,M=V.isSubmitting;p(function(){L(\"subject\")},[L]);var P=S.transcriptRequest,U=null==S?void 0:S.open,W=null==S?void 0:null===(t=S.v)||void 0===t?void 0:t.token,z=E(function(){return w()},[w]),A=E(function(e){var t=e.email,n=e.subject;U&&!P&&h(t,n),!U&&x&&W&&x(t,n,W)},[h,x,U,W,P]);return p(function(){P&&(I(\"email\",P.email),I(\"subject\",P.subject))},[I,P]),b.createElement(u,l({open:!0,wrapperFunction:function(e){return b.createElement(c,l({is:\"form\",onSubmit:B(A)},e))}},y),b.createElement(u.Header,null,b.createElement(u.Icon,{name:\"mail-arrow-top-right\"}),b.createElement(u.Title,null,T(\"Transcript\")),b.createElement(u.Close,{onClick:R})),b.createElement(u.Content,{fontScale:\"p2\"},!!P&&b.createElement(\"p\",null,T(\"Livechat_transcript_already_requested_warning\")),b.createElement(m,null,b.createElement(i,null,b.createElement(s,null,T(\"Email\"),\"*\"),b.createElement(d,null,b.createElement(o,l({disabled:!!F||!!P,error:null===(n=H.email)||void 0===n?void 0:n.message,flexGrow:1},G(\"email\",{required:T(\"Required_field\",{field:T(\"Email\")})})))),b.createElement(f,null,null===(j=H.email)||void 0===j?void 0:j.message)),b.createElement(i,null,b.createElement(s,null,T(\"Subject\"),\"*\"),b.createElement(d,null,b.createElement(o,l({disabled:!!P,error:null===(q=H.subject)||void 0===q?void 0:q.message,flexGrow:1},G(\"subject\",{required:T(\"Required_field\",{field:T(\"Subject\")})})))),b.createElement(f,null,null===(_=H.subject)||void 0===_?void 0:_.message)))),b.createElement(u.Footer,null,b.createElement(u.FooterControllers,null,b.createElement(a,{onClick:R},T(\"Cancel\")),U&&P&&b.createElement(a,{danger:!0,onClick:z},T(\"Undo_request\")),U&&!P&&b.createElement(a,{\"aria-label\":\"request-button\",disabled:M,loading:M,primary:!0,type:\"submit\"},T(\"Request\")),!U&&b.createElement(a,{\"aria-label\":\"send-button\",disabled:M,loading:M,primary:!0,type:\"submit\"},T(\"Send\")))))})}","map":"{\"version\":3,\"sources\":[\"client/components/Omnichannel/modals/TranscriptModal.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IOmnichannelRoom } from '@rocket.chat/core-typings';\\nimport { Field, Button, TextInput, Modal, Box, FieldGroup, FieldLabel, FieldRow, FieldError } from '@rocket.chat/fuselage';\\nimport React, { useCallback, useEffect } from 'react';\\nimport { useForm } from 'react-hook-form';\\nimport { useTranslation } from 'react-i18next';\\n\\ntype TranscriptModalProps = {\\n\\temail: string;\\n\\troom: IOmnichannelRoom;\\n\\tonRequest: (email: string, subject: string) => void;\\n\\tonSend?: (email: string, subject: string, token: string) => void;\\n\\tonCancel: () => void;\\n\\tonDiscard: () => void;\\n};\\n\\nconst TranscriptModal = ({ email: emailDefault = '', room, onRequest, onSend, onCancel, onDiscard, ...props }: TranscriptModalProps) => {\\n\\tconst { t } = useTranslation();\\n\\n\\tconst {\\n\\t\\tregister,\\n\\t\\thandleSubmit,\\n\\t\\tsetValue,\\n\\t\\tsetFocus,\\n\\t\\tformState: { errors, isSubmitting },\\n\\t} = useForm({\\n\\t\\tdefaultValues: { email: emailDefault || '', subject: t('Transcript_of_your_livechat_conversation') },\\n\\t});\\n\\n\\tuseEffect(() => {\\n\\t\\tsetFocus('subject');\\n\\t}, [setFocus]);\\n\\n\\tconst { transcriptRequest } = room;\\n\\tconst roomOpen = room?.open;\\n\\tconst token = room?.v?.token;\\n\\n\\tconst handleDiscard = useCallback(() => onDiscard(), [onDiscard]);\\n\\n\\tconst submit = useCallback(\\n\\t\\t({ email, subject }: { email: string; subject: string }) => {\\n\\t\\t\\tif (roomOpen && !transcriptRequest) {\\n\\t\\t\\t\\tonRequest(email, subject);\\n\\t\\t\\t}\\n\\t\\t\\tif (!roomOpen && onSend && token) {\\n\\t\\t\\t\\tonSend(email, subject, token);\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t[onRequest, onSend, roomOpen, token, transcriptRequest],\\n\\t);\\n\\n\\tuseEffect(() => {\\n\\t\\tif (transcriptRequest) {\\n\\t\\t\\tsetValue('email', transcriptRequest.email);\\n\\t\\t\\tsetValue('subject', transcriptRequest.subject);\\n\\t\\t}\\n\\t}, [setValue, transcriptRequest]);\\n\\n\\t// const canSubmit = isValid && Boolean(watch('subject'));\\n\\n\\treturn (\\n\\t\\t<Modal open wrapperFunction={(props) => <Box is='form' onSubmit={handleSubmit(submit)} {...props} />} {...props}>\\n\\t\\t\\t<Modal.Header>\\n\\t\\t\\t\\t<Modal.Icon name='mail-arrow-top-right' />\\n\\t\\t\\t\\t<Modal.Title>{t('Transcript')}</Modal.Title>\\n\\t\\t\\t\\t<Modal.Close onClick={onCancel} />\\n\\t\\t\\t</Modal.Header>\\n\\t\\t\\t<Modal.Content fontScale='p2'>\\n\\t\\t\\t\\t{!!transcriptRequest && <p>{t('Livechat_transcript_already_requested_warning')}</p>}\\n\\t\\t\\t\\t<FieldGroup>\\n\\t\\t\\t\\t\\t<Field>\\n\\t\\t\\t\\t\\t\\t<FieldLabel>{t('Email')}*</FieldLabel>\\n\\t\\t\\t\\t\\t\\t<FieldRow>\\n\\t\\t\\t\\t\\t\\t\\t<TextInput\\n\\t\\t\\t\\t\\t\\t\\t\\tdisabled={!!emailDefault || !!transcriptRequest}\\n\\t\\t\\t\\t\\t\\t\\t\\terror={errors.email?.message}\\n\\t\\t\\t\\t\\t\\t\\t\\tflexGrow={1}\\n\\t\\t\\t\\t\\t\\t\\t\\t{...register('email', { required: t('Required_field', { field: t('Email') }) })}\\n\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t\\t\\t\\t<FieldError>{errors.email?.message}</FieldError>\\n\\t\\t\\t\\t\\t</Field>\\n\\t\\t\\t\\t\\t<Field>\\n\\t\\t\\t\\t\\t\\t<FieldLabel>{t('Subject')}*</FieldLabel>\\n\\t\\t\\t\\t\\t\\t<FieldRow>\\n\\t\\t\\t\\t\\t\\t\\t<TextInput\\n\\t\\t\\t\\t\\t\\t\\t\\tdisabled={!!transcriptRequest}\\n\\t\\t\\t\\t\\t\\t\\t\\terror={errors.subject?.message}\\n\\t\\t\\t\\t\\t\\t\\t\\tflexGrow={1}\\n\\t\\t\\t\\t\\t\\t\\t\\t{...register('subject', { required: t('Required_field', { field: t('Subject') }) })}\\n\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t\\t\\t\\t<FieldError>{errors.subject?.message}</FieldError>\\n\\t\\t\\t\\t\\t</Field>\\n\\t\\t\\t\\t</FieldGroup>\\n\\t\\t\\t</Modal.Content>\\n\\t\\t\\t<Modal.Footer>\\n\\t\\t\\t\\t<Modal.FooterControllers>\\n\\t\\t\\t\\t\\t<Button onClick={onCancel}>{t('Cancel')}</Button>\\n\\t\\t\\t\\t\\t{roomOpen && transcriptRequest && (\\n\\t\\t\\t\\t\\t\\t<Button danger onClick={handleDiscard}>\\n\\t\\t\\t\\t\\t\\t\\t{t('Undo_request')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t{roomOpen && !transcriptRequest && (\\n\\t\\t\\t\\t\\t\\t<Button aria-label='request-button' disabled={isSubmitting} loading={isSubmitting} primary type='submit'>\\n\\t\\t\\t\\t\\t\\t\\t{t('Request')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t{!roomOpen && (\\n\\t\\t\\t\\t\\t\\t<Button aria-label='send-button' disabled={isSubmitting} loading={isSubmitting} primary type='submit'>\\n\\t\\t\\t\\t\\t\\t\\t{t('Send')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t</Modal.FooterControllers>\\n\\t\\t\\t</Modal.Footer>\\n\\t\\t</Modal>\\n\\t);\\n};\\n\\nexport default TranscriptModal;\\n\",null],\"names\":[\"_extends\",\"_objectWithoutProperties\",\"Field\",\"Button\",\"TextInput\",\"Modal\",\"Box\",\"FieldGroup\",\"FieldLabel\",\"FieldRow\",\"FieldError\",\"React\",\"useCallback\",\"useEffect\",\"useForm\",\"useTranslation\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"_room$v\",\"_errors$email\",\"_errors$email2\",\"_errors$subject\",\"_errors$subject2\",\"_ref$email\",\"email\",\"emailDefault\",\"room\",\"onRequest\",\"onSend\",\"onCancel\",\"onDiscard\",\"props\",\"_excluded\",\"t\",\"_useTranslation\",\"_useForm\",\"defaultValues\",\"subject\",\"register\",\"handleSubmit\",\"setValue\",\"setFocus\",\"_useForm$formState\",\"formState\",\"errors\",\"isSubmitting\",\"transcriptRequest\",\"roomOpen\",\"open\",\"token\",\"handleDiscard\",\"submit\",\"_ref2\",\"createElement\",\"wrapperFunction\",\"is\",\"onSubmit\",\"Header\",\"Icon\",\"name\",\"Title\",\"Close\",\"onClick\",\"Content\",\"fontScale\",\"disabled\",\"error\",\"message\",\"flexGrow\",\"required\",\"field\",\"Footer\",\"FooterControllers\",\"danger\",\"loading\",\"primary\",\"type\"],\"mappings\":\"2BACAA,EAAmGC,EAAnGC,EAASC,EAAOC,EAAQC,EAASC,EAAEC,EAAYC,EAAYC,EAAAC,EAAgEC,EAAAC,EAAAC,EAAAC,EAAAC,iEAAlHC,EAAOC,IAAQ,CAAA,iCAAiC,CAAEC,QAAA,SAAYC,CAAA,EAAQnB,EAAEmB,CAAA,CAAA,EAAU,GAAgCH,EAAAC,IAAA,CAAA,iDAAA,CAAAC,QAAA,SAAAC,CAAA,EAAAlB,EAAAkB,CAAA,CAAA,EAAA,GAA5CH,EAAEC,IAAA,CAAU,wBAAQ,CAAAf,MAAuB,SAACiB,CAAA,EAAAjB,EAAAiB,CAAA,EAAAhB,OAAA,SAAAgB,CAAA,EAAAhB,EAAAgB,CAAA,EAAAf,UAAA,SAAAe,CAAA,EAAAf,EAAAe,CAAA,EAAAd,MAAA,SAAAc,CAAA,EAAAd,EAAAc,CAAA,EAAAb,IAAA,SAAAa,CAAA,EAAAb,EAAAa,CAAA,EAAAZ,WAAA,SAAAY,CAAA,EAAAZ,EAAAY,CAAA,EAAAX,WAAA,SAAAW,CAAA,EAAAX,EAAAW,CAAA,EAAAV,SAAA,SAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,WAAA,SAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAA,QAAA,SAAAE,CAAA,EAAAR,EAAAQ,CAAA,EAAAP,YAAA,SAAAO,CAAA,EAAAP,EAAAO,CAAA,EAAAN,UAAA,SAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,kBAAA,CAAAH,QAAA,SAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,gBAAA,CAAAF,eAAA,SAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAA3HH,EAAOI,aAAS,CAcQ,SAAAC,CAAA,EAA+G,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAN,EAA5GO,KAAK,CAAEC,EAAYF,AAAA,KAAA,IAAAA,EAAG,GAAEA,EAAEG,EAAIT,EAAJS,IAAI,CAAEC,EAASV,EAATU,SAAS,CAAEC,EAAMX,EAANW,MAAM,CAAEC,EAAQZ,EAARY,QAAQ,CAAEC,EAASb,EAATa,SAAS,CAAKC,EAAKlC,EAAAoB,EAAAe,GAClGC,EAACC,AAAKvB,IAANsB,CAAC,CAETE,EAMIzB,EAAQ,CACX0B,cAAe,CAAEZ,MAAOC,GAAgB,GAAIY,QAASJ,EAAE,2CAA2C,IANlGK,EAAQH,EAARG,QAAQ,CACRC,EAAYJ,EAAZI,YAAY,CACZC,EAAQL,EAARK,QAAQ,CACRC,EAAQN,EAARM,QAAQ,CAAAC,EAAAP,EACRQ,SAAS,CAAIC,EAAMF,EAANE,MAAM,CAAEC,EAAYH,EAAZG,YAAY,CAKlCpC,EAAU,WACTgC,EAAS,UACV,EAAG,CAACA,EAAS,EAEb,IAAQK,EAAsBpB,EAAtBoB,iBAAiB,CACnBC,EAAWrB,MAAAA,EAAI,KAAA,EAAJA,EAAMsB,IAAI,CACrBC,EAAQvB,MAAAA,EAAI,KAAA,EAAA,AAAG,OAAHR,CAAAA,EAAJQ,EAAMX,CAAC,AAADA,GAACG,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAPA,EAAS+B,KAAK,CAEtBC,EAAgB1C,EAAY,WAAA,OAAMsB,GAAW,EAAE,CAACA,EAAU,EAE1DqB,EAAS3C,EACd,SAAA4C,CAAA,EAA2D,IAAxD5B,EAAK4B,EAAL5B,KAAK,CAAEa,EAAOe,EAAPf,OAAO,CACZU,GAAY,CAACD,GAChBnB,EAAUH,EAAOa,GAEd,CAACU,GAAYnB,GAAUqB,GAC1BrB,EAAOJ,EAAOa,EAASY,EAEzB,EACA,CAACtB,EAAWC,EAAQmB,EAAUE,EAAOH,EAAkB,EAYxD,OATArC,EAAU,WACLqC,IACHN,EAAS,QAASM,EAAkBtB,KAAK,EACzCgB,EAAS,UAAWM,EAAkBT,OAAO,EAE/C,EAAG,CAACG,EAAUM,EAAkB,EAK/BvC,EAAA8C,aAAA,CAACpD,EAAKL,EAAA,CAACoD,KAAI,CAAA,EAACM,gBAAiB,SAACvB,CAAK,EAAA,OAAKxB,EAAA8C,aAAA,CAACnD,EAAGN,EAAA,CAAC2D,GAAG,OAAOC,SAAUjB,EAAaY,EAAQ,EAAKpB,GAAS,CAAC,EAAKA,GACzGxB,EAAA8C,aAAA,CAACpD,EAAMwD,MAAM,CAAA,KACZlD,EAAA8C,aAAA,CAACpD,EAAMyD,IAAI,CAAA,CAACC,KAAK,sBAAsB,GACvCpD,EAAA8C,aAAA,CAACpD,EAAM2D,KAAK,CAAA,KAAE3B,EAAE,eAChB1B,EAAA8C,aAAA,CAACpD,EAAM4D,KAAK,CAAA,CAACC,QAASjC,CAAS,IAEhCtB,EAAA8C,aAAA,CAACpD,EAAM8D,OAAO,CAAA,CAACC,UAAU,IAAI,EAC3B,CAAC,CAAClB,GAAqBvC,EAAA8C,aAAA,CAAA,IAAA,KAAIpB,EAAE,kDAC9B1B,EAAA8C,aAAA,CAAClD,EAAU,KACVI,EAAA8C,aAAA,CAACvD,EAAK,KACLS,EAAA8C,aAAA,CAACjD,EAAU,KAAE6B,EAAE,SAAS,KACxB1B,EAAA8C,aAAA,CAAChD,EAAQ,KACRE,EAAA8C,aAAA,CAACrD,EAASJ,EAAA,CACTqE,SAAU,CAAC,CAACxC,GAAgB,CAAC,CAACqB,EAC9BoB,MAAK,AAAc,OAAd/C,CAAAA,EAAEyB,EAAOpB,KAAK,AAALA,GAAKL,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAZA,EAAcgD,OAAQ,CAC7BC,SAAU,CAAE,EACR9B,EAAS,QAAS,CAAE+B,SAAUpC,EAAE,iBAAkB,CAAEqC,MAAOrC,EAAE,QAAQ,EAAG,MAG9E1B,EAAA8C,aAAA,CAAC/C,EAAU,KAAA,AAAc,OAAdc,CAAAA,EAAEwB,EAAOpB,KAAK,AAALA,GAAKJ,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAZA,EAAc+C,OAAoB,GAEhD5D,EAAA8C,aAAA,CAACvD,EAAK,KACLS,EAAA8C,aAAA,CAACjD,EAAU,KAAE6B,EAAE,WAAW,KAC1B1B,EAAA8C,aAAA,CAAChD,EAAQ,KACRE,EAAA8C,aAAA,CAACrD,EAASJ,EAAA,CACTqE,SAAU,CAAC,CAACnB,EACZoB,MAAK,AAAgB,OAAhB7C,CAAAA,EAAEuB,EAAOP,OAAO,AAAPA,GAAOhB,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAdA,EAAgB8C,OAAQ,CAC/BC,SAAU,CAAE,EACR9B,EAAS,UAAW,CAAE+B,SAAUpC,EAAE,iBAAkB,CAAEqC,MAAOrC,EAAE,UAAU,EAAG,MAGlF1B,EAAA8C,aAAA,CAAC/C,EAAU,KAAA,AAAgB,OAAhBgB,CAAAA,EAAEsB,EAAOP,OAAO,AAAPA,GAAOf,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAdA,EAAgB6C,OAAoB,KAIpD5D,EAAA8C,aAAA,CAACpD,EAAMsE,MAAM,CAAA,KACZhE,EAAA8C,aAAA,CAACpD,EAAMuE,iBAAiB,CAAA,KACvBjE,EAAA8C,aAAA,CAACtD,EAAM,CAAC+D,QAASjC,CAAS,EAAEI,EAAE,WAC7Bc,GAAYD,GACZvC,EAAA8C,aAAA,CAACtD,EAAM,CAAC0E,OAAM,CAAA,EAACX,QAASZ,CAAc,EACpCjB,EAAE,iBAGJc,GAAY,CAACD,GACbvC,EAAA8C,aAAA,CAACtD,EAAM,CAAC,aAAW,iBAAiBkE,SAAUpB,EAAc6B,QAAS7B,EAAc8B,QAAO,CAAA,EAACC,KAAK,QAAQ,EACtG3C,EAAE,YAGJ,CAACc,GACDxC,EAAA8C,aAAA,CAACtD,EAAM,CAAC,aAAW,cAAckE,SAAUpB,EAAc6B,QAAS7B,EAAc8B,QAAO,CAAA,EAACC,KAAK,QAAQ,EACnG3C,EAAE,WAOV\"}"}