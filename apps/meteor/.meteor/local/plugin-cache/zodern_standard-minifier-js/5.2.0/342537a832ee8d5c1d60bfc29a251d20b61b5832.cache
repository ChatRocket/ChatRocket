{"code":"function module(e,t,l){let a,n,r,i,u,s,o,c,m,d,g,k,h,f;l.link(\"@rocket.chat/fuselage\",{TextInput(e){a=e},Chip(e){n=e},Button(e){r=e},FieldLabel(e){i=e},FieldRow(e){u=e}},0),l.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback(e){s=e}},1),l.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch(e){o=e}},2),l.link(\"react\",{default(e){c=e},useMemo(e){m=e},useState(e){d=e}},3),l.link(\"react-i18next\",{useTranslation(e){g=e}},4),l.link(\"../../views/omnichannel/additionalForms\",{CurrentChatTags(e){k=e}},5),l.link(\"./Skeleton\",{FormSkeleton(e){h=e}},6),l.link(\"./hooks/useLivechatTags\",{useLivechatTags(e){f=e}},7),l.exportDefault(e=>{let{tags:t=[],handler:l,error:E,tagRequired:p,department:v}=e,{t:C}=g(),{data:T,isInitialLoading:b}=f({department:v,viewAll:!v}),x=m(()=>t.filter(e=>!(null!=T&&T.tags.find(t=>t.name===e))),[t,null==T?void 0:T.tags]),F=o(),[_,w]=d(\"\"),y=m(()=>t.map(e=>({label:e,value:e})),[t]),A=e=>{t&&l(t.filter(t=>t!==e))},L=s(()=>{if(t){if(!_||\"\"===_.trim()){F({type:\"error\",message:C(\"Enter_a_tag\")}),w(\"\");return}if(t.includes(_)){F({type:\"error\",message:C(\"Tag_already_exists\")});return}l([...t,_]),w(\"\")}});return b?c.createElement(h,null):c.createElement(c.Fragment,null,c.createElement(i,{required:p,mb:4},C(\"Tags\")),null!=T&&T.tags&&null!=T&&T.tags.length?c.createElement(u,null,c.createElement(k,{value:y,handler:e=>{l(e.map(e=>e.label))},department:v,viewAll:!v})):c.createElement(c.Fragment,null,c.createElement(u,null,c.createElement(a,{error:E,value:_,onChange:e=>{let{currentTarget:t}=e;return w(t.value)},flexGrow:1,placeholder:C(\"Enter_a_tag\")}),c.createElement(r,{disabled:!_,mis:8,title:C(\"Add\"),onClick:L},C(\"Add\")))),x.length>0&&c.createElement(u,{justifyContent:\"flex-start\"},null==x?void 0:x.map((e,t)=>c.createElement(n,{key:t,onClick:()=>A(e),mie:8},e))))})}","map":"{\"version\":3,\"sources\":[\"client/components/Omnichannel/Tags.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { TextInput, Chip, Button, FieldLabel, FieldRow } from '@rocket.chat/fuselage';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport type { ChangeEvent, ReactElement } from 'react';\\nimport React, { useMemo, useState } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { CurrentChatTags } from '../../views/omnichannel/additionalForms';\\nimport { FormSkeleton } from './Skeleton';\\nimport { useLivechatTags } from './hooks/useLivechatTags';\\n\\ntype TagsProps = {\\n\\ttags?: string[];\\n\\thandler: (value: string[]) => void;\\n\\terror?: string;\\n\\ttagRequired?: boolean;\\n\\tdepartment?: string;\\n};\\n\\nconst Tags = ({ tags = [], handler, error, tagRequired, department }: TagsProps): ReactElement => {\\n\\tconst { t } = useTranslation();\\n\\n\\tconst { data: tagsResult, isInitialLoading } = useLivechatTags({\\n\\t\\tdepartment,\\n\\t\\tviewAll: !department,\\n\\t});\\n\\n\\tconst customTags = useMemo(() => {\\n\\t\\treturn tags.filter((tag) => !tagsResult?.tags.find((rtag) => rtag.name === tag));\\n\\t}, [tags, tagsResult?.tags]);\\n\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst [tagValue, handleTagValue] = useState('');\\n\\n\\tconst paginatedTagValue = useMemo(() => tags.map((tag) => ({ label: tag, value: tag })), [tags]);\\n\\n\\tconst removeTag = (tagToRemove: string): void => {\\n\\t\\tif (!tags) return;\\n\\n\\t\\thandler(tags.filter((tag) => tag !== tagToRemove));\\n\\t};\\n\\n\\tconst handleTagTextSubmit = useMutableCallback(() => {\\n\\t\\tif (!tags) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tif (!tagValue || tagValue.trim() === '') {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('Enter_a_tag') });\\n\\t\\t\\thandleTagValue('');\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tif (tags.includes(tagValue)) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('Tag_already_exists') });\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\thandler([...tags, tagValue]);\\n\\t\\thandleTagValue('');\\n\\t});\\n\\n\\tif (isInitialLoading) {\\n\\t\\treturn <FormSkeleton />;\\n\\t}\\n\\n\\treturn (\\n\\t\\t<>\\n\\t\\t\\t<FieldLabel required={tagRequired} mb={4}>\\n\\t\\t\\t\\t{t('Tags')}\\n\\t\\t\\t</FieldLabel>\\n\\n\\t\\t\\t{tagsResult?.tags && tagsResult?.tags.length ? (\\n\\t\\t\\t\\t<FieldRow>\\n\\t\\t\\t\\t\\t<CurrentChatTags\\n\\t\\t\\t\\t\\t\\tvalue={paginatedTagValue}\\n\\t\\t\\t\\t\\t\\thandler={(tags: { label: string; value: string }[]): void => {\\n\\t\\t\\t\\t\\t\\t\\thandler(tags.map((tag) => tag.label));\\n\\t\\t\\t\\t\\t\\t}}\\n\\t\\t\\t\\t\\t\\tdepartment={department}\\n\\t\\t\\t\\t\\t\\tviewAll={!department}\\n\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t) : (\\n\\t\\t\\t\\t<>\\n\\t\\t\\t\\t\\t<FieldRow>\\n\\t\\t\\t\\t\\t\\t<TextInput\\n\\t\\t\\t\\t\\t\\t\\terror={error}\\n\\t\\t\\t\\t\\t\\t\\tvalue={tagValue}\\n\\t\\t\\t\\t\\t\\t\\tonChange={({ currentTarget }: ChangeEvent<HTMLInputElement>): void => handleTagValue(currentTarget.value)}\\n\\t\\t\\t\\t\\t\\t\\tflexGrow={1}\\n\\t\\t\\t\\t\\t\\t\\tplaceholder={t('Enter_a_tag')}\\n\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t<Button disabled={!tagValue} mis={8} title={t('Add')} onClick={handleTagTextSubmit}>\\n\\t\\t\\t\\t\\t\\t\\t{t('Add')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t\\t</>\\n\\t\\t\\t)}\\n\\n\\t\\t\\t{customTags.length > 0 && (\\n\\t\\t\\t\\t<FieldRow justifyContent='flex-start'>\\n\\t\\t\\t\\t\\t{customTags?.map((tag, i) => (\\n\\t\\t\\t\\t\\t\\t<Chip key={i} onClick={(): void => removeTag(tag)} mie={8}>\\n\\t\\t\\t\\t\\t\\t\\t{tag}\\n\\t\\t\\t\\t\\t\\t</Chip>\\n\\t\\t\\t\\t\\t))}\\n\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t)}\\n\\t\\t</>\\n\\t);\\n};\\n\\nexport default Tags;\\n\",null],\"names\":[\"TextInput\",\"Chip\",\"Button\",\"FieldLabel\",\"FieldRow\",\"useMutableCallback\",\"useToastMessageDispatch\",\"React\",\"useMemo\",\"useState\",\"useTranslation\",\"CurrentChatTags\",\"FormSkeleton\",\"useLivechatTags\",\"module\",\"link\",\"v\",\"default\",\"exportDefault\",\"_ref\",\"tags\",\"handler\",\"error\",\"tagRequired\",\"department\",\"t\",\"data\",\"tagsResult\",\"isInitialLoading\",\"viewAll\",\"customTags\",\"filter\",\"tag\",\"find\",\"rtag\",\"name\",\"dispatchToastMessage\",\"tagValue\",\"handleTagValue\",\"paginatedTagValue\",\"map\",\"label\",\"value\",\"removeTag\",\"tagToRemove\",\"handleTagTextSubmit\",\"trim\",\"type\",\"message\",\"includes\",\"createElement\",\"Fragment\",\"required\",\"mb\",\"length\",\"onChange\",\"_ref2\",\"currentTarget\",\"flexGrow\",\"placeholder\",\"disabled\",\"mis\",\"title\",\"onClick\",\"justifyContent\",\"i\",\"key\",\"mie\"],\"mappings\":\"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\"}"}