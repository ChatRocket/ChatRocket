{"code":"function module(n,t,e){e.link(\"@babel/runtime/regenerator\",{default:function(n){u=n}},0),e.export({useOutlookCalendarListForToday:function(){return k},useOutlookCalendarList:function(){return d},useMutationOutlookCalendarSync:function(){return p}}),e.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch:function(n){r=n},useTranslation:function(n){o=n},useEndpoint:function(n){a=n}},0),e.link(\"@tanstack/react-query\",{useMutation:function(n){s=n},useQuery:function(n){c=n},useQueryClient:function(n){i=n}},1),e.link(\"../lib/syncOutlookEvents\",{syncOutlookEvents:function(n){l=n}},2),e.link(\"./useOutlookAuthentication\",{useOutlookAuthenticationMutation:function(n){f=n}},3);var u,r,o,a,s,c,i,l,f,k=function(){return d(new Date)},d=function(n){var t=a(\"GET\",\"/v1/calendar-events.list\");return c([\"outlook\",\"calendar\",\"list\"],function(){var e;return u.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.awrap(t({date:n.toISOString()}));case 2:return e=r.sent.data,r.abrupt(\"return\",e);case 5:case\"end\":return r.stop()}},null,null,null,Promise)})},p=function(){var n=o(),t=i(),e=f(),a=r();return s({mutationFn:function(){return u.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u.awrap(l());case 2:return n.next=4,u.awrap(t.invalidateQueries([\"outlook\",\"calendar\",\"list\"]));case 4:return n.next=6,u.awrap(e.mutateAsync());case 6:case\"end\":return n.stop()}},null,null,null,Promise)},onSuccess:function(){a({type:\"success\",message:n(\"Outlook_Sync_Success\")})},onError:function(t){t instanceof Error&&\"abort\"===t.message||a({type:\"error\",message:n(\"Outlook_Sync_Failed\")})}})}}","map":"{\"version\":3,\"sources\":[\"client/views/outlookCalendar/hooks/useOutlookCalendarList.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useToastMessageDispatch, useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\\n\\nimport { syncOutlookEvents } from '../lib/syncOutlookEvents';\\nimport { useOutlookAuthenticationMutation } from './useOutlookAuthentication';\\n\\nexport const useOutlookCalendarListForToday = () => {\\n\\treturn useOutlookCalendarList(new Date());\\n};\\n\\nexport const useOutlookCalendarList = (date: Date) => {\\n\\tconst calendarData = useEndpoint('GET', '/v1/calendar-events.list');\\n\\n\\treturn useQuery(['outlook', 'calendar', 'list'], async () => {\\n\\t\\tconst { data } = await calendarData({ date: date.toISOString() });\\n\\t\\treturn data;\\n\\t});\\n};\\n\\nexport const useMutationOutlookCalendarSync = () => {\\n\\tconst t = useTranslation();\\n\\tconst queryClient = useQueryClient();\\n\\n\\tconst checkOutlookCredentials = useOutlookAuthenticationMutation();\\n\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst syncMutation = useMutation({\\n\\t\\tmutationFn: async () => {\\n\\t\\t\\tawait syncOutlookEvents();\\n\\n\\t\\t\\tawait queryClient.invalidateQueries(['outlook', 'calendar', 'list']);\\n\\n\\t\\t\\tawait checkOutlookCredentials.mutateAsync();\\n\\t\\t},\\n\\t\\tonSuccess: () => {\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Outlook_Sync_Success') });\\n\\t\\t},\\n\\t\\tonError: (error) => {\\n\\t\\t\\tif (error instanceof Error && error.message === 'abort') {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('Outlook_Sync_Failed') });\\n\\t\\t},\\n\\t});\\n\\treturn syncMutation;\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"export\",\"useOutlookCalendarListForToday\",\"useOutlookCalendarList\",\"useMutationOutlookCalendarSync\",\"useToastMessageDispatch\",\"useTranslation\",\"useEndpoint\",\"useMutation\",\"useQuery\",\"useQueryClient\",\"syncOutlookEvents\",\"useOutlookAuthenticationMutation\",\"Date\",\"date\",\"calendarData\",\"data\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"toISOString\",\"_await$calendarData\",\"sent\",\"abrupt\",\"stop\",\"Promise\",\"t\",\"queryClient\",\"checkOutlookCredentials\",\"dispatchToastMessage\",\"mutationFn\",\"_context2\",\"invalidateQueries\",\"mutateAsync\",\"onSuccess\",\"type\",\"message\",\"onError\",\"error\",\"Error\"],\"mappings\":\"uBAASA,EAAAC,IAAyB,CAAA,6BAA6B,CAAAC,QAAM,SAAAC,CAAA,EAAAC,EAA2BD,CAAA,CAAA,EAAA,GAAhGH,EAAOK,MAAE,CAAA,CAAAC,+BAAyB,WAAgB,OAAaA,CAAM,EAA2BC,uBAAA,WAAA,OAAAA,CAAA,EAAAC,+BAAA,WAAA,OAAAA,CAAA,CAAA,GAAAR,EAAAC,IAAA,CAAA,2BAAA,CAAAQ,wBAAA,SAAAN,CAAA,EAAAM,EAAAN,CAAA,EAAAO,eAAA,SAAAP,CAAA,EAAAO,EAAAP,CAAA,EAAAQ,YAAA,SAAAR,CAAA,EAAAQ,EAAAR,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,wBAAA,CAAAW,YAAA,SAAAT,CAAA,EAAAS,EAAAT,CAAA,EAAAU,SAAA,SAAAV,CAAA,EAAAU,EAAAV,CAAA,EAAAW,eAAA,SAAAX,CAAA,EAAAW,EAAAX,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,2BAAA,CAAAc,kBAAA,SAAAZ,CAAA,EAAAY,EAAAZ,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,6BAAA,CAAAe,iCAAA,SAAAb,CAAA,EAAAa,EAAAb,CAAA,CAAA,EAAA,GAMzF,IANPC,EAAgGK,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAMnFV,EAAiC,WAC7C,OAAOC,EAAuB,IAAIU,KACnC,EAEaV,EAAyB,SAACW,CAAU,EAChD,IAAMC,EAAeR,EAAY,MAAO,4BAExC,OAAOE,EAAS,CAAC,UAAW,WAAY,OAAO,CAAE,WAAA,IAAAO,EAAA,OAAAhB,EAAAiB,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,OAAAF,EAAAE,IAAA,CAAA,EAAApB,EAAAqB,KAAA,CACzBN,EAAa,CAAED,KAAMA,EAAKQ,WAAW,EAAE,GAAG,MAAA,EAArD,OAAJN,EAAIO,AAAqDL,EAAAM,IAAA,CAAzDR,IAAI,CAAAE,EAAAO,MAAA,CAAA,SACLT,EAAI,MAAA,EAAA,IAAA,MAAA,OAAAE,EAAAQ,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EAEb,EAEavB,EAAiC,WAC7C,IAAMwB,EAAItB,IACJuB,EAAcnB,IAEdoB,EAA0BlB,IAE1BmB,EAAuB1B,IAoB7B,OAlBqBG,EAAY,CAChCwB,WAAY,WAAA,OAAAhC,EAAAiB,KAAA,CAAA,SAAAgB,CAAA,EAAA,OAAA,OAAAA,EAAAd,IAAA,CAAAc,EAAAb,IAAA,EAAA,KAAA,EAAA,OAAAa,EAAAb,IAAA,CAAA,EAAApB,EAAAqB,KAAA,CACLV,IAAmB,MAAA,EAAA,OAAAsB,EAAAb,IAAA,CAAA,EAAApB,EAAAqB,KAAA,CAEnBQ,EAAYK,iBAAiB,CAAC,CAAC,UAAW,WAAY,OAAO,EAAC,MAAA,EAAA,OAAAD,EAAAb,IAAA,CAAA,EAAApB,EAAAqB,KAAA,CAE9DS,EAAwBK,WAAW,GAAE,MAAA,EAAA,IAAA,MAAA,OAAAF,EAAAP,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EAE5CS,UAAW,WACVL,EAAqB,CAAEM,KAAM,UAAWC,QAASV,EAAE,uBAAuB,EAC3E,EACAW,QAAS,SAACC,CAAK,EACVA,aAAiBC,OAASD,AAAkB,UAAlBA,EAAMF,OAAO,EAG3CP,EAAqB,CAAEM,KAAM,QAASC,QAASV,EAAE,sBAAsB,EACxE,GAGF\"}"}