{"code":"function module(e,t,a){let l,n,i,r;a.export({appEnabledStatuses:()=>s,appButtonProps:()=>p,appIncompatibleStatusProps:()=>o,appStatusSpanProps:()=>u,appMultiStatusProps:()=>c}),a.link(\"@rocket.chat/apps-engine/definition/AppStatus\",{AppStatus(e){l=e}},0),a.link(\"semver\",{default(e){n=e}},1),a.link(\"../../../app/utils/lib/i18n\",{t(e){i=e}},2),a.link(\"./helpers/appErroredStatuses\",{appErroredStatuses(e){r=e}},3);let s=[l.AUTO_ENABLED,l.MANUALLY_ENABLED],p=e=>{let{installed:t,version:a,marketplaceVersion:l,isPurchased:i,price:r,purchaseType:s,subscriptionInfo:p,pricingPlans:o,isEnterpriseOnly:u,versionIncompatible:c,isAdminUser:b,requestedEndUser:d,endUserRequested:h}=e;if(!b)return d||h?{action:\"request\",label:\"Requested\"}:{action:\"request\",label:\"Request\"};let S=t&&a&&l&&n.lt(a,l);if(S)return c?{action:\"update\",icon:\"warning\",label:\"Update\"}:{action:\"update\",icon:\"reload\",label:\"Update\"};if(t)return;if(i)return c?{action:\"install\",icon:\"warning\",label:\"Install\"}:{action:\"install\",label:\"Install\"};let f=\"subscription\"===s&&!p.status;if(f){let e=o.every(e=>0===e.trialDays),t=o.every(e=>e.tiers&&e.tiers.length>0);return c?{action:\"purchase\",label:\"Subscribe\",icon:\"warning\"}:e||u?{action:\"purchase\",label:\"Subscribe\"}:t?{action:\"purchase\",label:\"See Pricing\"}:{action:\"purchase\",label:\"Try now\"}}return r>0?c?{action:\"purchase\",label:\"Buy\",icon:\"warning\"}:{action:\"purchase\",label:\"Buy\"}:c?{action:\"purchase\",label:\"Install\",icon:\"warning\"}:{action:\"purchase\",label:\"Install\"}},o=()=>({icon:\"check\",label:\"Incompatible\",tooltipText:i(\"App_version_incompatible_tooltip\")}),u=(e,t,a,n)=>{let{installed:p,status:o,subscriptionInfo:u,appRequestStats:c,migrated:b}=e,d=o&&s.includes(o);if(p)return d?b&&!t?{label:\"Enabled*\",tooltipText:i(\"Grandfathered_app\")}:{label:\"Enabled\"}:b&&!t?{label:\"Disabled*\",tooltipText:i(\"Grandfathered_app\")}:{type:\"warning\",label:\"Disabled\"};let h=o&&r.includes(o);if(h)return{type:\"failed\",icon:\"warning\",label:o===l.INVALID_SETTINGS_DISABLED?\"Config Needed\":\"Failed\"};let S=u&&\"trialing\"===u.status;return S?{icon:\"checkmark-circled\",label:\"Trial period\"}:\"requested\"===a&&c?n?{label:\"Requested\"}:c.totalUnseen?{label:c.totalUnseen>1?\"requests\":\"request\"}:{label:c.totalSeen>1?\"requests\":\"request\"}:void 0},c=(e,t,a,l)=>{let n=u(e,l,a,t),i=[];return(null==e?void 0:e.versionIncompatible)===void 0||t||i.push(o()),n&&i.push(n),i}}","map":"{\"version\":3,\"sources\":[\"client/views/marketplace/helpers.ts\",\"<anon>\"],\"sourcesContent\":[\"import { AppStatus } from '@rocket.chat/apps-engine/definition/AppStatus';\\nimport type { App } from '@rocket.chat/core-typings';\\nimport semver from 'semver';\\n\\n// import { t } from '../../../app/utils/client';\\nimport { t } from '../../../app/utils/lib/i18n';\\nimport { appErroredStatuses } from './helpers/appErroredStatuses';\\n\\nexport const appEnabledStatuses = [AppStatus.AUTO_ENABLED, AppStatus.MANUALLY_ENABLED];\\n\\nexport type Actions = 'update' | 'install' | 'purchase' | 'request';\\n\\ntype appButtonResponseProps = {\\n\\taction: Actions;\\n\\ticon?: 'reload' | 'warning';\\n\\tlabel: 'Update' | 'Install' | 'Subscribe' | 'See Pricing' | 'Try now' | 'Buy' | 'Request' | 'Requested';\\n};\\n\\nexport type appStatusSpanResponseProps = {\\n\\ttype?: 'failed' | 'warning';\\n\\ticon?: 'warning' | 'checkmark-circled' | 'check';\\n\\tlabel:\\n\\t\\t| 'Config Needed'\\n\\t\\t| 'Failed'\\n\\t\\t| 'Disabled'\\n\\t\\t| 'Disabled*'\\n\\t\\t| 'Trial period'\\n\\t\\t| 'Enabled'\\n\\t\\t| 'Enabled*'\\n\\t\\t| 'Incompatible'\\n\\t\\t| 'request'\\n\\t\\t| 'requests'\\n\\t\\t| 'Requested';\\n\\ttooltipText?: string;\\n};\\n\\ntype appButtonPropsType = App & { isAdminUser: boolean; endUserRequested: boolean };\\n\\nexport const appButtonProps = ({\\n\\tinstalled,\\n\\tversion,\\n\\tmarketplaceVersion,\\n\\tisPurchased,\\n\\tprice,\\n\\tpurchaseType,\\n\\tsubscriptionInfo,\\n\\tpricingPlans,\\n\\tisEnterpriseOnly,\\n\\tversionIncompatible,\\n\\tisAdminUser,\\n\\t// TODO: Unify this two variables\\n\\trequestedEndUser,\\n\\tendUserRequested,\\n}: appButtonPropsType): appButtonResponseProps | undefined => {\\n\\tif (!isAdminUser) {\\n\\t\\tif (requestedEndUser || endUserRequested) {\\n\\t\\t\\treturn {\\n\\t\\t\\t\\taction: 'request',\\n\\t\\t\\t\\tlabel: 'Requested',\\n\\t\\t\\t};\\n\\t\\t}\\n\\n\\t\\treturn {\\n\\t\\t\\taction: 'request',\\n\\t\\t\\tlabel: 'Request',\\n\\t\\t};\\n\\t}\\n\\n\\tconst canUpdate = installed && version && marketplaceVersion && semver.lt(version, marketplaceVersion);\\n\\tif (canUpdate) {\\n\\t\\tif (versionIncompatible) {\\n\\t\\t\\treturn {\\n\\t\\t\\t\\taction: 'update',\\n\\t\\t\\t\\ticon: 'warning',\\n\\t\\t\\t\\tlabel: 'Update',\\n\\t\\t\\t};\\n\\t\\t}\\n\\n\\t\\treturn {\\n\\t\\t\\taction: 'update',\\n\\t\\t\\ticon: 'reload',\\n\\t\\t\\tlabel: 'Update',\\n\\t\\t};\\n\\t}\\n\\n\\tif (installed) {\\n\\t\\treturn;\\n\\t}\\n\\n\\tconst canDownload = isPurchased;\\n\\tif (canDownload) {\\n\\t\\tif (versionIncompatible) {\\n\\t\\t\\treturn {\\n\\t\\t\\t\\taction: 'install',\\n\\t\\t\\t\\ticon: 'warning',\\n\\t\\t\\t\\tlabel: 'Install',\\n\\t\\t\\t};\\n\\t\\t}\\n\\n\\t\\treturn {\\n\\t\\t\\taction: 'install',\\n\\t\\t\\tlabel: 'Install',\\n\\t\\t};\\n\\t}\\n\\n\\tconst canSubscribe = purchaseType === 'subscription' && !subscriptionInfo.status;\\n\\tif (canSubscribe) {\\n\\t\\tconst cannotTry = pricingPlans.every((currentPricingPlan) => currentPricingPlan.trialDays === 0);\\n\\t\\tconst isTierBased = pricingPlans.every((currentPricingPlan) => currentPricingPlan.tiers && currentPricingPlan.tiers.length > 0);\\n\\n\\t\\tif (versionIncompatible) {\\n\\t\\t\\treturn {\\n\\t\\t\\t\\taction: 'purchase',\\n\\t\\t\\t\\tlabel: 'Subscribe',\\n\\t\\t\\t\\ticon: 'warning',\\n\\t\\t\\t};\\n\\t\\t}\\n\\n\\t\\tif (cannotTry || isEnterpriseOnly) {\\n\\t\\t\\treturn {\\n\\t\\t\\t\\taction: 'purchase',\\n\\t\\t\\t\\tlabel: 'Subscribe',\\n\\t\\t\\t};\\n\\t\\t}\\n\\n\\t\\tif (isTierBased) {\\n\\t\\t\\treturn {\\n\\t\\t\\t\\taction: 'purchase',\\n\\t\\t\\t\\tlabel: 'See Pricing',\\n\\t\\t\\t};\\n\\t\\t}\\n\\n\\t\\treturn {\\n\\t\\t\\taction: 'purchase',\\n\\t\\t\\tlabel: 'Try now',\\n\\t\\t};\\n\\t}\\n\\n\\tconst canBuy = price > 0;\\n\\tif (canBuy) {\\n\\t\\tif (versionIncompatible) {\\n\\t\\t\\treturn {\\n\\t\\t\\t\\taction: 'purchase',\\n\\t\\t\\t\\tlabel: 'Buy',\\n\\t\\t\\t\\ticon: 'warning',\\n\\t\\t\\t};\\n\\t\\t}\\n\\n\\t\\treturn {\\n\\t\\t\\taction: 'purchase',\\n\\t\\t\\tlabel: 'Buy',\\n\\t\\t};\\n\\t}\\n\\n\\tif (versionIncompatible) {\\n\\t\\treturn {\\n\\t\\t\\taction: 'purchase',\\n\\t\\t\\tlabel: 'Install',\\n\\t\\t\\ticon: 'warning',\\n\\t\\t};\\n\\t}\\n\\n\\treturn {\\n\\t\\taction: 'purchase',\\n\\t\\tlabel: 'Install',\\n\\t};\\n};\\n\\nexport const appIncompatibleStatusProps = (): appStatusSpanResponseProps => ({\\n\\ticon: 'check',\\n\\tlabel: 'Incompatible',\\n\\ttooltipText: t('App_version_incompatible_tooltip'),\\n});\\n\\nexport const appStatusSpanProps = (\\n\\t{ installed, status, subscriptionInfo, appRequestStats, migrated }: App,\\n\\tisEnterprise?: boolean,\\n\\tcontext?: string,\\n\\tisAppDetailsPage?: boolean,\\n): appStatusSpanResponseProps | undefined => {\\n\\tconst isEnabled = status && appEnabledStatuses.includes(status);\\n\\n\\tif (installed) {\\n\\t\\tif (isEnabled) {\\n\\t\\t\\treturn migrated && !isEnterprise\\n\\t\\t\\t\\t? {\\n\\t\\t\\t\\t\\t\\tlabel: 'Enabled*',\\n\\t\\t\\t\\t\\t\\ttooltipText: t('Grandfathered_app'),\\n\\t\\t\\t\\t  }\\n\\t\\t\\t\\t: {\\n\\t\\t\\t\\t\\t\\tlabel: 'Enabled',\\n\\t\\t\\t\\t  };\\n\\t\\t}\\n\\n\\t\\treturn migrated && !isEnterprise\\n\\t\\t\\t? {\\n\\t\\t\\t\\t\\tlabel: 'Disabled*',\\n\\t\\t\\t\\t\\ttooltipText: t('Grandfathered_app'),\\n\\t\\t\\t  }\\n\\t\\t\\t: {\\n\\t\\t\\t\\t\\ttype: 'warning',\\n\\t\\t\\t\\t\\tlabel: 'Disabled',\\n\\t\\t\\t  };\\n\\t}\\n\\n\\tconst isFailed = status && appErroredStatuses.includes(status);\\n\\tif (isFailed) {\\n\\t\\treturn {\\n\\t\\t\\ttype: 'failed',\\n\\t\\t\\ticon: 'warning',\\n\\t\\t\\tlabel: status === AppStatus.INVALID_SETTINGS_DISABLED ? 'Config Needed' : 'Failed',\\n\\t\\t};\\n\\t}\\n\\n\\tconst isOnTrialPeriod = subscriptionInfo && subscriptionInfo.status === 'trialing';\\n\\tif (isOnTrialPeriod) {\\n\\t\\treturn {\\n\\t\\t\\ticon: 'checkmark-circled',\\n\\t\\t\\tlabel: 'Trial period',\\n\\t\\t};\\n\\t}\\n\\n\\tif (context === 'requested' && appRequestStats) {\\n\\t\\tif (isAppDetailsPage) {\\n\\t\\t\\treturn {\\n\\t\\t\\t\\tlabel: 'Requested',\\n\\t\\t\\t};\\n\\t\\t}\\n\\n\\t\\tif (appRequestStats.totalUnseen) {\\n\\t\\t\\treturn {\\n\\t\\t\\t\\tlabel: appRequestStats.totalUnseen > 1 ? 'requests' : 'request',\\n\\t\\t\\t};\\n\\t\\t}\\n\\n\\t\\treturn {\\n\\t\\t\\tlabel: appRequestStats.totalSeen > 1 ? 'requests' : 'request',\\n\\t\\t};\\n\\t}\\n};\\n\\nexport const appMultiStatusProps = (\\n\\tapp: App,\\n\\tisAppDetailsPage: boolean,\\n\\tcontext: string,\\n\\tisEnterprise: boolean,\\n): appStatusSpanResponseProps[] => {\\n\\tconst status = appStatusSpanProps(app, isEnterprise, context, isAppDetailsPage);\\n\\tconst statuses = [];\\n\\n\\tif (app?.versionIncompatible !== undefined && !isAppDetailsPage) {\\n\\t\\tstatuses.push(appIncompatibleStatusProps());\\n\\t}\\n\\n\\tif (status) {\\n\\t\\tstatuses.push(status);\\n\\t}\\n\\n\\treturn statuses;\\n};\\n\",null],\"names\":[\"AppStatus\",\"semver\",\"t\",\"appErroredStatuses\",\"module\",\"export\",\"appEnabledStatuses\",\"appButtonProps\",\"appIncompatibleStatusProps\",\"appStatusSpanProps\",\"appMultiStatusProps\",\"link\",\"v\",\"default\",\"AUTO_ENABLED\",\"MANUALLY_ENABLED\",\"_ref\",\"installed\",\"version\",\"marketplaceVersion\",\"isPurchased\",\"price\",\"purchaseType\",\"subscriptionInfo\",\"pricingPlans\",\"isEnterpriseOnly\",\"versionIncompatible\",\"isAdminUser\",\"requestedEndUser\",\"endUserRequested\",\"action\",\"label\",\"canUpdate\",\"lt\",\"icon\",\"canSubscribe\",\"status\",\"cannotTry\",\"every\",\"currentPricingPlan\",\"trialDays\",\"isTierBased\",\"tiers\",\"length\",\"tooltipText\",\"_ref2\",\"isEnterprise\",\"context\",\"isAppDetailsPage\",\"appRequestStats\",\"migrated\",\"isEnabled\",\"includes\",\"type\",\"isFailed\",\"INVALID_SETTINGS_DISABLED\",\"isOnTrialPeriod\",\"totalUnseen\",\"totalSeen\",\"app\",\"statuses\",\"undefined\",\"push\"],\"mappings\":\"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\"}"}