{"code":"function module(e,t,r){let o,a,i,n,s,l,u,c,k,d,m;r.link(\"@rocket.chat/ui-contexts\",{useEndpoint(e){o=e},useRouter(e){a=e},useSearchParameter(e){i=e},useToastMessageDispatch(e){n=e},useUserId(e){s=e}},0),r.link(\"@tanstack/react-query\",{useQuery(e){l=e}},1),r.link(\"react\",{default(e){u=e}},2),r.link(\"react-i18next\",{useTranslation(e){c=e}},3),r.link(\"../../lib/errors/VisitorDoesNotExistError\",{VisitorDoesNotExistError(e){k=e}},4),r.link(\"../root/PageLoading\",{default(e){d=e}},5),r.link(\"./MeetPage\",{default(e){m=e}},6),r.exportDefault(()=>{var e;let t=a(),r=n(),{t:f}=c(),g=s(),v=null!==(e=i(\"token\"))&&void 0!==e?e:\"\",E=o(\"GET\",\"/v1/livechat/visitor/:token\",{token:v}),{data:h}=l([\"meet\",{token:v}],async()=>{if(v){let e=await E();if(\"visitor\"in e)return!0;throw new k}return!!g},{onSuccess:e=>{!1===e&&t.navigate(\"/home\")},onError:e=>{if(e instanceof k){r({type:\"error\",message:f(\"core.Visitor_does_not_exist\")}),t.navigate(\"/home\");return}r({type:\"error\",message:e}),t.navigate(\"/home\")}});return h?u.createElement(m,null):u.createElement(d,null)})}","map":"{\"version\":3,\"sources\":[\"client/views/meet/MeetRoute.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { useEndpoint, useRouter, useSearchParameter, useToastMessageDispatch, useUserId } from '@rocket.chat/ui-contexts';\\nimport { useQuery } from '@tanstack/react-query';\\nimport React from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { VisitorDoesNotExistError } from '../../lib/errors/VisitorDoesNotExistError';\\nimport PageLoading from '../root/PageLoading';\\nimport MeetPage from './MeetPage';\\n\\nconst MeetRoute = () => {\\n\\tconst router = useRouter();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst { t } = useTranslation();\\n\\n\\tconst uid = useUserId();\\n\\tconst token = useSearchParameter('token') ?? '';\\n\\tconst getVisitorByToken = useEndpoint('GET', '/v1/livechat/visitor/:token', { token });\\n\\n\\tconst { data: hasVisitor } = useQuery(\\n\\t\\t['meet', { token }],\\n\\t\\tasync () => {\\n\\t\\t\\tif (token) {\\n\\t\\t\\t\\tconst result = await getVisitorByToken();\\n\\t\\t\\t\\tif ('visitor' in result) {\\n\\t\\t\\t\\t\\treturn true;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tthrow new VisitorDoesNotExistError();\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (!uid) {\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn true;\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\tonSuccess: (hasVisitor) => {\\n\\t\\t\\t\\tif (hasVisitor === false) {\\n\\t\\t\\t\\t\\trouter.navigate('/home');\\n\\t\\t\\t\\t}\\n\\t\\t\\t},\\n\\t\\t\\tonError: (error) => {\\n\\t\\t\\t\\tif (error instanceof VisitorDoesNotExistError) {\\n\\t\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('core.Visitor_does_not_exist') });\\n\\t\\t\\t\\t\\trouter.navigate('/home');\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t\\trouter.navigate('/home');\\n\\t\\t\\t},\\n\\t\\t},\\n\\t);\\n\\n\\tif (!hasVisitor) {\\n\\t\\treturn <PageLoading />;\\n\\t}\\n\\n\\treturn <MeetPage />;\\n};\\n\\nexport default MeetRoute;\\n\",null],\"names\":[\"useEndpoint\",\"useRouter\",\"useSearchParameter\",\"useToastMessageDispatch\",\"useUserId\",\"useQuery\",\"React\",\"useTranslation\",\"VisitorDoesNotExistError\",\"PageLoading\",\"MeetPage\",\"module\",\"link\",\"v\",\"default\",\"exportDefault\",\"MeetRoute\",\"_useSearchParameter\",\"router\",\"dispatchToastMessage\",\"t\",\"uid\",\"token\",\"getVisitorByToken\",\"data\",\"hasVisitor\",\"result\",\"onSuccess\",\"navigate\",\"onError\",\"error\",\"type\",\"message\",\"createElement\"],\"mappings\":\"2BAAAA,EAASC,EAAaC,EAAWC,EAAoBC,EAAqEC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA5CC,EAAAC,IAAW,CAAA,2BAAM,CAAAZ,YAA2Ba,CAAA,EAAAb,EAAAa,CAAA,EAAAZ,UAAAY,CAAA,EAAAZ,EAAAY,CAAA,EAAAX,mBAAAW,CAAA,EAAAX,EAAAW,CAAA,EAAAV,wBAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,UAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,wBAAA,CAAAP,SAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,QAAA,CAAAE,QAAAD,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,gBAAA,CAAAL,eAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,4CAAA,CAAAJ,yBAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,sBAAA,CAAAE,QAAAD,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,aAAA,CAAAE,QAAAD,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,GAA1HF,EAAOI,aAAa,CASFC,KAAK,IAAAC,EACtB,IAAMC,EAASjB,IACTkB,EAAuBhB,IACvB,CAAEiB,EAAAA,CAAAA,CAAG,CAAGb,IAERc,EAAMjB,IACNkB,EAAK,AAA8B,OAA9BL,CAAAA,EAAGf,EAAmB,QAAO,GAACe,AAAA,KAAA,IAAAA,EAAAA,EAAI,GACvCM,EAAoBvB,EAAY,MAAO,8BAA+B,CAAEsB,MAAAA,CAAK,GAE7E,CAAEE,KAAMC,CAAAA,CAAY,CAAGpB,EAC5B,CAAC,OAAQ,CAAEiB,MAAAA,CAAK,EAAG,CACnB,UACC,GAAIA,EAAO,CACV,IAAMI,EAAS,MAAMH,IACrB,GAAI,YAAaG,EAChB,MAAO,CAAA,CAGR,OAAM,IAAIlB,CACX,SAEKa,CAKN,EACA,CACCM,UAAYF,IACQ,CAAA,IAAfA,GACHP,EAAOU,QAAQ,CAAC,QAElB,EACAC,QAAUC,IACT,GAAIA,aAAiBtB,EAA0B,CAC9CW,EAAqB,CAAEY,KAAM,QAASC,QAASZ,EAAE,8BAA8B,GAC/EF,EAAOU,QAAQ,CAAC,SAChB,MACD,CAEAT,EAAqB,CAAEY,KAAM,QAASC,QAASF,CAAK,GACpDZ,EAAOU,QAAQ,CAAC,QACjB,WAIF,AAAKH,EAIEnB,EAAA2B,aAAA,CAACvB,EAAQ,MAHRJ,EAAA2B,aAAA,CAACxB,EAAW,KAIrB\"}"}