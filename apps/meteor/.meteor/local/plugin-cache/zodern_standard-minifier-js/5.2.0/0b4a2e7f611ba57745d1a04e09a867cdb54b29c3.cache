{"code":"function module(e,t,a){let n,o,l,s,m,r,i,d,u,c,g,p,k,y;a.link(\"@babel/runtime/helpers/objectSpread2\",{default(e){n=e}},0),a.export({useDeleteRoom:()=>f}),a.link(\"@rocket.chat/core-typings\",{isRoomFederated(e){o=e}},0),a.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback(e){l=e}},1),a.link(\"@rocket.chat/ui-contexts\",{useSetModal(e){s=e},useToastMessageDispatch(e){m=e},useRouter(e){r=e},usePermission(e){i=e},useEndpoint(e){d=e},useTranslation(e){u=e}},2),a.link(\"@tanstack/react-query\",{useMutation(e){c=e},useQuery(e){g=e}},3),a.link(\"react\",{default(e){p=e}},4),a.link(\"../../../components/GenericModal\",{default(e){k=e}},5),a.link(\"../../teams/contextualBar/info/DeleteTeam\",{default(e){y=e}},6);let f=function(e){let{reload:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=u(),f=r(),I=s(),h=m(),v=\"prid\"in e?\"discussion\":e.teamId&&e.teamMain?\"team\":\"channel\",_=\"admin-rooms\"===f.getRouteName(),T=d(\"POST\",\"/v1/rooms.delete\"),S=d(\"POST\",\"/v1/teams.delete\"),b=d(\"GET\",\"/v1/teams.info\"),D=e.teamId||\"\",{data:M}=g([\"teamId\",D],async()=>b({teamId:D}),{keepPreviousData:!0,retry:!1,enabled:\"\"!==e.teamId}),E=i(\"delete-\".concat(e.t),e._id),C=i(\"delete-team-\".concat(\"c\"===e.t?\"channel\":\"group\"),null==M?void 0:M.teamInfo.roomId),R=e.teamId,x=!o(e)&&E&&(!R||C),P=c({mutationFn:T,onSuccess:()=>(h({type:\"success\",message:a(\"Deleted_roomType\",{roomName:e.name,roomType:v})}),_)?f.navigate(\"/admin/rooms\"):f.navigate(\"/home\"),onError:e=>{h({type:\"error\",message:e})},onSettled:()=>{I(null),null==t||t()}}),F=c({mutationFn:S,onSuccess:()=>(h({type:\"success\",message:a(\"Team_has_been_deleted\")}),_)?f.navigate(\"/admin/rooms\"):f.navigate(\"/home\"),onError:e=>{h({type:\"error\",message:e})},onSettled:()=>{I(null),null==t||t()}}),A=F.isLoading||P.isLoading,G=l(()=>{let t=async t=>{e.teamId&&F.mutateAsync(n({teamId:e.teamId},t.length&&{roomsToRemove:t}))};if(e.teamMain&&e.teamId)return I(p.createElement(y,{onConfirm:t,onCancel:()=>I(null),teamId:e.teamId}));let o=async()=>{P.mutateAsync({roomId:e._id})};I(p.createElement(k,{title:a(\"Delete_roomType\",{roomType:v}),variant:\"danger\",onConfirm:o,onCancel:()=>I(null),confirmText:a(\"Yes_delete_it\")},a(\"Delete_Room_Warning\",{roomType:v})))});return{handleDelete:G,canDeleteRoom:x,isDeleting:A}}}","map":"{\"version\":3,\"sources\":[\"client/views/hooks/roomActions/useDeleteRoom.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom, RoomAdminFieldsType } from '@rocket.chat/core-typings';\\nimport { isRoomFederated } from '@rocket.chat/core-typings';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useSetModal, useToastMessageDispatch, useRouter, usePermission, useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\\nimport { useMutation, useQuery } from '@tanstack/react-query';\\nimport React from 'react';\\n\\nimport GenericModal from '../../../components/GenericModal';\\nimport DeleteTeamModal from '../../teams/contextualBar/info/DeleteTeam';\\n\\nexport const useDeleteRoom = (room: IRoom | Pick<IRoom, RoomAdminFieldsType>, { reload }: { reload?: () => void } = {}) => {\\n\\tconst t = useTranslation();\\n\\tconst router = useRouter();\\n\\tconst setModal = useSetModal();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\t// eslint-disable-next-line no-nested-ternary\\n\\tconst roomType = 'prid' in room ? 'discussion' : room.teamId && room.teamMain ? 'team' : 'channel';\\n\\tconst isAdminRoute = router.getRouteName() === 'admin-rooms';\\n\\n\\tconst deleteRoomEndpoint = useEndpoint('POST', '/v1/rooms.delete');\\n\\tconst deleteTeamEndpoint = useEndpoint('POST', '/v1/teams.delete');\\n\\tconst teamsInfoEndpoint = useEndpoint('GET', '/v1/teams.info');\\n\\n\\tconst teamId = room.teamId || '';\\n\\tconst { data: teamInfoData } = useQuery(['teamId', teamId], async () => teamsInfoEndpoint({ teamId }), {\\n\\t\\tkeepPreviousData: true,\\n\\t\\tretry: false,\\n\\t\\tenabled: room.teamId !== '',\\n\\t});\\n\\n\\tconst hasPermissionToDeleteRoom = usePermission(`delete-${room.t}`, room._id);\\n\\tconst hasPermissionToDeleteTeamRoom = usePermission(`delete-team-${room.t === 'c' ? 'channel' : 'group'}`, teamInfoData?.teamInfo.roomId);\\n\\tconst isTeamRoom = room.teamId;\\n\\tconst canDeleteRoom = isRoomFederated(room) ? false : hasPermissionToDeleteRoom && (!isTeamRoom || hasPermissionToDeleteTeamRoom);\\n\\n\\tconst deleteRoomMutation = useMutation({\\n\\t\\tmutationFn: deleteRoomEndpoint,\\n\\t\\tonSuccess: () => {\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Deleted_roomType', { roomName: room.name, roomType }) });\\n\\t\\t\\tif (isAdminRoute) {\\n\\t\\t\\t\\treturn router.navigate('/admin/rooms');\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn router.navigate('/home');\\n\\t\\t},\\n\\t\\tonError: (error) => {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t},\\n\\t\\tonSettled: () => {\\n\\t\\t\\tsetModal(null);\\n\\t\\t\\treload?.();\\n\\t\\t},\\n\\t});\\n\\n\\tconst deleteTeamMutation = useMutation({\\n\\t\\tmutationFn: deleteTeamEndpoint,\\n\\t\\tonSuccess: () => {\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Team_has_been_deleted') });\\n\\t\\t\\tif (isAdminRoute) {\\n\\t\\t\\t\\treturn router.navigate('/admin/rooms');\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn router.navigate('/home');\\n\\t\\t},\\n\\t\\tonError: (error) => {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t},\\n\\t\\tonSettled: () => {\\n\\t\\t\\tsetModal(null);\\n\\t\\t\\treload?.();\\n\\t\\t},\\n\\t});\\n\\n\\tconst isDeleting = deleteTeamMutation.isLoading || deleteRoomMutation.isLoading;\\n\\n\\tconst handleDelete = useMutableCallback(() => {\\n\\t\\tconst handleDeleteTeam = async (roomsToRemove: IRoom['_id'][]) => {\\n\\t\\t\\tif (!room.teamId) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tdeleteTeamMutation.mutateAsync({ teamId: room.teamId, ...(roomsToRemove.length && { roomsToRemove }) });\\n\\t\\t};\\n\\n\\t\\tif (room.teamMain && room.teamId) {\\n\\t\\t\\treturn setModal(<DeleteTeamModal onConfirm={handleDeleteTeam} onCancel={(): void => setModal(null)} teamId={room.teamId} />);\\n\\t\\t}\\n\\n\\t\\tconst handleDeleteRoom = async () => {\\n\\t\\t\\tdeleteRoomMutation.mutateAsync({ roomId: room._id });\\n\\t\\t};\\n\\n\\t\\tsetModal(\\n\\t\\t\\t<GenericModal\\n\\t\\t\\t\\ttitle={t('Delete_roomType', { roomType })}\\n\\t\\t\\t\\tvariant='danger'\\n\\t\\t\\t\\tonConfirm={handleDeleteRoom}\\n\\t\\t\\t\\tonCancel={(): void => setModal(null)}\\n\\t\\t\\t\\tconfirmText={t('Yes_delete_it')}\\n\\t\\t\\t>\\n\\t\\t\\t\\t{t('Delete_Room_Warning', { roomType })}\\n\\t\\t\\t</GenericModal>,\\n\\t\\t);\\n\\t});\\n\\n\\treturn { handleDelete, canDeleteRoom, isDeleting };\\n};\\n\",null],\"names\":[\"_objectSpread\",\"isRoomFederated\",\"useMutableCallback\",\"useSetModal\",\"useToastMessageDispatch\",\"useRouter\",\"usePermission\",\"useEndpoint\",\"useTranslation\",\"useMutation\",\"useQuery\",\"React\",\"GenericModal\",\"DeleteTeamModal\",\"module\",\"link\",\"default\",\"v\",\"export\",\"useDeleteRoom\",\"room\",\"reload\",\"arguments\",\"length\",\"undefined\",\"t\",\"router\",\"setModal\",\"dispatchToastMessage\",\"roomType\",\"teamId\",\"teamMain\",\"isAdminRoute\",\"getRouteName\",\"deleteRoomEndpoint\",\"deleteTeamEndpoint\",\"teamsInfoEndpoint\",\"data\",\"teamInfoData\",\"keepPreviousData\",\"retry\",\"enabled\",\"hasPermissionToDeleteRoom\",\"concat\",\"_id\",\"hasPermissionToDeleteTeamRoom\",\"teamInfo\",\"roomId\",\"isTeamRoom\",\"canDeleteRoom\",\"deleteRoomMutation\",\"mutationFn\",\"onSuccess\",\"type\",\"message\",\"roomName\",\"name\",\"navigate\",\"onError\",\"error\",\"onSettled\",\"deleteTeamMutation\",\"isDeleting\",\"isLoading\",\"handleDelete\",\"handleDeleteTeam\",\"roomsToRemove\",\"mutateAsync\",\"createElement\",\"onConfirm\",\"onCancel\",\"handleDeleteRoom\",\"title\",\"variant\",\"confirmText\"],\"mappings\":\"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\"}"}