{"code":"function module(e,n,t){t.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){i=e}},0),t.export({useLegacyThreadMessages:function(){return d}}),t.link(\"@rocket.chat/core-typings\",{isThreadMessage:function(e){s=e}},0),t.link(\"@rocket.chat/ui-contexts\",{useMethod:function(e){u=e}},1),t.link(\"react\",{useEffect:function(e){o=e},useState:function(e){a=e},useCallback:function(e){c=e}},2),t.link(\"../../../../../../app/models/client\",{Messages:function(e){l=e}},3),t.link(\"../../../../../../app/ui-utils/client/lib/RoomHistoryManager\",{upsertMessageBulk:function(e){r=e}},4),t.link(\"../../../../../hooks/useReactiveValue\",{useReactiveValue:function(e){f=e}},5);var i,s,u,o,a,c,l,r,f,d=function(e){var n=f(c(function(){return l.find({$or:[{tmid:e},{_id:e}],_hidden:{$ne:!0},tmid:e,_id:{$ne:e}},{fields:{collapsed:0,threadMsg:0,repliesCount:0},sort:{ts:1}}).fetch().filter(s)},[e])),t=a(!1),d=i(t,2),g=d[0],h=d[1],k=u(\"getThreadMessages\");return o(function(){h(!0),k({tmid:e}).then(function(e){r({msgs:e},l),h(!1)})},[k,e]),{messages:n,loading:g}}}","map":"{\"version\":3,\"sources\":[\"client/views/room/contextualBar/Threads/hooks/useLegacyThreadMessages.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IThreadMessage, IThreadMainMessage } from '@rocket.chat/core-typings';\\nimport { isThreadMessage } from '@rocket.chat/core-typings';\\nimport { useMethod } from '@rocket.chat/ui-contexts';\\nimport { useEffect, useState, useCallback } from 'react';\\n\\nimport { Messages } from '../../../../../../app/models/client';\\nimport { upsertMessageBulk } from '../../../../../../app/ui-utils/client/lib/RoomHistoryManager';\\nimport { useReactiveValue } from '../../../../../hooks/useReactiveValue';\\n\\nexport const useLegacyThreadMessages = (\\n\\ttmid: IThreadMainMessage['_id'],\\n): {\\n\\tmessages: Array<IThreadMessage | IThreadMainMessage>;\\n\\tloading: boolean;\\n} => {\\n\\tconst messages = useReactiveValue(\\n\\t\\tuseCallback(() => {\\n\\t\\t\\treturn Messages.find(\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t$or: [{ tmid }, { _id: tmid }],\\n\\t\\t\\t\\t\\t_hidden: { $ne: true },\\n\\t\\t\\t\\t\\ttmid,\\n\\t\\t\\t\\t\\t_id: { $ne: tmid },\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\tfields: {\\n\\t\\t\\t\\t\\t\\tcollapsed: 0,\\n\\t\\t\\t\\t\\t\\tthreadMsg: 0,\\n\\t\\t\\t\\t\\t\\trepliesCount: 0,\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\tsort: { ts: 1 },\\n\\t\\t\\t\\t},\\n\\t\\t\\t)\\n\\t\\t\\t\\t.fetch()\\n\\t\\t\\t\\t.filter(isThreadMessage);\\n\\t\\t}, [tmid]),\\n\\t);\\n\\n\\tconst [loading, setLoading] = useState(false);\\n\\n\\tconst getThreadMessages = useMethod('getThreadMessages');\\n\\n\\tuseEffect(() => {\\n\\t\\tsetLoading(true);\\n\\t\\tgetThreadMessages({ tmid }).then((messages) => {\\n\\t\\t\\tupsertMessageBulk({ msgs: messages }, Messages);\\n\\t\\t\\tsetLoading(false);\\n\\t\\t});\\n\\t}, [getThreadMessages, tmid]);\\n\\n\\treturn { messages, loading };\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_slicedToArray\",\"export\",\"useLegacyThreadMessages\",\"isThreadMessage\",\"useMethod\",\"useEffect\",\"useState\",\"useCallback\",\"Messages\",\"upsertMessageBulk\",\"useReactiveValue\",\"tmid\",\"messages\",\"find\",\"$or\",\"_id\",\"_hidden\",\"$ne\",\"fields\",\"collapsed\",\"threadMsg\",\"repliesCount\",\"sort\",\"ts\",\"fetch\",\"filter\",\"_useState\",\"_useState2\",\"loading\",\"setLoading\",\"getThreadMessages\",\"then\",\"msgs\"],\"mappings\":\"uBACSA,EAAiBC,IAAA,CAAA,uCAAkC,CAAAC,QAAA,SAAAC,CAAA,EAAAC,EAAAD,CAAA,CAAA,EAAA,GAA5DH,EAAOK,MAAE,CAAA,CAAAC,wBAAuB,WAAA,OAAAA,CAA4B,CAAA,GAAAN,EAAAC,IAAA,CAAA,4BAAA,CAAAM,gBAAA,SAAAJ,CAAA,EAAAI,EAAAJ,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,2BAAA,CAAAO,UAAA,SAAAL,CAAA,EAAAK,EAAAL,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAAQ,UAAA,SAAAN,CAAA,EAAAM,EAAAN,CAAA,EAAAO,SAAA,SAAAP,CAAA,EAAAO,EAAAP,CAAA,EAAAQ,YAAA,SAAAR,CAAA,EAAAQ,EAAAR,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,sCAAA,CAAAW,SAAA,SAAAT,CAAA,EAAAS,EAAAT,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,+DAAA,CAAAY,kBAAA,SAAAV,CAAA,EAAAU,EAAAV,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,wCAAA,CAAAa,iBAAA,SAAAX,CAAA,EAAAW,EAAAX,CAAA,CAAA,EAAA,GAQrD,IARPC,EAA4DG,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAQ/CR,EAA0B,SACtCS,CAA+B,EAK/B,IAAMC,EAAWF,EAChBH,EAAY,WACX,OAAOC,EAASK,IAAI,CACnB,CACCC,IAAK,CAAC,CAAEH,KAAAA,CAAI,EAAI,CAAEI,IAAKJ,CAAI,EAAG,CAC9BK,QAAS,CAAEC,IAAK,CAAA,CAAI,EACpBN,KAAAA,EACAI,IAAK,CAAEE,IAAKN,CAAI,GAEjB,CACCO,OAAQ,CACPC,UAAW,EACXC,UAAW,EACXC,aAAc,GAEfC,KAAM,CAAEC,GAAI,CAAC,IAGbC,KAAK,GACLC,MAAM,CAACtB,EACV,EAAG,CAACQ,EAAK,GAGVe,EAA8BpB,EAAS,CAAA,GAAMqB,EAAA3B,EAAA0B,EAAA,GAAtCE,EAAOD,CAAA,CAAA,EAAA,CAAEE,EAAUF,CAAA,CAAA,EAAA,CAEpBG,EAAoB1B,EAAU,qBAUpC,OARAC,EAAU,WACTwB,EAAW,CAAA,GACXC,EAAkB,CAAEnB,KAAAA,CAAI,GAAIoB,IAAI,CAAC,SAACnB,CAAQ,EACzCH,EAAkB,CAAEuB,KAAMpB,CAAQ,EAAIJ,GACtCqB,EAAW,CAAA,EACZ,EACD,EAAG,CAACC,EAAmBnB,EAAK,EAErB,CAAEC,SAAAA,EAAUgB,QAAAA,CAAO,CAC3B\"}"}