{"code":"function module(e,t,r){r.link(\"@babel/runtime/regenerator\",{default:function(e){n=e}},0),r.link(\"meteor/meteor\",{Meteor:function(e){s=e}},0),r.link(\"meteor/tracker\",{Tracker:function(e){o=e}},1),r.link(\"underscore\",{default:function(e){u=e}},2),r.link(\"../../custom-oauth/client/CustomOAuth\",{CustomOAuth:function(e){a=e}},3),r.link(\"../../settings/client\",{settings:function(e){i=e}},4);var n,s,o,u,a,i,c={serverURL:\"\",identityPath:\"/oauth/me\",addAutopublishFields:{forLoggedInUser:[\"services.wordpress\"],forOtherUsers:[\"services.wordpress.user_login\"]},accessTokenParam:\"access_token\"},p=new a(\"wordpress\",c),_=u.debounce(function(){var e,t;return n.async(function(r){for(;;)switch(r.prev=r.next){case 0:if(c.serverURL=i.get(\"API_Wordpress_URL\"),c.serverURL){r.next=5;break}if(void 0!==c.serverURL){r.next=4;break}return r.abrupt(\"return\",_());case 4:return r.abrupt(\"return\");case 5:delete c.identityPath,delete c.identityTokenSentVia,delete c.authorizePath,delete c.tokenPath,delete c.scope,e=i.get(\"Accounts_OAuth_Wordpress_server_type\"),r.t0=e,r.next=\"custom\"===r.t0?14:\"wordpress-com\"===r.t0?20:26;break;case 14:return i.get(\"Accounts_OAuth_Wordpress_identity_path\")&&(c.identityPath=i.get(\"Accounts_OAuth_Wordpress_identity_path\")),i.get(\"Accounts_OAuth_Wordpress_identity_token_sent_via\")&&(c.identityTokenSentVia=i.get(\"Accounts_OAuth_Wordpress_identity_token_sent_via\")),i.get(\"Accounts_OAuth_Wordpress_token_path\")&&(c.tokenPath=i.get(\"Accounts_OAuth_Wordpress_token_path\")),i.get(\"Accounts_OAuth_Wordpress_authorize_path\")&&(c.authorizePath=i.get(\"Accounts_OAuth_Wordpress_authorize_path\")),i.get(\"Accounts_OAuth_Wordpress_scope\")&&(c.scope=i.get(\"Accounts_OAuth_Wordpress_scope\")),r.abrupt(\"break\",28);case 20:return c.identityPath=\"https://public-api.wordpress.com/rest/v1/me\",c.identityTokenSentVia=\"header\",c.authorizePath=\"https://public-api.wordpress.com/oauth2/authorize\",c.tokenPath=\"https://public-api.wordpress.com/oauth2/token\",c.scope=\"auth\",r.abrupt(\"break\",28);case 26:return c.identityPath=\"/oauth/me\",r.abrupt(\"break\",28);case 28:return t=p.configure(c),r.abrupt(\"return\",t);case 30:case\"end\":return r.stop()}},null,null,null,Promise)},100);s.startup(function(){return o.autorun(function(){return _()})})}","map":"{\"version\":3,\"sources\":[\"app/wordpress/client/lib.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { OauthConfig } from '@rocket.chat/core-typings';\\nimport { Meteor } from 'meteor/meteor';\\nimport { Tracker } from 'meteor/tracker';\\nimport _ from 'underscore';\\n\\nimport { CustomOAuth } from '../../custom-oauth/client/CustomOAuth';\\nimport { settings } from '../../settings/client';\\n\\nconst config: OauthConfig = {\\n\\tserverURL: '',\\n\\tidentityPath: '/oauth/me',\\n\\n\\taddAutopublishFields: {\\n\\t\\tforLoggedInUser: ['services.wordpress'],\\n\\t\\tforOtherUsers: ['services.wordpress.user_login'],\\n\\t},\\n\\taccessTokenParam: 'access_token',\\n};\\n\\nconst WordPress = new CustomOAuth('wordpress', config);\\n\\nconst fillSettings = _.debounce(async (): Promise<void> => {\\n\\tconfig.serverURL = settings.get('API_Wordpress_URL');\\n\\tif (!config.serverURL) {\\n\\t\\tif (config.serverURL === undefined) {\\n\\t\\t\\treturn fillSettings();\\n\\t\\t}\\n\\t\\treturn;\\n\\t}\\n\\n\\tdelete config.identityPath;\\n\\tdelete config.identityTokenSentVia;\\n\\tdelete config.authorizePath;\\n\\tdelete config.tokenPath;\\n\\tdelete config.scope;\\n\\n\\tconst serverType = settings.get('Accounts_OAuth_Wordpress_server_type');\\n\\tswitch (serverType) {\\n\\t\\tcase 'custom':\\n\\t\\t\\tif (settings.get('Accounts_OAuth_Wordpress_identity_path')) {\\n\\t\\t\\t\\tconfig.identityPath = settings.get('Accounts_OAuth_Wordpress_identity_path');\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (settings.get('Accounts_OAuth_Wordpress_identity_token_sent_via')) {\\n\\t\\t\\t\\tconfig.identityTokenSentVia = settings.get('Accounts_OAuth_Wordpress_identity_token_sent_via');\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (settings.get('Accounts_OAuth_Wordpress_token_path')) {\\n\\t\\t\\t\\tconfig.tokenPath = settings.get('Accounts_OAuth_Wordpress_token_path');\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (settings.get('Accounts_OAuth_Wordpress_authorize_path')) {\\n\\t\\t\\t\\tconfig.authorizePath = settings.get('Accounts_OAuth_Wordpress_authorize_path');\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (settings.get('Accounts_OAuth_Wordpress_scope')) {\\n\\t\\t\\t\\tconfig.scope = settings.get('Accounts_OAuth_Wordpress_scope');\\n\\t\\t\\t}\\n\\t\\t\\tbreak;\\n\\t\\tcase 'wordpress-com':\\n\\t\\t\\tconfig.identityPath = 'https://public-api.wordpress.com/rest/v1/me';\\n\\t\\t\\tconfig.identityTokenSentVia = 'header';\\n\\t\\t\\tconfig.authorizePath = 'https://public-api.wordpress.com/oauth2/authorize';\\n\\t\\t\\tconfig.tokenPath = 'https://public-api.wordpress.com/oauth2/token';\\n\\t\\t\\tconfig.scope = 'auth';\\n\\t\\t\\tbreak;\\n\\t\\tdefault:\\n\\t\\t\\tconfig.identityPath = '/oauth/me';\\n\\t\\t\\tbreak;\\n\\t}\\n\\n\\tconst result = WordPress.configure(config);\\n\\treturn result;\\n}, 100);\\n\\nMeteor.startup(() => {\\n\\treturn Tracker.autorun(() => {\\n\\t\\treturn fillSettings();\\n\\t});\\n});\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"Meteor\",\"Tracker\",\"_\",\"CustomOAuth\",\"settings\",\"config\",\"serverURL\",\"identityPath\",\"addAutopublishFields\",\"forLoggedInUser\",\"forOtherUsers\",\"accessTokenParam\",\"WordPress\",\"fillSettings\",\"debounce\",\"serverType\",\"result\",\"async\",\"_context\",\"prev\",\"next\",\"get\",\"undefined\",\"abrupt\",\"identityTokenSentVia\",\"authorizePath\",\"tokenPath\",\"scope\",\"t0\",\"configure\",\"stop\",\"Promise\",\"startup\",\"autorun\"],\"mappings\":\"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\"}"}