{"code":"function module(n,r,t){var e,o,a,c,l,u,i,s,f,p;t.link(\"@babel/runtime/regenerator\",{default:function(n){e=n}},0),t.link(\"@babel/runtime/helpers/toConsumableArray\",{default:function(n){o=n}},1),t.link(\"meteor/meteor\",{Meteor:function(n){a=n}},0),t.link(\"../../app/utils/lib/i18n\",{t:function(n){c=n}},1),t.link(\"../lib/2fa/process2faReturn\",{process2faReturn:function(n){l=n},process2faAsyncReturn:function(n){u=n}},2),t.link(\"../lib/2fa/utils\",{isTotpInvalidError:function(n){i=n}},3),a.call=(s=a.call,f=function(n,r,t){return function(e,a){return s.apply(void 0,[n].concat(o(r),[{twoFactorCode:e,twoFactorMethod:a},function(n,r){if(i(n)){t(Error(\"password\"===a?c(\"Invalid_password\"):c(\"Invalid_two_factor_code\")));return}t(n,r)}]))}},function(n){for(var r=arguments.length,t=Array(r>1?r-1:0),a=1;a<r;a++)t[a-1]=arguments[a];var c=t.length>0&&\"function\"==typeof t[t.length-1]?t.pop():function(){};return s.apply(void 0,[n].concat(o(t),[function(r,o){return e.async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.awrap(l({error:r,result:o,onCode:f(n,t,c),originalCallback:c,emailOrUsername:void 0}));case 2:case\"end\":return a.stop()}},null,null,null,Promise)}]))}),a.callAsync=(p=a.callAsync,function(n){var r,t,o,c=arguments;return e.async(function(l){for(;;)switch(l.prev=l.next){case 0:for(t=Array((r=c.length)>1?r-1:0),o=1;o<r;o++)t[o-1]=c[o];return l.prev=1,l.next=4,e.awrap(p.apply(void 0,[n].concat(t)));case 4:return l.abrupt(\"return\",l.sent);case 7:return l.prev=7,l.t0=l.catch(1),l.abrupt(\"return\",u({error:l.t0,onCode:function(r,e){var o;return(o=a).callAsync.apply(o,[n].concat(t,[{twoFactorCode:r,twoFactorMethod:e}]))},emailOrUsername:void 0}));case 10:case\"end\":return l.stop()}},null,null,[[1,7]],Promise)})}","map":"{\"version\":3,\"sources\":[\"client/meteorOverrides/totpOnCall.ts\",\"<anon>\"],\"sourcesContent\":[\"import { Meteor } from 'meteor/meteor';\\n\\nimport { t } from '../../app/utils/lib/i18n';\\nimport type { LoginCallback } from '../lib/2fa/overrideLoginMethod';\\nimport { process2faReturn, process2faAsyncReturn } from '../lib/2fa/process2faReturn';\\nimport { isTotpInvalidError } from '../lib/2fa/utils';\\n\\nconst withSyncTOTP = (call: (name: string, ...args: any[]) => any) => {\\n\\tconst callWithTotp =\\n\\t\\t(methodName: string, args: unknown[], callback: LoginCallback) =>\\n\\t\\t(twoFactorCode: string, twoFactorMethod: string): unknown =>\\n\\t\\t\\tcall(\\n\\t\\t\\t\\tmethodName,\\n\\t\\t\\t\\t...args,\\n\\t\\t\\t\\t{ twoFactorCode, twoFactorMethod },\\n\\t\\t\\t\\t(error: globalThis.Error | Meteor.Error | Meteor.TypedError | undefined, result: unknown): void => {\\n\\t\\t\\t\\t\\tif (isTotpInvalidError(error)) {\\n\\t\\t\\t\\t\\t\\tcallback(new Error(twoFactorMethod === 'password' ? t('Invalid_password') : t('Invalid_two_factor_code')));\\n\\t\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\tcallback(error, result);\\n\\t\\t\\t\\t},\\n\\t\\t\\t);\\n\\n\\tconst callWithoutTotp = (methodName: string, args: unknown[], callback: LoginCallback) => (): unknown =>\\n\\t\\tcall(\\n\\t\\t\\tmethodName,\\n\\t\\t\\t...args,\\n\\t\\t\\tasync (error: globalThis.Error | Meteor.Error | Meteor.TypedError | undefined, result: unknown): Promise<void> => {\\n\\t\\t\\t\\tawait process2faReturn({\\n\\t\\t\\t\\t\\terror,\\n\\t\\t\\t\\t\\tresult,\\n\\t\\t\\t\\t\\tonCode: callWithTotp(methodName, args, callback),\\n\\t\\t\\t\\t\\toriginalCallback: callback,\\n\\t\\t\\t\\t\\temailOrUsername: undefined,\\n\\t\\t\\t\\t});\\n\\t\\t\\t},\\n\\t\\t);\\n\\n\\treturn function (methodName: string, ...args: unknown[]): unknown {\\n\\t\\tconst callback = args.length > 0 && typeof args[args.length - 1] === 'function' ? (args.pop() as LoginCallback) : (): void => undefined;\\n\\n\\t\\treturn callWithoutTotp(methodName, args, callback)();\\n\\t};\\n};\\n\\nconst withAsyncTOTP = (callAsync: (name: string, ...args: any[]) => Promise<any>) => {\\n\\treturn async function callAsyncWithTOTP(methodName: string, ...args: unknown[]): Promise<unknown> {\\n\\t\\ttry {\\n\\t\\t\\treturn await callAsync(methodName, ...args);\\n\\t\\t} catch (error: unknown) {\\n\\t\\t\\treturn process2faAsyncReturn({\\n\\t\\t\\t\\terror,\\n\\t\\t\\t\\tonCode: (twoFactorCode, twoFactorMethod) => Meteor.callAsync(methodName, ...args, { twoFactorCode, twoFactorMethod }),\\n\\t\\t\\t\\temailOrUsername: undefined,\\n\\t\\t\\t});\\n\\t\\t}\\n\\t};\\n};\\n\\nMeteor.call = withSyncTOTP(Meteor.call);\\nMeteor.callAsync = withAsyncTOTP(Meteor.callAsync);\\n\",null],\"names\":[\"_regeneratorRuntime\",\"_toConsumableArray\",\"Meteor\",\"t\",\"process2faReturn\",\"process2faAsyncReturn\",\"isTotpInvalidError\",\"call\",\"callWithTotp\",\"callAsync\",\"module\",\"link\",\"default\",\"v\",\"methodName\",\"args\",\"callback\",\"twoFactorCode\",\"twoFactorMethod\",\"apply\",\"concat\",\"error\",\"result\",\"Error\",\"_len\",\"arguments\",\"length\",\"Array\",\"_key\",\"pop\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"onCode\",\"originalCallback\",\"emailOrUsername\",\"undefined\",\"stop\",\"Promise\",\"_len2\",\"_key2\",\"_args2\",\"_context2\",\"abrupt\",\"sent\",\"t0\",\"_Meteor\"],\"mappings\":\"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\"}"}