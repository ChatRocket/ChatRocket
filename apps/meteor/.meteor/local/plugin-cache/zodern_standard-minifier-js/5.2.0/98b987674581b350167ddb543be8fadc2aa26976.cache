{"code":"function module(e,t,l){let n,i,o,a,r,u,c,d,s,v,m,p,D,f,E,k,b,h,g,x,C;l.link(\"@babel/runtime/helpers/extends\",{default(e){n=e}},0),l.link(\"@rocket.chat/fuselage\",{Modal(e){i=e},Field(e){o=e},FieldLabel(e){a=e},FieldRow(e){r=e},Select(e){u=e},Button(e){c=e},Box(e){d=e}},0),l.link(\"@rocket.chat/ui-contexts\",{useTranslation(e){s=e},useAvailableDevices(e){v=e},useToastMessageDispatch(e){m=e},useSetModal(e){p=e},useSelectedDevices(e){D=e},useIsDeviceManagementEnabled(e){f=e}},1),l.link(\"react\",{default(e){E=e},useState(e){k=e}},2),l.link(\"react-hook-form\",{useForm(e){b=e},Controller(e){h=e}},3),l.link(\"../../contexts/CallContext\",{useChangeAudioInputDevice(e){g=e},useChangeAudioOutputDevice(e){x=e}},4),l.link(\"../../providers/DeviceProvider/lib/isSetSinkIdAvailable\",{isSetSinkIdAvailable(e){C=e}},5),l.exportDefault(()=>{var e,t,l,S;let _=p(),I=f(),y=s(),A=m(),F=D(),{handleSubmit:w,control:M}=b({defaultValues:{inputDevice:(null==F?void 0:null===(e=F.audioInput)||void 0===e?void 0:e.id)||\"\",outputDevice:(null==F?void 0:null===(t=F.audioOutput)||void 0===t?void 0:t.id)||\"\"}}),[O]=k(()=>C()),T=v(),B=g(),N=x(),H=(null==T?void 0:null===(l=T.audioInput)||void 0===l?void 0:l.map(e=>[e.id,e.label]))||[],L=(null==T?void 0:null===(S=T.audioOutput)||void 0===S?void 0:S.map(e=>[e.id,e.label]))||[],P=async e=>{var t,l;let n=e.inputDevice&&(null==T?void 0:null===(t=T.audioInput)||void 0===t?void 0:t.find(t=>t.id===e.inputDevice)),i=e.outputDevice&&(null==T?void 0:null===(l=T.audioOutput)||void 0===l?void 0:l.find(t=>t.id===e.outputDevice));try{n&&B(n),i&&N(i),_(),A({type:\"success\",message:y(\"Devices_Set\")})}catch(e){A({type:\"error\",message:e})}};return E.createElement(i,{wrapperFunction:e=>E.createElement(d,n({is:\"form\",onSubmit:w(P)},e))},E.createElement(i.Header,null,E.createElement(i.Title,null,y(\"Device_settings\")),E.createElement(i.Close,{onClick:()=>_()})),E.createElement(i.Content,{fontScale:\"p2\"},!O&&E.createElement(d,{color:\"status-font-on-danger\",display:\"flex\",flexDirection:\"column\"},y(\"Device_Changes_Not_Available\"),E.createElement(d,{is:\"a\",href:\"https://rocket.chat/download\",target:\"_blank\",rel:\"noopener noreferrer\"},y(\"Download_Destkop_App\"))),!I&&E.createElement(d,{color:\"status-font-on-danger\",display:\"flex\",flexDirection:\"column\"},y(\"Device_Changes_Not_Available_Insecure_Context\")),E.createElement(o,null,E.createElement(a,null,y(\"Microphone\")),E.createElement(r,{w:\"full\",display:\"flex\",flexDirection:\"column\",alignItems:\"stretch\"},E.createElement(h,{name:\"inputDevice\",control:M,render:e=>{let{field:t}=e;return E.createElement(u,n({disabled:!O},t,{options:H||[]}))}}))),E.createElement(o,null,E.createElement(a,null,y(\"Speakers\")),E.createElement(r,{w:\"full\",display:\"flex\",flexDirection:\"column\",alignItems:\"stretch\"},E.createElement(h,{name:\"outputDevice\",control:M,render:e=>{let{field:t}=e;return E.createElement(u,n({disabled:!O},t,{options:L||[]}))}})))),E.createElement(i.Footer,null,E.createElement(i.FooterControllers,null,E.createElement(c,{onClick:()=>_()},y(\"Cancel\")),E.createElement(c,{disabled:!O,primary:!0,onClick:w(P)},y(\"Save\")))))})}","map":"{\"version\":3,\"sources\":[\"client/voip/modals/DeviceSettingsModal.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { SelectOption } from '@rocket.chat/fuselage';\\nimport { Modal, Field, FieldLabel, FieldRow, Select, Button, Box } from '@rocket.chat/fuselage';\\nimport {\\n\\tuseTranslation,\\n\\tuseAvailableDevices,\\n\\tuseToastMessageDispatch,\\n\\tuseSetModal,\\n\\tuseSelectedDevices,\\n\\tuseIsDeviceManagementEnabled,\\n} from '@rocket.chat/ui-contexts';\\nimport type { ReactElement } from 'react';\\nimport React, { useState } from 'react';\\nimport type { SubmitHandler } from 'react-hook-form';\\nimport { useForm, Controller } from 'react-hook-form';\\n\\nimport { useChangeAudioInputDevice, useChangeAudioOutputDevice } from '../../contexts/CallContext';\\nimport { isSetSinkIdAvailable } from '../../providers/DeviceProvider/lib/isSetSinkIdAvailable';\\n\\ntype FieldValues = {\\n\\tinputDevice: string;\\n\\toutputDevice: string;\\n};\\n\\nconst DeviceSettingsModal = (): ReactElement => {\\n\\tconst setModal = useSetModal();\\n\\tconst onCancel = (): void => setModal();\\n\\tconst isDeviceManagementEnabled = useIsDeviceManagementEnabled();\\n\\tconst t = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst selectedAudioDevices = useSelectedDevices();\\n\\n\\tconst { handleSubmit, control } = useForm<FieldValues>({\\n\\t\\tdefaultValues: {\\n\\t\\t\\tinputDevice: selectedAudioDevices?.audioInput?.id || '',\\n\\t\\t\\toutputDevice: selectedAudioDevices?.audioOutput?.id || '',\\n\\t\\t},\\n\\t});\\n\\tconst [setSinkIdAvailable] = useState(() => isSetSinkIdAvailable());\\n\\tconst availableDevices = useAvailableDevices();\\n\\tconst changeAudioInputDevice = useChangeAudioInputDevice();\\n\\tconst changeAudioOutputDevice = useChangeAudioOutputDevice();\\n\\n\\tconst availableInputDevices: SelectOption[] = availableDevices?.audioInput?.map((device) => [device.id, device.label]) || [];\\n\\tconst availableOutputDevices: SelectOption[] = availableDevices?.audioOutput?.map((device) => [device.id, device.label]) || [];\\n\\n\\tconst onSubmit: SubmitHandler<FieldValues> = async (data) => {\\n\\t\\tconst selectedInputDevice = data.inputDevice && availableDevices?.audioInput?.find((device) => device.id === data.inputDevice);\\n\\t\\tconst selectedOutputDevice = data.outputDevice && availableDevices?.audioOutput?.find((device) => device.id === data.outputDevice);\\n\\t\\ttry {\\n\\t\\t\\tselectedInputDevice && changeAudioInputDevice(selectedInputDevice);\\n\\t\\t\\tselectedOutputDevice && changeAudioOutputDevice(selectedOutputDevice);\\n\\t\\t\\tsetModal();\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Devices_Set') });\\n\\t\\t} catch (error) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t}\\n\\t};\\n\\n\\treturn (\\n\\t\\t<Modal wrapperFunction={(props) => <Box is='form' onSubmit={handleSubmit(onSubmit)} {...props} />}>\\n\\t\\t\\t<Modal.Header>\\n\\t\\t\\t\\t<Modal.Title>{t('Device_settings')}</Modal.Title>\\n\\t\\t\\t\\t<Modal.Close onClick={onCancel} />\\n\\t\\t\\t</Modal.Header>\\n\\t\\t\\t<Modal.Content fontScale='p2'>\\n\\t\\t\\t\\t{!setSinkIdAvailable && (\\n\\t\\t\\t\\t\\t<Box color='status-font-on-danger' display='flex' flexDirection='column'>\\n\\t\\t\\t\\t\\t\\t{t('Device_Changes_Not_Available')}\\n\\t\\t\\t\\t\\t\\t<Box is='a' href='https://rocket.chat/download' target='_blank' rel='noopener noreferrer'>\\n\\t\\t\\t\\t\\t\\t\\t{t('Download_Destkop_App')}\\n\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t)}\\n\\t\\t\\t\\t{!isDeviceManagementEnabled && (\\n\\t\\t\\t\\t\\t<Box color='status-font-on-danger' display='flex' flexDirection='column'>\\n\\t\\t\\t\\t\\t\\t{t('Device_Changes_Not_Available_Insecure_Context')}\\n\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t)}\\n\\t\\t\\t\\t<Field>\\n\\t\\t\\t\\t\\t<FieldLabel>{t('Microphone')}</FieldLabel>\\n\\t\\t\\t\\t\\t<FieldRow w='full' display='flex' flexDirection='column' alignItems='stretch'>\\n\\t\\t\\t\\t\\t\\t<Controller\\n\\t\\t\\t\\t\\t\\t\\tname='inputDevice'\\n\\t\\t\\t\\t\\t\\t\\tcontrol={control}\\n\\t\\t\\t\\t\\t\\t\\trender={({ field }): ReactElement => (\\n\\t\\t\\t\\t\\t\\t\\t\\t<Select disabled={!setSinkIdAvailable} {...field} options={availableInputDevices || []} />\\n\\t\\t\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t\\t</Field>\\n\\t\\t\\t\\t<Field>\\n\\t\\t\\t\\t\\t<FieldLabel>{t('Speakers')}</FieldLabel>\\n\\t\\t\\t\\t\\t<FieldRow w='full' display='flex' flexDirection='column' alignItems='stretch'>\\n\\t\\t\\t\\t\\t\\t<Controller\\n\\t\\t\\t\\t\\t\\t\\tname='outputDevice'\\n\\t\\t\\t\\t\\t\\t\\tcontrol={control}\\n\\t\\t\\t\\t\\t\\t\\trender={({ field }): ReactElement => (\\n\\t\\t\\t\\t\\t\\t\\t\\t<Select disabled={!setSinkIdAvailable} {...field} options={availableOutputDevices || []} />\\n\\t\\t\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t\\t</Field>\\n\\t\\t\\t</Modal.Content>\\n\\t\\t\\t<Modal.Footer>\\n\\t\\t\\t\\t<Modal.FooterControllers>\\n\\t\\t\\t\\t\\t<Button onClick={(): void => setModal()}>{t('Cancel')}</Button>\\n\\t\\t\\t\\t\\t<Button disabled={!setSinkIdAvailable} primary onClick={handleSubmit(onSubmit)}>\\n\\t\\t\\t\\t\\t\\t{t('Save')}\\n\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t</Modal.FooterControllers>\\n\\t\\t\\t</Modal.Footer>\\n\\t\\t</Modal>\\n\\t);\\n};\\n\\nexport default DeviceSettingsModal;\\n\",null],\"names\":[\"_extends\",\"Modal\",\"Field\",\"FieldLabel\",\"FieldRow\",\"Select\",\"Button\",\"Box\",\"useTranslation\",\"useAvailableDevices\",\"useToastMessageDispatch\",\"useSetModal\",\"useSelectedDevices\",\"useIsDeviceManagementEnabled\",\"React\",\"useState\",\"useForm\",\"Controller\",\"useChangeAudioInputDevice\",\"useChangeAudioOutputDevice\",\"isSetSinkIdAvailable\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"DeviceSettingsModal\",\"_selectedAudioDevices\",\"_selectedAudioDevices2\",\"_availableDevices$aud\",\"_availableDevices$aud2\",\"setModal\",\"isDeviceManagementEnabled\",\"t\",\"dispatchToastMessage\",\"selectedAudioDevices\",\"handleSubmit\",\"control\",\"defaultValues\",\"inputDevice\",\"audioInput\",\"id\",\"outputDevice\",\"audioOutput\",\"setSinkIdAvailable\",\"availableDevices\",\"changeAudioInputDevice\",\"changeAudioOutputDevice\",\"availableInputDevices\",\"map\",\"device\",\"label\",\"availableOutputDevices\",\"onSubmit\",\"data\",\"_availableDevices$aud3\",\"_availableDevices$aud4\",\"selectedInputDevice\",\"find\",\"selectedOutputDevice\",\"type\",\"message\",\"error\",\"createElement\",\"wrapperFunction\",\"props\",\"is\",\"Header\",\"Title\",\"Close\",\"onClick\",\"onCancel\",\"Content\",\"fontScale\",\"color\",\"display\",\"flexDirection\",\"href\",\"target\",\"rel\",\"w\",\"alignItems\",\"name\",\"render\",\"_ref\",\"field\",\"disabled\",\"options\",\"_ref2\",\"Footer\",\"FooterControllers\",\"primary\"],\"mappings\":\"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\"}"}