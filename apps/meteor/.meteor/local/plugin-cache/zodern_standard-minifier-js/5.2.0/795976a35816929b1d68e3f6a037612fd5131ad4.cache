{"code":"function module(e,t,r){let a,l,s,i,n,o,u,g;let c=[\"msg\"];r.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default(e){a=e}},0),r.export({useLegacyThreadMessageJump:()=>m}),r.link(\"@rocket.chat/ui-contexts\",{useRouter(e){l=e},useSearchParameter(e){s=e}},0),r.link(\"react\",{useRef(e){i=e},useEffect(e){n=e}},1),r.link(\"../../../../../lib/utils/waitForElement\",{waitForElement(e){o=e}},2),r.link(\"../../../MessageList/providers/messageHighlightSubscription\",{clearHighlightMessage(e){u=e},setHighlightMessage(e){g=e}},3);let m=e=>{let{enabled:t=!0}=e,r=l(),m=s(\"msg\"),h=()=>{let e=r.getRouteName();if(!e)return;let t=r.getSearchParameters(),{msg:l}=t,s=a(t,c);r.navigate({name:e,params:r.getRouteParameters(),search:s},{replace:!0})},b=i(null),d=i(h);return d.current=h,n(()=>{let e=b.current;if(!t||!m||!e)return;let r=new AbortController;return o(\"[data-id='\".concat(m,\"']\"),{parent:e,signal:r.signal}).then(e=>{var t;r.signal.aborted||(g(m),null===(t=d.current)||void 0===t||t.call(d),setTimeout(()=>{u()},1e3),setTimeout(()=>{r.signal.aborted||e.scrollIntoView({behavior:\"smooth\",block:\"nearest\"})},300))}),()=>{r.abort()}},[t,m]),{parentRef:b}}}","map":"{\"version\":3,\"sources\":[\"client/views/room/contextualBar/Threads/hooks/useLegacyThreadMessageJump.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useRouter, useSearchParameter } from '@rocket.chat/ui-contexts';\\nimport { useRef, useEffect } from 'react';\\n\\nimport { waitForElement } from '../../../../../lib/utils/waitForElement';\\nimport { clearHighlightMessage, setHighlightMessage } from '../../../MessageList/providers/messageHighlightSubscription';\\n\\nexport const useLegacyThreadMessageJump = ({ enabled = true }: { enabled?: boolean }) => {\\n\\tconst router = useRouter();\\n\\tconst mid = useSearchParameter('msg');\\n\\n\\tconst clearQueryStringParameter = () => {\\n\\t\\tconst name = router.getRouteName();\\n\\n\\t\\tif (!name) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tconst { msg: _, ...search } = router.getSearchParameters();\\n\\n\\t\\trouter.navigate(\\n\\t\\t\\t{\\n\\t\\t\\t\\tname,\\n\\t\\t\\t\\tparams: router.getRouteParameters(),\\n\\t\\t\\t\\tsearch,\\n\\t\\t\\t},\\n\\t\\t\\t{ replace: true },\\n\\t\\t);\\n\\t};\\n\\n\\tconst parentRef = useRef<HTMLElement>(null);\\n\\tconst clearQueryStringParameterRef = useRef(clearQueryStringParameter);\\n\\tclearQueryStringParameterRef.current = clearQueryStringParameter;\\n\\n\\tuseEffect(() => {\\n\\t\\tconst parent = parentRef.current;\\n\\n\\t\\tif (!enabled || !mid || !parent) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tconst abortController = new AbortController();\\n\\n\\t\\twaitForElement<HTMLElement>(`[data-id='${mid}']`, { parent, signal: abortController.signal }).then((messageElement) => {\\n\\t\\t\\tif (abortController.signal.aborted) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tsetHighlightMessage(mid);\\n\\t\\t\\tclearQueryStringParameterRef.current?.();\\n\\n\\t\\t\\tsetTimeout(() => {\\n\\t\\t\\t\\tclearHighlightMessage();\\n\\t\\t\\t}, 1000);\\n\\n\\t\\t\\tsetTimeout(() => {\\n\\t\\t\\t\\tif (abortController.signal.aborted) {\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tmessageElement.scrollIntoView({\\n\\t\\t\\t\\t\\tbehavior: 'smooth',\\n\\t\\t\\t\\t\\tblock: 'nearest',\\n\\t\\t\\t\\t});\\n\\t\\t\\t}, 300);\\n\\t\\t});\\n\\n\\t\\treturn () => {\\n\\t\\t\\tabortController.abort();\\n\\t\\t};\\n\\t}, [enabled, mid]);\\n\\n\\treturn { parentRef };\\n};\\n\",null],\"names\":[\"_objectWithoutProperties\",\"useRouter\",\"useSearchParameter\",\"useRef\",\"useEffect\",\"waitForElement\",\"clearHighlightMessage\",\"setHighlightMessage\",\"module\",\"link\",\"default\",\"v\",\"export\",\"useLegacyThreadMessageJump\",\"_ref\",\"enabled\",\"router\",\"mid\",\"clearQueryStringParameter\",\"name\",\"getRouteName\",\"_router$getSearchPara\",\"getSearchParameters\",\"msg\",\"_\",\"search\",\"_excluded\",\"navigate\",\"params\",\"getRouteParameters\",\"replace\",\"parentRef\",\"clearQueryStringParameterRef\",\"current\",\"parent\",\"abortController\",\"AbortController\",\"concat\",\"signal\",\"then\",\"messageElement\",\"_clearQueryStringPara\",\"aborted\",\"call\",\"setTimeout\",\"scrollIntoView\",\"behavior\",\"block\",\"abort\"],\"mappings\":\"2BAAAA,EAAyEC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,gBAArDC,EAAAC,IAAoB,CAAA,iDAAiC,CAAAC,QAAAC,CAAA,EAAAX,EAAAW,CAAA,CAAA,EAAA,GAAzEH,EAAOI,MAAE,CAAA,CAAAC,2BAA+BA,IAAMA,CAA0B,GAACL,EAAAC,IAAA,CAAA,2BAAA,CAAAR,UAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,mBAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAAN,OAAAQ,CAAA,EAAAR,EAAAQ,CAAA,EAAAP,UAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,0CAAA,CAAAJ,eAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,8DAAA,CAAAH,sBAAAK,CAAA,EAAAL,EAAAK,CAAA,EAAAJ,oBAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAMlE,IAAME,EAA6BC,IAA8C,GAA7C,CAAEC,QAAAA,EAAU,CAAA,CAAA,CAA6B,CAAAD,EAC7EE,EAASf,IACTgB,EAAMf,EAAmB,OAEzBgB,EAA4BA,KACjC,IAAMC,EAAOH,EAAOI,YAAY,GAEhC,GAAI,CAACD,EACJ,OAGD,IAAAE,EAA8BL,EAAOM,mBAAmB,GAAlD,CAAEC,IAAKC,CAAAA,CAAc,CAAAH,EAARI,EAAMzB,EAAAqB,EAAAK,GAEzBV,EAAOW,QAAQ,CACd,CACCR,KAAAA,EACAS,OAAQZ,EAAOa,kBAAkB,GACjCJ,OAAAA,GAED,CAAEK,QAAS,CAAA,CAAI,EAEjB,EAEMC,EAAY5B,EAAoB,MAChC6B,EAA+B7B,EAAOe,GAyC5C,OAxCAc,EAA6BC,OAAO,CAAGf,EAEvCd,EAAU,KACT,IAAM8B,EAASH,EAAUE,OAAO,CAEhC,GAAI,CAAClB,GAAW,CAACE,GAAO,CAACiB,EACxB,OAGD,IAAMC,EAAkB,IAAIC,gBA0B5B,OAxBA/B,EAAc,aAAAgC,MAAA,CAA2BpB,EAAG,MAAM,CAAEiB,OAAAA,EAAQI,OAAQH,EAAgBG,MAAAA,AAAM,GAAIC,IAAI,CAAEC,IAAkB,IAAAC,CACjHN,CAAAA,EAAgBG,MAAM,CAACI,OAAO,GAIlCnC,EAAoBU,GACpB,AAAoC,OAApCwB,CAAAA,EAAAT,EAA6BC,OAAO,AAAPA,GAAOQ,AAAA,KAAA,IAAAA,GAApCA,EAAAE,IAAA,CAAAX,GAEAY,WAAW,KACVtC,GACD,EAAG,KAEHsC,WAAW,KACNT,EAAgBG,MAAM,CAACI,OAAO,EAIlCF,EAAeK,cAAc,CAAC,CAC7BC,SAAU,SACVC,MAAO,WAET,EAAG,KACJ,GAEO,KACNZ,EAAgBa,KAAK,EACtB,CACD,EAAG,CAACjC,EAASE,EAAI,EAEV,CAAEc,UAAAA,CAAS,CACnB\"}"}