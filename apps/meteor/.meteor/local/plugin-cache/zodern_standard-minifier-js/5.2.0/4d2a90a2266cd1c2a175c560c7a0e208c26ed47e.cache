{"code":"function module(e,t,i){let n,o,a,r,s,l,c,d,m;i.link(\"meteor/meteor\",{Meteor(e){n=e}},0),i.link(\"../../../client/lib/rooms/roomCoordinator\",{roomCoordinator(e){o=e}},1),i.link(\"../../../client/lib/toast\",{dispatchToastMessage(e){a=e}},2),i.link(\"../../../client/lib/utils/messageArgs\",{messageArgs(e){r=e}},3),i.link(\"../../../client/providers/RouterProvider\",{router(e){s=e}},4),i.link(\"../../models/client\",{ChatSubscription(e){l=e}},5),i.link(\"../../ui-utils/client\",{LegacyRoomManager(e){c=e},MessageAction(e){d=e}},6),i.link(\"../../utils/client/lib/SDKClient\",{sdk(e){m=e}},7),n.startup(()=>{d.addButton({id:\"mark-message-as-unread\",icon:\"flag\",label:\"Mark_unread\",context:[\"message\",\"message-mobile\",\"threads\"],type:\"interaction\",async action(e,t){let{message:i=r(this).msg}=t;try{let e=l.findOne({rid:i.rid});if(null==e)return;s.navigate(\"/home\"),await c.close(e.t+e.name),await m.call(\"unreadMessages\",i)}catch(e){a({type:\"error\",message:e})}},condition(e){let{message:t,user:i,room:n}=e,a=o.isLivechatRoom(n.t);return!a&&!!i&&t.u._id!==i._id},order:4,group:\"menu\"})})}","map":"{\"version\":3,\"sources\":[\"app/message-mark-as-unread/client/actionButton.ts\",\"<anon>\"],\"sourcesContent\":[\"import { Meteor } from 'meteor/meteor';\\n\\nimport { roomCoordinator } from '../../../client/lib/rooms/roomCoordinator';\\nimport { dispatchToastMessage } from '../../../client/lib/toast';\\nimport { messageArgs } from '../../../client/lib/utils/messageArgs';\\nimport { router } from '../../../client/providers/RouterProvider';\\nimport { ChatSubscription } from '../../models/client';\\nimport { LegacyRoomManager, MessageAction } from '../../ui-utils/client';\\nimport { sdk } from '../../utils/client/lib/SDKClient';\\n\\nMeteor.startup(() => {\\n\\tMessageAction.addButton({\\n\\t\\tid: 'mark-message-as-unread',\\n\\t\\ticon: 'flag',\\n\\t\\tlabel: 'Mark_unread',\\n\\t\\tcontext: ['message', 'message-mobile', 'threads'],\\n\\t\\ttype: 'interaction',\\n\\t\\tasync action(_, props) {\\n\\t\\t\\tconst { message = messageArgs(this).msg } = props;\\n\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tconst subscription = ChatSubscription.findOne({\\n\\t\\t\\t\\t\\trid: message.rid,\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\t\\tif (subscription == null) {\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\trouter.navigate('/home');\\n\\t\\t\\t\\tawait LegacyRoomManager.close(subscription.t + subscription.name);\\n\\t\\t\\t\\tawait sdk.call('unreadMessages', message);\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\tcondition({ message, user, room }) {\\n\\t\\t\\tconst isLivechatRoom = roomCoordinator.isLivechatRoom(room.t);\\n\\t\\t\\tif (isLivechatRoom) {\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (!user) {\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn message.u._id !== user._id;\\n\\t\\t},\\n\\t\\torder: 4,\\n\\t\\tgroup: 'menu',\\n\\t});\\n});\\n\",null],\"names\":[\"Meteor\",\"roomCoordinator\",\"dispatchToastMessage\",\"messageArgs\",\"router\",\"ChatSubscription\",\"LegacyRoomManager\",\"MessageAction\",\"sdk\",\"module\",\"link\",\"v\",\"startup\",\"addButton\",\"id\",\"icon\",\"label\",\"context\",\"type\",\"action\",\"_\",\"props\",\"message\",\"msg\",\"subscription\",\"findOne\",\"rid\",\"navigate\",\"close\",\"t\",\"name\",\"call\",\"error\",\"condition\",\"_ref\",\"user\",\"room\",\"isLivechatRoom\",\"u\",\"_id\",\"order\",\"group\"],\"mappings\":\"2BAAAA,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAV,OAAAW,CAAA,EAAAX,EAAAW,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,4CAAA,CAAAT,gBAAAU,CAAA,EAAAV,EAAAU,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,4BAAA,CAAAR,qBAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,wCAAA,CAAAP,YAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,2CAAA,CAAAN,OAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,sBAAA,CAAAL,iBAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,wBAAA,CAAAJ,kBAAAK,CAAA,EAAAL,EAAAK,CAAA,EAAAJ,cAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,mCAAA,CAAAF,IAAAG,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,GAUvCX,EAAOY,OAAO,CAAC,KACdL,EAAcM,SAAS,CAAC,CACvBC,GAAI,yBACJC,KAAM,OACNC,MAAO,cACPC,QAAS,CAAC,UAAW,iBAAkB,UAAU,CACjDC,KAAM,cACN,MAAMC,OAAOC,CAAC,CAAEC,CAAK,EACpB,GAAM,CAAEC,QAAAA,EAAUnB,EAAY,IAAI,EAAEoB,GAAAA,CAAK,CAAGF,EAE5C,GAAI,CACH,IAAMG,EAAenB,EAAiBoB,OAAO,CAAC,CAC7CC,IAAKJ,EAAQI,GAAAA,GAGd,GAAIF,AAAgB,MAAhBA,EACH,OAEDpB,EAAOuB,QAAQ,CAAC,SAChB,MAAMrB,EAAkBsB,KAAK,CAACJ,EAAaK,CAAC,CAAGL,EAAaM,IAAI,EAChE,MAAMtB,EAAIuB,IAAI,CAAC,iBAAkBT,EAClC,CAAE,MAAOU,EAAO,CACf9B,EAAqB,CAAEgB,KAAM,QAASI,QAASU,CAAK,EACrD,CACD,EACAC,UAASC,CAAA,EAAwB,GAAvB,CAAEZ,QAAAA,CAAO,CAAEa,KAAAA,CAAI,CAAEC,KAAAA,CAAAA,CAAM,CAAAF,EAC1BG,EAAiBpC,EAAgBoC,cAAc,CAACD,EAAKP,CAAC,QAC5D,CAAIQ,IAIA,CAACF,GAIEb,EAAQgB,CAAC,CAACC,GAAG,GAAKJ,EAAKI,GAAG,AAClC,EACAC,MAAO,EACPC,MAAO,QAET\"}"}