{"code":"function module(e,l,t){let r,n,i,a,o,u,s,c,f,d,m,p;t.link(\"@rocket.chat/fuselage\",{AudioPlayer(e){r=e},Box(e){n=e},Icon(e){i=e}},0),t.link(\"react\",{default(e){a=e},useEffect(e){o=e},useState(e){u=e},memo(e){s=e}},1),t.link(\"react-i18next\",{useTranslation(e){c=e}},2),t.link(\"../../../../lib/utils/userAgentMIMETypeFallback\",{userAgentMIMETypeFallback(e){f=e}},3),t.link(\"./FilePreview\",{FilePreviewType(e){d=e}},4),t.link(\"./ImagePreview\",{default(e){m=e}},5),t.link(\"./PreviewSkeleton\",{default(e){p=e}},6);let v=(e,l)=>{let t=new FileReader;return t.onload=e=>{var t;return l((null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.result)||null)},t.readAsDataURL(e)},E=e=>{let[l,t]=u(!1),[r,n]=u(null);return o(()=>{t(!1),v(e,e=>{n(e),t(!0)})},[e]),[l,r]};t.exportDefault(s(e=>{let{file:l,fileType:t}=e,[o,u]=E(l),{t:s}=c();if(!o)return a.createElement(p,null);if(\"string\"!=typeof u)return a.createElement(n,{display:\"flex\",alignItems:\"center\",w:\"full\"},a.createElement(i,{name:\"image\",size:\"x24\",mie:4}),s(\"FileUpload_Cannot_preview_file\"));if(t===d.IMAGE)return a.createElement(m,{url:u,file:l});if(t===d.VIDEO)return a.createElement(n,{is:\"video\",w:\"full\",controls:!0},a.createElement(\"source\",{src:u,type:f(l.type)}),s(\"Browser_does_not_support_video_element\"));if(t===d.AUDIO)return a.createElement(r,{src:u});throw Error(\"Wrong props provided for MediaPreview\")}))}","map":"{\"version\":3,\"sources\":[\"client/views/room/modals/FileUploadModal/MediaPreview.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { AudioPlayer, Box, Icon } from '@rocket.chat/fuselage';\\nimport type { ReactElement } from 'react';\\nimport React, { useEffect, useState, memo } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { userAgentMIMETypeFallback } from '../../../../lib/utils/userAgentMIMETypeFallback';\\nimport { FilePreviewType } from './FilePreview';\\nimport ImagePreview from './ImagePreview';\\nimport PreviewSkeleton from './PreviewSkeleton';\\n\\ntype ReaderOnloadCallback = (url: FileReader['result']) => void;\\n\\nconst readFileAsDataURL = (file: File, callback: ReaderOnloadCallback): void => {\\n\\tconst reader = new FileReader();\\n\\treader.onload = (e): void => callback(e?.target?.result || null);\\n\\n\\treturn reader.readAsDataURL(file);\\n};\\n\\nconst useFileAsDataURL = (file: File): [loaded: boolean, url: null | FileReader['result']] => {\\n\\tconst [loaded, setLoaded] = useState(false);\\n\\tconst [url, setUrl] = useState<FileReader['result']>(null);\\n\\n\\tuseEffect(() => {\\n\\t\\tsetLoaded(false);\\n\\t\\treadFileAsDataURL(file, (url) => {\\n\\t\\t\\tsetUrl(url);\\n\\t\\t\\tsetLoaded(true);\\n\\t\\t});\\n\\t}, [file]);\\n\\treturn [loaded, url];\\n};\\n\\ntype MediaPreviewProps = {\\n\\tfile: File;\\n\\tfileType: FilePreviewType;\\n};\\n\\nconst MediaPreview = ({ file, fileType }: MediaPreviewProps): ReactElement => {\\n\\tconst [loaded, url] = useFileAsDataURL(file);\\n\\tconst { t } = useTranslation();\\n\\n\\tif (!loaded) {\\n\\t\\treturn <PreviewSkeleton />;\\n\\t}\\n\\n\\tif (typeof url !== 'string') {\\n\\t\\treturn (\\n\\t\\t\\t<Box display='flex' alignItems='center' w='full'>\\n\\t\\t\\t\\t<Icon name='image' size='x24' mie={4} />\\n\\t\\t\\t\\t{t('FileUpload_Cannot_preview_file')}\\n\\t\\t\\t</Box>\\n\\t\\t);\\n\\t}\\n\\n\\tif (fileType === FilePreviewType.IMAGE) {\\n\\t\\treturn <ImagePreview url={url} file={file} />;\\n\\t}\\n\\n\\tif (fileType === FilePreviewType.VIDEO) {\\n\\t\\treturn (\\n\\t\\t\\t<Box is='video' w='full' controls>\\n\\t\\t\\t\\t<source src={url} type={userAgentMIMETypeFallback(file.type)} />\\n\\t\\t\\t\\t{t('Browser_does_not_support_video_element')}\\n\\t\\t\\t</Box>\\n\\t\\t);\\n\\t}\\n\\n\\tif (fileType === FilePreviewType.AUDIO) {\\n\\t\\treturn <AudioPlayer src={url} />;\\n\\t}\\n\\n\\tthrow new Error('Wrong props provided for MediaPreview');\\n};\\n\\nexport default memo(MediaPreview);\\n\",null],\"names\":[\"AudioPlayer\",\"Box\",\"Icon\",\"React\",\"useEffect\",\"useState\",\"memo\",\"useTranslation\",\"userAgentMIMETypeFallback\",\"FilePreviewType\",\"ImagePreview\",\"PreviewSkeleton\",\"module\",\"link\",\"v\",\"default\",\"readFileAsDataURL\",\"file\",\"callback\",\"reader\",\"FileReader\",\"onload\",\"e\",\"_e$target\",\"target\",\"result\",\"readAsDataURL\",\"useFileAsDataURL\",\"loaded\",\"setLoaded\",\"url\",\"setUrl\",\"exportDefault\",\"_ref\",\"fileType\",\"t\",\"createElement\",\"display\",\"alignItems\",\"w\",\"name\",\"size\",\"mie\",\"IMAGE\",\"VIDEO\",\"is\",\"controls\",\"src\",\"type\",\"AUDIO\",\"Error\"],\"mappings\":\"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\"}"}