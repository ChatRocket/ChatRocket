{"code":"function module(e,t,i){let r,s,a,l,n,o,d,c,g;i.link(\"@babel/runtime/helpers/objectSpread2\",{default(e){r=e}},0),i.link(\"meteor/meteor\",{Meteor(e){s=e}},0),i.link(\"../../../app/settings/client\",{settings(e){a=e}},1),i.link(\"../../../app/ui-utils/client\",{MessageAction(e){l=e}},2),i.link(\"../../../app/utils/client/lib/SDKClient\",{sdk(e){n=e}},3),i.link(\"../../lib/queryClient\",{queryClient(e){o=e}},4),i.link(\"../../lib/rooms/roomCoordinator\",{roomCoordinator(e){d=e}},5),i.link(\"../../lib/toast\",{dispatchToastMessage(e){c=e}},6),i.link(\"../../lib/utils/messageArgs\",{messageArgs(e){g=e}},7),s.startup(()=>{l.addButton({id:\"star-message\",icon:\"star\",label:\"Star\",type:\"interaction\",context:[\"starred\",\"message\",\"message-mobile\",\"threads\",\"federated\",\"videoconf\",\"videoconf-threads\"],async action(e,t){let{message:i=g(this).msg}=t;try{await n.call(\"starMessage\",r(r({},i),{},{starred:!0})),o.invalidateQueries([\"rooms\",i.rid,\"starred-messages\"])}catch(e){e&&c({type:\"error\",message:e})}},condition(e){let{message:t,subscription:i,user:r,room:s}=e;if(null==i&&a.get(\"Message_AllowStarring\"))return!1;let l=d.isLivechatRoom(s.t);return!l&&(!Array.isArray(t.starred)||!t.starred.find(e=>e._id===(null==r?void 0:r._id)))},order:3,group:\"menu\"})})}","map":"{\"version\":3,\"sources\":[\"client/startup/actionButtons/starMessage.ts\",\"<anon>\"],\"sourcesContent\":[\"import { Meteor } from 'meteor/meteor';\\n\\nimport { settings } from '../../../app/settings/client';\\nimport { MessageAction } from '../../../app/ui-utils/client';\\nimport { sdk } from '../../../app/utils/client/lib/SDKClient';\\nimport { queryClient } from '../../lib/queryClient';\\nimport { roomCoordinator } from '../../lib/rooms/roomCoordinator';\\nimport { dispatchToastMessage } from '../../lib/toast';\\nimport { messageArgs } from '../../lib/utils/messageArgs';\\n\\nMeteor.startup(() => {\\n\\tMessageAction.addButton({\\n\\t\\tid: 'star-message',\\n\\t\\ticon: 'star',\\n\\t\\tlabel: 'Star',\\n\\t\\ttype: 'interaction',\\n\\t\\tcontext: ['starred', 'message', 'message-mobile', 'threads', 'federated', 'videoconf', 'videoconf-threads'],\\n\\t\\tasync action(_, props) {\\n\\t\\t\\tconst { message = messageArgs(this).msg } = props;\\n\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tawait sdk.call('starMessage', { ...message, starred: true });\\n\\t\\t\\t\\tqueryClient.invalidateQueries(['rooms', message.rid, 'starred-messages']);\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tif (error) {\\n\\t\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\tcondition({ message, subscription, user, room }) {\\n\\t\\t\\tif (subscription == null && settings.get('Message_AllowStarring')) {\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t}\\n\\t\\t\\tconst isLivechatRoom = roomCoordinator.isLivechatRoom(room.t);\\n\\t\\t\\tif (isLivechatRoom) {\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn !Array.isArray(message.starred) || !message.starred.find((star: any) => star._id === user?._id);\\n\\t\\t},\\n\\t\\torder: 3,\\n\\t\\tgroup: 'menu',\\n\\t});\\n});\\n\",null],\"names\":[\"_objectSpread\",\"Meteor\",\"settings\",\"MessageAction\",\"sdk\",\"queryClient\",\"roomCoordinator\",\"dispatchToastMessage\",\"messageArgs\",\"module\",\"link\",\"default\",\"v\",\"startup\",\"addButton\",\"id\",\"icon\",\"label\",\"type\",\"context\",\"action\",\"_\",\"props\",\"message\",\"msg\",\"call\",\"starred\",\"invalidateQueries\",\"rid\",\"error\",\"condition\",\"_ref\",\"subscription\",\"user\",\"room\",\"get\",\"isLivechatRoom\",\"t\",\"Array\",\"isArray\",\"find\",\"star\",\"_id\",\"order\",\"group\"],\"mappings\":\"2BAAAA,EAAAC,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAtBC,EAAMC,IAAA,CAAA,uCAAgB,CAAAC,QAAAC,CAAA,EAAAZ,EAAAY,CAAA,CAAA,EAAA,GAA9BH,EAAQC,IAAA,CAAM,gBAAgB,CAAAT,OAAAW,CAAA,EAAAX,EAAAW,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,+BAAA,CAAAR,SAAAU,CAAA,EAAAV,EAAAU,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,+BAAA,CAAAP,cAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,0CAAA,CAAAN,IAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,wBAAA,CAAAL,YAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,kCAAA,CAAAJ,gBAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,kBAAA,CAAAH,qBAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,8BAAA,CAAAF,YAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAUvCX,EAAOY,OAAO,CAAC,KACdV,EAAcW,SAAS,CAAC,CACvBC,GAAI,eACJC,KAAM,OACNC,MAAO,OACPC,KAAM,cACNC,QAAS,CAAC,UAAW,UAAW,iBAAkB,UAAW,YAAa,YAAa,oBAAoB,CAC3G,MAAMC,OAAOC,CAAC,CAAEC,CAAK,EACpB,GAAM,CAAEC,QAAAA,EAAUf,EAAY,IAAI,EAAEgB,GAAAA,CAAK,CAAGF,EAE5C,GAAI,CACH,MAAMlB,EAAIqB,IAAI,CAAC,cAAazB,EAAAA,EAAA,CAAA,EAAOuB,GAAO,CAAA,EAAA,CAAEG,QAAS,CAAA,CAAI,IACzDrB,EAAYsB,iBAAiB,CAAC,CAAC,QAASJ,EAAQK,GAAG,CAAE,mBAAmB,CACzE,CAAE,MAAOC,EAAO,CACXA,GACHtB,EAAqB,CAAEW,KAAM,QAASK,QAASM,CAAK,EAEtD,CACD,EACAC,UAASC,CAAA,EAAsC,GAArC,CAAER,QAAAA,CAAO,CAAES,aAAAA,CAAY,CAAEC,KAAAA,CAAI,CAAEC,KAAAA,CAAAA,CAAM,CAAAH,EAC9C,GAAIC,AAAgB,MAAhBA,GAAwB9B,EAASiC,GAAG,CAAC,yBACxC,MAAO,CAAA,EAER,IAAMC,EAAiB9B,EAAgB8B,cAAc,CAACF,EAAKG,CAAC,QAC5D,CAAID,GAIG,CAAA,CAACE,MAAMC,OAAO,CAAChB,EAAQG,OAAO,GAAK,CAACH,EAAQG,OAAO,CAACc,IAAI,CAAEC,GAAcA,EAAKC,GAAG,GAAKT,CAAAA,MAAAA,EAAI,KAAA,EAAJA,EAAMS,GAAG,AAAHA,EAAG,CACtG,EACAC,MAAO,EACPC,MAAO,QAET\"}"}