{"code":"function module(e,t,l){let n,a,i,u,c,r,o,d,s,m,v,k,f;l.link(\"@rocket.chat/ui-client\",{FeaturePreview(e){n=e},FeaturePreviewOff(e){a=e},FeaturePreviewOn(e){i=e}},0),l.link(\"@rocket.chat/ui-contexts\",{useLayout(e){u=e},useUser(e){c=e},useSetting(e){r=e}},1),l.link(\"react\",{default(e){o=e},lazy(e){d=e},useCallback(e){s=e}},2),l.link(\"../../../../app/models/client\",{Roles(e){m=e}},3),l.link(\"../../../hooks/useReactiveValue\",{useReactiveValue(e){v=e}},4),l.link(\"./LayoutWithSidebar\",{default(e){k=e}},5),l.link(\"./LayoutWithSidebarV2\",{default(e){f=e}},6);let E=d(()=>l.dynamicImport(\"../../account/security/AccountSecurityPage\"));l.exportDefault(e=>{let{children:t}=e,{isEmbedded:l}=u(),d=c(),b=r(\"Accounts_TwoFactorAuthentication_Enabled\"),y=v(s(()=>{var e,t,l,n,a;if(!d||null!=d&&null!==(e=d.services)&&void 0!==e&&null!==(t=e.totp)&&void 0!==t&&t.enabled||null!=d&&null!==(l=d.services)&&void 0!==l&&null!==(n=l.email2fa)&&void 0!==n&&n.enabled)return!1;let i=m.findOne({_id:{$in:null!==(a=d.roles)&&void 0!==a?a:[]},mandatory2fa:!0});return void 0!==i&&b},[b,d]));return y?o.createElement(\"main\",{id:\"rocket-chat\",className:l?\"embedded-view\":void 0},o.createElement(\"div\",{className:\"rc-old main-content content-background-color\"},o.createElement(E,null))):o.createElement(n,{feature:\"newNavigation\"},o.createElement(a,null,o.createElement(k,null,t)),o.createElement(i,null,o.createElement(f,null,t)))})}","map":"{\"version\":3,\"sources\":[\"client/views/root/MainLayout/TwoFactorAuthSetupCheck.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { FeaturePreview, FeaturePreviewOff, FeaturePreviewOn } from '@rocket.chat/ui-client';\\nimport { useLayout, useUser, useSetting } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement, ReactNode } from 'react';\\nimport React, { lazy, useCallback } from 'react';\\n\\nimport { Roles } from '../../../../app/models/client';\\nimport { useReactiveValue } from '../../../hooks/useReactiveValue';\\nimport LayoutWithSidebar from './LayoutWithSidebar';\\nimport LayoutWithSidebarV2 from './LayoutWithSidebarV2';\\n\\nconst AccountSecurityPage = lazy(() => import('../../account/security/AccountSecurityPage'));\\n\\nconst TwoFactorAuthSetupCheck = ({ children }: { children: ReactNode }): ReactElement => {\\n\\tconst { isEmbedded: embeddedLayout } = useLayout();\\n\\tconst user = useUser();\\n\\tconst tfaEnabled = useSetting('Accounts_TwoFactorAuthentication_Enabled');\\n\\tconst require2faSetup = useReactiveValue(\\n\\t\\tuseCallback(() => {\\n\\t\\t\\t// User is already using 2fa\\n\\t\\t\\tif (!user || user?.services?.totp?.enabled || user?.services?.email2fa?.enabled) {\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t}\\n\\n\\t\\t\\tconst mandatoryRole = Roles.findOne({ _id: { $in: user.roles ?? [] }, mandatory2fa: true });\\n\\t\\t\\treturn mandatoryRole !== undefined && tfaEnabled;\\n\\t\\t}, [tfaEnabled, user]),\\n\\t);\\n\\n\\tif (require2faSetup) {\\n\\t\\treturn (\\n\\t\\t\\t<main id='rocket-chat' className={embeddedLayout ? 'embedded-view' : undefined}>\\n\\t\\t\\t\\t<div className='rc-old main-content content-background-color'>\\n\\t\\t\\t\\t\\t<AccountSecurityPage />\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</main>\\n\\t\\t);\\n\\t}\\n\\n\\treturn (\\n\\t\\t<FeaturePreview feature='newNavigation'>\\n\\t\\t\\t<FeaturePreviewOff>\\n\\t\\t\\t\\t<LayoutWithSidebar>{children}</LayoutWithSidebar>\\n\\t\\t\\t</FeaturePreviewOff>\\n\\t\\t\\t<FeaturePreviewOn>\\n\\t\\t\\t\\t<LayoutWithSidebarV2>{children}</LayoutWithSidebarV2>\\n\\t\\t\\t</FeaturePreviewOn>\\n\\t\\t</FeaturePreview>\\n\\t);\\n};\\n\\nexport default TwoFactorAuthSetupCheck;\\n\",null],\"names\":[\"FeaturePreview\",\"FeaturePreviewOff\",\"FeaturePreviewOn\",\"useLayout\",\"useUser\",\"useSetting\",\"React\",\"lazy\",\"useCallback\",\"Roles\",\"useReactiveValue\",\"LayoutWithSidebar\",\"LayoutWithSidebarV2\",\"module\",\"link\",\"v\",\"default\",\"AccountSecurityPage\",\"dynamicImport\",\"exportDefault\",\"_ref\",\"children\",\"isEmbedded\",\"embeddedLayout\",\"user\",\"tfaEnabled\",\"require2faSetup\",\"_user$services\",\"_user$services$totp\",\"_user$services2\",\"_user$services2$email\",\"_user$roles\",\"services\",\"totp\",\"enabled\",\"email2fa\",\"mandatoryRole\",\"findOne\",\"_id\",\"$in\",\"roles\",\"mandatory2fa\",\"undefined\",\"createElement\",\"id\",\"className\",\"feature\"],\"mappings\":\"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\"}"}