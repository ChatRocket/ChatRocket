{"code":"function module(e,o,n){n.export({useChangeLeaderAction:function(){return m}}),n.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback:function(e){r=e}},0),n.link(\"@rocket.chat/ui-contexts\",{useTranslation:function(e){s=e},usePermission:function(e){t=e},useUserRoom:function(e){i=e},useUserSubscription:function(e){u=e}},1),n.link(\"react\",{useMemo:function(e){a=e}},2),n.link(\"../../../../../hooks/useEndpointAction\",{useEndpointAction:function(e){c=e}},3),n.link(\"../../../lib/getRoomDirectives\",{getRoomDirectives:function(e){l=e}},4),n.link(\"../../useUserHasRoomRole\",{useUserHasRoomRole:function(e){d=e}},5);var r,s,t,i,u,a,c,l,d,m=function(e,o){var n=s(),m=i(o),_=e._id,f=t(\"set-leader\",o),v=u(o);if(!m)throw Error(\"Room not provided\");var k=l({room:m,showingUserId:_,userSubscription:v}).roomCanSetLeader,p=d(_,o,\"leader\"),h=\"p\"===m.t?\"/v1/groups\":\"/v1/channels\",R=c(\"POST\",h+\".\"+(p?\"removeLeader\":\"addLeader\"),{successMessage:n(p?\"removed__username__as__role_\":\"set__username__as__role_\",{username:e.username,role:\"leader\"})}),g=r(function(){return R({roomId:o,userId:_})});return a(function(){return k&&f?{content:n(p?\"Remove_as_leader\":\"Set_as_leader\"),icon:\"shield-alt\",onClick:g,type:\"privileges\"}:void 0},[p,k,n,f,g])}}","map":"{\"version\":3,\"sources\":[\"client/views/room/hooks/useUserInfoActions/actions/useChangeLeaderAction.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom, IUser } from '@rocket.chat/core-typings';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useTranslation, usePermission, useUserRoom, useUserSubscription } from '@rocket.chat/ui-contexts';\\nimport { useMemo } from 'react';\\n\\nimport { useEndpointAction } from '../../../../../hooks/useEndpointAction';\\nimport { getRoomDirectives } from '../../../lib/getRoomDirectives';\\nimport { useUserHasRoomRole } from '../../useUserHasRoomRole';\\nimport type { UserInfoAction, UserInfoActionType } from '../useUserInfoActions';\\n\\nexport const useChangeLeaderAction = (user: Pick<IUser, '_id' | 'username'>, rid: IRoom['_id']): UserInfoAction | undefined => {\\n\\tconst t = useTranslation();\\n\\tconst room = useUserRoom(rid);\\n\\tconst { _id: uid } = user;\\n\\tconst userCanSetLeader = usePermission('set-leader', rid);\\n\\tconst userSubscription = useUserSubscription(rid);\\n\\n\\tif (!room) {\\n\\t\\tthrow Error('Room not provided');\\n\\t}\\n\\n\\tconst { roomCanSetLeader } = getRoomDirectives({ room, showingUserId: uid, userSubscription });\\n\\tconst isLeader = useUserHasRoomRole(uid, rid, 'leader');\\n\\n\\tconst endpointPrefix = room.t === 'p' ? '/v1/groups' : '/v1/channels';\\n\\tconst changeLeaderEndpoint = isLeader ? 'removeLeader' : 'addLeader';\\n\\tconst changeLeaderMessage = isLeader ? 'removed__username__as__role_' : 'set__username__as__role_';\\n\\tconst changeLeader = useEndpointAction('POST', `${endpointPrefix}.${changeLeaderEndpoint}`, {\\n\\t\\tsuccessMessage: t(changeLeaderMessage, { username: user.username, role: 'leader' }),\\n\\t});\\n\\tconst changeLeaderAction = useMutableCallback(() => changeLeader({ roomId: rid, userId: uid }));\\n\\tconst changeLeaderOption = useMemo(\\n\\t\\t() =>\\n\\t\\t\\troomCanSetLeader && userCanSetLeader\\n\\t\\t\\t\\t? {\\n\\t\\t\\t\\t\\t\\tcontent: t(isLeader ? 'Remove_as_leader' : 'Set_as_leader'),\\n\\t\\t\\t\\t\\t\\ticon: 'shield-alt' as const,\\n\\t\\t\\t\\t\\t\\tonClick: changeLeaderAction,\\n\\t\\t\\t\\t\\t\\ttype: 'privileges' as UserInfoActionType,\\n\\t\\t\\t\\t  }\\n\\t\\t\\t\\t: undefined,\\n\\t\\t[isLeader, roomCanSetLeader, t, userCanSetLeader, changeLeaderAction],\\n\\t);\\n\\n\\treturn changeLeaderOption;\\n};\\n\",null],\"names\":[\"module\",\"export\",\"useChangeLeaderAction\",\"link\",\"useMutableCallback\",\"v\",\"useTranslation\",\"usePermission\",\"useUserRoom\",\"useUserSubscription\",\"useMemo\",\"useEndpointAction\",\"getRoomDirectives\",\"useUserHasRoomRole\",\"user\",\"rid\",\"t\",\"room\",\"uid\",\"_id\",\"userCanSetLeader\",\"userSubscription\",\"Error\",\"roomCanSetLeader\",\"_getRoomDirectives\",\"showingUserId\",\"isLeader\",\"endpointPrefix\",\"changeLeader\",\"successMessage\",\"username\",\"role\",\"changeLeaderAction\",\"roomId\",\"userId\",\"content\",\"icon\",\"onClick\",\"type\",\"undefined\"],\"mappings\":\"uBACAA,EAAOC,MAAE,CAAA,CAAAC,sBAA0B,WAAA,OAAAA,CAA8B,CAAA,GAAAF,EAAAG,IAAA,CAAA,8BAAA,CAAAC,mBAAA,SAAAC,CAAA,EAAAD,EAAAC,CAAA,CAAA,EAAA,GAAAL,EAAAG,IAAA,CAAA,2BAAA,CAAAG,eAAA,SAAAD,CAAA,EAAAC,EAAAD,CAAA,EAAAE,cAAA,SAAAF,CAAA,EAAAE,EAAAF,CAAA,EAAAG,YAAA,SAAAH,CAAA,EAAAG,EAAAH,CAAA,EAAAI,oBAAA,SAAAJ,CAAA,EAAAI,EAAAJ,CAAA,CAAA,EAAA,GAAAL,EAAAG,IAAA,CAAA,QAAA,CAAAO,QAAA,SAAAL,CAAA,EAAAK,EAAAL,CAAA,CAAA,EAAA,GAAAL,EAAAG,IAAA,CAAA,yCAAA,CAAAQ,kBAAA,SAAAN,CAAA,EAAAM,EAAAN,CAAA,CAAA,EAAA,GAAAL,EAAAG,IAAA,CAAA,iCAAA,CAAAS,kBAAA,SAAAP,CAAA,EAAAO,EAAAP,CAAA,CAAA,EAAA,GAAAL,EAAAG,IAAA,CAAA,2BAAA,CAAAU,mBAAA,SAAAR,CAAA,EAAAQ,EAAAR,CAAA,CAAA,EAAA,GAS1D,IAT0DD,EAAAE,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EASpDX,EAAwB,SAACY,CAAqC,CAAEC,CAAiB,EAC7F,IAAMC,EAAIV,IACJW,EAAOT,EAAYO,GACZG,EAAQJ,EAAbK,GAAG,CACLC,EAAmBb,EAAc,aAAcQ,GAC/CM,EAAmBZ,EAAoBM,GAE7C,GAAI,CAACE,EACJ,MAAMK,MAAM,qBAGb,IAAQC,EAAgBC,AAAKZ,EAAkB,CAAEK,KAAAA,EAAMQ,cAAeP,EAAKG,iBAAAA,CAAgB,GAAnFE,gBAAgB,CAClBG,EAAWb,EAAmBK,EAAKH,EAAK,UAExCY,EAAiBV,AAAW,MAAXA,EAAKD,CAAC,CAAW,aAAe,eAGjDY,EAAejB,EAAkB,OAAWgB,EAAc,IAFnCD,CAAAA,EAAW,eAAiB,WAAA,EAEmC,CAC3FG,eAAgBb,EAFWU,EAAW,+BAAiC,2BAEhC,CAAEI,SAAUhB,EAAKgB,QAAQ,CAAEC,KAAM,QAAQ,KAE3EC,EAAqB5B,EAAmB,WAAA,OAAMwB,EAAa,CAAEK,OAAQlB,EAAKmB,OAAQhB,CAAG,EAAG,GAc9F,OAb2BR,EAC1B,WAAA,OACCa,GAAoBH,EACjB,CACAe,QAASnB,EAAEU,EAAW,mBAAqB,iBAC3CU,KAAM,aACNC,QAASL,EACTM,KAAM,cAENC,KAAAA,CAAS,EACb,CAACb,EAAUH,EAAkBP,EAAGI,EAAkBY,EAAmB,CAIvE\"}"}