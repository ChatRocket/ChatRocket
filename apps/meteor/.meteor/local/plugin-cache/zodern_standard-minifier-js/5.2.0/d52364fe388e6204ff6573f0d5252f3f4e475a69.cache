{"code":"function module(e,t,s){let r,i,o,a,n,l,u,d,h,g,m,c,p,k,x,v,S,P,R,f,w;s.link(\"@babel/runtime/helpers/objectSpread2\",{default(e){r=e}},0),s.link(\"@rocket.chat/core-typings\",{isThreadMainMessage(e){i=e}},0),s.link(\"@rocket.chat/ui-contexts\",{useLayout(e){o=e},useUser(e){a=e},useUserPreference(e){n=e},useSetting(e){l=e},useEndpoint(e){u=e},useSearchParameter(e){d=e}},1),s.link(\"react\",{default(e){h=e},useMemo(e){g=e},memo(e){m=e}},2),s.link(\"../../../../../app/highlight-words/client/helper\",{getRegexHighlight(e){c=e},getRegexHighlightUrl(e){p=e}},3),s.link(\"../../../../components/message/list/MessageListContext\",{MessageListContext(e){k=e}},4),s.link(\"../../../../providers/AttachmentProvider\",{default(e){x=e}},5),s.link(\"../../contexts/ChatContext\",{useChat(e){v=e}},6),s.link(\"../../contexts/RoomContext\",{useRoom(e){S=e},useRoomSubscription(e){P=e}},7),s.link(\"../hooks/useAutoTranslate\",{useAutoTranslate(e){R=e}},8),s.link(\"../hooks/useKatex\",{useKatex(e){f=e}},9),s.link(\"../hooks/useLoadSurroundingMessages\",{useLoadSurroundingMessages(e){w=e}},10),s.exportDefault(m(e=>{let{children:t,messageListRef:s,attachmentDimension:m}=e,E=S();if(!E)throw Error(\"Room not found\");let M=u(\"POST\",\"/v1/chat.react\"),U=a(),_=null==U?void 0:U._id,b=null==U?void 0:U.username,y=P(),{isMobile:C}=o(),T=!!l(\"UI_Use_Real_Name\"),L=l(\"HexColorPreview_Enabled\"),j=!!l(\"UI_DisplayRoles\"),A=!!(!n(\"hideRoles\")&&!C),H=j&&A,I=!!(!n(\"hideUsernames\")&&!C),D=n(\"highlights\"),{showAutoTranslate:O,autoTranslateLanguage:F}=R(y),{katexEnabled:K,katexDollarSyntaxEnabled:N,katexParenthesisSyntaxEnabled:q}=f(),z=!!y,B=d(\"msg\");w(B);let G=v(),J=g(()=>r(r({showColors:L,useUserHasReacted:b?e=>t=>{var s;return!!(null===(s=e.reactions)||void 0===s?void 0:s[t].usernames.includes(b))}:()=>()=>!1,useShowFollowing:_?e=>{let{message:t}=e;return!!(t.replies&&t.replies.indexOf(_)>-1&&!i(t))}:()=>!1,autoTranslateLanguage:F,useShowTranslated:O,useShowStarred:z?e=>{let{message:t}=e;return!!(Array.isArray(t.starred)&&t.starred.find(e=>e._id===_))}:()=>!1,useMessageDateFormatter:()=>e=>e.toLocaleString(),showRoles:H,showRealName:T,showUsername:I,messageListRef:s,jumpToMessageParam:B},K&&{katex:{dollarSyntaxEnabled:N,parenthesisSyntaxEnabled:q}}),{},{highlights:null==D?void 0:D.map(e=>e.trim()).map(e=>({highlight:e,regex:c(e),urlRegex:p(e)})),useOpenEmojiPicker:_?e=>t=>{t.nativeEvent.stopImmediatePropagation(),null==G||G.emojiPicker.open(t.currentTarget,t=>M({messageId:e._id,reaction:t}))}:()=>()=>void 0,username:b}),[b,_,O,z,F,H,T,I,K,N,q,D,M,L,B,s,null==G?void 0:G.emojiPicker]);return h.createElement(x,{width:null==m?void 0:m.width,height:null==m?void 0:m.height},h.createElement(k.Provider,{value:J},t))}))}","map":"{\"version\":3,\"sources\":[\"client/views/room/MessageList/providers/MessageListProvider.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { isThreadMainMessage } from '@rocket.chat/core-typings';\\nimport { useLayout, useUser, useUserPreference, useSetting, useEndpoint, useSearchParameter } from '@rocket.chat/ui-contexts';\\nimport type { ReactNode } from 'react';\\nimport React, { useMemo, memo } from 'react';\\n\\nimport { getRegexHighlight, getRegexHighlightUrl } from '../../../../../app/highlight-words/client/helper';\\nimport type { MessageListContextValue } from '../../../../components/message/list/MessageListContext';\\nimport { MessageListContext } from '../../../../components/message/list/MessageListContext';\\nimport AttachmentProvider from '../../../../providers/AttachmentProvider';\\nimport { useChat } from '../../contexts/ChatContext';\\nimport { useRoom, useRoomSubscription } from '../../contexts/RoomContext';\\nimport { useAutoTranslate } from '../hooks/useAutoTranslate';\\nimport { useKatex } from '../hooks/useKatex';\\nimport { useLoadSurroundingMessages } from '../hooks/useLoadSurroundingMessages';\\n\\ntype MessageListProviderProps = {\\n\\tchildren: ReactNode;\\n\\tmessageListRef?: React.RefObject<HTMLElement>;\\n\\tattachmentDimension?: {\\n\\t\\twidth?: number;\\n\\t\\theight?: number;\\n\\t};\\n};\\n\\nconst MessageListProvider = ({ children, messageListRef, attachmentDimension }: MessageListProviderProps) => {\\n\\tconst room = useRoom();\\n\\n\\tif (!room) {\\n\\t\\tthrow new Error('Room not found');\\n\\t}\\n\\n\\tconst reactToMessage = useEndpoint('POST', '/v1/chat.react');\\n\\tconst user = useUser();\\n\\tconst uid = user?._id;\\n\\tconst username = user?.username;\\n\\tconst subscription = useRoomSubscription();\\n\\n\\tconst { isMobile } = useLayout();\\n\\n\\tconst showRealName = Boolean(useSetting('UI_Use_Real_Name'));\\n\\tconst showColors = useSetting('HexColorPreview_Enabled') as boolean;\\n\\n\\tconst displayRolesGlobal = Boolean(useSetting('UI_DisplayRoles'));\\n\\tconst hideRolesPreference = Boolean(!useUserPreference<boolean>('hideRoles') && !isMobile);\\n\\tconst showRoles = displayRolesGlobal && hideRolesPreference;\\n\\tconst showUsername = Boolean(!useUserPreference<boolean>('hideUsernames') && !isMobile);\\n\\tconst highlights = useUserPreference<string[]>('highlights');\\n\\n\\tconst { showAutoTranslate, autoTranslateLanguage } = useAutoTranslate(subscription);\\n\\tconst { katexEnabled, katexDollarSyntaxEnabled, katexParenthesisSyntaxEnabled } = useKatex();\\n\\n\\tconst hasSubscription = Boolean(subscription);\\n\\tconst msgParameter = useSearchParameter('msg');\\n\\n\\tuseLoadSurroundingMessages(msgParameter);\\n\\n\\tconst chat = useChat();\\n\\n\\tconst context: MessageListContextValue = useMemo(\\n\\t\\t() => ({\\n\\t\\t\\tshowColors,\\n\\t\\t\\tuseUserHasReacted: username\\n\\t\\t\\t\\t? (message) =>\\n\\t\\t\\t\\t\\t\\t(reaction): boolean =>\\n\\t\\t\\t\\t\\t\\t\\tBoolean(message.reactions?.[reaction].usernames.includes(username))\\n\\t\\t\\t\\t: () => (): boolean => false,\\n\\t\\t\\tuseShowFollowing: uid\\n\\t\\t\\t\\t? ({ message }): boolean => Boolean(message.replies && message.replies.indexOf(uid) > -1 && !isThreadMainMessage(message))\\n\\t\\t\\t\\t: (): boolean => false,\\n\\t\\t\\tautoTranslateLanguage,\\n\\t\\t\\tuseShowTranslated: showAutoTranslate,\\n\\t\\t\\tuseShowStarred: hasSubscription\\n\\t\\t\\t\\t? ({ message }): boolean => Boolean(Array.isArray(message.starred) && message.starred.find((star) => star._id === uid))\\n\\t\\t\\t\\t: (): boolean => false,\\n\\t\\t\\tuseMessageDateFormatter:\\n\\t\\t\\t\\t() =>\\n\\t\\t\\t\\t(date: Date): string =>\\n\\t\\t\\t\\t\\tdate.toLocaleString(),\\n\\t\\t\\tshowRoles,\\n\\t\\t\\tshowRealName,\\n\\t\\t\\tshowUsername,\\n\\t\\t\\tmessageListRef,\\n\\t\\t\\tjumpToMessageParam: msgParameter,\\n\\t\\t\\t...(katexEnabled && {\\n\\t\\t\\t\\tkatex: {\\n\\t\\t\\t\\t\\tdollarSyntaxEnabled: katexDollarSyntaxEnabled,\\n\\t\\t\\t\\t\\tparenthesisSyntaxEnabled: katexParenthesisSyntaxEnabled,\\n\\t\\t\\t\\t},\\n\\t\\t\\t}),\\n\\t\\t\\thighlights: highlights\\n\\t\\t\\t\\t?.map((str) => str.trim())\\n\\t\\t\\t\\t.map((highlight) => ({\\n\\t\\t\\t\\t\\thighlight,\\n\\t\\t\\t\\t\\tregex: getRegexHighlight(highlight),\\n\\t\\t\\t\\t\\turlRegex: getRegexHighlightUrl(highlight),\\n\\t\\t\\t\\t})),\\n\\n\\t\\t\\tuseOpenEmojiPicker: uid\\n\\t\\t\\t\\t? (message) =>\\n\\t\\t\\t\\t\\t\\t(e): void => {\\n\\t\\t\\t\\t\\t\\t\\te.nativeEvent.stopImmediatePropagation();\\n\\t\\t\\t\\t\\t\\t\\tchat?.emojiPicker.open(e.currentTarget, (emoji: string) => reactToMessage({ messageId: message._id, reaction: emoji }));\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t: () => (): void => undefined,\\n\\t\\t\\tusername,\\n\\t\\t}),\\n\\t\\t[\\n\\t\\t\\tusername,\\n\\t\\t\\tuid,\\n\\t\\t\\tshowAutoTranslate,\\n\\t\\t\\thasSubscription,\\n\\t\\t\\tautoTranslateLanguage,\\n\\t\\t\\tshowRoles,\\n\\t\\t\\tshowRealName,\\n\\t\\t\\tshowUsername,\\n\\t\\t\\tkatexEnabled,\\n\\t\\t\\tkatexDollarSyntaxEnabled,\\n\\t\\t\\tkatexParenthesisSyntaxEnabled,\\n\\t\\t\\thighlights,\\n\\t\\t\\treactToMessage,\\n\\t\\t\\tshowColors,\\n\\t\\t\\tmsgParameter,\\n\\t\\t\\tmessageListRef,\\n\\t\\t\\tchat?.emojiPicker,\\n\\t\\t],\\n\\t);\\n\\n\\treturn (\\n\\t\\t<AttachmentProvider width={attachmentDimension?.width} height={attachmentDimension?.height}>\\n\\t\\t\\t<MessageListContext.Provider value={context}>{children}</MessageListContext.Provider>\\n\\t\\t</AttachmentProvider>\\n\\t);\\n};\\n\\nexport default memo(MessageListProvider);\\n\",null],\"names\":[\"_objectSpread\",\"isThreadMainMessage\",\"useLayout\",\"useUser\",\"useUserPreference\",\"useSetting\",\"useEndpoint\",\"useSearchParameter\",\"React\",\"useMemo\",\"memo\",\"getRegexHighlight\",\"getRegexHighlightUrl\",\"MessageListContext\",\"AttachmentProvider\",\"useChat\",\"useRoom\",\"useRoomSubscription\",\"useAutoTranslate\",\"useKatex\",\"useLoadSurroundingMessages\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"children\",\"messageListRef\",\"attachmentDimension\",\"room\",\"Error\",\"reactToMessage\",\"user\",\"uid\",\"_id\",\"username\",\"subscription\",\"isMobile\",\"showRealName\",\"Boolean\",\"showColors\",\"displayRolesGlobal\",\"hideRolesPreference\",\"showRoles\",\"showUsername\",\"highlights\",\"showAutoTranslate\",\"autoTranslateLanguage\",\"katexEnabled\",\"katexDollarSyntaxEnabled\",\"katexParenthesisSyntaxEnabled\",\"hasSubscription\",\"msgParameter\",\"chat\",\"context\",\"useUserHasReacted\",\"message\",\"reaction\",\"_message$reactions\",\"reactions\",\"usernames\",\"includes\",\"useShowFollowing\",\"_ref2\",\"replies\",\"indexOf\",\"useShowTranslated\",\"useShowStarred\",\"_ref3\",\"Array\",\"isArray\",\"starred\",\"find\",\"star\",\"useMessageDateFormatter\",\"date\",\"toLocaleString\",\"jumpToMessageParam\",\"katex\",\"dollarSyntaxEnabled\",\"parenthesisSyntaxEnabled\",\"map\",\"str\",\"trim\",\"highlight\",\"regex\",\"urlRegex\",\"useOpenEmojiPicker\",\"e\",\"nativeEvent\",\"stopImmediatePropagation\",\"emojiPicker\",\"open\",\"currentTarget\",\"emoji\",\"messageId\",\"undefined\",\"createElement\",\"width\",\"height\",\"Provider\",\"value\"],\"mappings\":\"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\"}"}