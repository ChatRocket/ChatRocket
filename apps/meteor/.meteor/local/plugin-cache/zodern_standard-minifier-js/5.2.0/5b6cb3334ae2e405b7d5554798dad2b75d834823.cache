{"code":"function module(n,e,t){t.link(\"@babel/runtime/regenerator\",{default:function(n){u=n}},0),t.export({useFileUploadAction:function(){return s}}),t.link(\"@rocket.chat/ui-contexts\",{useTranslation:function(n){i=n},useSetting:function(n){l=n}},0),t.link(\"react\",{useEffect:function(n){r=n}},1),t.link(\"../../../../../../hooks/useFileInput\",{useFileInput:function(n){o=n}},2),t.link(\"../../../../contexts/ChatContext\",{useChat:function(n){c=n}},3);var u,i,l,r,o,c,a={type:\"file\",multiple:!0},s=function(n){var e=i(),s=l(\"FileUpload_Enabled\"),f=o(a),d=c();return r(function(){var n,e=function(){null!=f&&f.current&&(f.current.value=\"\")},i=function(){var n,i,l,r;return u.async(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,u.awrap(t.dynamicImport(\"../../../../../../../app/utils/lib/mimeTypes\"));case 2:l=o.sent.getMimeType,r=Array.from(null!==(n=null==f?void 0:null===(i=f.current)||void 0===i?void 0:i.files)&&void 0!==n?n:[]).map(function(n){return Object.defineProperty(n,\"type\",{value:l(n.type,n.name)}),n}),null==d||d.flows.uploadFiles(r,e);case 6:case\"end\":return o.stop()}},null,null,null,Promise)};return null===(n=f.current)||void 0===n||n.addEventListener(\"change\",i),function(){var n;return null==f?void 0:null===(n=f.current)||void 0===n?void 0:n.removeEventListener(\"change\",i)}},[d,f]),{id:\"file-upload\",content:e(\"Upload_file\"),icon:\"clip\",onClick:function(){var n;null==f||null===(n=f.current)||void 0===n||n.click()},disabled:!s||n}}}","map":"{\"version\":3,\"sources\":[\"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useFileUploadAction.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { GenericMenuItemProps } from '@rocket.chat/ui-client';\\nimport { useTranslation, useSetting } from '@rocket.chat/ui-contexts';\\nimport { useEffect } from 'react';\\n\\nimport { useFileInput } from '../../../../../../hooks/useFileInput';\\nimport { useChat } from '../../../../contexts/ChatContext';\\n\\nconst fileInputProps = { type: 'file', multiple: true };\\n\\nexport const useFileUploadAction = (disabled: boolean): GenericMenuItemProps => {\\n\\tconst t = useTranslation();\\n\\tconst fileUploadEnabled = useSetting<boolean>('FileUpload_Enabled');\\n\\tconst fileInputRef = useFileInput(fileInputProps);\\n\\tconst chat = useChat();\\n\\n\\tuseEffect(() => {\\n\\t\\tconst resetFileInput = () => {\\n\\t\\t\\tif (!fileInputRef?.current) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tfileInputRef.current.value = '';\\n\\t\\t};\\n\\n\\t\\tconst handleUploadChange = async () => {\\n\\t\\t\\tconst { getMimeType } = await import('../../../../../../../app/utils/lib/mimeTypes');\\n\\t\\t\\tconst filesToUpload = Array.from(fileInputRef?.current?.files ?? []).map((file) => {\\n\\t\\t\\t\\tObject.defineProperty(file, 'type', {\\n\\t\\t\\t\\t\\tvalue: getMimeType(file.type, file.name),\\n\\t\\t\\t\\t});\\n\\t\\t\\t\\treturn file;\\n\\t\\t\\t});\\n\\t\\t\\tchat?.flows.uploadFiles(filesToUpload, resetFileInput);\\n\\t\\t};\\n\\n\\t\\tfileInputRef.current?.addEventListener('change', handleUploadChange);\\n\\t\\treturn () => fileInputRef?.current?.removeEventListener('change', handleUploadChange);\\n\\t}, [chat, fileInputRef]);\\n\\n\\tconst handleUpload = () => {\\n\\t\\tfileInputRef?.current?.click();\\n\\t};\\n\\n\\treturn {\\n\\t\\tid: 'file-upload',\\n\\t\\tcontent: t('Upload_file'),\\n\\t\\ticon: 'clip',\\n\\t\\tonClick: handleUpload,\\n\\t\\tdisabled: !fileUploadEnabled || disabled,\\n\\t};\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"export\",\"useFileUploadAction\",\"useTranslation\",\"useSetting\",\"useEffect\",\"useFileInput\",\"useChat\",\"fileInputProps\",\"type\",\"multiple\",\"disabled\",\"t\",\"fileUploadEnabled\",\"fileInputRef\",\"chat\",\"_fileInputRef$current3\",\"resetFileInput\",\"current\",\"value\",\"handleUploadChange\",\"_fileInputRef$current\",\"_fileInputRef$current2\",\"getMimeType\",\"filesToUpload\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"dynamicImport\",\"_await$module$dynamic\",\"sent\",\"Array\",\"from\",\"files\",\"map\",\"file\",\"Object\",\"defineProperty\",\"name\",\"flows\",\"uploadFiles\",\"stop\",\"Promise\",\"addEventListener\",\"_fileInputRef$current4\",\"removeEventListener\",\"id\",\"content\",\"icon\",\"onClick\",\"_fileInputRef$current5\",\"click\"],\"mappings\":\"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\"}"}