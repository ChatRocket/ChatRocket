{"code":"function module(e,t,n){let s,a,i,o,l,r,c,u,d,h,m,f;n.export({useDeleteUserAction:()=>g}),n.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback(e){s=e}},0),n.link(\"@rocket.chat/ui-contexts\",{useSetModal(e){a=e},useToastMessageDispatch(e){i=e},useRoute(e){o=e},useSetting(e){l=e},usePermission(e){r=e},useEndpoint(e){c=e},useTranslation(e){u=e}},1),n.link(\"react\",{default(e){d=e},useMemo(e){h=e}},2),n.link(\"../../../../components/GenericModal\",{default(e){m=e}},3),n.link(\"./useConfirmOwnerChanges\",{useConfirmOwnerChanges(e){f=e}},4);let g=(e,t,n)=>{let g=u(),_=a(),k=o(\"admin-users\"),p=r(\"delete-user\"),C=l(\"Message_ErasureType\"),D=f(),T=i(),M=()=>{_(),k.push({}),n()},b=h(()=>({userId:e,confirmRelinquish:!1}),[e]),v=c(\"POST\",\"/v1/users.delete\"),w=()=>D(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&(b.confirmRelinquish=e);try{await v(b),T({type:\"success\",message:g(\"User_has_been_deleted\")}),M()}catch(e){throw e}},{contentTitle:g(\"Delete_User_Warning_\".concat(C)),confirmText:g(\"Delete\")},t),x=s(()=>{_(d.createElement(m,{variant:\"danger\",onConfirm:w,onCancel:()=>_(),confirmText:g(\"Delete\")},g(\"Delete_User_Warning_\".concat(C))))});return p?{icon:\"trash\",label:g(\"Delete\"),action:x}:void 0}}","map":"{\"version\":3,\"sources\":[\"client/views/admin/users/hooks/useDeleteUserAction.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IUser } from '@rocket.chat/core-typings';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\\nimport {\\n\\tuseSetModal,\\n\\tuseToastMessageDispatch,\\n\\tuseRoute,\\n\\tuseSetting,\\n\\tusePermission,\\n\\tuseEndpoint,\\n\\tuseTranslation,\\n} from '@rocket.chat/ui-contexts';\\nimport React, { useMemo } from 'react';\\n\\nimport GenericModal from '../../../../components/GenericModal';\\nimport type { Action } from '../../../hooks/useActionSpread';\\nimport { useConfirmOwnerChanges } from './useConfirmOwnerChanges';\\n\\nexport const useDeleteUserAction = (userId: IUser['_id'], onChange: () => void, onReload: () => void): Action | undefined => {\\n\\tconst t = useTranslation();\\n\\tconst setModal = useSetModal();\\n\\tconst userRoute = useRoute('admin-users');\\n\\tconst canDeleteUser = usePermission('delete-user');\\n\\tconst erasureType = useSetting('Message_ErasureType');\\n\\tconst confirmOwnerChanges = useConfirmOwnerChanges();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst handleDeletedUser = (): void => {\\n\\t\\tsetModal();\\n\\t\\tuserRoute.push({});\\n\\t\\tonReload();\\n\\t};\\n\\n\\tconst deleteUserQuery = useMemo(() => ({ userId, confirmRelinquish: false }), [userId]);\\n\\tconst deleteUserEndpoint = useEndpoint('POST', '/v1/users.delete');\\n\\n\\tconst deleteUser = (): Promise<void> =>\\n\\t\\tconfirmOwnerChanges(\\n\\t\\t\\tasync (confirm = false) => {\\n\\t\\t\\t\\tif (confirm) {\\n\\t\\t\\t\\t\\tdeleteUserQuery.confirmRelinquish = confirm;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\ttry {\\n\\t\\t\\t\\t\\tawait deleteUserEndpoint(deleteUserQuery);\\n\\t\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('User_has_been_deleted') });\\n\\t\\t\\t\\t\\thandleDeletedUser();\\n\\t\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\t\\tthrow error;\\n\\t\\t\\t\\t}\\n\\t\\t\\t},\\n\\t\\t\\t{\\n\\t\\t\\t\\tcontentTitle: t(`Delete_User_Warning_${erasureType}` as TranslationKey),\\n\\t\\t\\t\\tconfirmText: t('Delete'),\\n\\t\\t\\t},\\n\\t\\t\\tonChange,\\n\\t\\t);\\n\\n\\tconst confirmDeleteUser = useMutableCallback(() => {\\n\\t\\tsetModal(\\n\\t\\t\\t<GenericModal variant='danger' onConfirm={deleteUser} onCancel={(): void => setModal()} confirmText={t('Delete')}>\\n\\t\\t\\t\\t{t(`Delete_User_Warning_${erasureType}` as TranslationKey)}\\n\\t\\t\\t</GenericModal>,\\n\\t\\t);\\n\\t});\\n\\n\\treturn canDeleteUser\\n\\t\\t? {\\n\\t\\t\\t\\ticon: 'trash',\\n\\t\\t\\t\\tlabel: t('Delete'),\\n\\t\\t\\t\\taction: confirmDeleteUser,\\n\\t\\t  }\\n\\t\\t: undefined;\\n};\\n\",null],\"names\":[\"useMutableCallback\",\"useSetModal\",\"useToastMessageDispatch\",\"useRoute\",\"useSetting\",\"usePermission\",\"useEndpoint\",\"useTranslation\",\"React\",\"useMemo\",\"GenericModal\",\"useConfirmOwnerChanges\",\"module\",\"export\",\"useDeleteUserAction\",\"link\",\"v\",\"default\",\"userId\",\"onChange\",\"onReload\",\"t\",\"setModal\",\"userRoute\",\"canDeleteUser\",\"erasureType\",\"confirmOwnerChanges\",\"dispatchToastMessage\",\"handleDeletedUser\",\"push\",\"deleteUserQuery\",\"confirmRelinquish\",\"deleteUserEndpoint\",\"deleteUser\",\"confirm\",\"arguments\",\"length\",\"undefined\",\"type\",\"message\",\"error\",\"contentTitle\",\"concat\",\"confirmText\",\"confirmDeleteUser\",\"createElement\",\"variant\",\"onConfirm\",\"onCancel\",\"icon\",\"label\",\"action\"],\"mappings\":\"2BACiEA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAjEC,EAAOC,MAAE,CAAA,CAAAC,oBAA0BA,IAAAA,CAAA,GAA8BF,EAAAG,IAAA,CAAA,8BAAA,CAAAf,mBAAAgB,CAAA,EAAAhB,EAAAgB,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,2BAAA,CAAAd,YAAAe,CAAA,EAAAf,EAAAe,CAAA,EAAAd,wBAAAc,CAAA,EAAAd,EAAAc,CAAA,EAAAb,SAAAa,CAAA,EAAAb,EAAAa,CAAA,EAAAZ,WAAAY,CAAA,EAAAZ,EAAAY,CAAA,EAAAX,cAAAW,CAAA,EAAAX,EAAAW,CAAA,EAAAV,YAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,eAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,QAAA,CAAAE,QAAAD,CAAA,EAAAR,EAAAQ,CAAA,EAAAP,QAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,sCAAA,CAAAE,QAAAD,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,2BAAA,CAAAJ,uBAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAiB1D,IAAMF,EAAsBA,CAACI,EAAsBC,EAAsBC,KAC/E,IAAMC,EAAId,IACJe,EAAWrB,IACXsB,EAAYpB,EAAS,eACrBqB,EAAgBnB,EAAc,eAC9BoB,EAAcrB,EAAW,uBACzBsB,EAAsBf,IACtBgB,EAAuBzB,IAEvB0B,EAAoBA,KACzBN,IACAC,EAAUM,IAAI,CAAC,CAAA,GACfT,GACD,EAEMU,EAAkBrB,EAAQ,IAAO,CAAA,CAAES,OAAAA,EAAQa,kBAAmB,CAAA,CAAK,CAAA,EAAK,CAACb,EAAO,EAChFc,EAAqB1B,EAAY,OAAQ,oBAEzC2B,EAAaA,IAClBP,EACC,iBAA0B,IAAnBQ,EAAOC,UAAAC,MAAA,CAAA,GAAAD,AAAAE,KAAAA,IAAAF,SAAA,CAAA,EAAA,EAAAA,SAAA,CAAA,EAAA,CACTD,GACHJ,CAAAA,EAAgBC,iBAAiB,CAAGG,CAAAA,EAGrC,GAAI,CACH,MAAMF,EAAmBF,GACzBH,EAAqB,CAAEW,KAAM,UAAWC,QAASlB,EAAE,wBAAwB,GAC3EO,GACD,CAAE,MAAOY,EAAO,CACf,MAAMA,CACP,CACD,EACA,CACCC,aAAcpB,EAAC,uBAAAqB,MAAA,CAAwBjB,IACvCkB,YAAatB,EAAE,WAEhBF,GAGIyB,EAAoB5C,EAAmB,KAC5CsB,EACCd,EAAAqC,aAAA,CAACnC,EAAY,CAACoC,QAAQ,SAASC,UAAWd,EAAYe,SAAUA,IAAY1B,IAAYqB,YAAatB,EAAE,SAAU,EAC/GA,EAAC,uBAAAqB,MAAA,CAAwBjB,KAG7B,GAEA,OAAOD,EACJ,CACAyB,KAAM,QACNC,MAAO7B,EAAE,UACT8B,OAAQP,GAERP,KAAAA,CACJ\"}"}