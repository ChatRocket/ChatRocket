{"code":"function module(e,t,i){i.link(\"@rocket.chat/random\",{Random:function(e){n=e}},0),i.link(\"meteor/accounts-base\",{Accounts:function(e){o=e}},1),i.link(\"meteor/github-oauth\",{Github:function(e){l=e}},2),i.link(\"meteor/meteor\",{Meteor:function(e){r=e}},3),i.link(\"meteor/oauth\",{OAuth:function(e){u=e}},4),i.link(\"../../lib/2fa/overrideLoginMethod\",{overrideLoginMethod:function(e){a=e}},5),i.link(\"../../lib/wrapRequestCredentialFn\",{wrapRequestCredentialFn:function(e){c=e}},6),i.link(\"./oauth\",{createOAuthTotpLoginMethod:function(e){h=e}},7);var n,o,l,r,u,a,c,h,d=r.loginWithGithub,s=h(l);r.loginWithGithub=function(e,t){a(d,[e],t,s)},l.requestCredential=c(\"github\",function(e){var t,i=e.config,l=e.loginStyle,r=e.options,a=e.credentialRequestCompleteCallback,c=n.secret(),h=((null==r?void 0:r.requestPermissions)||[\"user:email\"]).map(encodeURIComponent).join(\"+\"),d=\"\";null!==(t=o._options)&&void 0!==t&&t.forbidClientAccountCreation&&(d=\"&allow_signup=false\");var s=\"https://github.com/login/oauth/authorize?client_id=\"+i.clientId+\"&scope=\"+h+\"&redirect_uri=\"+u._redirectUri(\"github\",i)+\"&state=\"+u._stateParam(l,c,r.redirectUrl)+d;u.launchLogin({loginService:\"github\",loginStyle:l,loginUrl:s,credentialRequestCompleteCallback:a,credentialToken:c,popupOptions:{width:900,height:450}})})}","map":"{\"version\":3,\"sources\":[\"client/meteorOverrides/login/github.ts\",\"<anon>\"],\"sourcesContent\":[\"import { Random } from '@rocket.chat/random';\\nimport { Accounts } from 'meteor/accounts-base';\\nimport { Github } from 'meteor/github-oauth';\\nimport { Meteor } from 'meteor/meteor';\\nimport { OAuth } from 'meteor/oauth';\\n\\nimport { overrideLoginMethod } from '../../lib/2fa/overrideLoginMethod';\\nimport { wrapRequestCredentialFn } from '../../lib/wrapRequestCredentialFn';\\nimport { createOAuthTotpLoginMethod } from './oauth';\\n\\nconst { loginWithGithub } = Meteor;\\nconst loginWithGithubAndTOTP = createOAuthTotpLoginMethod(Github);\\nMeteor.loginWithGithub = (options, callback) => {\\n\\toverrideLoginMethod(loginWithGithub, [options], callback, loginWithGithubAndTOTP);\\n};\\n\\nGithub.requestCredential = wrapRequestCredentialFn('github', ({ config, loginStyle, options, credentialRequestCompleteCallback }) => {\\n\\tconst credentialToken = Random.secret();\\n\\tconst scope = options?.requestPermissions || ['user:email'];\\n\\tconst flatScope = scope.map(encodeURIComponent).join('+');\\n\\n\\tlet allowSignup = '';\\n\\tif (Accounts._options?.forbidClientAccountCreation) {\\n\\t\\tallowSignup = '&allow_signup=false';\\n\\t}\\n\\n\\tconst loginUrl =\\n\\t\\t`https://github.com/login/oauth/authorize` +\\n\\t\\t`?client_id=${config.clientId}` +\\n\\t\\t`&scope=${flatScope}` +\\n\\t\\t`&redirect_uri=${OAuth._redirectUri('github', config)}` +\\n\\t\\t`&state=${OAuth._stateParam(loginStyle, credentialToken, options.redirectUrl)}${allowSignup}`;\\n\\n\\tOAuth.launchLogin({\\n\\t\\tloginService: 'github',\\n\\t\\tloginStyle,\\n\\t\\tloginUrl,\\n\\t\\tcredentialRequestCompleteCallback,\\n\\t\\tcredentialToken,\\n\\t\\tpopupOptions: { width: 900, height: 450 },\\n\\t});\\n});\\n\",null],\"names\":[\"module\",\"link\",\"Random\",\"v\",\"Accounts\",\"Github\",\"Meteor\",\"OAuth\",\"overrideLoginMethod\",\"wrapRequestCredentialFn\",\"createOAuthTotpLoginMethod\",\"loginWithGithub\",\"_Meteor\",\"loginWithGithubAndTOTP\",\"options\",\"callback\",\"requestCredential\",\"_ref\",\"_Accounts$_options\",\"config\",\"loginStyle\",\"credentialRequestCompleteCallback\",\"credentialToken\",\"secret\",\"flatScope\",\"scope\",\"requestPermissions\",\"map\",\"encodeURIComponent\",\"join\",\"allowSignup\",\"_options\",\"forbidClientAccountCreation\",\"loginUrl\",\"clientId\",\"_redirectUri\",\"_stateParam\",\"redirectUrl\",\"launchLogin\",\"loginService\",\"popupOptions\",\"width\",\"height\"],\"mappings\":\"uBAASA,EAAQC,IAAA,CAAM,sBAAsB,CAAAC,OAAA,SAAAC,CAAA,EAAAD,EAAAC,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,uBAAA,CAAAG,SAAA,SAAAD,CAAA,EAAAC,EAAAD,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,sBAAA,CAAAI,OAAA,SAAAF,CAAA,EAAAE,EAAAF,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,gBAAA,CAAAK,OAAA,SAAAH,CAAA,EAAAG,EAAAH,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,eAAA,CAAAM,MAAA,SAAAJ,CAAA,EAAAI,EAAAJ,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,oCAAA,CAAAO,oBAAA,SAAAL,CAAA,EAAAK,EAAAL,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,oCAAA,CAAAQ,wBAAA,SAAAN,CAAA,EAAAM,EAAAN,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,UAAA,CAAAS,2BAAA,SAAAP,CAAA,EAAAO,EAAAP,CAAA,CAAA,EAAA,GAU7C,IAVAD,EAA6CE,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAUrCC,EAAeC,AAAKN,EAApBK,eAAe,CACjBE,EAAyBH,EAA2BL,EAC1DC,CAAAA,EAAOK,eAAe,CAAG,SAACG,CAAO,CAAEC,CAAQ,EAC1CP,EAAoBG,EAAiB,CAACG,EAAQ,CAAEC,EAAUF,EAC3D,EAEAR,EAAOW,iBAAiB,CAAGP,EAAwB,SAAU,SAAAQ,CAAA,EAAuE,IAAAC,EAApEC,EAAMF,EAANE,MAAM,CAAEC,EAAUH,EAAVG,UAAU,CAAEN,EAAOG,EAAPH,OAAO,CAAEO,EAAiCJ,EAAjCI,iCAAiC,CACvHC,EAAkBpB,EAAOqB,MAAM,GAE/BC,EAAYC,AADJ,CAAA,AAAAX,CAAAA,MAAAA,EAAO,KAAA,EAAPA,EAASY,kBAAkB,AAAlBA,GAAsB,CAAC,aAAa,AAAD,EAClCC,GAAG,CAACC,oBAAoBC,IAAI,CAAC,KAEjDC,EAAc,EACG,QAArBZ,CAAAA,EAAId,EAAS2B,QAAQ,AAARA,GAAQb,AAAA,KAAA,IAAAA,GAAjBA,EAAmBc,2BAA2B,EACjDF,CAAAA,EAAc,qBAAA,EAGf,IAAMG,EACL,sDACcd,EAAOe,QAAQ,CAAE,UACrBV,EAAW,iBACJjB,EAAM4B,YAAY,CAAC,SAAUhB,GAAS,UAC7CZ,EAAM6B,WAAW,CAAChB,EAAYE,EAAiBR,EAAQuB,WAAW,EAAIP,EAEjFvB,EAAM+B,WAAW,CAAC,CACjBC,aAAc,SACdnB,WAAAA,EACAa,SAAAA,EACAZ,kCAAAA,EACAC,gBAAAA,EACAkB,aAAc,CAAEC,MAAO,IAAKC,OAAQ,GAAG,GAEzC\"}"}