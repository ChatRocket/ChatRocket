{"code":"function module(e,n,t){let a,l,i,s,r,o,c,d,p,u,m,b,k,E,v,A,f,h,y,g,M,_,x,I,w,P,U,S,T,C,L;t.link(\"@babel/runtime/helpers/objectSpread2\",{default(e){a=e}},0),t.export({useAppMenu:()=>D}),t.link(\"@rocket.chat/apps-engine/definition/AppStatus\",{AppStatus(e){l=e}},0),t.link(\"@rocket.chat/fuselage\",{Box(e){i=e},Icon(e){s=e}},1),t.link(\"@rocket.chat/ui-contexts\",{useSetModal(e){r=e},useEndpoint(e){o=e},useTranslation(e){c=e},useRouteParameter(e){d=e},useToastMessageDispatch(e){p=e},usePermission(e){u=e},useRouter(e){m=e}},2),t.link(\"react\",{default(e){b=e},useMemo(e){k=e},useCallback(e){E=e},useState(e){v=e}},3),t.link(\"semver\",{default(e){A=e}},4),t.link(\"../../../components/WarningModal\",{default(e){f=e}},5),t.link(\"../../../hooks/useHasLicenseModule\",{useHasLicenseModule(e){h=e}},6),t.link(\"../../../hooks/useIsEnterprise\",{useIsEnterprise(e){y=e}},7),t.link(\"../AppsList/AddonRequiredModal\",{default(e){g=e}},8),t.link(\"../IframeModal\",{default(e){M=e}},9),t.link(\"../components/UninstallGrandfatheredAppModal/UninstallGrandfatheredAppModal\",{default(e){_=e}},10),t.link(\"../helpers\",{appEnabledStatuses(e){x=e},appButtonProps(e){I=e}},11),t.link(\"../helpers/handleAPIError\",{handleAPIError(e){w=e}},12),t.link(\"../helpers/warnEnableDisableApp\",{warnEnableDisableApp(e){P=e}},13),t.link(\"./useAppInstallationHandler\",{useAppInstallationHandler(e){U=e}},14),t.link(\"./useAppsCountQuery\",{useAppsCountQuery(e){S=e}},15),t.link(\"./useMarketplaceActions\",{useMarketplaceActions(e){T=e}},16),t.link(\"./useOpenAppPermissionsReviewModal\",{useOpenAppPermissionsReviewModal(e){C=e}},17),t.link(\"./useOpenIncompatibleModal\",{useOpenIncompatibleModal(e){L=e}},18);let D=(e,n)=>{var t,D,O;let z=c(),R=m(),q=r(),F=p(),B=L(),H=d(\"context\"),N=d(\"tab\"),Y=S(H),G=u(\"manage-apps\"),{data:V}=y(),Q=!!(null!=V&&V.isEnterprise),j=e.addon,W=h(j),[J,K]=v(!1),[X,Z]=v(e.requestedEndUser),[$,ee]=v(null==e?void 0:e.isPurchased),en=I(a(a({},e),{},{isAdminUser:G,endUserRequested:!1})),et=null==en?void 0:en.label.replace(\" \",\"_\"),ea=(null==en?void 0:en.action)||\"\",el=o(\"POST\",\"/apps/:id/status\",{id:e.id}),ei=o(\"GET\",\"/apps\"),es=o(\"POST\",\"/apps/:id/sync\",{id:e.id}),er=o(\"DELETE\",\"/apps/:id\",{id:e.id}),eo=\"subscription\"===e.purchaseType,ec=e.subscriptionInfo&&[\"active\",\"trialing\"].includes(e.subscriptionInfo.status),ed=!!e.status&&x.includes(e.status),ep=E(()=>{q(null),K(!1)},[q,K]),eu=T(),em=E(async(n,t)=>{n&&(\"request\"===n?Z(!0):await eu[n](a(a({},e),{},{permissionsGranted:t}))),K(!1)},[e,eu,K]),eb=C({app:e,onCancel:ep,onConfirm:e=>em(ea,e)}),ek=U({app:e,isAppPurchased:$,action:ea,onDismiss:ep,onSuccess:em,setIsPurchased:ee}),eE=E(e=>{q(b.createElement(g,{actionType:e,onDismiss:ep,onInstallAnyway:ek}))},[ek,ep,q]),ev=E((e,n)=>{if(G&&j&&!W)return eE(e);n()},[j,G,eE,W]),eA=E(()=>{K(!0),ev(\"install\",ek)},[ek,ev]),ef=E(async()=>{let n;if(null!=e&&e.versionIncompatible&&!ec){B(e,\"subscribe\",ep);return}try{n=await ei({buildExternalUrl:\"true\",appId:e.id,purchaseType:e.purchaseType,details:\"true\"})}catch(e){w(e);return}let t=async()=>{try{await es()}catch(e){w(e)}};q(b.createElement(M,{url:n.url,confirm:t,cancel:ep}))},[e,ec,q,ep,B,ei,es]),eh=E(()=>{R.navigate({name:\"marketplace\",params:{context:H,page:\"info\",id:e.id,version:e.version,tab:\"logs\"}})},[e.id,e.version,H,R]),ey=E(()=>{let n=async()=>{ep();try{let{status:n}=await el({status:l.MANUALLY_DISABLED});P(e.name,n,\"disable\")}catch(e){w(e)}};q(b.createElement(f,{close:ep,confirm:n,text:z(\"Apps_Marketplace_Deactivate_App_Prompt\"),confirmText:z(\"Yes\")}))},[e.name,ep,el,q,z]),eg=E(()=>{ev(\"enable\",async()=>{try{let{status:n}=await el({status:l.MANUALLY_ENABLED});P(e.name,n,\"enable\")}catch(e){w(e)}})},[e.name,ev,el]),eM=E(()=>{let n=async()=>{ep();try{let{success:n}=await er();n&&(F({type:\"success\",message:\"\".concat(e.name,\" uninstalled\")}),\"details\"===H&&\"details\"!==N&&R.navigate({name:\"marketplace\",params:a(a({},R.getRouteParameters()),{},{tab:\"details\"})},{replace:!0}))}catch(e){w(e)}};if(ec){let e=async()=>{await ef()};q(b.createElement(f,{close:ep,cancel:n,confirm:e,text:z(\"Apps_Marketplace_Uninstall_Subscribed_App_Prompt\"),confirmText:z(\"Apps_Marketplace_Modify_App_Subscription\"),cancelText:z(\"Apps_Marketplace_Uninstall_Subscribed_App_Anyway\")}))}if(Y.data){if(e.migrated){q(b.createElement(_,{context:H,appName:e.name,limit:Y.data.limit,handleUninstall:n,handleClose:ep}));return}q(b.createElement(f,{close:ep,confirm:n,text:z(\"Apps_Marketplace_Uninstall_App_Prompt\"),confirmText:z(\"Yes\")}))}},[ec,Y.data,e.migrated,e.name,q,ep,z,er,F,H,N,R,ef]),e_=E((e,n)=>e.versionIncompatible?(\"subscribe\"!==n||ec)&&\"install\"!==n&&\"update\"!==n?\"card\":\"warning\":\"update\"===n?\"refresh\":\"card\",[ec]),ex=E(async()=>{if(K(!0),null!=e&&e.versionIncompatible){B(e,\"update\",ep);return}eb()},[e,eb,B,ep]),eI=e.installed&&e.version&&e.marketplaceVersion&&A.lt(e.version,e.marketplaceVersion),ew=k(()=>{var t,a,l,r;let o=[eo&&ec&&G&&{id:\"subscribe\",section:0,content:b.createElement(b.Fragment,null,b.createElement(s,{name:e_(e,\"subscribe\"),size:\"x16\",mie:4}),z(\"Subscription\")),onClick:ef}],c=[!e.installed&&!!en&&{id:\"acquire\",section:0,disabled:X,content:b.createElement(b.Fragment,null,G&&b.createElement(s,{name:e_(e,\"install\"),size:\"x16\",mie:4}),z(et)),onClick:eA}],d=e.isEnterpriseOnly&&Q||!e.isEnterpriseOnly,p=e.installed&&G&&!ed&&d,u=!e.migrated&&!(null!=Y&&null!==(t=Y.data)&&void 0!==t&&t.hasUnlimitedApps)&&(null==Y?void 0:null===(a=Y.data)||void 0===a?void 0:a.enabled)!==void 0&&(null==Y?void 0:null===(l=Y.data)||void 0===l?void 0:l.enabled)>=(null==Y?void 0:null===(r=Y.data)||void 0===r?void 0:r.limit),m=[\"details\"!==H&&G&&e.installed&&{id:\"viewLogs\",section:0,content:b.createElement(b.Fragment,null,b.createElement(s,{name:\"desktop-text\",size:\"x16\",mie:4}),z(\"View_Logs\")),onClick:eh},G&&!!eI&&!n&&{id:\"update\",section:0,content:b.createElement(b.Fragment,null,b.createElement(s,{name:e_(e,\"update\"),size:\"x16\",mie:4}),z(\"Update\")),onClick:ex},e.installed&&G&&ed&&{id:\"disable\",section:0,content:b.createElement(i,{color:\"status-font-on-warning\"},b.createElement(s,{name:\"ban\",size:\"x16\",mie:4}),z(\"Disable\")),onClick:ey},p&&{id:\"enable\",section:0,disabled:u,content:b.createElement(b.Fragment,null,b.createElement(s,{name:\"check\",size:\"x16\",marginInlineEnd:\"x4\"}),z(\"Enable\")),onClick:eg},e.installed&&G&&{id:\"uninstall\",section:1,content:b.createElement(i,{color:\"status-font-on-danger\"},b.createElement(s,{name:\"trash\",size:\"x16\",mie:4}),z(\"Uninstall\")),onClick:eM}],k=[...o,...c,...m].flatMap(e=>e&&\"boolean\"!=typeof e?e:[]),E=[];return k.forEach(e=>{void 0===E[e.section]&&(E[e.section]={items:[]}),E[e.section].items.push(e)}),E},[eo,ec,G,e_,e,z,ef,en,X,et,eA,Q,ed,null==Y?void 0:null===(t=Y.data)||void 0===t?void 0:t.hasUnlimitedApps,null==Y?void 0:null===(D=Y.data)||void 0===D?void 0:D.enabled,null==Y?void 0:null===(O=Y.data)||void 0===O?void 0:O.limit,H,eh,eI,n,ex,ey,eg,eM]);return{isLoading:J,isAdminUser:G,sections:ew}}}","map":"{\"version\":3,\"sources\":[\"client/views/marketplace/hooks/useAppMenu.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { AppStatus } from '@rocket.chat/apps-engine/definition/AppStatus';\\nimport type { App } from '@rocket.chat/core-typings';\\nimport { Box, Icon } from '@rocket.chat/fuselage';\\nimport {\\n\\tuseSetModal,\\n\\tuseEndpoint,\\n\\tuseTranslation,\\n\\tuseRouteParameter,\\n\\tuseToastMessageDispatch,\\n\\tusePermission,\\n\\tuseRouter,\\n} from '@rocket.chat/ui-contexts';\\nimport type { MouseEvent, ReactNode } from 'react';\\nimport React, { useMemo, useCallback, useState } from 'react';\\nimport semver from 'semver';\\n\\nimport WarningModal from '../../../components/WarningModal';\\nimport { useHasLicenseModule } from '../../../hooks/useHasLicenseModule';\\nimport { useIsEnterprise } from '../../../hooks/useIsEnterprise';\\nimport type { AddonActionType } from '../AppsList/AddonRequiredModal';\\nimport AddonRequiredModal from '../AppsList/AddonRequiredModal';\\nimport IframeModal from '../IframeModal';\\nimport UninstallGrandfatheredAppModal from '../components/UninstallGrandfatheredAppModal/UninstallGrandfatheredAppModal';\\nimport type { Actions } from '../helpers';\\nimport { appEnabledStatuses, appButtonProps } from '../helpers';\\nimport { handleAPIError } from '../helpers/handleAPIError';\\nimport { warnEnableDisableApp } from '../helpers/warnEnableDisableApp';\\nimport { useAppInstallationHandler } from './useAppInstallationHandler';\\nimport type { MarketplaceRouteContext } from './useAppsCountQuery';\\nimport { useAppsCountQuery } from './useAppsCountQuery';\\nimport { useMarketplaceActions } from './useMarketplaceActions';\\nimport { useOpenAppPermissionsReviewModal } from './useOpenAppPermissionsReviewModal';\\nimport { useOpenIncompatibleModal } from './useOpenIncompatibleModal';\\n\\nexport type AppMenuOption = {\\n\\tid: string;\\n\\tsection: number;\\n\\tcontent: ReactNode;\\n\\tdisabled?: boolean;\\n\\tonClick?: (e?: MouseEvent<HTMLElement>) => void;\\n};\\n\\ntype AppMenuSections = {\\n\\titems: AppMenuOption[];\\n}[];\\n\\nexport const useAppMenu = (app: App, isAppDetailsPage: boolean) => {\\n\\tconst t = useTranslation();\\n\\tconst router = useRouter();\\n\\tconst setModal = useSetModal();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst openIncompatibleModal = useOpenIncompatibleModal();\\n\\n\\tconst context = useRouteParameter('context') as MarketplaceRouteContext;\\n\\tconst currentTab = useRouteParameter('tab');\\n\\tconst appCountQuery = useAppsCountQuery(context);\\n\\n\\tconst isAdminUser = usePermission('manage-apps');\\n\\tconst { data } = useIsEnterprise();\\n\\tconst isEnterpriseLicense = !!data?.isEnterprise;\\n\\n\\tconst appAddon = app.addon;\\n\\tconst workspaceHasAddon = useHasLicenseModule(appAddon);\\n\\n\\tconst [isLoading, setLoading] = useState(false);\\n\\tconst [requestedEndUser, setRequestedEndUser] = useState(app.requestedEndUser);\\n\\tconst [isAppPurchased, setPurchased] = useState(app?.isPurchased);\\n\\n\\tconst button = appButtonProps({ ...app, isAdminUser, endUserRequested: false });\\n\\tconst buttonLabel = button?.label.replace(' ', '_') as\\n\\t\\t| 'Update'\\n\\t\\t| 'Install'\\n\\t\\t| 'Subscribe'\\n\\t\\t| 'See_Pricing'\\n\\t\\t| 'Try_now'\\n\\t\\t| 'Buy'\\n\\t\\t| 'Request'\\n\\t\\t| 'Requested';\\n\\tconst action = button?.action || '';\\n\\n\\tconst setAppStatus = useEndpoint<'POST', '/apps/:id/status'>('POST', '/apps/:id/status', { id: app.id });\\n\\tconst buildExternalUrl = useEndpoint('GET', '/apps');\\n\\tconst syncApp = useEndpoint<'POST', '/apps/:id/sync'>('POST', '/apps/:id/sync', { id: app.id });\\n\\tconst uninstallApp = useEndpoint<'DELETE', '/apps/:id'>('DELETE', '/apps/:id', { id: app.id });\\n\\n\\tconst canAppBeSubscribed = app.purchaseType === 'subscription';\\n\\tconst isSubscribed = app.subscriptionInfo && ['active', 'trialing'].includes(app.subscriptionInfo.status);\\n\\tconst isAppEnabled = app.status ? appEnabledStatuses.includes(app.status) : false;\\n\\n\\tconst closeModal = useCallback(() => {\\n\\t\\tsetModal(null);\\n\\t\\tsetLoading(false);\\n\\t}, [setModal, setLoading]);\\n\\n\\tconst marketplaceActions = useMarketplaceActions();\\n\\n\\tconst installationSuccess = useCallback(\\n\\t\\tasync (action: Actions | '', permissionsGranted) => {\\n\\t\\t\\tif (action) {\\n\\t\\t\\t\\tif (action === 'request') {\\n\\t\\t\\t\\t\\tsetRequestedEndUser(true);\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tawait marketplaceActions[action]({ ...app, permissionsGranted });\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\n\\t\\t\\tsetLoading(false);\\n\\t\\t},\\n\\t\\t[app, marketplaceActions, setLoading],\\n\\t);\\n\\n\\tconst openPermissionModal = useOpenAppPermissionsReviewModal({\\n\\t\\tapp,\\n\\t\\tonCancel: closeModal,\\n\\t\\tonConfirm: (permissionsGranted) => installationSuccess(action, permissionsGranted),\\n\\t});\\n\\n\\tconst appInstallationHandler = useAppInstallationHandler({\\n\\t\\tapp,\\n\\t\\tisAppPurchased,\\n\\t\\taction,\\n\\t\\tonDismiss: closeModal,\\n\\t\\tonSuccess: installationSuccess,\\n\\t\\tsetIsPurchased: setPurchased,\\n\\t});\\n\\n\\t// TODO: There is no necessity of all these callbacks being out of the above useMemo.\\n\\t// My propose here is to refactor the hook to make it clearer and with less unnecessary caching.\\n\\tconst missingAddonHandler = useCallback(\\n\\t\\t(actionType: AddonActionType) => {\\n\\t\\t\\tsetModal(<AddonRequiredModal actionType={actionType} onDismiss={closeModal} onInstallAnyway={appInstallationHandler} />);\\n\\t\\t},\\n\\t\\t[appInstallationHandler, closeModal, setModal],\\n\\t);\\n\\n\\tconst handleAddon = useCallback(\\n\\t\\t(actionType: AddonActionType, callback: () => void) => {\\n\\t\\t\\tif (isAdminUser && appAddon && !workspaceHasAddon) {\\n\\t\\t\\t\\treturn missingAddonHandler(actionType);\\n\\t\\t\\t}\\n\\n\\t\\t\\tcallback();\\n\\t\\t},\\n\\t\\t[appAddon, isAdminUser, missingAddonHandler, workspaceHasAddon],\\n\\t);\\n\\n\\tconst handleAcquireApp = useCallback(() => {\\n\\t\\tsetLoading(true);\\n\\t\\thandleAddon('install', appInstallationHandler);\\n\\t}, [appInstallationHandler, handleAddon]);\\n\\n\\tconst handleSubscription = useCallback(async () => {\\n\\t\\tif (app?.versionIncompatible && !isSubscribed) {\\n\\t\\t\\topenIncompatibleModal(app, 'subscribe', closeModal);\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tlet data;\\n\\t\\ttry {\\n\\t\\t\\tdata = (await buildExternalUrl({\\n\\t\\t\\t\\tbuildExternalUrl: 'true',\\n\\t\\t\\t\\tappId: app.id,\\n\\t\\t\\t\\tpurchaseType: app.purchaseType,\\n\\t\\t\\t\\tdetails: 'true',\\n\\t\\t\\t})) as { url: string };\\n\\t\\t} catch (error) {\\n\\t\\t\\thandleAPIError(error);\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tconst confirm = async () => {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tawait syncApp();\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\thandleAPIError(error);\\n\\t\\t\\t}\\n\\t\\t};\\n\\n\\t\\tsetModal(<IframeModal url={data.url} confirm={confirm} cancel={closeModal} />);\\n\\t}, [app, isSubscribed, setModal, closeModal, openIncompatibleModal, buildExternalUrl, syncApp]);\\n\\n\\tconst handleViewLogs = useCallback(() => {\\n\\t\\trouter.navigate({\\n\\t\\t\\tname: 'marketplace',\\n\\t\\t\\tparams: {\\n\\t\\t\\t\\tcontext,\\n\\t\\t\\t\\tpage: 'info',\\n\\t\\t\\t\\tid: app.id,\\n\\t\\t\\t\\tversion: app.version,\\n\\t\\t\\t\\ttab: 'logs',\\n\\t\\t\\t},\\n\\t\\t});\\n\\t}, [app.id, app.version, context, router]);\\n\\n\\tconst handleDisable = useCallback(() => {\\n\\t\\tconst confirm = async () => {\\n\\t\\t\\tcloseModal();\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tconst { status } = await setAppStatus({ status: AppStatus.MANUALLY_DISABLED });\\n\\t\\t\\t\\twarnEnableDisableApp(app.name, status, 'disable');\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\thandleAPIError(error);\\n\\t\\t\\t}\\n\\t\\t};\\n\\t\\tsetModal(\\n\\t\\t\\t<WarningModal close={closeModal} confirm={confirm} text={t('Apps_Marketplace_Deactivate_App_Prompt')} confirmText={t('Yes')} />,\\n\\t\\t);\\n\\t}, [app.name, closeModal, setAppStatus, setModal, t]);\\n\\n\\tconst handleEnable = useCallback(() => {\\n\\t\\thandleAddon('enable', async () => {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tconst { status } = await setAppStatus({ status: AppStatus.MANUALLY_ENABLED });\\n\\t\\t\\t\\twarnEnableDisableApp(app.name, status, 'enable');\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\thandleAPIError(error);\\n\\t\\t\\t}\\n\\t\\t});\\n\\t}, [app.name, handleAddon, setAppStatus]);\\n\\n\\tconst handleUninstall = useCallback(() => {\\n\\t\\tconst uninstall = async () => {\\n\\t\\t\\tcloseModal();\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tconst { success } = await uninstallApp();\\n\\t\\t\\t\\tif (success) {\\n\\t\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: `${app.name} uninstalled` });\\n\\t\\t\\t\\t\\tif (context === 'details' && currentTab !== 'details') {\\n\\t\\t\\t\\t\\t\\trouter.navigate(\\n\\t\\t\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\t\\t\\tname: 'marketplace',\\n\\t\\t\\t\\t\\t\\t\\t\\tparams: { ...router.getRouteParameters(), tab: 'details' },\\n\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t\\t{ replace: true },\\n\\t\\t\\t\\t\\t\\t);\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\thandleAPIError(error);\\n\\t\\t\\t}\\n\\t\\t};\\n\\n\\t\\tif (isSubscribed) {\\n\\t\\t\\tconst confirm = async () => {\\n\\t\\t\\t\\tawait handleSubscription();\\n\\t\\t\\t};\\n\\n\\t\\t\\tsetModal(\\n\\t\\t\\t\\t<WarningModal\\n\\t\\t\\t\\t\\tclose={closeModal}\\n\\t\\t\\t\\t\\tcancel={uninstall}\\n\\t\\t\\t\\t\\tconfirm={confirm}\\n\\t\\t\\t\\t\\ttext={t('Apps_Marketplace_Uninstall_Subscribed_App_Prompt')}\\n\\t\\t\\t\\t\\tconfirmText={t('Apps_Marketplace_Modify_App_Subscription')}\\n\\t\\t\\t\\t\\tcancelText={t('Apps_Marketplace_Uninstall_Subscribed_App_Anyway')}\\n\\t\\t\\t\\t/>,\\n\\t\\t\\t);\\n\\t\\t}\\n\\n\\t\\tif (!appCountQuery.data) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tif (app.migrated) {\\n\\t\\t\\tsetModal(\\n\\t\\t\\t\\t<UninstallGrandfatheredAppModal\\n\\t\\t\\t\\t\\tcontext={context}\\n\\t\\t\\t\\t\\tappName={app.name}\\n\\t\\t\\t\\t\\tlimit={appCountQuery.data.limit}\\n\\t\\t\\t\\t\\thandleUninstall={uninstall}\\n\\t\\t\\t\\t\\thandleClose={closeModal}\\n\\t\\t\\t\\t/>,\\n\\t\\t\\t);\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tsetModal(\\n\\t\\t\\t<WarningModal close={closeModal} confirm={uninstall} text={t('Apps_Marketplace_Uninstall_App_Prompt')} confirmText={t('Yes')} />,\\n\\t\\t);\\n\\t}, [\\n\\t\\tisSubscribed,\\n\\t\\tappCountQuery.data,\\n\\t\\tapp.migrated,\\n\\t\\tapp.name,\\n\\t\\tsetModal,\\n\\t\\tcloseModal,\\n\\t\\tt,\\n\\t\\tuninstallApp,\\n\\t\\tdispatchToastMessage,\\n\\t\\tcontext,\\n\\t\\tcurrentTab,\\n\\t\\trouter,\\n\\t\\thandleSubscription,\\n\\t]);\\n\\n\\tconst incompatibleIconName = useCallback(\\n\\t\\t(app, action) => {\\n\\t\\t\\tif (!app.versionIncompatible) {\\n\\t\\t\\t\\tif (action === 'update') {\\n\\t\\t\\t\\t\\treturn 'refresh';\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\treturn 'card';\\n\\t\\t\\t}\\n\\n\\t\\t\\t// Now we are handling an incompatible app\\n\\t\\t\\tif (action === 'subscribe' && !isSubscribed) {\\n\\t\\t\\t\\treturn 'warning';\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (action === 'install' || action === 'update') {\\n\\t\\t\\t\\treturn 'warning';\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn 'card';\\n\\t\\t},\\n\\t\\t[isSubscribed],\\n\\t);\\n\\n\\tconst handleUpdate = useCallback(async () => {\\n\\t\\tsetLoading(true);\\n\\n\\t\\tif (app?.versionIncompatible) {\\n\\t\\t\\topenIncompatibleModal(app, 'update', closeModal);\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\topenPermissionModal();\\n\\t}, [app, openPermissionModal, openIncompatibleModal, closeModal]);\\n\\n\\tconst canUpdate = app.installed && app.version && app.marketplaceVersion && semver.lt(app.version, app.marketplaceVersion);\\n\\n\\tconst menuSections = useMemo(() => {\\n\\t\\tconst bothAppStatusOptions = [\\n\\t\\t\\tcanAppBeSubscribed &&\\n\\t\\t\\t\\tisSubscribed &&\\n\\t\\t\\t\\tisAdminUser && {\\n\\t\\t\\t\\t\\tid: 'subscribe',\\n\\t\\t\\t\\t\\tsection: 0,\\n\\t\\t\\t\\t\\tcontent: (\\n\\t\\t\\t\\t\\t\\t<>\\n\\t\\t\\t\\t\\t\\t\\t<Icon name={incompatibleIconName(app, 'subscribe')} size='x16' mie={4} />\\n\\t\\t\\t\\t\\t\\t\\t{t('Subscription')}\\n\\t\\t\\t\\t\\t\\t</>\\n\\t\\t\\t\\t\\t),\\n\\t\\t\\t\\t\\tonClick: handleSubscription,\\n\\t\\t\\t\\t},\\n\\t\\t];\\n\\n\\t\\tconst nonInstalledAppOptions = [\\n\\t\\t\\t!app.installed &&\\n\\t\\t\\t\\t!!button && {\\n\\t\\t\\t\\t\\tid: 'acquire',\\n\\t\\t\\t\\t\\tsection: 0,\\n\\t\\t\\t\\t\\tdisabled: requestedEndUser,\\n\\t\\t\\t\\t\\tcontent: (\\n\\t\\t\\t\\t\\t\\t<>\\n\\t\\t\\t\\t\\t\\t\\t{isAdminUser && <Icon name={incompatibleIconName(app, 'install')} size='x16' mie={4} />}\\n\\t\\t\\t\\t\\t\\t\\t{t(buttonLabel)}\\n\\t\\t\\t\\t\\t\\t</>\\n\\t\\t\\t\\t\\t),\\n\\t\\t\\t\\t\\tonClick: handleAcquireApp,\\n\\t\\t\\t\\t},\\n\\t\\t];\\n\\n\\t\\tconst isEnterpriseOrNot = (app.isEnterpriseOnly && isEnterpriseLicense) || !app.isEnterpriseOnly;\\n\\t\\tconst isPossibleToEnableApp = app.installed && isAdminUser && !isAppEnabled && isEnterpriseOrNot;\\n\\t\\tconst doesItReachedTheLimit =\\n\\t\\t\\t!app.migrated &&\\n\\t\\t\\t!appCountQuery?.data?.hasUnlimitedApps &&\\n\\t\\t\\tappCountQuery?.data?.enabled !== undefined &&\\n\\t\\t\\tappCountQuery?.data?.enabled >= appCountQuery?.data?.limit;\\n\\n\\t\\tconst installedAppOptions = [\\n\\t\\t\\tcontext !== 'details' &&\\n\\t\\t\\t\\tisAdminUser &&\\n\\t\\t\\t\\tapp.installed && {\\n\\t\\t\\t\\t\\tid: 'viewLogs',\\n\\t\\t\\t\\t\\tsection: 0,\\n\\t\\t\\t\\t\\tcontent: (\\n\\t\\t\\t\\t\\t\\t<>\\n\\t\\t\\t\\t\\t\\t\\t<Icon name='desktop-text' size='x16' mie={4} />\\n\\t\\t\\t\\t\\t\\t\\t{t('View_Logs')}\\n\\t\\t\\t\\t\\t\\t</>\\n\\t\\t\\t\\t\\t),\\n\\t\\t\\t\\t\\tonClick: handleViewLogs,\\n\\t\\t\\t\\t},\\n\\t\\t\\tisAdminUser &&\\n\\t\\t\\t\\t!!canUpdate &&\\n\\t\\t\\t\\t!isAppDetailsPage && {\\n\\t\\t\\t\\t\\tid: 'update',\\n\\t\\t\\t\\t\\tsection: 0,\\n\\t\\t\\t\\t\\tcontent: (\\n\\t\\t\\t\\t\\t\\t<>\\n\\t\\t\\t\\t\\t\\t\\t<Icon name={incompatibleIconName(app, 'update')} size='x16' mie={4} />\\n\\t\\t\\t\\t\\t\\t\\t{t('Update')}\\n\\t\\t\\t\\t\\t\\t</>\\n\\t\\t\\t\\t\\t),\\n\\t\\t\\t\\t\\tonClick: handleUpdate,\\n\\t\\t\\t\\t},\\n\\t\\t\\tapp.installed &&\\n\\t\\t\\t\\tisAdminUser &&\\n\\t\\t\\t\\tisAppEnabled && {\\n\\t\\t\\t\\t\\tid: 'disable',\\n\\t\\t\\t\\t\\tsection: 0,\\n\\t\\t\\t\\t\\tcontent: (\\n\\t\\t\\t\\t\\t\\t<Box color='status-font-on-warning'>\\n\\t\\t\\t\\t\\t\\t\\t<Icon name='ban' size='x16' mie={4} />\\n\\t\\t\\t\\t\\t\\t\\t{t('Disable')}\\n\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t),\\n\\t\\t\\t\\t\\tonClick: handleDisable,\\n\\t\\t\\t\\t},\\n\\t\\t\\tisPossibleToEnableApp && {\\n\\t\\t\\t\\tid: 'enable',\\n\\t\\t\\t\\tsection: 0,\\n\\t\\t\\t\\tdisabled: doesItReachedTheLimit,\\n\\t\\t\\t\\tcontent: (\\n\\t\\t\\t\\t\\t<>\\n\\t\\t\\t\\t\\t\\t<Icon name='check' size='x16' marginInlineEnd='x4' />\\n\\t\\t\\t\\t\\t\\t{t('Enable')}\\n\\t\\t\\t\\t\\t</>\\n\\t\\t\\t\\t),\\n\\t\\t\\t\\tonClick: handleEnable,\\n\\t\\t\\t},\\n\\t\\t\\tapp.installed &&\\n\\t\\t\\t\\tisAdminUser && {\\n\\t\\t\\t\\t\\tid: 'uninstall',\\n\\t\\t\\t\\t\\tsection: 1,\\n\\t\\t\\t\\t\\tcontent: (\\n\\t\\t\\t\\t\\t\\t<Box color='status-font-on-danger'>\\n\\t\\t\\t\\t\\t\\t\\t<Icon name='trash' size='x16' mie={4} />\\n\\t\\t\\t\\t\\t\\t\\t{t('Uninstall')}\\n\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t),\\n\\t\\t\\t\\t\\tonClick: handleUninstall,\\n\\t\\t\\t\\t},\\n\\t\\t];\\n\\n\\t\\tconst filtered = [...bothAppStatusOptions, ...nonInstalledAppOptions, ...installedAppOptions].flatMap((value) =>\\n\\t\\t\\tvalue && typeof value !== 'boolean' ? value : [],\\n\\t\\t);\\n\\n\\t\\tconst sections: AppMenuSections = [];\\n\\n\\t\\tfiltered.forEach((option) => {\\n\\t\\t\\tif (typeof sections[option.section] === 'undefined') {\\n\\t\\t\\t\\tsections[option.section] = { items: [] };\\n\\t\\t\\t}\\n\\n\\t\\t\\tsections[option.section].items.push(option);\\n\\t\\t});\\n\\n\\t\\treturn sections;\\n\\t}, [\\n\\t\\tcanAppBeSubscribed,\\n\\t\\tisSubscribed,\\n\\t\\tisAdminUser,\\n\\t\\tincompatibleIconName,\\n\\t\\tapp,\\n\\t\\tt,\\n\\t\\thandleSubscription,\\n\\t\\tbutton,\\n\\t\\trequestedEndUser,\\n\\t\\tbuttonLabel,\\n\\t\\thandleAcquireApp,\\n\\t\\tisEnterpriseLicense,\\n\\t\\tisAppEnabled,\\n\\t\\tappCountQuery?.data?.hasUnlimitedApps,\\n\\t\\tappCountQuery?.data?.enabled,\\n\\t\\tappCountQuery?.data?.limit,\\n\\t\\tcontext,\\n\\t\\thandleViewLogs,\\n\\t\\tcanUpdate,\\n\\t\\tisAppDetailsPage,\\n\\t\\thandleUpdate,\\n\\t\\thandleDisable,\\n\\t\\thandleEnable,\\n\\t\\thandleUninstall,\\n\\t]);\\n\\n\\treturn { isLoading, isAdminUser, sections: menuSections };\\n};\\n\",null],\"names\":[\"_objectSpread\",\"AppStatus\",\"Box\",\"Icon\",\"useSetModal\",\"useEndpoint\",\"useTranslation\",\"useRouteParameter\",\"useToastMessageDispatch\",\"usePermission\",\"useRouter\",\"React\",\"useMemo\",\"useCallback\",\"useState\",\"semver\",\"WarningModal\",\"useHasLicenseModule\",\"useIsEnterprise\",\"AddonRequiredModal\",\"IframeModal\",\"UninstallGrandfatheredAppModal\",\"appEnabledStatuses\",\"appButtonProps\",\"handleAPIError\",\"warnEnableDisableApp\",\"useAppInstallationHandler\",\"useAppsCountQuery\",\"useMarketplaceActions\",\"useOpenAppPermissionsReviewModal\",\"useOpenIncompatibleModal\",\"module\",\"link\",\"default\",\"v\",\"export\",\"useAppMenu\",\"app\",\"isAppDetailsPage\",\"_appCountQuery$data5\",\"_appCountQuery$data6\",\"_appCountQuery$data7\",\"t\",\"router\",\"setModal\",\"dispatchToastMessage\",\"openIncompatibleModal\",\"context\",\"currentTab\",\"appCountQuery\",\"isAdminUser\",\"data\",\"isEnterpriseLicense\",\"isEnterprise\",\"appAddon\",\"addon\",\"workspaceHasAddon\",\"isLoading\",\"setLoading\",\"requestedEndUser\",\"setRequestedEndUser\",\"isAppPurchased\",\"setPurchased\",\"isPurchased\",\"button\",\"endUserRequested\",\"buttonLabel\",\"label\",\"replace\",\"action\",\"setAppStatus\",\"id\",\"buildExternalUrl\",\"syncApp\",\"uninstallApp\",\"canAppBeSubscribed\",\"purchaseType\",\"isSubscribed\",\"subscriptionInfo\",\"includes\",\"status\",\"isAppEnabled\",\"closeModal\",\"marketplaceActions\",\"installationSuccess\",\"permissionsGranted\",\"openPermissionModal\",\"onCancel\",\"onConfirm\",\"appInstallationHandler\",\"onDismiss\",\"onSuccess\",\"setIsPurchased\",\"missingAddonHandler\",\"actionType\",\"createElement\",\"onInstallAnyway\",\"handleAddon\",\"callback\",\"handleAcquireApp\",\"handleSubscription\",\"versionIncompatible\",\"appId\",\"details\",\"error\",\"confirm\",\"url\",\"cancel\",\"handleViewLogs\",\"navigate\",\"name\",\"params\",\"page\",\"version\",\"tab\",\"handleDisable\",\"MANUALLY_DISABLED\",\"close\",\"text\",\"confirmText\",\"handleEnable\",\"MANUALLY_ENABLED\",\"handleUninstall\",\"uninstall\",\"success\",\"type\",\"message\",\"concat\",\"getRouteParameters\",\"cancelText\",\"migrated\",\"appName\",\"limit\",\"handleClose\",\"incompatibleIconName\",\"handleUpdate\",\"canUpdate\",\"installed\",\"marketplaceVersion\",\"lt\",\"menuSections\",\"_appCountQuery$data\",\"_appCountQuery$data2\",\"_appCountQuery$data3\",\"_appCountQuery$data4\",\"bothAppStatusOptions\",\"section\",\"content\",\"Fragment\",\"size\",\"mie\",\"onClick\",\"nonInstalledAppOptions\",\"disabled\",\"isEnterpriseOrNot\",\"isEnterpriseOnly\",\"isPossibleToEnableApp\",\"doesItReachedTheLimit\",\"hasUnlimitedApps\",\"enabled\",\"undefined\",\"installedAppOptions\",\"color\",\"marginInlineEnd\",\"filtered\",\"flatMap\",\"value\",\"sections\",\"forEach\",\"option\",\"items\",\"push\"],\"mappings\":\"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\"}"}