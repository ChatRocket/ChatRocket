{"code":"function module(e,l,n){let t,i,u,r,o;n.export({useFileUploadAction:()=>c}),n.link(\"@rocket.chat/ui-contexts\",{useTranslation(e){t=e},useSetting(e){i=e}},0),n.link(\"react\",{useEffect(e){u=e}},1),n.link(\"../../../../../../hooks/useFileInput\",{useFileInput(e){r=e}},2),n.link(\"../../../../contexts/ChatContext\",{useChat(e){o=e}},3);let a={type:\"file\",multiple:!0},c=e=>{let l=t(),c=i(\"FileUpload_Enabled\"),d=r(a),s=o();return u(()=>{var e;let l=()=>{null!=d&&d.current&&(d.current.value=\"\")},t=async()=>{var e,t;let{getMimeType:i}=await n.dynamicImport(\"../../../../../../../app/utils/lib/mimeTypes\"),u=Array.from(null!==(e=null==d?void 0:null===(t=d.current)||void 0===t?void 0:t.files)&&void 0!==e?e:[]).map(e=>(Object.defineProperty(e,\"type\",{value:i(e.type,e.name)}),e));null==s||s.flows.uploadFiles(u,l)};return null===(e=d.current)||void 0===e||e.addEventListener(\"change\",t),()=>{var e;return null==d?void 0:null===(e=d.current)||void 0===e?void 0:e.removeEventListener(\"change\",t)}},[s,d]),{id:\"file-upload\",content:l(\"Upload_file\"),icon:\"clip\",onClick:()=>{var e;null==d||null===(e=d.current)||void 0===e||e.click()},disabled:!c||e}}}","map":"{\"version\":3,\"sources\":[\"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useFileUploadAction.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { GenericMenuItemProps } from '@rocket.chat/ui-client';\\nimport { useTranslation, useSetting } from '@rocket.chat/ui-contexts';\\nimport { useEffect } from 'react';\\n\\nimport { useFileInput } from '../../../../../../hooks/useFileInput';\\nimport { useChat } from '../../../../contexts/ChatContext';\\n\\nconst fileInputProps = { type: 'file', multiple: true };\\n\\nexport const useFileUploadAction = (disabled: boolean): GenericMenuItemProps => {\\n\\tconst t = useTranslation();\\n\\tconst fileUploadEnabled = useSetting<boolean>('FileUpload_Enabled');\\n\\tconst fileInputRef = useFileInput(fileInputProps);\\n\\tconst chat = useChat();\\n\\n\\tuseEffect(() => {\\n\\t\\tconst resetFileInput = () => {\\n\\t\\t\\tif (!fileInputRef?.current) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tfileInputRef.current.value = '';\\n\\t\\t};\\n\\n\\t\\tconst handleUploadChange = async () => {\\n\\t\\t\\tconst { getMimeType } = await import('../../../../../../../app/utils/lib/mimeTypes');\\n\\t\\t\\tconst filesToUpload = Array.from(fileInputRef?.current?.files ?? []).map((file) => {\\n\\t\\t\\t\\tObject.defineProperty(file, 'type', {\\n\\t\\t\\t\\t\\tvalue: getMimeType(file.type, file.name),\\n\\t\\t\\t\\t});\\n\\t\\t\\t\\treturn file;\\n\\t\\t\\t});\\n\\t\\t\\tchat?.flows.uploadFiles(filesToUpload, resetFileInput);\\n\\t\\t};\\n\\n\\t\\tfileInputRef.current?.addEventListener('change', handleUploadChange);\\n\\t\\treturn () => fileInputRef?.current?.removeEventListener('change', handleUploadChange);\\n\\t}, [chat, fileInputRef]);\\n\\n\\tconst handleUpload = () => {\\n\\t\\tfileInputRef?.current?.click();\\n\\t};\\n\\n\\treturn {\\n\\t\\tid: 'file-upload',\\n\\t\\tcontent: t('Upload_file'),\\n\\t\\ticon: 'clip',\\n\\t\\tonClick: handleUpload,\\n\\t\\tdisabled: !fileUploadEnabled || disabled,\\n\\t};\\n};\\n\",null],\"names\":[\"useTranslation\",\"useSetting\",\"useEffect\",\"useFileInput\",\"useChat\",\"module\",\"export\",\"useFileUploadAction\",\"link\",\"v\",\"fileInputProps\",\"type\",\"multiple\",\"disabled\",\"t\",\"fileUploadEnabled\",\"fileInputRef\",\"chat\",\"_fileInputRef$current3\",\"resetFileInput\",\"current\",\"value\",\"handleUploadChange\",\"_fileInputRef$current\",\"_fileInputRef$current2\",\"getMimeType\",\"dynamicImport\",\"filesToUpload\",\"Array\",\"from\",\"files\",\"map\",\"file\",\"Object\",\"defineProperty\",\"name\",\"flows\",\"uploadFiles\",\"addEventListener\",\"_fileInputRef$current4\",\"removeEventListener\",\"id\",\"content\",\"icon\",\"onClick\",\"handleUpload\",\"_fileInputRef$current5\",\"click\"],\"mappings\":\"2BAC2CA,EAA2BC,EAAAC,EAAAC,EAAAC,EAAtEC,EAAOC,MAAE,CAAA,CAAAC,oBAA0BA,IAAEA,CAAM,GAA2BF,EAAAG,IAAA,CAAA,2BAAA,CAAAR,eAAAS,CAAA,EAAAT,EAAAS,CAAA,EAAAR,WAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,QAAA,CAAAN,UAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,uCAAA,CAAAL,aAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,mCAAA,CAAAJ,QAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAMtE,IAAMC,EAAiB,CAAEC,KAAM,OAAQC,SAAU,CAAA,CAAI,EAExCL,EAAuBM,IACnC,IAAMC,EAAId,IACJe,EAAoBd,EAAoB,sBACxCe,EAAeb,EAAaO,GAC5BO,EAAOb,WAEbF,EAAU,KAAK,IAAAgB,EACd,IAAMC,EAAiBA,WACjBH,GAAAA,EAAcI,OAAO,EAI1BJ,CAAAA,EAAaI,OAAO,CAACC,KAAK,CAAG,EAAA,CAC9B,EAEMC,EAAqB,UAAW,IAAAC,EAAAC,EACrC,GAAM,CAAEC,YAAAA,CAAAA,CAAa,CAAG,MAAMpB,EAAAqB,aAAA,CAAO,gDAC/BC,EAAgBC,MAAMC,IAAI,CAAA,AAA6B,OAA7BN,CAAAA,EAACP,MAAAA,EAAY,KAAA,EAAA,AAAS,OAATQ,CAAAA,EAAZR,EAAcI,OAAO,AAAPA,GAAOI,AAAA,KAAA,IAAAA,EAAA,KAAA,EAArBA,EAAuBM,KAAK,AAALA,GAAKP,AAAA,KAAA,IAAAA,EAAAA,EAAI,EAAE,EAAEQ,GAAG,CAAEC,IACzEC,OAAOC,cAAc,CAACF,EAAM,OAAQ,CACnCX,MAAOI,EAAYO,EAAKrB,IAAI,CAAEqB,EAAKG,IAAI,IAEjCH,GAERf,OAAAA,GAAAA,EAAMmB,KAAK,CAACC,WAAW,CAACV,EAAeR,EACxC,EAGA,OADA,AAAoB,OAApBD,CAAAA,EAAAF,EAAaI,OAAO,AAAPA,GAAOF,AAAA,KAAA,IAAAA,GAApBA,EAAsBoB,gBAAgB,CAAC,SAAUhB,GAC1C,KAAA,IAAAiB,EAAA,OAAMvB,MAAAA,EAAY,KAAA,EAAA,AAAS,OAATuB,CAAAA,EAAZvB,EAAcI,OAAO,AAAPA,GAAOmB,AAAA,KAAA,IAAAA,EAAA,KAAA,EAArBA,EAAuBC,mBAAmB,CAAC,SAAUlB,EAAmB,CACtF,EAAG,CAACL,EAAMD,EAAa,EAMhB,CACNyB,GAAI,cACJC,QAAS5B,EAAE,eACX6B,KAAM,OACNC,QARoBC,KAAK,IAAAC,CACzB9B,OAAAA,GAAY,AAAS,OAAT8B,CAAAA,EAAZ9B,EAAcI,OAAO,AAAPA,GAAO0B,AAAA,KAAA,IAAAA,GAArBA,EAAuBC,KAAK,EAC7B,EAOClC,SAAU,CAACE,GAAqBF,EAElC\"}"}