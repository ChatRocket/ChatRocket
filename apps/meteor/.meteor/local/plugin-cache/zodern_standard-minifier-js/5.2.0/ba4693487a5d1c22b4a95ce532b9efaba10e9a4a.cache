{"code":"function module(n,e,o){o.link(\"@rocket.chat/fuselage\",{Box:function(n){t=n}},0),o.link(\"react\",{default:function(n){r=n},useCallback:function(n){u=n},useEffect:function(n){i=n},useRef:function(n){c=n}},1);var t,r,u,i,c,a=function(n){i(function(){var e=function(e){\"Escape\"===e.key&&(e.stopPropagation(),null==n||n())};return window.addEventListener(\"keydown\",e),function(){window.removeEventListener(\"keydown\",e)}},[n])},l=function(n,e){var o,t=e.current,r=n.target.parentElement;return null!==(o=!!r&&(null==t?void 0:t.contains(r)))&&void 0!==o&&o},f=function(n,e){var o=c(!1);return{onMouseDown:u(function(e){if(l(e,n)){o.current=!1;return}o.current=!0},[n]),onMouseUp:u(function(t){if(l(t,n)){o.current=!1;return}o.current&&(o.current=!1,t.stopPropagation(),null==e||e())},[e,n])}};o.exportDefault(function(n){var e=n.children,o=n.onDismiss,u=c(null);a(o);var i=f(u,o),l=i.onMouseDown,s=i.onMouseUp;return r.createElement(t,{ref:u,children:e,className:\"rcx-modal__backdrop\",position:\"fixed\",zIndex:9999,inset:0,display:\"flex\",flexDirection:\"column\",onMouseDown:l,onMouseUp:s})})}","map":"{\"version\":3,\"sources\":[\"client/components/ModalBackdrop.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Box } from '@rocket.chat/fuselage';\\nimport type { MouseEvent, ReactElement, ReactNode, RefObject } from 'react';\\nimport React, { useCallback, useEffect, useRef } from 'react';\\n\\nconst useEscapeKey = (onDismiss: (() => void) | undefined): void => {\\n\\tuseEffect(() => {\\n\\t\\tconst closeOnEsc = (e: KeyboardEvent): void => {\\n\\t\\t\\tif (e.key !== 'Escape') {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\te.stopPropagation();\\n\\t\\t\\tonDismiss?.();\\n\\t\\t};\\n\\n\\t\\twindow.addEventListener('keydown', closeOnEsc);\\n\\n\\t\\treturn (): void => {\\n\\t\\t\\twindow.removeEventListener('keydown', closeOnEsc);\\n\\t\\t};\\n\\t}, [onDismiss]);\\n};\\n\\nconst isAtBackdropChildren = (e: MouseEvent, ref: RefObject<HTMLElement>): boolean => {\\n\\tconst backdrop = ref.current;\\n\\tconst { parentElement } = e.target as HTMLElement;\\n\\n\\treturn (Boolean(parentElement) && backdrop?.contains(parentElement)) ?? false;\\n};\\n\\nconst useOutsideClick = (\\n\\tref: RefObject<HTMLElement>,\\n\\tonDismiss: (() => void) | undefined,\\n): {\\n\\tonMouseDown: (e: MouseEvent) => void;\\n\\tonMouseUp: (e: MouseEvent) => void;\\n} => {\\n\\tconst hasClicked = useRef<boolean>(false);\\n\\n\\tconst onMouseDown = useCallback(\\n\\t\\t(e) => {\\n\\t\\t\\tif (isAtBackdropChildren(e, ref)) {\\n\\t\\t\\t\\thasClicked.current = false;\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\thasClicked.current = true;\\n\\t\\t},\\n\\t\\t[ref],\\n\\t);\\n\\n\\tconst onMouseUp = useCallback(\\n\\t\\t(e: MouseEvent) => {\\n\\t\\t\\tif (isAtBackdropChildren(e, ref)) {\\n\\t\\t\\t\\thasClicked.current = false;\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (!hasClicked.current) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\thasClicked.current = false;\\n\\t\\t\\te.stopPropagation();\\n\\t\\t\\tonDismiss?.();\\n\\t\\t},\\n\\t\\t[onDismiss, ref],\\n\\t);\\n\\n\\treturn {\\n\\t\\tonMouseDown,\\n\\t\\tonMouseUp,\\n\\t};\\n};\\n\\ntype ModalBackdropProps = {\\n\\tchildren?: ReactNode;\\n\\tonDismiss?: () => void;\\n};\\n\\nconst ModalBackdrop = ({ children, onDismiss }: ModalBackdropProps): ReactElement => {\\n\\tconst ref = useRef<HTMLDivElement>(null);\\n\\n\\tuseEscapeKey(onDismiss);\\n\\tconst { onMouseDown, onMouseUp } = useOutsideClick(ref, onDismiss);\\n\\n\\treturn (\\n\\t\\t<Box\\n\\t\\t\\tref={ref}\\n\\t\\t\\tchildren={children}\\n\\t\\t\\tclassName='rcx-modal__backdrop'\\n\\t\\t\\tposition='fixed'\\n\\t\\t\\tzIndex={9999}\\n\\t\\t\\tinset={0}\\n\\t\\t\\tdisplay='flex'\\n\\t\\t\\tflexDirection='column'\\n\\t\\t\\tonMouseDown={onMouseDown}\\n\\t\\t\\tonMouseUp={onMouseUp}\\n\\t\\t/>\\n\\t);\\n};\\n\\nexport default ModalBackdrop;\\n\",null],\"names\":[\"module\",\"link\",\"Box\",\"v\",\"React\",\"useCallback\",\"useEffect\",\"useRef\",\"useEscapeKey\",\"onDismiss\",\"closeOnEsc\",\"e\",\"key\",\"stopPropagation\",\"window\",\"addEventListener\",\"removeEventListener\",\"isAtBackdropChildren\",\"ref\",\"_ref\",\"backdrop\",\"current\",\"parentElement\",\"target\",\"Boolean\",\"contains\",\"useOutsideClick\",\"hasClicked\",\"onMouseDown\",\"onMouseUp\",\"exportDefault\",\"_ref2\",\"children\",\"_useOutsideClick\",\"createElement\",\"className\",\"position\",\"zIndex\",\"inset\",\"display\",\"flexDirection\"],\"mappings\":\"uBAAOA,EAAOC,IAAA,CAAM,wBAAwB,CAAAC,IAAA,SAAAC,CAAA,EAAAD,EAAAC,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAA,QAAA,SAAAE,CAAA,EAAAC,EAAAD,CAAA,EAAAE,YAAA,SAAAF,CAAA,EAAAE,EAAAF,CAAA,EAAAG,UAAA,SAAAH,CAAA,EAAAG,EAAAH,CAAA,EAAAI,OAAA,SAAAJ,CAAA,EAAAI,EAAAJ,CAAA,CAAA,EAAA,GAI5C,IAJAD,EAA4CE,EAAAC,EAAAC,EAAAC,EAItCC,EAAe,SAACC,CAAmC,EACxDH,EAAU,WACT,IAAMI,EAAa,SAACC,CAAgB,EACrB,WAAVA,EAAEC,GAAG,GAITD,EAAEE,eAAe,GACjBJ,MAAAA,GAAAA,IACD,EAIA,OAFAK,OAAOC,gBAAgB,CAAC,UAAWL,GAE5B,WACNI,OAAOE,mBAAmB,CAAC,UAAWN,EACvC,CACD,EAAG,CAACD,EAAU,CACf,EAEMQ,EAAuB,SAACN,CAAa,CAAEO,CAA2B,EACvE,IADoFC,EAC9EC,EAAWF,EAAIG,OAAO,CACpBC,EAAkBX,EAAEY,MAAqB,CAAzCD,aAAa,CAErB,OAAA,AAAmE,OAAnEH,CAAAA,EAAQK,CAAAA,CAAQF,GAAkBF,CAAAA,MAAAA,EAAQ,KAAA,EAARA,EAAUK,QAAQ,CAACH,EAAa,CAAC,GAAAH,AAAA,KAAA,IAAAA,GAAAA,CACpE,EAEMO,EAAkB,SACvBR,CAA2B,CAC3BT,CAAmC,EAKnC,IAAMkB,EAAapB,EAAgB,CAAA,GAgCnC,MAAO,CACNqB,YA/BmBvB,EACnB,SAACM,CAAC,EACD,GAAIM,EAAqBN,EAAGO,GAAM,CACjCS,EAAWN,OAAO,CAAG,CAAA,EACrB,MACD,CAEAM,EAAWN,OAAO,CAAG,CAAA,CACtB,EACA,CAACH,EAAI,EAuBLW,UApBiBxB,EACjB,SAACM,CAAa,EACb,GAAIM,EAAqBN,EAAGO,GAAM,CACjCS,EAAWN,OAAO,CAAG,CAAA,EACrB,MACD,CAEKM,EAAWN,OAAO,GAIvBM,EAAWN,OAAO,CAAG,CAAA,EACrBV,EAAEE,eAAe,GACjBJ,MAAAA,GAAAA,IACD,EACA,CAACA,EAAWS,EAAI,EAOlB,EAzEAlB,EAAO8B,aAAa,CAgFE,SAAAC,CAAA,EAA8D,IAA3DC,EAAQD,EAARC,QAAQ,CAAEvB,EAASsB,EAATtB,SAAS,CACrCS,EAAMX,EAAuB,MAEnCC,EAAaC,GACb,IAAAwB,EAAmCP,EAAgBR,EAAKT,GAAhDmB,EAAWK,EAAXL,WAAW,CAAEC,EAASI,EAATJ,SAAS,CAE9B,OACCzB,EAAA8B,aAAA,CAAChC,EAAG,CACHgB,IAAKA,EACLc,SAAUA,EACVG,UAAU,sBACVC,SAAS,QACTC,OAAQ,KACRC,MAAO,EACPC,QAAQ,OACRC,cAAc,SACdZ,YAAaA,EACbC,UAAWA,CAAU,EAGxB\"}"}