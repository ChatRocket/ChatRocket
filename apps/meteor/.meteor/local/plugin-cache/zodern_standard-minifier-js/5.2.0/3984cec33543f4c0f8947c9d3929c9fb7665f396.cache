{"code":"function module(e,l,t){let n,r,a,i,o,u,c,m,d,s,E,b,f,p,v,k;let _=[\"email\",\"room\",\"onRequest\",\"onSend\",\"onCancel\",\"onDiscard\"];t.link(\"@babel/runtime/helpers/extends\",{default(e){n=e}},0),t.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default(e){r=e}},1),t.link(\"@rocket.chat/fuselage\",{Field(e){a=e},Button(e){i=e},TextInput(e){o=e},Modal(e){u=e},Box(e){c=e},FieldGroup(e){m=e},FieldLabel(e){d=e},FieldRow(e){s=e},FieldError(e){E=e}},0),t.link(\"react\",{default(e){b=e},useCallback(e){f=e},useEffect(e){p=e}},1),t.link(\"react-hook-form\",{useForm(e){v=e}},2),t.link(\"react-i18next\",{useTranslation(e){k=e}},3),t.exportDefault(e=>{var l,t,g,j,q;let{email:C=\"\",room:F,onRequest:h,onSend:x,onCancel:S,onDiscard:w}=e,y=r(e,_),{t:R}=k(),{register:T,handleSubmit:G,setValue:B,setFocus:D,formState:{errors:I,isSubmitting:L}}=v({defaultValues:{email:C||\"\",subject:R(\"Transcript_of_your_livechat_conversation\")}});p(()=>{D(\"subject\")},[D]);let{transcriptRequest:H}=F,M=null==F?void 0:F.open,P=null==F?void 0:null===(l=F.v)||void 0===l?void 0:l.token,U=f(()=>w(),[w]),V=f(e=>{let{email:l,subject:t}=e;M&&!H&&h(l,t),!M&&x&&P&&x(l,t,P)},[h,x,M,P,H]);return p(()=>{H&&(B(\"email\",H.email),B(\"subject\",H.subject))},[B,H]),b.createElement(u,n({open:!0,wrapperFunction:e=>b.createElement(c,n({is:\"form\",onSubmit:G(V)},e))},y),b.createElement(u.Header,null,b.createElement(u.Icon,{name:\"mail-arrow-top-right\"}),b.createElement(u.Title,null,R(\"Transcript\")),b.createElement(u.Close,{onClick:S})),b.createElement(u.Content,{fontScale:\"p2\"},!!H&&b.createElement(\"p\",null,R(\"Livechat_transcript_already_requested_warning\")),b.createElement(m,null,b.createElement(a,null,b.createElement(d,null,R(\"Email\"),\"*\"),b.createElement(s,null,b.createElement(o,n({disabled:!!C||!!H,error:null===(t=I.email)||void 0===t?void 0:t.message,flexGrow:1},T(\"email\",{required:R(\"Required_field\",{field:R(\"Email\")})})))),b.createElement(E,null,null===(g=I.email)||void 0===g?void 0:g.message)),b.createElement(a,null,b.createElement(d,null,R(\"Subject\"),\"*\"),b.createElement(s,null,b.createElement(o,n({disabled:!!H,error:null===(j=I.subject)||void 0===j?void 0:j.message,flexGrow:1},T(\"subject\",{required:R(\"Required_field\",{field:R(\"Subject\")})})))),b.createElement(E,null,null===(q=I.subject)||void 0===q?void 0:q.message)))),b.createElement(u.Footer,null,b.createElement(u.FooterControllers,null,b.createElement(i,{onClick:S},R(\"Cancel\")),M&&H&&b.createElement(i,{danger:!0,onClick:U},R(\"Undo_request\")),M&&!H&&b.createElement(i,{\"aria-label\":\"request-button\",disabled:L,loading:L,primary:!0,type:\"submit\"},R(\"Request\")),!M&&b.createElement(i,{\"aria-label\":\"send-button\",disabled:L,loading:L,primary:!0,type:\"submit\"},R(\"Send\")))))})}","map":"{\"version\":3,\"sources\":[\"client/components/Omnichannel/modals/TranscriptModal.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IOmnichannelRoom } from '@rocket.chat/core-typings';\\nimport { Field, Button, TextInput, Modal, Box, FieldGroup, FieldLabel, FieldRow, FieldError } from '@rocket.chat/fuselage';\\nimport React, { useCallback, useEffect } from 'react';\\nimport { useForm } from 'react-hook-form';\\nimport { useTranslation } from 'react-i18next';\\n\\ntype TranscriptModalProps = {\\n\\temail: string;\\n\\troom: IOmnichannelRoom;\\n\\tonRequest: (email: string, subject: string) => void;\\n\\tonSend?: (email: string, subject: string, token: string) => void;\\n\\tonCancel: () => void;\\n\\tonDiscard: () => void;\\n};\\n\\nconst TranscriptModal = ({ email: emailDefault = '', room, onRequest, onSend, onCancel, onDiscard, ...props }: TranscriptModalProps) => {\\n\\tconst { t } = useTranslation();\\n\\n\\tconst {\\n\\t\\tregister,\\n\\t\\thandleSubmit,\\n\\t\\tsetValue,\\n\\t\\tsetFocus,\\n\\t\\tformState: { errors, isSubmitting },\\n\\t} = useForm({\\n\\t\\tdefaultValues: { email: emailDefault || '', subject: t('Transcript_of_your_livechat_conversation') },\\n\\t});\\n\\n\\tuseEffect(() => {\\n\\t\\tsetFocus('subject');\\n\\t}, [setFocus]);\\n\\n\\tconst { transcriptRequest } = room;\\n\\tconst roomOpen = room?.open;\\n\\tconst token = room?.v?.token;\\n\\n\\tconst handleDiscard = useCallback(() => onDiscard(), [onDiscard]);\\n\\n\\tconst submit = useCallback(\\n\\t\\t({ email, subject }: { email: string; subject: string }) => {\\n\\t\\t\\tif (roomOpen && !transcriptRequest) {\\n\\t\\t\\t\\tonRequest(email, subject);\\n\\t\\t\\t}\\n\\t\\t\\tif (!roomOpen && onSend && token) {\\n\\t\\t\\t\\tonSend(email, subject, token);\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t[onRequest, onSend, roomOpen, token, transcriptRequest],\\n\\t);\\n\\n\\tuseEffect(() => {\\n\\t\\tif (transcriptRequest) {\\n\\t\\t\\tsetValue('email', transcriptRequest.email);\\n\\t\\t\\tsetValue('subject', transcriptRequest.subject);\\n\\t\\t}\\n\\t}, [setValue, transcriptRequest]);\\n\\n\\t// const canSubmit = isValid && Boolean(watch('subject'));\\n\\n\\treturn (\\n\\t\\t<Modal open wrapperFunction={(props) => <Box is='form' onSubmit={handleSubmit(submit)} {...props} />} {...props}>\\n\\t\\t\\t<Modal.Header>\\n\\t\\t\\t\\t<Modal.Icon name='mail-arrow-top-right' />\\n\\t\\t\\t\\t<Modal.Title>{t('Transcript')}</Modal.Title>\\n\\t\\t\\t\\t<Modal.Close onClick={onCancel} />\\n\\t\\t\\t</Modal.Header>\\n\\t\\t\\t<Modal.Content fontScale='p2'>\\n\\t\\t\\t\\t{!!transcriptRequest && <p>{t('Livechat_transcript_already_requested_warning')}</p>}\\n\\t\\t\\t\\t<FieldGroup>\\n\\t\\t\\t\\t\\t<Field>\\n\\t\\t\\t\\t\\t\\t<FieldLabel>{t('Email')}*</FieldLabel>\\n\\t\\t\\t\\t\\t\\t<FieldRow>\\n\\t\\t\\t\\t\\t\\t\\t<TextInput\\n\\t\\t\\t\\t\\t\\t\\t\\tdisabled={!!emailDefault || !!transcriptRequest}\\n\\t\\t\\t\\t\\t\\t\\t\\terror={errors.email?.message}\\n\\t\\t\\t\\t\\t\\t\\t\\tflexGrow={1}\\n\\t\\t\\t\\t\\t\\t\\t\\t{...register('email', { required: t('Required_field', { field: t('Email') }) })}\\n\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t\\t\\t\\t<FieldError>{errors.email?.message}</FieldError>\\n\\t\\t\\t\\t\\t</Field>\\n\\t\\t\\t\\t\\t<Field>\\n\\t\\t\\t\\t\\t\\t<FieldLabel>{t('Subject')}*</FieldLabel>\\n\\t\\t\\t\\t\\t\\t<FieldRow>\\n\\t\\t\\t\\t\\t\\t\\t<TextInput\\n\\t\\t\\t\\t\\t\\t\\t\\tdisabled={!!transcriptRequest}\\n\\t\\t\\t\\t\\t\\t\\t\\terror={errors.subject?.message}\\n\\t\\t\\t\\t\\t\\t\\t\\tflexGrow={1}\\n\\t\\t\\t\\t\\t\\t\\t\\t{...register('subject', { required: t('Required_field', { field: t('Subject') }) })}\\n\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t\\t\\t\\t<FieldError>{errors.subject?.message}</FieldError>\\n\\t\\t\\t\\t\\t</Field>\\n\\t\\t\\t\\t</FieldGroup>\\n\\t\\t\\t</Modal.Content>\\n\\t\\t\\t<Modal.Footer>\\n\\t\\t\\t\\t<Modal.FooterControllers>\\n\\t\\t\\t\\t\\t<Button onClick={onCancel}>{t('Cancel')}</Button>\\n\\t\\t\\t\\t\\t{roomOpen && transcriptRequest && (\\n\\t\\t\\t\\t\\t\\t<Button danger onClick={handleDiscard}>\\n\\t\\t\\t\\t\\t\\t\\t{t('Undo_request')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t{roomOpen && !transcriptRequest && (\\n\\t\\t\\t\\t\\t\\t<Button aria-label='request-button' disabled={isSubmitting} loading={isSubmitting} primary type='submit'>\\n\\t\\t\\t\\t\\t\\t\\t{t('Request')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t{!roomOpen && (\\n\\t\\t\\t\\t\\t\\t<Button aria-label='send-button' disabled={isSubmitting} loading={isSubmitting} primary type='submit'>\\n\\t\\t\\t\\t\\t\\t\\t{t('Send')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t</Modal.FooterControllers>\\n\\t\\t\\t</Modal.Footer>\\n\\t\\t</Modal>\\n\\t);\\n};\\n\\nexport default TranscriptModal;\\n\",null],\"names\":[\"_extends\",\"_objectWithoutProperties\",\"Field\",\"Button\",\"TextInput\",\"Modal\",\"Box\",\"FieldGroup\",\"FieldLabel\",\"FieldRow\",\"FieldError\",\"React\",\"useCallback\",\"useEffect\",\"useForm\",\"useTranslation\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"_room$v\",\"_errors$email\",\"_errors$email2\",\"_errors$subject\",\"_errors$subject2\",\"email\",\"emailDefault\",\"room\",\"onRequest\",\"onSend\",\"onCancel\",\"onDiscard\",\"props\",\"_excluded\",\"t\",\"register\",\"handleSubmit\",\"setValue\",\"setFocus\",\"formState\",\"errors\",\"isSubmitting\",\"defaultValues\",\"subject\",\"transcriptRequest\",\"roomOpen\",\"open\",\"token\",\"handleDiscard\",\"submit\",\"_ref2\",\"createElement\",\"wrapperFunction\",\"is\",\"onSubmit\",\"Header\",\"Icon\",\"name\",\"Title\",\"Close\",\"onClick\",\"Content\",\"fontScale\",\"disabled\",\"error\",\"message\",\"flexGrow\",\"required\",\"field\",\"Footer\",\"FooterControllers\",\"danger\",\"loading\",\"primary\",\"type\"],\"mappings\":\"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\"}"}