{"code":"function module(e,s,n){var t,a,i,l,o,r,u,c,f,d,g,m,h,k,b,M,y,p,S,L,v,T,R,E,N,_=[\"innerRef\",\"bubbleRef\",\"listStyle\"];n.link(\"@babel/runtime/helpers/toConsumableArray\",{default:function(e){t=e}},0),n.link(\"@babel/runtime/helpers/extends\",{default:function(e){a=e}},1),n.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default:function(e){i=e}},2),n.link(\"@rocket.chat/fuselage\",{Box:function(e){l=e}},0),n.link(\"@rocket.chat/fuselage-hooks\",{useMergedRefs:function(e){o=e}},1),n.link(\"@rocket.chat/ui-contexts\",{useSetting:function(e){r=e},useUserPreference:function(e){u=e},useTranslation:function(e){c=e}},2),n.link(\"date-fns\",{differenceInSeconds:function(e){f=e}},3),n.link(\"react\",{default:function(e){d=e},Fragment:function(e){g=e}},4),n.link(\"../../../../../../app/ui-utils/client\",{MessageTypes:function(e){m=e}},5),n.link(\"../../../../../../lib/isTruthy\",{isTruthy:function(e){h=e}},6),n.link(\"../../../../../components/CustomScrollbars\",{CustomScrollbars:function(e){k=e}},7),n.link(\"../../../BubbleDate\",{BubbleDate:function(e){b=e}},8),n.link(\"../../../MessageList/lib/isMessageNewDay\",{isMessageNewDay:function(e){M=e}},9),n.link(\"../../../MessageList/providers/MessageListProvider\",{default:function(e){y=e}},10),n.link(\"../../../body/LoadingMessagesIndicator\",{default:function(e){p=e}},11),n.link(\"../../../hooks/useDateScroll\",{useDateScroll:function(e){S=e}},12),n.link(\"../../../hooks/useFirstUnreadMessageId\",{useFirstUnreadMessageId:function(e){L=e}},13),n.link(\"../../../hooks/useMessageListNavigation\",{useMessageListNavigation:function(e){v=e}},14),n.link(\"../hooks/useLegacyThreadMessageJump\",{useLegacyThreadMessageJump:function(e){T=e}},15),n.link(\"../hooks/useLegacyThreadMessageListScrolling\",{useLegacyThreadMessageListScrolling:function(e){R=e}},16),n.link(\"../hooks/useLegacyThreadMessages\",{useLegacyThreadMessages:function(e){E=e}},17),n.link(\"./ThreadMessageItem\",{ThreadMessageItem:function(e){N=e}},18),n.exportDefault(function(e){var s=e.mainMessage,n=c(),D=S(),w=D.innerRef,I=D.bubbleRef,U=D.listStyle,B=i(D,_),x=E(s._id),A=x.messages,P=x.loading,j=R(s),C=j.listWrapperRef,F=j.listRef,q=j.onScroll,J=T({enabled:!P}).parentRef,W=u(\"hideUsernames\"),X=!!u(\"displayAvatars\"),G=L(),z=Number(r(\"Message_GroupingPeriod\")),H=v().messageListRef,K=o(F,H),O=o(w,C,J);return d.createElement(\"div\",{className:[\"thread-list js-scroll-thread\",W&&\"hide-usernames\"].filter(h).join(\" \")},d.createElement(b,a({ref:I},B)),d.createElement(k,{ref:O,onScroll:function(e){q(e)},style:{scrollBehavior:\"smooth\",overflowX:\"hidden\"}},d.createElement(l,{is:\"ul\",className:[U,\"thread\"],ref:K,\"aria-label\":n(\"Thread_message_list\"),style:{scrollBehavior:\"smooth\",overflowX:\"hidden\"}},P?d.createElement(\"li\",{className:\"load-more\"},d.createElement(p,null)):d.createElement(y,{messageListRef:J},[s].concat(t(A)).map(function(e,s,n){var t=n[s-1],a=!(!t||m.isSystemMessage(e)||m.isSystemMessage(t))&&!1!==e.groupable&&e.u._id===t.u._id&&e.alias===t.alias&&f(e.ts,t.ts)<z&&!M(e,t),i=M(e,t),l=G===e._id,o=m.isSystemMessage(e);return d.createElement(g,{key:e._id},d.createElement(N,{message:e,previous:t,sequential:a,shouldShowAsSequential:a&&!i,showUserAvatar:X,firstUnread:l,system:o}))})))))})}","map":"{\"version\":3,\"sources\":[\"client/views/room/contextualBar/Threads/components/ThreadMessageList.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IMessage, IThreadMainMessage } from '@rocket.chat/core-typings';\\nimport { Box } from '@rocket.chat/fuselage';\\nimport { useMergedRefs } from '@rocket.chat/fuselage-hooks';\\nimport { useSetting, useUserPreference, useTranslation } from '@rocket.chat/ui-contexts';\\nimport { differenceInSeconds } from 'date-fns';\\nimport type { ReactElement } from 'react';\\nimport React, { Fragment } from 'react';\\n\\nimport { MessageTypes } from '../../../../../../app/ui-utils/client';\\nimport { isTruthy } from '../../../../../../lib/isTruthy';\\nimport { CustomScrollbars } from '../../../../../components/CustomScrollbars';\\nimport { BubbleDate } from '../../../BubbleDate';\\nimport { isMessageNewDay } from '../../../MessageList/lib/isMessageNewDay';\\nimport MessageListProvider from '../../../MessageList/providers/MessageListProvider';\\nimport LoadingMessagesIndicator from '../../../body/LoadingMessagesIndicator';\\nimport { useDateScroll } from '../../../hooks/useDateScroll';\\nimport { useFirstUnreadMessageId } from '../../../hooks/useFirstUnreadMessageId';\\nimport { useMessageListNavigation } from '../../../hooks/useMessageListNavigation';\\nimport { useLegacyThreadMessageJump } from '../hooks/useLegacyThreadMessageJump';\\nimport { useLegacyThreadMessageListScrolling } from '../hooks/useLegacyThreadMessageListScrolling';\\nimport { useLegacyThreadMessages } from '../hooks/useLegacyThreadMessages';\\nimport { ThreadMessageItem } from './ThreadMessageItem';\\n\\nconst isMessageSequential = (current: IMessage, previous: IMessage | undefined, groupingRange: number): boolean => {\\n\\tif (!previous) {\\n\\t\\treturn false;\\n\\t}\\n\\n\\tif (MessageTypes.isSystemMessage(current) || MessageTypes.isSystemMessage(previous)) {\\n\\t\\treturn false;\\n\\t}\\n\\n\\tif (current.groupable === false) {\\n\\t\\treturn false;\\n\\t}\\n\\n\\tif (current.u._id !== previous.u._id) {\\n\\t\\treturn false;\\n\\t}\\n\\n\\tif (current.alias !== previous.alias) {\\n\\t\\treturn false;\\n\\t}\\n\\treturn differenceInSeconds(current.ts, previous.ts) < groupingRange && !isMessageNewDay(current, previous);\\n};\\n\\ntype ThreadMessageListProps = {\\n\\tmainMessage: IThreadMainMessage;\\n};\\n\\nconst ThreadMessageList = ({ mainMessage }: ThreadMessageListProps): ReactElement => {\\n\\tconst t = useTranslation();\\n\\tconst { innerRef, bubbleRef, listStyle, ...bubbleDate } = useDateScroll();\\n\\n\\tconst { messages, loading } = useLegacyThreadMessages(mainMessage._id);\\n\\tconst {\\n\\t\\tlistWrapperRef: listWrapperScrollRef,\\n\\t\\tlistRef: listScrollRef,\\n\\t\\tonScroll: handleScroll,\\n\\t} = useLegacyThreadMessageListScrolling(mainMessage);\\n\\tconst { parentRef: listJumpRef } = useLegacyThreadMessageJump({ enabled: !loading });\\n\\n\\tconst hideUsernames = useUserPreference<boolean>('hideUsernames');\\n\\tconst showUserAvatar = !!useUserPreference<boolean>('displayAvatars');\\n\\tconst firstUnreadMessageId = useFirstUnreadMessageId();\\n\\tconst messageGroupingPeriod = Number(useSetting('Message_GroupingPeriod'));\\n\\n\\tconst { messageListRef } = useMessageListNavigation();\\n\\tconst listRef = useMergedRefs<HTMLElement | null>(listScrollRef, messageListRef);\\n\\n\\tconst scrollRef = useMergedRefs<HTMLElement | null>(innerRef, listWrapperScrollRef, listJumpRef);\\n\\n\\treturn (\\n\\t\\t<div className={['thread-list js-scroll-thread', hideUsernames && 'hide-usernames'].filter(isTruthy).join(' ')}>\\n\\t\\t\\t<BubbleDate ref={bubbleRef} {...bubbleDate} />\\n\\t\\t\\t<CustomScrollbars\\n\\t\\t\\t\\tref={scrollRef}\\n\\t\\t\\t\\tonScroll={(args) => {\\n\\t\\t\\t\\t\\thandleScroll(args);\\n\\t\\t\\t\\t}}\\n\\t\\t\\t\\tstyle={{ scrollBehavior: 'smooth', overflowX: 'hidden' }}\\n\\t\\t\\t>\\n\\t\\t\\t\\t<Box\\n\\t\\t\\t\\t\\tis='ul'\\n\\t\\t\\t\\t\\tclassName={[listStyle, 'thread']}\\n\\t\\t\\t\\t\\tref={listRef}\\n\\t\\t\\t\\t\\taria-label={t('Thread_message_list')}\\n\\t\\t\\t\\t\\tstyle={{ scrollBehavior: 'smooth', overflowX: 'hidden' }}\\n\\t\\t\\t\\t>\\n\\t\\t\\t\\t\\t{loading ? (\\n\\t\\t\\t\\t\\t\\t<li className='load-more'>\\n\\t\\t\\t\\t\\t\\t\\t<LoadingMessagesIndicator />\\n\\t\\t\\t\\t\\t\\t</li>\\n\\t\\t\\t\\t\\t) : (\\n\\t\\t\\t\\t\\t\\t<MessageListProvider messageListRef={listJumpRef}>\\n\\t\\t\\t\\t\\t\\t\\t{[mainMessage, ...messages].map((message, index, { [index - 1]: previous }) => {\\n\\t\\t\\t\\t\\t\\t\\t\\tconst sequential = isMessageSequential(message, previous, messageGroupingPeriod);\\n\\t\\t\\t\\t\\t\\t\\t\\tconst newDay = isMessageNewDay(message, previous);\\n\\t\\t\\t\\t\\t\\t\\t\\tconst shouldShowAsSequential = sequential && !newDay;\\n\\n\\t\\t\\t\\t\\t\\t\\t\\tconst firstUnread = firstUnreadMessageId === message._id;\\n\\t\\t\\t\\t\\t\\t\\t\\tconst system = MessageTypes.isSystemMessage(message);\\n\\n\\t\\t\\t\\t\\t\\t\\t\\treturn (\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<Fragment key={message._id}>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<ThreadMessageItem\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tmessage={message}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tprevious={previous}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tsequential={sequential}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tshouldShowAsSequential={shouldShowAsSequential}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tshowUserAvatar={showUserAvatar}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tfirstUnread={firstUnread}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tsystem={system}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t</Fragment>\\n\\t\\t\\t\\t\\t\\t\\t\\t);\\n\\t\\t\\t\\t\\t\\t\\t})}\\n\\t\\t\\t\\t\\t\\t</MessageListProvider>\\n\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t</Box>\\n\\t\\t\\t</CustomScrollbars>\\n\\t\\t</div>\\n\\t);\\n};\\n\\nexport default ThreadMessageList;\\n\",null],\"names\":[\"_toConsumableArray\",\"_extends\",\"_objectWithoutProperties\",\"Box\",\"useMergedRefs\",\"useSetting\",\"useUserPreference\",\"useTranslation\",\"differenceInSeconds\",\"React\",\"Fragment\",\"MessageTypes\",\"isTruthy\",\"CustomScrollbars\",\"BubbleDate\",\"isMessageNewDay\",\"MessageListProvider\",\"LoadingMessagesIndicator\",\"useDateScroll\",\"useFirstUnreadMessageId\",\"useMessageListNavigation\",\"useLegacyThreadMessageJump\",\"useLegacyThreadMessageListScrolling\",\"useLegacyThreadMessages\",\"ThreadMessageItem\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"mainMessage\",\"t\",\"_useDateScroll\",\"innerRef\",\"bubbleRef\",\"listStyle\",\"bubbleDate\",\"_excluded\",\"_useLegacyThreadMessa\",\"_id\",\"messages\",\"loading\",\"_useLegacyThreadMessa2\",\"listWrapperScrollRef\",\"listWrapperRef\",\"listScrollRef\",\"listRef\",\"handleScroll\",\"onScroll\",\"listJumpRef\",\"_useLegacyThreadMessa3\",\"enabled\",\"parentRef\",\"hideUsernames\",\"showUserAvatar\",\"firstUnreadMessageId\",\"messageGroupingPeriod\",\"Number\",\"messageListRef\",\"_useMessageListNaviga\",\"scrollRef\",\"createElement\",\"className\",\"filter\",\"join\",\"ref\",\"args\",\"style\",\"scrollBehavior\",\"overflowX\",\"is\",\"concat\",\"map\",\"message\",\"index\",\"_ref2\",\"previous\",\"sequential\",\"isSystemMessage\",\"current\",\"groupable\",\"u\",\"alias\",\"ts\",\"newDay\",\"firstUnread\",\"system\",\"key\",\"shouldShowAsSequential\"],\"mappings\":\"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\"}"}