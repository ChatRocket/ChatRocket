{"code":"function module(n,e,i){i.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(n){o=n}},0),i.export({useVoipCallAction:function(){return d}}),i.link(\"@rocket.chat/ui-contexts\",{useUserId:function(n){t=n}},0),i.link(\"@rocket.chat/ui-voip\",{useVoipAPI:function(n){s=n},useVoipState:function(n){c=n}},1),i.link(\"react\",{useMemo:function(n){u=n}},2),i.link(\"react-i18next\",{useTranslation:function(n){r=n}},3),i.link(\"../../../composer/messageBox/hooks/useMediaPermissions\",{useMediaPermissions:function(n){l=n}},4),i.link(\"../../../contexts/UserCardContext\",{useUserCard:function(n){a=n}},5);var o,t,s,c,u,r,l,a,d=function(n){var e=r().t,i=a().closeUserCard,d=t(),f=c(),k=f.isEnabled,m=f.isRegistered,p=f.isInCall,h=s().makeCall,x=l(\"microphone\"),C=o(x,1)[0],v=!!(null!=n&&n.freeSwitchExtension),b=d===n._id,E=b||C||!v||!m||p;return u(function(){return k&&!b?{type:\"communication\",title:e(\"Voice_call\"),icon:\"phone\",disabled:E,onClick:function(){h(null==n?void 0:n.freeSwitchExtension),i()}}:void 0},[i,E,k,b,h,e,null==n?void 0:n.freeSwitchExtension])}}","map":"{\"version\":3,\"sources\":[\"client/views/room/hooks/useUserInfoActions/actions/useVoipCallAction.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IUser } from '@rocket.chat/core-typings';\\nimport { useUserId } from '@rocket.chat/ui-contexts';\\nimport { useVoipAPI, useVoipState } from '@rocket.chat/ui-voip';\\nimport { useMemo } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { useMediaPermissions } from '../../../composer/messageBox/hooks/useMediaPermissions';\\nimport { useUserCard } from '../../../contexts/UserCardContext';\\nimport type { UserInfoAction } from '../useUserInfoActions';\\n\\nexport const useVoipCallAction = (user: Pick<IUser, '_id' | 'username' | 'freeSwitchExtension'>): UserInfoAction | undefined => {\\n\\tconst { t } = useTranslation();\\n\\tconst { closeUserCard } = useUserCard();\\n\\tconst ownUserId = useUserId();\\n\\n\\tconst { isEnabled, isRegistered, isInCall } = useVoipState();\\n\\tconst { makeCall } = useVoipAPI();\\n\\tconst [isMicPermissionDenied] = useMediaPermissions('microphone');\\n\\n\\tconst isRemoteRegistered = !!user?.freeSwitchExtension;\\n\\tconst isSameUser = ownUserId === user._id;\\n\\n\\tconst disabled = isSameUser || isMicPermissionDenied || !isRemoteRegistered || !isRegistered || isInCall;\\n\\n\\tconst voipCallOption = useMemo<UserInfoAction | undefined>(() => {\\n\\t\\tconst handleClick = () => {\\n\\t\\t\\tmakeCall(user?.freeSwitchExtension as string);\\n\\t\\t\\tcloseUserCard();\\n\\t\\t};\\n\\n\\t\\treturn isEnabled && !isSameUser\\n\\t\\t\\t? {\\n\\t\\t\\t\\t\\ttype: 'communication',\\n\\t\\t\\t\\t\\ttitle: t('Voice_call'),\\n\\t\\t\\t\\t\\ticon: 'phone',\\n\\t\\t\\t\\t\\tdisabled,\\n\\t\\t\\t\\t\\tonClick: handleClick,\\n\\t\\t\\t  }\\n\\t\\t\\t: undefined;\\n\\t}, [closeUserCard, disabled, isEnabled, isSameUser, makeCall, t, user?.freeSwitchExtension]);\\n\\n\\treturn voipCallOption;\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_slicedToArray\",\"export\",\"useVoipCallAction\",\"useUserId\",\"useVoipAPI\",\"useVoipState\",\"useMemo\",\"useTranslation\",\"useMediaPermissions\",\"useUserCard\",\"user\",\"t\",\"_useTranslation\",\"closeUserCard\",\"_useUserCard\",\"ownUserId\",\"_useVoipState\",\"isEnabled\",\"isRegistered\",\"isInCall\",\"makeCall\",\"_useVoipAPI\",\"_useMediaPermissions\",\"isMicPermissionDenied\",\"_useMediaPermissions2\",\"isRemoteRegistered\",\"freeSwitchExtension\",\"isSameUser\",\"_id\",\"disabled\",\"type\",\"title\",\"icon\",\"onClick\",\"undefined\"],\"mappings\":\"uBACkBA,EAAQC,IAAA,CAAA,uCAA2B,CAAAC,QAAA,SAAAC,CAAA,EAAAC,EAAAD,CAAA,CAAA,EAAA,GAArDH,EAAOK,MAAE,CAAA,CAAAC,kBAAiB,WAAA,OAAAA,CAA2B,CAAA,GAAAN,EAAAC,IAAA,CAAA,2BAAA,CAAAM,UAAA,SAAAJ,CAAA,EAAAI,EAAAJ,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,uBAAA,CAAAO,WAAA,SAAAL,CAAA,EAAAK,EAAAL,CAAA,EAAAM,aAAA,SAAAN,CAAA,EAAAM,EAAAN,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAAS,QAAA,SAAAP,CAAA,EAAAO,EAAAP,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,gBAAA,CAAAU,eAAA,SAAAR,CAAA,EAAAQ,EAAAR,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,yDAAA,CAAAW,oBAAA,SAAAT,CAAA,EAAAS,EAAAT,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,oCAAA,CAAAY,YAAA,SAAAV,CAAA,EAAAU,EAAAV,CAAA,CAAA,EAAA,GAS9C,IATPC,EAAqDG,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EASxCP,EAAoB,SAACQ,CAA6D,EAC9F,IAAQC,EAACC,AAAKL,IAANI,CAAC,CACDE,EAAaC,AAAKL,IAAlBI,aAAa,CACfE,EAAYZ,IAElBa,EAA8CX,IAAtCY,EAASD,EAATC,SAAS,CAAEC,EAAYF,EAAZE,YAAY,CAAEC,EAAQH,EAARG,QAAQ,CACjCC,EAAQC,AAAKjB,IAAbgB,QAAQ,CAChBE,EAAgCd,EAAoB,cAA7Ce,EAAqBC,AAAqCxB,EAAAsB,EAAA,EAArC,CAAA,EAAA,CAEtBG,EAAqB,CAAC,CAACf,CAAAA,MAAAA,GAAAA,EAAMgB,mBAAmB,AAAnBA,EAC7BC,EAAaZ,IAAcL,EAAKkB,GAAG,CAEnCC,EAAWF,GAAcJ,GAAyB,CAACE,GAAsB,CAACP,GAAgBC,EAmBhG,OAjBuBb,EAAoC,WAM1D,OAAOW,GAAa,CAACU,EAClB,CACAG,KAAM,gBACNC,MAAOpB,EAAE,cACTqB,KAAM,QACNH,SAAAA,EACAI,QAXiB,WACnBb,EAASV,MAAAA,EAAI,KAAA,EAAJA,EAAMgB,mBAA6B,EAC5Cb,GACD,GAUGqB,KAAAA,CACJ,EAAG,CAACrB,EAAegB,EAAUZ,EAAWU,EAAYP,EAAUT,EAAGD,MAAAA,EAAI,KAAA,EAAJA,EAAMgB,mBAAmB,CAAC,CAG5F\"}"}