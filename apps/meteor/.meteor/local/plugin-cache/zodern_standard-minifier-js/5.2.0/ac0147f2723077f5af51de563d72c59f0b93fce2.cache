{"code":"function module(e,n,o){var i,t,r,a,l,u,c,s,f,d,m,_,k,p,C,g,v,h;o.link(\"@babel/runtime/regenerator\",{default:function(e){i=e}},0),o.link(\"@rocket.chat/core-typings\",{isOmnichannelRoom:function(e){t=e},isRoomFederated:function(e){r=e}},0),o.link(\"@rocket.chat/fuselage\",{Box:function(e){a=e}},1),o.link(\"@rocket.chat/fuselage-hooks\",{useEffectEvent:function(e){l=e},useStableArray:function(e){u=e}},2),o.link(\"@rocket.chat/ui-contexts\",{usePermission:function(e){c=e},useSetting:function(e){s=e},useUser:function(e){f=e}},3),o.link(\"react\",{default:function(e){d=e},useMemo:function(e){m=e}},4),o.link(\"react-i18next\",{useTranslation:function(e){_=e}},5),o.link(\"../../../contexts/VideoConfContext\",{useVideoConfDispatchOutgoing:function(e){k=e},useVideoConfIsCalling:function(e){p=e},useVideoConfIsRinging:function(e){C=e}},6),o.link(\"../../../lib/VideoConfManager\",{VideoConfManager:function(e){g=e}},7),o.link(\"../../../views/room/contexts/RoomContext\",{useRoom:function(e){v=e}},8),o.link(\"../../../views/room/contextualBar/VideoConference/hooks/useVideoConfWarning\",{useVideoConfWarning:function(e){h=e}},9),o.exportDefault(function(){var e,n,o,b=_().t,V=v(),x=f(),E=r(V),w=e=(null===(n=V.uids)||void 0===n?void 0:n.length)===1,y=c(\"post-readonly\",V._id),R=c(\"call-management\",V._id),M=h(),D=k(),O=p(),B=C(),I=s(\"VideoConf_Enable_DMs\",!0),P=s(\"VideoConf_Enable_Channels\",!0),S=s(\"VideoConf_Enable_Teams\",!0),T=s(\"VideoConf_Enable_Groups\",!0),W=\"default-provider\"===s(\"Omnichannel_call_provider\",\"default-provider\"),A=u([I&&\"direct\",I&&\"direct_multiple\",T&&\"group\",W&&\"live\",S&&\"team\",P&&\"channel\"].filter(function(e){return!!e})),F=A.length>0&&R&&(!(null!=x&&x.username)||!(null!==(o=V.muted)&&void 0!==o&&o.includes(x.username)))&&!w,G=E||!!V.ro&&!y,U=G?b(\"core.Video_Call_unavailable_for_this_type_of_room\"):\"\",j=t(V)?-1:4,q=l(function(){return i.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(O||B)){e.next=2;break}return e.abrupt(\"return\");case 2:return e.prev=2,e.next=5,i.awrap(g.loadCapabilities());case 5:D({rid:V._id}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),M(e.t0.error);case 11:case\"end\":return e.stop()}},null,null,[[2,8]],Promise)});return m(function(){return{items:[{id:\"start-video-call\",icon:\"video\",disabled:G,onClick:q,content:d.createElement(a,{is:\"span\",title:U},b(\"Video_call\"))}],disabled:G,allowed:F,order:j,groups:A}},[F,G,A,q,j,b,U])})}","map":"{\"version\":3,\"sources\":[\"client/hooks/roomActions/useStartCallRoomAction/useVideoConfMenuOptions.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { isOmnichannelRoom, isRoomFederated } from '@rocket.chat/core-typings';\\nimport { Box } from '@rocket.chat/fuselage';\\nimport { useEffectEvent, useStableArray } from '@rocket.chat/fuselage-hooks';\\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\\nimport { usePermission, useSetting, useUser } from '@rocket.chat/ui-contexts';\\nimport React, { useMemo } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { useVideoConfDispatchOutgoing, useVideoConfIsCalling, useVideoConfIsRinging } from '../../../contexts/VideoConfContext';\\nimport { VideoConfManager } from '../../../lib/VideoConfManager';\\nimport { useRoom } from '../../../views/room/contexts/RoomContext';\\nimport type { RoomToolboxActionConfig } from '../../../views/room/contexts/RoomToolboxContext';\\nimport { useVideoConfWarning } from '../../../views/room/contextualBar/VideoConference/hooks/useVideoConfWarning';\\n\\nconst useVideoConfMenuOptions = () => {\\n\\tconst { t } = useTranslation();\\n\\tconst room = useRoom();\\n\\tconst user = useUser();\\n\\tconst federated = isRoomFederated(room);\\n\\n\\tconst ownUser = room.uids?.length === 1 ?? false;\\n\\n\\tconst permittedToPostReadonly = usePermission('post-readonly', room._id);\\n\\tconst permittedToCallManagement = usePermission('call-management', room._id);\\n\\n\\tconst dispatchWarning = useVideoConfWarning();\\n\\tconst dispatchPopup = useVideoConfDispatchOutgoing();\\n\\tconst isCalling = useVideoConfIsCalling();\\n\\tconst isRinging = useVideoConfIsRinging();\\n\\n\\tconst enabledForDMs = useSetting('VideoConf_Enable_DMs', true);\\n\\tconst enabledForChannels = useSetting('VideoConf_Enable_Channels', true);\\n\\tconst enabledForTeams = useSetting('VideoConf_Enable_Teams', true);\\n\\tconst enabledForGroups = useSetting('VideoConf_Enable_Groups', true);\\n\\tconst enabledForLiveChat = useSetting('Omnichannel_call_provider', 'default-provider') === 'default-provider';\\n\\n\\tconst groups = useStableArray(\\n\\t\\t[\\n\\t\\t\\tenabledForDMs && 'direct',\\n\\t\\t\\tenabledForDMs && 'direct_multiple',\\n\\t\\t\\tenabledForGroups && 'group',\\n\\t\\t\\tenabledForLiveChat && 'live',\\n\\t\\t\\tenabledForTeams && 'team',\\n\\t\\t\\tenabledForChannels && 'channel',\\n\\t\\t].filter((group): group is RoomToolboxActionConfig['groups'][number] => !!group),\\n\\t);\\n\\n\\tconst visible = groups.length > 0;\\n\\tconst allowed = visible && permittedToCallManagement && (!user?.username || !room.muted?.includes(user.username)) && !ownUser;\\n\\tconst disabled = federated || (!!room.ro && !permittedToPostReadonly);\\n\\tconst tooltip = disabled ? t('core.Video_Call_unavailable_for_this_type_of_room') : '';\\n\\tconst order = isOmnichannelRoom(room) ? -1 : 4;\\n\\n\\tconst handleOpenVideoConf = useEffectEvent(async () => {\\n\\t\\tif (isCalling || isRinging) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\ttry {\\n\\t\\t\\tawait VideoConfManager.loadCapabilities();\\n\\t\\t\\tdispatchPopup({ rid: room._id });\\n\\t\\t} catch (error: any) {\\n\\t\\t\\tdispatchWarning(error.error);\\n\\t\\t}\\n\\t});\\n\\n\\treturn useMemo(() => {\\n\\t\\tconst items: GenericMenuItemProps[] = [\\n\\t\\t\\t{\\n\\t\\t\\t\\tid: 'start-video-call',\\n\\t\\t\\t\\ticon: 'video',\\n\\t\\t\\t\\tdisabled,\\n\\t\\t\\t\\tonClick: handleOpenVideoConf,\\n\\t\\t\\t\\tcontent: (\\n\\t\\t\\t\\t\\t<Box is='span' title={tooltip}>\\n\\t\\t\\t\\t\\t\\t{t('Video_call')}\\n\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t),\\n\\t\\t\\t},\\n\\t\\t];\\n\\n\\t\\treturn {\\n\\t\\t\\titems,\\n\\t\\t\\tdisabled,\\n\\t\\t\\tallowed,\\n\\t\\t\\torder,\\n\\t\\t\\tgroups,\\n\\t\\t};\\n\\t}, [allowed, disabled, groups, handleOpenVideoConf, order, t, tooltip]);\\n};\\n\\nexport default useVideoConfMenuOptions;\\n\",null],\"names\":[\"_regeneratorRuntime\",\"isOmnichannelRoom\",\"isRoomFederated\",\"Box\",\"useEffectEvent\",\"useStableArray\",\"usePermission\",\"useSetting\",\"useUser\",\"React\",\"useMemo\",\"useTranslation\",\"useVideoConfDispatchOutgoing\",\"useVideoConfIsCalling\",\"useVideoConfIsRinging\",\"VideoConfManager\",\"useRoom\",\"useVideoConfWarning\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"_room$uids\",\"_room$muted\",\"t\",\"_useTranslation\",\"room\",\"user\",\"federated\",\"ownUser\",\"uids\",\"length\",\"permittedToPostReadonly\",\"_id\",\"permittedToCallManagement\",\"dispatchWarning\",\"dispatchPopup\",\"isCalling\",\"isRinging\",\"enabledForDMs\",\"enabledForChannels\",\"enabledForTeams\",\"enabledForGroups\",\"enabledForLiveChat\",\"groups\",\"filter\",\"group\",\"allowed\",\"visible\",\"username\",\"muted\",\"includes\",\"disabled\",\"ro\",\"tooltip\",\"order\",\"handleOpenVideoConf\",\"async\",\"_context\",\"prev\",\"next\",\"abrupt\",\"awrap\",\"loadCapabilities\",\"rid\",\"t0\",\"error\",\"stop\",\"Promise\",\"items\",\"id\",\"icon\",\"onClick\",\"content\",\"createElement\",\"is\",\"title\"],\"mappings\":\"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\"}"}