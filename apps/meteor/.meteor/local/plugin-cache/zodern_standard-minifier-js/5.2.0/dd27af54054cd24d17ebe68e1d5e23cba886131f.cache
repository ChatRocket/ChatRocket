{"code":"function module(e,n,i){i.export({useRetentionPolicy:function(){return f}}),i.link(\"@rocket.chat/ui-contexts\",{useSetting:function(e){t=e}},0),i.link(\"../../../lib/convertTimeUnit\",{TIMEUNIT:function(e){o=e},isValidTimespan:function(e){r=e},timeUnitToMs:function(e){l=e}},1);var t,o,r,l,a=function(e){return\"retention\"in e&&void 0!==e.retention},s=function(e){return\"overrideGlobal\"in e.retention&&e.retention.overrideGlobal},u=function(e,n){var i=n.enabled,t=n.appliesToChannels,o=n.appliesToGroups,r=n.appliesToDMs;if(!i)return!1;if(a(e)&&void 0!==e.retention.enabled)return e.retention.enabled;switch(e.t){case\"c\":return t;case\"p\":return o;case\"d\":return r}return!1},c=function(e,n){var i=n.filesOnly;return a(e)&&s(e)?e.retention.filesOnly:i},d=function(e,n){var i=n.doNotPrunePinned;return a(e)&&s(e)?e.retention.excludePinned:i},p=function(e,n){var i=n.ignoreThreads;return a(e)&&s(e)?e.retention.ignoreThreads:i},T=function(e,n){var i=n.maxAgeChannels,t=n.maxAgeGroups,u=n.maxAgeDMs;return a(e)&&s(e)&&r(e.retention.maxAge)?l(o.days,e.retention.maxAge):\"c\"===e.t?i:\"p\"===e.t?t:\"d\"===e.t?u:-1/0},f=function(e){var n={enabled:t(\"RetentionPolicy_Enabled\"),filesOnly:t(\"RetentionPolicy_FilesOnly\"),doNotPrunePinned:t(\"RetentionPolicy_DoNotPrunePinned\"),ignoreThreads:t(\"RetentionPolicy_DoNotPruneThreads\"),appliesToChannels:t(\"RetentionPolicy_AppliesToChannels\"),maxAgeChannels:t(\"RetentionPolicy_TTL_Channels\"),appliesToGroups:t(\"RetentionPolicy_AppliesToGroups\"),maxAgeGroups:t(\"RetentionPolicy_TTL_Groups\"),appliesToDMs:t(\"RetentionPolicy_AppliesToDMs\"),maxAgeDMs:t(\"RetentionPolicy_TTL_DMs\")};if(e)return{enabled:n.enabled,isActive:u(e,n),filesOnly:c(e,n),excludePinned:d(e,n),ignoreThreads:p(e,n),maxAge:T(e,n)}}}","map":"{\"version\":3,\"sources\":[\"client/views/room/hooks/useRetentionPolicy.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom, IRoomWithRetentionPolicy } from '@rocket.chat/core-typings';\\nimport { useSetting } from '@rocket.chat/ui-contexts';\\n\\nimport { TIMEUNIT, isValidTimespan, timeUnitToMs } from '../../../lib/convertTimeUnit';\\n\\nconst hasRetentionPolicy = (room: IRoom & { retention?: any }): room is IRoomWithRetentionPolicy =>\\n\\t'retention' in room && room.retention !== undefined;\\n\\nconst isRetentionOverridden = (room: IRoom & { retention?: any }) => 'overrideGlobal' in room.retention && room.retention.overrideGlobal;\\n\\ntype RetentionPolicySettings = {\\n\\tenabled: boolean;\\n\\tfilesOnly: boolean;\\n\\tdoNotPrunePinned: boolean;\\n\\tignoreThreads: boolean;\\n\\tappliesToChannels: boolean;\\n\\tmaxAgeChannels: number;\\n\\tappliesToGroups: boolean;\\n\\tmaxAgeGroups: number;\\n\\tappliesToDMs: boolean;\\n\\tmaxAgeDMs: number;\\n};\\n\\nconst isActive = (room: IRoom, { enabled, appliesToChannels, appliesToGroups, appliesToDMs }: RetentionPolicySettings): boolean => {\\n\\tif (!enabled) {\\n\\t\\treturn false;\\n\\t}\\n\\n\\tif (hasRetentionPolicy(room) && room.retention.enabled !== undefined) {\\n\\t\\treturn room.retention.enabled;\\n\\t}\\n\\n\\tswitch (room.t) {\\n\\t\\tcase 'c':\\n\\t\\t\\treturn appliesToChannels;\\n\\t\\tcase 'p':\\n\\t\\t\\treturn appliesToGroups;\\n\\t\\tcase 'd':\\n\\t\\t\\treturn appliesToDMs;\\n\\t}\\n\\n\\treturn false;\\n};\\n\\nconst extractFilesOnly = (room: IRoom, { filesOnly }: RetentionPolicySettings): boolean => {\\n\\tif (hasRetentionPolicy(room) && isRetentionOverridden(room)) {\\n\\t\\treturn room.retention.filesOnly;\\n\\t}\\n\\n\\treturn filesOnly;\\n};\\n\\nconst extractExcludePinned = (room: IRoom, { doNotPrunePinned }: RetentionPolicySettings): boolean => {\\n\\tif (hasRetentionPolicy(room) && isRetentionOverridden(room)) {\\n\\t\\treturn room.retention.excludePinned;\\n\\t}\\n\\n\\treturn doNotPrunePinned;\\n};\\n\\nconst extractIgnoreThreads = (room: IRoom, { ignoreThreads }: RetentionPolicySettings): boolean => {\\n\\tif (hasRetentionPolicy(room) && isRetentionOverridden(room)) {\\n\\t\\treturn room.retention.ignoreThreads;\\n\\t}\\n\\n\\treturn ignoreThreads;\\n};\\n\\nconst getMaxAge = (room: IRoom, { maxAgeChannels, maxAgeGroups, maxAgeDMs }: RetentionPolicySettings): number => {\\n\\tif (hasRetentionPolicy(room) && isRetentionOverridden(room) && isValidTimespan(room.retention.maxAge)) {\\n\\t\\treturn timeUnitToMs(TIMEUNIT.days, room.retention.maxAge);\\n\\t}\\n\\n\\tif (room.t === 'c') {\\n\\t\\treturn maxAgeChannels;\\n\\t}\\n\\tif (room.t === 'p') {\\n\\t\\treturn maxAgeGroups;\\n\\t}\\n\\tif (room.t === 'd') {\\n\\t\\treturn maxAgeDMs;\\n\\t}\\n\\n\\treturn -Infinity;\\n};\\n\\nexport const useRetentionPolicy = (\\n\\troom: IRoom | undefined,\\n):\\n\\t| {\\n\\t\\t\\tenabled: boolean;\\n\\t\\t\\tisActive: boolean;\\n\\t\\t\\tfilesOnly: boolean;\\n\\t\\t\\texcludePinned: boolean;\\n\\t\\t\\tignoreThreads: boolean;\\n\\t\\t\\tmaxAge: number;\\n\\t  }\\n\\t| undefined => {\\n\\tconst settings = {\\n\\t\\tenabled: useSetting('RetentionPolicy_Enabled') as boolean,\\n\\t\\tfilesOnly: useSetting('RetentionPolicy_FilesOnly') as boolean,\\n\\t\\tdoNotPrunePinned: useSetting('RetentionPolicy_DoNotPrunePinned') as boolean,\\n\\t\\tignoreThreads: useSetting('RetentionPolicy_DoNotPruneThreads') as boolean,\\n\\t\\tappliesToChannels: useSetting('RetentionPolicy_AppliesToChannels') as boolean,\\n\\t\\tmaxAgeChannels: useSetting('RetentionPolicy_TTL_Channels') as number,\\n\\t\\tappliesToGroups: useSetting('RetentionPolicy_AppliesToGroups') as boolean,\\n\\t\\tmaxAgeGroups: useSetting('RetentionPolicy_TTL_Groups') as number,\\n\\t\\tappliesToDMs: useSetting('RetentionPolicy_AppliesToDMs') as boolean,\\n\\t\\tmaxAgeDMs: useSetting('RetentionPolicy_TTL_DMs') as number,\\n\\t} as const;\\n\\n\\tif (!room) {\\n\\t\\treturn undefined;\\n\\t}\\n\\n\\treturn {\\n\\t\\tenabled: settings.enabled,\\n\\t\\tisActive: isActive(room, settings),\\n\\t\\tfilesOnly: extractFilesOnly(room, settings),\\n\\t\\texcludePinned: extractExcludePinned(room, settings),\\n\\t\\tignoreThreads: extractIgnoreThreads(room, settings),\\n\\t\\tmaxAge: getMaxAge(room, settings),\\n\\t};\\n};\\n\",null],\"names\":[\"module\",\"export\",\"useRetentionPolicy\",\"link\",\"useSetting\",\"v\",\"TIMEUNIT\",\"isValidTimespan\",\"timeUnitToMs\",\"hasRetentionPolicy\",\"room\",\"undefined\",\"retention\",\"isRetentionOverridden\",\"overrideGlobal\",\"isActive\",\"_ref\",\"enabled\",\"appliesToChannels\",\"appliesToGroups\",\"appliesToDMs\",\"t\",\"extractFilesOnly\",\"_ref2\",\"filesOnly\",\"extractExcludePinned\",\"_ref3\",\"doNotPrunePinned\",\"excludePinned\",\"extractIgnoreThreads\",\"_ref4\",\"ignoreThreads\",\"getMaxAge\",\"_ref5\",\"maxAgeChannels\",\"maxAgeGroups\",\"maxAgeDMs\",\"maxAge\",\"days\",\"Infinity\",\"settings\"],\"mappings\":\"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\"}"}