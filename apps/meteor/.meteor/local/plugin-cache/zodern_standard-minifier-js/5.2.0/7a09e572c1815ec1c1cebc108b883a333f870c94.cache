{"code":"function module(e,t,o){var i,l;let s,a,r,n,d,u,c,m,k,b,v,I,T,p,C,f,g,D,x,y,E,L;o.link(\"@rocket.chat/core-typings\",{isRoomFederated(e){s=e},isDirectMessageRoom(e){a=e},isTeamRoom(e){r=e}},0),o.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback(e){n=e},useDebouncedValue(e){d=e},useLocalStorage(e){u=e}},1),o.link(\"@rocket.chat/ui-contexts\",{useUserRoom(e){c=e},useAtLeastOnePermission(e){m=e},useUser(e){k=e},usePermission(e){b=e},useUserSubscription(e){v=e}},2),o.link(\"react\",{default(e){I=e},useCallback(e){T=e},useMemo(e){p=e},useState(e){C=e}},3),o.link(\"../../../../lib/federation/Federation\",{\"*\"(e){f=e}},4),o.link(\"../../../hooks/useMembersList\",{useMembersList(e){g=e}},5),o.link(\"../../contexts/RoomToolboxContext\",{useRoomToolbox(e){D=e}},6),o.link(\"../UserInfo\",{default(e){x=e}},7),o.link(\"./AddUsers\",{default(e){y=e}},8),o.link(\"./InviteUsers\",{default(e){E=e}},9),o.link(\"./RoomMembers\",{default(e){L=e}},10),(l=i||(i={})).INFO=\"user-info\",l.INVITE=\"invite-users\",l.ADD=\"add-users\",l.LIST=\"users-list\",o.exportDefault(e=>{var t,o,l;let{rid:M}=e,h=k(),R=c(M),{closeTab:U}=D(),[A,N]=u(\"members-list-type\",\"online\"),[S,F]=C(\"\"),V=v(M),B=R&&r(R),O=R&&a(R),P=b(\"create-invite-links\",M),j=R&&s(R),w=R&&h&&j?f.canCreateInviteLinks(h,R,V):P,[q,z]=C({tab:i.LIST,userId:void 0}),G=d(S,800),{data:H,fetchNextPage:J,isLoading:K,refetch:Q,hasNextPage:W}=g(p(()=>({rid:M,type:A,limit:50,debouncedText:G,roomType:null==R?void 0:R.t}),[M,A,G,null==R?void 0:R.t])),X=m(p(()=>[(null==R?void 0:R.t)===\"p\"?\"add-user-to-any-p-room\":\"add-user-to-any-c-room\",\"add-user-to-joined-room\"],[null==R?void 0:R.t]),M),Y=R&&h&&j?f.isEditableByTheUser(h,R,V):X,Z=T(e=>{F(e.currentTarget.value)},[]),$=n(e=>{let{userid:t}=e.currentTarget.dataset;z({tab:i.INFO,userId:t})}),_=n(()=>{z({tab:i.INVITE})}),ee=n(()=>{z({tab:i.ADD})}),et=T(()=>{z({tab:i.LIST})},[z]);return q.tab===i.INFO&&q.userId?I.createElement(x,{rid:M,uid:q.userId,onClose:U,onClickBack:et}):q.tab===i.INVITE?I.createElement(E,{rid:M,onClickBack:et}):q.tab===i.ADD?I.createElement(y,{rid:M,onClickBack:et,reload:Q}):I.createElement(L,{rid:M,isTeam:B,isDirect:O,loading:K,type:A,text:S,setText:Z,setType:N,members:null!==(t=null==H?void 0:null===(o=H.pages)||void 0===o?void 0:o.flatMap(e=>e.members))&&void 0!==t?t:[],total:null!==(l=null==H?void 0:H.pages[H.pages.length-1].total)&&void 0!==l?l:0,onClickClose:U,onClickView:$,loadMoreItems:W?J:()=>void 0,reload:Q,onClickInvite:w&&Y?_:void 0,onClickAdd:Y?ee:void 0})})}","map":"{\"version\":3,\"sources\":[\"client/views/room/contextualBar/RoomMembers/RoomMembersWithData.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom, IUser } from '@rocket.chat/core-typings';\\nimport { isRoomFederated, isDirectMessageRoom, isTeamRoom } from '@rocket.chat/core-typings';\\nimport { useMutableCallback, useDebouncedValue, useLocalStorage } from '@rocket.chat/fuselage-hooks';\\nimport { useUserRoom, useAtLeastOnePermission, useUser, usePermission, useUserSubscription } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement } from 'react';\\nimport React, { useCallback, useMemo, useState } from 'react';\\n\\nimport * as Federation from '../../../../lib/federation/Federation';\\nimport { useMembersList } from '../../../hooks/useMembersList';\\nimport { useRoomToolbox } from '../../contexts/RoomToolboxContext';\\nimport UserInfoWithData from '../UserInfo';\\nimport AddUsers from './AddUsers';\\nimport InviteUsers from './InviteUsers';\\nimport RoomMembers from './RoomMembers';\\n\\nenum ROOM_MEMBERS_TABS {\\n\\tINFO = 'user-info',\\n\\tINVITE = 'invite-users',\\n\\tADD = 'add-users',\\n\\tLIST = 'users-list',\\n}\\n\\ntype validRoomType = 'd' | 'p' | 'c';\\n\\nconst RoomMembersWithData = ({ rid }: { rid: IRoom['_id'] }): ReactElement => {\\n\\tconst user = useUser();\\n\\tconst room = useUserRoom(rid);\\n\\tconst { closeTab } = useRoomToolbox();\\n\\tconst [type, setType] = useLocalStorage<'online' | 'all'>('members-list-type', 'online');\\n\\tconst [text, setText] = useState('');\\n\\tconst subscription = useUserSubscription(rid);\\n\\n\\tconst isTeam = room && isTeamRoom(room);\\n\\tconst isDirect = room && isDirectMessageRoom(room);\\n\\tconst hasPermissionToCreateInviteLinks = usePermission('create-invite-links', rid);\\n\\tconst isFederated = room && isRoomFederated(room);\\n\\n\\tconst canCreateInviteLinks =\\n\\t\\troom && user && isFederated ? Federation.canCreateInviteLinks(user, room, subscription) : hasPermissionToCreateInviteLinks;\\n\\n\\tconst [state, setState] = useState<{ tab: ROOM_MEMBERS_TABS; userId?: IUser['_id'] }>({\\n\\t\\ttab: ROOM_MEMBERS_TABS.LIST,\\n\\t\\tuserId: undefined,\\n\\t});\\n\\n\\tconst debouncedText = useDebouncedValue(text, 800);\\n\\n\\tconst { data, fetchNextPage, isLoading, refetch, hasNextPage } = useMembersList(\\n\\t\\tuseMemo(() => ({ rid, type, limit: 50, debouncedText, roomType: room?.t as validRoomType }), [rid, type, debouncedText, room?.t]),\\n\\t);\\n\\n\\tconst hasPermissionToAddUsers = useAtLeastOnePermission(\\n\\t\\tuseMemo(() => [room?.t === 'p' ? 'add-user-to-any-p-room' : 'add-user-to-any-c-room', 'add-user-to-joined-room'], [room?.t]),\\n\\t\\trid,\\n\\t);\\n\\n\\tconst canAddUsers = room && user && isFederated ? Federation.isEditableByTheUser(user, room, subscription) : hasPermissionToAddUsers;\\n\\n\\tconst handleTextChange = useCallback((event) => {\\n\\t\\tsetText(event.currentTarget.value);\\n\\t}, []);\\n\\n\\tconst openUserInfo = useMutableCallback((e) => {\\n\\t\\tconst { userid } = e.currentTarget.dataset;\\n\\t\\tsetState({\\n\\t\\t\\ttab: ROOM_MEMBERS_TABS.INFO,\\n\\t\\t\\tuserId: userid,\\n\\t\\t});\\n\\t});\\n\\n\\tconst openInvite = useMutableCallback(() => {\\n\\t\\tsetState({ tab: ROOM_MEMBERS_TABS.INVITE });\\n\\t});\\n\\n\\tconst openAddUser = useMutableCallback(() => {\\n\\t\\tsetState({ tab: ROOM_MEMBERS_TABS.ADD });\\n\\t});\\n\\n\\tconst handleBack = useCallback(() => {\\n\\t\\tsetState({ tab: ROOM_MEMBERS_TABS.LIST });\\n\\t}, [setState]);\\n\\n\\tif (state.tab === ROOM_MEMBERS_TABS.INFO && state.userId) {\\n\\t\\treturn <UserInfoWithData rid={rid} uid={state.userId} onClose={closeTab} onClickBack={handleBack} />;\\n\\t}\\n\\n\\tif (state.tab === ROOM_MEMBERS_TABS.INVITE) {\\n\\t\\treturn <InviteUsers rid={rid} onClickBack={handleBack} />;\\n\\t}\\n\\n\\tif (state.tab === ROOM_MEMBERS_TABS.ADD) {\\n\\t\\treturn <AddUsers rid={rid} onClickBack={handleBack} reload={refetch} />;\\n\\t}\\n\\n\\treturn (\\n\\t\\t<RoomMembers\\n\\t\\t\\trid={rid}\\n\\t\\t\\tisTeam={isTeam}\\n\\t\\t\\tisDirect={isDirect}\\n\\t\\t\\tloading={isLoading}\\n\\t\\t\\ttype={type}\\n\\t\\t\\ttext={text}\\n\\t\\t\\tsetText={handleTextChange}\\n\\t\\t\\tsetType={setType}\\n\\t\\t\\tmembers={data?.pages?.flatMap((page) => page.members) ?? []}\\n\\t\\t\\ttotal={data?.pages[data.pages.length - 1].total ?? 0}\\n\\t\\t\\tonClickClose={closeTab}\\n\\t\\t\\tonClickView={openUserInfo}\\n\\t\\t\\tloadMoreItems={hasNextPage ? fetchNextPage : () => undefined}\\n\\t\\t\\treload={refetch}\\n\\t\\t\\tonClickInvite={canCreateInviteLinks && canAddUsers ? openInvite : undefined}\\n\\t\\t\\tonClickAdd={canAddUsers ? openAddUser : undefined}\\n\\t\\t/>\\n\\t);\\n};\\n\\nexport default RoomMembersWithData;\\n\",null],\"names\":[\"ROOM_MEMBERS_TABS\",\"isRoomFederated\",\"isDirectMessageRoom\",\"isTeamRoom\",\"useMutableCallback\",\"useDebouncedValue\",\"useLocalStorage\",\"useUserRoom\",\"useAtLeastOnePermission\",\"useUser\",\"usePermission\",\"useUserSubscription\",\"React\",\"useCallback\",\"useMemo\",\"useState\",\"Federation\",\"useMembersList\",\"useRoomToolbox\",\"UserInfoWithData\",\"AddUsers\",\"InviteUsers\",\"RoomMembers\",\"module\",\"link\",\"v\",\"default\",\"exportDefault\",\"_ref\",\"_data$pages$flatMap\",\"_data$pages\",\"_data$pages$total\",\"rid\",\"user\",\"room\",\"closeTab\",\"type\",\"setType\",\"text\",\"setText\",\"subscription\",\"isTeam\",\"isDirect\",\"hasPermissionToCreateInviteLinks\",\"isFederated\",\"canCreateInviteLinks\",\"state\",\"setState\",\"tab\",\"LIST\",\"userId\",\"undefined\",\"debouncedText\",\"data\",\"fetchNextPage\",\"isLoading\",\"refetch\",\"hasNextPage\",\"limit\",\"roomType\",\"t\",\"hasPermissionToAddUsers\",\"canAddUsers\",\"isEditableByTheUser\",\"handleTextChange\",\"event\",\"currentTarget\",\"value\",\"openUserInfo\",\"e\",\"userid\",\"dataset\",\"INFO\",\"openInvite\",\"INVITE\",\"openAddUser\",\"ADD\",\"handleBack\",\"createElement\",\"uid\",\"onClose\",\"onClickBack\",\"reload\",\"loading\",\"members\",\"pages\",\"flatMap\",\"page\",\"total\",\"length\",\"onClickClose\",\"onClickView\",\"loadMoreItems\",\"onClickInvite\",\"onClickAdd\"],\"mappings\":\"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\"}"}