{"code":"function module(t,n,e){e.link(\"@babel/runtime/regenerator\",{default:function(t){o=t}},0),e.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(t){r=t}},1),e.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(t){i=t}},2),e.export({useAgentsSection:function(){return m}}),e.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(t){a=t},useTranslation:function(t){s=t}},0),e.link(\"@tanstack/react-query\",{useQuery:function(t){u=t}},1),e.link(\"react\",{useMemo:function(t){c=t}},2),e.link(\"../../../components/GenericTable/hooks/useSort\",{useSort:function(t){l=t}},3),e.link(\"../../../components/dashboards/periods\",{getPeriodRange:function(t){d=t}},4),e.link(\"../../../components/dashboards/usePeriodSelectorStorage\",{usePeriodSelectorStorage:function(t){f=t}},5),e.link(\"../components/constants\",{COLORS:function(t){p=t},PERIOD_OPTIONS:function(t){_=t}},6),e.link(\"../utils/formatPeriodDescription\",{formatPeriodDescription:function(t){g=t}},7),e.link(\"./useDefaultDownload\",{useDefaultDownload:function(t){S=t}},8);var o,r,i,a,s,u,c,l,d,f,p,_,g,S,b=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map(function(t){return i(i({},t),{},{color:p.info})})},m=function(){var t,n=s(),e=f(\"reports-agents-period\",_),p=r(e,2),m=p[0],v=p[1],h=a(\"GET\",\"/v1/livechat/analytics/dashboards/conversations-by-agent\"),k=l(\"total\",\"desc\"),y=k.sortBy,D=k.sortDirection,P=k.setSort,O=u([\"omnichannel-reports\",\"conversations-by-agent\",m,y,D],function(){var t,n,e,r,a;return o.async(function(s){for(;;)switch(s.prev=s.next){case 0:return e=(n=d(m)).start,r=n.end,s.next=3,o.awrap(h({start:e.toISOString(),end:r.toISOString(),sort:JSON.stringify(((t={})[y]=\"asc\"===D?1:-1,t))}));case 3:return a=s.sent,s.abrupt(\"return\",i(i({},a),{},{data:b(a.data)}));case 5:case\"end\":return s.stop()}},null,null,null,Promise)},{refetchInterval:3e5}),w=O.data,E=(w=void 0===w?{data:[],total:0}:w).data,I=w.total,R=void 0===I?0:I,T=w.unspecified,x=void 0===T?0:T,A=O.refetch,L=O.isLoading,N=O.isError,B=O.isSuccess,C=n(\"Conversations_by_agents\"),G=n(\"__agents__agents_and__count__conversations__period__\",{agents:null!==(t=E.length)&&void 0!==t?t:0,count:R,period:g(m,n)})+\" \"+(x>0?\"(\"+n(\"__count__without__assignee__\",{count:x})+\")\":\"\"),j=n(\"Omnichannel_Reports_Agents_Empty_Subtitle\"),q=S({columnName:n(\"Agents\"),title:C,data:E,period:m});return c(function(){return{id:\"conversations-by-agent\",title:C,subtitle:G,emptyStateSubtitle:j,data:E,total:R,isLoading:L,isError:N,isDataFound:B&&E.length>0,periodSelectorProps:v,period:m,downloadProps:q,sortBy:y,sortDirection:D,setSort:P,onRetry:A}},[C,G,j,E,R,L,N,B,v,m,q,y,D,P,A])}}","map":"{\"version\":3,\"sources\":[\"client/omnichannel/reports/hooks/useAgentsSection.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\\nimport { useQuery } from '@tanstack/react-query';\\nimport { useMemo } from 'react';\\n\\nimport { useSort } from '../../../components/GenericTable/hooks/useSort';\\nimport { getPeriodRange } from '../../../components/dashboards/periods';\\nimport { usePeriodSelectorStorage } from '../../../components/dashboards/usePeriodSelectorStorage';\\nimport { COLORS, PERIOD_OPTIONS } from '../components/constants';\\nimport { formatPeriodDescription } from '../utils/formatPeriodDescription';\\nimport { useDefaultDownload } from './useDefaultDownload';\\n\\nconst formatChartData = (data: { label: string; value: number }[] | undefined = []) =>\\n\\tdata.map((item) => ({\\n\\t\\t...item,\\n\\t\\tcolor: COLORS.info,\\n\\t}));\\n\\nexport const useAgentsSection = () => {\\n\\tconst t = useTranslation();\\n\\tconst [period, periodSelectorProps] = usePeriodSelectorStorage('reports-agents-period', PERIOD_OPTIONS);\\n\\tconst getConversationsByAgent = useEndpoint('GET', '/v1/livechat/analytics/dashboards/conversations-by-agent');\\n\\tconst { sortBy, sortDirection, setSort } = useSort<'name' | 'total'>('total', 'desc');\\n\\n\\tconst {\\n\\t\\tdata: { data, total = 0, unspecified = 0 } = { data: [], total: 0 },\\n\\t\\trefetch,\\n\\t\\tisLoading,\\n\\t\\tisError,\\n\\t\\tisSuccess,\\n\\t} = useQuery(\\n\\t\\t['omnichannel-reports', 'conversations-by-agent', period, sortBy, sortDirection],\\n\\t\\tasync () => {\\n\\t\\t\\tconst { start, end } = getPeriodRange(period);\\n\\t\\t\\tconst response = await getConversationsByAgent({\\n\\t\\t\\t\\tstart: start.toISOString(),\\n\\t\\t\\t\\tend: end.toISOString(),\\n\\t\\t\\t\\tsort: JSON.stringify({ [sortBy]: sortDirection === 'asc' ? 1 : -1 }),\\n\\t\\t\\t});\\n\\t\\t\\treturn { ...response, data: formatChartData(response.data) };\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\trefetchInterval: 5 * 60 * 1000,\\n\\t\\t},\\n\\t);\\n\\n\\tconst title = t('Conversations_by_agents');\\n\\n\\tconst subtitleTotals = t('__agents__agents_and__count__conversations__period__', {\\n\\t\\tagents: data.length ?? 0,\\n\\t\\tcount: total,\\n\\t\\tperiod: formatPeriodDescription(period, t),\\n\\t});\\n\\tconst subtitleUnspecified = unspecified > 0 ? `(${t('__count__without__assignee__', { count: unspecified })})` : '';\\n\\tconst subtitle = `${subtitleTotals} ${subtitleUnspecified}`;\\n\\tconst emptyStateSubtitle = t('Omnichannel_Reports_Agents_Empty_Subtitle');\\n\\n\\tconst downloadProps = useDefaultDownload({ columnName: t('Agents'), title, data, period });\\n\\n\\treturn useMemo(\\n\\t\\t() => ({\\n\\t\\t\\tid: 'conversations-by-agent',\\n\\t\\t\\ttitle,\\n\\t\\t\\tsubtitle,\\n\\t\\t\\temptyStateSubtitle,\\n\\t\\t\\tdata,\\n\\t\\t\\ttotal,\\n\\t\\t\\tisLoading,\\n\\t\\t\\tisError,\\n\\t\\t\\tisDataFound: isSuccess && data.length > 0,\\n\\t\\t\\tperiodSelectorProps,\\n\\t\\t\\tperiod,\\n\\t\\t\\tdownloadProps,\\n\\t\\t\\tsortBy,\\n\\t\\t\\tsortDirection,\\n\\t\\t\\tsetSort,\\n\\t\\t\\tonRetry: refetch,\\n\\t\\t}),\\n\\t\\t[\\n\\t\\t\\ttitle,\\n\\t\\t\\tsubtitle,\\n\\t\\t\\temptyStateSubtitle,\\n\\t\\t\\tdata,\\n\\t\\t\\ttotal,\\n\\t\\t\\tisLoading,\\n\\t\\t\\tisError,\\n\\t\\t\\tisSuccess,\\n\\t\\t\\tperiodSelectorProps,\\n\\t\\t\\tperiod,\\n\\t\\t\\tdownloadProps,\\n\\t\\t\\tsortBy,\\n\\t\\t\\tsortDirection,\\n\\t\\t\\tsetSort,\\n\\t\\t\\trefetch,\\n\\t\\t],\\n\\t);\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"_slicedToArray\",\"_objectSpread\",\"export\",\"useAgentsSection\",\"useEndpoint\",\"useTranslation\",\"useQuery\",\"useMemo\",\"useSort\",\"getPeriodRange\",\"usePeriodSelectorStorage\",\"COLORS\",\"PERIOD_OPTIONS\",\"formatPeriodDescription\",\"useDefaultDownload\",\"formatChartData\",\"data\",\"arguments\",\"length\",\"undefined\",\"map\",\"item\",\"color\",\"info\",\"_data$length\",\"t\",\"_usePeriodSelectorSto\",\"_usePeriodSelectorSto2\",\"period\",\"periodSelectorProps\",\"getConversationsByAgent\",\"_useSort\",\"sortBy\",\"sortDirection\",\"setSort\",\"_useQuery\",\"_JSON$stringify\",\"_getPeriodRange\",\"start\",\"end\",\"response\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"toISOString\",\"sort\",\"JSON\",\"stringify\",\"sent\",\"abrupt\",\"stop\",\"Promise\",\"refetchInterval\",\"_useQuery$data\",\"total\",\"_useQuery$data$total\",\"_useQuery$data$unspec\",\"unspecified\",\"refetch\",\"isLoading\",\"isError\",\"isSuccess\",\"title\",\"subtitle\",\"subtitleTotals\",\"agents\",\"count\",\"emptyStateSubtitle\",\"downloadProps\",\"columnName\",\"id\",\"isDataFound\",\"onRetry\"],\"mappings\":\"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\"}"}