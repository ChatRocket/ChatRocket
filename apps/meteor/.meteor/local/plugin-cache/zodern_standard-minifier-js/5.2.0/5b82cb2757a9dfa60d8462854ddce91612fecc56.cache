{"code":"function module(e,n,t){t.link(\"@rocket.chat/ui-client\",{FeaturePreview:function(e){i=e},FeaturePreviewOff:function(e){l=e},FeaturePreviewOn:function(e){u=e}},0),t.link(\"@rocket.chat/ui-contexts\",{useLayout:function(e){c=e},useUser:function(e){a=e},useSetting:function(e){o=e}},1),t.link(\"react\",{default:function(e){r=e},lazy:function(e){d=e},useCallback:function(e){f=e}},2),t.link(\"../../../../app/models/client\",{Roles:function(e){s=e}},3),t.link(\"../../../hooks/useReactiveValue\",{useReactiveValue:function(e){m=e}},4),t.link(\"./LayoutWithSidebar\",{default:function(e){v=e}},5),t.link(\"./LayoutWithSidebarV2\",{default:function(e){k=e}},6);var i,l,u,c,a,o,r,d,f,s,m,v,k,E=d(function(){return t.dynamicImport(\"../../account/security/AccountSecurityPage\")});t.exportDefault(function(e){var n=e.children,t=c().isEmbedded,d=a(),b=o(\"Accounts_TwoFactorAuthentication_Enabled\");return m(f(function(){var e,n,t,i,l;return!!d&&(null==d||null===(e=d.services)||void 0===e||null===(n=e.totp)||void 0===n||!n.enabled)&&(null==d||null===(t=d.services)||void 0===t||null===(i=t.email2fa)||void 0===i||!i.enabled)&&void 0!==s.findOne({_id:{$in:null!==(l=d.roles)&&void 0!==l?l:[]},mandatory2fa:!0})&&b},[b,d]))?r.createElement(\"main\",{id:\"rocket-chat\",className:t?\"embedded-view\":void 0},r.createElement(\"div\",{className:\"rc-old main-content content-background-color\"},r.createElement(E,null))):r.createElement(i,{feature:\"newNavigation\"},r.createElement(l,null,r.createElement(v,null,n)),r.createElement(u,null,r.createElement(k,null,n)))})}","map":"{\"version\":3,\"sources\":[\"client/views/root/MainLayout/TwoFactorAuthSetupCheck.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { FeaturePreview, FeaturePreviewOff, FeaturePreviewOn } from '@rocket.chat/ui-client';\\nimport { useLayout, useUser, useSetting } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement, ReactNode } from 'react';\\nimport React, { lazy, useCallback } from 'react';\\n\\nimport { Roles } from '../../../../app/models/client';\\nimport { useReactiveValue } from '../../../hooks/useReactiveValue';\\nimport LayoutWithSidebar from './LayoutWithSidebar';\\nimport LayoutWithSidebarV2 from './LayoutWithSidebarV2';\\n\\nconst AccountSecurityPage = lazy(() => import('../../account/security/AccountSecurityPage'));\\n\\nconst TwoFactorAuthSetupCheck = ({ children }: { children: ReactNode }): ReactElement => {\\n\\tconst { isEmbedded: embeddedLayout } = useLayout();\\n\\tconst user = useUser();\\n\\tconst tfaEnabled = useSetting('Accounts_TwoFactorAuthentication_Enabled');\\n\\tconst require2faSetup = useReactiveValue(\\n\\t\\tuseCallback(() => {\\n\\t\\t\\t// User is already using 2fa\\n\\t\\t\\tif (!user || user?.services?.totp?.enabled || user?.services?.email2fa?.enabled) {\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t}\\n\\n\\t\\t\\tconst mandatoryRole = Roles.findOne({ _id: { $in: user.roles ?? [] }, mandatory2fa: true });\\n\\t\\t\\treturn mandatoryRole !== undefined && tfaEnabled;\\n\\t\\t}, [tfaEnabled, user]),\\n\\t);\\n\\n\\tif (require2faSetup) {\\n\\t\\treturn (\\n\\t\\t\\t<main id='rocket-chat' className={embeddedLayout ? 'embedded-view' : undefined}>\\n\\t\\t\\t\\t<div className='rc-old main-content content-background-color'>\\n\\t\\t\\t\\t\\t<AccountSecurityPage />\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</main>\\n\\t\\t);\\n\\t}\\n\\n\\treturn (\\n\\t\\t<FeaturePreview feature='newNavigation'>\\n\\t\\t\\t<FeaturePreviewOff>\\n\\t\\t\\t\\t<LayoutWithSidebar>{children}</LayoutWithSidebar>\\n\\t\\t\\t</FeaturePreviewOff>\\n\\t\\t\\t<FeaturePreviewOn>\\n\\t\\t\\t\\t<LayoutWithSidebarV2>{children}</LayoutWithSidebarV2>\\n\\t\\t\\t</FeaturePreviewOn>\\n\\t\\t</FeaturePreview>\\n\\t);\\n};\\n\\nexport default TwoFactorAuthSetupCheck;\\n\",null],\"names\":[\"module\",\"link\",\"FeaturePreview\",\"v\",\"FeaturePreviewOff\",\"FeaturePreviewOn\",\"useLayout\",\"useUser\",\"useSetting\",\"React\",\"lazy\",\"useCallback\",\"Roles\",\"useReactiveValue\",\"LayoutWithSidebar\",\"LayoutWithSidebarV2\",\"AccountSecurityPage\",\"dynamicImport\",\"exportDefault\",\"_ref\",\"children\",\"embeddedLayout\",\"_useLayout\",\"isEmbedded\",\"user\",\"tfaEnabled\",\"_user$services\",\"_user$services$totp\",\"_user$services2\",\"_user$services2$email\",\"_user$roles\",\"services\",\"totp\",\"enabled\",\"email2fa\",\"mandatoryRole\",\"undefined\",\"findOne\",\"_id\",\"$in\",\"roles\",\"mandatory2fa\",\"createElement\",\"id\",\"className\",\"feature\"],\"mappings\":\"uBAA4CA,EAAgBC,IAAE,CAAA,yBAAM,CAAwBC,eAAC,SAAAC,CAAA,EAAAD,EAAAC,CAAA,EAAAC,kBAAA,SAAAD,CAAA,EAAAC,EAAAD,CAAA,EAAAE,iBAAA,SAAAF,CAAA,EAAAE,EAAAF,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,2BAAA,CAAAK,UAAA,SAAAH,CAAA,EAAAG,EAAAH,CAAA,EAAAI,QAAA,SAAAJ,CAAA,EAAAI,EAAAJ,CAAA,EAAAK,WAAA,SAAAL,CAAA,EAAAK,EAAAL,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAA,QAAA,SAAAE,CAAA,EAAAM,EAAAN,CAAA,EAAAO,KAAA,SAAAP,CAAA,EAAAO,EAAAP,CAAA,EAAAQ,YAAA,SAAAR,CAAA,EAAAQ,EAAAR,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,gCAAA,CAAAW,MAAA,SAAAT,CAAA,EAAAS,EAAAT,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,kCAAA,CAAAY,iBAAA,SAAAV,CAAA,EAAAU,EAAAV,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,sBAAA,CAAA,QAAA,SAAAE,CAAA,EAAAW,EAAAX,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,wBAAA,CAAA,QAAA,SAAAE,CAAA,EAAAY,EAAAZ,CAAA,CAAA,EAAA,GAU7F,IAVAD,EAASE,EAAgBC,EAAoEC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAUvFC,EAAsBN,EAAK,WAAA,OAAMV,EAAAiB,aAAA,CAAO,6CAA6C,GAV3FjB,EAAOkB,aAAE,CAYuB,SAAAC,CAAA,EAAwD,IAArDC,EAAQD,EAARC,QAAQ,CACtBC,EAAcC,AAAKhB,IAA/BiB,UAAU,CACZC,EAAOjB,IACPkB,EAAajB,EAAW,mDAa9B,AAZwBK,EACvBF,EAAY,eAAKe,EAAAC,EAAAC,EAAAC,EAAAC,QAEhB,CAAI,CAACN,GAAQA,CAAAA,MAAAA,GAAI,AAAU,OAAVE,CAAAA,EAAJF,EAAMO,QAAQ,AAARA,GAAQL,AAAA,KAAA,IAAAA,GAAA,AAAM,OAANC,CAAAA,EAAdD,EAAgBM,IAAI,AAAJA,GAAIL,AAAA,KAAA,IAAAA,IAApBA,EAAsBM,OAAO,AAAPA,GAAWT,CAAAA,MAAAA,GAAI,AAAU,OAAVI,CAAAA,EAAJJ,EAAMO,QAAQ,AAARA,GAAQH,AAAA,KAAA,IAAAA,GAAA,AAAU,OAAVC,CAAAA,EAAdD,EAAgBM,QAAQ,AAARA,GAAQL,AAAA,KAAA,IAAAA,IAAxBA,EAA0BI,OAAO,AAAPA,GAKjEE,AAAkBC,KAAAA,IADHxB,EAAMyB,OAAO,CAAC,CAAEC,IAAK,CAAEC,IAAG,AAAY,OAAZT,CAAAA,EAAEN,EAAKgB,KAAK,AAALA,GAAKV,AAAA,KAAA,IAAAA,EAAAA,EAAI,EAAA,AAAE,EAAIW,aAAc,CAAA,CAAI,IAClDhB,CACvC,EAAG,CAACA,EAAYD,EAAK,GAKpBf,EAAAiC,aAAA,CAAA,OAAA,CAAMC,GAAG,cAAcC,UAAWvB,EAAiB,gBAAkBe,KAAAA,CAAU,EAC9E3B,EAAAiC,aAAA,CAAA,MAAA,CAAKE,UAAU,8CAA8C,EAC5DnC,EAAAiC,aAAA,CAAC1B,EAAmB,QAOvBP,EAAAiC,aAAA,CAACxC,EAAc,CAAC2C,QAAQ,eAAe,EACtCpC,EAAAiC,aAAA,CAACtC,EAAiB,KACjBK,EAAAiC,aAAA,CAAC5B,EAAiB,KAAEM,IAErBX,EAAAiC,aAAA,CAACrC,EAAgB,KAChBI,EAAAiC,aAAA,CAAC3B,EAAmB,KAAEK,IAI1B\"}"}