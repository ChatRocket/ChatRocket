{"code":"function module(e,i,o){let n,t,s,l,c,r,u;o.export({useVoipCallAction:()=>a}),o.link(\"@rocket.chat/ui-contexts\",{useUserId(e){n=e}},0),o.link(\"@rocket.chat/ui-voip\",{useVoipAPI(e){t=e},useVoipState(e){s=e}},1),o.link(\"react\",{useMemo(e){l=e}},2),o.link(\"react-i18next\",{useTranslation(e){c=e}},3),o.link(\"../../../composer/messageBox/hooks/useMediaPermissions\",{useMediaPermissions(e){r=e}},4),o.link(\"../../../contexts/UserCardContext\",{useUserCard(e){u=e}},5);let a=e=>{let{t:i}=c(),{closeUserCard:o}=u(),a=n(),{isEnabled:d,isRegistered:k,isInCall:m}=s(),{makeCall:p}=t(),[x]=r(\"microphone\"),h=!!(null!=e&&e.freeSwitchExtension),C=a===e._id,f=C||x||!h||!k||m,v=l(()=>d&&!C?{type:\"communication\",title:i(\"Voice_call\"),icon:\"phone\",disabled:f,onClick:()=>{p(null==e?void 0:e.freeSwitchExtension),o()}}:void 0,[o,f,d,C,p,i,null==e?void 0:e.freeSwitchExtension]);return v}}","map":"{\"version\":3,\"sources\":[\"client/views/room/hooks/useUserInfoActions/actions/useVoipCallAction.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IUser } from '@rocket.chat/core-typings';\\nimport { useUserId } from '@rocket.chat/ui-contexts';\\nimport { useVoipAPI, useVoipState } from '@rocket.chat/ui-voip';\\nimport { useMemo } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { useMediaPermissions } from '../../../composer/messageBox/hooks/useMediaPermissions';\\nimport { useUserCard } from '../../../contexts/UserCardContext';\\nimport type { UserInfoAction } from '../useUserInfoActions';\\n\\nexport const useVoipCallAction = (user: Pick<IUser, '_id' | 'username' | 'freeSwitchExtension'>): UserInfoAction | undefined => {\\n\\tconst { t } = useTranslation();\\n\\tconst { closeUserCard } = useUserCard();\\n\\tconst ownUserId = useUserId();\\n\\n\\tconst { isEnabled, isRegistered, isInCall } = useVoipState();\\n\\tconst { makeCall } = useVoipAPI();\\n\\tconst [isMicPermissionDenied] = useMediaPermissions('microphone');\\n\\n\\tconst isRemoteRegistered = !!user?.freeSwitchExtension;\\n\\tconst isSameUser = ownUserId === user._id;\\n\\n\\tconst disabled = isSameUser || isMicPermissionDenied || !isRemoteRegistered || !isRegistered || isInCall;\\n\\n\\tconst voipCallOption = useMemo<UserInfoAction | undefined>(() => {\\n\\t\\tconst handleClick = () => {\\n\\t\\t\\tmakeCall(user?.freeSwitchExtension as string);\\n\\t\\t\\tcloseUserCard();\\n\\t\\t};\\n\\n\\t\\treturn isEnabled && !isSameUser\\n\\t\\t\\t? {\\n\\t\\t\\t\\t\\ttype: 'communication',\\n\\t\\t\\t\\t\\ttitle: t('Voice_call'),\\n\\t\\t\\t\\t\\ticon: 'phone',\\n\\t\\t\\t\\t\\tdisabled,\\n\\t\\t\\t\\t\\tonClick: handleClick,\\n\\t\\t\\t  }\\n\\t\\t\\t: undefined;\\n\\t}, [closeUserCard, disabled, isEnabled, isSameUser, makeCall, t, user?.freeSwitchExtension]);\\n\\n\\treturn voipCallOption;\\n};\\n\",null],\"names\":[\"useUserId\",\"useVoipAPI\",\"useVoipState\",\"useMemo\",\"useTranslation\",\"useMediaPermissions\",\"useUserCard\",\"module\",\"export\",\"useVoipCallAction\",\"link\",\"v\",\"user\",\"t\",\"closeUserCard\",\"ownUserId\",\"isEnabled\",\"isRegistered\",\"isInCall\",\"makeCall\",\"isMicPermissionDenied\",\"isRemoteRegistered\",\"freeSwitchExtension\",\"isSameUser\",\"_id\",\"disabled\",\"voipCallOption\",\"type\",\"title\",\"icon\",\"onClick\",\"handleClick\",\"undefined\"],\"mappings\":\"2BACqDA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAArDC,EAAOC,MAAE,CAAA,CAAAC,kBAAiBA,IAAAA,CAA2B,GAAAF,EAAAG,IAAA,CAAA,2BAAA,CAAAV,UAAAW,CAAA,EAAAX,EAAAW,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,uBAAA,CAAAT,WAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,aAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,QAAA,CAAAP,QAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,gBAAA,CAAAN,eAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,yDAAA,CAAAL,oBAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,oCAAA,CAAAJ,YAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAS9C,IAAMF,EAAqBG,IACjC,GAAM,CAAEC,EAAAA,CAAAA,CAAG,CAAGT,IACR,CAAEU,cAAAA,CAAAA,CAAe,CAAGR,IACpBS,EAAYf,IAEZ,CAAEgB,UAAAA,CAAS,CAAEC,aAAAA,CAAY,CAAEC,SAAAA,CAAAA,CAAU,CAAGhB,IACxC,CAAEiB,SAAAA,CAAAA,CAAU,CAAGlB,IACf,CAACmB,EAAsB,CAAGf,EAAoB,cAE9CgB,EAAqB,CAAC,CAACT,CAAAA,MAAAA,GAAAA,EAAMU,mBAAmB,AAAnBA,EAC7BC,EAAaR,IAAcH,EAAKY,GAAG,CAEnCC,EAAWF,GAAcH,GAAyB,CAACC,GAAsB,CAACJ,GAAgBC,EAE1FQ,EAAiBvB,EAAoC,IAMnDa,GAAa,CAACO,EAClB,CACAI,KAAM,gBACNC,MAAOf,EAAE,cACTgB,KAAM,QACNJ,SAAAA,EACAK,QAXiBC,KACnBZ,EAASP,MAAAA,EAAI,KAAA,EAAJA,EAAMU,mBAA6B,EAC5CR,GACD,GAUGkB,KAAAA,EACD,CAAClB,EAAeW,EAAUT,EAAWO,EAAYJ,EAAUN,EAAGD,MAAAA,EAAI,KAAA,EAAJA,EAAMU,mBAAmB,CAAC,EAE3F,OAAOI,CACR\"}"}