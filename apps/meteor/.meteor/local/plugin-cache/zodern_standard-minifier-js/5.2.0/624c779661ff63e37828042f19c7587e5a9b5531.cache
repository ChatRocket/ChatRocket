{"code":"function module(e,n,t){var i,r,o,a,s,c,u,l,m,d;t.link(\"@babel/runtime/regenerator\",{default:function(e){i=e}},0),t.link(\"meteor/meteor\",{Meteor:function(e){r=e}},0),t.link(\"../../../client/lib/rooms/roomCoordinator\",{roomCoordinator:function(e){o=e}},1),t.link(\"../../../client/lib/toast\",{dispatchToastMessage:function(e){a=e}},2),t.link(\"../../../client/lib/utils/messageArgs\",{messageArgs:function(e){s=e}},3),t.link(\"../../../client/providers/RouterProvider\",{router:function(e){c=e}},4),t.link(\"../../models/client\",{ChatSubscription:function(e){u=e}},5),t.link(\"../../ui-utils/client\",{LegacyRoomManager:function(e){l=e},MessageAction:function(e){m=e}},6),t.link(\"../../utils/client/lib/SDKClient\",{sdk:function(e){d=e}},7),r.startup(function(){m.addButton({id:\"mark-message-as-unread\",icon:\"flag\",label:\"Mark_unread\",context:[\"message\",\"message-mobile\",\"threads\"],type:\"interaction\",action:function(e,n){var t,r,o;return i.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=void 0===(t=n.message)?s(this).msg:t,e.prev=1,null!=(o=u.findOne({rid:r.rid}))){e.next=5;break}return e.abrupt(\"return\");case 5:return c.navigate(\"/home\"),e.next=8,i.awrap(l.close(o.t+o.name));case 8:return e.next=10,i.awrap(d.call(\"unreadMessages\",r));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),a({type:\"error\",message:e.t0});case 15:case\"end\":return e.stop()}},null,this,[[1,12]],Promise)},condition:function(e){var n=e.message,t=e.user,i=e.room;return!o.isLivechatRoom(i.t)&&!!t&&n.u._id!==t._id},order:4,group:\"menu\"})})}","map":"{\"version\":3,\"sources\":[\"app/message-mark-as-unread/client/actionButton.ts\",\"<anon>\"],\"sourcesContent\":[\"import { Meteor } from 'meteor/meteor';\\n\\nimport { roomCoordinator } from '../../../client/lib/rooms/roomCoordinator';\\nimport { dispatchToastMessage } from '../../../client/lib/toast';\\nimport { messageArgs } from '../../../client/lib/utils/messageArgs';\\nimport { router } from '../../../client/providers/RouterProvider';\\nimport { ChatSubscription } from '../../models/client';\\nimport { LegacyRoomManager, MessageAction } from '../../ui-utils/client';\\nimport { sdk } from '../../utils/client/lib/SDKClient';\\n\\nMeteor.startup(() => {\\n\\tMessageAction.addButton({\\n\\t\\tid: 'mark-message-as-unread',\\n\\t\\ticon: 'flag',\\n\\t\\tlabel: 'Mark_unread',\\n\\t\\tcontext: ['message', 'message-mobile', 'threads'],\\n\\t\\ttype: 'interaction',\\n\\t\\tasync action(_, props) {\\n\\t\\t\\tconst { message = messageArgs(this).msg } = props;\\n\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tconst subscription = ChatSubscription.findOne({\\n\\t\\t\\t\\t\\trid: message.rid,\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\t\\tif (subscription == null) {\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\trouter.navigate('/home');\\n\\t\\t\\t\\tawait LegacyRoomManager.close(subscription.t + subscription.name);\\n\\t\\t\\t\\tawait sdk.call('unreadMessages', message);\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\tcondition({ message, user, room }) {\\n\\t\\t\\tconst isLivechatRoom = roomCoordinator.isLivechatRoom(room.t);\\n\\t\\t\\tif (isLivechatRoom) {\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (!user) {\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn message.u._id !== user._id;\\n\\t\\t},\\n\\t\\torder: 4,\\n\\t\\tgroup: 'menu',\\n\\t});\\n});\\n\",null],\"names\":[\"_regeneratorRuntime\",\"Meteor\",\"roomCoordinator\",\"dispatchToastMessage\",\"messageArgs\",\"router\",\"ChatSubscription\",\"LegacyRoomManager\",\"MessageAction\",\"sdk\",\"module\",\"link\",\"default\",\"v\",\"startup\",\"addButton\",\"id\",\"icon\",\"label\",\"context\",\"type\",\"action\",\"_\",\"props\",\"_props$message\",\"message\",\"subscription\",\"async\",\"_context\",\"prev\",\"next\",\"msg\",\"findOne\",\"rid\",\"abrupt\",\"navigate\",\"awrap\",\"close\",\"t\",\"name\",\"call\",\"t0\",\"stop\",\"Promise\",\"condition\",\"_ref\",\"user\",\"room\",\"isLivechatRoom\",\"u\",\"_id\",\"order\",\"group\"],\"mappings\":\"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\"}"}