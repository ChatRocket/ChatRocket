{"code":"function module(e,t,a){let l,n,r,c,o,u,i,s,m,p,d,k,f,g,h,E,b;a.link(\"@babel/runtime/helpers/objectSpread2\",{default(e){l=e}},0),a.link(\"@rocket.chat/fuselage\",{ButtonGroup(e){n=e},Button(e){r=e},Box(e){c=e}},0),a.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback(e){o=e},useUniqueId(e){u=e}},1),a.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch(e){i=e},useEndpoint(e){s=e}},2),a.link(\"react\",{default(e){m=e}},3),a.link(\"react-hook-form\",{useForm(e){p=e},FormProvider(e){d=e}},4),a.link(\"react-i18next\",{useTranslation(e){k=e}},5),a.link(\"../../../components/Page\",{Page(e){f=e},PageHeader(e){g=e},PageScrollableContentWithShadow(e){h=e},PageFooter(e){E=e}},6),a.link(\"./AppearanceForm\",{default(e){b=e}},7);let S=e=>e.reduce((e,t)=>{let{_id:a,value:n}=t;return e=l(l({},e),{},{[a]:n})},{});a.exportDefault(e=>{let{settings:t}=e,{t:a}=k(),l=i(),y=s(\"POST\",\"/v1/livechat/appearance\"),P=p({defaultValues:S(t)}),{reset:x,formState:{isDirty:v},handleSubmit:C,watch:F}=P,w=F(),B=o(async e=>{let t=Object.entries(e).map(e=>{let[t,a]=e;return{_id:t,value:a}});try{await y(t),l({type:\"success\",message:a(\"Settings_updated\")})}catch(e){l({type:\"error\",message:e})}finally{x(w)}}),D=u();return m.createElement(f,null,m.createElement(g,{title:a(\"Appearance\")}),m.createElement(h,null,m.createElement(c,{maxWidth:\"x600\",w:\"full\",alignSelf:\"center\"},m.createElement(d,P,m.createElement(\"form\",{id:D,onSubmit:C(B)},m.createElement(b,null))))),m.createElement(E,{isDirty:v},m.createElement(n,null,m.createElement(r,{onClick:()=>x()},a(\"Cancel\")),m.createElement(r,{form:D,type:\"submit\",primary:!0},a(\"Save_changes\")))))})}","map":"{\"version\":3,\"sources\":[\"client/views/omnichannel/appearance/AppearancePage.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { ISetting, Serialized } from '@rocket.chat/core-typings';\\nimport { ButtonGroup, Button, Box } from '@rocket.chat/fuselage';\\nimport { useMutableCallback, useUniqueId } from '@rocket.chat/fuselage-hooks';\\nimport { useToastMessageDispatch, useEndpoint } from '@rocket.chat/ui-contexts';\\nimport React from 'react';\\nimport { useForm, FormProvider } from 'react-hook-form';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { Page, PageHeader, PageScrollableContentWithShadow, PageFooter } from '../../../components/Page';\\nimport AppearanceForm from './AppearanceForm';\\n\\ntype LivechatAppearanceSettings = {\\n\\tLivechat_title: string;\\n\\tLivechat_title_color: string;\\n\\tLivechat_show_agent_info: boolean;\\n\\tLivechat_show_agent_email: boolean;\\n\\tLivechat_display_offline_form: boolean;\\n\\tLivechat_offline_form_unavailable: string;\\n\\tLivechat_offline_message: string;\\n\\tLivechat_offline_title: string;\\n\\tLivechat_offline_title_color: string;\\n\\tLivechat_offline_email: string;\\n\\tLivechat_offline_success_message: string;\\n\\tLivechat_registration_form: boolean;\\n\\tLivechat_name_field_registration_form: boolean;\\n\\tLivechat_email_field_registration_form: boolean;\\n\\tLivechat_registration_form_message: string;\\n\\tLivechat_conversation_finished_message: string;\\n\\tLivechat_conversation_finished_text: string;\\n\\tLivechat_enable_message_character_limit: boolean;\\n\\tLivechat_message_character_limit: number;\\n\\tOmnichannel_allow_visitors_to_close_conversation: boolean;\\n};\\n\\ntype AppearanceSettings = Partial<LivechatAppearanceSettings>;\\n\\nconst reduceAppearance = (settings: Serialized<ISetting>[]): AppearanceSettings =>\\n\\tsettings.reduce<Partial<LivechatAppearanceSettings>>((acc, { _id, value }) => {\\n\\t\\tacc = { ...acc, [_id]: value };\\n\\t\\treturn acc;\\n\\t}, {});\\n\\nconst AppearancePage = ({ settings }: { settings: Serialized<ISetting>[] }) => {\\n\\tconst { t } = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst saveAction = useEndpoint('POST', '/v1/livechat/appearance');\\n\\n\\tconst methods = useForm({ defaultValues: reduceAppearance(settings) });\\n\\tconst {\\n\\t\\treset,\\n\\t\\tformState: { isDirty },\\n\\t\\thandleSubmit,\\n\\t\\twatch,\\n\\t} = methods;\\n\\n\\tconst currentData = watch();\\n\\n\\tconst handleSave = useMutableCallback(async (data) => {\\n\\t\\tconst mappedAppearance = Object.entries(data).map(([_id, value]) => ({ _id, value })) as {\\n\\t\\t\\t_id: string;\\n\\t\\t\\tvalue: string | boolean | number;\\n\\t\\t}[];\\n\\n\\t\\ttry {\\n\\t\\t\\tawait saveAction(mappedAppearance);\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Settings_updated') });\\n\\t\\t} catch (error) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t} finally {\\n\\t\\t\\treset(currentData);\\n\\t\\t}\\n\\t});\\n\\n\\tconst formId = useUniqueId();\\n\\n\\treturn (\\n\\t\\t<Page>\\n\\t\\t\\t<PageHeader title={t('Appearance')} />\\n\\t\\t\\t<PageScrollableContentWithShadow>\\n\\t\\t\\t\\t<Box maxWidth='x600' w='full' alignSelf='center'>\\n\\t\\t\\t\\t\\t<FormProvider {...methods}>\\n\\t\\t\\t\\t\\t\\t<form id={formId} onSubmit={handleSubmit(handleSave)}>\\n\\t\\t\\t\\t\\t\\t\\t<AppearanceForm />\\n\\t\\t\\t\\t\\t\\t</form>\\n\\t\\t\\t\\t\\t</FormProvider>\\n\\t\\t\\t\\t</Box>\\n\\t\\t\\t</PageScrollableContentWithShadow>\\n\\t\\t\\t<PageFooter isDirty={isDirty}>\\n\\t\\t\\t\\t<ButtonGroup>\\n\\t\\t\\t\\t\\t<Button onClick={() => reset()}>{t('Cancel')}</Button>\\n\\t\\t\\t\\t\\t<Button form={formId} type='submit' primary>\\n\\t\\t\\t\\t\\t\\t{t('Save_changes')}\\n\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t</ButtonGroup>\\n\\t\\t\\t</PageFooter>\\n\\t\\t</Page>\\n\\t);\\n};\\n\\nexport default AppearancePage;\\n\",null],\"names\":[\"_objectSpread\",\"ButtonGroup\",\"Button\",\"Box\",\"useMutableCallback\",\"useUniqueId\",\"useToastMessageDispatch\",\"useEndpoint\",\"React\",\"useForm\",\"FormProvider\",\"useTranslation\",\"Page\",\"PageHeader\",\"PageScrollableContentWithShadow\",\"PageFooter\",\"AppearanceForm\",\"module\",\"link\",\"default\",\"v\",\"reduceAppearance\",\"settings\",\"reduce\",\"acc\",\"_ref\",\"_id\",\"value\",\"exportDefault\",\"_ref2\",\"t\",\"dispatchToastMessage\",\"saveAction\",\"methods\",\"defaultValues\",\"reset\",\"formState\",\"isDirty\",\"handleSubmit\",\"watch\",\"currentData\",\"handleSave\",\"data\",\"mappedAppearance\",\"Object\",\"entries\",\"map\",\"_ref3\",\"type\",\"message\",\"error\",\"formId\",\"createElement\",\"title\",\"maxWidth\",\"w\",\"alignSelf\",\"id\",\"onSubmit\",\"onClick\",\"form\",\"primary\"],\"mappings\":\"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\"}"}