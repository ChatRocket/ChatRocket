{"code":"function module(e,n,i){var t,s,r,o,a,u;i.link(\"meteor/meteor\",{Meteor:function(e){t=e}},0),i.link(\"../../app/models/client\",{ChatMessage:function(e){s=e},ChatSubscription:function(e){r=e}},1),i.link(\"../../app/settings/client\",{settings:function(e){o=e}},2),i.link(\"../../app/utils/lib/i18n\",{t:function(e){a=e}},3),i.link(\"../lib/toast\",{dispatchToastMessage:function(e){u=e}},4),t.methods({unpinMessage:function(e){return t.userId()?o.get(\"Message_AllowPinning\")?r.findOne({rid:e.rid})&&\"string\"==typeof e._id?(u({type:\"success\",message:a(\"Message_has_been_unpinned\")}),s.update({_id:e._id,rid:e.rid},{$set:{pinned:!1}}),!0):(u({type:\"error\",message:a(\"error-unpinning-message\")}),!1):(u({type:\"error\",message:a(\"unpinning-not-allowed\")}),!1):(u({type:\"error\",message:a(\"error-not-authorized\")}),!1)}})}","map":"{\"version\":3,\"sources\":[\"client/methods/unpinMessage.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IMessage } from '@rocket.chat/core-typings';\\nimport type { ServerMethods } from '@rocket.chat/ddp-client';\\nimport { Meteor } from 'meteor/meteor';\\n\\nimport { ChatMessage, ChatSubscription } from '../../app/models/client';\\nimport { settings } from '../../app/settings/client';\\nimport { t } from '../../app/utils/lib/i18n';\\nimport { dispatchToastMessage } from '../lib/toast';\\n\\nMeteor.methods<ServerMethods>({\\n\\tunpinMessage(message: IMessage) {\\n\\t\\tif (!Meteor.userId()) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('error-not-authorized') });\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\t\\tif (!settings.get('Message_AllowPinning')) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('unpinning-not-allowed') });\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\t\\tif (!ChatSubscription.findOne({ rid: message.rid })) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('error-unpinning-message') });\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\t\\tif (typeof message._id !== 'string') {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('error-unpinning-message') });\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\t\\tdispatchToastMessage({ type: 'success', message: t('Message_has_been_unpinned') });\\n\\t\\tChatMessage.update(\\n\\t\\t\\t{\\n\\t\\t\\t\\t_id: message._id,\\n\\t\\t\\t\\trid: message.rid,\\n\\t\\t\\t},\\n\\t\\t\\t{\\n\\t\\t\\t\\t$set: {\\n\\t\\t\\t\\t\\tpinned: false,\\n\\t\\t\\t\\t},\\n\\t\\t\\t},\\n\\t\\t);\\n\\n\\t\\treturn true;\\n\\t},\\n});\\n\",null],\"names\":[\"Meteor\",\"ChatMessage\",\"ChatSubscription\",\"settings\",\"t\",\"dispatchToastMessage\",\"module\",\"link\",\"v\",\"methods\",\"unpinMessage\",\"message\",\"userId\",\"get\",\"findOne\",\"rid\",\"_id\",\"type\",\"update\",\"$set\",\"pinned\"],\"mappings\":\"2BAEAA,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAP,OAAA,SAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,0BAAA,CAAAN,YAAA,SAAAO,CAAA,EAAAP,EAAAO,CAAA,EAAAN,iBAAA,SAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,4BAAA,CAAAJ,SAAA,SAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,2BAAA,CAAAH,EAAA,SAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,eAAA,CAAAF,qBAAA,SAAAG,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,GAOvCR,EAAOS,OAAO,CAAgB,CAC7BC,aAAY,SAACC,CAAiB,SAC7B,AAAKX,EAAOY,MAAM,GAIbT,EAASU,GAAG,CAAC,wBAIbX,EAAiBY,OAAO,CAAC,CAAEC,IAAKJ,EAAQI,GAAAA,AAAG,IAI5C,AAAuB,UAAvB,OAAOJ,EAAQK,GAAG,EAItBX,EAAqB,CAAEY,KAAM,UAAWN,QAASP,EAAE,4BAA4B,GAC/EH,EAAYiB,MAAM,CACjB,CACCF,IAAKL,EAAQK,GAAG,CAChBD,IAAKJ,EAAQI,GAAAA,EAEd,CACCI,KAAM,CACLC,OAAQ,CAAA,KAKJ,CAAA,IApBNf,EAAqB,CAAEY,KAAM,QAASN,QAASP,EAAE,0BAA0B,GACpE,CAAA,IALPC,EAAqB,CAAEY,KAAM,QAASN,QAASP,EAAE,wBAAwB,GAClE,CAAA,IALPC,EAAqB,CAAEY,KAAM,QAASN,QAASP,EAAE,uBAAuB,GACjE,CAAA,EA4BT\"}"}