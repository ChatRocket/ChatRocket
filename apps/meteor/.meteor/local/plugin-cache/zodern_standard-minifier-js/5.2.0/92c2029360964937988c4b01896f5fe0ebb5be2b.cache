{"code":"function module(e,t,n){var a,r,c,u,i,l,o,s,f,m,p,d,k,h,b,g,v,E,S;n.link(\"@babel/runtime/regenerator\",{default:function(e){a=e}},0),n.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){r=e}},1),n.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(e){c=e}},2),n.link(\"@rocket.chat/fuselage\",{ButtonGroup:function(e){u=e},Button:function(e){i=e},Box:function(e){l=e}},0),n.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback:function(e){o=e},useUniqueId:function(e){s=e}},1),n.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch:function(e){f=e},useEndpoint:function(e){m=e}},2),n.link(\"react\",{default:function(e){p=e}},3),n.link(\"react-hook-form\",{useForm:function(e){d=e},FormProvider:function(e){k=e}},4),n.link(\"react-i18next\",{useTranslation:function(e){h=e}},5),n.link(\"../../../components/Page\",{Page:function(e){b=e},PageHeader:function(e){g=e},PageScrollableContentWithShadow:function(e){v=e},PageFooter:function(e){E=e}},6),n.link(\"./AppearanceForm\",{default:function(e){S=e}},7),n.exportDefault(function(e){var t=e.settings,n=h().t,x=f(),y=m(\"POST\",\"/v1/livechat/appearance\"),P=d({defaultValues:t.reduce(function(e,t){var n,a=t._id,r=t.value;return e=c(c({},e),{},((n={})[a]=r,n))},{})}),w=P.reset,C=P.formState.isDirty,D=P.handleSubmit,F=(0,P.watch)(),T=o(function(e){var t;return a.async(function(c){for(;;)switch(c.prev=c.next){case 0:return t=Object.entries(e).map(function(e){var t=r(e,2);return{_id:t[0],value:t[1]}}),c.prev=1,c.next=4,a.awrap(y(t));case 4:x({type:\"success\",message:n(\"Settings_updated\")}),c.next=10;break;case 7:c.prev=7,c.t0=c.catch(1),x({type:\"error\",message:c.t0});case 10:return c.prev=10,w(F),c.finish(10);case 13:case\"end\":return c.stop()}},null,null,[[1,7,10,13]],Promise)}),_=s();return p.createElement(b,null,p.createElement(g,{title:n(\"Appearance\")}),p.createElement(v,null,p.createElement(l,{maxWidth:\"x600\",w:\"full\",alignSelf:\"center\"},p.createElement(k,P,p.createElement(\"form\",{id:_,onSubmit:D(T)},p.createElement(S,null))))),p.createElement(E,{isDirty:C},p.createElement(u,null,p.createElement(i,{onClick:function(){return w()}},n(\"Cancel\")),p.createElement(i,{form:_,type:\"submit\",primary:!0},n(\"Save_changes\")))))})}","map":"{\"version\":3,\"sources\":[\"client/views/omnichannel/appearance/AppearancePage.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { ISetting, Serialized } from '@rocket.chat/core-typings';\\nimport { ButtonGroup, Button, Box } from '@rocket.chat/fuselage';\\nimport { useMutableCallback, useUniqueId } from '@rocket.chat/fuselage-hooks';\\nimport { useToastMessageDispatch, useEndpoint } from '@rocket.chat/ui-contexts';\\nimport React from 'react';\\nimport { useForm, FormProvider } from 'react-hook-form';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { Page, PageHeader, PageScrollableContentWithShadow, PageFooter } from '../../../components/Page';\\nimport AppearanceForm from './AppearanceForm';\\n\\ntype LivechatAppearanceSettings = {\\n\\tLivechat_title: string;\\n\\tLivechat_title_color: string;\\n\\tLivechat_show_agent_info: boolean;\\n\\tLivechat_show_agent_email: boolean;\\n\\tLivechat_display_offline_form: boolean;\\n\\tLivechat_offline_form_unavailable: string;\\n\\tLivechat_offline_message: string;\\n\\tLivechat_offline_title: string;\\n\\tLivechat_offline_title_color: string;\\n\\tLivechat_offline_email: string;\\n\\tLivechat_offline_success_message: string;\\n\\tLivechat_registration_form: boolean;\\n\\tLivechat_name_field_registration_form: boolean;\\n\\tLivechat_email_field_registration_form: boolean;\\n\\tLivechat_registration_form_message: string;\\n\\tLivechat_conversation_finished_message: string;\\n\\tLivechat_conversation_finished_text: string;\\n\\tLivechat_enable_message_character_limit: boolean;\\n\\tLivechat_message_character_limit: number;\\n\\tOmnichannel_allow_visitors_to_close_conversation: boolean;\\n};\\n\\ntype AppearanceSettings = Partial<LivechatAppearanceSettings>;\\n\\nconst reduceAppearance = (settings: Serialized<ISetting>[]): AppearanceSettings =>\\n\\tsettings.reduce<Partial<LivechatAppearanceSettings>>((acc, { _id, value }) => {\\n\\t\\tacc = { ...acc, [_id]: value };\\n\\t\\treturn acc;\\n\\t}, {});\\n\\nconst AppearancePage = ({ settings }: { settings: Serialized<ISetting>[] }) => {\\n\\tconst { t } = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst saveAction = useEndpoint('POST', '/v1/livechat/appearance');\\n\\n\\tconst methods = useForm({ defaultValues: reduceAppearance(settings) });\\n\\tconst {\\n\\t\\treset,\\n\\t\\tformState: { isDirty },\\n\\t\\thandleSubmit,\\n\\t\\twatch,\\n\\t} = methods;\\n\\n\\tconst currentData = watch();\\n\\n\\tconst handleSave = useMutableCallback(async (data) => {\\n\\t\\tconst mappedAppearance = Object.entries(data).map(([_id, value]) => ({ _id, value })) as {\\n\\t\\t\\t_id: string;\\n\\t\\t\\tvalue: string | boolean | number;\\n\\t\\t}[];\\n\\n\\t\\ttry {\\n\\t\\t\\tawait saveAction(mappedAppearance);\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Settings_updated') });\\n\\t\\t} catch (error) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t} finally {\\n\\t\\t\\treset(currentData);\\n\\t\\t}\\n\\t});\\n\\n\\tconst formId = useUniqueId();\\n\\n\\treturn (\\n\\t\\t<Page>\\n\\t\\t\\t<PageHeader title={t('Appearance')} />\\n\\t\\t\\t<PageScrollableContentWithShadow>\\n\\t\\t\\t\\t<Box maxWidth='x600' w='full' alignSelf='center'>\\n\\t\\t\\t\\t\\t<FormProvider {...methods}>\\n\\t\\t\\t\\t\\t\\t<form id={formId} onSubmit={handleSubmit(handleSave)}>\\n\\t\\t\\t\\t\\t\\t\\t<AppearanceForm />\\n\\t\\t\\t\\t\\t\\t</form>\\n\\t\\t\\t\\t\\t</FormProvider>\\n\\t\\t\\t\\t</Box>\\n\\t\\t\\t</PageScrollableContentWithShadow>\\n\\t\\t\\t<PageFooter isDirty={isDirty}>\\n\\t\\t\\t\\t<ButtonGroup>\\n\\t\\t\\t\\t\\t<Button onClick={() => reset()}>{t('Cancel')}</Button>\\n\\t\\t\\t\\t\\t<Button form={formId} type='submit' primary>\\n\\t\\t\\t\\t\\t\\t{t('Save_changes')}\\n\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t</ButtonGroup>\\n\\t\\t\\t</PageFooter>\\n\\t\\t</Page>\\n\\t);\\n};\\n\\nexport default AppearancePage;\\n\",null],\"names\":[\"_regeneratorRuntime\",\"_slicedToArray\",\"_objectSpread\",\"ButtonGroup\",\"Button\",\"Box\",\"useMutableCallback\",\"useUniqueId\",\"useToastMessageDispatch\",\"useEndpoint\",\"React\",\"useForm\",\"FormProvider\",\"useTranslation\",\"Page\",\"PageHeader\",\"PageScrollableContentWithShadow\",\"PageFooter\",\"AppearanceForm\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref2\",\"settings\",\"t\",\"_useTranslation\",\"dispatchToastMessage\",\"saveAction\",\"methods\",\"defaultValues\",\"reduce\",\"acc\",\"_ref\",\"_objectSpread2\",\"_id\",\"value\",\"reset\",\"isDirty\",\"formState\",\"handleSubmit\",\"currentData\",\"watch\",\"handleSave\",\"data\",\"mappedAppearance\",\"async\",\"_context\",\"prev\",\"next\",\"Object\",\"entries\",\"map\",\"_ref3\",\"_ref4\",\"awrap\",\"type\",\"message\",\"t0\",\"finish\",\"stop\",\"Promise\",\"formId\",\"createElement\",\"title\",\"maxWidth\",\"w\",\"alignSelf\",\"id\",\"onSubmit\",\"onClick\",\"form\",\"primary\"],\"mappings\":\"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\"}"}