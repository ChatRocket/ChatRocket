{"code":"function module(e,n,r){r.link(\"@babel/runtime/regenerator\",{default:function(e){t=e}},0),r.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(e){s=e}},1),r.export({createDataAPI:function(){return v}}),r.link(\"@rocket.chat/random\",{Random:function(e){u=e}},0),r.link(\"moment\",{default:function(e){a=e}},1),r.link(\"../../../app/authorization/client\",{hasAtLeastOnePermission:function(e){i=e},hasPermission:function(e){c=e}},2),r.link(\"../../../app/models/client\",{Messages:function(e){o=e},ChatRoom:function(e){l=e},ChatSubscription:function(e){d=e}},3),r.link(\"../../../app/settings/client\",{settings:function(e){f=e}},4),r.link(\"../../../app/ui-utils/client\",{MessageTypes:function(e){p=e}},5),r.link(\"../../../app/utils/client/lib/SDKClient\",{sdk:function(e){b=e}},6),r.link(\"../utils/prependReplies\",{prependReplies:function(e){x=e}},7);var t,s,u,a,i,c,o,l,d,f,p,b,x,v=function(e){var n=e.rid,r=e.tmid,v=function(e){var n;return t.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt(\"return\",null!==(n=o.findOne({_id:e,_hidden:{$ne:!0}},{reactive:!1}))&&void 0!==n?n:b.call(\"getSingleMessage\",e));case 1:case\"end\":return r.stop()}},null,null,null,Promise)},m=function(){return t.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",o.findOne({rid:n,tmid:null!=r?r:{$exists:!1},_hidden:{$ne:!0}},{sort:{ts:-1},reactive:!1}));case 1:case\"end\":return e.stop()}},null,null,null,Promise)},g=function(){var e;return t.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=Meteor.userId()){t.next=3;break}return t.abrupt(\"return\",void 0);case 3:return t.abrupt(\"return\",o.findOne({rid:n,tmid:null!=r?r:{$exists:!1},\"u._id\":e,_hidden:{$ne:!0}},{sort:{ts:-1},reactive:!1}));case 4:case\"end\":return t.stop()}},null,null,null,Promise)},w=function(e){var n,r,s,u,o,l,d;return t.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(!p.isSystemMessage(e)){t.next=2;break}return t.abrupt(\"return\",!1);case 2:if(r=i(\"edit-message\",e.rid),s=null!==(n=f.get(\"Message_AllowEditing\"))&&void 0!==n&&n,u=(null==e?void 0:e.u)&&e.u._id===Meteor.userId(),!(!r&&(!s||!u))){t.next=7;break}return t.abrupt(\"return\",!1);case 7:if(o=f.get(\"Message_AllowEditing_BlockEditInMinutes\"),l=c(\"bypass-time-limit-edit-and-delete\",e.rid),d=a().diff(e.ts,\"minutes\"),!(!l&&d&&o&&d>o)){t.next=12;break}return t.abrupt(\"return\",!1);case 12:return t.abrupt(\"return\",!0);case 13:case\"end\":return t.stop()}},null,null,null,Promise)},h=function(e){var s,u;return t.async(function(a){for(;;)switch(a.prev=a.next){case 0:if(s=Meteor.userId()){a.next=3;break}return a.abrupt(\"return\",void 0);case 3:if(u=o.findOne({rid:n,tmid:null!=r?r:{$exists:!1},\"u._id\":s,_hidden:{$ne:!0},ts:{$lt:e.ts}},{sort:{ts:-1},reactive:!1})){a.next=6;break}return a.abrupt(\"return\",void 0);case 6:return a.next=8,t.awrap(w(u));case 8:if(!a.sent){a.next=10;break}return a.abrupt(\"return\",u);case 10:return a.abrupt(\"return\",h(u));case 11:case\"end\":return a.stop()}},null,null,null,Promise)},M=function(e){var s,u;return t.async(function(a){for(;;)switch(a.prev=a.next){case 0:if(s=Meteor.userId()){a.next=3;break}return a.abrupt(\"return\",void 0);case 3:if(u=o.findOne({rid:n,tmid:null!=r?r:{$exists:!1},\"u._id\":s,_hidden:{$ne:!0},ts:{$gt:e.ts}},{sort:{ts:1},reactive:!1})){a.next=6;break}return a.abrupt(\"return\",void 0);case 6:return a.next=8,t.awrap(w(u));case 8:if(!a.sent){a.next=10;break}return a.abrupt(\"return\",u);case 10:return a.abrupt(\"return\",M(u));case 11:case\"end\":return a.stop()}},null,null,null,Promise)},k=new Map,y=function(){return t.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",l.findOne({_id:n},{reactive:!1}));case 1:case\"end\":return e.stop()}},null,null,null,Promise)},P=function(e){return t.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt(\"return\",l.findOne({_id:e,prid:{$exists:!0}},{reactive:!1}));case 1:case\"end\":return n.stop()}},null,null,null,Promise)},_=function(e,n){return function(){var r,s=arguments;return t.async(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.awrap(e.apply(void 0,s));case 2:if(r=u.sent){u.next=5;break}throw Error(n);case 5:return u.abrupt(\"return\",r);case 6:case\"end\":return u.stop()}},null,null,null,Promise)}},O=function(){return t.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",d.findOne({rid:n},{reactive:!1}));case 1:case\"end\":return e.stop()}},null,null,null,Promise)},D=_(O,\"Subscription not found\"),I=function(e){return t.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt(\"return\",d.findOne({rid:e.rid},{reactive:!1}));case 1:case\"end\":return n.stop()}},null,null,null,Promise)},E=_(I,\"Subscription not found\");return{composeMessage:function(e,a){var i,c,o,l,d,f,p,b;return t.async(function(v){for(;;)switch(v.prev=v.next){case 0:return o=a.sendToChannel,l=a.quotedMessages,d=a.originalMessage,v.next=3,t.awrap(x(e,l));case 3:return f=v.sent,p=null!==(i=null==d?void 0:d.rid)&&void 0!==i?i:n,b=d?d.tmid:r,v.abrupt(\"return\",s(s({_id:null!==(c=null==d?void 0:d._id)&&void 0!==c?c:u.id(),rid:p},b&&s({tmid:b},o&&{tshow:o})),{},{msg:f}));case 7:case\"end\":return v.stop()}},null,null,null,Promise)},findMessageByID:v,getMessageByID:function(e){var n;return t.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.awrap(v(e));case 2:if(n=r.sent){r.next=5;break}throw Error(\"Message not found\");case 5:return r.abrupt(\"return\",n);case 6:case\"end\":return r.stop()}},null,null,null,Promise)},findLastMessage:m,getLastMessage:function(){var e;return t.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.awrap(m());case 2:if(e=n.sent){n.next=5;break}throw Error(\"Message not found\");case 5:return n.abrupt(\"return\",e);case 6:case\"end\":return n.stop()}},null,null,null,Promise)},findLastOwnMessage:g,getLastOwnMessage:function(){var e;return t.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.awrap(g());case 2:if(e=n.sent){n.next=5;break}throw Error(\"Message not found\");case 5:return n.abrupt(\"return\",e);case 6:case\"end\":return n.stop()}},null,null,null,Promise)},findPreviousOwnMessage:h,getPreviousOwnMessage:function(e){var n;return t.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.awrap(h(e));case 2:if(n=r.sent){r.next=5;break}throw Error(\"Message not found\");case 5:return r.abrupt(\"return\",n);case 6:case\"end\":return r.stop()}},null,null,null,Promise)},findNextOwnMessage:M,getNextOwnMessage:function(e){var n;return t.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.awrap(M(e));case 2:if(n=r.sent){r.next=5;break}throw Error(\"Message not found\");case 5:return r.abrupt(\"return\",n);case 6:case\"end\":return r.stop()}},null,null,null,Promise)},pushEphemeralMessage:function(e){return t.async(function(t){for(;;)switch(t.prev=t.next){case 0:o.upsert({_id:e._id},{$set:s(s({},e),{},{rid:n},r&&{tmid:r})});case 1:case\"end\":return t.stop()}},null,null,null,Promise)},canUpdateMessage:w,updateMessage:function(e,n){return t.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt(\"return\",b.call(\"updateMessage\",e,n));case 1:case\"end\":return r.stop()}},null,null,null,Promise)},canDeleteMessage:function(e){var r,s,u,i,o,l,d;return t.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(Meteor.userId()){t.next=3;break}return t.abrupt(\"return\",!1);case 3:if(!p.isSystemMessage(e)){t.next=5;break}return t.abrupt(\"return\",!1);case 5:if(!c(\"force-delete-message\",e.rid)){t.next=8;break}return t.abrupt(\"return\",!0);case 8:if(f.get(\"Message_AllowDeleting\")){t.next=11;break}return t.abrupt(\"return\",!1);case 11:if(r=c(\"delete-message\",n),s=c(\"delete-own-message\"),u=r||s&&(null==e?void 0:e.u)&&e.u._id===Meteor.userId()){t.next=16;break}return t.abrupt(\"return\",!1);case 16:return i=f.get(\"Message_AllowDeleting_BlockDeleteInMinutes\"),o=c(\"bypass-time-limit-edit-and-delete\",e.rid),l=a().diff(e.ts,\"minutes\"),d=o||!i||!l||l<=i,t.abrupt(\"return\",u&&d);case 21:case\"end\":return t.stop()}},null,null,null,Promise)},deleteMessage:function(e){var n,r,s;return t.async(function(u){for(;;)switch(u.prev=u.next){case 0:if(\"string\"!=typeof e){u.next=10;break}return n=e,u.next=4,t.awrap(v(n));case 4:if(s=u.sent){u.next=7;break}throw Error(\"Message not found\");case 7:r=s.rid,u.next=12;break;case 10:n=e._id,r=e.rid;case 12:return u.next=14,t.awrap(b.rest.post(\"/v1/chat.delete\",{msgId:n,roomId:r}));case 14:case\"end\":return u.stop()}},null,null,null,Promise)},getDraft:function(e){return t.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt(\"return\",k.get(e));case 1:case\"end\":return n.stop()}},null,null,null,Promise)},saveDraft:function(e,n){return t.async(function(r){for(;;)switch(r.prev=r.next){case 0:k.set(e,n);case 1:case\"end\":return r.stop()}},null,null,null,Promise)},discardDraft:function(e){return t.async(function(n){for(;;)switch(n.prev=n.next){case 0:k.delete(e);case 1:case\"end\":return n.stop()}},null,null,null,Promise)},findRoom:y,getRoom:function(){var e;return t.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.awrap(y());case 2:if(e=n.sent){n.next=5;break}throw Error(\"Room not found\");case 5:return n.abrupt(\"return\",e);case 6:case\"end\":return n.stop()}},null,null,null,Promise)},isSubscribedToRoom:function(){return t.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",!!d.findOne({rid:n},{reactive:!1}));case 1:case\"end\":return e.stop()}},null,null,null,Promise)},joinRoom:function(){return t.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.awrap(b.call(\"joinRoom\",n));case 2:case\"end\":return e.stop()}},null,null,null,Promise)},findDiscussionByID:P,getDiscussionByID:function(e){var n;return t.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.awrap(P(e));case 2:if(n=r.sent){r.next=5;break}throw Error(\"Discussion not found\");case 5:return r.abrupt(\"return\",n);case 6:case\"end\":return r.stop()}},null,null,null,Promise)},findSubscription:O,getSubscription:D,findSubscriptionFromMessage:I,getSubscriptionFromMessage:E}}}","map":"{\"version\":3,\"sources\":[\"client/lib/chats/data.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IEditedMessage, IMessage, IRoom, ISubscription } from '@rocket.chat/core-typings';\\nimport { Random } from '@rocket.chat/random';\\nimport moment from 'moment';\\n\\nimport { hasAtLeastOnePermission, hasPermission } from '../../../app/authorization/client';\\nimport { Messages, ChatRoom, ChatSubscription } from '../../../app/models/client';\\nimport { settings } from '../../../app/settings/client';\\nimport { MessageTypes } from '../../../app/ui-utils/client';\\nimport { sdk } from '../../../app/utils/client/lib/SDKClient';\\nimport { prependReplies } from '../utils/prependReplies';\\nimport type { DataAPI } from './ChatAPI';\\n\\nexport const createDataAPI = ({ rid, tmid }: { rid: IRoom['_id']; tmid: IMessage['_id'] | undefined }): DataAPI => {\\n\\tconst composeMessage = async (\\n\\t\\ttext: string,\\n\\t\\t{ sendToChannel, quotedMessages, originalMessage }: { sendToChannel?: boolean; quotedMessages: IMessage[]; originalMessage?: IMessage },\\n\\t): Promise<IMessage> => {\\n\\t\\tconst msg = await prependReplies(text, quotedMessages);\\n\\n\\t\\tconst effectiveRID = originalMessage?.rid ?? rid;\\n\\t\\tconst effectiveTMID = originalMessage ? originalMessage.tmid : tmid;\\n\\n\\t\\treturn {\\n\\t\\t\\t_id: originalMessage?._id ?? Random.id(),\\n\\t\\t\\trid: effectiveRID,\\n\\t\\t\\t...(effectiveTMID && {\\n\\t\\t\\t\\ttmid: effectiveTMID,\\n\\t\\t\\t\\t...(sendToChannel && { tshow: sendToChannel }),\\n\\t\\t\\t}),\\n\\t\\t\\tmsg,\\n\\t\\t} as IMessage;\\n\\t};\\n\\n\\tconst findMessageByID = async (mid: IMessage['_id']): Promise<IMessage | null> =>\\n\\t\\tMessages.findOne({ _id: mid, _hidden: { $ne: true } }, { reactive: false }) ?? sdk.call('getSingleMessage', mid);\\n\\n\\tconst getMessageByID = async (mid: IMessage['_id']): Promise<IMessage> => {\\n\\t\\tconst message = await findMessageByID(mid);\\n\\n\\t\\tif (!message) {\\n\\t\\t\\tthrow new Error('Message not found');\\n\\t\\t}\\n\\n\\t\\treturn message;\\n\\t};\\n\\n\\tconst findLastMessage = async (): Promise<IMessage | undefined> =>\\n\\t\\tMessages.findOne({ rid, tmid: tmid ?? { $exists: false }, _hidden: { $ne: true } }, { sort: { ts: -1 }, reactive: false });\\n\\n\\tconst getLastMessage = async (): Promise<IMessage> => {\\n\\t\\tconst message = await findLastMessage();\\n\\n\\t\\tif (!message) {\\n\\t\\t\\tthrow new Error('Message not found');\\n\\t\\t}\\n\\n\\t\\treturn message;\\n\\t};\\n\\n\\tconst findLastOwnMessage = async (): Promise<IMessage | undefined> => {\\n\\t\\tconst uid = Meteor.userId();\\n\\n\\t\\tif (!uid) {\\n\\t\\t\\treturn undefined;\\n\\t\\t}\\n\\n\\t\\treturn Messages.findOne(\\n\\t\\t\\t{ rid, 'tmid': tmid ?? { $exists: false }, 'u._id': uid, '_hidden': { $ne: true } },\\n\\t\\t\\t{ sort: { ts: -1 }, reactive: false },\\n\\t\\t);\\n\\t};\\n\\n\\tconst getLastOwnMessage = async (): Promise<IMessage> => {\\n\\t\\tconst message = await findLastOwnMessage();\\n\\n\\t\\tif (!message) {\\n\\t\\t\\tthrow new Error('Message not found');\\n\\t\\t}\\n\\n\\t\\treturn message;\\n\\t};\\n\\n\\tconst canUpdateMessage = async (message: IMessage): Promise<boolean> => {\\n\\t\\tif (MessageTypes.isSystemMessage(message)) {\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\n\\t\\tconst canEditMessage = hasAtLeastOnePermission('edit-message', message.rid);\\n\\t\\tconst editAllowed = (settings.get('Message_AllowEditing') as boolean | undefined) ?? false;\\n\\t\\tconst editOwn = message?.u && message.u._id === Meteor.userId();\\n\\n\\t\\tif (!canEditMessage && (!editAllowed || !editOwn)) {\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\n\\t\\tconst blockEditInMinutes = settings.get('Message_AllowEditing_BlockEditInMinutes') as number | undefined;\\n\\t\\tconst bypassBlockTimeLimit = hasPermission('bypass-time-limit-edit-and-delete', message.rid);\\n\\n\\t\\tconst elapsedMinutes = moment().diff(message.ts, 'minutes');\\n\\t\\tif (!bypassBlockTimeLimit && elapsedMinutes && blockEditInMinutes && elapsedMinutes > blockEditInMinutes) {\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\n\\t\\treturn true;\\n\\t};\\n\\n\\tconst findPreviousOwnMessage = async (message: IMessage): Promise<IMessage | undefined> => {\\n\\t\\tconst uid = Meteor.userId();\\n\\n\\t\\tif (!uid) {\\n\\t\\t\\treturn undefined;\\n\\t\\t}\\n\\n\\t\\tconst msg = Messages.findOne(\\n\\t\\t\\t{ rid, 'tmid': tmid ?? { $exists: false }, 'u._id': uid, '_hidden': { $ne: true }, 'ts': { $lt: message.ts } },\\n\\t\\t\\t{ sort: { ts: -1 }, reactive: false },\\n\\t\\t);\\n\\n\\t\\tif (!msg) {\\n\\t\\t\\treturn undefined;\\n\\t\\t}\\n\\n\\t\\tif (await canUpdateMessage(msg)) {\\n\\t\\t\\treturn msg;\\n\\t\\t}\\n\\n\\t\\treturn findPreviousOwnMessage(msg);\\n\\t};\\n\\n\\tconst getPreviousOwnMessage = async (message: IMessage): Promise<IMessage> => {\\n\\t\\tconst previousMessage = await findPreviousOwnMessage(message);\\n\\n\\t\\tif (!previousMessage) {\\n\\t\\t\\tthrow new Error('Message not found');\\n\\t\\t}\\n\\n\\t\\treturn previousMessage;\\n\\t};\\n\\n\\tconst findNextOwnMessage = async (message: IMessage): Promise<IMessage | undefined> => {\\n\\t\\tconst uid = Meteor.userId();\\n\\n\\t\\tif (!uid) {\\n\\t\\t\\treturn undefined;\\n\\t\\t}\\n\\n\\t\\tconst msg = Messages.findOne(\\n\\t\\t\\t{ rid, 'tmid': tmid ?? { $exists: false }, 'u._id': uid, '_hidden': { $ne: true }, 'ts': { $gt: message.ts } },\\n\\t\\t\\t{ sort: { ts: 1 }, reactive: false },\\n\\t\\t);\\n\\n\\t\\tif (!msg) {\\n\\t\\t\\treturn undefined;\\n\\t\\t}\\n\\n\\t\\tif (await canUpdateMessage(msg)) {\\n\\t\\t\\treturn msg;\\n\\t\\t}\\n\\n\\t\\treturn findNextOwnMessage(msg);\\n\\t};\\n\\n\\tconst getNextOwnMessage = async (message: IMessage): Promise<IMessage> => {\\n\\t\\tconst nextMessage = await findNextOwnMessage(message);\\n\\n\\t\\tif (!nextMessage) {\\n\\t\\t\\tthrow new Error('Message not found');\\n\\t\\t}\\n\\n\\t\\treturn nextMessage;\\n\\t};\\n\\n\\tconst pushEphemeralMessage = async (message: Omit<IMessage, 'rid' | 'tmid'>): Promise<void> => {\\n\\t\\tMessages.upsert({ _id: message._id }, { $set: { ...message, rid, ...(tmid && { tmid }) } });\\n\\t};\\n\\n\\tconst updateMessage = async (message: IEditedMessage, previewUrls?: string[]): Promise<void> =>\\n\\t\\tsdk.call('updateMessage', message, previewUrls);\\n\\n\\tconst canDeleteMessage = async (message: IMessage): Promise<boolean> => {\\n\\t\\tconst uid = Meteor.userId();\\n\\n\\t\\tif (!uid) {\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\n\\t\\tif (MessageTypes.isSystemMessage(message)) {\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\n\\t\\tconst forceDeleteAllowed = hasPermission('force-delete-message', message.rid);\\n\\t\\tif (forceDeleteAllowed) {\\n\\t\\t\\treturn true;\\n\\t\\t}\\n\\n\\t\\tconst deletionEnabled = settings.get('Message_AllowDeleting') as boolean | undefined;\\n\\t\\tif (!deletionEnabled) {\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\n\\t\\tconst deleteAnyAllowed = hasPermission('delete-message', rid);\\n\\t\\tconst deleteOwnAllowed = hasPermission('delete-own-message');\\n\\t\\tconst deleteAllowed = deleteAnyAllowed || (deleteOwnAllowed && message?.u && message.u._id === Meteor.userId());\\n\\n\\t\\tif (!deleteAllowed) {\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\n\\t\\tconst blockDeleteInMinutes = settings.get('Message_AllowDeleting_BlockDeleteInMinutes') as number | undefined;\\n\\t\\tconst bypassBlockTimeLimit = hasPermission('bypass-time-limit-edit-and-delete', message.rid);\\n\\t\\tconst elapsedMinutes = moment().diff(message.ts, 'minutes');\\n\\t\\tconst onTimeForDelete = bypassBlockTimeLimit || !blockDeleteInMinutes || !elapsedMinutes || elapsedMinutes <= blockDeleteInMinutes;\\n\\n\\t\\treturn deleteAllowed && onTimeForDelete;\\n\\t};\\n\\n\\tconst deleteMessage = async (msgIdOrMsg: IMessage | IMessage['_id']): Promise<void> => {\\n\\t\\tlet msgId: string;\\n\\t\\tlet roomId: string;\\n\\t\\tif (typeof msgIdOrMsg === 'string') {\\n\\t\\t\\tmsgId = msgIdOrMsg;\\n\\t\\t\\tconst msg = await findMessageByID(msgId);\\n\\t\\t\\tif (!msg) {\\n\\t\\t\\t\\tthrow new Error('Message not found');\\n\\t\\t\\t}\\n\\t\\t\\troomId = msg.rid;\\n\\t\\t} else {\\n\\t\\t\\tmsgId = msgIdOrMsg._id;\\n\\t\\t\\troomId = msgIdOrMsg.rid;\\n\\t\\t}\\n\\n\\t\\tawait sdk.rest.post('/v1/chat.delete', { msgId, roomId });\\n\\t};\\n\\n\\tconst drafts = new Map<IMessage['_id'] | undefined, string>();\\n\\n\\tconst getDraft = async (mid: IMessage['_id'] | undefined): Promise<string | undefined> => drafts.get(mid);\\n\\n\\tconst discardDraft = async (mid: IMessage['_id'] | undefined): Promise<void> => {\\n\\t\\tdrafts.delete(mid);\\n\\t};\\n\\n\\tconst saveDraft = async (mid: IMessage['_id'] | undefined, draft: string): Promise<void> => {\\n\\t\\tdrafts.set(mid, draft);\\n\\t};\\n\\n\\tconst findRoom = async (): Promise<IRoom | undefined> => ChatRoom.findOne({ _id: rid }, { reactive: false });\\n\\n\\tconst getRoom = async (): Promise<IRoom> => {\\n\\t\\tconst room = await findRoom();\\n\\n\\t\\tif (!room) {\\n\\t\\t\\tthrow new Error('Room not found');\\n\\t\\t}\\n\\n\\t\\treturn room;\\n\\t};\\n\\n\\tconst isSubscribedToRoom = async (): Promise<boolean> => !!ChatSubscription.findOne({ rid }, { reactive: false });\\n\\n\\tconst joinRoom = async (): Promise<void> => {\\n\\t\\tawait sdk.call('joinRoom', rid);\\n\\t};\\n\\n\\tconst findDiscussionByID = async (drid: IRoom['_id']): Promise<IRoom | undefined> =>\\n\\t\\tChatRoom.findOne({ _id: drid, prid: { $exists: true } }, { reactive: false });\\n\\n\\tconst getDiscussionByID = async (drid: IRoom['_id']): Promise<IRoom> => {\\n\\t\\tconst discussion = await findDiscussionByID(drid);\\n\\n\\t\\tif (!discussion) {\\n\\t\\t\\tthrow new Error('Discussion not found');\\n\\t\\t}\\n\\n\\t\\treturn discussion;\\n\\t};\\n\\n\\tconst createStrictGetter = <TFind extends (...args: any[]) => Promise<any>>(\\n\\t\\tfind: TFind,\\n\\t\\terrorMessage: string,\\n\\t): ((...args: Parameters<TFind>) => Promise<Exclude<Awaited<ReturnType<TFind>>, undefined>>) => {\\n\\t\\treturn async (...args) => {\\n\\t\\t\\tconst result = await find(...args);\\n\\n\\t\\t\\tif (!result) {\\n\\t\\t\\t\\tthrow new Error(errorMessage);\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn result;\\n\\t\\t};\\n\\t};\\n\\n\\tconst findSubscription = async (): Promise<ISubscription | undefined> => {\\n\\t\\treturn ChatSubscription.findOne({ rid }, { reactive: false });\\n\\t};\\n\\n\\tconst getSubscription = createStrictGetter(findSubscription, 'Subscription not found');\\n\\n\\tconst findSubscriptionFromMessage = async (message: IMessage): Promise<ISubscription | undefined> => {\\n\\t\\treturn ChatSubscription.findOne({ rid: message.rid }, { reactive: false });\\n\\t};\\n\\n\\tconst getSubscriptionFromMessage = createStrictGetter(findSubscriptionFromMessage, 'Subscription not found');\\n\\n\\treturn {\\n\\t\\tcomposeMessage,\\n\\t\\tfindMessageByID,\\n\\t\\tgetMessageByID,\\n\\t\\tfindLastMessage,\\n\\t\\tgetLastMessage,\\n\\t\\tfindLastOwnMessage,\\n\\t\\tgetLastOwnMessage,\\n\\t\\tfindPreviousOwnMessage,\\n\\t\\tgetPreviousOwnMessage,\\n\\t\\tfindNextOwnMessage,\\n\\t\\tgetNextOwnMessage,\\n\\t\\tpushEphemeralMessage,\\n\\t\\tcanUpdateMessage,\\n\\t\\tupdateMessage,\\n\\t\\tcanDeleteMessage,\\n\\t\\tdeleteMessage,\\n\\t\\tgetDraft,\\n\\t\\tsaveDraft,\\n\\t\\tdiscardDraft,\\n\\t\\tfindRoom,\\n\\t\\tgetRoom,\\n\\t\\tisSubscribedToRoom,\\n\\t\\tjoinRoom,\\n\\t\\tfindDiscussionByID,\\n\\t\\tgetDiscussionByID,\\n\\t\\tfindSubscription,\\n\\t\\tgetSubscription,\\n\\t\\tfindSubscriptionFromMessage,\\n\\t\\tgetSubscriptionFromMessage,\\n\\t};\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"_objectSpread\",\"export\",\"createDataAPI\",\"Random\",\"moment\",\"hasAtLeastOnePermission\",\"hasPermission\",\"Messages\",\"ChatRoom\",\"ChatSubscription\",\"settings\",\"MessageTypes\",\"sdk\",\"prependReplies\",\"_ref\",\"rid\",\"tmid\",\"findMessageByID\",\"mid\",\"_Messages$findOne\",\"async\",\"_context2\",\"prev\",\"next\",\"abrupt\",\"findOne\",\"_id\",\"_hidden\",\"$ne\",\"reactive\",\"call\",\"stop\",\"Promise\",\"findLastMessage\",\"_context4\",\"$exists\",\"sort\",\"ts\",\"findLastOwnMessage\",\"uid\",\"_context6\",\"Meteor\",\"userId\",\"undefined\",\"canUpdateMessage\",\"message\",\"_settings$get\",\"canEditMessage\",\"editAllowed\",\"editOwn\",\"blockEditInMinutes\",\"bypassBlockTimeLimit\",\"elapsedMinutes\",\"_context8\",\"isSystemMessage\",\"get\",\"u\",\"diff\",\"findPreviousOwnMessage\",\"msg\",\"_context9\",\"$lt\",\"awrap\",\"sent\",\"findNextOwnMessage\",\"_context11\",\"$gt\",\"drafts\",\"Map\",\"findRoom\",\"_context20\",\"findDiscussionByID\",\"drid\",\"_context24\",\"prid\",\"createStrictGetter\",\"find\",\"errorMessage\",\"result\",\"_args26\",\"arguments\",\"_context26\",\"apply\",\"Error\",\"findSubscription\",\"_context27\",\"getSubscription\",\"findSubscriptionFromMessage\",\"_context28\",\"getSubscriptionFromMessage\",\"composeMessage\",\"text\",\"_ref2\",\"_originalMessage$rid\",\"_originalMessage$_id\",\"sendToChannel\",\"quotedMessages\",\"originalMessage\",\"effectiveRID\",\"effectiveTMID\",\"_context\",\"id\",\"tshow\",\"getMessageByID\",\"_context3\",\"getLastMessage\",\"_context5\",\"getLastOwnMessage\",\"_context7\",\"getPreviousOwnMessage\",\"previousMessage\",\"_context10\",\"getNextOwnMessage\",\"nextMessage\",\"_context12\",\"pushEphemeralMessage\",\"_context13\",\"upsert\",\"$set\",\"updateMessage\",\"previewUrls\",\"_context14\",\"canDeleteMessage\",\"deleteAnyAllowed\",\"deleteOwnAllowed\",\"deleteAllowed\",\"blockDeleteInMinutes\",\"onTimeForDelete\",\"_context15\",\"deleteMessage\",\"msgIdOrMsg\",\"msgId\",\"roomId\",\"_context16\",\"rest\",\"post\",\"getDraft\",\"_context17\",\"saveDraft\",\"draft\",\"_context19\",\"set\",\"discardDraft\",\"_context18\",\"delete\",\"getRoom\",\"room\",\"_context21\",\"isSubscribedToRoom\",\"_context22\",\"joinRoom\",\"_context23\",\"getDiscussionByID\",\"discussion\",\"_context25\"],\"mappings\":\"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\"}"}