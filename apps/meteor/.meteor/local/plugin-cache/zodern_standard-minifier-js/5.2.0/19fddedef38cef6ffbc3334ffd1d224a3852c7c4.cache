{"code":"function module(e,i,o){o.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){n=e}},0),o.export({useVideoMessageAction:function(){return f}}),o.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback:function(e){t=e}},0),o.link(\"@rocket.chat/ui-contexts\",{useSetting:function(e){c=e}},1),o.link(\"react\",{useEffect:function(e){d=e},useMemo:function(e){l=e}},2),o.link(\"../../../../../../../app/ui/client/lib/recorderjs/videoRecorder\",{VideoRecorder:function(e){u=e}},3),o.link(\"../../../../contexts/ChatContext\",{useChat:function(e){a=e}},4),o.link(\"../../hooks/useMediaActionTitle\",{useMediaActionTitle:function(e){r=e}},5),o.link(\"../../hooks/useMediaPermissions\",{useMediaPermissions:function(e){s=e}},6);var n,t,c,d,l,u,a,r,s,f=function(e){var i=c(\"FileUpload_Enabled\"),o=c(\"Message_VideoRecorderEnabled\"),f=c(\"FileUpload_MediaTypeBlackList\"),v=c(\"FileUpload_MediaTypeWhiteList\"),k=s(\"camera\"),m=n(k,2),p=m[0],M=m[1],g=l(function(){return!!(!p&&navigator.mediaDevices&&window.MediaRecorder&&i&&o&&!(null!=f&&f.match(/video\\/webm|video\\/\\*/i))&&(!v||v.match(/video\\/webm|video\\/\\*/i))&&u.getSupportedMimeTypes())},[f,v,i,p,o]),h=r(\"video\",p,i,o,g),b=a(),R=t(function(e){if(e){var i;null==b||null===(i=b.composer)||void 0===i||i.setRecordingVideo(!1)}M(e)});return d(function(){R(p)},[R,p]),{id:\"video-message\",content:h,icon:\"video\",disabled:!g||!!e,onClick:function(){var e,i;null!=b&&null!==(e=b.composer)&&void 0!==e&&e.recordingVideo.get()||null==b||null===(i=b.composer)||void 0===i||i.setRecordingVideo(!0)}}}}","map":"{\"version\":3,\"sources\":[\"client/views/room/composer/messageBox/MessageBoxActionsToolbar/hooks/useVideoMessageAction.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\\nimport { useSetting } from '@rocket.chat/ui-contexts';\\nimport { useEffect, useMemo } from 'react';\\n\\nimport { VideoRecorder } from '../../../../../../../app/ui/client/lib/recorderjs/videoRecorder';\\nimport { useChat } from '../../../../contexts/ChatContext';\\nimport { useMediaActionTitle } from '../../hooks/useMediaActionTitle';\\nimport { useMediaPermissions } from '../../hooks/useMediaPermissions';\\n\\nexport const useVideoMessageAction = (disabled: boolean): GenericMenuItemProps => {\\n\\tconst isFileUploadEnabled = useSetting('FileUpload_Enabled') as boolean;\\n\\tconst isVideoRecorderEnabled = useSetting('Message_VideoRecorderEnabled') as boolean;\\n\\tconst fileUploadMediaTypeBlackList = useSetting('FileUpload_MediaTypeBlackList') as string;\\n\\tconst fileUploadMediaTypeWhiteList = useSetting('FileUpload_MediaTypeWhiteList') as string;\\n\\tconst [isPermissionDenied, setIsPermissionDenied] = useMediaPermissions('camera');\\n\\n\\tconst isAllowed = useMemo(\\n\\t\\t() =>\\n\\t\\t\\tBoolean(\\n\\t\\t\\t\\t!isPermissionDenied &&\\n\\t\\t\\t\\t\\tnavigator.mediaDevices &&\\n\\t\\t\\t\\t\\twindow.MediaRecorder &&\\n\\t\\t\\t\\t\\tisFileUploadEnabled &&\\n\\t\\t\\t\\t\\tisVideoRecorderEnabled &&\\n\\t\\t\\t\\t\\t!fileUploadMediaTypeBlackList?.match(/video\\\\/webm|video\\\\/\\\\*/i) &&\\n\\t\\t\\t\\t\\t(!fileUploadMediaTypeWhiteList || fileUploadMediaTypeWhiteList.match(/video\\\\/webm|video\\\\/\\\\*/i)) &&\\n\\t\\t\\t\\t\\tBoolean(VideoRecorder.getSupportedMimeTypes()),\\n\\t\\t\\t),\\n\\t\\t[fileUploadMediaTypeBlackList, fileUploadMediaTypeWhiteList, isFileUploadEnabled, isPermissionDenied, isVideoRecorderEnabled],\\n\\t);\\n\\n\\tconst getMediaActionTitle = useMediaActionTitle('video', isPermissionDenied, isFileUploadEnabled, isVideoRecorderEnabled, isAllowed);\\n\\n\\tconst chat = useChat();\\n\\n\\tconst handleOpenVideoMessage = () => {\\n\\t\\tif (!chat?.composer?.recordingVideo.get()) {\\n\\t\\t\\tchat?.composer?.setRecordingVideo(true);\\n\\t\\t}\\n\\t};\\n\\n\\tconst handleDenyVideo = useMutableCallback((isDenied) => {\\n\\t\\tif (isDenied) {\\n\\t\\t\\tchat?.composer?.setRecordingVideo(false);\\n\\t\\t}\\n\\n\\t\\tsetIsPermissionDenied(isDenied);\\n\\t});\\n\\n\\tuseEffect(() => {\\n\\t\\thandleDenyVideo(isPermissionDenied);\\n\\t}, [handleDenyVideo, isPermissionDenied]);\\n\\n\\treturn {\\n\\t\\tid: 'video-message',\\n\\t\\tcontent: getMediaActionTitle,\\n\\t\\ticon: 'video',\\n\\t\\tdisabled: !isAllowed || Boolean(disabled),\\n\\t\\tonClick: handleOpenVideoMessage,\\n\\t};\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_slicedToArray\",\"export\",\"useVideoMessageAction\",\"useMutableCallback\",\"useSetting\",\"useEffect\",\"useMemo\",\"VideoRecorder\",\"useChat\",\"useMediaActionTitle\",\"useMediaPermissions\",\"disabled\",\"isFileUploadEnabled\",\"isVideoRecorderEnabled\",\"fileUploadMediaTypeBlackList\",\"fileUploadMediaTypeWhiteList\",\"_useMediaPermissions\",\"_useMediaPermissions2\",\"isPermissionDenied\",\"setIsPermissionDenied\",\"isAllowed\",\"Boolean\",\"navigator\",\"mediaDevices\",\"window\",\"MediaRecorder\",\"match\",\"getSupportedMimeTypes\",\"getMediaActionTitle\",\"chat\",\"handleDenyVideo\",\"isDenied\",\"_chat$composer3\",\"composer\",\"setRecordingVideo\",\"id\",\"content\",\"icon\",\"onClick\",\"_chat$composer\",\"_chat$composer2\",\"recordingVideo\",\"get\"],\"mappings\":\"uBAASA,EAAAC,IAAoB,CAAA,uCAAoC,CAAAC,QAAA,SAAAC,CAAA,EAAAC,EAAAD,CAAA,CAAA,EAAA,GAAjEH,EAAOK,MAAE,CAAA,CAAAC,sBAA0B,WAAA,OAAAA,CAA8B,CAAA,GAAAN,EAAAC,IAAA,CAAA,8BAAA,CAAAM,mBAAA,SAAAJ,CAAA,EAAAI,EAAAJ,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,2BAAA,CAAAO,WAAA,SAAAL,CAAA,EAAAK,EAAAL,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAAQ,UAAA,SAAAN,CAAA,EAAAM,EAAAN,CAAA,EAAAO,QAAA,SAAAP,CAAA,EAAAO,EAAAP,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,kEAAA,CAAAU,cAAA,SAAAR,CAAA,EAAAQ,EAAAR,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,mCAAA,CAAAW,QAAA,SAAAT,CAAA,EAAAS,EAAAT,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,kCAAA,CAAAY,oBAAA,SAAAV,CAAA,EAAAU,EAAAV,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,kCAAA,CAAAa,oBAAA,SAAAX,CAAA,EAAAW,EAAAX,CAAA,CAAA,EAAA,GAU1D,IAVPC,EAAiEG,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAUpDR,EAAwB,SAACS,CAAiB,EACtD,IAAMC,EAAsBR,EAAW,sBACjCS,EAAyBT,EAAW,gCACpCU,EAA+BV,EAAW,iCAC1CW,EAA+BX,EAAW,iCAChDY,EAAoDN,EAAoB,UAASO,EAAAjB,EAAAgB,EAAA,GAA1EE,EAAkBD,CAAA,CAAA,EAAA,CAAEE,EAAqBF,CAAA,CAAA,EAAA,CAE1CG,EAAYd,EACjB,WAAA,MACCe,CAAAA,CACC,CAAA,CAACH,GACAI,UAAUC,YAAY,EACtBC,OAAOC,aAAa,EACpBb,GACAC,GACA,CAACC,CAAAA,MAAAA,GAAAA,EAA8BY,KAAK,CAAC,yBAAwB,GAC5D,CAAA,CAACX,GAAgCA,EAA6BW,KAAK,CAAC,yBAAwB,GACrFnB,EAAcoB,qBAAqB,EAAE,CAC9C,EACF,CAACb,EAA8BC,EAA8BH,EAAqBM,EAAoBL,EAAuB,EAGxHe,EAAsBnB,EAAoB,QAASS,EAAoBN,EAAqBC,EAAwBO,GAEpHS,EAAOrB,IAQPsB,EAAkB3B,EAAmB,SAAC4B,CAAQ,EACnD,GAAIA,EAAU,CAAA,IAAAC,CACbH,OAAAA,GAAI,AAAU,OAAVG,CAAAA,EAAJH,EAAMI,QAAQ,AAARA,GAAQD,AAAA,KAAA,IAAAA,GAAdA,EAAgBE,iBAAiB,CAAC,CAAA,EACnC,CAEAf,EAAsBY,EACvB,GAMA,OAJA1B,EAAU,WACTyB,EAAgBZ,EACjB,EAAG,CAACY,EAAiBZ,EAAmB,EAEjC,CACNiB,GAAI,gBACJC,QAASR,EACTS,KAAM,QACN1B,SAAU,CAACS,GAAaC,CAAAA,CAAQV,EAChC2B,QAvB8B,eAAKC,EACQC,QAAtCX,GAAI,AAAU,OAAVU,CAAAA,EAAJV,EAAMI,QAAQ,AAARA,GAAQM,AAAA,KAAA,IAAAA,GAAdA,EAAgBE,cAAc,CAACC,GAAG,IACtCb,MAAAA,GAAI,AAAU,OAAVW,CAAAA,EAAJX,EAAMI,QAAQ,AAARA,GAAQO,AAAA,KAAA,IAAAA,GAAdA,EAAgBN,iBAAiB,CAAC,CAAA,EAEpC,EAqBD\"}"}