{"code":"function module(e,n,t){t.link(\"@babel/runtime/regenerator\",{default:function(e){r=e}},0),t.export({requestMessageDeletion:function(){return c}}),t.link(\"../../../../app/utils/lib/i18n\",{t:function(e){a=e}},0),t.link(\"../../../components/GenericModal\",{default:function(e){s=e}},1),t.link(\"../../imperativeModal\",{imperativeModal:function(e){o=e}},2),t.link(\"../../toast\",{dispatchToastMessage:function(e){i=e}},3);var r,a,s,o,i,c=function(e,n){var t;return r.async(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,r.awrap(e.data.canDeleteMessage(n));case 2:if(c.sent){c.next=5;break}return i({type:\"error\",message:a(\"Message_deleting_blocked\")}),c.abrupt(\"return\");case 5:if(!n.drid){c.next=11;break}return c.next=8,r.awrap(e.data.getDiscussionByID(n.drid));case 8:c.t0=c.sent,c.next=12;break;case 11:c.t0=void 0;case 12:return t=c.t0,c.next=15,r.awrap(new Promise(function(c,u){var l=function t(){var t,s;return r.async(function l(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,r.awrap(e.data.canDeleteMessage(n));case 3:if(l.sent){l.next=6;break}return i({type:\"error\",message:a(\"Message_deleting_blocked\")}),l.abrupt(\"return\");case 6:return l.next=8,r.awrap(e.data.deleteMessage(n));case 8:o.close(),(null===(t=e.currentEditing)||void 0===t?void 0:t.mid)===n._id&&e.currentEditing.stop(),null===(s=e.composer)||void 0===s||s.focus(),i({type:\"success\",message:a(\"Your_entry_has_been_deleted\")}),c(),l.next=19;break;case 15:l.prev=15,l.t0=l.catch(0),i({type:\"error\",message:l.t0}),u(l.t0);case 19:case\"end\":return l.stop()}},null,null,[[0,15]],Promise)},d=function t(){var t,a;return r.async(function r(r){for(;;)switch(r.prev=r.next){case 0:o.close(),(null===(t=e.currentEditing)||void 0===t?void 0:t.mid)===n._id&&e.currentEditing.stop(),null===(a=e.composer)||void 0===a||a.focus(),c();case 4:case\"end\":return r.stop()}},null,null,null,Promise)};o.open({component:s,props:{title:a(\"Are_you_sure\"),children:t?a(\"The_message_is_a_discussion_you_will_not_be_able_to_recover\"):a(\"You_will_not_be_able_to_recover\"),variant:\"danger\",confirmText:a(\"Yes_delete_it\"),onConfirm:l,onClose:d,onCancel:d}})}));case 15:case\"end\":return c.stop()}},null,null,null,Promise)}}","map":"{\"version\":3,\"sources\":[\"client/lib/chats/flows/requestMessageDeletion.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IMessage } from '@rocket.chat/core-typings';\\n\\nimport { t } from '../../../../app/utils/lib/i18n';\\nimport GenericModal from '../../../components/GenericModal';\\nimport { imperativeModal } from '../../imperativeModal';\\nimport { dispatchToastMessage } from '../../toast';\\nimport type { ChatAPI } from '../ChatAPI';\\n\\nexport const requestMessageDeletion = async (chat: ChatAPI, message: IMessage): Promise<void> => {\\n\\tif (!(await chat.data.canDeleteMessage(message))) {\\n\\t\\tdispatchToastMessage({ type: 'error', message: t('Message_deleting_blocked') });\\n\\t\\treturn;\\n\\t}\\n\\n\\tconst room = message.drid ? await chat.data.getDiscussionByID(message.drid) : undefined;\\n\\n\\tawait new Promise<void>((resolve, reject) => {\\n\\t\\tconst onConfirm = async (): Promise<void> => {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tif (!(await chat.data.canDeleteMessage(message))) {\\n\\t\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('Message_deleting_blocked') });\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tawait chat.data.deleteMessage(message);\\n\\n\\t\\t\\t\\timperativeModal.close();\\n\\n\\t\\t\\t\\tif (chat.currentEditing?.mid === message._id) {\\n\\t\\t\\t\\t\\tchat.currentEditing.stop();\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tchat.composer?.focus();\\n\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Your_entry_has_been_deleted') });\\n\\t\\t\\t\\tresolve();\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t\\treject(error);\\n\\t\\t\\t}\\n\\t\\t};\\n\\n\\t\\tconst onCloseModal = async (): Promise<void> => {\\n\\t\\t\\timperativeModal.close();\\n\\n\\t\\t\\tif (chat.currentEditing?.mid === message._id) {\\n\\t\\t\\t\\tchat.currentEditing.stop();\\n\\t\\t\\t}\\n\\t\\t\\tchat.composer?.focus();\\n\\n\\t\\t\\tresolve();\\n\\t\\t};\\n\\n\\t\\timperativeModal.open({\\n\\t\\t\\tcomponent: GenericModal,\\n\\t\\t\\tprops: {\\n\\t\\t\\t\\ttitle: t('Are_you_sure'),\\n\\t\\t\\t\\tchildren: room ? t('The_message_is_a_discussion_you_will_not_be_able_to_recover') : t('You_will_not_be_able_to_recover'),\\n\\t\\t\\t\\tvariant: 'danger',\\n\\t\\t\\t\\tconfirmText: t('Yes_delete_it'),\\n\\t\\t\\t\\tonConfirm,\\n\\t\\t\\t\\tonClose: onCloseModal,\\n\\t\\t\\t\\tonCancel: onCloseModal,\\n\\t\\t\\t},\\n\\t\\t});\\n\\t});\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"export\",\"requestMessageDeletion\",\"t\",\"GenericModal\",\"imperativeModal\",\"dispatchToastMessage\",\"chat\",\"message\",\"room\",\"async\",\"_context3\",\"prev\",\"next\",\"awrap\",\"data\",\"canDeleteMessage\",\"sent\",\"type\",\"abrupt\",\"drid\",\"getDiscussionByID\",\"t0\",\"undefined\",\"Promise\",\"resolve\",\"reject\",\"onConfirm\",\"_callee\",\"_chat$currentEditing\",\"_chat$composer\",\"_callee$\",\"_context\",\"deleteMessage\",\"close\",\"currentEditing\",\"mid\",\"_id\",\"stop\",\"composer\",\"focus\",\"onCloseModal\",\"_callee2\",\"_chat$currentEditing2\",\"_chat$composer2\",\"_callee2$\",\"_context2\",\"open\",\"component\",\"props\",\"title\",\"children\",\"variant\",\"confirmText\",\"onClose\",\"onCancel\"],\"mappings\":\"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\"}"}