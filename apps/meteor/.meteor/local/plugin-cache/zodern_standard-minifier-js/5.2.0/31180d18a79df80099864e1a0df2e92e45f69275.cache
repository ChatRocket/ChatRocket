{"code":"function module(e,n,t){t.export({useMessageDeletionIsAllowed:function(){return a}}),t.link(\"@rocket.chat/ui-contexts\",{useSetting:function(e){i=e},usePermission:function(e){o=e}},0),t.link(\"react\",{useMemo:function(e){s=e}},1),t.link(\"../lib/getDifference\",{getDifference:function(e){l=e},MINUTES:function(e){u=e}},2);var i,o,s,l,u,a=function(e,n,t){var a=o(\"force-delete-message\",e),c=i(\"Message_AllowDeleting\"),r=o(\"delete-message\",e),f=o(\"delete-own-message\"),d=o(\"bypass-time-limit-edit-and-delete\",e),g=i(\"Message_AllowDeleting_BlockDeleteInMinutes\");return s(function(){var e;return!!a||!!c&&(!!r||!!f)&&(!!r||n.userId===t)&&(e=n,!!d||0===g||!!e.uploadedAt&&!!g&&l(new Date,new Date(e.uploadedAt),u)<g)},[a,c,r,f,g,d,n,t])}}","map":"{\"version\":3,\"sources\":[\"client/views/room/contextualBar/RoomFiles/hooks/useMessageDeletionIsAllowed.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom, IUser, IUpload } from '@rocket.chat/core-typings';\\nimport { useSetting, usePermission } from '@rocket.chat/ui-contexts';\\nimport { useMemo } from 'react';\\n\\nimport { getDifference, MINUTES } from '../lib/getDifference';\\n\\nexport const useMessageDeletionIsAllowed = (rid: IRoom['_id'], file: IUpload, uid: IUser['_id'] | null) => {\\n\\tconst canForceDelete = usePermission('force-delete-message', rid);\\n\\tconst deletionIsEnabled = useSetting('Message_AllowDeleting');\\n\\tconst userHasPermissionToDeleteAny = usePermission('delete-message', rid);\\n\\tconst userHasPermissionToDeleteOwn = usePermission('delete-own-message');\\n\\tconst bypassBlockTimeLimit = usePermission('bypass-time-limit-edit-and-delete', rid);\\n\\tconst blockDeleteInMinutes = useSetting<number>('Message_AllowDeleting_BlockDeleteInMinutes');\\n\\n\\tconst isDeletionAllowed = useMemo(() => {\\n\\t\\tif (canForceDelete) {\\n\\t\\t\\treturn true;\\n\\t\\t}\\n\\n\\t\\tif (!deletionIsEnabled) {\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\n\\t\\tif (!userHasPermissionToDeleteAny && !userHasPermissionToDeleteOwn) {\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\n\\t\\tconst checkTimeframe = (file: IUpload) => {\\n\\t\\t\\tif (!bypassBlockTimeLimit && blockDeleteInMinutes !== 0) {\\n\\t\\t\\t\\tif (!file.uploadedAt || !blockDeleteInMinutes) {\\n\\t\\t\\t\\t\\treturn false;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tconst currentTsDiff = getDifference(new Date(), new Date(file.uploadedAt), MINUTES);\\n\\t\\t\\t\\treturn currentTsDiff < blockDeleteInMinutes;\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn true;\\n\\t\\t};\\n\\n\\t\\tconst isUserOwnFile = (file: IUpload) => file.userId === uid;\\n\\n\\t\\tif (userHasPermissionToDeleteAny || isUserOwnFile(file)) {\\n\\t\\t\\treturn checkTimeframe(file);\\n\\t\\t}\\n\\n\\t\\treturn false;\\n\\t}, [\\n\\t\\tcanForceDelete,\\n\\t\\tdeletionIsEnabled,\\n\\t\\tuserHasPermissionToDeleteAny,\\n\\t\\tuserHasPermissionToDeleteOwn,\\n\\t\\tblockDeleteInMinutes,\\n\\t\\tbypassBlockTimeLimit,\\n\\t\\tfile,\\n\\t\\tuid,\\n\\t]);\\n\\n\\treturn isDeletionAllowed;\\n};\\n\",null],\"names\":[\"module\",\"export\",\"useMessageDeletionIsAllowed\",\"link\",\"useSetting\",\"v\",\"usePermission\",\"useMemo\",\"getDifference\",\"MINUTES\",\"rid\",\"file\",\"uid\",\"canForceDelete\",\"deletionIsEnabled\",\"userHasPermissionToDeleteAny\",\"userHasPermissionToDeleteOwn\",\"bypassBlockTimeLimit\",\"blockDeleteInMinutes\",\"userId\",\"uploadedAt\",\"currentTsDiff\",\"Date\"],\"mappings\":\"uBACAA,EAAOC,MAAE,CAAA,CAAAC,4BAAiC,WAAA,OAAAA,CAA2B,CAAA,GAAAF,EAAAG,IAAA,CAAA,2BAAA,CAAAC,WAAA,SAAAC,CAAA,EAAAD,EAAAC,CAAA,EAAAC,cAAA,SAAAD,CAAA,EAAAC,EAAAD,CAAA,CAAA,EAAA,GAAAL,EAAAG,IAAA,CAAA,QAAA,CAAAI,QAAA,SAAAF,CAAA,EAAAE,EAAAF,CAAA,CAAA,EAAA,GAAAL,EAAAG,IAAA,CAAA,uBAAA,CAAAK,cAAA,SAAAH,CAAA,EAAAG,EAAAH,CAAA,EAAAI,QAAA,SAAAJ,CAAA,EAAAI,EAAAJ,CAAA,CAAA,EAAA,GAK9D,IAL8DD,EAAAE,EAAAC,EAAAC,EAAAC,EAKxDP,EAA8B,SAACQ,CAAiB,CAAEC,CAAa,CAAEC,CAAwB,EACrG,IAAMC,EAAiBP,EAAc,uBAAwBI,GACvDI,EAAoBV,EAAW,yBAC/BW,EAA+BT,EAAc,iBAAkBI,GAC/DM,EAA+BV,EAAc,sBAC7CW,EAAuBX,EAAc,oCAAqCI,GAC1EQ,EAAuBd,EAAmB,8CA8ChD,OA5C0BG,EAAQ,eAaTI,QAZxB,EAAIE,KAICC,GAID,CAAA,EAACC,KAAiCC,CAAAA,GAmBlCD,CAAAA,EAAAA,GAFqCJ,AAESA,EAFJQ,MAAM,GAAKP,CAEH,IAf9BD,EAgBDA,EAftB,EAAKM,GAAwBC,AAAyB,IAAzBA,GAC5B,EAAKP,EAAKS,UAAU,IAAKF,GAKlBG,AADeb,EAAc,IAAIc,KAAQ,IAAIA,KAAKX,EAAKS,UAAU,EAAGX,GACpDS,EAa1B,EAAG,CACFL,EACAC,EACAC,EACAC,EACAE,EACAD,EACAN,EACAC,EACA,CAGF\"}"}