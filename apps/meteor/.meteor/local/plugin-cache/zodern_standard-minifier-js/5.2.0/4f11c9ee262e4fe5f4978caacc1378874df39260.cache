{"code":"function module(e,t,a){var l;let i,n,r,o,s,c,u,d,m,k,p,g,f,h,b,v;a.link(\"@babel/runtime/helpers/taggedTemplateLiteral\",{default(e){i=e}},0),a.link(\"@babel/runtime/helpers/extends\",{default(e){n=e}},1),a.link(\"@rocket.chat/core-typings\",{isRoomFederated(e){r=e}},0),a.link(\"@rocket.chat/css-in-js\",{css(e){o=e}},1),a.link(\"@rocket.chat/fuselage\",{Box(e){s=e},Button(e){c=e},ButtonGroup(e){u=e}},2),a.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback(e){d=e}},3),a.link(\"@rocket.chat/ui-avatar\",{RoomAvatar(e){m=e}},4),a.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch(e){k=e}},5),a.link(\"react\",{default(e){p=e},useEffect(e){g=e}},6),a.link(\"react-i18next\",{useTranslation(e){f=e}},7),a.link(\"../../../app/utils/client/getAvatarURL\",{getAvatarURL(e){h=e}},8),a.link(\"../../hooks/useSingleFileInput\",{useSingleFileInput(e){b=e}},9),a.link(\"../../lib/utils/isValidImageFormat\",{isValidImageFormat(e){v=e}},10),a.exportDefault(e=>{let{disabled:t=!1,room:a,roomAvatar:x,onChangeAvatar:A}=e,{t:E}=f(),R=k(),F=d(async e=>{let t=new FileReader;t.readAsDataURL(e),t.onloadend=async()=>{let{result:e}=t;if(\"string\"==typeof e&&await v(e)){A(e);return}R({type:\"error\",message:E(\"Avatar_format_invalid\")})}}),[y,I]=b(F),U=d(()=>{I(),A(null)});g(()=>{x||I()},[x,I]);let _=a.prid?h({roomId:a.prid}):h({username:\"@\".concat(a.name)});return p.createElement(s,{borderRadius:\"x2\",maxWidth:\"x332\",w:\"full\",position:\"relative\"},p.createElement(m,n({},void 0!==x&&{url:null===x?_:x},{room:a,size:\"x332\"})),p.createElement(s,{className:[o(l||(l=i([\"\\n\t\t\t\t\t\tbottom: 0;\\n\t\t\t\t\t\tright: 0;\\n\t\t\t\t\t\"])))],position:\"absolute\",m:12},p.createElement(u,null,p.createElement(c,{icon:\"upload\",disabled:r(a)||t,small:!0,title:E(\"Upload_user_avatar\"),onClick:y},E(\"Upload\")),p.createElement(c,{small:!0,danger:!0,icon:\"trash\",title:E(\"Accounts_SetDefaultAvatar\"),disabled:!x||r(a)||t,onClick:U}))))})}","map":"{\"version\":3,\"sources\":[\"client/components/avatar/RoomAvatarEditor.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { isRoomFederated } from '@rocket.chat/core-typings';\\nimport type { IRoom, RoomAdminFieldsType } from '@rocket.chat/core-typings';\\nimport { css } from '@rocket.chat/css-in-js';\\nimport { Box, Button, ButtonGroup } from '@rocket.chat/fuselage';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { RoomAvatar } from '@rocket.chat/ui-avatar';\\nimport { useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement } from 'react';\\nimport React, { useEffect } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { getAvatarURL } from '../../../app/utils/client/getAvatarURL';\\nimport { useSingleFileInput } from '../../hooks/useSingleFileInput';\\nimport { isValidImageFormat } from '../../lib/utils/isValidImageFormat';\\n\\ntype RoomAvatarEditorProps = {\\n\\troom: Pick<IRoom, RoomAdminFieldsType>;\\n\\tdisabled?: boolean;\\n\\troomAvatar?: string;\\n\\tonChangeAvatar: (url: string | null) => void;\\n};\\n\\nconst RoomAvatarEditor = ({ disabled = false, room, roomAvatar, onChangeAvatar }: RoomAvatarEditorProps): ReactElement => {\\n\\tconst { t } = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst handleChangeAvatar = useMutableCallback(async (file) => {\\n\\t\\tconst reader = new FileReader();\\n\\t\\treader.readAsDataURL(file);\\n\\t\\treader.onloadend = async (): Promise<void> => {\\n\\t\\t\\tconst { result } = reader;\\n\\t\\t\\tif (typeof result === 'string' && (await isValidImageFormat(result))) {\\n\\t\\t\\t\\tonChangeAvatar(result);\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('Avatar_format_invalid') });\\n\\t\\t};\\n\\t});\\n\\n\\tconst [clickUpload, reset] = useSingleFileInput(handleChangeAvatar);\\n\\tconst clickReset = useMutableCallback(() => {\\n\\t\\treset();\\n\\t\\tonChangeAvatar(null);\\n\\t});\\n\\n\\tuseEffect(() => {\\n\\t\\t!roomAvatar && reset();\\n\\t}, [roomAvatar, reset]);\\n\\n\\tconst defaultUrl = room.prid ? getAvatarURL({ roomId: room.prid }) : getAvatarURL({ username: `@${room.name}` }); // Discussions inherit avatars from the parent room\\n\\n\\treturn (\\n\\t\\t<Box borderRadius='x2' maxWidth='x332' w='full' position='relative'>\\n\\t\\t\\t<RoomAvatar {...(roomAvatar !== undefined && { url: roomAvatar === null ? defaultUrl : roomAvatar })} room={room} size='x332' />\\n\\t\\t\\t<Box\\n\\t\\t\\t\\tclassName={[\\n\\t\\t\\t\\t\\tcss`\\n\\t\\t\\t\\t\\t\\tbottom: 0;\\n\\t\\t\\t\\t\\t\\tright: 0;\\n\\t\\t\\t\\t\\t`,\\n\\t\\t\\t\\t]}\\n\\t\\t\\t\\tposition='absolute'\\n\\t\\t\\t\\tm={12}\\n\\t\\t\\t>\\n\\t\\t\\t\\t<ButtonGroup>\\n\\t\\t\\t\\t\\t<Button icon='upload' disabled={isRoomFederated(room) || disabled} small title={t('Upload_user_avatar')} onClick={clickUpload}>\\n\\t\\t\\t\\t\\t\\t{t('Upload')}\\n\\t\\t\\t\\t\\t</Button>\\n\\n\\t\\t\\t\\t\\t<Button\\n\\t\\t\\t\\t\\t\\tsmall\\n\\t\\t\\t\\t\\t\\tdanger\\n\\t\\t\\t\\t\\t\\ticon='trash'\\n\\t\\t\\t\\t\\t\\ttitle={t('Accounts_SetDefaultAvatar')}\\n\\t\\t\\t\\t\\t\\tdisabled={!roomAvatar || isRoomFederated(room) || disabled}\\n\\t\\t\\t\\t\\t\\tonClick={clickReset}\\n\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t</ButtonGroup>\\n\\t\\t\\t</Box>\\n\\t\\t</Box>\\n\\t);\\n};\\n\\nexport default RoomAvatarEditor;\\n\",null],\"names\":[\"_taggedTemplateLiteral\",\"_extends\",\"isRoomFederated\",\"css\",\"Box\",\"Button\",\"ButtonGroup\",\"useMutableCallback\",\"RoomAvatar\",\"useToastMessageDispatch\",\"React\",\"useEffect\",\"useTranslation\",\"getAvatarURL\",\"useSingleFileInput\",\"isValidImageFormat\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"disabled\",\"room\",\"roomAvatar\",\"onChangeAvatar\",\"t\",\"dispatchToastMessage\",\"handleChangeAvatar\",\"file\",\"reader\",\"FileReader\",\"readAsDataURL\",\"onloadend\",\"result\",\"type\",\"message\",\"clickUpload\",\"reset\",\"clickReset\",\"defaultUrl\",\"prid\",\"roomId\",\"username\",\"concat\",\"name\",\"createElement\",\"borderRadius\",\"maxWidth\",\"w\",\"position\",\"undefined\",\"url\",\"size\",\"className\",\"_templateObject\",\"m\",\"icon\",\"small\",\"title\",\"onClick\",\"danger\"],\"mappings\":\"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\"}"}