{"code":"function module(e,l,t){let o,a,s,r,u;t.export({useFileUpload:()=>n}),t.link(\"react\",{useCallback(e){o=e},useEffect(e){a=e}},0),t.link(\"use-sync-external-store/shim\",{useSyncExternalStore(e){s=e}},1),t.link(\"../../contexts/ChatContext\",{useChat(e){r=e}},2),t.link(\"./useFileUploadDropTarget\",{useFileUploadDropTarget(e){u=e}},3);let n=()=>{let e=r();if(!e)throw Error(\"No ChatContext provided\");a(()=>{e.uploads.wipeFailedOnes()},[e]);let l=s(e.uploads.subscribe,e.uploads.get),t=o(l=>{e.uploads.cancel(l)},[e]),n=o(l=>{e.flows.uploadFiles(l)},[e]);return{uploads:l,handleUploadProgressClose:t,handleUploadFiles:n,targeDrop:u()}}}","map":"{\"version\":3,\"sources\":[\"client/views/room/body/hooks/useFileUpload.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useCallback, useEffect } from 'react';\\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\\n\\nimport type { Upload } from '../../../../lib/chats/Upload';\\nimport { useChat } from '../../contexts/ChatContext';\\nimport { useFileUploadDropTarget } from './useFileUploadDropTarget';\\n\\nexport const useFileUpload = () => {\\n\\tconst chat = useChat();\\n\\tif (!chat) {\\n\\t\\tthrow new Error('No ChatContext provided');\\n\\t}\\n\\n\\tuseEffect(() => {\\n\\t\\tchat.uploads.wipeFailedOnes();\\n\\t}, [chat]);\\n\\n\\tconst uploads = useSyncExternalStore(chat.uploads.subscribe, chat.uploads.get);\\n\\n\\tconst handleUploadProgressClose = useCallback(\\n\\t\\t(id: Upload['id']) => {\\n\\t\\t\\tchat.uploads.cancel(id);\\n\\t\\t},\\n\\t\\t[chat],\\n\\t);\\n\\n\\tconst handleUploadFiles = useCallback(\\n\\t\\t(files: readonly File[]): void => {\\n\\t\\t\\tchat.flows.uploadFiles(files);\\n\\t\\t},\\n\\t\\t[chat],\\n\\t);\\n\\n\\treturn {\\n\\t\\tuploads,\\n\\t\\thandleUploadProgressClose,\\n\\t\\thandleUploadFiles,\\n\\t\\ttargeDrop: useFileUploadDropTarget(),\\n\\t};\\n};\\n\",null],\"names\":[\"useCallback\",\"useEffect\",\"useSyncExternalStore\",\"useChat\",\"useFileUploadDropTarget\",\"module\",\"export\",\"useFileUpload\",\"link\",\"v\",\"chat\",\"Error\",\"uploads\",\"wipeFailedOnes\",\"subscribe\",\"get\",\"handleUploadProgressClose\",\"id\",\"cancel\",\"handleUploadFiles\",\"files\",\"flows\",\"uploadFiles\",\"targeDrop\"],\"mappings\":\"2BAA+CA,EAAAC,EAAAC,EAAAC,EAAAC,EAA/CC,EAAOC,MAAE,CAAA,CAAAC,cAAaA,IAAWA,CAAa,GAACF,EAAAG,IAAA,CAAA,QAAA,CAAAR,YAAAS,CAAA,EAAAT,EAAAS,CAAA,EAAAR,UAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,+BAAA,CAAAN,qBAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,6BAAA,CAAAL,QAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,4BAAA,CAAAJ,wBAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAOxC,IAAMF,EAAgBA,KAC5B,IAAMG,EAAOP,IACb,GAAI,CAACO,EACJ,MAAM,AAAIC,MAAM,2BAGjBV,EAAU,KACTS,EAAKE,OAAO,CAACC,cAAc,EAC5B,EAAG,CAACH,EAAK,EAET,IAAME,EAAUV,EAAqBQ,EAAKE,OAAO,CAACE,SAAS,CAAEJ,EAAKE,OAAO,CAACG,GAAG,EAEvEC,EAA4BhB,EAChCiB,IACAP,EAAKE,OAAO,CAACM,MAAM,CAACD,EACrB,EACA,CAACP,EAAK,EAGDS,EAAoBnB,EACxBoB,IACAV,EAAKW,KAAK,CAACC,WAAW,CAACF,EACxB,EACA,CAACV,EAAK,EAGP,MAAO,CACNE,QAAAA,EACAI,0BAAAA,EACAG,kBAAAA,EACAI,UAAWnB,IAEb\"}"}