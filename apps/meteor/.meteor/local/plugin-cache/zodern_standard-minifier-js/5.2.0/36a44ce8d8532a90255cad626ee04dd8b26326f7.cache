{"code":"function module(e,n,t){var i,r,s,a,u,o,c,l,f,d,_,k,x;t.link(\"@babel/runtime/regenerator\",{default:function(e){i=e}},0),t.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(e){r=e}},1),t.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){s=e}},2),t.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback:function(e){a=e}},0),t.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(e){u=e},useTranslation:function(e){o=e},useToastMessageDispatch:function(e){c=e}},1),t.link(\"react\",{default:function(e){l=e},useState:function(e){f=e},useEffect:function(e){d=e}},2),t.link(\"../../../../../hooks/useFormatDateAndTime\",{useFormatDateAndTime:function(e){_=e}},3),t.link(\"../../../contexts/RoomToolboxContext\",{useRoomToolbox:function(e){k=e}},4),t.link(\"./InviteUsers\",{default:function(e){x=e}},5),t.exportDefault(function(e){var n=e.rid,t=e.onClickBack,m=o(),p=c(),v=f({isEditing:!1,daysAndMaxUses:{days:\"1\",maxUses:\"0\"},url:\"\",caption:\"\",error:void 0}),b=s(v,2),U=b[0],g=U.isEditing,y=U.url,T=U.caption,E=U.error,h=U.daysAndMaxUses,C=h.days,w=h.maxUses,A=b[1],M=k().closeTab,L=_(),D=u(\"POST\",\"/v1/findOrCreateInvite\"),Y=a(function(){return A(function(e){return r(r({},e),{},{isEditing:!0})})}),B=a(function(){return A(function(e){return r(r({},e),{},{isEditing:!1})})}),I=a(function(e){if(!e)return\"\";if(e.expires){var n=new Date(e.expires);if(e.maxUses){var t=e.maxUses-e.uses;return m(\"Your_invite_link_will_expire_on__date__or_after__usesLeft__uses\",{date:L(n),usesLeft:t})}return m(\"Your_invite_link_will_expire_on__date__\",{date:L(n)})}return e.maxUses?m(\"Your_invite_link_will_expire_after__usesLeft__uses\",{usesLeft:e.maxUses-e.uses}):m(\"Your_invite_link_will_never_expire\")});d(function(){var e;i.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.awrap(D({rid:n,days:Number(C),maxUses:Number(w)}));case 3:e=t.sent,A(function(n){return r(r({},n),{},{url:null==e?void 0:e.url,caption:I(e)})}),p({type:\"success\",message:m(\"Invite_link_generated\")}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),A(function(e){return r(r({},e),{},{error:t.t0})});case 11:case\"end\":return t.stop()}},null,null,[[0,8]],Promise)},[p,m,D,I,n,C,w]);var N=a(function(e){A(function(n){return r(r({},n),{},{daysAndMaxUses:e,isEditing:!1})})});return l.createElement(x,{isEditing:g,error:E,linkText:y,captionText:T,daysAndMaxUses:{days:C,maxUses:w},onClose:M,onClickBackMembers:t,onClickBackLink:B,onClickEdit:Y,onClickNewLink:N})})}","map":"{\"version\":3,\"sources\":[\"client/views/room/contextualBar/RoomMembers/InviteUsers/InviteUsersWithData.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom } from '@rocket.chat/core-typings';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useEndpoint, useTranslation, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement } from 'react';\\nimport React, { useState, useEffect } from 'react';\\n\\nimport { useFormatDateAndTime } from '../../../../../hooks/useFormatDateAndTime';\\nimport { useRoomToolbox } from '../../../contexts/RoomToolboxContext';\\nimport InviteUsers from './InviteUsers';\\n\\ntype InviteUsersWithDataProps = {\\n\\trid: IRoom['_id'];\\n\\tonClickBack: () => void;\\n};\\n\\nconst InviteUsersWithData = ({ rid, onClickBack }: InviteUsersWithDataProps): ReactElement => {\\n\\tconst t = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst [\\n\\t\\t{\\n\\t\\t\\tisEditing,\\n\\t\\t\\turl,\\n\\t\\t\\tcaption,\\n\\t\\t\\terror,\\n\\t\\t\\tdaysAndMaxUses: { days, maxUses },\\n\\t\\t},\\n\\t\\tsetInviteState,\\n\\t] = useState({\\n\\t\\tisEditing: false,\\n\\t\\tdaysAndMaxUses: { days: '1', maxUses: '0' },\\n\\t\\turl: '',\\n\\t\\tcaption: '',\\n\\t\\terror: undefined as Error | undefined,\\n\\t});\\n\\n\\tconst { closeTab } = useRoomToolbox();\\n\\tconst format = useFormatDateAndTime();\\n\\tconst findOrCreateInvite = useEndpoint('POST', '/v1/findOrCreateInvite');\\n\\n\\tconst handleEdit = useMutableCallback(() => setInviteState((prevState) => ({ ...prevState, isEditing: true })));\\n\\tconst handleBackToLink = useMutableCallback(() => setInviteState((prevState) => ({ ...prevState, isEditing: false })));\\n\\n\\tconst linkExpirationText = useMutableCallback((data) => {\\n\\t\\tif (!data) {\\n\\t\\t\\treturn '';\\n\\t\\t}\\n\\n\\t\\tif (data.expires) {\\n\\t\\t\\tconst expiration = new Date(data.expires);\\n\\t\\t\\tif (data.maxUses) {\\n\\t\\t\\t\\tconst usesLeft = data.maxUses - data.uses;\\n\\t\\t\\t\\treturn t('Your_invite_link_will_expire_on__date__or_after__usesLeft__uses', {\\n\\t\\t\\t\\t\\tdate: format(expiration),\\n\\t\\t\\t\\t\\tusesLeft,\\n\\t\\t\\t\\t});\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn t('Your_invite_link_will_expire_on__date__', { date: format(expiration) });\\n\\t\\t}\\n\\n\\t\\tif (data.maxUses) {\\n\\t\\t\\tconst usesLeft = data.maxUses - data.uses;\\n\\t\\t\\treturn t('Your_invite_link_will_expire_after__usesLeft__uses', { usesLeft });\\n\\t\\t}\\n\\n\\t\\treturn t('Your_invite_link_will_never_expire');\\n\\t});\\n\\n\\tuseEffect(() => {\\n\\t\\t(async (): Promise<void> => {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tconst data = await findOrCreateInvite({ rid, days: Number(days), maxUses: Number(maxUses) });\\n\\t\\t\\t\\tsetInviteState((prevState) => ({ ...prevState, url: data?.url, caption: linkExpirationText(data) }));\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Invite_link_generated') });\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tsetInviteState((prevState) => ({ ...prevState, error: error as Error }));\\n\\t\\t\\t}\\n\\t\\t})();\\n\\t}, [dispatchToastMessage, t, findOrCreateInvite, linkExpirationText, rid, days, maxUses]);\\n\\n\\tconst handleGenerateLink = useMutableCallback((daysAndMaxUses) => {\\n\\t\\tsetInviteState((prevState) => ({ ...prevState, daysAndMaxUses, isEditing: false }));\\n\\t});\\n\\n\\treturn (\\n\\t\\t<InviteUsers\\n\\t\\t\\tisEditing={isEditing}\\n\\t\\t\\terror={error}\\n\\t\\t\\tlinkText={url}\\n\\t\\t\\tcaptionText={caption}\\n\\t\\t\\tdaysAndMaxUses={{ days, maxUses }}\\n\\t\\t\\tonClose={closeTab}\\n\\t\\t\\tonClickBackMembers={onClickBack}\\n\\t\\t\\tonClickBackLink={handleBackToLink}\\n\\t\\t\\tonClickEdit={handleEdit}\\n\\t\\t\\tonClickNewLink={handleGenerateLink}\\n\\t\\t/>\\n\\t);\\n};\\n\\nexport default InviteUsersWithData;\\n\",null],\"names\":[\"_regeneratorRuntime\",\"_objectSpread\",\"_slicedToArray\",\"useMutableCallback\",\"useEndpoint\",\"useTranslation\",\"useToastMessageDispatch\",\"React\",\"useState\",\"useEffect\",\"useFormatDateAndTime\",\"useRoomToolbox\",\"InviteUsers\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"rid\",\"onClickBack\",\"t\",\"dispatchToastMessage\",\"_useState\",\"isEditing\",\"daysAndMaxUses\",\"days\",\"maxUses\",\"url\",\"caption\",\"error\",\"undefined\",\"_useState2\",\"_useState2$\",\"_useState2$$daysAndMa\",\"setInviteState\",\"closeTab\",\"_useRoomToolbox\",\"format\",\"findOrCreateInvite\",\"handleEdit\",\"prevState\",\"handleBackToLink\",\"linkExpirationText\",\"data\",\"expires\",\"expiration\",\"Date\",\"usesLeft\",\"uses\",\"date\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"Number\",\"sent\",\"type\",\"message\",\"t0\",\"stop\",\"Promise\",\"handleGenerateLink\",\"createElement\",\"linkText\",\"captionText\",\"onClose\",\"onClickBackMembers\",\"onClickBackLink\",\"onClickEdit\",\"onClickNewLink\"],\"mappings\":\"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\"}"}