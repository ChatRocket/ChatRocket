{"code":"function module(e,s,l){let o,r,u,t,n;l.export({useComposerBoxPopupQueries:()=>a}),l.link(\"@tanstack/react-query\",{useQueries(e){o=e}},0),l.link(\"react\",{useEffect(e){r=e},useState(e){u=e}},1),l.link(\"../../../../../app/utils/client/slashCommand\",{slashCommands(e){t=e}},2),l.link(\"./useEnablePopupPreview\",{useEnablePopupPreview(e){n=e}},3);let a=(e,s)=>{let[l,a]=u(0);r(()=>{a(0)},[s,e]);let m=n(e,s),i=!s||s.preview&&!!t.commands[null==e?void 0:e.cmd]&&t.commands[null==e?void 0:e.cmd].providesPreview||m;return{queries:o({queries:[(null==s?void 0:s.getItemsFromLocal)&&{keepPreviousData:!0,queryKey:[\"message-popup\",\"local\",e,s],queryFn:()=>(null==s?void 0:s.getItemsFromLocal)&&s.getItemsFromLocal(e),onSuccess:e=>{e.length<5&&a(1)},enabled:i},(null==s?void 0:s.getItemsFromServer)&&{keepPreviousData:!0,queryKey:[\"message-popup\",\"server\",e,s],queryFn:()=>(null==s?void 0:s.getItemsFromServer)&&s.getItemsFromServer(e),enabled:l>0}].filter(Boolean)}),suspended:!i}}}","map":"{\"version\":3,\"sources\":[\"client/views/room/composer/hooks/useComposerBoxPopupQueries.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { QueriesResults } from '@tanstack/react-query';\\nimport { useQueries } from '@tanstack/react-query';\\nimport { useEffect, useState } from 'react';\\n\\nimport { slashCommands } from '../../../../../app/utils/client/slashCommand';\\nimport type { ComposerPopupOption } from '../../contexts/ComposerPopupContext';\\nimport { useEnablePopupPreview } from './useEnablePopupPreview';\\n\\nexport const useComposerBoxPopupQueries = <T extends { _id: string; sort?: number }>(filter: unknown, popup?: ComposerPopupOption<T>) => {\\n\\tconst [counter, setCounter] = useState(0);\\n\\n\\tuseEffect(() => {\\n\\t\\tsetCounter(0);\\n\\t}, [popup, filter]);\\n\\n\\tconst shouldPopupPreview = useEnablePopupPreview(filter, popup);\\n\\n\\tconst enableQuery =\\n\\t\\t!popup ||\\n\\t\\t(popup.preview &&\\n\\t\\t\\tBoolean(slashCommands.commands[(filter as any)?.cmd]) &&\\n\\t\\t\\tslashCommands.commands[(filter as any)?.cmd].providesPreview) ||\\n\\t\\tshouldPopupPreview;\\n\\n\\treturn {\\n\\t\\tqueries: useQueries({\\n\\t\\t\\tqueries: [\\n\\t\\t\\t\\tpopup?.getItemsFromLocal && {\\n\\t\\t\\t\\t\\tkeepPreviousData: true,\\n\\t\\t\\t\\t\\tqueryKey: ['message-popup', 'local', filter, popup],\\n\\t\\t\\t\\t\\tqueryFn: () => popup?.getItemsFromLocal && popup.getItemsFromLocal(filter),\\n\\t\\t\\t\\t\\tonSuccess: (args: T[]) => {\\n\\t\\t\\t\\t\\t\\tif (args.length < 5) {\\n\\t\\t\\t\\t\\t\\t\\tsetCounter(1);\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\tenabled: enableQuery,\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\tpopup?.getItemsFromServer && {\\n\\t\\t\\t\\t\\tkeepPreviousData: true,\\n\\t\\t\\t\\t\\tqueryKey: ['message-popup', 'server', filter, popup],\\n\\t\\t\\t\\t\\tqueryFn: () => popup?.getItemsFromServer && popup.getItemsFromServer(filter),\\n\\t\\t\\t\\t\\tenabled: counter > 0,\\n\\t\\t\\t\\t},\\n\\t\\t\\t].filter(Boolean) as any,\\n\\t\\t}) as QueriesResults<T[]>,\\n\\t\\tsuspended: !enableQuery,\\n\\t};\\n};\\n\",null],\"names\":[\"useQueries\",\"useEffect\",\"useState\",\"slashCommands\",\"useEnablePopupPreview\",\"module\",\"export\",\"useComposerBoxPopupQueries\",\"link\",\"v\",\"filter\",\"popup\",\"counter\",\"setCounter\",\"shouldPopupPreview\",\"enableQuery\",\"preview\",\"Boolean\",\"commands\",\"cmd\",\"providesPreview\",\"queries\",\"getItemsFromLocal\",\"keepPreviousData\",\"queryKey\",\"queryFn\",\"onSuccess\",\"args\",\"length\",\"enabled\",\"getItemsFromServer\",\"suspended\"],\"mappings\":\"2BACmDA,EAAAC,EAAAC,EAAAC,EAAAC,EAAnDC,EAAOC,MAAE,CAAA,CAAAC,2BAAkBA,IAAAA,CAAwB,GAAAF,EAAAG,IAAA,CAAA,wBAAA,CAAAR,WAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,QAAA,CAAAP,UAAAQ,CAAA,EAAAR,EAAAQ,CAAA,EAAAP,SAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,+CAAA,CAAAL,cAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,0BAAA,CAAAJ,sBAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAO5C,IAAMF,EAA6BA,CAA2CG,EAAiBC,KACrG,GAAM,CAACC,EAASC,EAAW,CAAGX,EAAS,GAEvCD,EAAU,KACTY,EAAW,EACZ,EAAG,CAACF,EAAOD,EAAO,EAElB,IAAMI,EAAqBV,EAAsBM,EAAQC,GAEnDI,EACL,CAACJ,GACAA,EAAMK,OAAO,EACbC,CAAAA,CAAQd,EAAce,QAAQ,CAAER,MAAAA,EAAc,KAAA,EAAdA,EAAgBS,GAAG,CAAC,EACpDhB,EAAce,QAAQ,CAAER,MAAAA,EAAc,KAAA,EAAdA,EAAgBS,GAAG,CAAC,CAACC,eAAgB,EAC9DN,EAED,MAAO,CACNO,QAASrB,EAAW,CACnBqB,QAAS,CACR,AAAAV,CAAAA,MAAAA,EAAK,KAAA,EAALA,EAAOW,iBAAiB,AAAjBA,GAAqB,CAC3BC,iBAAkB,CAAA,EAClBC,SAAU,CAAC,gBAAiB,QAASd,EAAQC,EAAM,CACnDc,QAASA,IAAM,AAAAd,CAAAA,MAAAA,EAAK,KAAA,EAALA,EAAOW,iBAAiB,AAAjBA,GAAqBX,EAAMW,iBAAiB,CAACZ,GACnEgB,UAAYC,IACPA,EAAKC,MAAM,CAAG,GACjBf,EAAW,EAEb,EACAgB,QAASd,GAEV,AAAAJ,CAAAA,MAAAA,EAAK,KAAA,EAALA,EAAOmB,kBAAkB,AAAlBA,GAAsB,CAC5BP,iBAAkB,CAAA,EAClBC,SAAU,CAAC,gBAAiB,SAAUd,EAAQC,EAAM,CACpDc,QAASA,IAAM,AAAAd,CAAAA,MAAAA,EAAK,KAAA,EAALA,EAAOmB,kBAAkB,AAAlBA,GAAsBnB,EAAMmB,kBAAkB,CAACpB,GACrEmB,QAASjB,EAAU,GAEpB,CAACF,MAAM,CAACO,WAEVc,UAAW,CAAChB,EAEd\"}"}