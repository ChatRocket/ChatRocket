{"code":"function module(e,t,l){let n,a,s,i,o,u,d,c;l.link(\"@babel/runtime/helpers/objectSpread2\",{default(e){n=e}},0),l.export({useAgentsList:()=>r}),l.link(\"@rocket.chat/ui-contexts\",{useEndpoint(e){a=e}},0),l.link(\"react\",{useCallback(e){s=e},useState(e){i=e}},1),l.link(\"react-i18next\",{useTranslation(e){o=e}},2),l.link(\"../../../hooks/lists/useScrollableRecordList\",{useScrollableRecordList(e){u=e}},3),l.link(\"../../../hooks/useComponentDidUpdate\",{useComponentDidUpdate(e){d=e}},4),l.link(\"../../../lib/lists/RecordList\",{RecordList(e){c=e}},5);let r=e=>{let{t}=o(),[l,r]=i(()=>new c),p=s(()=>r(new c),[]),_=a(\"GET\",\"/v1/livechat/users/agent\"),{text:k,onlyAvailable:b=!1,showIdleAgents:m=!0,excludeId:h,haveAll:f,haveNoAgentsSelectedOption:w}=e;d(()=>{e&&p()},[e,p]);let A=s(async(e,l)=>{let{users:a,total:s}=await _(n(n(n({},k&&{text:k}),h&&{excludeId:h}),{},{showIdleAgents:m,onlyAvailable:b,offset:e,count:l+e,sort:'{ \"name\": 1 }'})),i=a.map(e=>{let t={_updatedAt:new Date(e._updatedAt),label:\"\".concat(e.name||e._id,\" (@\").concat(e.username,\")\"),value:e._id,_id:e._id};return t});return f&&i.unshift({label:t(\"All\"),value:\"all\",_updatedAt:new Date,_id:\"all\"}),w&&i.unshift({label:t(\"Empty_no_agent_selected\"),value:\"no-agent-selected\",_updatedAt:new Date,_id:\"no-agent-selected\"}),{items:i,itemCount:s+1}},[h,_,f,w,b,m,t,k]),{loadMoreItems:g,initialItemCount:v}=u(l,A,25);return{reload:p,itemsList:l,loadMoreItems:g,initialItemCount:v}}}","map":"{\"version\":3,\"sources\":[\"client/components/Omnichannel/hooks/useAgentsList.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useCallback, useState } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { useScrollableRecordList } from '../../../hooks/lists/useScrollableRecordList';\\nimport { useComponentDidUpdate } from '../../../hooks/useComponentDidUpdate';\\nimport { RecordList } from '../../../lib/lists/RecordList';\\n\\ntype AgentsListOptions = {\\n\\ttext: string;\\n\\thaveAll: boolean;\\n\\thaveNoAgentsSelectedOption: boolean;\\n\\texcludeId?: string;\\n\\tshowIdleAgents?: boolean;\\n\\tonlyAvailable?: boolean;\\n};\\n\\ntype AgentOption = { value: string; label: string; _updatedAt: Date; _id: string };\\n\\nexport const useAgentsList = (\\n\\toptions: AgentsListOptions,\\n): {\\n\\titemsList: RecordList<AgentOption>;\\n\\tinitialItemCount: number;\\n\\treload: () => void;\\n\\tloadMoreItems: (start: number, end: number) => void;\\n} => {\\n\\tconst { t } = useTranslation();\\n\\tconst [itemsList, setItemsList] = useState(() => new RecordList<AgentOption>());\\n\\tconst reload = useCallback(() => setItemsList(new RecordList<AgentOption>()), []);\\n\\n\\tconst getAgents = useEndpoint('GET', '/v1/livechat/users/agent');\\n\\tconst { text, onlyAvailable = false, showIdleAgents = true, excludeId, haveAll, haveNoAgentsSelectedOption } = options;\\n\\n\\tuseComponentDidUpdate(() => {\\n\\t\\toptions && reload();\\n\\t}, [options, reload]);\\n\\n\\tconst fetchData = useCallback(\\n\\t\\tasync (start, end) => {\\n\\t\\t\\tconst { users: agents, total } = await getAgents({\\n\\t\\t\\t\\t...(text && { text }),\\n\\t\\t\\t\\t...(excludeId && { excludeId }),\\n\\t\\t\\t\\tshowIdleAgents,\\n\\t\\t\\t\\tonlyAvailable,\\n\\t\\t\\t\\toffset: start,\\n\\t\\t\\t\\tcount: end + start,\\n\\t\\t\\t\\tsort: `{ \\\"name\\\": 1 }`,\\n\\t\\t\\t});\\n\\n\\t\\t\\tconst items = agents.map<AgentOption>((agent) => {\\n\\t\\t\\t\\tconst agentOption = {\\n\\t\\t\\t\\t\\t_updatedAt: new Date(agent._updatedAt),\\n\\t\\t\\t\\t\\tlabel: `${agent.name || agent._id} (@${agent.username})`,\\n\\t\\t\\t\\t\\tvalue: agent._id,\\n\\t\\t\\t\\t\\t_id: agent._id,\\n\\t\\t\\t\\t};\\n\\t\\t\\t\\treturn agentOption;\\n\\t\\t\\t});\\n\\n\\t\\t\\thaveAll &&\\n\\t\\t\\t\\titems.unshift({\\n\\t\\t\\t\\t\\tlabel: t('All'),\\n\\t\\t\\t\\t\\tvalue: 'all',\\n\\t\\t\\t\\t\\t_updatedAt: new Date(),\\n\\t\\t\\t\\t\\t_id: 'all',\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\thaveNoAgentsSelectedOption &&\\n\\t\\t\\t\\titems.unshift({\\n\\t\\t\\t\\t\\tlabel: t('Empty_no_agent_selected'),\\n\\t\\t\\t\\t\\tvalue: 'no-agent-selected',\\n\\t\\t\\t\\t\\t_updatedAt: new Date(),\\n\\t\\t\\t\\t\\t_id: 'no-agent-selected',\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\treturn {\\n\\t\\t\\t\\titems,\\n\\t\\t\\t\\titemCount: total + 1,\\n\\t\\t\\t};\\n\\t\\t},\\n\\t\\t[excludeId, getAgents, haveAll, haveNoAgentsSelectedOption, onlyAvailable, showIdleAgents, t, text],\\n\\t);\\n\\n\\tconst { loadMoreItems, initialItemCount } = useScrollableRecordList(itemsList, fetchData, 25);\\n\\n\\treturn {\\n\\t\\treload,\\n\\t\\titemsList,\\n\\t\\tloadMoreItems,\\n\\t\\tinitialItemCount,\\n\\t};\\n};\\n\",null],\"names\":[\"_objectSpread\",\"useEndpoint\",\"useCallback\",\"useState\",\"useTranslation\",\"useScrollableRecordList\",\"useComponentDidUpdate\",\"RecordList\",\"module\",\"link\",\"default\",\"v\",\"export\",\"useAgentsList\",\"options\",\"t\",\"itemsList\",\"setItemsList\",\"reload\",\"getAgents\",\"text\",\"onlyAvailable\",\"showIdleAgents\",\"excludeId\",\"haveAll\",\"haveNoAgentsSelectedOption\",\"fetchData\",\"start\",\"end\",\"users\",\"agents\",\"total\",\"offset\",\"count\",\"sort\",\"items\",\"map\",\"agent\",\"agentOption\",\"_updatedAt\",\"Date\",\"label\",\"concat\",\"name\",\"_id\",\"username\",\"value\",\"unshift\",\"itemCount\",\"loadMoreItems\",\"initialItemCount\"],\"mappings\":\"2BAAAA,EAA4BC,EAA2BC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9CC,EAAaC,IAAM,CAAA,uCAA2B,CAAAC,QAAAC,CAAA,EAAAX,EAAAW,CAAA,CAAA,EAAA,GAAvDH,EAAOI,MAAE,CAAA,CAAAC,cAAmBA,IAAAA,CAAA,GAA2BL,EAAAC,IAAA,CAAA,2BAAA,CAAAR,YAAAU,CAAA,EAAAV,EAAAU,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAAP,YAAAS,CAAA,EAAAT,EAAAS,CAAA,EAAAR,SAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,gBAAA,CAAAL,eAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,+CAAA,CAAAJ,wBAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,uCAAA,CAAAH,sBAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,gCAAA,CAAAF,WAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAmBhD,IAAME,EACZC,IAOA,GAAM,CAAEC,CAAAA,CAAG,CAAGX,IACR,CAACY,EAAWC,EAAa,CAAGd,EAAS,IAAM,IAAII,GAC/CW,EAAShB,EAAY,IAAMe,EAAa,IAAIV,GAA4B,EAAE,EAE1EY,EAAYlB,EAAY,MAAO,4BAC/B,CAAEmB,KAAAA,CAAI,CAAEC,cAAAA,EAAgB,CAAA,CAAK,CAAEC,eAAAA,EAAiB,CAAA,CAAI,CAAEC,UAAAA,CAAS,CAAEC,QAAAA,CAAO,CAAEC,2BAAAA,CAAAA,CAA4B,CAAGX,EAE/GR,EAAsB,KACrBQ,GAAWI,GACZ,EAAG,CAACJ,EAASI,EAAO,EAEpB,IAAMQ,EAAYxB,EACjB,MAAOyB,EAAOC,KACb,GAAM,CAAEC,MAAOC,CAAM,CAAEC,MAAAA,CAAAA,CAAO,CAAG,MAAMZ,EAASnB,EAAAA,EAAAA,EAAA,CAAA,EAC3CoB,GAAQ,CAAEA,KAAAA,CAAI,GACdG,GAAa,CAAEA,UAAAA,CAAS,GAAE,CAAA,EAAA,CAC9BD,eAAAA,EACAD,cAAAA,EACAW,OAAQL,EACRM,MAAOL,EAAMD,EACbO,KAAI,eAAiB,IAGhBC,EAAQL,EAAOM,GAAG,CAAeC,IACtC,IAAMC,EAAc,CACnBC,WAAY,IAAIC,KAAKH,EAAME,UAAU,EACrCE,MAAK,GAAAC,MAAA,CAAKL,EAAMM,IAAI,EAAIN,EAAMO,GAAG,CAAA,OAAAF,MAAA,CAAML,EAAMQ,QAAQ,CAAA,KACrDC,MAAOT,EAAMO,GAAG,CAChBA,IAAKP,EAAMO,GAAAA,EAEZ,OAAON,CACR,GAkBA,OAhBAd,GACCW,EAAMY,OAAO,CAAC,CACbN,MAAO1B,EAAE,OACT+B,MAAO,MACPP,WAAY,IAAIC,KAChBI,IAAK,QAGPnB,GACCU,EAAMY,OAAO,CAAC,CACbN,MAAO1B,EAAE,2BACT+B,MAAO,oBACPP,WAAY,IAAIC,KAChBI,IAAK,sBAGA,CACNT,MAAAA,EACAa,UAAWjB,EAAQ,EAErB,EACA,CAACR,EAAWJ,EAAWK,EAASC,EAA4BJ,EAAeC,EAAgBP,EAAGK,EAAK,EAG9F,CAAE6B,cAAAA,CAAa,CAAEC,iBAAAA,CAAAA,CAAkB,CAAG7C,EAAwBW,EAAWU,EAAW,IAE1F,MAAO,CACNR,OAAAA,EACAF,UAAAA,EACAiC,cAAAA,EACAC,iBAAAA,EAEF\"}"}