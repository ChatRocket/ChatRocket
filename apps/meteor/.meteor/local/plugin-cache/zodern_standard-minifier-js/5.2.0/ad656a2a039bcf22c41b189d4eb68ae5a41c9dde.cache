{"code":"function module(e,t,n){var l,o,c,i,u,a,r,s,m,f,d,p,E,h,k,_,v;n.link(\"@rocket.chat/fuselage\",{Box:function(e){l=e},Button:function(e){o=e},ButtonGroup:function(e){c=e}},0),n.link(\"@rocket.chat/fuselage-hooks\",{useUniqueId:function(e){i=e}},1),n.link(\"@rocket.chat/layout\",{Form:function(e){u=e}},2),n.link(\"@rocket.chat/ui-contexts\",{useLogout:function(e){a=e},useRoute:function(e){r=e}},3),n.link(\"meteor/accounts-base\",{Accounts:function(e){s=e}},4),n.link(\"react\",{default:function(e){m=e},useEffect:function(e){f=e},useMemo:function(e){d=e},useRef:function(e){p=e}},5),n.link(\"react-i18next\",{Trans:function(e){E=e},useTranslation:function(e){h=e}},6),n.link(\"../../../lib/utils/queueMicrotask\",{queueMicrotask:function(e){k=e}},7),n.link(\"./CurrentUserDisplay\",{default:function(e){_=e}},8),n.link(\"./Layout\",{default:function(e){v=e}},9),n.exportDefault(function(e){var t,n,y=e.oauthApp,b=e.redirectUri,g=e.user,C=d(function(){var e;return null!==(e=s.storageLocation.getItem(s.LOGIN_TOKEN_KEY))&&void 0!==e?e:void 0},[]),w=i(),I=h().t,T=r(\"home\"),L=a(),x=p(null),A=null===(t=g.oauth)||void 0===t?void 0:null===(n=t.authorizedClients)||void 0===n?void 0:n.includes(y.clientId);return f(function(){if(A){var e;null===(e=x.current)||void 0===e||e.click()}},[y.clientId,A]),m.createElement(v,null,m.createElement(u,{method:\"post\",action:\"\",\"aria-labelledby\":w},m.createElement(u.Header,null,m.createElement(u.Title,{id:w},I(\"core.Authorize_access_to_your_account\"))),m.createElement(u.Container,null,m.createElement(l,{withRichContent:!0},m.createElement(_,{user:g}),m.createElement(\"p\",null,m.createElement(E,{i18nKey:\"core.The_application_will_be_able_to\",t:I},\"The application \",m.createElement(\"strong\",null,{appName:y.name}),\" will be able to:\")),m.createElement(\"ul\",null,m.createElement(\"li\",null,I(\"core.access_your_basic_information\")))),m.createElement(\"input\",{type:\"hidden\",name:\"access_token\",value:C}),m.createElement(\"input\",{type:\"hidden\",name:\"client_id\",value:y.clientId}),m.createElement(\"input\",{type:\"hidden\",name:\"redirect_uri\",value:b}),m.createElement(\"input\",{type:\"hidden\",name:\"response_type\",value:\"code\"})),m.createElement(u.Footer,null,m.createElement(c,{stretch:!0},m.createElement(o,{ref:x,type:\"submit\",primary:!0,name:\"allow\",value:\"yes\"},I(\"core.Authorize\")),m.createElement(o,{onClick:function(){k(function(){T.push()}),window.close()}},I(\"core.Cancel\")),m.createElement(o,{danger:!0,onClick:function(){L()}},I(\"core.Logout\"))))))})}","map":"{\"version\":3,\"sources\":[\"client/views/oauth/components/AuthorizationFormPage.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IOAuthApps, IUser } from '@rocket.chat/core-typings';\\nimport { Box, Button, ButtonGroup } from '@rocket.chat/fuselage';\\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\\nimport { Form } from '@rocket.chat/layout';\\nimport { useLogout, useRoute } from '@rocket.chat/ui-contexts';\\nimport { Accounts } from 'meteor/accounts-base';\\nimport React, { useEffect, useMemo, useRef } from 'react';\\nimport { Trans, useTranslation } from 'react-i18next';\\n\\nimport { queueMicrotask } from '../../../lib/utils/queueMicrotask';\\nimport CurrentUserDisplay from './CurrentUserDisplay';\\nimport Layout from './Layout';\\n\\ntype AuthorizationFormPageProps = {\\n\\toauthApp: IOAuthApps;\\n\\tredirectUri: string;\\n\\tuser: IUser;\\n};\\n\\nconst AuthorizationFormPage = ({ oauthApp, redirectUri, user }: AuthorizationFormPageProps) => {\\n\\tconst token = useMemo(() => Accounts.storageLocation.getItem(Accounts.LOGIN_TOKEN_KEY) ?? undefined, []);\\n\\n\\tconst formLabelId = useUniqueId();\\n\\n\\tconst { t } = useTranslation();\\n\\n\\tconst homeRoute = useRoute('home');\\n\\n\\tconst handleCancelButtonClick = () => {\\n\\t\\tqueueMicrotask(() => {\\n\\t\\t\\thomeRoute.push();\\n\\t\\t});\\n\\t\\twindow.close();\\n\\t};\\n\\n\\tconst logout = useLogout();\\n\\n\\tconst handleLogoutButtonClick = () => {\\n\\t\\tlogout();\\n\\t};\\n\\n\\tconst submitRef = useRef<HTMLButtonElement>(null);\\n\\n\\tconst hasAuthorized = user.oauth?.authorizedClients?.includes(oauthApp.clientId);\\n\\n\\tuseEffect(() => {\\n\\t\\tif (hasAuthorized) {\\n\\t\\t\\tsubmitRef.current?.click();\\n\\t\\t}\\n\\t}, [oauthApp.clientId, hasAuthorized]);\\n\\n\\treturn (\\n\\t\\t<Layout>\\n\\t\\t\\t<Form method='post' action='' aria-labelledby={formLabelId}>\\n\\t\\t\\t\\t<Form.Header>\\n\\t\\t\\t\\t\\t<Form.Title id={formLabelId}>{t('core.Authorize_access_to_your_account')}</Form.Title>\\n\\t\\t\\t\\t</Form.Header>\\n\\t\\t\\t\\t<Form.Container>\\n\\t\\t\\t\\t\\t<Box withRichContent>\\n\\t\\t\\t\\t\\t\\t<CurrentUserDisplay user={user} />\\n\\n\\t\\t\\t\\t\\t\\t<p>\\n\\t\\t\\t\\t\\t\\t\\t<Trans i18nKey='core.The_application_will_be_able_to' t={t}>\\n\\t\\t\\t\\t\\t\\t\\t\\tThe application <strong>{{ appName: oauthApp.name }}</strong> will be able to:\\n\\t\\t\\t\\t\\t\\t\\t</Trans>\\n\\t\\t\\t\\t\\t\\t</p>\\n\\n\\t\\t\\t\\t\\t\\t<ul>\\n\\t\\t\\t\\t\\t\\t\\t<li>{t('core.access_your_basic_information')}</li>\\n\\t\\t\\t\\t\\t\\t</ul>\\n\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t<input type='hidden' name='access_token' value={token} />\\n\\t\\t\\t\\t\\t<input type='hidden' name='client_id' value={oauthApp.clientId} />\\n\\t\\t\\t\\t\\t<input type='hidden' name='redirect_uri' value={redirectUri} />\\n\\t\\t\\t\\t\\t<input type='hidden' name='response_type' value='code' />\\n\\t\\t\\t\\t</Form.Container>\\n\\t\\t\\t\\t<Form.Footer>\\n\\t\\t\\t\\t\\t<ButtonGroup stretch>\\n\\t\\t\\t\\t\\t\\t<Button ref={submitRef} type='submit' primary name='allow' value='yes'>\\n\\t\\t\\t\\t\\t\\t\\t{t('core.Authorize')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t\\t<Button onClick={handleCancelButtonClick}>{t('core.Cancel')}</Button>\\n\\t\\t\\t\\t\\t\\t<Button danger onClick={handleLogoutButtonClick}>\\n\\t\\t\\t\\t\\t\\t\\t{t('core.Logout')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t</ButtonGroup>\\n\\t\\t\\t\\t</Form.Footer>\\n\\t\\t\\t</Form>\\n\\t\\t</Layout>\\n\\t);\\n};\\n\\nexport default AuthorizationFormPage;\\n\",null],\"names\":[\"Box\",\"Button\",\"ButtonGroup\",\"useUniqueId\",\"Form\",\"useLogout\",\"useRoute\",\"Accounts\",\"React\",\"useEffect\",\"useMemo\",\"useRef\",\"Trans\",\"useTranslation\",\"queueMicrotask\",\"CurrentUserDisplay\",\"Layout\",\"module\",\"link\",\"v\",\"exportDefault\",\"_ref\",\"_user$oauth\",\"_user$oauth$authorize\",\"oauthApp\",\"redirectUri\",\"user\",\"token\",\"_Accounts$storageLoca\",\"storageLocation\",\"getItem\",\"LOGIN_TOKEN_KEY\",\"undefined\",\"formLabelId\",\"t\",\"_useTranslation\",\"homeRoute\",\"logout\",\"submitRef\",\"hasAuthorized\",\"oauth\",\"authorizedClients\",\"includes\",\"clientId\",\"_submitRef$current\",\"current\",\"click\",\"createElement\",\"method\",\"action\",\"Header\",\"Title\",\"id\",\"Container\",\"withRichContent\",\"i18nKey\",\"appName\",\"name\",\"type\",\"value\",\"Footer\",\"stretch\",\"ref\",\"primary\",\"onClick\",\"push\",\"window\",\"close\",\"danger\"],\"mappings\":\"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\"}"}