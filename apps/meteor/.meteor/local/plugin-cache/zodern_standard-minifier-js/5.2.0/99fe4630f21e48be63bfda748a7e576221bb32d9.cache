{"code":"function module(e,t,o){let l,n,a,s,i,r,d,c,u,m,k,g,h,f,p,x,E,C,b,v,M,T,_,w,y,D,F,R;o.link(\"@babel/runtime/helpers/extends\",{default(e){l=e}},0),o.link(\"@rocket.chat/core-typings\",{isEditedMessage(e){n=e}},0),o.link(\"@rocket.chat/fuselage\",{Box(e){a=e},CheckBox(e){s=e},Field(e){i=e},FieldLabel(e){r=e},FieldRow(e){d=e}},1),o.link(\"@rocket.chat/fuselage-hooks\",{useUniqueId(e){c=e}},2),o.link(\"@rocket.chat/ui-contexts\",{useMethod(e){u=e},useTranslation(e){m=e},useUserPreference(e){k=e}},3),o.link(\"react\",{default(e){g=e},useState(e){h=e},useEffect(e){f=e},useCallback(e){p=e}},4),o.link(\"../../../../../../lib/callbacks\",{callbacks(e){x=e}},5),o.link(\"../../../../../components/Contextualbar\",{ContextualbarContent(e){E=e}},6),o.link(\"../../../MessageList/MessageListErrorBoundary\",{default(e){C=e}},7),o.link(\"../../../body/DropTargetOverlay\",{default(e){b=e}},8),o.link(\"../../../body/hooks/useFileUploadDropTarget\",{useFileUploadDropTarget(e){v=e}},9),o.link(\"../../../composer/ComposerContainer\",{default(e){M=e}},10),o.link(\"../../../composer/RoomComposer/RoomComposer\",{default(e){T=e}},11),o.link(\"../../../contexts/ChatContext\",{useChat(e){_=e}},12),o.link(\"../../../contexts/RoomContext\",{useRoom(e){w=e},useRoomSubscription(e){y=e}},13),o.link(\"../../../contexts/RoomToolboxContext\",{useRoomToolbox(e){D=e}},14),o.link(\"../../../providers/DateListProvider\",{DateListProvider(e){F=e}},15),o.link(\"./ThreadMessageList\",{default(e){R=e}},16),o.exportDefault(e=>{let{mainMessage:t}=e,[o,S]=v(),L=k(\"alsoSendThreadToChannel\"),[N,U]=h(()=>{switch(L){case\"always\":return!0;case\"never\":return!1;default:return!t.tcount}}),B=p(()=>{\"default\"===L&&U(!1)},[L]),{closeTab:P}=D(),I=p(()=>{P()},[P]),G=_(),j=p(()=>{null==G||G.messageEditing.toPreviousMessage()},[null==G?void 0:G.messageEditing]),q=p(()=>{null==G||G.messageEditing.toNextMessage()},[null==G?void 0:G.messageEditing]),A=p(e=>{null==G||G.flows.uploadFiles(e)},[null==G?void 0:G.flows]),O=w(),z=u(\"readThreads\");f(()=>(x.add(\"streamNewMessage\",e=>{O._id!==e.rid||n(e)||e.tmid!==t._id||z(t._id)},x.priority.MEDIUM,\"thread-\".concat(O._id)),()=>{x.remove(\"streamNewMessage\",\"thread-\".concat(O._id))}),[t._id,z,O._id]);let H=y(),J=c(),K=m();return g.createElement(E,l({flexShrink:1,flexGrow:1,paddingInline:0},o),g.createElement(F,null,g.createElement(b,S),g.createElement(a,{is:\"section\",position:\"relative\",display:\"flex\",flexDirection:\"column\",flexGrow:1,flexShrink:1,flexBasis:\"auto\",height:\"full\"},g.createElement(C,null,g.createElement(R,{mainMessage:t})),g.createElement(T,null,g.createElement(M,{tmid:t._id,subscription:H,onSend:B,onEscape:I,onNavigateToPreviousMessage:j,onNavigateToNextMessage:q,onUploadFiles:A,tshow:N},g.createElement(i,{marginBlock:8},g.createElement(d,{justifyContent:\"initial\"},g.createElement(s,{id:J,checked:N,onChange:()=>U(e=>!e),name:\"alsoSendThreadToChannel\"}),g.createElement(r,{mis:\"x8\",htmlFor:J,color:\"annotation\",fontScale:\"p2\"},K(\"Also_send_to_channel\")))))))))})}","map":"{\"version\":3,\"sources\":[\"client/views/room/contextualBar/Threads/components/ThreadChat.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IMessage, IThreadMainMessage } from '@rocket.chat/core-typings';\\nimport { isEditedMessage } from '@rocket.chat/core-typings';\\nimport { Box, CheckBox, Field, FieldLabel, FieldRow } from '@rocket.chat/fuselage';\\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\\nimport { useMethod, useTranslation, useUserPreference } from '@rocket.chat/ui-contexts';\\nimport React, { useState, useEffect, useCallback } from 'react';\\n\\nimport { callbacks } from '../../../../../../lib/callbacks';\\nimport { ContextualbarContent } from '../../../../../components/Contextualbar';\\nimport MessageListErrorBoundary from '../../../MessageList/MessageListErrorBoundary';\\nimport DropTargetOverlay from '../../../body/DropTargetOverlay';\\nimport { useFileUploadDropTarget } from '../../../body/hooks/useFileUploadDropTarget';\\nimport ComposerContainer from '../../../composer/ComposerContainer';\\nimport RoomComposer from '../../../composer/RoomComposer/RoomComposer';\\nimport { useChat } from '../../../contexts/ChatContext';\\nimport { useRoom, useRoomSubscription } from '../../../contexts/RoomContext';\\nimport { useRoomToolbox } from '../../../contexts/RoomToolboxContext';\\nimport { DateListProvider } from '../../../providers/DateListProvider';\\nimport ThreadMessageList from './ThreadMessageList';\\n\\ntype ThreadChatProps = {\\n\\tmainMessage: IThreadMainMessage;\\n};\\n\\nconst ThreadChat = ({ mainMessage }: ThreadChatProps) => {\\n\\tconst [fileUploadTriggerProps, fileUploadOverlayProps] = useFileUploadDropTarget();\\n\\n\\tconst sendToChannelPreference = useUserPreference<'always' | 'never' | 'default'>('alsoSendThreadToChannel');\\n\\n\\tconst [sendToChannel, setSendToChannel] = useState(() => {\\n\\t\\tswitch (sendToChannelPreference) {\\n\\t\\t\\tcase 'always':\\n\\t\\t\\t\\treturn true;\\n\\t\\t\\tcase 'never':\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\tdefault:\\n\\t\\t\\t\\treturn !mainMessage.tcount;\\n\\t\\t}\\n\\t});\\n\\n\\tconst handleSend = useCallback((): void => {\\n\\t\\tif (sendToChannelPreference === 'default') {\\n\\t\\t\\tsetSendToChannel(false);\\n\\t\\t}\\n\\t}, [sendToChannelPreference]);\\n\\n\\tconst { closeTab } = useRoomToolbox();\\n\\n\\tconst handleComposerEscape = useCallback((): void => {\\n\\t\\tcloseTab();\\n\\t}, [closeTab]);\\n\\n\\tconst chat = useChat();\\n\\n\\tconst handleNavigateToPreviousMessage = useCallback((): void => {\\n\\t\\tchat?.messageEditing.toPreviousMessage();\\n\\t}, [chat?.messageEditing]);\\n\\n\\tconst handleNavigateToNextMessage = useCallback((): void => {\\n\\t\\tchat?.messageEditing.toNextMessage();\\n\\t}, [chat?.messageEditing]);\\n\\n\\tconst handleUploadFiles = useCallback(\\n\\t\\t(files: readonly File[]): void => {\\n\\t\\t\\tchat?.flows.uploadFiles(files);\\n\\t\\t},\\n\\t\\t[chat?.flows],\\n\\t);\\n\\n\\tconst room = useRoom();\\n\\tconst readThreads = useMethod('readThreads');\\n\\tuseEffect(() => {\\n\\t\\tcallbacks.add(\\n\\t\\t\\t'streamNewMessage',\\n\\t\\t\\t(msg: IMessage) => {\\n\\t\\t\\t\\tif (room._id !== msg.rid || isEditedMessage(msg) || msg.tmid !== mainMessage._id) {\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\treadThreads(mainMessage._id);\\n\\t\\t\\t},\\n\\t\\t\\tcallbacks.priority.MEDIUM,\\n\\t\\t\\t`thread-${room._id}`,\\n\\t\\t);\\n\\n\\t\\treturn () => {\\n\\t\\t\\tcallbacks.remove('streamNewMessage', `thread-${room._id}`);\\n\\t\\t};\\n\\t}, [mainMessage._id, readThreads, room._id]);\\n\\n\\tconst subscription = useRoomSubscription();\\n\\tconst sendToChannelID = useUniqueId();\\n\\tconst t = useTranslation();\\n\\n\\treturn (\\n\\t\\t<ContextualbarContent flexShrink={1} flexGrow={1} paddingInline={0} {...fileUploadTriggerProps}>\\n\\t\\t\\t<DateListProvider>\\n\\t\\t\\t\\t<DropTargetOverlay {...fileUploadOverlayProps} />\\n\\t\\t\\t\\t<Box\\n\\t\\t\\t\\t\\tis='section'\\n\\t\\t\\t\\t\\tposition='relative'\\n\\t\\t\\t\\t\\tdisplay='flex'\\n\\t\\t\\t\\t\\tflexDirection='column'\\n\\t\\t\\t\\t\\tflexGrow={1}\\n\\t\\t\\t\\t\\tflexShrink={1}\\n\\t\\t\\t\\t\\tflexBasis='auto'\\n\\t\\t\\t\\t\\theight='full'\\n\\t\\t\\t\\t>\\n\\t\\t\\t\\t\\t<MessageListErrorBoundary>\\n\\t\\t\\t\\t\\t\\t<ThreadMessageList mainMessage={mainMessage} />\\n\\t\\t\\t\\t\\t</MessageListErrorBoundary>\\n\\n\\t\\t\\t\\t\\t<RoomComposer>\\n\\t\\t\\t\\t\\t\\t<ComposerContainer\\n\\t\\t\\t\\t\\t\\t\\ttmid={mainMessage._id}\\n\\t\\t\\t\\t\\t\\t\\tsubscription={subscription}\\n\\t\\t\\t\\t\\t\\t\\tonSend={handleSend}\\n\\t\\t\\t\\t\\t\\t\\tonEscape={handleComposerEscape}\\n\\t\\t\\t\\t\\t\\t\\tonNavigateToPreviousMessage={handleNavigateToPreviousMessage}\\n\\t\\t\\t\\t\\t\\t\\tonNavigateToNextMessage={handleNavigateToNextMessage}\\n\\t\\t\\t\\t\\t\\t\\tonUploadFiles={handleUploadFiles}\\n\\t\\t\\t\\t\\t\\t\\ttshow={sendToChannel}\\n\\t\\t\\t\\t\\t\\t>\\n\\t\\t\\t\\t\\t\\t\\t<Field marginBlock={8}>\\n\\t\\t\\t\\t\\t\\t\\t\\t<FieldRow justifyContent='initial'>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<CheckBox\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tid={sendToChannelID}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tchecked={sendToChannel}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tonChange={() => setSendToChannel((checked) => !checked)}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tname='alsoSendThreadToChannel'\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<FieldLabel mis='x8' htmlFor={sendToChannelID} color='annotation' fontScale='p2'>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{t('Also_send_to_channel')}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t</FieldLabel>\\n\\t\\t\\t\\t\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t\\t\\t\\t\\t</Field>\\n\\t\\t\\t\\t\\t\\t</ComposerContainer>\\n\\t\\t\\t\\t\\t</RoomComposer>\\n\\t\\t\\t\\t</Box>\\n\\t\\t\\t</DateListProvider>\\n\\t\\t</ContextualbarContent>\\n\\t);\\n};\\n\\nexport default ThreadChat;\\n\",null],\"names\":[\"_extends\",\"isEditedMessage\",\"Box\",\"CheckBox\",\"Field\",\"FieldLabel\",\"FieldRow\",\"useUniqueId\",\"useMethod\",\"useTranslation\",\"useUserPreference\",\"React\",\"useState\",\"useEffect\",\"useCallback\",\"callbacks\",\"ContextualbarContent\",\"MessageListErrorBoundary\",\"DropTargetOverlay\",\"useFileUploadDropTarget\",\"ComposerContainer\",\"RoomComposer\",\"useChat\",\"useRoom\",\"useRoomSubscription\",\"useRoomToolbox\",\"DateListProvider\",\"ThreadMessageList\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"mainMessage\",\"fileUploadTriggerProps\",\"fileUploadOverlayProps\",\"sendToChannelPreference\",\"sendToChannel\",\"setSendToChannel\",\"tcount\",\"handleSend\",\"closeTab\",\"handleComposerEscape\",\"chat\",\"handleNavigateToPreviousMessage\",\"messageEditing\",\"toPreviousMessage\",\"handleNavigateToNextMessage\",\"toNextMessage\",\"handleUploadFiles\",\"files\",\"flows\",\"uploadFiles\",\"room\",\"readThreads\",\"add\",\"msg\",\"_id\",\"rid\",\"tmid\",\"priority\",\"MEDIUM\",\"concat\",\"remove\",\"subscription\",\"sendToChannelID\",\"t\",\"createElement\",\"flexShrink\",\"flexGrow\",\"paddingInline\",\"is\",\"position\",\"display\",\"flexDirection\",\"flexBasis\",\"height\",\"onSend\",\"onEscape\",\"onNavigateToPreviousMessage\",\"onNavigateToNextMessage\",\"onUploadFiles\",\"tshow\",\"marginBlock\",\"justifyContent\",\"id\",\"checked\",\"onChange\",\"name\",\"mis\",\"htmlFor\",\"color\",\"fontScale\"],\"mappings\":\"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\"}"}