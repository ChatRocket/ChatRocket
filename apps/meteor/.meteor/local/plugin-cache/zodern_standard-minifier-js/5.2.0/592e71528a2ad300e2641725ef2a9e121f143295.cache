{"code":"function module(e,t,i){let o,n,r,l,a,c,u,h;i.link(\"@rocket.chat/random\",{Random(e){o=e}},0),i.link(\"meteor/accounts-base\",{Accounts(e){n=e}},1),i.link(\"meteor/github-oauth\",{Github(e){r=e}},2),i.link(\"meteor/meteor\",{Meteor(e){l=e}},3),i.link(\"meteor/oauth\",{OAuth(e){a=e}},4),i.link(\"../../lib/2fa/overrideLoginMethod\",{overrideLoginMethod(e){c=e}},5),i.link(\"../../lib/wrapRequestCredentialFn\",{wrapRequestCredentialFn(e){u=e}},6),i.link(\"./oauth\",{createOAuthTotpLoginMethod(e){h=e}},7);let{loginWithGithub:d}=l,s=h(r);l.loginWithGithub=(e,t)=>{c(d,[e],t,s)},r.requestCredential=u(\"github\",e=>{var t;let{config:i,loginStyle:r,options:l,credentialRequestCompleteCallback:c}=e,u=o.secret(),h=(null==l?void 0:l.requestPermissions)||[\"user:email\"],d=h.map(encodeURIComponent).join(\"+\"),s=\"\";null!==(t=n._options)&&void 0!==t&&t.forbidClientAccountCreation&&(s=\"&allow_signup=false\");let g=\"https://github.com/login/oauth/authorize\"+\"?client_id=\".concat(i.clientId)+\"&scope=\".concat(d)+\"&redirect_uri=\".concat(a._redirectUri(\"github\",i))+\"&state=\".concat(a._stateParam(r,u,l.redirectUrl)).concat(s);a.launchLogin({loginService:\"github\",loginStyle:r,loginUrl:g,credentialRequestCompleteCallback:c,credentialToken:u,popupOptions:{width:900,height:450}})})}","map":"{\"version\":3,\"sources\":[\"client/meteorOverrides/login/github.ts\",\"<anon>\"],\"sourcesContent\":[\"import { Random } from '@rocket.chat/random';\\nimport { Accounts } from 'meteor/accounts-base';\\nimport { Github } from 'meteor/github-oauth';\\nimport { Meteor } from 'meteor/meteor';\\nimport { OAuth } from 'meteor/oauth';\\n\\nimport { overrideLoginMethod } from '../../lib/2fa/overrideLoginMethod';\\nimport { wrapRequestCredentialFn } from '../../lib/wrapRequestCredentialFn';\\nimport { createOAuthTotpLoginMethod } from './oauth';\\n\\nconst { loginWithGithub } = Meteor;\\nconst loginWithGithubAndTOTP = createOAuthTotpLoginMethod(Github);\\nMeteor.loginWithGithub = (options, callback) => {\\n\\toverrideLoginMethod(loginWithGithub, [options], callback, loginWithGithubAndTOTP);\\n};\\n\\nGithub.requestCredential = wrapRequestCredentialFn('github', ({ config, loginStyle, options, credentialRequestCompleteCallback }) => {\\n\\tconst credentialToken = Random.secret();\\n\\tconst scope = options?.requestPermissions || ['user:email'];\\n\\tconst flatScope = scope.map(encodeURIComponent).join('+');\\n\\n\\tlet allowSignup = '';\\n\\tif (Accounts._options?.forbidClientAccountCreation) {\\n\\t\\tallowSignup = '&allow_signup=false';\\n\\t}\\n\\n\\tconst loginUrl =\\n\\t\\t`https://github.com/login/oauth/authorize` +\\n\\t\\t`?client_id=${config.clientId}` +\\n\\t\\t`&scope=${flatScope}` +\\n\\t\\t`&redirect_uri=${OAuth._redirectUri('github', config)}` +\\n\\t\\t`&state=${OAuth._stateParam(loginStyle, credentialToken, options.redirectUrl)}${allowSignup}`;\\n\\n\\tOAuth.launchLogin({\\n\\t\\tloginService: 'github',\\n\\t\\tloginStyle,\\n\\t\\tloginUrl,\\n\\t\\tcredentialRequestCompleteCallback,\\n\\t\\tcredentialToken,\\n\\t\\tpopupOptions: { width: 900, height: 450 },\\n\\t});\\n});\\n\",null],\"names\":[\"Random\",\"Accounts\",\"Github\",\"Meteor\",\"OAuth\",\"overrideLoginMethod\",\"wrapRequestCredentialFn\",\"createOAuthTotpLoginMethod\",\"module\",\"link\",\"v\",\"loginWithGithub\",\"loginWithGithubAndTOTP\",\"options\",\"callback\",\"requestCredential\",\"_ref\",\"_Accounts$_options\",\"config\",\"loginStyle\",\"credentialRequestCompleteCallback\",\"credentialToken\",\"secret\",\"scope\",\"requestPermissions\",\"flatScope\",\"map\",\"encodeURIComponent\",\"join\",\"allowSignup\",\"_options\",\"forbidClientAccountCreation\",\"loginUrl\",\"concat\",\"clientId\",\"_redirectUri\",\"_stateParam\",\"redirectUrl\",\"launchLogin\",\"loginService\",\"popupOptions\",\"width\",\"height\"],\"mappings\":\"2BAAAA,EAA6CC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAApCC,EAAQC,IAAA,CAAM,sBAAsB,CAAAT,OAAAU,CAAA,EAAAV,EAAAU,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,uBAAA,CAAAR,SAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,sBAAA,CAAAP,OAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,gBAAA,CAAAN,OAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,eAAA,CAAAL,MAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,oCAAA,CAAAJ,oBAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,oCAAA,CAAAH,wBAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,UAAA,CAAAF,2BAAAG,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,GAU7C,GAAM,CAAEC,gBAAAA,CAAAA,CAAiB,CAAGR,EACtBS,EAAyBL,EAA2BL,EAC1DC,CAAAA,EAAOQ,eAAe,CAAG,CAACE,EAASC,KAClCT,EAAoBM,EAAiB,CAACE,EAAQ,CAAEC,EAAUF,EAC3D,EAEAV,EAAOa,iBAAiB,CAAGT,EAAwB,SAAUU,IAAuE,IAAAC,EAAA,GAAtE,CAAEC,OAAAA,CAAM,CAAEC,WAAAA,CAAU,CAAEN,QAAAA,CAAO,CAAEO,kCAAAA,CAAAA,CAAmC,CAAAJ,EACzHK,EAAkBrB,EAAOsB,MAAM,GAC/BC,EAAQ,AAAAV,CAAAA,MAAAA,EAAO,KAAA,EAAPA,EAASW,kBAAkB,AAAlBA,GAAsB,CAAC,aAAa,CACrDC,EAAYF,EAAMG,GAAG,CAACC,oBAAoBC,IAAI,CAAC,KAEjDC,EAAc,EACG,QAArBZ,CAAAA,EAAIhB,EAAS6B,QAAQ,AAARA,GAAQb,AAAA,KAAA,IAAAA,GAAjBA,EAAmBc,2BAA2B,EACjDF,CAAAA,EAAc,qBAAA,EAGf,IAAMG,EACL,2CAAA,cAAAC,MAAA,CACcf,EAAOgB,QAAQ,EAAE,UAAAD,MAAA,CACrBR,GAAW,iBAAAQ,MAAA,CACJ7B,EAAM+B,YAAY,CAAC,SAAUjB,IAAS,UAAAe,MAAA,CAC7C7B,EAAMgC,WAAW,CAACjB,EAAYE,EAAiBR,EAAQwB,WAAW,GAACJ,MAAA,CAAGJ,GAEjFzB,EAAMkC,WAAW,CAAC,CACjBC,aAAc,SACdpB,WAAAA,EACAa,SAAAA,EACAZ,kCAAAA,EACAC,gBAAAA,EACAmB,aAAc,CAAEC,MAAO,IAAKC,OAAQ,GAAG,GAEzC\"}"}