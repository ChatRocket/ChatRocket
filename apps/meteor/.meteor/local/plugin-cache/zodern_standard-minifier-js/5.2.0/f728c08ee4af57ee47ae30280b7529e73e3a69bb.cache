{"code":"function module(e,l,o){let n,t,i,r,a,s,u,d;o.link(\"@babel/runtime/helpers/objectSpread2\",{default(e){n=e}},0),o.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback(e){t=e}},0),o.link(\"@rocket.chat/ui-contexts\",{usePermission(e){i=e}},1),o.link(\"react\",{default(e){r=e},useState(e){a=e},useCallback(e){s=e}},2),o.link(\"./RemoveUsersFirstStep\",{default(e){u=e}},3),o.link(\"./RemoveUsersSecondStep\",{default(e){d=e}},4);let c={LIST_ROOMS:\"LIST_ROOMS\",CONFIRM_DELETE:\"CONFIRM_DELETE\"};o.exportDefault(e=>{let{onClose:l,onCancel:o,onConfirm:m,rooms:E,currentStep:R=(null==E?void 0:E.length)===0?c.CONFIRM_DELETE:c.LIST_ROOMS,username:O}=e,[f,C]=a(R),[S,v]=a({}),_=t(()=>C(c.CONFIRM_DELETE)),h=t(()=>C(c.LIST_ROOMS)),k=i(\"view-all-team-channels\"),g=null==E?void 0:E.filter(e=>{let{isLastOwner:l}=e;return!l}),L=s(e=>{v(l=>l[e._id]?(delete l[e._id],n({},l)):n(n({},l),{},{[e._id]:e}))},[]),M=t(()=>{if(0===Object.values(S).filter(Boolean).length){var e;return v(Object.fromEntries(null!==(e=null==g?void 0:g.map(e=>[e._id,e]))&&void 0!==e?e:[]))}v({})});if(f===c.CONFIRM_DELETE||!k){var T;return r.createElement(d,{onConfirm:m,onClose:l,onCancel:(null!==(T=null==E?void 0:E.length)&&void 0!==T?T:0)>0?h:o,deletedRooms:S,rooms:E,username:O})}return r.createElement(u,{onConfirm:_,onClose:l,onCancel:o,rooms:E,selectedRooms:S,onToggleAllRooms:M,onChangeRoomSelection:L,eligibleRoomsLength:null==g?void 0:g.length})})}","map":"{\"version\":3,\"sources\":[\"client/views/teams/contextualBar/members/RemoveUsersModal/BaseRemoveUsersModal.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom, Serialized } from '@rocket.chat/core-typings';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { usePermission } from '@rocket.chat/ui-contexts';\\nimport React, { useState, useCallback } from 'react';\\n\\nimport RemoveUsersFirstStep from './RemoveUsersFirstStep';\\nimport RemoveUsersSecondStep from './RemoveUsersSecondStep';\\n\\nconst STEPS = {\\n\\tLIST_ROOMS: 'LIST_ROOMS',\\n\\tCONFIRM_DELETE: 'CONFIRM_DELETE',\\n};\\n\\ntype BaseRemoveUsersModalProps = {\\n\\tonClose: () => void;\\n\\tonCancel: () => void;\\n\\tonConfirm: (deletedRooms: { [key: string]: Serialized<IRoom> }) => void;\\n\\tcurrentStep?: string;\\n\\trooms?: (Serialized<IRoom> & { isLastOwner?: boolean })[];\\n\\tusername?: string;\\n};\\n\\nconst BaseRemoveUsersModal = ({\\n\\tonClose,\\n\\tonCancel,\\n\\tonConfirm,\\n\\trooms,\\n\\tcurrentStep = rooms?.length === 0 ? STEPS.CONFIRM_DELETE : STEPS.LIST_ROOMS,\\n\\tusername,\\n}: BaseRemoveUsersModalProps) => {\\n\\tconst [step, setStep] = useState(currentStep);\\n\\n\\tconst [selectedRooms, setSelectedRooms] = useState<Record<string, Serialized<IRoom> & { isLastOwner?: boolean }>>({});\\n\\n\\tconst onContinue = useMutableCallback(() => setStep(STEPS.CONFIRM_DELETE));\\n\\tconst onReturn = useMutableCallback(() => setStep(STEPS.LIST_ROOMS));\\n\\n\\tconst canViewUserRooms = usePermission('view-all-team-channels');\\n\\n\\tconst eligibleRooms = rooms?.filter(({ isLastOwner }) => !isLastOwner);\\n\\n\\tconst onChangeRoomSelection = useCallback((room) => {\\n\\t\\tsetSelectedRooms((selectedRooms) => {\\n\\t\\t\\tif (selectedRooms[room._id]) {\\n\\t\\t\\t\\tdelete selectedRooms[room._id];\\n\\t\\t\\t\\treturn { ...selectedRooms };\\n\\t\\t\\t}\\n\\t\\t\\treturn { ...selectedRooms, [room._id]: room };\\n\\t\\t});\\n\\t}, []);\\n\\n\\tconst onToggleAllRooms = useMutableCallback(() => {\\n\\t\\tif (Object.values(selectedRooms).filter(Boolean).length === 0) {\\n\\t\\t\\treturn setSelectedRooms(Object.fromEntries(eligibleRooms?.map((room) => [room._id, room]) ?? []));\\n\\t\\t}\\n\\t\\tsetSelectedRooms({});\\n\\t});\\n\\n\\tif (step === STEPS.CONFIRM_DELETE || !canViewUserRooms) {\\n\\t\\treturn (\\n\\t\\t\\t<RemoveUsersSecondStep\\n\\t\\t\\t\\tonConfirm={onConfirm}\\n\\t\\t\\t\\tonClose={onClose}\\n\\t\\t\\t\\tonCancel={(rooms?.length ?? 0) > 0 ? onReturn : onCancel}\\n\\t\\t\\t\\tdeletedRooms={selectedRooms}\\n\\t\\t\\t\\trooms={rooms}\\n\\t\\t\\t\\tusername={username}\\n\\t\\t\\t/>\\n\\t\\t);\\n\\t}\\n\\n\\treturn (\\n\\t\\t<RemoveUsersFirstStep\\n\\t\\t\\tonConfirm={onContinue}\\n\\t\\t\\tonClose={onClose}\\n\\t\\t\\tonCancel={onCancel}\\n\\t\\t\\trooms={rooms}\\n\\t\\t\\tselectedRooms={selectedRooms}\\n\\t\\t\\tonToggleAllRooms={onToggleAllRooms}\\n\\t\\t\\tonChangeRoomSelection={onChangeRoomSelection}\\n\\t\\t\\teligibleRoomsLength={eligibleRooms?.length}\\n\\t\\t/>\\n\\t);\\n};\\n\\nexport default BaseRemoveUsersModal;\\n\",null],\"names\":[\"_objectSpread\",\"useMutableCallback\",\"usePermission\",\"React\",\"useState\",\"useCallback\",\"RemoveUsersFirstStep\",\"RemoveUsersSecondStep\",\"module\",\"link\",\"default\",\"v\",\"STEPS\",\"LIST_ROOMS\",\"CONFIRM_DELETE\",\"exportDefault\",\"_ref\",\"onClose\",\"onCancel\",\"onConfirm\",\"rooms\",\"currentStep\",\"length\",\"username\",\"step\",\"setStep\",\"selectedRooms\",\"setSelectedRooms\",\"onContinue\",\"onReturn\",\"canViewUserRooms\",\"eligibleRooms\",\"filter\",\"_ref2\",\"isLastOwner\",\"onChangeRoomSelection\",\"room\",\"_id\",\"onToggleAllRooms\",\"Object\",\"values\",\"Boolean\",\"_eligibleRooms$map\",\"fromEntries\",\"map\",\"_rooms$length\",\"createElement\",\"deletedRooms\",\"eligibleRoomsLength\"],\"mappings\":\"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\"}"}