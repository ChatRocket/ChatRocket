{"code":"function module(e,t,a){var n,r,i,l,o,c,u,s,f,d,m,k,p,v,b,g,x,E,A,U;a.link(\"@babel/runtime/regenerator\",{default:function(e){n=e}},0),a.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){r=e}},1),a.link(\"@rocket.chat/fuselage\",{Box:function(e){i=e},Button:function(e){l=e},Avatar:function(e){o=e},TextInput:function(e){c=e},IconButton:function(e){u=e},Label:function(e){s=e}},0),a.link(\"@rocket.chat/fuselage-hooks\",{useUniqueId:function(e){f=e}},1),a.link(\"@rocket.chat/ui-avatar\",{UserAvatar:function(e){d=e}},2),a.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch:function(e){m=e},useSetting:function(e){k=e},useTranslation:function(e){p=e}},3),a.link(\"react\",{default:function(e){v=e},useState:function(e){b=e},useCallback:function(e){g=e}},4),a.link(\"../../../hooks/useSingleFileInput\",{useSingleFileInput:function(e){x=e}},5),a.link(\"../../../lib/utils/isValidImageFormat\",{isValidImageFormat:function(e){E=e}},6),a.link(\"./UserAvatarSuggestions\",{default:function(e){A=e}},7),a.link(\"./readFileAsDataURL\",{readFileAsDataURL:function(e){U=e}},8),a.exportDefault(function(e){var t=e.currentUsername,a=e.username,h=e.setAvatarObj,y=e.disabled,_=e.etag,D=p(),F=k(\"FileUpload_RotateImages\"),S=b(\"\"),w=r(S,2),I=w[0],C=w[1],L=b(),q=r(L,2),T=q[0],R=q[1],j=f(),B=m(),O=g(function(e,t){var a;return n.async(function(r){for(;;)switch(r.prev=r.next){case 0:return h(t),r.prev=1,r.next=4,n.awrap(U(e));case 4:return a=r.sent,r.next=7,n.awrap(E(a));case 7:if(!r.sent){r.next=9;break}R(a);case 9:r.next=14;break;case 11:r.prev=11,r.t0=r.catch(1),B({type:\"error\",message:D(\"Avatar_format_invalid\")});case 14:case\"end\":return r.stop()}},null,null,[[1,11]],Promise)},[h,D,B]),G=x(O),P=r(G,1)[0],V=g(function(e){h(e),R(e.blob)},[h,R]);return v.createElement(i,{display:\"flex\",flexDirection:\"column\",fontScale:\"p2m\",color:\"default\"},D(\"Profile_picture\"),v.createElement(i,{display:\"flex\",flexDirection:\"row\",mbs:4},v.createElement(d,{size:\"x124\",url:T,key:T,\"data-qa-id\":\"UserAvatarEditor\",username:t||\"\",etag:_,style:{imageOrientation:F?\"from-image\":\"none\",objectFit:\"contain\"},onError:function(){return B({type:\"error\",message:D(\"error-invalid-image-url\")})}}),v.createElement(i,{display:\"flex\",flexDirection:\"column\",flexGrow:\"1\",justifyContent:\"space-between\",mis:4},v.createElement(i,{display:\"flex\",flexDirection:\"row\",mbs:\"none\"},v.createElement(l,{square:!0,disabled:y,mi:4,title:D(\"Accounts_SetDefaultAvatar\"),onClick:function(){R(\"/avatar/%40\"+a),h(\"reset\")}},v.createElement(o,{url:\"/avatar/%40\"+a})),v.createElement(u,{icon:\"upload\",secondary:!0,disabled:y,title:D(\"Upload\"),mi:4,onClick:P}),v.createElement(u,{icon:\"permalink\",secondary:!0,disabled:y||!I,title:D(\"Add_URL\"),mi:4,onClick:function(){R(I),h({avatarUrl:I})},\"data-qa-id\":\"UserAvatarEditorSetAvatarLink\"}),v.createElement(A,{disabled:y,onSelectOne:V})),v.createElement(s,{htmlFor:j,mis:4},D(\"Use_url_for_avatar\")),v.createElement(c,{\"data-qa-id\":\"UserAvatarEditorLink\",id:j,flexGrow:0,placeholder:D(\"Use_url_for_avatar\"),value:I,mis:4,onChange:function(e){C(e.currentTarget.value)}}))))})}","map":"{\"version\":3,\"sources\":[\"client/components/avatar/UserAvatarEditor/UserAvatarEditor.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IUser, AvatarObject } from '@rocket.chat/core-typings';\\nimport { Box, Button, Avatar, TextInput, IconButton, Label } from '@rocket.chat/fuselage';\\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\\nimport { UserAvatar } from '@rocket.chat/ui-avatar';\\nimport { useToastMessageDispatch, useSetting, useTranslation } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement, ChangeEvent } from 'react';\\nimport React, { useState, useCallback } from 'react';\\n\\nimport { useSingleFileInput } from '../../../hooks/useSingleFileInput';\\nimport { isValidImageFormat } from '../../../lib/utils/isValidImageFormat';\\nimport type { UserAvatarSuggestion } from './UserAvatarSuggestion';\\nimport UserAvatarSuggestions from './UserAvatarSuggestions';\\nimport { readFileAsDataURL } from './readFileAsDataURL';\\n\\ntype UserAvatarEditorProps = {\\n\\tcurrentUsername: IUser['username'];\\n\\tusername: IUser['username'];\\n\\tsetAvatarObj: (obj: AvatarObject) => void;\\n\\tdisabled?: boolean;\\n\\tetag: IUser['avatarETag'];\\n};\\n\\nfunction UserAvatarEditor({ currentUsername, username, setAvatarObj, disabled, etag }: UserAvatarEditorProps): ReactElement {\\n\\tconst t = useTranslation();\\n\\tconst rotateImages = useSetting('FileUpload_RotateImages');\\n\\tconst [avatarFromUrl, setAvatarFromUrl] = useState('');\\n\\tconst [newAvatarSource, setNewAvatarSource] = useState<string>();\\n\\tconst imageUrlField = useUniqueId();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst setUploadedPreview = useCallback(\\n\\t\\tasync (file, avatarObj) => {\\n\\t\\t\\tsetAvatarObj(avatarObj);\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tconst dataURL = await readFileAsDataURL(file);\\n\\n\\t\\t\\t\\tif (await isValidImageFormat(dataURL)) {\\n\\t\\t\\t\\t\\tsetNewAvatarSource(dataURL);\\n\\t\\t\\t\\t}\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('Avatar_format_invalid') });\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t[setAvatarObj, t, dispatchToastMessage],\\n\\t);\\n\\n\\tconst [clickUpload] = useSingleFileInput(setUploadedPreview);\\n\\n\\tconst handleAddUrl = (): void => {\\n\\t\\tsetNewAvatarSource(avatarFromUrl);\\n\\t\\tsetAvatarObj({ avatarUrl: avatarFromUrl });\\n\\t};\\n\\n\\tconst clickReset = (): void => {\\n\\t\\tsetNewAvatarSource(`/avatar/%40${username}`);\\n\\t\\tsetAvatarObj('reset');\\n\\t};\\n\\n\\tconst url = newAvatarSource;\\n\\n\\tconst handleAvatarFromUrlChange = (event: ChangeEvent<HTMLInputElement>): void => {\\n\\t\\tsetAvatarFromUrl(event.currentTarget.value);\\n\\t};\\n\\n\\tconst handleSelectSuggestion = useCallback(\\n\\t\\t(suggestion: UserAvatarSuggestion) => {\\n\\t\\t\\tsetAvatarObj(suggestion as unknown as AvatarObject);\\n\\t\\t\\tsetNewAvatarSource(suggestion.blob);\\n\\t\\t},\\n\\t\\t[setAvatarObj, setNewAvatarSource],\\n\\t);\\n\\n\\treturn (\\n\\t\\t<Box display='flex' flexDirection='column' fontScale='p2m' color='default'>\\n\\t\\t\\t{t('Profile_picture')}\\n\\t\\t\\t<Box display='flex' flexDirection='row' mbs={4}>\\n\\t\\t\\t\\t<UserAvatar\\n\\t\\t\\t\\t\\tsize='x124'\\n\\t\\t\\t\\t\\turl={url}\\n\\t\\t\\t\\t\\tkey={url}\\n\\t\\t\\t\\t\\tdata-qa-id='UserAvatarEditor'\\n\\t\\t\\t\\t\\tusername={currentUsername || ''}\\n\\t\\t\\t\\t\\tetag={etag}\\n\\t\\t\\t\\t\\tstyle={{\\n\\t\\t\\t\\t\\t\\timageOrientation: rotateImages ? 'from-image' : 'none',\\n\\t\\t\\t\\t\\t\\tobjectFit: 'contain',\\n\\t\\t\\t\\t\\t}}\\n\\t\\t\\t\\t\\tonError={() => dispatchToastMessage({ type: 'error', message: t('error-invalid-image-url') })}\\n\\t\\t\\t\\t/>\\n\\t\\t\\t\\t<Box display='flex' flexDirection='column' flexGrow='1' justifyContent='space-between' mis={4}>\\n\\t\\t\\t\\t\\t<Box display='flex' flexDirection='row' mbs='none'>\\n\\t\\t\\t\\t\\t\\t<Button square disabled={disabled} mi={4} title={t('Accounts_SetDefaultAvatar')} onClick={clickReset}>\\n\\t\\t\\t\\t\\t\\t\\t<Avatar url={`/avatar/%40${username}`} />\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t\\t<IconButton icon='upload' secondary disabled={disabled} title={t('Upload')} mi={4} onClick={clickUpload} />\\n\\t\\t\\t\\t\\t\\t<IconButton\\n\\t\\t\\t\\t\\t\\t\\ticon='permalink'\\n\\t\\t\\t\\t\\t\\t\\tsecondary\\n\\t\\t\\t\\t\\t\\t\\tdisabled={disabled || !avatarFromUrl}\\n\\t\\t\\t\\t\\t\\t\\ttitle={t('Add_URL')}\\n\\t\\t\\t\\t\\t\\t\\tmi={4}\\n\\t\\t\\t\\t\\t\\t\\tonClick={handleAddUrl}\\n\\t\\t\\t\\t\\t\\t\\tdata-qa-id='UserAvatarEditorSetAvatarLink'\\n\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t<UserAvatarSuggestions disabled={disabled} onSelectOne={handleSelectSuggestion} />\\n\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t<Label htmlFor={imageUrlField} mis={4}>\\n\\t\\t\\t\\t\\t\\t{t('Use_url_for_avatar')}\\n\\t\\t\\t\\t\\t</Label>\\n\\t\\t\\t\\t\\t<TextInput\\n\\t\\t\\t\\t\\t\\tdata-qa-id='UserAvatarEditorLink'\\n\\t\\t\\t\\t\\t\\tid={imageUrlField}\\n\\t\\t\\t\\t\\t\\tflexGrow={0}\\n\\t\\t\\t\\t\\t\\tplaceholder={t('Use_url_for_avatar')}\\n\\t\\t\\t\\t\\t\\tvalue={avatarFromUrl}\\n\\t\\t\\t\\t\\t\\tmis={4}\\n\\t\\t\\t\\t\\t\\tonChange={handleAvatarFromUrlChange}\\n\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t</Box>\\n\\t\\t\\t</Box>\\n\\t\\t</Box>\\n\\t);\\n}\\n\\nexport default UserAvatarEditor;\\n\",null],\"names\":[\"_regeneratorRuntime\",\"_slicedToArray\",\"Box\",\"Button\",\"Avatar\",\"TextInput\",\"IconButton\",\"Label\",\"useUniqueId\",\"UserAvatar\",\"useToastMessageDispatch\",\"useSetting\",\"useTranslation\",\"React\",\"useState\",\"useCallback\",\"useSingleFileInput\",\"isValidImageFormat\",\"UserAvatarSuggestions\",\"readFileAsDataURL\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"currentUsername\",\"username\",\"setAvatarObj\",\"disabled\",\"etag\",\"t\",\"rotateImages\",\"_useState\",\"_useState2\",\"avatarFromUrl\",\"setAvatarFromUrl\",\"_useState3\",\"_useState4\",\"newAvatarSource\",\"setNewAvatarSource\",\"imageUrlField\",\"dispatchToastMessage\",\"setUploadedPreview\",\"file\",\"avatarObj\",\"dataURL\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"sent\",\"t0\",\"type\",\"message\",\"stop\",\"Promise\",\"_useSingleFileInput\",\"clickUpload\",\"_useSingleFileInput2\",\"handleSelectSuggestion\",\"suggestion\",\"blob\",\"createElement\",\"display\",\"flexDirection\",\"fontScale\",\"color\",\"mbs\",\"size\",\"url\",\"key\",\"style\",\"imageOrientation\",\"objectFit\",\"onError\",\"flexGrow\",\"justifyContent\",\"mis\",\"square\",\"mi\",\"title\",\"onClick\",\"icon\",\"secondary\",\"avatarUrl\",\"onSelectOne\",\"htmlFor\",\"id\",\"placeholder\",\"value\",\"onChange\",\"event\",\"currentTarget\"],\"mappings\":\"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\"}"}