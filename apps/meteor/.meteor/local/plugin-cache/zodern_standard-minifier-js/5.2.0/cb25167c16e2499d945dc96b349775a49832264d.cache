{"code":"function module(e,n,t){var r,o,i,a,u,l,c,s,m,d,f,g,E,p,k,h,b,v,C,_,F,x;t.link(\"@babel/runtime/helpers/extends\",{default:function(e){r=e}},0),t.link(\"@babel/runtime/regenerator\",{default:function(e){o=e}},1),t.link(\"@rocket.chat/fuselage\",{Box:function(e){i=e},Modal:function(e){a=e},Button:function(e){u=e},FieldGroup:function(e){l=e},Field:function(e){c=e},FieldRow:function(e){s=e},FieldError:function(e){m=e},FieldHint:function(e){d=e}},0),t.link(\"@rocket.chat/fuselage-hooks\",{useUniqueId:function(e){f=e}},1),t.link(\"@rocket.chat/ui-contexts\",{useTranslation:function(e){g=e},useEndpoint:function(e){E=e},useToastMessageDispatch:function(e){p=e},useSetting:function(e){k=e}},2),t.link(\"@tanstack/react-query\",{useMutation:function(e){h=e}},3),t.link(\"react\",{default:function(e){b=e},memo:function(e){v=e}},4),t.link(\"react-hook-form\",{useForm:function(e){C=e},Controller:function(e){_=e}},5),t.link(\"../../components/UserAutoCompleteMultiple/UserAutoCompleteMultipleFederated\",{default:function(e){F=e}},6),t.link(\"../../lib/utils/goToRoomById\",{goToRoomById:function(e){x=e}},7),t.exportDefault(v(function(e){var n=e.onClose,t=g(),v=k(\"DirectMesssage_maxUsers\")||1,y=f(),S=p(),B=E(\"POST\",\"/v1/dm.create\"),D=C({mode:\"onBlur\",defaultValues:{users:[]}}),M=D.control,T=D.handleSubmit,q=D.formState,U=q.isSubmitting,I=q.isValidating,w=q.errors,A=h({mutationFn:B,onSuccess:function(e){var n=e.room.rid;x(n)},onError:function(e){S({type:\"error\",message:e})},onSettled:function(){n()}}),R=function(e){var n;return o.async(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.users,t.abrupt(\"return\",A.mutateAsync({usernames:n.join(\",\")}));case 2:case\"end\":return t.stop()}},null,null,null,Promise)};return b.createElement(a,{\"data-qa\":\"create-direct-modal\",wrapperFunction:function(e){return b.createElement(i,r({is:\"form\",onSubmit:T(R)},e))}},b.createElement(a.Header,null,b.createElement(a.Title,null,t(\"Create_direct_message\")),b.createElement(a.Close,{tabIndex:-1,onClick:n})),b.createElement(a.Content,{mbe:2},b.createElement(l,null,b.createElement(c,null,b.createElement(i,{htmlFor:y},t(\"Direct_message_creation_description\")),b.createElement(s,null,b.createElement(_,{name:\"users\",rules:{required:t(\"Direct_message_creation_error\"),validate:function(e){return e.length+1>v?t(\"error-direct-message-max-user-exceeded\",{maxUsers:v}):void 0}},control:M,render:function(e){var n=e.field,t=n.name,r=n.onChange,o=n.value,i=n.onBlur;return b.createElement(F,{name:t,onChange:r,value:o,onBlur:i,id:y,\"aria-describedby\":y+\"-hint \"+y+\"-error\",\"aria-required\":\"true\",\"aria-invalid\":!!w.users})}})),w.users&&b.createElement(m,{\"aria-live\":\"assertive\",id:y+\"-error\"},w.users.message),b.createElement(d,{id:y+\"-hint\"},t(\"Direct_message_creation_description_hint\"))))),b.createElement(a.Footer,null,b.createElement(a.FooterControllers,null,b.createElement(u,{onClick:n},t(\"Cancel\")),b.createElement(u,{loading:U||I,type:\"submit\",primary:!0},t(\"Create\")))))}))}","map":"{\"version\":3,\"sources\":[\"client/sidebarv2/header/CreateDirectMessage.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IUser } from '@rocket.chat/core-typings';\\nimport { Box, Modal, Button, FieldGroup, Field, FieldRow, FieldError, FieldHint } from '@rocket.chat/fuselage';\\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\\nimport { useTranslation, useEndpoint, useToastMessageDispatch, useSetting } from '@rocket.chat/ui-contexts';\\nimport { useMutation } from '@tanstack/react-query';\\nimport React, { memo } from 'react';\\nimport { useForm, Controller } from 'react-hook-form';\\n\\nimport UserAutoCompleteMultipleFederated from '../../components/UserAutoCompleteMultiple/UserAutoCompleteMultipleFederated';\\nimport { goToRoomById } from '../../lib/utils/goToRoomById';\\n\\ntype CreateDirectMessageProps = { onClose: () => void };\\n\\nconst CreateDirectMessage = ({ onClose }: CreateDirectMessageProps) => {\\n\\tconst t = useTranslation();\\n\\tconst directMaxUsers = useSetting<number>('DirectMesssage_maxUsers') || 1;\\n\\tconst membersFieldId = useUniqueId();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst createDirectAction = useEndpoint('POST', '/v1/dm.create');\\n\\n\\tconst {\\n\\t\\tcontrol,\\n\\t\\thandleSubmit,\\n\\t\\tformState: { isSubmitting, isValidating, errors },\\n\\t} = useForm({ mode: 'onBlur', defaultValues: { users: [] } });\\n\\n\\tconst mutateDirectMessage = useMutation({\\n\\t\\tmutationFn: createDirectAction,\\n\\t\\tonSuccess: ({ room: { rid } }) => {\\n\\t\\t\\tgoToRoomById(rid);\\n\\t\\t},\\n\\t\\tonError: (error) => {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t},\\n\\t\\tonSettled: () => {\\n\\t\\t\\tonClose();\\n\\t\\t},\\n\\t});\\n\\n\\tconst handleCreate = async ({ users }: { users: IUser['username'][] }) => {\\n\\t\\treturn mutateDirectMessage.mutateAsync({ usernames: users.join(',') });\\n\\t};\\n\\n\\treturn (\\n\\t\\t<Modal data-qa='create-direct-modal' wrapperFunction={(props) => <Box is='form' onSubmit={handleSubmit(handleCreate)} {...props} />}>\\n\\t\\t\\t<Modal.Header>\\n\\t\\t\\t\\t<Modal.Title>{t('Create_direct_message')}</Modal.Title>\\n\\t\\t\\t\\t<Modal.Close tabIndex={-1} onClick={onClose} />\\n\\t\\t\\t</Modal.Header>\\n\\t\\t\\t<Modal.Content mbe={2}>\\n\\t\\t\\t\\t<FieldGroup>\\n\\t\\t\\t\\t\\t<Field>\\n\\t\\t\\t\\t\\t\\t<Box htmlFor={membersFieldId}>{t('Direct_message_creation_description')}</Box>\\n\\t\\t\\t\\t\\t\\t<FieldRow>\\n\\t\\t\\t\\t\\t\\t\\t<Controller\\n\\t\\t\\t\\t\\t\\t\\t\\tname='users'\\n\\t\\t\\t\\t\\t\\t\\t\\trules={{\\n\\t\\t\\t\\t\\t\\t\\t\\t\\trequired: t('Direct_message_creation_error'),\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tvalidate: (users) =>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tusers.length + 1 > directMaxUsers\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t? t('error-direct-message-max-user-exceeded', { maxUsers: directMaxUsers })\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t: undefined,\\n\\t\\t\\t\\t\\t\\t\\t\\t}}\\n\\t\\t\\t\\t\\t\\t\\t\\tcontrol={control}\\n\\t\\t\\t\\t\\t\\t\\t\\trender={({ field: { name, onChange, value, onBlur } }) => (\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<UserAutoCompleteMultipleFederated\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tname={name}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tonChange={onChange}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tvalue={value}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tonBlur={onBlur}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tid={membersFieldId}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\taria-describedby={`${membersFieldId}-hint ${membersFieldId}-error`}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\taria-required='true'\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\taria-invalid={Boolean(errors.users)}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t\\t\\t\\t{errors.users && (\\n\\t\\t\\t\\t\\t\\t\\t<FieldError aria-live='assertive' id={`${membersFieldId}-error`}>\\n\\t\\t\\t\\t\\t\\t\\t\\t{errors.users.message}\\n\\t\\t\\t\\t\\t\\t\\t</FieldError>\\n\\t\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t\\t<FieldHint id={`${membersFieldId}-hint`}>{t('Direct_message_creation_description_hint')}</FieldHint>\\n\\t\\t\\t\\t\\t</Field>\\n\\t\\t\\t\\t</FieldGroup>\\n\\t\\t\\t</Modal.Content>\\n\\t\\t\\t<Modal.Footer>\\n\\t\\t\\t\\t<Modal.FooterControllers>\\n\\t\\t\\t\\t\\t<Button onClick={onClose}>{t('Cancel')}</Button>\\n\\t\\t\\t\\t\\t<Button loading={isSubmitting || isValidating} type='submit' primary>\\n\\t\\t\\t\\t\\t\\t{t('Create')}\\n\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t</Modal.FooterControllers>\\n\\t\\t\\t</Modal.Footer>\\n\\t\\t</Modal>\\n\\t);\\n};\\n\\nexport default memo(CreateDirectMessage);\\n\",null],\"names\":[\"_extends\",\"_regeneratorRuntime\",\"Box\",\"Modal\",\"Button\",\"FieldGroup\",\"Field\",\"FieldRow\",\"FieldError\",\"FieldHint\",\"useUniqueId\",\"useTranslation\",\"useEndpoint\",\"useToastMessageDispatch\",\"useSetting\",\"useMutation\",\"React\",\"memo\",\"useForm\",\"Controller\",\"UserAutoCompleteMultipleFederated\",\"goToRoomById\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"onClose\",\"t\",\"directMaxUsers\",\"membersFieldId\",\"dispatchToastMessage\",\"createDirectAction\",\"_useForm\",\"mode\",\"defaultValues\",\"users\",\"control\",\"handleSubmit\",\"_useForm$formState\",\"formState\",\"isSubmitting\",\"isValidating\",\"errors\",\"mutateDirectMessage\",\"mutationFn\",\"onSuccess\",\"_ref2\",\"rid\",\"room\",\"onError\",\"error\",\"type\",\"message\",\"onSettled\",\"handleCreate\",\"_ref3\",\"async\",\"_context\",\"prev\",\"next\",\"abrupt\",\"mutateAsync\",\"usernames\",\"join\",\"stop\",\"Promise\",\"createElement\",\"wrapperFunction\",\"props\",\"is\",\"onSubmit\",\"Header\",\"Title\",\"Close\",\"tabIndex\",\"onClick\",\"Content\",\"mbe\",\"htmlFor\",\"name\",\"rules\",\"required\",\"validate\",\"length\",\"maxUsers\",\"undefined\",\"render\",\"_ref4\",\"_ref4$field\",\"field\",\"onChange\",\"value\",\"onBlur\",\"id\",\"Boolean\",\"Footer\",\"FooterControllers\",\"loading\",\"primary\"],\"mappings\":\"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\"}"}