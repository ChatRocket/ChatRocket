{"code":"function module(e,t,o){let n,i,r,a,E,l,m,d,s,u;o.export({useEditRoomPermissions:()=>R}),o.link(\"@rocket.chat/ui-contexts\",{usePermission(e){n=e},useAtLeastOnePermission(e){i=e},useRole(e){r=e},useEndpoint(e){a=e}},0),o.link(\"@tanstack/react-query\",{useQuery(e){E=e}},1),o.link(\"react\",{useMemo(e){l=e}},2),o.link(\"../../../../../../app/e2e/client/E2EEState\",{E2EEState(e){m=e}},3),o.link(\"../../../../../../definition/IRoomTypeConfig\",{RoomSettingsEnum(e){d=e}},4),o.link(\"../../../../../lib/rooms/roomCoordinator\",{roomCoordinator(e){s=e}},5),o.link(\"../../../hooks/useE2EEState\",{useE2EEState(e){u=e}},6);let c=(e,t,o,n)=>(!e.default||n)&&(\"p\"===e.t&&t||\"c\"===e.t&&o),R=e=>{let t=r(\"admin\"),o=u(),R=o===m.READY||o===m.SAVE_PASSWORD,S=n(\"create-c\"),I=n(\"create-p\"),_=a(\"GET\",\"/v1/teams.info\"),p=e.teamId||\"\",{data:A}=E([\"teamId\",p],async()=>_({teamId:p}),{keepPreviousData:!0,retry:!1,enabled:\"\"!==e.teamId}),k=n(\"create-team-channel\",null==A?void 0:A.teamInfo.roomId),C=n(\"create-team-group\",null==A?void 0:A.teamInfo.roomId),N=c(e,p?k:S,p?C:I,t),v=n(\"set-readonly\",e._id),y=n(\"set-react-when-readonly\",e._id),O=n(\"edit-room-retention-policy\",e._id),g=i(l(()=>[\"archive-room\",\"unarchive-room\"],[]),e._id),D=n(\"toggle-room-e2e-encryption\",e._id)&&(e.encrypted||R),[P,T,f,h,M,Y,H,L,V,b,w]=l(()=>{var t;let o=(null===(t=s.getRoomDirectives(e.t))||void 0===t?void 0:t.allowRoomSettingChange)||(()=>{});return[o(e,d.NAME),o(e,d.TOPIC),o(e,d.ANNOUNCEMENT),o(e,d.ARCHIVE_OR_UNARCHIVE),o(e,d.DESCRIPTION),o(e,d.TYPE),o(e,d.READ_ONLY),o(e,d.SYSTEM_MESSAGES),o(e,d.JOIN_CODE),o(e,d.REACT_WHEN_READ_ONLY),o(e,d.E2E)]},[e]);return{canChangeType:N,canSetReadOnly:v,canSetReactWhenReadOnly:y,canEditRoomRetentionPolicy:O,canArchiveOrUnarchive:g,canToggleEncryption:D,canViewName:P,canViewTopic:T,canViewAnnouncement:f,canViewArchived:h,canViewDescription:M,canViewType:Y,canViewReadOnly:H,canViewHideSysMes:L,canViewJoinCode:V,canViewReactWhenReadOnly:b,canViewEncrypted:w}}}","map":"{\"version\":3,\"sources\":[\"client/views/room/contextualBar/Info/EditRoomInfo/useEditRoomPermissions.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom, IRoomWithRetentionPolicy } from '@rocket.chat/core-typings';\\nimport { usePermission, useAtLeastOnePermission, useRole, useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useQuery } from '@tanstack/react-query';\\nimport { useMemo } from 'react';\\n\\nimport { E2EEState } from '../../../../../../app/e2e/client/E2EEState';\\nimport { RoomSettingsEnum } from '../../../../../../definition/IRoomTypeConfig';\\nimport { roomCoordinator } from '../../../../../lib/rooms/roomCoordinator';\\nimport { useE2EEState } from '../../../hooks/useE2EEState';\\n\\nconst getCanChangeType = (room: IRoom | IRoomWithRetentionPolicy, canCreateChannel: boolean, canCreateGroup: boolean, isAdmin: boolean) =>\\n\\t(!room.default || isAdmin) && ((room.t === 'p' && canCreateChannel) || (room.t === 'c' && canCreateGroup));\\n\\nexport const useEditRoomPermissions = (room: IRoom | IRoomWithRetentionPolicy) => {\\n\\tconst isAdmin = useRole('admin');\\n\\tconst e2eeState = useE2EEState();\\n\\tconst isE2EEReady = e2eeState === E2EEState.READY || e2eeState === E2EEState.SAVE_PASSWORD;\\n\\tconst canCreateChannel = usePermission('create-c');\\n\\tconst canCreateGroup = usePermission('create-p');\\n\\tconst teamsInfoEndpoint = useEndpoint('GET', '/v1/teams.info');\\n\\n\\tconst teamId = room.teamId || '';\\n\\tconst { data: teamInfoData } = useQuery(['teamId', teamId], async () => teamsInfoEndpoint({ teamId }), {\\n\\t\\tkeepPreviousData: true,\\n\\t\\tretry: false,\\n\\t\\tenabled: room.teamId !== '',\\n\\t});\\n\\n\\tconst canCreateTeamChannel = usePermission('create-team-channel', teamInfoData?.teamInfo.roomId);\\n\\tconst canCreateTeamGroup = usePermission('create-team-group', teamInfoData?.teamInfo.roomId);\\n\\n\\tconst canChangeType = getCanChangeType(\\n\\t\\troom,\\n\\t\\tteamId ? canCreateTeamChannel : canCreateChannel,\\n\\t\\tteamId ? canCreateTeamGroup : canCreateGroup,\\n\\t\\tisAdmin,\\n\\t);\\n\\tconst canSetReadOnly = usePermission('set-readonly', room._id);\\n\\tconst canSetReactWhenReadOnly = usePermission('set-react-when-readonly', room._id);\\n\\tconst canEditRoomRetentionPolicy = usePermission('edit-room-retention-policy', room._id);\\n\\tconst canArchiveOrUnarchive = useAtLeastOnePermission(\\n\\t\\tuseMemo(() => ['archive-room', 'unarchive-room'], []),\\n\\t\\troom._id,\\n\\t);\\n\\tconst canToggleEncryption = usePermission('toggle-room-e2e-encryption', room._id) && (room.encrypted || isE2EEReady);\\n\\n\\tconst [\\n\\t\\tcanViewName,\\n\\t\\tcanViewTopic,\\n\\t\\tcanViewAnnouncement,\\n\\t\\tcanViewArchived,\\n\\t\\tcanViewDescription,\\n\\t\\tcanViewType,\\n\\t\\tcanViewReadOnly,\\n\\t\\tcanViewHideSysMes,\\n\\t\\tcanViewJoinCode,\\n\\t\\tcanViewReactWhenReadOnly,\\n\\t\\tcanViewEncrypted,\\n\\t] = useMemo(() => {\\n\\t\\tconst isAllowed =\\n\\t\\t\\troomCoordinator.getRoomDirectives(room.t)?.allowRoomSettingChange ||\\n\\t\\t\\t(() => {\\n\\t\\t\\t\\tundefined;\\n\\t\\t\\t});\\n\\t\\treturn [\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.NAME),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.TOPIC),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.ANNOUNCEMENT),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.ARCHIVE_OR_UNARCHIVE),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.DESCRIPTION),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.TYPE),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.READ_ONLY),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.SYSTEM_MESSAGES),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.JOIN_CODE),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.REACT_WHEN_READ_ONLY),\\n\\t\\t\\tisAllowed(room, RoomSettingsEnum.E2E),\\n\\t\\t];\\n\\t}, [room]);\\n\\n\\treturn {\\n\\t\\tcanChangeType,\\n\\t\\tcanSetReadOnly,\\n\\t\\tcanSetReactWhenReadOnly,\\n\\t\\tcanEditRoomRetentionPolicy,\\n\\t\\tcanArchiveOrUnarchive,\\n\\t\\tcanToggleEncryption,\\n\\t\\tcanViewName,\\n\\t\\tcanViewTopic,\\n\\t\\tcanViewAnnouncement,\\n\\t\\tcanViewArchived,\\n\\t\\tcanViewDescription,\\n\\t\\tcanViewType,\\n\\t\\tcanViewReadOnly,\\n\\t\\tcanViewHideSysMes,\\n\\t\\tcanViewJoinCode,\\n\\t\\tcanViewReactWhenReadOnly,\\n\\t\\tcanViewEncrypted,\\n\\t};\\n};\\n\",null],\"names\":[\"usePermission\",\"useAtLeastOnePermission\",\"useRole\",\"useEndpoint\",\"useQuery\",\"useMemo\",\"E2EEState\",\"RoomSettingsEnum\",\"roomCoordinator\",\"useE2EEState\",\"module\",\"export\",\"useEditRoomPermissions\",\"link\",\"v\",\"getCanChangeType\",\"room\",\"canCreateChannel\",\"canCreateGroup\",\"isAdmin\",\"default\",\"t\",\"e2eeState\",\"isE2EEReady\",\"READY\",\"SAVE_PASSWORD\",\"teamsInfoEndpoint\",\"teamId\",\"data\",\"teamInfoData\",\"keepPreviousData\",\"retry\",\"enabled\",\"canCreateTeamChannel\",\"teamInfo\",\"roomId\",\"canCreateTeamGroup\",\"canChangeType\",\"canSetReadOnly\",\"_id\",\"canSetReactWhenReadOnly\",\"canEditRoomRetentionPolicy\",\"canArchiveOrUnarchive\",\"canToggleEncryption\",\"encrypted\",\"canViewName\",\"canViewTopic\",\"canViewAnnouncement\",\"canViewArchived\",\"canViewDescription\",\"canViewType\",\"canViewReadOnly\",\"canViewHideSysMes\",\"canViewJoinCode\",\"canViewReactWhenReadOnly\",\"canViewEncrypted\",\"_roomCoordinator$getR\",\"isAllowed\",\"getRoomDirectives\",\"allowRoomSettingChange\",\"NAME\",\"TOPIC\",\"ANNOUNCEMENT\",\"ARCHIVE_OR_UNARCHIVE\",\"DESCRIPTION\",\"TYPE\",\"READ_ONLY\",\"SYSTEM_MESSAGES\",\"JOIN_CODE\",\"REACT_WHEN_READ_ONLY\",\"E2E\"],\"mappings\":\"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\"}"}