{"code":"function module(e,t,o){let r,n,u,i,s;o.link(\"meteor/meteor\",{Meteor(e){r=e}},0),o.link(\"meteor/tracker\",{Tracker(e){n=e}},1),o.link(\"underscore\",{default(e){u=e}},2),o.link(\"../../custom-oauth/client/CustomOAuth\",{CustomOAuth(e){i=e}},3),o.link(\"../../settings/client\",{settings(e){s=e}},4);let a={serverURL:\"\",tokenPath:\"/index.php/apps/oauth2/api/v1/token\",tokenSentVia:\"header\",authorizePath:\"/index.php/apps/oauth2/authorize\",identityPath:\"/ocs/v2.php/cloud/user?format=json\",scope:\"openid\",addAutopublishFields:{forLoggedInUser:[\"services.nextcloud\"],forOtherUsers:[\"services.nextcloud.name\"]}},c=new i(\"nextcloud\",a),d=u.debounce(()=>{let e=s.get(\"Accounts_OAuth_Nextcloud_URL\");return e?(a.serverURL=e.trim().replace(/\\/*$/,\"\"),c.configure(a)):void 0===e?d():void 0},100);r.startup(()=>{n.autorun(()=>d())})}","map":"{\"version\":3,\"sources\":[\"app/nextcloud/client/lib.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { OauthConfig } from '@rocket.chat/core-typings';\\nimport { Meteor } from 'meteor/meteor';\\nimport { Tracker } from 'meteor/tracker';\\nimport _ from 'underscore';\\n\\nimport { CustomOAuth } from '../../custom-oauth/client/CustomOAuth';\\nimport { settings } from '../../settings/client';\\n\\nconst config: OauthConfig = {\\n\\tserverURL: '',\\n\\ttokenPath: '/index.php/apps/oauth2/api/v1/token',\\n\\ttokenSentVia: 'header',\\n\\tauthorizePath: '/index.php/apps/oauth2/authorize',\\n\\tidentityPath: '/ocs/v2.php/cloud/user?format=json',\\n\\tscope: 'openid',\\n\\taddAutopublishFields: {\\n\\t\\tforLoggedInUser: ['services.nextcloud'],\\n\\t\\tforOtherUsers: ['services.nextcloud.name'],\\n\\t},\\n};\\n\\nconst Nextcloud = new CustomOAuth('nextcloud', config);\\n\\nconst fillServerURL = _.debounce((): void => {\\n\\tconst nextcloudURL = settings.get('Accounts_OAuth_Nextcloud_URL');\\n\\tif (!nextcloudURL) {\\n\\t\\tif (nextcloudURL === undefined) {\\n\\t\\t\\treturn fillServerURL();\\n\\t\\t}\\n\\t\\treturn;\\n\\t}\\n\\tconfig.serverURL = nextcloudURL.trim().replace(/\\\\/*$/, '');\\n\\treturn Nextcloud.configure(config);\\n}, 100);\\n\\nMeteor.startup(() => {\\n\\tTracker.autorun(() => {\\n\\t\\treturn fillServerURL();\\n\\t});\\n});\\n\",null],\"names\":[\"Meteor\",\"Tracker\",\"_\",\"CustomOAuth\",\"settings\",\"module\",\"link\",\"v\",\"default\",\"config\",\"serverURL\",\"tokenPath\",\"tokenSentVia\",\"authorizePath\",\"identityPath\",\"scope\",\"addAutopublishFields\",\"forLoggedInUser\",\"forOtherUsers\",\"Nextcloud\",\"fillServerURL\",\"debounce\",\"nextcloudURL\",\"get\",\"trim\",\"replace\",\"configure\",\"undefined\",\"startup\",\"autorun\"],\"mappings\":\"2BACAA,EAAuCC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAN,OAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,iBAAA,CAAAL,QAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,aAAA,CAAAE,QAAAD,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,wCAAA,CAAAH,YAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,wBAAA,CAAAF,SAAAG,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,GAOvC,IAAME,EAAsB,CAC3BC,UAAW,GACXC,UAAW,sCACXC,aAAc,SACdC,cAAe,mCACfC,aAAc,qCACdC,MAAO,SACPC,qBAAsB,CACrBC,gBAAiB,CAAC,qBAAqB,CACvCC,cAAe,CAAC,0BAAyB,GAIrCC,EAAY,IAAIhB,EAAY,YAAaM,GAEzCW,EAAgBlB,EAAEmB,QAAQ,CAAC,KAChC,IAAMC,EAAelB,EAASmB,GAAG,CAAC,uCAClC,AAAKD,GAMLb,EAAOC,SAAS,CAAGY,EAAaE,IAAI,GAAGC,OAAO,CAAC,OAAQ,IAChDN,EAAUO,SAAS,CAACjB,IAN1B,AAAIa,AAAiBK,KAAAA,IAAjBL,EACIF,IAER,KAAA,CAIF,EAAG,KAEHpB,EAAO4B,OAAO,CAAC,KACd3B,EAAQ4B,OAAO,CAAC,IACRT,IAET\"}"}