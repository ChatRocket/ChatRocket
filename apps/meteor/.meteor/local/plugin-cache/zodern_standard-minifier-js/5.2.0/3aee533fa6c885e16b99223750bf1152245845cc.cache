{"code":"function module(e,n,t){t.link(\"@babel/runtime/regenerator\",{default:function(e){i=e}},0),t.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(e){r=e}},1),t.link(\"@babel/runtime/helpers/toConsumableArray\",{default:function(e){s=e}},2),t.export({uploadFiles:function(){return y}}),t.link(\"@rocket.chat/core-typings\",{isRoomFederated:function(e){a=e}},0),t.link(\"../../../../app/e2e/client\",{e2e:function(e){o=e}},1),t.link(\"../../../../app/settings/client\",{settings:function(e){l=e}},2),t.link(\"../../../../app/utils/client\",{fileUploadIsValidContentType:function(e){u=e}},3),t.link(\"../../../../lib/utils/getFileExtension\",{getFileExtension:function(e){p=e}},4),t.link(\"../../../views/room/modals/FileUploadModal\",{default:function(e){c=e}},5),t.link(\"../../imperativeModal\",{imperativeModal:function(e){d=e}},6),t.link(\"../../utils/prependReplies\",{prependReplies:function(e){f=e}},7);var i,r,s,a,o,l,u,p,c,d,f,m=function(e){return new Promise(function(n){var t=new Image;t.onload=function(){n({height:t.height,width:t.width})},t.src=e})},y=function(e,n,t){var y,v,h,g,b,k,w,x;return i.async(function(_){for(;;)switch(_.prev=_.next){case 0:return h=null!==(y=null===(v=e.composer)||void 0===v?void 0:v.quotedMessages.get())&&void 0!==y?y:[],_.next=3,i.awrap(f(\"\",h));case 3:return g=_.sent,_.next=6,i.awrap(e.data.getRoom());case 6:b=_.sent,k=s(n),w=function(n,t,i,s){var a;e.uploads.send(n,r({msg:g},t),i,s),null===(a=e.composer)||void 0===a||a.clear(),d.close(),x()},(x=function(){var n,t,s,f=k.pop();if(!f){null===(s=e.composer)||void 0===s||s.dismissAllQuotedMessages();return}d.open({component:c,props:{file:f,fileName:f.name,fileDescription:null!==(n=null===(t=e.composer)||void 0===t?void 0:t.text)&&void 0!==n?n:\"\",showDescription:b&&!a(b),onClose:function(){d.close(),x()},onSubmit:function e(e,n){var t,s,a,u,c;return i.async(function d(d){for(;;)switch(d.prev=d.next){case 0:return Object.defineProperty(f,\"name\",{writable:!0,value:e}),d.next=3,i.awrap(o.getInstanceByRoomId(b._id));case 3:if(t=d.sent){d.next=7;break}return w(f,{description:n}),d.abrupt(\"return\");case 7:if(l.get(\"E2E_Enable_Encrypt_Files\")){d.next=10;break}return w(f,{description:n}),d.abrupt(\"return\");case 10:return d.next=12,i.awrap(t.shouldConvertSentMessages({msg:g}));case 12:if(d.sent){d.next=16;break}return w(f,{description:n}),d.abrupt(\"return\");case 16:return d.next=18,i.awrap(t.encryptFile(f));case 18:if(!(s=d.sent)){d.next=28;break}return a=function e(e,a){var o,l,u,c;return i.async(function d(d){for(;;)switch(d.prev=d.next){case 0:if(o=[],l={title:f.name,type:\"file\",description:n,title_link:a,title_link_download:!0,encryption:{key:s.key,iv:s.iv},hashes:{sha256:s.hash}},!/^image\\/.+/.test(f.type)){d.next=9;break}return d.next=5,i.awrap(m(window.URL.createObjectURL(f)));case 5:u=d.sent,o.push(r(r({},l),{},{image_url:a,image_type:f.type,image_size:f.size},u&&{image_dimensions:u})),d.next=10;break;case 9:/^audio\\/.+/.test(f.type)?o.push(r(r({},l),{},{audio_url:a,audio_type:f.type,audio_size:f.size})):/^video\\/.+/.test(f.type)?o.push(r(r({},l),{},{video_url:a,video_type:f.type,video_size:f.size})):o.push(r(r({},l),{},{size:f.size,format:p(f.name)}));case 10:return c=[{_id:e,name:f.name,type:f.type,size:f.size}],d.abrupt(\"return\",t.encryptMessageContent({attachments:o,files:c,file:c[0]}));case 12:case\"end\":return d.stop()}},null,null,null,Promise)},u={type:f.type,typeGroup:f.type.split(\"/\")[0],name:e,encryption:{key:s.key,iv:s.iv},hashes:{sha256:s.hash}},d.t0=u,d.next=25,i.awrap(t.encryptMessageContent(u));case 25:d.t1=d.sent,c={raw:d.t0,encrypted:d.t1},w(s.file,{t:\"e2e\"},a,c);case 28:case\"end\":return d.stop()}},null,null,null,Promise)},invalidContentType:!u(null==f?void 0:f.type)}})})(),null==t||t();case 12:case\"end\":return _.stop()}},null,null,null,Promise)}}","map":"{\"version\":3,\"sources\":[\"client/lib/chats/flows/uploadFiles.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IMessage, FileAttachmentProps, IE2EEMessage, IUpload } from '@rocket.chat/core-typings';\\nimport { isRoomFederated } from '@rocket.chat/core-typings';\\n\\nimport { e2e } from '../../../../app/e2e/client';\\nimport { settings } from '../../../../app/settings/client';\\nimport { fileUploadIsValidContentType } from '../../../../app/utils/client';\\nimport { getFileExtension } from '../../../../lib/utils/getFileExtension';\\nimport FileUploadModal from '../../../views/room/modals/FileUploadModal';\\nimport { imperativeModal } from '../../imperativeModal';\\nimport { prependReplies } from '../../utils/prependReplies';\\nimport type { ChatAPI } from '../ChatAPI';\\n\\nconst getHeightAndWidthFromDataUrl = (dataURL: string): Promise<{ height: number; width: number }> => {\\n\\treturn new Promise((resolve) => {\\n\\t\\tconst img = new Image();\\n\\t\\timg.onload = () => {\\n\\t\\t\\tresolve({\\n\\t\\t\\t\\theight: img.height,\\n\\t\\t\\t\\twidth: img.width,\\n\\t\\t\\t});\\n\\t\\t};\\n\\t\\timg.src = dataURL;\\n\\t});\\n};\\n\\nexport const uploadFiles = async (chat: ChatAPI, files: readonly File[], resetFileInput?: () => void): Promise<void> => {\\n\\tconst replies = chat.composer?.quotedMessages.get() ?? [];\\n\\n\\tconst msg = await prependReplies('', replies);\\n\\n\\tconst room = await chat.data.getRoom();\\n\\n\\tconst queue = [...files];\\n\\n\\tconst uploadFile = (\\n\\t\\tfile: File,\\n\\t\\textraData?: Pick<IMessage, 't' | 'e2e'> & { description?: string },\\n\\t\\tgetContent?: (fileId: string, fileUrl: string) => Promise<IE2EEMessage['content']>,\\n\\t\\tfileContent?: { raw: Partial<IUpload>; encrypted: IE2EEMessage['content'] },\\n\\t) => {\\n\\t\\tchat.uploads.send(\\n\\t\\t\\tfile,\\n\\t\\t\\t{\\n\\t\\t\\t\\tmsg,\\n\\t\\t\\t\\t...extraData,\\n\\t\\t\\t},\\n\\t\\t\\tgetContent,\\n\\t\\t\\tfileContent,\\n\\t\\t);\\n\\t\\tchat.composer?.clear();\\n\\t\\timperativeModal.close();\\n\\t\\tuploadNextFile();\\n\\t};\\n\\n\\tconst uploadNextFile = (): void => {\\n\\t\\tconst file = queue.pop();\\n\\t\\tif (!file) {\\n\\t\\t\\tchat.composer?.dismissAllQuotedMessages();\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\timperativeModal.open({\\n\\t\\t\\tcomponent: FileUploadModal,\\n\\t\\t\\tprops: {\\n\\t\\t\\t\\tfile,\\n\\t\\t\\t\\tfileName: file.name,\\n\\t\\t\\t\\tfileDescription: chat.composer?.text ?? '',\\n\\t\\t\\t\\tshowDescription: room && !isRoomFederated(room),\\n\\t\\t\\t\\tonClose: (): void => {\\n\\t\\t\\t\\t\\timperativeModal.close();\\n\\t\\t\\t\\t\\tuploadNextFile();\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\tonSubmit: async (fileName: string, description?: string): Promise<void> => {\\n\\t\\t\\t\\t\\tObject.defineProperty(file, 'name', {\\n\\t\\t\\t\\t\\t\\twritable: true,\\n\\t\\t\\t\\t\\t\\tvalue: fileName,\\n\\t\\t\\t\\t\\t});\\n\\n\\t\\t\\t\\t\\t// encrypt attachment description\\n\\t\\t\\t\\t\\tconst e2eRoom = await e2e.getInstanceByRoomId(room._id);\\n\\n\\t\\t\\t\\t\\tif (!e2eRoom) {\\n\\t\\t\\t\\t\\t\\tuploadFile(file, { description });\\n\\t\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\tif (!settings.get('E2E_Enable_Encrypt_Files')) {\\n\\t\\t\\t\\t\\t\\tuploadFile(file, { description });\\n\\t\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\tconst shouldConvertSentMessages = await e2eRoom.shouldConvertSentMessages({ msg });\\n\\n\\t\\t\\t\\t\\tif (!shouldConvertSentMessages) {\\n\\t\\t\\t\\t\\t\\tuploadFile(file, { description });\\n\\t\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\tconst encryptedFile = await e2eRoom.encryptFile(file);\\n\\n\\t\\t\\t\\t\\tif (encryptedFile) {\\n\\t\\t\\t\\t\\t\\tconst getContent = async (_id: string, fileUrl: string): Promise<IE2EEMessage['content']> => {\\n\\t\\t\\t\\t\\t\\t\\tconst attachments = [];\\n\\n\\t\\t\\t\\t\\t\\t\\tconst attachment: FileAttachmentProps = {\\n\\t\\t\\t\\t\\t\\t\\t\\ttitle: file.name,\\n\\t\\t\\t\\t\\t\\t\\t\\ttype: 'file',\\n\\t\\t\\t\\t\\t\\t\\t\\tdescription,\\n\\t\\t\\t\\t\\t\\t\\t\\ttitle_link: fileUrl,\\n\\t\\t\\t\\t\\t\\t\\t\\ttitle_link_download: true,\\n\\t\\t\\t\\t\\t\\t\\t\\tencryption: {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tkey: encryptedFile.key,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tiv: encryptedFile.iv,\\n\\t\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t\\t\\thashes: {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tsha256: encryptedFile.hash,\\n\\t\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t\\t};\\n\\n\\t\\t\\t\\t\\t\\t\\tif (/^image\\\\/.+/.test(file.type)) {\\n\\t\\t\\t\\t\\t\\t\\t\\tconst dimensions = await getHeightAndWidthFromDataUrl(window.URL.createObjectURL(file));\\n\\n\\t\\t\\t\\t\\t\\t\\t\\tattachments.push({\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t...attachment,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\timage_url: fileUrl,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\timage_type: file.type,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\timage_size: file.size,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t...(dimensions && {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\timage_dimensions: dimensions,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t}),\\n\\t\\t\\t\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t\\t\\t\\t} else if (/^audio\\\\/.+/.test(file.type)) {\\n\\t\\t\\t\\t\\t\\t\\t\\tattachments.push({\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t...attachment,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\taudio_url: fileUrl,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\taudio_type: file.type,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\taudio_size: file.size,\\n\\t\\t\\t\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t\\t\\t\\t} else if (/^video\\\\/.+/.test(file.type)) {\\n\\t\\t\\t\\t\\t\\t\\t\\tattachments.push({\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t...attachment,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tvideo_url: fileUrl,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tvideo_type: file.type,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tvideo_size: file.size,\\n\\t\\t\\t\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\t\\t\\tattachments.push({\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t...attachment,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tsize: file.size,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tformat: getFileExtension(file.name),\\n\\t\\t\\t\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\t\\t\\tconst files = [\\n\\t\\t\\t\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t_id,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tname: file.name,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\ttype: file.type,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tsize: file.size,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t// \\\"format\\\": \\\"png\\\"\\n\\t\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t\\t];\\n\\n\\t\\t\\t\\t\\t\\t\\treturn e2eRoom.encryptMessageContent({\\n\\t\\t\\t\\t\\t\\t\\t\\tattachments,\\n\\t\\t\\t\\t\\t\\t\\t\\tfiles,\\n\\t\\t\\t\\t\\t\\t\\t\\tfile: files[0],\\n\\t\\t\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t\\t\\t};\\n\\n\\t\\t\\t\\t\\t\\tconst fileContentData = {\\n\\t\\t\\t\\t\\t\\t\\ttype: file.type,\\n\\t\\t\\t\\t\\t\\t\\ttypeGroup: file.type.split('/')[0],\\n\\t\\t\\t\\t\\t\\t\\tname: fileName,\\n\\t\\t\\t\\t\\t\\t\\tencryption: {\\n\\t\\t\\t\\t\\t\\t\\t\\tkey: encryptedFile.key,\\n\\t\\t\\t\\t\\t\\t\\t\\tiv: encryptedFile.iv,\\n\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t\\thashes: {\\n\\t\\t\\t\\t\\t\\t\\t\\tsha256: encryptedFile.hash,\\n\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t};\\n\\n\\t\\t\\t\\t\\t\\tconst fileContent = {\\n\\t\\t\\t\\t\\t\\t\\traw: fileContentData,\\n\\t\\t\\t\\t\\t\\t\\tencrypted: await e2eRoom.encryptMessageContent(fileContentData),\\n\\t\\t\\t\\t\\t\\t};\\n\\n\\t\\t\\t\\t\\t\\tuploadFile(\\n\\t\\t\\t\\t\\t\\t\\tencryptedFile.file,\\n\\t\\t\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\t\\t\\tt: 'e2e',\\n\\t\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\t\\tgetContent,\\n\\t\\t\\t\\t\\t\\t\\tfileContent,\\n\\t\\t\\t\\t\\t\\t);\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\tinvalidContentType: !fileUploadIsValidContentType(file?.type),\\n\\t\\t\\t},\\n\\t\\t});\\n\\t};\\n\\n\\tuploadNextFile();\\n\\tresetFileInput?.();\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"_objectSpread\",\"_toConsumableArray\",\"export\",\"uploadFiles\",\"isRoomFederated\",\"e2e\",\"settings\",\"fileUploadIsValidContentType\",\"getFileExtension\",\"FileUploadModal\",\"imperativeModal\",\"prependReplies\",\"getHeightAndWidthFromDataUrl\",\"dataURL\",\"Promise\",\"resolve\",\"img\",\"Image\",\"onload\",\"height\",\"width\",\"src\",\"chat\",\"files\",\"resetFileInput\",\"_chat$composer$quoted\",\"_chat$composer\",\"replies\",\"msg\",\"room\",\"queue\",\"uploadFile\",\"uploadNextFile\",\"async\",\"_context3\",\"prev\",\"next\",\"composer\",\"quotedMessages\",\"get\",\"awrap\",\"sent\",\"data\",\"getRoom\",\"file\",\"extraData\",\"getContent\",\"fileContent\",\"_chat$composer2\",\"uploads\",\"send\",\"clear\",\"close\",\"_chat$composer$text\",\"_chat$composer4\",\"_chat$composer3\",\"pop\",\"dismissAllQuotedMessages\",\"open\",\"component\",\"props\",\"fileName\",\"name\",\"fileDescription\",\"text\",\"showDescription\",\"onClose\",\"onSubmit\",\"_callee2\",\"description\",\"e2eRoom\",\"encryptedFile\",\"fileContentData\",\"_callee2$\",\"_context2\",\"Object\",\"defineProperty\",\"writable\",\"value\",\"getInstanceByRoomId\",\"_id\",\"abrupt\",\"shouldConvertSentMessages\",\"encryptFile\",\"_callee\",\"fileUrl\",\"attachments\",\"attachment\",\"dimensions\",\"_callee$\",\"_context\",\"title\",\"type\",\"title_link\",\"title_link_download\",\"encryption\",\"key\",\"iv\",\"hashes\",\"sha256\",\"hash\",\"test\",\"window\",\"URL\",\"createObjectURL\",\"push\",\"image_url\",\"image_type\",\"image_size\",\"size\",\"image_dimensions\",\"audio_url\",\"audio_type\",\"audio_size\",\"video_url\",\"video_type\",\"video_size\",\"format\",\"encryptMessageContent\",\"stop\",\"typeGroup\",\"split\",\"t0\",\"t1\",\"raw\",\"encrypted\",\"t\",\"invalidContentType\"],\"mappings\":\"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\"}"}