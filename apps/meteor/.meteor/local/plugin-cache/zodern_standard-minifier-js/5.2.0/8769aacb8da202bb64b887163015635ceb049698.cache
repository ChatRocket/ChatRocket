{"code":"function module(e,n,t){t.link(\"@babel/runtime/regenerator\",{default:function(e){r=e}},0),t.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){a=e}},1),t.export({useMediaPermissions:function(){return o}}),t.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback:function(e){i=e}},0),t.link(\"react\",{useEffect:function(e){u=e},useState:function(e){c=e}},1);var r,a,i,u,c,s=function(e){switch(e){case\"camera\":return\"videoinput\";case\"microphone\":return\"audioinput\"}},o=function(e){var n=c(!1),t=a(n,2),o=t[0],f=t[1],l=i(function(){var n,t;return r.async(function(a){for(;;)switch(a.prev=a.next){case 0:if(!navigator.permissions){a.next=13;break}return a.prev=1,a.next=4,r.awrap(navigator.permissions.query({name:e}));case 4:return f(\"denied\"===(t=a.sent).state),t.onchange=function(){f(\"denied\"===t.state)},a.abrupt(\"return\");case 10:a.prev=10,a.t0=a.catch(1),console.warn(a.t0);case 13:if(null!==(n=navigator.mediaDevices)&&void 0!==n&&n.enumerateDevices){a.next=16;break}return f(!0),a.abrupt(\"return\");case 16:return a.prev=16,a.next=19,r.awrap(navigator.mediaDevices.enumerateDevices());case 19:if(a.sent.some(function(n){return n.kind===s(e)})){a.next=21;break}f(!0);case 21:a.next=26;break;case 23:a.prev=23,a.t1=a.catch(16),console.warn(a.t1);case 26:case\"end\":return a.stop()}},null,null,[[1,10],[16,23]],Promise)});return u(function(){l()},[l]),[o,f]}}","map":"{\"version\":3,\"sources\":[\"client/views/room/composer/messageBox/hooks/useMediaPermissions.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useEffect, useState } from 'react';\\n\\ntype MediaDevices = 'camera' | 'microphone';\\n\\nconst getDeviceKind = (name: MediaDevices): MediaDeviceKind => {\\n\\tswitch (name) {\\n\\t\\tcase 'camera':\\n\\t\\t\\treturn 'videoinput';\\n\\t\\tcase 'microphone':\\n\\t\\t\\treturn 'audioinput';\\n\\t}\\n};\\n\\nexport const useMediaPermissions = (name: MediaDevices): [isPermissionDenied: boolean, setIsPermissionDenied: (state: boolean) => void] => {\\n\\tconst [isPermissionDenied, setIsPermissionDenied] = useState(false);\\n\\n\\tconst handleMount = useMutableCallback(async (): Promise<void> => {\\n\\t\\tif (navigator.permissions) {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tconst permissionStatus = await navigator.permissions.query({ name: name as PermissionName });\\n\\t\\t\\t\\tsetIsPermissionDenied(permissionStatus.state === 'denied');\\n\\t\\t\\t\\tpermissionStatus.onchange = (): void => {\\n\\t\\t\\t\\t\\tsetIsPermissionDenied(permissionStatus.state === 'denied');\\n\\t\\t\\t\\t};\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tconsole.warn(error);\\n\\t\\t\\t}\\n\\t\\t}\\n\\n\\t\\tif (!navigator.mediaDevices?.enumerateDevices) {\\n\\t\\t\\tsetIsPermissionDenied(true);\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\ttry {\\n\\t\\t\\tif (!(await navigator.mediaDevices.enumerateDevices()).some(({ kind }) => kind === getDeviceKind(name))) {\\n\\t\\t\\t\\tsetIsPermissionDenied(true);\\n\\t\\t\\t}\\n\\t\\t} catch (error) {\\n\\t\\t\\tconsole.warn(error);\\n\\t\\t}\\n\\t});\\n\\n\\tuseEffect(() => {\\n\\t\\thandleMount();\\n\\t}, [handleMount]);\\n\\n\\treturn [isPermissionDenied, setIsPermissionDenied];\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"_slicedToArray\",\"export\",\"useMediaPermissions\",\"useMutableCallback\",\"useEffect\",\"useState\",\"getDeviceKind\",\"name\",\"_useState\",\"_useState2\",\"isPermissionDenied\",\"setIsPermissionDenied\",\"handleMount\",\"_navigator$mediaDevic\",\"permissionStatus\",\"async\",\"_context\",\"prev\",\"next\",\"navigator\",\"permissions\",\"awrap\",\"query\",\"sent\",\"state\",\"onchange\",\"abrupt\",\"t0\",\"console\",\"warn\",\"mediaDevices\",\"enumerateDevices\",\"some\",\"_ref\",\"kind\",\"t1\",\"stop\",\"Promise\"],\"mappings\":\"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\"}"}