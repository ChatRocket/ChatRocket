{"code":"function module(e,t,s){let a,n,l,u,i,r,o,c,d,m,k,S,y,b,p;s.export({useStatusItems:()=>f}),s.link(\"@rocket.chat/fuselage\",{Box(e){a=e}},0),s.link(\"@rocket.chat/ui-contexts\",{useEndpoint(e){n=e},useSetting(e){l=e}},1),s.link(\"@tanstack/react-query\",{useMutation(e){u=e},useQuery(e){i=e},useQueryClient(e){r=e}},2),s.link(\"react\",{default(e){o=e},useEffect(e){c=e}},3),s.link(\"react-i18next\",{useTranslation(e){d=e}},4),s.link(\"../../../../lib/callbacks\",{callbacks(e){m=e}},5),s.link(\"../../../components/MarkdownText\",{default(e){k=e}},6),s.link(\"../../../components/UserStatus\",{UserStatus(e){S=e}},7),s.link(\"../../../lib/userStatuses\",{userStatuses(e){y=e}},8),s.link(\"../../../views/admin/customUserStatus/hooks/useStatusDisabledModal\",{useStatusDisabledModal(e){b=e}},9),s.link(\"./useCustomStatusModalHandler\",{useCustomStatusModalHandler(e){p=e}},10);let f=()=>{y.invisibleAllowed=l(\"Accounts_AllowInvisibleStatusOption\",!0);let e=r();c(()=>y.watch(()=>{e.setQueryData([\"user-statuses\"],Array.from(y))}),[e]);let{t}=d(),s=n(\"POST\",\"/v1/users.setStatus\"),f=u({mutationFn:async e=>{s({status:e.statusType,message:y.isValidType(e.id)?\"\":e.name}),m.run(\"userStatusManuallySet\",e)}}),w=l(\"Presence_broadcast_disabled\",!1),{data:E}=i({queryKey:[\"user-statuses\"],queryFn:async()=>(await y.sync(),Array.from(y)),staleTime:1/0,select:e=>e.map(e=>{let s=e.localizeName?t(e.name):e.name;return{id:e.id,status:o.createElement(S,{status:e.statusType}),content:o.createElement(k,{content:s,parseEmoji:!0,variant:\"inline\"}),disabled:w,onClick:()=>f.mutate(e)}})}),C=b(),M=p();return[...w?[{id:\"presence-disabled\",content:o.createElement(a,{fontScale:\"p2\"},o.createElement(a,{mbe:4,wordBreak:\"break-word\",style:{whiteSpace:\"normal\"}},t(\"User_status_disabled\")),o.createElement(a,{is:\"a\",color:\"info\",onClick:C},t(\"Learn_more\")))}]:[],...null!=E?E:[],{id:\"custom-status\",icon:\"emoji\",content:t(\"Custom_Status\"),onClick:M,disabled:w}]}}","map":"{\"version\":3,\"sources\":[\"client/sidebar/header/hooks/useStatusItems.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Box } from '@rocket.chat/fuselage';\\nimport type { GenericMenuItemProps } from '@rocket.chat/ui-client';\\nimport { useEndpoint, useSetting } from '@rocket.chat/ui-contexts';\\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\\nimport React, { useEffect } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { callbacks } from '../../../../lib/callbacks';\\nimport MarkdownText from '../../../components/MarkdownText';\\nimport { UserStatus } from '../../../components/UserStatus';\\nimport { userStatuses } from '../../../lib/userStatuses';\\nimport type { UserStatusDescriptor } from '../../../lib/userStatuses';\\nimport { useStatusDisabledModal } from '../../../views/admin/customUserStatus/hooks/useStatusDisabledModal';\\nimport { useCustomStatusModalHandler } from './useCustomStatusModalHandler';\\n\\nexport const useStatusItems = (): GenericMenuItemProps[] => {\\n\\t// We should lift this up to somewhere else if we want to use it in other places\\n\\n\\tuserStatuses.invisibleAllowed = useSetting('Accounts_AllowInvisibleStatusOption', true);\\n\\n\\tconst queryClient = useQueryClient();\\n\\n\\tuseEffect(\\n\\t\\t() =>\\n\\t\\t\\tuserStatuses.watch(() => {\\n\\t\\t\\t\\tqueryClient.setQueryData(['user-statuses'], Array.from(userStatuses));\\n\\t\\t\\t}),\\n\\t\\t[queryClient],\\n\\t);\\n\\n\\tconst { t } = useTranslation();\\n\\n\\tconst setStatus = useEndpoint('POST', '/v1/users.setStatus');\\n\\tconst setStatusMutation = useMutation({\\n\\t\\tmutationFn: async (status: UserStatusDescriptor) => {\\n\\t\\t\\tvoid setStatus({ status: status.statusType, message: userStatuses.isValidType(status.id) ? '' : status.name });\\n\\t\\t\\tvoid callbacks.run('userStatusManuallySet', status);\\n\\t\\t},\\n\\t});\\n\\n\\tconst presenceDisabled = useSetting('Presence_broadcast_disabled', false);\\n\\n\\tconst { data: statuses } = useQuery({\\n\\t\\tqueryKey: ['user-statuses'],\\n\\t\\tqueryFn: async () => {\\n\\t\\t\\tawait userStatuses.sync();\\n\\t\\t\\treturn Array.from(userStatuses);\\n\\t\\t},\\n\\t\\tstaleTime: Infinity,\\n\\t\\tselect: (statuses) =>\\n\\t\\t\\tstatuses.map((status): GenericMenuItemProps => {\\n\\t\\t\\t\\tconst content = status.localizeName ? t(status.name) : status.name;\\n\\t\\t\\t\\treturn {\\n\\t\\t\\t\\t\\tid: status.id,\\n\\t\\t\\t\\t\\tstatus: <UserStatus status={status.statusType} />,\\n\\t\\t\\t\\t\\tcontent: <MarkdownText content={content} parseEmoji={true} variant='inline' />,\\n\\t\\t\\t\\t\\tdisabled: presenceDisabled,\\n\\t\\t\\t\\t\\tonClick: () => setStatusMutation.mutate(status),\\n\\t\\t\\t\\t};\\n\\t\\t\\t}),\\n\\t});\\n\\n\\tconst handleStatusDisabledModal = useStatusDisabledModal();\\n\\tconst handleCustomStatus = useCustomStatusModalHandler();\\n\\n\\treturn [\\n\\t\\t...(presenceDisabled\\n\\t\\t\\t? [\\n\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\tid: 'presence-disabled',\\n\\t\\t\\t\\t\\t\\tcontent: (\\n\\t\\t\\t\\t\\t\\t\\t<Box fontScale='p2'>\\n\\t\\t\\t\\t\\t\\t\\t\\t<Box mbe={4} wordBreak='break-word' style={{ whiteSpace: 'normal' }}>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t{t('User_status_disabled')}\\n\\t\\t\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t\\t\\t\\t<Box is='a' color='info' onClick={handleStatusDisabledModal}>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t{t('Learn_more')}\\n\\t\\t\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t\\t),\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t  ]\\n\\t\\t\\t: []),\\n\\t\\t...(statuses ?? []),\\n\\t\\t{ id: 'custom-status', icon: 'emoji', content: t('Custom_Status'), onClick: handleCustomStatus, disabled: presenceDisabled },\\n\\t];\\n};\\n\",null],\"names\":[\"Box\",\"useEndpoint\",\"useSetting\",\"useMutation\",\"useQuery\",\"useQueryClient\",\"React\",\"useEffect\",\"useTranslation\",\"callbacks\",\"MarkdownText\",\"UserStatus\",\"userStatuses\",\"useStatusDisabledModal\",\"useCustomStatusModalHandler\",\"module\",\"export\",\"useStatusItems\",\"link\",\"v\",\"default\",\"invisibleAllowed\",\"queryClient\",\"watch\",\"setQueryData\",\"Array\",\"from\",\"t\",\"setStatus\",\"setStatusMutation\",\"mutationFn\",\"status\",\"statusType\",\"message\",\"isValidType\",\"id\",\"name\",\"run\",\"presenceDisabled\",\"data\",\"statuses\",\"queryKey\",\"queryFn\",\"sync\",\"staleTime\",\"Infinity\",\"select\",\"map\",\"content\",\"localizeName\",\"createElement\",\"parseEmoji\",\"variant\",\"disabled\",\"onClick\",\"mutate\",\"handleStatusDisabledModal\",\"handleCustomStatus\",\"fontScale\",\"mbe\",\"wordBreak\",\"style\",\"whiteSpace\",\"is\",\"color\",\"icon\"],\"mappings\":\"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\"}"}