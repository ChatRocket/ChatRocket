{"code":"function module(e,t,n){var i,r,s,o,a,l,u,c,d,m;n.link(\"@babel/runtime/regenerator\",{default:function(e){i=e}},0),n.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(e){r=e}},1),n.link(\"meteor/meteor\",{Meteor:function(e){s=e}},0),n.link(\"../../../app/settings/client\",{settings:function(e){o=e}},1),n.link(\"../../../app/ui-utils/client\",{MessageAction:function(e){a=e}},2),n.link(\"../../../app/utils/client/lib/SDKClient\",{sdk:function(e){l=e}},3),n.link(\"../../lib/queryClient\",{queryClient:function(e){u=e}},4),n.link(\"../../lib/rooms/roomCoordinator\",{roomCoordinator:function(e){c=e}},5),n.link(\"../../lib/toast\",{dispatchToastMessage:function(e){d=e}},6),n.link(\"../../lib/utils/messageArgs\",{messageArgs:function(e){m=e}},7),s.startup(function(){a.addButton({id:\"star-message\",icon:\"star\",label:\"Star\",type:\"interaction\",context:[\"starred\",\"message\",\"message-mobile\",\"threads\",\"federated\",\"videoconf\",\"videoconf-threads\"],action:function(e,t){var n,s;return i.async(function(e){for(;;)switch(e.prev=e.next){case 0:return s=void 0===(n=t.message)?m(this).msg:n,e.prev=1,e.next=4,i.awrap(l.call(\"starMessage\",r(r({},s),{},{starred:!0})));case 4:u.invalidateQueries([\"rooms\",s.rid,\"starred-messages\"]),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),e.t0&&d({type:\"error\",message:e.t0});case 10:case\"end\":return e.stop()}},null,this,[[1,7]],Promise)},condition:function(e){var t=e.message,n=e.subscription,i=e.user,r=e.room;return!(null==n&&o.get(\"Message_AllowStarring\"))&&!c.isLivechatRoom(r.t)&&(!Array.isArray(t.starred)||!t.starred.find(function(e){return e._id===(null==i?void 0:i._id)}))},order:3,group:\"menu\"})})}","map":"{\"version\":3,\"sources\":[\"client/startup/actionButtons/starMessage.ts\",\"<anon>\"],\"sourcesContent\":[\"import { Meteor } from 'meteor/meteor';\\n\\nimport { settings } from '../../../app/settings/client';\\nimport { MessageAction } from '../../../app/ui-utils/client';\\nimport { sdk } from '../../../app/utils/client/lib/SDKClient';\\nimport { queryClient } from '../../lib/queryClient';\\nimport { roomCoordinator } from '../../lib/rooms/roomCoordinator';\\nimport { dispatchToastMessage } from '../../lib/toast';\\nimport { messageArgs } from '../../lib/utils/messageArgs';\\n\\nMeteor.startup(() => {\\n\\tMessageAction.addButton({\\n\\t\\tid: 'star-message',\\n\\t\\ticon: 'star',\\n\\t\\tlabel: 'Star',\\n\\t\\ttype: 'interaction',\\n\\t\\tcontext: ['starred', 'message', 'message-mobile', 'threads', 'federated', 'videoconf', 'videoconf-threads'],\\n\\t\\tasync action(_, props) {\\n\\t\\t\\tconst { message = messageArgs(this).msg } = props;\\n\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tawait sdk.call('starMessage', { ...message, starred: true });\\n\\t\\t\\t\\tqueryClient.invalidateQueries(['rooms', message.rid, 'starred-messages']);\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tif (error) {\\n\\t\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\tcondition({ message, subscription, user, room }) {\\n\\t\\t\\tif (subscription == null && settings.get('Message_AllowStarring')) {\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t}\\n\\t\\t\\tconst isLivechatRoom = roomCoordinator.isLivechatRoom(room.t);\\n\\t\\t\\tif (isLivechatRoom) {\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn !Array.isArray(message.starred) || !message.starred.find((star: any) => star._id === user?._id);\\n\\t\\t},\\n\\t\\torder: 3,\\n\\t\\tgroup: 'menu',\\n\\t});\\n});\\n\",null],\"names\":[\"_regeneratorRuntime\",\"_objectSpread\",\"Meteor\",\"settings\",\"MessageAction\",\"sdk\",\"queryClient\",\"roomCoordinator\",\"dispatchToastMessage\",\"messageArgs\",\"module\",\"link\",\"default\",\"v\",\"startup\",\"addButton\",\"id\",\"icon\",\"label\",\"type\",\"context\",\"action\",\"_\",\"props\",\"_props$message\",\"message\",\"async\",\"_context\",\"prev\",\"next\",\"msg\",\"awrap\",\"call\",\"starred\",\"invalidateQueries\",\"rid\",\"t0\",\"stop\",\"Promise\",\"condition\",\"_ref\",\"subscription\",\"user\",\"room\",\"get\",\"isLivechatRoom\",\"t\",\"Array\",\"isArray\",\"find\",\"star\",\"_id\",\"order\",\"group\"],\"mappings\":\"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\"}"}