{"code":"function module(e,t,n){var r,a,u,c,i,o,s,l,f,d;n.link(\"@babel/runtime/regenerator\",{default:function(e){r=e}},0),n.link(\"@rocket.chat/onboarding-ui\",{AwaitingConfirmationPage:function(e){a=e}},0),n.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch:function(e){u=e},useSettingSetValue:function(e){c=e},useEndpoint:function(e){i=e}},1),n.link(\"react\",{default:function(e){o=e},useEffect:function(e){s=e},useCallback:function(e){l=e}},2),n.link(\"react-i18next\",{useTranslation:function(e){f=e}},3),n.link(\"../contexts/SetupWizardContext\",{useSetupWizardContext:function(e){d=e}},4),n.exportDefault(function(){var e=d(),t=e.registerServer,n=e.currentStep,p=e.maxSteps,v=e.goToStep,m=e.setupWizardData.registrationData,k=e.saveWorkspaceData,x=c(\"Show_Setup_Wizard\"),g=i(\"GET\",\"/v1/cloud.confirmationPoll\"),S=u(),_=f().t,b=l(function(){var e;return r.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!m.device_code){t.next=11;break}return t.next=4,r.awrap(g({deviceCode:m.device_code}));case 4:if(!(\"successful\"in(e=t.sent.pollData)&&e.successful)){t.next=11;break}return t.next=9,r.awrap(k());case 9:return S({type:\"success\",message:_(\"Your_workspace_is_ready\")}),t.abrupt(\"return\",x(\"completed\"));case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),S({type:\"error\",message:t.t0});case 16:case\"end\":return t.stop()}},null,null,[[0,13]],Promise)},[g,m.device_code,x,k,S,_]);return s(function(){var e,t=setInterval(function(){return b()},(e=m.interval)?1e3*e:0);return function(){return clearInterval(t)}},[b,m.interval]),o.createElement(a,{currentStep:n,stepCount:p,emailAddress:m.cloudEmail,securityCode:m.user_code,onResendEmailRequest:function(){return t({email:m.cloudEmail,resend:!0})},onChangeEmailRequest:function(){return v(3)}})})}","map":"{\"version\":3,\"sources\":[\"client/views/setupWizard/steps/CloudAccountConfirmation.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { AwaitingConfirmationPage } from '@rocket.chat/onboarding-ui';\\nimport { useToastMessageDispatch, useSettingSetValue, useEndpoint } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement } from 'react';\\nimport React, { useEffect, useCallback } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { useSetupWizardContext } from '../contexts/SetupWizardContext';\\n\\nconst setIntervalTime = (interval?: number): number => (interval ? interval * 1000 : 0);\\n\\nconst CloudAccountConfirmation = (): ReactElement => {\\n\\tconst {\\n\\t\\tregisterServer,\\n\\t\\tcurrentStep,\\n\\t\\tmaxSteps,\\n\\t\\tgoToStep,\\n\\t\\tsetupWizardData: { registrationData },\\n\\t\\tsaveWorkspaceData,\\n\\t} = useSetupWizardContext();\\n\\tconst setShowSetupWizard = useSettingSetValue('Show_Setup_Wizard');\\n\\tconst cloudConfirmationPoll = useEndpoint('GET', '/v1/cloud.confirmationPoll');\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst { t } = useTranslation();\\n\\n\\tconst getConfirmation = useCallback(async () => {\\n\\t\\ttry {\\n\\t\\t\\tif (registrationData.device_code) {\\n\\t\\t\\t\\tconst { pollData } = await cloudConfirmationPoll({\\n\\t\\t\\t\\t\\tdeviceCode: registrationData.device_code,\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\t\\tif ('successful' in pollData && pollData.successful) {\\n\\t\\t\\t\\t\\tawait saveWorkspaceData();\\n\\t\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Your_workspace_is_ready') });\\n\\t\\t\\t\\t\\treturn setShowSetupWizard('completed');\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t} catch (error: unknown) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t}\\n\\t}, [cloudConfirmationPoll, registrationData.device_code, setShowSetupWizard, saveWorkspaceData, dispatchToastMessage, t]);\\n\\n\\tuseEffect(() => {\\n\\t\\tconst pollInterval = setInterval(() => getConfirmation(), setIntervalTime(registrationData.interval));\\n\\n\\t\\treturn (): void => clearInterval(pollInterval);\\n\\t}, [getConfirmation, registrationData.interval]);\\n\\n\\treturn (\\n\\t\\t<AwaitingConfirmationPage\\n\\t\\t\\tcurrentStep={currentStep}\\n\\t\\t\\tstepCount={maxSteps}\\n\\t\\t\\temailAddress={registrationData.cloudEmail}\\n\\t\\t\\tsecurityCode={registrationData.user_code}\\n\\t\\t\\tonResendEmailRequest={(): Promise<void> => registerServer({ email: registrationData.cloudEmail, resend: true })}\\n\\t\\t\\tonChangeEmailRequest={(): void => goToStep(3)}\\n\\t\\t/>\\n\\t);\\n};\\n\\nexport default CloudAccountConfirmation;\\n\",null],\"names\":[\"_regeneratorRuntime\",\"AwaitingConfirmationPage\",\"useToastMessageDispatch\",\"useSettingSetValue\",\"useEndpoint\",\"React\",\"useEffect\",\"useCallback\",\"useTranslation\",\"useSetupWizardContext\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_useSetupWizardContex\",\"registerServer\",\"currentStep\",\"maxSteps\",\"goToStep\",\"registrationData\",\"setupWizardData\",\"saveWorkspaceData\",\"setShowSetupWizard\",\"cloudConfirmationPoll\",\"dispatchToastMessage\",\"t\",\"_useTranslation\",\"getConfirmation\",\"pollData\",\"async\",\"_context\",\"prev\",\"next\",\"device_code\",\"awrap\",\"deviceCode\",\"_await$cloudConfirmat\",\"sent\",\"successful\",\"type\",\"message\",\"abrupt\",\"t0\",\"stop\",\"Promise\",\"interval\",\"pollInterval\",\"setInterval\",\"clearInterval\",\"createElement\",\"stepCount\",\"emailAddress\",\"cloudEmail\",\"securityCode\",\"user_code\",\"onResendEmailRequest\",\"email\",\"resend\",\"onChangeEmailRequest\"],\"mappings\":\"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\"}"}