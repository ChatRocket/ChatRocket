{"code":"function module(e,t,n){n.link(\"meteor/meteor\",{Meteor:function(e){o=e}},0),n.link(\"meteor/tracker\",{Tracker:function(e){u=e}},1),n.link(\"underscore\",{default:function(e){r=e}},2),n.link(\"../../custom-oauth/client/CustomOAuth\",{CustomOAuth:function(e){i=e}},3),n.link(\"../../settings/client\",{settings:function(e){c=e}},4);var o,u,r,i,c,s={serverURL:\"\",tokenPath:\"/index.php/apps/oauth2/api/v1/token\",tokenSentVia:\"header\",authorizePath:\"/index.php/apps/oauth2/authorize\",identityPath:\"/ocs/v2.php/cloud/user?format=json\",scope:\"openid\",addAutopublishFields:{forLoggedInUser:[\"services.nextcloud\"],forOtherUsers:[\"services.nextcloud.name\"]}},a=new i(\"nextcloud\",s),d=r.debounce(function(){var e=c.get(\"Accounts_OAuth_Nextcloud_URL\");return e?(s.serverURL=e.trim().replace(/\\/*$/,\"\"),a.configure(s)):void 0===e?d():void 0},100);o.startup(function(){u.autorun(function(){return d()})})}","map":"{\"version\":3,\"sources\":[\"app/nextcloud/client/lib.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { OauthConfig } from '@rocket.chat/core-typings';\\nimport { Meteor } from 'meteor/meteor';\\nimport { Tracker } from 'meteor/tracker';\\nimport _ from 'underscore';\\n\\nimport { CustomOAuth } from '../../custom-oauth/client/CustomOAuth';\\nimport { settings } from '../../settings/client';\\n\\nconst config: OauthConfig = {\\n\\tserverURL: '',\\n\\ttokenPath: '/index.php/apps/oauth2/api/v1/token',\\n\\ttokenSentVia: 'header',\\n\\tauthorizePath: '/index.php/apps/oauth2/authorize',\\n\\tidentityPath: '/ocs/v2.php/cloud/user?format=json',\\n\\tscope: 'openid',\\n\\taddAutopublishFields: {\\n\\t\\tforLoggedInUser: ['services.nextcloud'],\\n\\t\\tforOtherUsers: ['services.nextcloud.name'],\\n\\t},\\n};\\n\\nconst Nextcloud = new CustomOAuth('nextcloud', config);\\n\\nconst fillServerURL = _.debounce((): void => {\\n\\tconst nextcloudURL = settings.get('Accounts_OAuth_Nextcloud_URL');\\n\\tif (!nextcloudURL) {\\n\\t\\tif (nextcloudURL === undefined) {\\n\\t\\t\\treturn fillServerURL();\\n\\t\\t}\\n\\t\\treturn;\\n\\t}\\n\\tconfig.serverURL = nextcloudURL.trim().replace(/\\\\/*$/, '');\\n\\treturn Nextcloud.configure(config);\\n}, 100);\\n\\nMeteor.startup(() => {\\n\\tTracker.autorun(() => {\\n\\t\\treturn fillServerURL();\\n\\t});\\n});\\n\",null],\"names\":[\"module\",\"link\",\"Meteor\",\"v\",\"Tracker\",\"_\",\"CustomOAuth\",\"settings\",\"config\",\"serverURL\",\"tokenPath\",\"tokenSentVia\",\"authorizePath\",\"identityPath\",\"scope\",\"addAutopublishFields\",\"forLoggedInUser\",\"forOtherUsers\",\"Nextcloud\",\"fillServerURL\",\"debounce\",\"nextcloudURL\",\"get\",\"trim\",\"replace\",\"configure\",\"undefined\",\"startup\",\"autorun\"],\"mappings\":\"uBACSA,EAAQC,IAAA,CAAM,gBAAgB,CAAAC,OAAA,SAAAC,CAAA,EAAAD,EAAAC,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,iBAAA,CAAAG,QAAA,SAAAD,CAAA,EAAAC,EAAAD,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,aAAA,CAAA,QAAA,SAAAE,CAAA,EAAAE,EAAAF,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,wCAAA,CAAAK,YAAA,SAAAH,CAAA,EAAAG,EAAAH,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,wBAAA,CAAAM,SAAA,SAAAJ,CAAA,EAAAI,EAAAJ,CAAA,CAAA,EAAA,GAOvC,IAPAD,EAAuCE,EAAAC,EAAAC,EAAAC,EAOjCC,EAAsB,CAC3BC,UAAW,GACXC,UAAW,sCACXC,aAAc,SACdC,cAAe,mCACfC,aAAc,qCACdC,MAAO,SACPC,qBAAsB,CACrBC,gBAAiB,CAAC,qBAAqB,CACvCC,cAAe,CAAC,0BAAyB,GAIrCC,EAAY,IAAIZ,EAAY,YAAaE,GAEzCW,EAAgBd,EAAEe,QAAQ,CAAC,WAChC,IAAMC,EAAed,EAASe,GAAG,CAAC,uCAClC,AAAKD,GAMLb,EAAOC,SAAS,CAAGY,EAAaE,IAAI,GAAGC,OAAO,CAAC,OAAQ,IAChDN,EAAUO,SAAS,CAACjB,IAN1B,AAAIa,AAAiBK,KAAAA,IAAjBL,EACIF,IAER,KAAA,CAIF,EAAG,KAEHjB,EAAOyB,OAAO,CAAC,WACdvB,EAAQwB,OAAO,CAAC,WACf,OAAOT,GACR,EACD\"}"}