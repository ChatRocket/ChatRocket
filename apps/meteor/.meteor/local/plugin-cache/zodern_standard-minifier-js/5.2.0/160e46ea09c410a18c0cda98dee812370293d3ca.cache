{"code":"function module(e,t,n){var i,a,s,r,o,u,l,c,m,f,d,p,b,k=[\"_updatedAt\",\"lastMessage\",\"lm\",\"ts\",\"webRtcCallStartTime\",\"usersWaitingForE2EKeys\"];n.link(\"@babel/runtime/regenerator\",{default:function(e){i=e}},0),n.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(e){a=e}},1),n.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default:function(e){s=e}},2),n.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){r=e}},3),n.export({useTeamsChannelList:function(){return C}}),n.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(e){o=e}},0),n.link(\"react\",{useCallback:function(e){u=e},useMemo:function(e){l=e},useState:function(e){c=e}},1),n.link(\"../../../../../hooks/lists/useScrollableRecordList\",{useScrollableRecordList:function(e){m=e}},2),n.link(\"../../../../../hooks/useComponentDidUpdate\",{useComponentDidUpdate:function(e){f=e}},3),n.link(\"../../../../../lib/lists/RecordList\",{RecordList:function(e){d=e}},4),n.link(\"../../../../../lib/utils/getConfig\",{getConfig:function(e){p=e}},5),n.link(\"../../../../../lib/utils/mapMessageFromApi\",{mapMessageFromApi:function(e){b=e}},6);var C=function(e){var t=o(\"GET\",\"/v1/teams.listRooms\"),n=c(function(){return new d}),C=r(n,2),g=C[0],w=C[1],h=u(function(){return w(new d)},[]);f(function(){e&&h()},[e,h]);var I=u(function(n,r){var o,u,l;return i.async(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,i.awrap(t({teamId:e.teamId,offset:n,count:r,filter:e.text,type:e.type}));case 2:return u=(o=c.sent).rooms,l=o.total,c.abrupt(\"return\",{items:u.map(function(e){var t=e._updatedAt,n=e.lastMessage,i=e.lm,r=e.ts,o=e.webRtcCallStartTime,u=e.usersWaitingForE2EKeys,l=s(e,k);return a(a(a(a(a(a({},i&&{lm:new Date(i)}),r&&{ts:new Date(r)}),{},{_updatedAt:new Date(t)},n&&{lastMessage:b(n)}),o&&{webRtcCallStartTime:new Date(o)}),u&&u.map(function(e){return{userId:e.userId,ts:new Date(e.ts)}})),l)}),itemCount:l});case 6:case\"end\":return c.stop()}},null,null,null,Promise)},[t,e]),v=m(g,I,l(function(){return parseInt(\"\"+p(\"teamsChannelListSize\",10))},[]));return{reload:h,teamsChannelList:g,loadMoreItems:v.loadMoreItems,initialItemCount:v.initialItemCount}}}","map":"{\"version\":3,\"sources\":[\"client/views/teams/contextualBar/channels/hooks/useTeamsChannelList.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom } from '@rocket.chat/core-typings';\\nimport { useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useCallback, useMemo, useState } from 'react';\\n\\nimport { useScrollableRecordList } from '../../../../../hooks/lists/useScrollableRecordList';\\nimport { useComponentDidUpdate } from '../../../../../hooks/useComponentDidUpdate';\\nimport { RecordList } from '../../../../../lib/lists/RecordList';\\nimport { getConfig } from '../../../../../lib/utils/getConfig';\\nimport { mapMessageFromApi } from '../../../../../lib/utils/mapMessageFromApi';\\n\\ntype TeamsChannelListOptions = {\\n\\tteamId: string;\\n\\ttype: 'all' | 'autoJoin';\\n\\ttext: string;\\n};\\n\\nexport const useTeamsChannelList = (\\n\\toptions: TeamsChannelListOptions,\\n): {\\n\\tteamsChannelList: RecordList<IRoom>;\\n\\tinitialItemCount: number;\\n\\treload: () => void;\\n\\tloadMoreItems: (start: number, end: number) => void;\\n} => {\\n\\tconst apiEndPoint = useEndpoint('GET', '/v1/teams.listRooms');\\n\\tconst [teamsChannelList, setTeamsChannelList] = useState(() => new RecordList<IRoom>());\\n\\tconst reload = useCallback(() => setTeamsChannelList(new RecordList<IRoom>()), []);\\n\\n\\tuseComponentDidUpdate(() => {\\n\\t\\toptions && reload();\\n\\t}, [options, reload]);\\n\\n\\tconst fetchData = useCallback(\\n\\t\\tasync (start, end) => {\\n\\t\\t\\tconst { rooms, total } = await apiEndPoint({\\n\\t\\t\\t\\tteamId: options.teamId,\\n\\t\\t\\t\\toffset: start,\\n\\t\\t\\t\\tcount: end,\\n\\t\\t\\t\\tfilter: options.text,\\n\\t\\t\\t\\ttype: options.type,\\n\\t\\t\\t});\\n\\n\\t\\t\\treturn {\\n\\t\\t\\t\\titems: rooms.map(({ _updatedAt, lastMessage, lm, ts, webRtcCallStartTime, usersWaitingForE2EKeys, ...room }) => ({\\n\\t\\t\\t\\t\\t...(lm && { lm: new Date(lm) }),\\n\\t\\t\\t\\t\\t...(ts && { ts: new Date(ts) }),\\n\\t\\t\\t\\t\\t_updatedAt: new Date(_updatedAt),\\n\\t\\t\\t\\t\\t...(lastMessage && { lastMessage: mapMessageFromApi(lastMessage) }),\\n\\t\\t\\t\\t\\t...(webRtcCallStartTime && { webRtcCallStartTime: new Date(webRtcCallStartTime) }),\\n\\t\\t\\t\\t\\t...(usersWaitingForE2EKeys && usersWaitingForE2EKeys.map(({ userId, ts }) => ({ userId, ts: new Date(ts) }))),\\n\\t\\t\\t\\t\\t...room,\\n\\t\\t\\t\\t})),\\n\\t\\t\\t\\titemCount: total,\\n\\t\\t\\t};\\n\\t\\t},\\n\\t\\t[apiEndPoint, options],\\n\\t);\\n\\n\\tconst { loadMoreItems, initialItemCount } = useScrollableRecordList(\\n\\t\\tteamsChannelList,\\n\\t\\tfetchData,\\n\\t\\tuseMemo(() => parseInt(`${getConfig('teamsChannelListSize', 10)}`), []),\\n\\t);\\n\\n\\treturn {\\n\\t\\treload,\\n\\t\\tteamsChannelList,\\n\\t\\tloadMoreItems,\\n\\t\\tinitialItemCount,\\n\\t};\\n};\\n\",null],\"names\":[\"_regeneratorRuntime\",\"_objectSpread\",\"_objectWithoutProperties\",\"_slicedToArray\",\"useEndpoint\",\"useCallback\",\"useMemo\",\"useState\",\"useScrollableRecordList\",\"useComponentDidUpdate\",\"RecordList\",\"getConfig\",\"mapMessageFromApi\",\"module\",\"link\",\"default\",\"v\",\"export\",\"useTeamsChannelList\",\"options\",\"apiEndPoint\",\"_useState\",\"_useState2\",\"teamsChannelList\",\"setTeamsChannelList\",\"reload\",\"fetchData\",\"start\",\"end\",\"_await$apiEndPoint\",\"rooms\",\"total\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"teamId\",\"offset\",\"count\",\"filter\",\"text\",\"type\",\"sent\",\"abrupt\",\"items\",\"map\",\"_ref\",\"_updatedAt\",\"lastMessage\",\"lm\",\"ts\",\"webRtcCallStartTime\",\"usersWaitingForE2EKeys\",\"room\",\"_excluded\",\"Date\",\"_ref2\",\"userId\",\"itemCount\",\"stop\",\"Promise\",\"_useScrollableRecordL\",\"parseInt\",\"loadMoreItems\",\"initialItemCount\"],\"mappings\":\"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\"}"}