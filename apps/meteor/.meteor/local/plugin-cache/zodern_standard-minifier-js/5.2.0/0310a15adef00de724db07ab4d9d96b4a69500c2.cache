{"code":"function module(e,n,t){let o,a,c,l,r,s,i,m;t.export({OmnichannelRoomIconProvider:()=>d}),t.link(\"react\",{default(e){o=e},useCallback(e){a=e},useMemo(e){c=e}},0),t.link(\"react-dom\",{createPortal(e){l=e}},1),t.link(\"use-sync-external-store/shim\",{useSyncExternalStore(e){r=e}},2),t.link(\"../../../../lib/asyncState/AsyncStatePhase\",{AsyncStatePhase(e){s=e}},3),t.link(\"../context/OmnichannelRoomIconContext\",{OmnichannelRoomIconContext(e){i=e}},4),t.link(\"../lib/OmnichannelRoomIconManager\",{default(e){m=e}},5);let u=Array.from(m.icons.values()),d=e=>{let{children:n}=e,t=r(a(e=>m.on(\"change\",()=>{u=Array.from(m.icons.values()),e()}),[]),()=>u);return o.createElement(i.Provider,{value:c(()=>{let e=(e,n)=>{let t=m.get(e,n);return t?{phase:s.RESOLVED,value:t,error:void 0}:{phase:s.LOADING,value:void 0,error:void 0}},n=new Map;return{queryIcon:(t,o)=>[a=>m.on(\"\".concat(t,\"-\").concat(o),()=>{n.set(\"\".concat(t,\"-\").concat(o),e(t,o)),a()}),()=>{let a=n.get(\"\".concat(t,\"-\").concat(o));return a||(a=e(t,o),n.set(\"\".concat(t,\"-\").concat(o),a)),a}]}},[])},l(o.createElement(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",xmlnsXlink:\"http://www.w3.org/1999/xlink\",style:{display:\"none\"},dangerouslySetInnerHTML:{__html:t.join(\"\")}}),document.body,\"custom-icons\"),n)}}","map":"{\"version\":3,\"sources\":[\"client/components/RoomIcon/OmnichannelRoomIcon/provider/OmnichannelRoomIconProvider.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { ReactNode } from 'react';\\nimport React, { useCallback, useMemo } from 'react';\\nimport { createPortal } from 'react-dom';\\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\\n\\nimport type { AsyncState } from '../../../../lib/asyncState/AsyncState';\\nimport { AsyncStatePhase } from '../../../../lib/asyncState/AsyncStatePhase';\\nimport { OmnichannelRoomIconContext } from '../context/OmnichannelRoomIconContext';\\nimport OmnichannelRoomIconManager from '../lib/OmnichannelRoomIconManager';\\n\\nlet icons = Array.from(OmnichannelRoomIconManager.icons.values());\\n\\ntype OmnichannelRoomIconProviderProps = {\\n\\tchildren?: ReactNode;\\n};\\n\\nexport const OmnichannelRoomIconProvider = ({ children }: OmnichannelRoomIconProviderProps) => {\\n\\tconst svgIcons = useSyncExternalStore(\\n\\t\\tuseCallback(\\n\\t\\t\\t(callback): (() => void) =>\\n\\t\\t\\t\\tOmnichannelRoomIconManager.on('change', () => {\\n\\t\\t\\t\\t\\ticons = Array.from(OmnichannelRoomIconManager.icons.values());\\n\\t\\t\\t\\t\\tcallback();\\n\\t\\t\\t\\t}),\\n\\t\\t\\t[],\\n\\t\\t),\\n\\t\\t(): string[] => icons,\\n\\t);\\n\\n\\treturn (\\n\\t\\t<OmnichannelRoomIconContext.Provider\\n\\t\\t\\tvalue={useMemo(() => {\\n\\t\\t\\t\\tconst extractSnapshot = (app: string, iconName: string): AsyncState<string> => {\\n\\t\\t\\t\\t\\tconst icon = OmnichannelRoomIconManager.get(app, iconName);\\n\\n\\t\\t\\t\\t\\tif (icon) {\\n\\t\\t\\t\\t\\t\\treturn {\\n\\t\\t\\t\\t\\t\\t\\tphase: AsyncStatePhase.RESOLVED,\\n\\t\\t\\t\\t\\t\\t\\tvalue: icon,\\n\\t\\t\\t\\t\\t\\t\\terror: undefined,\\n\\t\\t\\t\\t\\t\\t};\\n\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\treturn {\\n\\t\\t\\t\\t\\t\\tphase: AsyncStatePhase.LOADING,\\n\\t\\t\\t\\t\\t\\tvalue: undefined,\\n\\t\\t\\t\\t\\t\\terror: undefined,\\n\\t\\t\\t\\t\\t};\\n\\t\\t\\t\\t};\\n\\n\\t\\t\\t\\t// We cache all the icons here, so that we can use them in the OmnichannelRoomIcon component\\n\\t\\t\\t\\tconst snapshots = new Map<string, AsyncState<string>>();\\n\\n\\t\\t\\t\\treturn {\\n\\t\\t\\t\\t\\tqueryIcon: (\\n\\t\\t\\t\\t\\t\\tapp: string,\\n\\t\\t\\t\\t\\t\\ticonName: string,\\n\\t\\t\\t\\t\\t): [subscribe: (onStoreChange: () => void) => () => void, getSnapshot: () => AsyncState<string>] => [\\n\\t\\t\\t\\t\\t\\t(callback): (() => void) =>\\n\\t\\t\\t\\t\\t\\t\\tOmnichannelRoomIconManager.on(`${app}-${iconName}`, () => {\\n\\t\\t\\t\\t\\t\\t\\t\\tsnapshots.set(`${app}-${iconName}`, extractSnapshot(app, iconName));\\n\\n\\t\\t\\t\\t\\t\\t\\t\\t// Then we call the callback (onStoreChange), signaling React to re-render\\n\\t\\t\\t\\t\\t\\t\\t\\tcallback();\\n\\t\\t\\t\\t\\t\\t\\t}),\\n\\n\\t\\t\\t\\t\\t\\t// No problem here, because it's return value is a cached in the snapshots map on subsequent calls\\n\\t\\t\\t\\t\\t\\t(): AsyncState<string> => {\\n\\t\\t\\t\\t\\t\\t\\tlet snapshot = snapshots.get(`${app}-${iconName}`);\\n\\n\\t\\t\\t\\t\\t\\t\\tif (!snapshot) {\\n\\t\\t\\t\\t\\t\\t\\t\\tsnapshot = extractSnapshot(app, iconName);\\n\\t\\t\\t\\t\\t\\t\\t\\tsnapshots.set(`${app}-${iconName}`, snapshot);\\n\\t\\t\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\t\\t\\treturn snapshot;\\n\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t],\\n\\t\\t\\t\\t};\\n\\t\\t\\t}, [])}\\n\\t\\t>\\n\\t\\t\\t{createPortal(\\n\\t\\t\\t\\t<svg\\n\\t\\t\\t\\t\\txmlns='http://www.w3.org/2000/svg'\\n\\t\\t\\t\\t\\txmlnsXlink='http://www.w3.org/1999/xlink'\\n\\t\\t\\t\\t\\tstyle={{ display: 'none' }}\\n\\t\\t\\t\\t\\tdangerouslySetInnerHTML={{ __html: svgIcons.join('') }}\\n\\t\\t\\t\\t/>,\\n\\t\\t\\t\\tdocument.body,\\n\\t\\t\\t\\t'custom-icons',\\n\\t\\t\\t)}\\n\\t\\t\\t{children}\\n\\t\\t</OmnichannelRoomIconContext.Provider>\\n\\t);\\n};\\n\",null],\"names\":[\"React\",\"useCallback\",\"useMemo\",\"createPortal\",\"useSyncExternalStore\",\"AsyncStatePhase\",\"OmnichannelRoomIconContext\",\"OmnichannelRoomIconManager\",\"module\",\"export\",\"OmnichannelRoomIconProvider\",\"link\",\"default\",\"v\",\"icons\",\"Array\",\"from\",\"values\",\"_ref\",\"children\",\"svgIcons\",\"callback\",\"on\",\"createElement\",\"Provider\",\"value\",\"extractSnapshot\",\"app\",\"iconName\",\"icon\",\"get\",\"phase\",\"RESOLVED\",\"error\",\"undefined\",\"LOADING\",\"snapshots\",\"Map\",\"queryIcon\",\"concat\",\"set\",\"snapshot\",\"xmlns\",\"xmlnsXlink\",\"style\",\"display\",\"dangerouslySetInnerHTML\",\"__html\",\"join\",\"document\",\"body\"],\"mappings\":\"2BACoDA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAApDC,EAAOC,MAAK,CAAE,CAAAC,4BAAwBA,IAAMA,CAAQ,GAAAF,EAAAG,IAAA,CAAA,QAAA,CAAAC,QAAAC,CAAA,EAAAb,EAAAa,CAAA,EAAAZ,YAAAY,CAAA,EAAAZ,EAAAY,CAAA,EAAAX,QAAAW,CAAA,EAAAX,EAAAW,CAAA,CAAA,EAAA,GAAAL,EAAAG,IAAA,CAAA,YAAA,CAAAR,aAAAU,CAAA,EAAAV,EAAAU,CAAA,CAAA,EAAA,GAAAL,EAAAG,IAAA,CAAA,+BAAA,CAAAP,qBAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAL,EAAAG,IAAA,CAAA,6CAAA,CAAAN,gBAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAL,EAAAG,IAAA,CAAA,wCAAA,CAAAL,2BAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAL,EAAAG,IAAA,CAAA,oCAAA,CAAAC,QAAAC,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GASpD,IAAIC,EAAQC,MAAMC,IAAI,CAACT,EAA2BO,KAAK,CAACG,MAAM,IAMjDP,EAA8BQ,IAAmD,GAAlD,CAAEC,SAAAA,CAAAA,CAA4C,CAAAD,EACnFE,EAAWhB,EAChBH,EACEoB,GACAd,EAA2Be,EAAE,CAAC,SAAU,KACvCR,EAAQC,MAAMC,IAAI,CAACT,EAA2BO,KAAK,CAACG,MAAM,IAC1DI,GACD,GACD,EAAE,EAEH,IAAgBP,GAGjB,OACCd,EAAAuB,aAAA,CAACjB,EAA2BkB,QAAQ,CAAA,CACnCC,MAAOvB,EAAQ,KACd,IAAMwB,EAAkBA,CAACC,EAAaC,KACrC,IAAMC,EAAOtB,EAA2BuB,GAAG,CAACH,EAAKC,UAEjD,AAAIC,EACI,CACNE,MAAO1B,EAAgB2B,QAAQ,CAC/BP,MAAOI,EACPI,MAAOC,KAAAA,GAIF,CACNH,MAAO1B,EAAgB8B,OAAO,CAC9BV,MAAOS,KAAAA,EACPD,MAAOC,KAAAA,EAET,EAGME,EAAY,IAAIC,IAEtB,MAAO,CACNC,UAAWA,CACVX,EACAC,IACmG,CAClGP,GACAd,EAA2Be,EAAE,CAAA,GAAAiB,MAAA,CAAIZ,EAAG,KAAAY,MAAA,CAAIX,GAAY,KACnDQ,EAAUI,GAAG,CAAA,GAAAD,MAAA,CAAIZ,EAAG,KAAAY,MAAA,CAAIX,GAAYF,EAAgBC,EAAKC,IAGzDP,GACD,GAGD,KACC,IAAIoB,EAAWL,EAAUN,GAAG,CAAA,GAAAS,MAAA,CAAIZ,EAAG,KAAAY,MAAA,CAAIX,IAOvC,OALKa,IACJA,EAAWf,EAAgBC,EAAKC,GAChCQ,EAAUI,GAAG,CAAA,GAAAD,MAAA,CAAIZ,EAAG,KAAAY,MAAA,CAAIX,GAAYa,IAG9BA,CACR,EAAC,CAGJ,EAAG,EAAE,CAAE,EAENtC,EACAH,EAAAuB,aAAA,CAAA,MAAA,CACCmB,MAAM,6BACNC,WAAW,+BACXC,MAAO,CAAEC,QAAS,MAAM,EACxBC,wBAAyB,CAAEC,OAAQ3B,EAAS4B,IAAI,CAAC,GAAG,CAAG,GAExDC,SAASC,IAAI,CACb,gBAEA/B,EAGJ\"}"}