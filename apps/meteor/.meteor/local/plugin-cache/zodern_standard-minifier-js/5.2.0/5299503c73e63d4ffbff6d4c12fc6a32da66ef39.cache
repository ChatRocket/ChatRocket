{"code":"function module(e,t,n){var a,s,r,l,i,c,o,u,d,f,p,m,v;n.link(\"@babel/runtime/regenerator\",{default:function(e){a=e}},0),n.link(\"@rocket.chat/fuselage\",{Box:function(e){s=e},Button:function(e){r=e},Field:function(e){l=e},FieldLabel:function(e){i=e},FieldRow:function(e){c=e},Icon:function(e){o=e}},0),n.link(\"@rocket.chat/random\",{Random:function(e){u=e}},1),n.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch:function(e){d=e},useEndpoint:function(e){f=e},useTranslation:function(e){p=e},useUpload:function(e){m=e}},2),n.link(\"react\",{default:function(e){v=e}},3),n.link(\"./AssetSettingInput.styles.css\"),n.exportDefault(function(e){var t,n=e._id,g=e.label,b=e.value,h=e.asset,k=e.required,x=e.disabled,E=e.fileConstraints,w=p(),y=d(),N=m(\"/v1/assets.setAsset\"),_=f(\"POST\",\"/v1/assets.unsetAsset\");return v.createElement(l,null,v.createElement(i,{htmlFor:n,title:n,required:k},g),v.createElement(c,null,v.createElement(\"div\",{className:\"settings-file-preview\"},null!=b&&b.url?v.createElement(\"div\",{className:\"preview\",style:{backgroundImage:\"url(\"+b.url+\"?_dc=\"+u.id()+\")\"},role:\"img\",\"aria-label\":w(\"Asset_preview\")}):v.createElement(\"div\",{className:\"preview no-file background-transparent-light secondary-font-color\"},v.createElement(o,{size:\"x16\",name:\"upload\"})),v.createElement(\"div\",{className:\"action\"},null!=b&&b.url?v.createElement(r,{icon:\"trash\",disabled:x,onClick:function(){return a.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.awrap(_({assetName:h}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),y({type:\"error\",message:e.t0});case 8:case\"end\":return e.stop()}},null,null,[[0,5]],Promise)}},w(\"Delete\")):v.createElement(s,{position:\"relative\",className:\"rcx-button rcx-button--primary \"+(x?\"is-disabled\":\"\")},w(\"Select_file\"),v.createElement(\"input\",{className:\"AssetSettingInput__input\",type:\"file\",accept:\".\"+(null==E?void 0:null===(t=E.extensions)||void 0===t?void 0:t.join(\", .\")),onChange:function(e){var t,n=e.target.files;(!n||0===n.length)&&\"dataTransfer\"in e&&e.dataTransfer.files&&(n=e.dataTransfer.files),Object.values(null!==(t=n)&&void 0!==t?t:[]).forEach(function(e){var t;return a.async(function(n){for(;;)switch(n.prev=n.next){case 0:return y({type:\"info\",message:w(\"Uploading_file\")}),(t=new FormData).append(\"asset\",e,e.name),t.append(\"assetName\",h),n.prev=4,n.next=7,a.awrap(N(t));case 7:n.next=12;break;case 9:n.prev=9,n.t0=n.catch(4),y({type:\"error\",message:n.t0});case 12:case\"end\":return n.stop()}},null,null,[[4,9]],Promise)})},disabled:x}))))))})}","map":"{\"version\":3,\"sources\":[\"client/views/admin/settings/Setting/inputs/AssetSettingInput.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Box, Button, Field, FieldLabel, FieldRow, Icon } from '@rocket.chat/fuselage';\\nimport { Random } from '@rocket.chat/random';\\nimport { useToastMessageDispatch, useEndpoint, useTranslation, useUpload } from '@rocket.chat/ui-contexts';\\nimport type { ChangeEventHandler, DragEvent, ReactElement, SyntheticEvent } from 'react';\\nimport React from 'react';\\n\\nimport './AssetSettingInput.styles.css';\\nimport type { SettingInputProps } from './types';\\n\\ntype AssetSettingInputProps = Omit<SettingInputProps<{ url: string }>, 'onChangeValue'> & {\\n\\tasset?: any;\\n\\tfileConstraints?: { extensions: string[] };\\n};\\n\\nfunction AssetSettingInput({ _id, label, value, asset, required, disabled, fileConstraints }: AssetSettingInputProps): ReactElement {\\n\\tconst t = useTranslation();\\n\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst setAsset = useUpload('/v1/assets.setAsset');\\n\\tconst unsetAsset = useEndpoint('POST', '/v1/assets.unsetAsset');\\n\\n\\tconst isDataTransferEvent = <T extends SyntheticEvent>(event: T): event is T & DragEvent<HTMLInputElement> =>\\n\\t\\tBoolean('dataTransfer' in event && (event as any).dataTransfer.files);\\n\\n\\tconst handleUpload: ChangeEventHandler<HTMLInputElement> = (event): void => {\\n\\t\\tlet { files } = event.target;\\n\\n\\t\\tif (!files || files.length === 0) {\\n\\t\\t\\tif (isDataTransferEvent(event)) {\\n\\t\\t\\t\\tfiles = event.dataTransfer.files;\\n\\t\\t\\t}\\n\\t\\t}\\n\\n\\t\\tObject.values(files ?? []).forEach(async (blob) => {\\n\\t\\t\\tdispatchToastMessage({ type: 'info', message: t('Uploading_file') });\\n\\n\\t\\t\\tconst fileData = new FormData();\\n\\t\\t\\tfileData.append('asset', blob, blob.name);\\n\\t\\t\\tfileData.append('assetName', asset);\\n\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tawait setAsset(fileData);\\n\\t\\t\\t} catch (e) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: e });\\n\\t\\t\\t}\\n\\t\\t});\\n\\t};\\n\\n\\tconst handleDeleteButtonClick = async (): Promise<void> => {\\n\\t\\ttry {\\n\\t\\t\\tawait unsetAsset({ assetName: asset });\\n\\t\\t} catch (error) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t}\\n\\t};\\n\\n\\treturn (\\n\\t\\t<Field>\\n\\t\\t\\t<FieldLabel htmlFor={_id} title={_id} required={required}>\\n\\t\\t\\t\\t{label}\\n\\t\\t\\t</FieldLabel>\\n\\t\\t\\t<FieldRow>\\n\\t\\t\\t\\t<div className='settings-file-preview'>\\n\\t\\t\\t\\t\\t{value?.url ? (\\n\\t\\t\\t\\t\\t\\t<div\\n\\t\\t\\t\\t\\t\\t\\tclassName='preview'\\n\\t\\t\\t\\t\\t\\t\\tstyle={{ backgroundImage: `url(${value.url}?_dc=${Random.id()})` }}\\n\\t\\t\\t\\t\\t\\t\\trole='img'\\n\\t\\t\\t\\t\\t\\t\\taria-label={t('Asset_preview')}\\n\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t) : (\\n\\t\\t\\t\\t\\t\\t<div className='preview no-file background-transparent-light secondary-font-color'>\\n\\t\\t\\t\\t\\t\\t\\t<Icon size='x16' name='upload' />\\n\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t<div className='action'>\\n\\t\\t\\t\\t\\t\\t{value?.url ? (\\n\\t\\t\\t\\t\\t\\t\\t<Button icon='trash' disabled={disabled} onClick={handleDeleteButtonClick}>\\n\\t\\t\\t\\t\\t\\t\\t\\t{t('Delete')}\\n\\t\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t\\t) : (\\n\\t\\t\\t\\t\\t\\t\\t<Box position='relative' className={`rcx-button rcx-button--primary ${disabled ? 'is-disabled' : ''}`}>\\n\\t\\t\\t\\t\\t\\t\\t\\t{t('Select_file')}\\n\\t\\t\\t\\t\\t\\t\\t\\t<input\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tclassName='AssetSettingInput__input'\\n\\t\\t\\t\\t\\t\\t\\t\\t\\ttype='file'\\n\\t\\t\\t\\t\\t\\t\\t\\t\\taccept={`.${fileConstraints?.extensions?.join(', .')}`}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tonChange={handleUpload}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tdisabled={disabled}\\n\\t\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t\\t)}\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</FieldRow>\\n\\t\\t</Field>\\n\\t);\\n}\\n\\nexport default AssetSettingInput;\\n\",null],\"names\":[\"_regeneratorRuntime\",\"Box\",\"Button\",\"Field\",\"FieldLabel\",\"FieldRow\",\"Icon\",\"Random\",\"useToastMessageDispatch\",\"useEndpoint\",\"useTranslation\",\"useUpload\",\"React\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"_fileConstraints$exte\",\"_id\",\"label\",\"value\",\"asset\",\"required\",\"disabled\",\"fileConstraints\",\"t\",\"dispatchToastMessage\",\"setAsset\",\"unsetAsset\",\"createElement\",\"htmlFor\",\"title\",\"className\",\"url\",\"style\",\"backgroundImage\",\"id\",\"role\",\"size\",\"name\",\"icon\",\"onClick\",\"async\",\"_context2\",\"prev\",\"next\",\"awrap\",\"assetName\",\"t0\",\"type\",\"message\",\"stop\",\"Promise\",\"position\",\"accept\",\"extensions\",\"join\",\"onChange\",\"event\",\"_files\",\"files\",\"target\",\"length\",\"dataTransfer\",\"Object\",\"values\",\"forEach\",\"blob\",\"fileData\",\"_context\",\"FormData\",\"append\"],\"mappings\":\"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\"}"}