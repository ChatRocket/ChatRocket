{"code":"function module(e,t,n){var r,a,i,l,o,u,s,d,c,m,f,p=[\"_id\",\"name\"];n.link(\"@babel/runtime/regenerator\",{default:function(e){r=e}},0),n.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default:function(e){a=e}},1),n.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){i=e}},2),n.export({useDepartmentsList:function(){return v}}),n.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(e){l=e},useTranslation:function(e){o=e}},0),n.link(\"react\",{useCallback:function(e){u=e},useState:function(e){s=e}},1),n.link(\"../../../hooks/lists/useScrollableRecordList\",{useScrollableRecordList:function(e){d=e}},2),n.link(\"../../../hooks/useComponentDidUpdate\",{useComponentDidUpdate:function(e){c=e}},3),n.link(\"../../../lib/lists/RecordList\",{RecordList:function(e){m=e}},4),n.link(\"../utils/normalizeDepartments\",{normalizeDepartments:function(e){f=e}},5);var v=function(e){var t,n=o(),v=s(function(){return new m}),h=i(v,2),b=h[0],D=h[1],k=u(function(){return D(new m)},[]),I=l(\"GET\",\"/v1/livechat/department\"),x=l(\"GET\",\"/v1/livechat/department/:_id\",{_id:null!==(t=e.selectedDepartment)&&void 0!==t?t:\"\"});c(function(){e&&k()},[e,k]);var w=u(function(t,i){var l,o,u,s,d,c;return r.async(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,r.awrap(I({onlyMyDepartments:\"\"+!!e.onlyMyDepartments,text:e.filter,offset:t,count:i+t,sort:'{ \"name\": 1 }',excludeDepartmentId:e.excludeDepartmentId,enabled:e.enabled?\"true\":\"false\",showArchived:e.showArchived?\"true\":\"false\"}));case 2:return u=(o=m.sent).departments,s=o.total,d=u.filter(function(t){return!e.departmentId||t._id!==e.departmentId}).map(function(e){var t=e._id,r=e.name;return{_id:t,label:a(e,p).archived?r+\" [\"+n(\"Archived\")+\"]\":r,value:t}}),m.next=8,r.awrap(f(d,null!==(l=e.selectedDepartment)&&void 0!==l?l:\"\",x));case 8:return c=m.sent,e.haveAll&&c.unshift({_id:\"\",label:n(\"All\"),value:\"all\"}),e.haveNone&&c.unshift({_id:\"\",label:n(\"None\"),value:\"\"}),m.abrupt(\"return\",{items:c,itemCount:e.departmentId?s-1:s});case 12:case\"end\":return m.stop()}},null,null,null,Promise)},[I,e.onlyMyDepartments,e.filter,e.excludeDepartmentId,e.enabled,e.showArchived,e.selectedDepartment,e.haveAll,e.haveNone,e.departmentId,x,n]),y=d(b,w,25);return{reload:k,itemsList:b,loadMoreItems:y.loadMoreItems,initialItemCount:y.initialItemCount}}}","map":"{\"version\":3,\"sources\":[\"client/components/Omnichannel/hooks/useDepartmentsList.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\\nimport { useCallback, useState } from 'react';\\n\\nimport { useScrollableRecordList } from '../../../hooks/lists/useScrollableRecordList';\\nimport { useComponentDidUpdate } from '../../../hooks/useComponentDidUpdate';\\nimport { RecordList } from '../../../lib/lists/RecordList';\\nimport type { DepartmentListItem } from '../Definitions/DepartmentsDefinitions';\\nimport { normalizeDepartments } from '../utils/normalizeDepartments';\\n\\ntype DepartmentsListOptions = {\\n\\tfilter: string;\\n\\tdepartmentId?: string;\\n\\tonlyMyDepartments?: boolean;\\n\\thaveAll?: boolean;\\n\\thaveNone?: boolean;\\n\\texcludeDepartmentId?: string;\\n\\tenabled?: boolean;\\n\\tshowArchived?: boolean;\\n\\tselectedDepartment?: string;\\n};\\n\\nexport const useDepartmentsList = (\\n\\toptions: DepartmentsListOptions,\\n): {\\n\\titemsList: RecordList<DepartmentListItem>;\\n\\tinitialItemCount: number;\\n\\treload: () => void;\\n\\tloadMoreItems: (start: number, end: number) => void;\\n} => {\\n\\tconst t = useTranslation();\\n\\tconst [itemsList, setItemsList] = useState(() => new RecordList<DepartmentListItem>());\\n\\tconst reload = useCallback(() => setItemsList(new RecordList<DepartmentListItem>()), []);\\n\\n\\tconst getDepartments = useEndpoint('GET', '/v1/livechat/department');\\n\\tconst getDepartment = useEndpoint('GET', '/v1/livechat/department/:_id', { _id: options.selectedDepartment ?? '' });\\n\\n\\tuseComponentDidUpdate(() => {\\n\\t\\toptions && reload();\\n\\t}, [options, reload]);\\n\\n\\tconst fetchData = useCallback(\\n\\t\\tasync (start, end) => {\\n\\t\\t\\tconst { departments, total } = await getDepartments({\\n\\t\\t\\t\\tonlyMyDepartments: `${!!options.onlyMyDepartments}`,\\n\\t\\t\\t\\ttext: options.filter,\\n\\t\\t\\t\\toffset: start,\\n\\t\\t\\t\\tcount: end + start,\\n\\t\\t\\t\\tsort: `{ \\\"name\\\": 1 }`,\\n\\t\\t\\t\\texcludeDepartmentId: options.excludeDepartmentId,\\n\\t\\t\\t\\tenabled: options.enabled ? 'true' : 'false',\\n\\t\\t\\t\\tshowArchived: options.showArchived ? 'true' : 'false',\\n\\t\\t\\t});\\n\\n\\t\\t\\tconst items = departments\\n\\t\\t\\t\\t.filter((department) => {\\n\\t\\t\\t\\t\\tif (options.departmentId && department._id === options.departmentId) {\\n\\t\\t\\t\\t\\t\\treturn false;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\treturn true;\\n\\t\\t\\t\\t})\\n\\t\\t\\t\\t.map(\\n\\t\\t\\t\\t\\t({ _id, name, ...department }): DepartmentListItem => ({\\n\\t\\t\\t\\t\\t\\t_id,\\n\\t\\t\\t\\t\\t\\tlabel: department.archived ? `${name} [${t('Archived')}]` : name,\\n\\t\\t\\t\\t\\t\\tvalue: _id,\\n\\t\\t\\t\\t\\t}),\\n\\t\\t\\t\\t);\\n\\n\\t\\t\\tconst normalizedItems = await normalizeDepartments(items, options.selectedDepartment ?? '', getDepartment);\\n\\n\\t\\t\\toptions.haveAll &&\\n\\t\\t\\t\\tnormalizedItems.unshift({\\n\\t\\t\\t\\t\\t_id: '',\\n\\t\\t\\t\\t\\tlabel: t('All'),\\n\\t\\t\\t\\t\\tvalue: 'all',\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\toptions.haveNone &&\\n\\t\\t\\t\\tnormalizedItems.unshift({\\n\\t\\t\\t\\t\\t_id: '',\\n\\t\\t\\t\\t\\tlabel: t('None'),\\n\\t\\t\\t\\t\\tvalue: '',\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\treturn {\\n\\t\\t\\t\\titems: normalizedItems,\\n\\t\\t\\t\\titemCount: options.departmentId ? total - 1 : total,\\n\\t\\t\\t};\\n\\t\\t},\\n\\t\\t[\\n\\t\\t\\tgetDepartments,\\n\\t\\t\\toptions.onlyMyDepartments,\\n\\t\\t\\toptions.filter,\\n\\t\\t\\toptions.excludeDepartmentId,\\n\\t\\t\\toptions.enabled,\\n\\t\\t\\toptions.showArchived,\\n\\t\\t\\toptions.selectedDepartment,\\n\\t\\t\\toptions.haveAll,\\n\\t\\t\\toptions.haveNone,\\n\\t\\t\\toptions.departmentId,\\n\\t\\t\\tgetDepartment,\\n\\t\\t\\tt,\\n\\t\\t],\\n\\t);\\n\\n\\tconst { loadMoreItems, initialItemCount } = useScrollableRecordList(itemsList, fetchData, 25);\\n\\n\\treturn {\\n\\t\\treload,\\n\\t\\titemsList,\\n\\t\\tloadMoreItems,\\n\\t\\tinitialItemCount,\\n\\t};\\n};\\n\",null],\"names\":[\"_regeneratorRuntime\",\"_objectWithoutProperties\",\"_slicedToArray\",\"useEndpoint\",\"useTranslation\",\"useCallback\",\"useState\",\"useScrollableRecordList\",\"useComponentDidUpdate\",\"RecordList\",\"normalizeDepartments\",\"module\",\"link\",\"default\",\"v\",\"export\",\"useDepartmentsList\",\"options\",\"_options$selectedDepa\",\"t\",\"_useState\",\"_useState2\",\"itemsList\",\"setItemsList\",\"reload\",\"getDepartments\",\"getDepartment\",\"_id\",\"selectedDepartment\",\"fetchData\",\"start\",\"end\",\"_options$selectedDepa2\",\"_await$getDepartments\",\"departments\",\"total\",\"items\",\"normalizedItems\",\"async\",\"_context\",\"prev\",\"next\",\"awrap\",\"onlyMyDepartments\",\"text\",\"filter\",\"offset\",\"count\",\"sort\",\"excludeDepartmentId\",\"enabled\",\"showArchived\",\"sent\",\"department\",\"departmentId\",\"map\",\"_ref\",\"name\",\"label\",\"_excluded\",\"archived\",\"value\",\"haveAll\",\"unshift\",\"haveNone\",\"abrupt\",\"itemCount\",\"stop\",\"Promise\",\"_useScrollableRecordL\",\"loadMoreItems\",\"initialItemCount\"],\"mappings\":\"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\"}"}