{"code":"function module(e,t,n){let a,l,o,i,u,r,c,s,d,k,m,b,E,f,h,C,p,_;n.link(\"@babel/runtime/helpers/extends\",{default(e){a=e}},0),n.link(\"@rocket.chat/fuselage\",{ButtonGroup(e){l=e},Button(e){o=e}},0),n.link(\"@rocket.chat/ui-contexts\",{useTranslation(e){i=e},useUserPreference(e){u=e},useEndpoint(e){r=e},useToastMessageDispatch(e){c=e}},1),n.link(\"react\",{default(e){s=e},useCallback(e){d=e}},2),n.link(\"../../../components/Contextualbar\",{ContextualbarHeader(e){k=e},ContextualbarIcon(e){m=e},ContextualbarTitle(e){b=e},ContextualbarClose(e){E=e},ContextualbarContent(e){f=e},ContextualbarFooter(e){h=e}},3),n.link(\"../hooks/useOutlookAuthentication\",{useOutlookAuthentication(e){C=e},useOutlookAuthenticationMutationLogout(e){p=e}},4),n.link(\"./OutlookSettingItem\",{default(e){_=e}},5),n.exportDefault(e=>{let{onClose:t,changeRoute:n}=e,x=i(),g=c(),O=r(\"POST\",\"/v1/users.setPreferences\"),v=u(\"notifyCalendarEvents\"),{authEnabled:y}=C(),T=p(),P=d(e=>{try{O({data:{notifyCalendarEvents:e}}),g({type:\"success\",message:x(\"Preferences_saved\")})}catch(e){g({type:\"error\",message:e})}},[O,g,x]),A=[{id:\"notification\",title:x(\"Event_notifications\"),subTitle:x(\"Event_notifications_description\"),enabled:v,handleEnable:P},{id:\"authentication\",title:x(\"Outlook_authentication\"),subTitle:x(\"Outlook_authentication_description\"),enabled:y,handleEnable:()=>T.mutate(void 0,{onSuccess:n})}];return s.createElement(s.Fragment,null,s.createElement(k,null,s.createElement(m,{name:\"calendar\"}),s.createElement(b,null,x(\"Outlook_calendar_settings\")),s.createElement(E,{onClick:t})),s.createElement(f,{paddingInline:0,color:\"default\"},A.map((e,t)=>{if(\"authentication\"!==e.id||e.enabled)return s.createElement(_,a({key:t},e))})),s.createElement(h,null,s.createElement(l,{stretch:!0},s.createElement(o,{onClick:n},x(\"Back_to_calendar\")))))})}","map":"{\"version\":3,\"sources\":[\"client/views/outlookCalendar/OutlookSettingsList/OutlookSettingsList.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { ButtonGroup, Button } from '@rocket.chat/fuselage';\\nimport { useTranslation, useUserPreference, useEndpoint, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement } from 'react';\\nimport React, { useCallback } from 'react';\\n\\nimport {\\n\\tContextualbarHeader,\\n\\tContextualbarIcon,\\n\\tContextualbarTitle,\\n\\tContextualbarClose,\\n\\tContextualbarContent,\\n\\tContextualbarFooter,\\n} from '../../../components/Contextualbar';\\nimport { useOutlookAuthentication, useOutlookAuthenticationMutationLogout } from '../hooks/useOutlookAuthentication';\\nimport OutlookSettingItem from './OutlookSettingItem';\\n\\ntype OutlookSettingsListProps = {\\n\\tonClose: () => void;\\n\\tchangeRoute: () => void;\\n};\\n\\nconst OutlookSettingsList = ({ onClose, changeRoute }: OutlookSettingsListProps): ReactElement => {\\n\\tconst t = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\tconst saveUserPreferences = useEndpoint('POST', '/v1/users.setPreferences');\\n\\tconst notifyCalendarEvents = useUserPreference('notifyCalendarEvents') as boolean;\\n\\tconst { authEnabled } = useOutlookAuthentication();\\n\\tconst handleDisableAuth = useOutlookAuthenticationMutationLogout();\\n\\n\\tconst handleNotifyCalendarEvents = useCallback(\\n\\t\\t(value: boolean) => {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tsaveUserPreferences({ data: { notifyCalendarEvents: value } });\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Preferences_saved') });\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t[saveUserPreferences, dispatchToastMessage, t],\\n\\t);\\n\\n\\tconst calendarSettings = [\\n\\t\\t{\\n\\t\\t\\tid: 'notification',\\n\\t\\t\\ttitle: t('Event_notifications'),\\n\\t\\t\\tsubTitle: t('Event_notifications_description'),\\n\\t\\t\\tenabled: notifyCalendarEvents,\\n\\t\\t\\thandleEnable: handleNotifyCalendarEvents,\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\tid: 'authentication',\\n\\t\\t\\ttitle: t('Outlook_authentication'),\\n\\t\\t\\tsubTitle: t('Outlook_authentication_description'),\\n\\t\\t\\tenabled: authEnabled,\\n\\t\\t\\thandleEnable: () =>\\n\\t\\t\\t\\thandleDisableAuth.mutate(undefined, {\\n\\t\\t\\t\\t\\tonSuccess: changeRoute,\\n\\t\\t\\t\\t}),\\n\\t\\t},\\n\\t];\\n\\n\\treturn (\\n\\t\\t<>\\n\\t\\t\\t<ContextualbarHeader>\\n\\t\\t\\t\\t<ContextualbarIcon name='calendar' />\\n\\t\\t\\t\\t<ContextualbarTitle>{t('Outlook_calendar_settings')}</ContextualbarTitle>\\n\\t\\t\\t\\t<ContextualbarClose onClick={onClose} />\\n\\t\\t\\t</ContextualbarHeader>\\n\\t\\t\\t<ContextualbarContent paddingInline={0} color='default'>\\n\\t\\t\\t\\t{calendarSettings.map((setting, index) => {\\n\\t\\t\\t\\t\\tif (setting.id === 'authentication' && !setting.enabled) {\\n\\t\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\treturn <OutlookSettingItem key={index} {...setting} />;\\n\\t\\t\\t\\t})}\\n\\t\\t\\t</ContextualbarContent>\\n\\t\\t\\t<ContextualbarFooter>\\n\\t\\t\\t\\t<ButtonGroup stretch>\\n\\t\\t\\t\\t\\t<Button onClick={changeRoute}>{t('Back_to_calendar')}</Button>\\n\\t\\t\\t\\t</ButtonGroup>\\n\\t\\t\\t</ContextualbarFooter>\\n\\t\\t</>\\n\\t);\\n};\\n\\nexport default OutlookSettingsList;\\n\",null],\"names\":[\"_extends\",\"ButtonGroup\",\"Button\",\"useTranslation\",\"useUserPreference\",\"useEndpoint\",\"useToastMessageDispatch\",\"React\",\"useCallback\",\"ContextualbarHeader\",\"ContextualbarIcon\",\"ContextualbarTitle\",\"ContextualbarClose\",\"ContextualbarContent\",\"ContextualbarFooter\",\"useOutlookAuthentication\",\"useOutlookAuthenticationMutationLogout\",\"OutlookSettingItem\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"onClose\",\"changeRoute\",\"t\",\"dispatchToastMessage\",\"saveUserPreferences\",\"notifyCalendarEvents\",\"authEnabled\",\"handleDisableAuth\",\"handleNotifyCalendarEvents\",\"value\",\"data\",\"type\",\"message\",\"error\",\"calendarSettings\",\"id\",\"title\",\"subTitle\",\"enabled\",\"handleEnable\",\"mutate\",\"undefined\",\"onSuccess\",\"createElement\",\"Fragment\",\"name\",\"onClick\",\"paddingInline\",\"color\",\"map\",\"setting\",\"index\",\"key\",\"stretch\"],\"mappings\":\"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\"}"}