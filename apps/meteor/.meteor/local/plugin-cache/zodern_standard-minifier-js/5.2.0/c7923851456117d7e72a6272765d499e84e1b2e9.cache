{"code":"function module(e,n,t){let i,o,l,r;t.export({useRetentionPolicy:()=>P}),t.link(\"@rocket.chat/ui-contexts\",{useSetting(e){i=e}},0),t.link(\"../../../lib/convertTimeUnit\",{TIMEUNIT(e){o=e},isValidTimespan(e){l=e},timeUnitToMs(e){r=e}},1);let s=e=>\"retention\"in e&&void 0!==e.retention,a=e=>\"overrideGlobal\"in e.retention&&e.retention.overrideGlobal,d=(e,n)=>{let{enabled:t,appliesToChannels:i,appliesToGroups:o,appliesToDMs:l}=n;if(!t)return!1;if(s(e)&&void 0!==e.retention.enabled)return e.retention.enabled;switch(e.t){case\"c\":return i;case\"p\":return o;case\"d\":return l}return!1},c=(e,n)=>{let{filesOnly:t}=n;return s(e)&&a(e)?e.retention.filesOnly:t},u=(e,n)=>{let{doNotPrunePinned:t}=n;return s(e)&&a(e)?e.retention.excludePinned:t},T=(e,n)=>{let{ignoreThreads:t}=n;return s(e)&&a(e)?e.retention.ignoreThreads:t},p=(e,n)=>{let{maxAgeChannels:t,maxAgeGroups:i,maxAgeDMs:d}=n;return s(e)&&a(e)&&l(e.retention.maxAge)?r(o.days,e.retention.maxAge):\"c\"===e.t?t:\"p\"===e.t?i:\"d\"===e.t?d:-1/0},P=e=>{let n={enabled:i(\"RetentionPolicy_Enabled\"),filesOnly:i(\"RetentionPolicy_FilesOnly\"),doNotPrunePinned:i(\"RetentionPolicy_DoNotPrunePinned\"),ignoreThreads:i(\"RetentionPolicy_DoNotPruneThreads\"),appliesToChannels:i(\"RetentionPolicy_AppliesToChannels\"),maxAgeChannels:i(\"RetentionPolicy_TTL_Channels\"),appliesToGroups:i(\"RetentionPolicy_AppliesToGroups\"),maxAgeGroups:i(\"RetentionPolicy_TTL_Groups\"),appliesToDMs:i(\"RetentionPolicy_AppliesToDMs\"),maxAgeDMs:i(\"RetentionPolicy_TTL_DMs\")};if(e)return{enabled:n.enabled,isActive:d(e,n),filesOnly:c(e,n),excludePinned:u(e,n),ignoreThreads:T(e,n),maxAge:p(e,n)}}}","map":"{\"version\":3,\"sources\":[\"client/views/room/hooks/useRetentionPolicy.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom, IRoomWithRetentionPolicy } from '@rocket.chat/core-typings';\\nimport { useSetting } from '@rocket.chat/ui-contexts';\\n\\nimport { TIMEUNIT, isValidTimespan, timeUnitToMs } from '../../../lib/convertTimeUnit';\\n\\nconst hasRetentionPolicy = (room: IRoom & { retention?: any }): room is IRoomWithRetentionPolicy =>\\n\\t'retention' in room && room.retention !== undefined;\\n\\nconst isRetentionOverridden = (room: IRoom & { retention?: any }) => 'overrideGlobal' in room.retention && room.retention.overrideGlobal;\\n\\ntype RetentionPolicySettings = {\\n\\tenabled: boolean;\\n\\tfilesOnly: boolean;\\n\\tdoNotPrunePinned: boolean;\\n\\tignoreThreads: boolean;\\n\\tappliesToChannels: boolean;\\n\\tmaxAgeChannels: number;\\n\\tappliesToGroups: boolean;\\n\\tmaxAgeGroups: number;\\n\\tappliesToDMs: boolean;\\n\\tmaxAgeDMs: number;\\n};\\n\\nconst isActive = (room: IRoom, { enabled, appliesToChannels, appliesToGroups, appliesToDMs }: RetentionPolicySettings): boolean => {\\n\\tif (!enabled) {\\n\\t\\treturn false;\\n\\t}\\n\\n\\tif (hasRetentionPolicy(room) && room.retention.enabled !== undefined) {\\n\\t\\treturn room.retention.enabled;\\n\\t}\\n\\n\\tswitch (room.t) {\\n\\t\\tcase 'c':\\n\\t\\t\\treturn appliesToChannels;\\n\\t\\tcase 'p':\\n\\t\\t\\treturn appliesToGroups;\\n\\t\\tcase 'd':\\n\\t\\t\\treturn appliesToDMs;\\n\\t}\\n\\n\\treturn false;\\n};\\n\\nconst extractFilesOnly = (room: IRoom, { filesOnly }: RetentionPolicySettings): boolean => {\\n\\tif (hasRetentionPolicy(room) && isRetentionOverridden(room)) {\\n\\t\\treturn room.retention.filesOnly;\\n\\t}\\n\\n\\treturn filesOnly;\\n};\\n\\nconst extractExcludePinned = (room: IRoom, { doNotPrunePinned }: RetentionPolicySettings): boolean => {\\n\\tif (hasRetentionPolicy(room) && isRetentionOverridden(room)) {\\n\\t\\treturn room.retention.excludePinned;\\n\\t}\\n\\n\\treturn doNotPrunePinned;\\n};\\n\\nconst extractIgnoreThreads = (room: IRoom, { ignoreThreads }: RetentionPolicySettings): boolean => {\\n\\tif (hasRetentionPolicy(room) && isRetentionOverridden(room)) {\\n\\t\\treturn room.retention.ignoreThreads;\\n\\t}\\n\\n\\treturn ignoreThreads;\\n};\\n\\nconst getMaxAge = (room: IRoom, { maxAgeChannels, maxAgeGroups, maxAgeDMs }: RetentionPolicySettings): number => {\\n\\tif (hasRetentionPolicy(room) && isRetentionOverridden(room) && isValidTimespan(room.retention.maxAge)) {\\n\\t\\treturn timeUnitToMs(TIMEUNIT.days, room.retention.maxAge);\\n\\t}\\n\\n\\tif (room.t === 'c') {\\n\\t\\treturn maxAgeChannels;\\n\\t}\\n\\tif (room.t === 'p') {\\n\\t\\treturn maxAgeGroups;\\n\\t}\\n\\tif (room.t === 'd') {\\n\\t\\treturn maxAgeDMs;\\n\\t}\\n\\n\\treturn -Infinity;\\n};\\n\\nexport const useRetentionPolicy = (\\n\\troom: IRoom | undefined,\\n):\\n\\t| {\\n\\t\\t\\tenabled: boolean;\\n\\t\\t\\tisActive: boolean;\\n\\t\\t\\tfilesOnly: boolean;\\n\\t\\t\\texcludePinned: boolean;\\n\\t\\t\\tignoreThreads: boolean;\\n\\t\\t\\tmaxAge: number;\\n\\t  }\\n\\t| undefined => {\\n\\tconst settings = {\\n\\t\\tenabled: useSetting('RetentionPolicy_Enabled') as boolean,\\n\\t\\tfilesOnly: useSetting('RetentionPolicy_FilesOnly') as boolean,\\n\\t\\tdoNotPrunePinned: useSetting('RetentionPolicy_DoNotPrunePinned') as boolean,\\n\\t\\tignoreThreads: useSetting('RetentionPolicy_DoNotPruneThreads') as boolean,\\n\\t\\tappliesToChannels: useSetting('RetentionPolicy_AppliesToChannels') as boolean,\\n\\t\\tmaxAgeChannels: useSetting('RetentionPolicy_TTL_Channels') as number,\\n\\t\\tappliesToGroups: useSetting('RetentionPolicy_AppliesToGroups') as boolean,\\n\\t\\tmaxAgeGroups: useSetting('RetentionPolicy_TTL_Groups') as number,\\n\\t\\tappliesToDMs: useSetting('RetentionPolicy_AppliesToDMs') as boolean,\\n\\t\\tmaxAgeDMs: useSetting('RetentionPolicy_TTL_DMs') as number,\\n\\t} as const;\\n\\n\\tif (!room) {\\n\\t\\treturn undefined;\\n\\t}\\n\\n\\treturn {\\n\\t\\tenabled: settings.enabled,\\n\\t\\tisActive: isActive(room, settings),\\n\\t\\tfilesOnly: extractFilesOnly(room, settings),\\n\\t\\texcludePinned: extractExcludePinned(room, settings),\\n\\t\\tignoreThreads: extractIgnoreThreads(room, settings),\\n\\t\\tmaxAge: getMaxAge(room, settings),\\n\\t};\\n};\\n\",null],\"names\":[\"useSetting\",\"TIMEUNIT\",\"isValidTimespan\",\"timeUnitToMs\",\"module\",\"export\",\"useRetentionPolicy\",\"link\",\"v\",\"hasRetentionPolicy\",\"room\",\"undefined\",\"retention\",\"isRetentionOverridden\",\"overrideGlobal\",\"isActive\",\"_ref\",\"enabled\",\"appliesToChannels\",\"appliesToGroups\",\"appliesToDMs\",\"t\",\"extractFilesOnly\",\"_ref2\",\"filesOnly\",\"extractExcludePinned\",\"_ref3\",\"doNotPrunePinned\",\"excludePinned\",\"extractIgnoreThreads\",\"_ref4\",\"ignoreThreads\",\"getMaxAge\",\"_ref5\",\"maxAgeChannels\",\"maxAgeGroups\",\"maxAgeDMs\",\"maxAge\",\"days\",\"Infinity\",\"settings\"],\"mappings\":\"2BACsDA,EAAAC,EAAAC,EAAAC,EAAtDC,EAAOC,MAAE,CAAA,CAAAC,mBAAkBA,IAAAA,CAA2B,GAAAF,EAAAG,IAAA,CAAA,2BAAA,CAAAP,WAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,+BAAA,CAAAN,SAAAO,CAAA,EAAAP,EAAAO,CAAA,EAAAN,gBAAAM,CAAA,EAAAN,EAAAM,CAAA,EAAAL,aAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAItD,IAAMC,EAAsBC,GAC3B,cAAeA,GAAQA,AAAmBC,KAAAA,IAAnBD,EAAKE,SAAS,CAEhCC,EAAyBH,GAAsC,mBAAoBA,EAAKE,SAAS,EAAIF,EAAKE,SAAS,CAACE,cAAc,CAelIC,EAAWA,CAACL,EAAWM,KAAqG,GAAnG,CAAEC,QAAAA,CAAO,CAAEC,kBAAAA,CAAiB,CAAEC,gBAAAA,CAAe,CAAEC,aAAAA,CAAAA,CAAuC,CAAAJ,EACpH,GAAI,CAACC,EACJ,MAAO,CAAA,EAGR,GAAIR,EAAmBC,IAASA,AAA2BC,KAAAA,IAA3BD,EAAKE,SAAS,CAACK,OAAO,CACrD,OAAOP,EAAKE,SAAS,CAACK,OAAO,CAG9B,OAAQP,EAAKW,CAAC,EACb,IAAK,IACJ,OAAOH,CACR,KAAK,IACJ,OAAOC,CACR,KAAK,IACJ,OAAOC,CACT,CAEA,MAAO,CAAA,CACR,EAEME,EAAmBA,CAACZ,EAAWa,KAAqD,GAAnD,CAAEC,UAAAA,CAAAA,CAAoC,CAAAD,SAC5E,AAAId,EAAmBC,IAASG,EAAsBH,GAC9CA,EAAKE,SAAS,CAACY,SAAS,CAGzBA,CACR,EAEMC,EAAuBA,CAACf,EAAWgB,KAA4D,GAA1D,CAAEC,iBAAAA,CAAAA,CAA2C,CAAAD,SACvF,AAAIjB,EAAmBC,IAASG,EAAsBH,GAC9CA,EAAKE,SAAS,CAACgB,aAAa,CAG7BD,CACR,EAEME,EAAuBA,CAACnB,EAAWoB,KAAyD,GAAvD,CAAEC,cAAAA,CAAAA,CAAwC,CAAAD,SACpF,AAAIrB,EAAmBC,IAASG,EAAsBH,GAC9CA,EAAKE,SAAS,CAACmB,aAAa,CAG7BA,CACR,EAEMC,EAAYA,CAACtB,EAAWuB,KAAkF,GAAhF,CAAEC,eAAAA,CAAc,CAAEC,aAAAA,CAAY,CAAEC,UAAAA,CAAAA,CAAoC,CAAAH,SACnG,AAAIxB,EAAmBC,IAASG,EAAsBH,IAASR,EAAgBQ,EAAKE,SAAS,CAACyB,MAAM,EAC5FlC,EAAaF,EAASqC,IAAI,CAAE5B,EAAKE,SAAS,CAACyB,MAAM,EAGrD3B,AAAW,MAAXA,EAAKW,CAAC,CACFa,EAEJxB,AAAW,MAAXA,EAAKW,CAAC,CACFc,EAEJzB,AAAW,MAAXA,EAAKW,CAAC,CACFe,EAGD,CAACG,GACT,EAEajC,EACZI,IAWA,IAAM8B,EAAW,CAChBvB,QAASjB,EAAW,2BACpBwB,UAAWxB,EAAW,6BACtB2B,iBAAkB3B,EAAW,oCAC7B+B,cAAe/B,EAAW,qCAC1BkB,kBAAmBlB,EAAW,qCAC9BkC,eAAgBlC,EAAW,gCAC3BmB,gBAAiBnB,EAAW,mCAC5BmC,aAAcnC,EAAW,8BACzBoB,aAAcpB,EAAW,gCACzBoC,UAAWpC,EAAW,4BAGvB,GAAKU,EAIL,MAAO,CACNO,QAASuB,EAASvB,OAAO,CACzBF,SAAUA,EAASL,EAAM8B,GACzBhB,UAAWF,EAAiBZ,EAAM8B,GAClCZ,cAAeH,EAAqBf,EAAM8B,GAC1CT,cAAeF,EAAqBnB,EAAM8B,GAC1CH,OAAQL,EAAUtB,EAAM8B,GAE1B\"}"}