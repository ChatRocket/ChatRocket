{"code":"function module(n,e,t){var i,r,o,l,u,s,a,c,m,f;function d(n){var e=o({},(r(n),n));if(e.msg){var t,d=a(l(e.msg));if(!e.channels&&!e.mentions)return d;var p=u.userId(),k=p&&(null===(t=m.findOne(p,{fields:{username:1}}))||void 0===t?void 0:t.username)||\"\",g=f.get(\"UTF8_User_Names_Validation\"),b=f.get(\"UI_Use_Real_Name\"),h=new c({pattern:function(){return g},useRealName:function(){return b},me:function(){return k},userTemplate:function(n){return\"<strong> \"+n.label+\" </strong>\"},roomTemplate:function(n){return n.prefix+\"<strong> \"+n.mention+\" </strong>\"}}),v=s(d);return h.parse(i(i({},e),{},{msg:d,html:v})).html}if(e.attachments){var T=e.attachments.find(function(n){return n.title||n.description});if(null!=T&&T.description)return l(T.description);if(null!=T&&T.title)return l(T.title)}}t.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(n){i=n}},0),t.link(\"@babel/runtime/helpers/objectDestructuringEmpty\",{default:function(n){r=n}},1),t.link(\"@babel/runtime/helpers/extends\",{default:function(n){o=n}},2),t.export({normalizeThreadTitle:function(){return d}}),t.link(\"@rocket.chat/string-helpers\",{escapeHTML:function(n){l=n}},0),t.link(\"meteor/meteor\",{Meteor:function(n){u=n}},1),t.link(\"../../../emoji/client/emojiParser\",{emojiParser:function(n){s=n}},2),t.link(\"../../../markdown/lib/markdown\",{filterMarkdown:function(n){a=n}},3),t.link(\"../../../mentions/lib/MentionsParser\",{MentionsParser:function(n){c=n}},4),t.link(\"../../../models/client\",{Users:function(n){m=n}},5),t.link(\"../../../settings/client\",{settings:function(n){f=n}},6)}","map":"{\"version\":3,\"sources\":[\"app/threads/client/lib/normalizeThreadTitle.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IMessage } from '@rocket.chat/core-typings';\\nimport { escapeHTML } from '@rocket.chat/string-helpers';\\nimport { Meteor } from 'meteor/meteor';\\n\\nimport { emojiParser } from '../../../emoji/client/emojiParser';\\nimport { filterMarkdown } from '../../../markdown/lib/markdown';\\nimport { MentionsParser } from '../../../mentions/lib/MentionsParser';\\nimport { Users } from '../../../models/client';\\nimport { settings } from '../../../settings/client';\\n\\nexport function normalizeThreadTitle({ ...message }: Readonly<IMessage>) {\\n\\tif (message.msg) {\\n\\t\\tconst filteredMessage = filterMarkdown(escapeHTML(message.msg));\\n\\t\\tif (!message.channels && !message.mentions) {\\n\\t\\t\\treturn filteredMessage;\\n\\t\\t}\\n\\t\\tconst uid = Meteor.userId();\\n\\t\\tconst me = (uid && Users.findOne(uid, { fields: { username: 1 } })?.username) || '';\\n\\t\\tconst pattern = settings.get('UTF8_User_Names_Validation');\\n\\t\\tconst useRealName = settings.get('UI_Use_Real_Name');\\n\\n\\t\\tconst instance = new MentionsParser({\\n\\t\\t\\tpattern: () => pattern,\\n\\t\\t\\tuseRealName: () => useRealName,\\n\\t\\t\\tme: () => me,\\n\\t\\t\\tuserTemplate: ({ label }) => `<strong> ${label} </strong>`,\\n\\t\\t\\troomTemplate: ({ prefix, mention }) => `${prefix}<strong> ${mention} </strong>`,\\n\\t\\t});\\n\\t\\tconst html = emojiParser(filteredMessage);\\n\\t\\treturn instance.parse({ ...message, msg: filteredMessage, html }).html;\\n\\t}\\n\\n\\tif (message.attachments) {\\n\\t\\tconst attachment = message.attachments.find((attachment) => attachment.title || attachment.description);\\n\\n\\t\\tif (attachment?.description) {\\n\\t\\t\\treturn escapeHTML(attachment.description);\\n\\t\\t}\\n\\n\\t\\tif (attachment?.title) {\\n\\t\\t\\treturn escapeHTML(attachment.title);\\n\\t\\t}\\n\\t}\\n}\\n\",null],\"names\":[\"_objectSpread\",\"_objectDestructuringEmpty\",\"_extends\",\"escapeHTML\",\"Meteor\",\"emojiParser\",\"filterMarkdown\",\"MentionsParser\",\"Users\",\"settings\",\"normalizeThreadTitle\",\"_ref\",\"message\",\"msg\",\"_Users$findOne\",\"filteredMessage\",\"channels\",\"mentions\",\"uid\",\"userId\",\"me\",\"findOne\",\"fields\",\"username\",\"pattern\",\"get\",\"useRealName\",\"instance\",\"userTemplate\",\"_ref2\",\"label\",\"roomTemplate\",\"_ref3\",\"prefix\",\"mention\",\"html\",\"parse\",\"attachments\",\"attachment\",\"find\",\"title\",\"description\",\"module\",\"link\",\"default\",\"v\",\"export\"],\"mappings\":\"2BACAA,EAAyDC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EASnD,SAAUC,EAAoBC,CAAA,EAAmC,IAA7BC,EAAOV,EAAA,CAAA,EAAAD,CAAAA,EAAAU,GAAAA,CAAAA,GAChD,GAAIC,EAAQC,GAAG,CAAE,CAChB,IADgBC,EACVC,EAAkBT,EAAeH,EAAWS,EAAQC,GAAG,GAC7D,GAAI,CAACD,EAAQI,QAAQ,EAAI,CAACJ,EAAQK,QAAQ,CACzC,OAAOF,EAER,IAAMG,EAAMd,EAAOe,MAAM,GACnBC,EAAMF,GAAG,CAAA,AAAmD,OAAnDJ,CAAAA,EAAIN,EAAMa,OAAO,CAACH,EAAK,CAAEI,OAAQ,CAAEC,SAAU,CAAC,CAAE,EAAE,GAACT,AAAA,KAAA,IAAAA,EAAA,KAAA,EAA/CA,EAAiDS,QAAQ,AAARA,GAAa,GAC3EC,EAAUf,EAASgB,GAAG,CAAC,8BACvBC,EAAcjB,EAASgB,GAAG,CAAC,oBAE3BE,EAAW,IAAIpB,EAAe,CACnCiB,QAAS,WAAA,OAAMA,CAAO,EACtBE,YAAa,WAAA,OAAMA,CAAW,EAC9BN,GAAI,WAAA,OAAMA,CAAE,EACZQ,aAAc,SAAAC,CAAA,EAAQ,MAAA,YAAAA,EAALC,KAAK,CAAwB,YAAA,EAC9CC,aAAc,SAAAC,CAAA,EAAkB,OAAUC,AAAnBD,EAANC,MAAM,CAAyB,YAAhBD,EAAPE,OAAO,CAAmC,YAAA,IAE9DC,EAAO9B,EAAYU,GACzB,OAAOY,EAASS,KAAK,CAAApC,EAAAA,EAAA,CAAA,EAAMY,GAAO,CAAA,EAAA,CAAEC,IAAKE,EAAiBoB,KAAAA,CAAI,IAAIA,IAAI,AACvE,CAEA,GAAIvB,EAAQyB,WAAW,CAAE,CACxB,IAAMC,EAAa1B,EAAQyB,WAAW,CAACE,IAAI,CAAC,SAACD,CAAU,EAAA,OAAKA,EAAWE,KAAK,EAAIF,EAAWG,WAAW,GAEtG,GAAIH,MAAAA,GAAAA,EAAYG,WAAW,CAC1B,OAAOtC,EAAWmC,EAAWG,WAAW,EAGzC,GAAIH,MAAAA,GAAAA,EAAYE,KAAK,CACpB,OAAOrC,EAAWmC,EAAWE,KAAK,CAEpC,CACD,CA1CSE,EAAYC,IAAM,CAAA,uCAA8B,CAAAC,QAAA,SAAAC,CAAA,EAAA7C,EAAA6C,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,kDAAA,CAAAC,QAAA,SAAAC,CAAA,EAAA5C,EAAA4C,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,iCAAA,CAAAC,QAAA,SAAAC,CAAA,EAAA3C,EAAA2C,CAAA,CAAA,EAAA,GAAzDH,EAAOI,MAAE,CAAA,CAAApC,qBAAkB,WAAA,OAAAA,CAA8B,CAAA,GAAAgC,EAAAC,IAAA,CAAA,8BAAA,CAAAxC,WAAA,SAAA0C,CAAA,EAAA1C,EAAA0C,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,gBAAA,CAAAvC,OAAA,SAAAyC,CAAA,EAAAzC,EAAAyC,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,oCAAA,CAAAtC,YAAA,SAAAwC,CAAA,EAAAxC,EAAAwC,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,iCAAA,CAAArC,eAAA,SAAAuC,CAAA,EAAAvC,EAAAuC,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,uCAAA,CAAApC,eAAA,SAAAsC,CAAA,EAAAtC,EAAAsC,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,yBAAA,CAAAnC,MAAA,SAAAqC,CAAA,EAAArC,EAAAqC,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,2BAAA,CAAAlC,SAAA,SAAAoC,CAAA,EAAApC,EAAAoC,CAAA,CAAA,EAAA\"}"}