{"code":"function module(e,t,r){let a;r.link(\"@babel/runtime/helpers/objectSpread2\",{default(e){a=e}},0),r.export({storeQueryFunction:()=>n});let i=e=>e.sort((e,t)=>e.name.toLowerCase()>t.name.toLowerCase()?1:-1);function n(e,t){if(!e.isFetched&&!t.isFetched)throw Error(\"Apps not loaded\");let r=[],n=[],s=[],o=[...t.data||[]];return i(e.data||[]).forEach(e=>{let t=o.findIndex(t=>{let{id:r}=t;return r===e.id}),[i]=t>-1?o.splice(t,1):[],d=a(a(a({},e),i&&{private:i.private,installed:!0,status:i.status,version:i.version,licenseValidation:i.licenseValidation,migrated:i.migrated}),{},{bundledIn:e.bundledIn,marketplaceVersion:e.version});i&&(i.private?s.push(d):n.push(d)),r.push(d)}),i(o).forEach(e=>{if(e.private){s.push(e);return}n.push(e)}),[r,n,s]}}","map":"{\"version\":3,\"sources\":[\"client/providers/AppsProvider/storeQueryFunction.ts\",\"<anon>\"],\"sourcesContent\":[\"import { type UseQueryResult } from '@tanstack/react-query';\\n\\nimport type { App } from '../../views/marketplace/types';\\n\\nconst sortByName = (apps: App[]): App[] => apps.sort((a, b) => (a.name.toLowerCase() > b.name.toLowerCase() ? 1 : -1));\\n\\n/**\\n * Aggregates result data from marketplace request and instance installed into their appropriate lists\\n *\\n * Exporting for better testing\\n */\\nexport function storeQueryFunction(\\n\\tmarketplace: UseQueryResult<App[], unknown>,\\n\\tinstance: UseQueryResult<App[], unknown>,\\n): [App[], App[], App[]] {\\n\\tif (!marketplace.isFetched && !instance.isFetched) {\\n\\t\\tthrow new Error('Apps not loaded');\\n\\t}\\n\\n\\tconst marketplaceApps: App[] = [];\\n\\tconst installedApps: App[] = [];\\n\\tconst privateApps: App[] = [];\\n\\tconst clonedData = [...(instance.data || [])];\\n\\n\\tsortByName(marketplace.data || []).forEach((app) => {\\n\\t\\tconst appIndex = clonedData.findIndex(({ id }) => id === app.id);\\n\\t\\tconst [installedApp] = appIndex > -1 ? clonedData.splice(appIndex, 1) : [];\\n\\n\\t\\tconst record = {\\n\\t\\t\\t...app,\\n\\t\\t\\t...(installedApp && {\\n\\t\\t\\t\\tprivate: installedApp.private,\\n\\t\\t\\t\\tinstalled: true,\\n\\t\\t\\t\\tstatus: installedApp.status,\\n\\t\\t\\t\\tversion: installedApp.version,\\n\\t\\t\\t\\tlicenseValidation: installedApp.licenseValidation,\\n\\t\\t\\t\\tmigrated: installedApp.migrated,\\n\\t\\t\\t}),\\n\\t\\t\\tbundledIn: app.bundledIn,\\n\\t\\t\\tmarketplaceVersion: app.version,\\n\\t\\t};\\n\\n\\t\\tif (installedApp) {\\n\\t\\t\\tif (installedApp.private) {\\n\\t\\t\\t\\tprivateApps.push(record);\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tinstalledApps.push(record);\\n\\t\\t\\t}\\n\\t\\t}\\n\\n\\t\\tmarketplaceApps.push(record);\\n\\t});\\n\\n\\tsortByName(clonedData).forEach((app) => {\\n\\t\\tif (app.private) {\\n\\t\\t\\tprivateApps.push(app);\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tinstalledApps.push(app);\\n\\t});\\n\\n\\treturn [marketplaceApps, installedApps, privateApps];\\n}\\n\",null],\"names\":[\"_objectSpread\",\"module\",\"link\",\"default\",\"v\",\"export\",\"storeQueryFunction\",\"sortByName\",\"apps\",\"sort\",\"a\",\"b\",\"name\",\"toLowerCase\",\"marketplace\",\"instance\",\"isFetched\",\"Error\",\"marketplaceApps\",\"installedApps\",\"privateApps\",\"clonedData\",\"data\",\"forEach\",\"app\",\"appIndex\",\"findIndex\",\"_ref\",\"id\",\"installedApp\",\"splice\",\"record\",\"private\",\"installed\",\"status\",\"version\",\"licenseValidation\",\"migrated\",\"bundledIn\",\"marketplaceVersion\",\"push\"],\"mappings\":\"2BAIAA,EAAgBC,EAAeC,IAAY,CAAA,uCAAuC,CAAEC,QAAKC,CAAI,EAACJ,EAAeI,CAAC,CAAC,EAAE,GAAjHH,EAAMI,MAAA,CAAA,CAAAC,mBAA0CA,IAAIA,CAAkB,GAAtE,IAAMC,EAAcC,GAAuBA,EAAKC,IAAI,CAAC,CAACC,EAAGC,IAAOD,EAAEE,IAAI,CAACC,WAAW,GAAKF,EAAEC,IAAI,CAACC,WAAW,GAAK,EAAI,IAO5G,SAAUP,EACfQ,CAA2C,CAC3CC,CAAwC,EAExC,GAAI,CAACD,EAAYE,SAAS,EAAI,CAACD,EAASC,SAAS,CAChD,MAAM,AAAIC,MAAM,mBAGjB,IAAMC,EAAyB,EAAE,CAC3BC,EAAuB,EAAE,CACzBC,EAAqB,EAAE,CACvBC,EAAa,IAAKN,EAASO,IAAI,EAAI,EAAE,CAAE,CAwC7C,OAtCAf,EAAWO,EAAYQ,IAAI,EAAI,EAAE,EAAEC,OAAO,CAAEC,IAC3C,IAAMC,EAAWJ,EAAWK,SAAS,CAACC,IAAA,GAAC,CAAEC,GAAAA,CAAAA,CAAI,CAAAD,EAAA,OAAKC,IAAOJ,EAAII,EAAE,GACzD,CAACC,EAAa,CAAGJ,EAAW,GAAKJ,EAAWS,MAAM,CAACL,EAAU,GAAK,EAAE,CAEpEM,EAAM/B,EAAAA,EAAAA,EAAA,CAAA,EACRwB,GACCK,GAAgB,CACnBG,QAASH,EAAaG,OAAO,CAC7BC,UAAW,CAAA,EACXC,OAAQL,EAAaK,MAAM,CAC3BC,QAASN,EAAaM,OAAO,CAC7BC,kBAAmBP,EAAaO,iBAAiB,CACjDC,SAAUR,EAAaQ,QAAAA,GACvB,CAAA,EAAA,CACDC,UAAWd,EAAIc,SAAS,CACxBC,mBAAoBf,EAAIW,OAAAA,AAAO,GAG5BN,IACCA,EAAaG,OAAO,CACvBZ,EAAYoB,IAAI,CAACT,GAEjBZ,EAAcqB,IAAI,CAACT,IAIrBb,EAAgBsB,IAAI,CAACT,EACtB,GAEAxB,EAAWc,GAAYE,OAAO,CAAEC,IAC/B,GAAIA,EAAIQ,OAAO,CAAE,CAChBZ,EAAYoB,IAAI,CAAChB,GACjB,MACD,CAEAL,EAAcqB,IAAI,CAAChB,EACpB,GAEO,CAACN,EAAiBC,EAAeC,EAAY,AACrD\"}"}