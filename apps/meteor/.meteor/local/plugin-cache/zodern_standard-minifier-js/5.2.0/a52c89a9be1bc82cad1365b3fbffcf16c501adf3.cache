{"code":"function module(e,r,t){let u,i,n,a,l;t.link(\"@babel/runtime/helpers/objectSpread2\",{default(e){u=e}},0),t.export({useReactiveQuery:()=>s}),t.link(\"@tanstack/react-query\",{useQuery(e){i=e},useQueryClient(e){n=e}},0),t.link(\"meteor/tracker\",{Tracker(e){a=e}},1),t.link(\"../lib/utils/queueMicrotask\",{queueMicrotask(e){l=e}},2);let s=(e,r,t)=>{let s=n();return i(e,()=>new Promise((t,u)=>{l(()=>{a.autorun(i=>{let n=r();if(i.firstRun){void 0===n?u(Error(\"Reactive query returned undefined\")):t(n);return}s.invalidateQueries(e,{exact:!0}),i.stop()})})}),u({staleTime:1/0},t))}}","map":"{\"version\":3,\"sources\":[\"client/hooks/useReactiveQuery.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { UseQueryOptions, QueryKey, UseQueryResult } from '@tanstack/react-query';\\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\\nimport { Tracker } from 'meteor/tracker';\\n\\nimport { queueMicrotask } from '../lib/utils/queueMicrotask';\\n\\nexport const useReactiveQuery = <TQueryFnData, TData = TQueryFnData, TQueryKey extends QueryKey = QueryKey>(\\n\\tqueryKey: TQueryKey,\\n\\treactiveQueryFn: () => TQueryFnData,\\n\\toptions?: UseQueryOptions<TQueryFnData, Error, TData, TQueryKey>,\\n): UseQueryResult<TData, Error> => {\\n\\tconst queryClient = useQueryClient();\\n\\n\\treturn useQuery(\\n\\t\\tqueryKey,\\n\\t\\t(): Promise<TQueryFnData> =>\\n\\t\\t\\tnew Promise((resolve, reject) => {\\n\\t\\t\\t\\tqueueMicrotask(() => {\\n\\t\\t\\t\\t\\tTracker.autorun((c) => {\\n\\t\\t\\t\\t\\t\\tconst data = reactiveQueryFn();\\n\\n\\t\\t\\t\\t\\t\\tif (c.firstRun) {\\n\\t\\t\\t\\t\\t\\t\\tif (data === undefined) {\\n\\t\\t\\t\\t\\t\\t\\t\\treject(new Error('Reactive query returned undefined'));\\n\\t\\t\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\t\\t\\tresolve(data);\\n\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\t\\tqueryClient.invalidateQueries(queryKey, { exact: true });\\n\\t\\t\\t\\t\\t\\tc.stop();\\n\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t});\\n\\t\\t\\t}),\\n\\t\\t{ staleTime: Infinity, ...options },\\n\\t);\\n};\\n\",null],\"names\":[\"_objectSpread\",\"useQuery\",\"useQueryClient\",\"Tracker\",\"queueMicrotask\",\"module\",\"link\",\"default\",\"v\",\"export\",\"useReactiveQuery\",\"queryKey\",\"reactiveQueryFn\",\"options\",\"queryClient\",\"Promise\",\"resolve\",\"reject\",\"autorun\",\"c\",\"data\",\"firstRun\",\"undefined\",\"Error\",\"invalidateQueries\",\"exact\",\"stop\",\"staleTime\",\"Infinity\"],\"mappings\":\"2BACAA,EAAyCC,EAAwBC,EAAAC,EAAAC,EAAhDC,EAAEC,IAAA,CAAA,uCAA8C,CAAAC,QAAAC,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAjEH,EAAOI,MAAE,CAAA,CAAAC,iBAAUA,IAAgBA,CAAM,GAAwBL,EAAAC,IAAA,CAAA,wBAAA,CAAAL,SAAAO,CAAA,EAAAP,EAAAO,CAAA,EAAAN,eAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,iBAAA,CAAAH,QAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,8BAAA,CAAAF,eAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAK1D,IAAME,EAAmBA,CAC/BC,EACAC,EACAC,KAEA,IAAMC,EAAcZ,IAEpB,OAAOD,EACNU,EACA,IACC,IAAII,QAAQ,CAACC,EAASC,KACrBb,EAAe,KACdD,EAAQe,OAAO,CAAEC,IAChB,IAAMC,EAAOR,IAEb,GAAIO,EAAEE,QAAQ,CAAE,CACXD,AAASE,KAAAA,IAATF,EACHH,EAAO,AAAIM,MAAM,sCAEjBP,EAAQI,GAET,MACD,CAEAN,EAAYU,iBAAiB,CAACb,EAAU,CAAEc,MAAO,CAAA,CAAI,GACrDN,EAAEO,IAAI,EACP,EACD,EACD,GAAE1B,EAAA,CACD2B,UAAWC,GAAQ,EAAKf,GAE5B\"}"}