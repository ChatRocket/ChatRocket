{"code":"function module(e,t,u){let n,o,s,l,r,i,a,c;u.export({useRouteLock:()=>d}),u.link(\"@rocket.chat/fuselage-hooks\",{useDebouncedValue(e){n=e}},0),u.link(\"@rocket.chat/ui-contexts\",{useUserId(e){o=e},useUser(e){s=e},useSetting(e){l=e},useRole(e){r=e},useRouter(e){i=e}},1),u.link(\"react\",{useEffect(e){a=e},useState(e){c=e}},2);let d=()=>{let[e,t]=c(!0),u=l(\"Show_Setup_Wizard\"),d=o(),k=n(s(),100),f=r(\"admin\"),h=i();return a(()=>{if(!u||d&&!(null!=k&&k.status))return;let n=\"completed\"===u,o=e&&!k&&\"pending\"!==u,s=!!k&&!f;if(n||o||s){h.navigate(\"/home\");return}t(!1)},[h,u,d,k,f,e]),e}}","map":"{\"version\":3,\"sources\":[\"client/views/setupWizard/hooks/useRouteLock.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useDebouncedValue } from '@rocket.chat/fuselage-hooks';\\nimport { useUserId, useUser, useSetting, useRole, useRouter } from '@rocket.chat/ui-contexts';\\nimport { useEffect, useState } from 'react';\\n\\nexport const useRouteLock = (): boolean => {\\n\\tconst [locked, setLocked] = useState(true);\\n\\tconst setupWizardState = useSetting('Show_Setup_Wizard');\\n\\tconst userId = useUserId();\\n\\tconst user = useDebouncedValue(useUser(), 100);\\n\\tconst hasAdminRole = useRole('admin');\\n\\tconst router = useRouter();\\n\\n\\tuseEffect(() => {\\n\\t\\tif (!setupWizardState) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tif (userId && !user?.status) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tconst isComplete = setupWizardState === 'completed';\\n\\t\\tconst noUserLoggedInAndIsNotPending = locked && !user && setupWizardState !== 'pending';\\n\\t\\tconst userIsLoggedInButIsNotAdmin = !!user && !hasAdminRole;\\n\\n\\t\\tconst mustRedirect = isComplete || noUserLoggedInAndIsNotPending || userIsLoggedInButIsNotAdmin;\\n\\n\\t\\tif (mustRedirect) {\\n\\t\\t\\trouter.navigate('/home');\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tsetLocked(false);\\n\\t}, [router, setupWizardState, userId, user, hasAdminRole, locked]);\\n\\n\\treturn locked;\\n};\\n\",null],\"names\":[\"useDebouncedValue\",\"useUserId\",\"useUser\",\"useSetting\",\"useRole\",\"useRouter\",\"useEffect\",\"useState\",\"module\",\"export\",\"useRouteLock\",\"link\",\"v\",\"locked\",\"setLocked\",\"setupWizardState\",\"userId\",\"user\",\"hasAdminRole\",\"router\",\"status\",\"isComplete\",\"noUserLoggedInAndIsNotPending\",\"userIsLoggedInButIsNotAdmin\",\"navigate\"],\"mappings\":\"2BAAkCA,EAA8BC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAhEC,EAAOC,MAAE,CAAA,CAAAC,aAAmBA,IAAAA,CAAM,GAA8BF,EAAAG,IAAA,CAAA,8BAAA,CAAAX,kBAAAY,CAAA,EAAAZ,EAAAY,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,2BAAA,CAAAV,UAAAW,CAAA,EAAAX,EAAAW,CAAA,EAAAV,QAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,WAAAS,CAAA,EAAAT,EAAAS,CAAA,EAAAR,QAAAQ,CAAA,EAAAR,EAAAQ,CAAA,EAAAP,UAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,QAAA,CAAAL,UAAAM,CAAA,EAAAN,EAAAM,CAAA,EAAAL,SAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAIzD,IAAMF,EAAeA,KAC3B,GAAM,CAACG,EAAQC,EAAU,CAAGP,EAAS,CAAA,GAC/BQ,EAAmBZ,EAAW,qBAC9Ba,EAASf,IACTgB,EAAOjB,EAAkBE,IAAW,KACpCgB,EAAed,EAAQ,SACvBe,EAASd,IAyBf,OAvBAC,EAAU,KACT,GAAI,CAACS,GAIDC,GAAU,CAACC,CAAAA,MAAAA,GAAAA,EAAMG,MAAM,AAANA,EAHpB,OAOD,IAAMC,EAAaN,AAAqB,cAArBA,EACbO,EAAgCT,GAAU,CAACI,GAAQF,AAAqB,YAArBA,EACnDQ,EAA8B,CAAC,CAACN,GAAQ,CAACC,EAI/C,GAFqBG,GAAcC,GAAiCC,EAElD,CACjBJ,EAAOK,QAAQ,CAAC,SAChB,MACD,CAEAV,EAAU,CAAA,EACX,EAAG,CAACK,EAAQJ,EAAkBC,EAAQC,EAAMC,EAAcL,EAAO,EAE1DA,CACR\"}"}