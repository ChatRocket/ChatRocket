{"code":"function module(t,e,n){\"use strict\";var r=t(\"hash.js\"),i=t(\"../curves\"),o=t(\"../utils\"),s=o.assert,u=o.parseBytes,h=t(\"./key\"),c=t(\"./signature\");function a(t){if(s(\"ed25519\"===t,\"only tested with ed25519 so far\"),!(this instanceof a))return new a(t);t=i[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=r.sha512}n.exports=a,a.prototype.sign=function t(t,e){t=u(t);var n=this.keyFromSecret(e),r=this.hashInt(n.messagePrefix(),t),i=this.g.mul(r),o=this.encodePoint(i),s=this.hashInt(o,n.pubBytes(),t).mul(n.priv()),h=r.add(s).umod(this.curve.n);return this.makeSignature({R:i,S:h,Rencoded:o})},a.prototype.verify=function t(t,e,n){if(t=u(t),(e=this.makeSignature(e)).S().gte(e.eddsa.curve.n)||e.S().isNeg())return!1;var r=this.keyFromPublic(n),i=this.hashInt(e.Rencoded(),r.pubBytes(),t),o=this.g.mul(e.S());return e.R().add(r.pub().mul(i)).eq(o)},a.prototype.hashInt=function t(){for(var t=this.hash(),e=0;e<arguments.length;e++)t.update(arguments[e]);return o.intFromLE(t.digest()).umod(this.curve.n)},a.prototype.keyFromPublic=function t(t){return h.fromPublic(this,t)},a.prototype.keyFromSecret=function t(t){return h.fromSecret(this,t)},a.prototype.makeSignature=function t(t){return t instanceof c?t:new c(this,t)},a.prototype.encodePoint=function t(t){var e=t.getY().toArray(\"le\",this.encodingLength);return e[this.encodingLength-1]|=t.getX().isOdd()?128:0,e},a.prototype.decodePoint=function t(t){var e=(t=o.parseBytes(t)).length-1,n=t.slice(0,e).concat(-129&t[e]),r=(128&t[e])!=0,i=o.intFromLE(n);return this.curve.pointFromY(i,r)},a.prototype.encodeInt=function t(t){return t.toArray(\"le\",this.encodingLength)},a.prototype.decodeInt=function t(t){return o.intFromLE(t)},a.prototype.isPoint=function t(t){return t instanceof this.pointClass}}","map":"{\"version\":3,\"sources\":[\"<anon>\"],\"names\":[],\"mappings\":\"\"}"}