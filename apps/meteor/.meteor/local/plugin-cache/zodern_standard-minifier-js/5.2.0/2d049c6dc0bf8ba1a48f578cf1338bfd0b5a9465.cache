{"code":"function module(r,e,t){\"use strict\";var a=r(\"safe-buffer\").Buffer,n=r(\"create-hmac\"),o=r(\"browserify-rsa\"),u=r(\"elliptic\").ec,i=r(\"bn.js\"),d=r(\"parse-asn1\"),p=r(\"./curves.json\");function c(r,e,t,o){if((r=a.from(r.toArray())).length<e.byteLength()){var u=a.alloc(e.byteLength()-r.length);r=a.concat([u,r])}var i=t.length,d=function(r,e){r=(r=s(r,e)).mod(e);var t=a.from(r.toArray());if(t.length<e.byteLength()){var n=a.alloc(e.byteLength()-t.length);t=a.concat([n,t])}return t}(t,e),p=a.alloc(i);p.fill(1);var c=a.alloc(i);return c=n(o,c).update(p).update(a.from([0])).update(r).update(d).digest(),p=n(o,c).update(p).digest(),c=n(o,c).update(p).update(a.from([1])).update(r).update(d).digest(),p=n(o,c).update(p).digest(),{k:c,v:p}}function s(r,e){var t=new i(r),a=(r.length<<3)-e.bitLength();return a>0&&t.ishrn(a),t}function g(r,e,t){var o,u;do{for(o=a.alloc(0);8*o.length<r.bitLength();)e.v=n(t,e.k).update(e.v).digest(),o=a.concat([o,e.v]);u=s(o,r),e.k=n(t,e.k).update(e.v).update(a.from([0])).digest(),e.v=n(t,e.k).update(e.v).digest()}while(-1!==u.cmp(r));return u}t.exports=function(r,e,t,n,f){var l=d(e);if(l.curve){if(\"ecdsa\"!==n&&\"ecdsa/rsa\"!==n)throw Error(\"wrong private key type\");return function(r,e){var t=p[e.curve.join(\".\")];if(!t)throw Error(\"unknown curve \"+e.curve.join(\".\"));var n=new u(t).keyFromPrivate(e.privateKey).sign(r);return a.from(n.toDER())}(r,l)}if(\"dsa\"===l.type){if(\"dsa\"!==n)throw Error(\"wrong private key type\");return function(r,e,t){for(var n,o,u,d,p,f,l,v,h=e.params.priv_key,m=e.params.p,y=e.params.q,w=e.params.g,k=new i(0),b=s(r,y).mod(y),L=!1,E=c(h,y,r,t);!1===L;)o=v=g(y,E,t),k=w.toRed(i.mont(m)).redPow(o).fromRed().mod(y),0===(L=v.invm(y).imul(b.add(h.mul(k))).mod(y)).cmpn(0)&&(L=!1,k=new i(0));return p=k,f=L,p=p.toArray(),f=f.toArray(),128&p[0]&&(p=[0].concat(p)),128&f[0]&&(f=[0].concat(f)),l=(l=[48,p.length+f.length+4,2,p.length]).concat(p,[2,f.length],f),a.from(l)}(r,l,t)}if(\"rsa\"!==n&&\"ecdsa/rsa\"!==n)throw Error(\"wrong private key type\");if(void 0!==e.padding&&1!==e.padding)throw Error(\"illegal or unsupported padding mode\");r=a.concat([f,r]);for(var v=l.modulus.byteLength(),h=[0,1];r.length+h.length+1<v;)h.push(255);h.push(0);for(var m=-1;++m<r.length;)h.push(r[m]);return o(h,l)},t.exports.getKey=c,t.exports.makeKey=g}","map":"{\"version\":3,\"sources\":[\"<anon>\"],\"names\":[],\"mappings\":\"\"}"}