{"code":"function module(e,t,l){let n,a,i,o,u,s,d,c,r;l.export({useWebDAVMessageAction:()=>g}),l.link(\"@rocket.chat/ui-contexts\",{useSetModal(e){n=e},useSetting(e){a=e}},0),l.link(\"react\",{default(e){i=e},useEffect(e){o=e}},1),l.link(\"../../../../app/ui-utils/client/lib/MessageAction\",{MessageAction(e){u=e}},2),l.link(\"../../../../app/utils/client\",{getURL(e){s=e}},3),l.link(\"../../../hooks/webdav/useWebDAVAccountIntegrationsQuery\",{useWebDAVAccountIntegrationsQuery(e){d=e}},4),l.link(\"../../../lib/utils/messageArgs\",{messageArgs(e){c=e}},5),l.link(\"../../../views/room/webdav/SaveToWebdavModal\",{default(e){r=e}},6);let g=()=>{let e=a(\"Webdav_Integration_Enabled\",!1),{data:t}=d({enabled:e}),l=n();o(()=>{if(e)return u.addButton({id:\"webdav-upload\",icon:\"upload\",label:\"Save_To_Webdav\",condition:e=>{let{message:l,subscription:n}=e;return!!n&&!!(null!=t&&t.length)&&!!l.file},action(e,t){let{message:n=c(this).msg}=t,[a]=n.attachments||[],o=s(a.title_link,{full:!0});l(i.createElement(r,{data:{attachment:a,url:o},onClose:()=>l(void 0)}))},order:100,group:\"menu\"}),()=>{u.removeButton(\"webdav-upload\")}},[null==t?void 0:t.length,e,l])}}","map":"{\"version\":3,\"sources\":[\"client/components/message/toolbar/useWebDAVMessageAction.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { useSetModal, useSetting } from '@rocket.chat/ui-contexts';\\nimport React, { useEffect } from 'react';\\n\\nimport { MessageAction } from '../../../../app/ui-utils/client/lib/MessageAction';\\nimport { getURL } from '../../../../app/utils/client';\\nimport { useWebDAVAccountIntegrationsQuery } from '../../../hooks/webdav/useWebDAVAccountIntegrationsQuery';\\nimport { messageArgs } from '../../../lib/utils/messageArgs';\\nimport SaveToWebdavModal from '../../../views/room/webdav/SaveToWebdavModal';\\n\\nexport const useWebDAVMessageAction = () => {\\n\\tconst enabled = useSetting<boolean>('Webdav_Integration_Enabled', false);\\n\\n\\tconst { data } = useWebDAVAccountIntegrationsQuery({ enabled });\\n\\n\\tconst setModal = useSetModal();\\n\\n\\tuseEffect(() => {\\n\\t\\tif (!enabled) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tMessageAction.addButton({\\n\\t\\t\\tid: 'webdav-upload',\\n\\t\\t\\ticon: 'upload',\\n\\t\\t\\tlabel: 'Save_To_Webdav',\\n\\t\\t\\tcondition: ({ message, subscription }) => {\\n\\t\\t\\t\\treturn !!subscription && !!data?.length && !!message.file;\\n\\t\\t\\t},\\n\\t\\t\\taction(_, props) {\\n\\t\\t\\t\\tconst { message = messageArgs(this).msg } = props;\\n\\t\\t\\t\\tconst [attachment] = message.attachments || [];\\n\\t\\t\\t\\tconst url = getURL(attachment.title_link as string, { full: true });\\n\\n\\t\\t\\t\\tsetModal(<SaveToWebdavModal data={{ attachment, url }} onClose={() => setModal(undefined)} />);\\n\\t\\t\\t},\\n\\t\\t\\torder: 100,\\n\\t\\t\\tgroup: 'menu',\\n\\t\\t});\\n\\n\\t\\treturn () => {\\n\\t\\t\\tMessageAction.removeButton('webdav-upload');\\n\\t\\t};\\n\\t}, [data?.length, enabled, setModal]);\\n};\\n\",null],\"names\":[\"useSetModal\",\"useSetting\",\"React\",\"useEffect\",\"MessageAction\",\"getURL\",\"useWebDAVAccountIntegrationsQuery\",\"messageArgs\",\"SaveToWebdavModal\",\"module\",\"export\",\"useWebDAVMessageAction\",\"link\",\"v\",\"default\",\"enabled\",\"data\",\"setModal\",\"addButton\",\"id\",\"icon\",\"label\",\"condition\",\"_ref\",\"message\",\"subscription\",\"length\",\"file\",\"action\",\"_\",\"props\",\"msg\",\"attachment\",\"attachments\",\"url\",\"title_link\",\"full\",\"createElement\",\"onClose\",\"undefined\",\"order\",\"group\",\"removeButton\"],\"mappings\":\"2BAAmEA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAnEC,EAAOC,MAAE,CAAA,CAAAC,uBAAyBA,IAAMA,CAAA,GAA2BF,EAAAG,IAAA,CAAA,2BAAA,CAAAZ,YAAAa,CAAA,EAAAb,EAAAa,CAAA,EAAAZ,WAAAY,CAAA,EAAAZ,EAAAY,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,QAAA,CAAAE,QAAAD,CAAA,EAAAX,EAAAW,CAAA,EAAAV,UAAAU,CAAA,EAAAV,EAAAU,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,oDAAA,CAAAR,cAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,+BAAA,CAAAP,OAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,0DAAA,CAAAN,kCAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,iCAAA,CAAAL,YAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,+CAAA,CAAAE,QAAAD,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAS5D,IAAMF,EAAyBA,KACrC,IAAMI,EAAUd,EAAoB,6BAA8B,CAAA,GAE5D,CAAEe,KAAAA,CAAAA,CAAM,CAAGV,EAAkC,CAAES,QAAAA,CAAO,GAEtDE,EAAWjB,IAEjBG,EAAU,KACT,GAAKY,EAsBL,OAlBAX,EAAcc,SAAS,CAAC,CACvBC,GAAI,gBACJC,KAAM,SACNC,MAAO,iBACPC,UAAWC,IAA8B,GAA7B,CAAEC,QAAAA,CAAO,CAAEC,aAAAA,CAAAA,CAAc,CAAAF,EACpC,MAAO,CAAC,CAACE,GAAgB,CAAC,CAACT,CAAAA,MAAAA,GAAAA,EAAMU,MAAM,AAANA,GAAU,CAAC,CAACF,EAAQG,IAAI,AAC1D,EACAC,OAAOC,CAAC,CAAEC,CAAK,EACd,GAAM,CAAEN,QAAAA,EAAUjB,EAAY,IAAI,EAAEwB,GAAAA,CAAK,CAAGD,EACtC,CAACE,EAAW,CAAGR,EAAQS,WAAW,EAAI,EAAE,CACxCC,EAAM7B,EAAO2B,EAAWG,UAAoB,CAAE,CAAEC,KAAM,CAAA,CAAI,GAEhEnB,EAASf,EAAAmC,aAAA,CAAC7B,EAAiB,CAACQ,KAAM,CAAEgB,WAAAA,EAAYE,IAAAA,CAAG,EAAII,QAASA,IAAMrB,EAASsB,KAAAA,EAAW,GAC3F,EACAC,MAAO,IACPC,MAAO,SAGD,KACNrC,EAAcsC,YAAY,CAAC,gBAC5B,CACD,EAAG,CAAC1B,MAAAA,EAAI,KAAA,EAAJA,EAAMU,MAAM,CAAEX,EAASE,EAAS,CACrC\"}"}