{"code":"function module(e,t,s){let i,l,o,a,n,r,u;s.link(\"@babel/runtime/helpers/objectSpread2\",{default(e){i=e}},0),s.export({useHistoryMessageList:()=>c}),s.link(\"@rocket.chat/ui-contexts\",{useEndpoint(e){l=e}},0),s.link(\"react\",{useCallback(e){o=e},useState(e){a=e}},1),s.link(\"../../../../hooks/lists/useScrollableMessageList\",{useScrollableMessageList(e){n=e}},2),s.link(\"../../../../hooks/useComponentDidUpdate\",{useComponentDidUpdate(e){r=e}},3),s.link(\"../../../../lib/lists/MessageList\",{MessageList(e){u=e}},4);let c=e=>{let[t,s]=a(()=>new u),c=o(()=>s(new u),[]),d=l(\"GET\",\"/v1/livechat/:rid/messages\",{rid:e.roomId});r(()=>{e&&c()},[e,c]);let k=o(async(t,s)=>{let{messages:l,total:o}=await d(i(i({},e.filter&&{searchTerm:e.filter}),{},{offset:t,count:s,sort:'{ \"ts\": 1 }'}));return{items:l,itemCount:o}},[d,e.filter]),{loadMoreItems:m,initialItemCount:p}=n(t,k,25);return{itemsList:t,loadMoreItems:m,initialItemCount:p}}}","map":"{\"version\":3,\"sources\":[\"client/views/omnichannel/contactHistory/MessageList/useHistoryMessageList.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useCallback, useState } from 'react';\\n\\nimport { useScrollableMessageList } from '../../../../hooks/lists/useScrollableMessageList';\\nimport { useComponentDidUpdate } from '../../../../hooks/useComponentDidUpdate';\\nimport { MessageList } from '../../../../lib/lists/MessageList';\\n\\ntype HistoryMessageListOptions = {\\n\\tfilter: string;\\n\\troomId: string;\\n};\\n\\nexport const useHistoryMessageList = (\\n\\toptions: HistoryMessageListOptions,\\n): {\\n\\titemsList: MessageList;\\n\\tinitialItemCount: number;\\n\\tloadMoreItems: (start: number, end: number) => void;\\n} => {\\n\\tconst [itemsList, setItemsList] = useState(() => new MessageList());\\n\\tconst reload = useCallback(() => setItemsList(new MessageList()), []);\\n\\n\\tconst getMessages = useEndpoint('GET', '/v1/livechat/:rid/messages', { rid: options.roomId });\\n\\n\\tuseComponentDidUpdate(() => {\\n\\t\\toptions && reload();\\n\\t}, [options, reload]);\\n\\n\\tconst fetchMessages = useCallback(\\n\\t\\tasync (start, end) => {\\n\\t\\t\\tconst { messages, total } = await getMessages({\\n\\t\\t\\t\\t...(options.filter && { searchTerm: options.filter }),\\n\\t\\t\\t\\toffset: start,\\n\\t\\t\\t\\tcount: end,\\n\\t\\t\\t\\tsort: `{ \\\"ts\\\": 1 }`,\\n\\t\\t\\t});\\n\\t\\t\\treturn {\\n\\t\\t\\t\\titems: messages,\\n\\t\\t\\t\\titemCount: total,\\n\\t\\t\\t};\\n\\t\\t},\\n\\t\\t[getMessages, options.filter],\\n\\t);\\n\\n\\tconst { loadMoreItems, initialItemCount } = useScrollableMessageList(itemsList, fetchMessages, 25);\\n\\n\\treturn {\\n\\t\\titemsList,\\n\\t\\tloadMoreItems,\\n\\t\\tinitialItemCount,\\n\\t};\\n};\\n\",null],\"names\":[\"_objectSpread\",\"useEndpoint\",\"useCallback\",\"useState\",\"useScrollableMessageList\",\"useComponentDidUpdate\",\"MessageList\",\"module\",\"link\",\"default\",\"v\",\"export\",\"useHistoryMessageList\",\"options\",\"itemsList\",\"setItemsList\",\"reload\",\"getMessages\",\"rid\",\"roomId\",\"fetchMessages\",\"start\",\"end\",\"messages\",\"total\",\"filter\",\"searchTerm\",\"offset\",\"count\",\"sort\",\"items\",\"itemCount\",\"loadMoreItems\",\"initialItemCount\"],\"mappings\":\"2BAAAA,EAAuDC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9CC,EAAaC,IAAM,CAAA,uCAA2B,CAAAC,QAAAC,CAAA,EAAAV,EAAAU,CAAA,CAAA,EAAA,GAAvDH,EAAOI,MAAE,CAAA,CAAAC,sBAAmBA,IAAAA,CAA2B,GAAAL,EAAAC,IAAA,CAAA,2BAAA,CAAAP,YAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,QAAA,CAAAN,YAAAQ,CAAA,EAAAR,EAAAQ,CAAA,EAAAP,SAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,mDAAA,CAAAJ,yBAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,0CAAA,CAAAH,sBAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,oCAAA,CAAAF,YAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAYhD,IAAME,EACZC,IAMA,GAAM,CAACC,EAAWC,EAAa,CAAGZ,EAAS,IAAM,IAAIG,GAC/CU,EAASd,EAAY,IAAMa,EAAa,IAAIT,GAAgB,EAAE,EAE9DW,EAAchB,EAAY,MAAO,6BAA8B,CAAEiB,IAAKL,EAAQM,MAAAA,AAAM,GAE1Fd,EAAsB,KACrBQ,GAAWG,GACZ,EAAG,CAACH,EAASG,EAAO,EAEpB,IAAMI,EAAgBlB,EACrB,MAAOmB,EAAOC,KACb,GAAM,CAAEC,SAAAA,CAAQ,CAAEC,MAAAA,CAAAA,CAAO,CAAG,MAAMP,EAAWjB,EAAAA,EAAA,CAAA,EACxCa,EAAQY,MAAM,EAAI,CAAEC,WAAYb,EAAQY,MAAAA,AAAM,GAAE,CAAA,EAAA,CACpDE,OAAQN,EACRO,MAAON,EACPO,KAAI,aAAe,IAEpB,MAAO,CACNC,MAAOP,EACPQ,UAAWP,EAEb,EACA,CAACP,EAAaJ,EAAQY,MAAM,CAAC,EAGxB,CAAEO,cAAAA,CAAa,CAAEC,iBAAAA,CAAAA,CAAkB,CAAG7B,EAAyBU,EAAWM,EAAe,IAE/F,MAAO,CACNN,UAAAA,EACAkB,cAAAA,EACAC,iBAAAA,EAEF\"}"}