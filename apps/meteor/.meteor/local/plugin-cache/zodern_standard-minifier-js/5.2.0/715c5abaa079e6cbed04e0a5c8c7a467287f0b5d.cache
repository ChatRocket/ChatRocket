{"code":"function module(e,t,l){let n,a,o,c,r,i,u,s,m,d,p,E,h,k,_,v,y;l.link(\"@rocket.chat/fuselage\",{Box(e){n=e},Button(e){a=e},ButtonGroup(e){o=e}},0),l.link(\"@rocket.chat/fuselage-hooks\",{useUniqueId(e){c=e}},1),l.link(\"@rocket.chat/layout\",{Form(e){r=e}},2),l.link(\"@rocket.chat/ui-contexts\",{useLogout(e){i=e},useRoute(e){u=e}},3),l.link(\"meteor/accounts-base\",{Accounts(e){s=e}},4),l.link(\"react\",{default(e){m=e},useEffect(e){d=e},useMemo(e){p=e},useRef(e){E=e}},5),l.link(\"react-i18next\",{Trans(e){h=e},useTranslation(e){k=e}},6),l.link(\"../../../lib/utils/queueMicrotask\",{queueMicrotask(e){_=e}},7),l.link(\"./CurrentUserDisplay\",{default(e){v=e}},8),l.link(\"./Layout\",{default(e){y=e}},9),l.exportDefault(e=>{var t,l;let{oauthApp:f,redirectUri:b,user:g}=e,C=p(()=>{var e;return null!==(e=s.storageLocation.getItem(s.LOGIN_TOKEN_KEY))&&void 0!==e?e:void 0},[]),w=c(),{t:I}=k(),T=u(\"home\"),L=i(),x=E(null),q=null===(t=g.oauth)||void 0===t?void 0:null===(l=t.authorizedClients)||void 0===l?void 0:l.includes(f.clientId);return d(()=>{if(q){var e;null===(e=x.current)||void 0===e||e.click()}},[f.clientId,q]),m.createElement(y,null,m.createElement(r,{method:\"post\",action:\"\",\"aria-labelledby\":w},m.createElement(r.Header,null,m.createElement(r.Title,{id:w},I(\"core.Authorize_access_to_your_account\"))),m.createElement(r.Container,null,m.createElement(n,{withRichContent:!0},m.createElement(v,{user:g}),m.createElement(\"p\",null,m.createElement(h,{i18nKey:\"core.The_application_will_be_able_to\",t:I},\"The application \",m.createElement(\"strong\",null,{appName:f.name}),\" will be able to:\")),m.createElement(\"ul\",null,m.createElement(\"li\",null,I(\"core.access_your_basic_information\")))),m.createElement(\"input\",{type:\"hidden\",name:\"access_token\",value:C}),m.createElement(\"input\",{type:\"hidden\",name:\"client_id\",value:f.clientId}),m.createElement(\"input\",{type:\"hidden\",name:\"redirect_uri\",value:b}),m.createElement(\"input\",{type:\"hidden\",name:\"response_type\",value:\"code\"})),m.createElement(r.Footer,null,m.createElement(o,{stretch:!0},m.createElement(a,{ref:x,type:\"submit\",primary:!0,name:\"allow\",value:\"yes\"},I(\"core.Authorize\")),m.createElement(a,{onClick:()=>{_(()=>{T.push()}),window.close()}},I(\"core.Cancel\")),m.createElement(a,{danger:!0,onClick:()=>{L()}},I(\"core.Logout\"))))))})}","map":"{\"version\":3,\"sources\":[\"client/views/oauth/components/AuthorizationFormPage.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IOAuthApps, IUser } from '@rocket.chat/core-typings';\\nimport { Box, Button, ButtonGroup } from '@rocket.chat/fuselage';\\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\\nimport { Form } from '@rocket.chat/layout';\\nimport { useLogout, useRoute } from '@rocket.chat/ui-contexts';\\nimport { Accounts } from 'meteor/accounts-base';\\nimport React, { useEffect, useMemo, useRef } from 'react';\\nimport { Trans, useTranslation } from 'react-i18next';\\n\\nimport { queueMicrotask } from '../../../lib/utils/queueMicrotask';\\nimport CurrentUserDisplay from './CurrentUserDisplay';\\nimport Layout from './Layout';\\n\\ntype AuthorizationFormPageProps = {\\n\\toauthApp: IOAuthApps;\\n\\tredirectUri: string;\\n\\tuser: IUser;\\n};\\n\\nconst AuthorizationFormPage = ({ oauthApp, redirectUri, user }: AuthorizationFormPageProps) => {\\n\\tconst token = useMemo(() => Accounts.storageLocation.getItem(Accounts.LOGIN_TOKEN_KEY) ?? undefined, []);\\n\\n\\tconst formLabelId = useUniqueId();\\n\\n\\tconst { t } = useTranslation();\\n\\n\\tconst homeRoute = useRoute('home');\\n\\n\\tconst handleCancelButtonClick = () => {\\n\\t\\tqueueMicrotask(() => {\\n\\t\\t\\thomeRoute.push();\\n\\t\\t});\\n\\t\\twindow.close();\\n\\t};\\n\\n\\tconst logout = useLogout();\\n\\n\\tconst handleLogoutButtonClick = () => {\\n\\t\\tlogout();\\n\\t};\\n\\n\\tconst submitRef = useRef<HTMLButtonElement>(null);\\n\\n\\tconst hasAuthorized = user.oauth?.authorizedClients?.includes(oauthApp.clientId);\\n\\n\\tuseEffect(() => {\\n\\t\\tif (hasAuthorized) {\\n\\t\\t\\tsubmitRef.current?.click();\\n\\t\\t}\\n\\t}, [oauthApp.clientId, hasAuthorized]);\\n\\n\\treturn (\\n\\t\\t<Layout>\\n\\t\\t\\t<Form method='post' action='' aria-labelledby={formLabelId}>\\n\\t\\t\\t\\t<Form.Header>\\n\\t\\t\\t\\t\\t<Form.Title id={formLabelId}>{t('core.Authorize_access_to_your_account')}</Form.Title>\\n\\t\\t\\t\\t</Form.Header>\\n\\t\\t\\t\\t<Form.Container>\\n\\t\\t\\t\\t\\t<Box withRichContent>\\n\\t\\t\\t\\t\\t\\t<CurrentUserDisplay user={user} />\\n\\n\\t\\t\\t\\t\\t\\t<p>\\n\\t\\t\\t\\t\\t\\t\\t<Trans i18nKey='core.The_application_will_be_able_to' t={t}>\\n\\t\\t\\t\\t\\t\\t\\t\\tThe application <strong>{{ appName: oauthApp.name }}</strong> will be able to:\\n\\t\\t\\t\\t\\t\\t\\t</Trans>\\n\\t\\t\\t\\t\\t\\t</p>\\n\\n\\t\\t\\t\\t\\t\\t<ul>\\n\\t\\t\\t\\t\\t\\t\\t<li>{t('core.access_your_basic_information')}</li>\\n\\t\\t\\t\\t\\t\\t</ul>\\n\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t<input type='hidden' name='access_token' value={token} />\\n\\t\\t\\t\\t\\t<input type='hidden' name='client_id' value={oauthApp.clientId} />\\n\\t\\t\\t\\t\\t<input type='hidden' name='redirect_uri' value={redirectUri} />\\n\\t\\t\\t\\t\\t<input type='hidden' name='response_type' value='code' />\\n\\t\\t\\t\\t</Form.Container>\\n\\t\\t\\t\\t<Form.Footer>\\n\\t\\t\\t\\t\\t<ButtonGroup stretch>\\n\\t\\t\\t\\t\\t\\t<Button ref={submitRef} type='submit' primary name='allow' value='yes'>\\n\\t\\t\\t\\t\\t\\t\\t{t('core.Authorize')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t\\t<Button onClick={handleCancelButtonClick}>{t('core.Cancel')}</Button>\\n\\t\\t\\t\\t\\t\\t<Button danger onClick={handleLogoutButtonClick}>\\n\\t\\t\\t\\t\\t\\t\\t{t('core.Logout')}\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t</ButtonGroup>\\n\\t\\t\\t\\t</Form.Footer>\\n\\t\\t\\t</Form>\\n\\t\\t</Layout>\\n\\t);\\n};\\n\\nexport default AuthorizationFormPage;\\n\",null],\"names\":[\"Box\",\"Button\",\"ButtonGroup\",\"useUniqueId\",\"Form\",\"useLogout\",\"useRoute\",\"Accounts\",\"React\",\"useEffect\",\"useMemo\",\"useRef\",\"Trans\",\"useTranslation\",\"queueMicrotask\",\"CurrentUserDisplay\",\"Layout\",\"module\",\"link\",\"v\",\"default\",\"exportDefault\",\"_ref\",\"_user$oauth\",\"_user$oauth$authorize\",\"oauthApp\",\"redirectUri\",\"user\",\"token\",\"_Accounts$storageLoca\",\"storageLocation\",\"getItem\",\"LOGIN_TOKEN_KEY\",\"undefined\",\"formLabelId\",\"t\",\"homeRoute\",\"logout\",\"submitRef\",\"hasAuthorized\",\"oauth\",\"authorizedClients\",\"includes\",\"clientId\",\"_submitRef$current\",\"current\",\"click\",\"createElement\",\"method\",\"action\",\"Header\",\"Title\",\"id\",\"Container\",\"withRichContent\",\"i18nKey\",\"appName\",\"name\",\"type\",\"value\",\"Footer\",\"stretch\",\"ref\",\"primary\",\"onClick\",\"handleCancelButtonClick\",\"push\",\"window\",\"close\",\"danger\",\"handleLogoutButtonClick\"],\"mappings\":\"2BACAA,EAAOC,EAAOC,EAAmDC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA3CC,EAAWC,IAAE,CAAA,wBAAM,CAAuBlB,IAACmB,CAAA,EAAAnB,EAAAmB,CAAA,EAAAlB,OAAAkB,CAAA,EAAAlB,EAAAkB,CAAA,EAAAjB,YAAAiB,CAAA,EAAAjB,EAAAiB,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,8BAAA,CAAAf,YAAAgB,CAAA,EAAAhB,EAAAgB,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,sBAAA,CAAAd,KAAAe,CAAA,EAAAf,EAAAe,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,2BAAA,CAAAb,UAAAc,CAAA,EAAAd,EAAAc,CAAA,EAAAb,SAAAa,CAAA,EAAAb,EAAAa,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,uBAAA,CAAAX,SAAAY,CAAA,EAAAZ,EAAAY,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,QAAA,CAAAE,QAAAD,CAAA,EAAAX,EAAAW,CAAA,EAAAV,UAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,QAAAS,CAAA,EAAAT,EAAAS,CAAA,EAAAR,OAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,gBAAA,CAAAN,MAAAO,CAAA,EAAAP,EAAAO,CAAA,EAAAN,eAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,oCAAA,CAAAJ,eAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,uBAAA,CAAAE,QAAAD,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,WAAA,CAAAE,QAAAD,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,GAAjEF,EAAOI,aAAa,CAkBUC,IAAgE,IAAAC,EAAAC,EAAA,GAA/D,CAAEC,SAAAA,CAAQ,CAAEC,YAAAA,CAAW,CAAEC,KAAAA,CAAAA,CAAkC,CAAAL,EACnFM,EAAQlB,EAAQ,KAAA,IAAAmB,EAAA,OAAA,AAAgE,OAAhEA,CAAAA,EAAMtB,EAASuB,eAAe,CAACC,OAAO,CAACxB,EAASyB,eAAe,CAAA,GAACH,AAAA,KAAA,IAAAA,EAAAA,EAAII,KAAAA,CAAS,EAAE,EAAE,EAEjGC,EAAc/B,IAEd,CAAEgC,EAAAA,CAAAA,CAAG,CAAGtB,IAERuB,EAAY9B,EAAS,QASrB+B,EAAShC,IAMTiC,EAAY3B,EAA0B,MAEtC4B,EAAa,AAAa,OAAbhB,CAAAA,EAAGI,EAAKa,KAAK,AAALA,GAAKjB,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAA,AAAmB,OAAnBC,CAAAA,EAAVD,EAAYkB,iBAAiB,AAAjBA,GAAiBjB,AAAA,KAAA,IAAAA,EAAA,KAAA,EAA7BA,EAA+BkB,QAAQ,CAACjB,EAASkB,QAAQ,EAQ/E,OANAlC,EAAU,KACT,GAAI8B,EAAe,CAAA,IAAAK,CAClB,AAAiB,QAAjBA,CAAAA,EAAAN,EAAUO,OAAO,AAAPA,GAAOD,AAAA,KAAA,IAAAA,GAAjBA,EAAmBE,KAAK,EACzB,CACD,EAAG,CAACrB,EAASkB,QAAQ,CAAEJ,EAAc,EAGpC/B,EAAAuC,aAAA,CAAC/B,EAAM,KACNR,EAAAuC,aAAA,CAAC3C,EAAI,CAAC4C,OAAO,OAAOC,OAAO,GAAG,kBAAiBf,CAAY,EAC1D1B,EAAAuC,aAAA,CAAC3C,EAAK8C,MAAM,CAAA,KACX1C,EAAAuC,aAAA,CAAC3C,EAAK+C,KAAK,CAAA,CAACC,GAAIlB,CAAY,EAAEC,EAAE,2CAEjC3B,EAAAuC,aAAA,CAAC3C,EAAKiD,SAAS,CAAA,KACd7C,EAAAuC,aAAA,CAAC/C,EAAG,CAACsD,gBAAe,CAAA,CAAA,EACnB9C,EAAAuC,aAAA,CAAChC,EAAkB,CAACY,KAAMA,CAAK,GAE/BnB,EAAAuC,aAAA,CAAA,IAAA,KACCvC,EAAAuC,aAAA,CAACnC,EAAK,CAAC2C,QAAQ,uCAAuCpB,EAAGA,CAAE,EAC1D,mBAAgB3B,EAAAuC,aAAA,CAAA,SAAA,KAAS,CAAES,QAAS/B,EAASgC,IAAAA,AAAI,GAAa,sBAIhEjD,EAAAuC,aAAA,CAAA,KAAA,KACCvC,EAAAuC,aAAA,CAAA,KAAA,KAAKZ,EAAE,yCAGT3B,EAAAuC,aAAA,CAAA,QAAA,CAAOW,KAAK,SAASD,KAAK,eAAeE,MAAO/B,CAAM,GACtDpB,EAAAuC,aAAA,CAAA,QAAA,CAAOW,KAAK,SAASD,KAAK,YAAYE,MAAOlC,EAASkB,QAAAA,AAAS,GAC/DnC,EAAAuC,aAAA,CAAA,QAAA,CAAOW,KAAK,SAASD,KAAK,eAAeE,MAAOjC,CAAY,GAC5DlB,EAAAuC,aAAA,CAAA,QAAA,CAAOW,KAAK,SAASD,KAAK,gBAAgBE,MAAM,MAAM,IAEvDnD,EAAAuC,aAAA,CAAC3C,EAAKwD,MAAM,CAAA,KACXpD,EAAAuC,aAAA,CAAC7C,EAAW,CAAC2D,QAAO,CAAA,CAAA,EACnBrD,EAAAuC,aAAA,CAAC9C,EAAM,CAAC6D,IAAKxB,EAAWoB,KAAK,SAASK,QAAO,CAAA,EAACN,KAAK,QAAQE,MAAM,KAAK,EACpExB,EAAE,mBAEJ3B,EAAAuC,aAAA,CAAC9C,EAAM,CAAC+D,QArDmBC,KAC/BnD,EAAe,KACdsB,EAAU8B,IAAI,EACf,GACAC,OAAOC,KAAK,EACb,CAgD8C,EAAEjC,EAAE,gBAC7C3B,EAAAuC,aAAA,CAAC9C,EAAM,CAACoE,OAAM,CAAA,EAACL,QA7CYM,KAC/BjC,GACD,CA2CqD,EAC9CF,EAAE,mBAOV\"}"}