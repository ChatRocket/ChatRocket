{"code":"function module(n,e,u){u.export({useDirectMessageAction:function(){return f}}),u.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback:function(n){t=n}},0),u.link(\"@rocket.chat/ui-contexts\",{useTranslation:function(n){o=n},usePermission:function(n){i=n},useRoute:function(n){c=n},useUserSubscription:function(n){r=n},useUserSubscriptionByName:function(n){s=n}},1),u.link(\"react\",{useMemo:function(n){a=n}},2);var t,o,i,c,r,s,a,l=function(n,e,u,t){var o,i=n&&n.name!==t;return null!==(o=(u||e)&&i)&&void 0!==o&&o},f=function(n,e){var u,f=o(),m=s(null!==(u=n.username)&&void 0!==u?u:\"\"),k=r(e),d=i(\"create-d\"),v=c(\"direct\"),b=l(k,m,d,n.username),p=t(function(){return n.username&&v.push({rid:n.username})});return a(function(){return b?{content:f(\"Direct_Message\"),icon:\"balloon\",onClick:p,type:\"communication\"}:void 0},[p,b,f])}}","map":"{\"version\":3,\"sources\":[\"client/views/room/hooks/useUserInfoActions/actions/useDirectMessageAction.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom, IUser, ISubscription } from '@rocket.chat/core-typings';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useTranslation, usePermission, useRoute, useUserSubscription, useUserSubscriptionByName } from '@rocket.chat/ui-contexts';\\nimport { useMemo } from 'react';\\n\\nimport type { UserInfoAction, UserInfoActionType } from '../useUserInfoActions';\\n\\nconst getShouldOpenDirectMessage = (\\n\\tcurrentSubscription?: ISubscription,\\n\\tusernameSubscription?: ISubscription,\\n\\tcanOpenDirectMessage?: boolean,\\n\\tusername?: IUser['username'],\\n): boolean => {\\n\\tconst canOpenDm = canOpenDirectMessage || usernameSubscription;\\n\\tconst directMessageIsNotAlreadyOpen = currentSubscription && currentSubscription.name !== username;\\n\\treturn (canOpenDm && directMessageIsNotAlreadyOpen) ?? false;\\n};\\n\\nexport const useDirectMessageAction = (user: Pick<IUser, '_id' | 'username'>, rid: IRoom['_id']): UserInfoAction | undefined => {\\n\\tconst t = useTranslation();\\n\\tconst usernameSubscription = useUserSubscriptionByName(user.username ?? '');\\n\\tconst currentSubscription = useUserSubscription(rid);\\n\\tconst canOpenDirectMessage = usePermission('create-d');\\n\\tconst directRoute = useRoute('direct');\\n\\n\\tconst shouldOpenDirectMessage = getShouldOpenDirectMessage(\\n\\t\\tcurrentSubscription,\\n\\t\\tusernameSubscription,\\n\\t\\tcanOpenDirectMessage,\\n\\t\\tuser.username,\\n\\t);\\n\\n\\tconst openDirectMessage = useMutableCallback(\\n\\t\\t() =>\\n\\t\\t\\tuser.username &&\\n\\t\\t\\tdirectRoute.push({\\n\\t\\t\\t\\trid: user.username,\\n\\t\\t\\t}),\\n\\t);\\n\\n\\tconst openDirectMessageOption = useMemo(\\n\\t\\t() =>\\n\\t\\t\\tshouldOpenDirectMessage\\n\\t\\t\\t\\t? {\\n\\t\\t\\t\\t\\t\\tcontent: t('Direct_Message'),\\n\\t\\t\\t\\t\\t\\ticon: 'balloon' as const,\\n\\t\\t\\t\\t\\t\\tonClick: openDirectMessage,\\n\\t\\t\\t\\t\\t\\ttype: 'communication' as UserInfoActionType,\\n\\t\\t\\t\\t  }\\n\\t\\t\\t\\t: undefined,\\n\\t\\t[openDirectMessage, shouldOpenDirectMessage, t],\\n\\t);\\n\\n\\treturn openDirectMessageOption;\\n};\\n\",null],\"names\":[\"module\",\"export\",\"useDirectMessageAction\",\"link\",\"useMutableCallback\",\"v\",\"useTranslation\",\"usePermission\",\"useRoute\",\"useUserSubscription\",\"useUserSubscriptionByName\",\"useMemo\",\"getShouldOpenDirectMessage\",\"currentSubscription\",\"usernameSubscription\",\"canOpenDirectMessage\",\"username\",\"_ref\",\"directMessageIsNotAlreadyOpen\",\"name\",\"canOpenDm\",\"user\",\"rid\",\"_user$username\",\"t\",\"directRoute\",\"shouldOpenDirectMessage\",\"openDirectMessage\",\"push\",\"content\",\"icon\",\"onClick\",\"type\",\"undefined\"],\"mappings\":\"uBACAA,EAAOC,MAAE,CAAA,CAAAC,uBAA0B,WAAA,OAAAA,CAA8B,CAAA,GAAAF,EAAAG,IAAA,CAAA,8BAAA,CAAAC,mBAAA,SAAAC,CAAA,EAAAD,EAAAC,CAAA,CAAA,EAAA,GAAAL,EAAAG,IAAA,CAAA,2BAAA,CAAAG,eAAA,SAAAD,CAAA,EAAAC,EAAAD,CAAA,EAAAE,cAAA,SAAAF,CAAA,EAAAE,EAAAF,CAAA,EAAAG,SAAA,SAAAH,CAAA,EAAAG,EAAAH,CAAA,EAAAI,oBAAA,SAAAJ,CAAA,EAAAI,EAAAJ,CAAA,EAAAK,0BAAA,SAAAL,CAAA,EAAAK,EAAAL,CAAA,CAAA,EAAA,GAAAL,EAAAG,IAAA,CAAA,QAAA,CAAAQ,QAAA,SAAAN,CAAA,EAAAM,EAAAN,CAAA,CAAA,EAAA,GAMjE,IANiED,EAAAE,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAM3DC,EAA6B,SAClCC,CAAmC,CACnCC,CAAoC,CACpCC,CAA8B,CAC9BC,CAA4B,EAG5B,IAFYC,EAENC,EAAgCL,GAAuBA,EAAoBM,IAAI,GAAKH,EAC1F,OAAA,AAAkD,OAAlDC,CAAAA,EAAQG,AAFUL,CAAAA,GAAwBD,CAAAA,GAErBI,CAAAA,GAA6BD,AAAA,KAAA,IAAAA,GAAAA,CACnD,EAEaf,EAAyB,SAACmB,CAAqC,CAAEC,CAAiB,EAC9F,IAD8HC,EACxHC,EAAIlB,IACJQ,EAAuBJ,EAAyB,AAAc,OAAda,CAAAA,EAACF,EAAKL,QAAQ,AAARA,GAAQO,AAAA,KAAA,IAAAA,EAAAA,EAAI,IAClEV,EAAsBJ,EAAoBa,GAC1CP,EAAuBR,EAAc,YACrCkB,EAAcjB,EAAS,UAEvBkB,EAA0Bd,EAC/BC,EACAC,EACAC,EACAM,EAAKL,QAAQ,EAGRW,EAAoBvB,EACzB,WAAA,OACCiB,EAAKL,QAAQ,EACbS,EAAYG,IAAI,CAAC,CAChBN,IAAKD,EAAKL,QAAAA,EACT,GAgBJ,OAbgCL,EAC/B,WAAA,OACCe,EACG,CACAG,QAASL,EAAE,kBACXM,KAAM,UACNC,QAASJ,EACTK,KAAM,iBAENC,KAAAA,CAAS,EACb,CAACN,EAAmBD,EAAyBF,EAAE,CAIjD\"}"}