{"code":"function module(t,e,a){let n,o,s,u,l,i,r,c;a.export({useOutlookCalendarListForToday:()=>k,useOutlookCalendarList:()=>y,useMutationOutlookCalendarSync:()=>d}),a.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch(t){n=t},useTranslation(t){o=t},useEndpoint(t){s=t}},0),a.link(\"@tanstack/react-query\",{useMutation(t){u=t},useQuery(t){l=t},useQueryClient(t){i=t}},1),a.link(\"../lib/syncOutlookEvents\",{syncOutlookEvents(t){r=t}},2),a.link(\"./useOutlookAuthentication\",{useOutlookAuthenticationMutation(t){c=t}},3);let k=()=>y(new Date),y=t=>{let e=s(\"GET\",\"/v1/calendar-events.list\");return l([\"outlook\",\"calendar\",\"list\"],async()=>{let{data:a}=await e({date:t.toISOString()});return a})},d=()=>{let t=o(),e=i(),a=c(),s=n(),l=u({mutationFn:async()=>{await r(),await e.invalidateQueries([\"outlook\",\"calendar\",\"list\"]),await a.mutateAsync()},onSuccess:()=>{s({type:\"success\",message:t(\"Outlook_Sync_Success\")})},onError:e=>{e instanceof Error&&\"abort\"===e.message||s({type:\"error\",message:t(\"Outlook_Sync_Failed\")})}});return l}}","map":"{\"version\":3,\"sources\":[\"client/views/outlookCalendar/hooks/useOutlookCalendarList.ts\",\"<anon>\"],\"sourcesContent\":[\"import { useToastMessageDispatch, useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\\n\\nimport { syncOutlookEvents } from '../lib/syncOutlookEvents';\\nimport { useOutlookAuthenticationMutation } from './useOutlookAuthentication';\\n\\nexport const useOutlookCalendarListForToday = () => {\\n\\treturn useOutlookCalendarList(new Date());\\n};\\n\\nexport const useOutlookCalendarList = (date: Date) => {\\n\\tconst calendarData = useEndpoint('GET', '/v1/calendar-events.list');\\n\\n\\treturn useQuery(['outlook', 'calendar', 'list'], async () => {\\n\\t\\tconst { data } = await calendarData({ date: date.toISOString() });\\n\\t\\treturn data;\\n\\t});\\n};\\n\\nexport const useMutationOutlookCalendarSync = () => {\\n\\tconst t = useTranslation();\\n\\tconst queryClient = useQueryClient();\\n\\n\\tconst checkOutlookCredentials = useOutlookAuthenticationMutation();\\n\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst syncMutation = useMutation({\\n\\t\\tmutationFn: async () => {\\n\\t\\t\\tawait syncOutlookEvents();\\n\\n\\t\\t\\tawait queryClient.invalidateQueries(['outlook', 'calendar', 'list']);\\n\\n\\t\\t\\tawait checkOutlookCredentials.mutateAsync();\\n\\t\\t},\\n\\t\\tonSuccess: () => {\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Outlook_Sync_Success') });\\n\\t\\t},\\n\\t\\tonError: (error) => {\\n\\t\\t\\tif (error instanceof Error && error.message === 'abort') {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('Outlook_Sync_Failed') });\\n\\t\\t},\\n\\t});\\n\\treturn syncMutation;\\n};\\n\",null],\"names\":[\"useToastMessageDispatch\",\"useTranslation\",\"useEndpoint\",\"useMutation\",\"useQuery\",\"useQueryClient\",\"syncOutlookEvents\",\"useOutlookAuthenticationMutation\",\"module\",\"export\",\"useOutlookCalendarListForToday\",\"useOutlookCalendarList\",\"useMutationOutlookCalendarSync\",\"link\",\"v\",\"Date\",\"date\",\"calendarData\",\"data\",\"toISOString\",\"t\",\"queryClient\",\"checkOutlookCredentials\",\"dispatchToastMessage\",\"syncMutation\",\"mutationFn\",\"invalidateQueries\",\"mutateAsync\",\"onSuccess\",\"type\",\"message\",\"onError\",\"error\",\"Error\"],\"mappings\":\"2BAAgGA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAhGC,EAAOC,MAAE,CAAA,CAAAC,+BAAyBA,IAAgBA,EAAmBC,uBAA2BA,IAAAA,EAAAC,+BAAAA,IAAAA,CAAA,GAAAJ,EAAAK,IAAA,CAAA,2BAAA,CAAAb,wBAAAc,CAAA,EAAAd,EAAAc,CAAA,EAAAb,eAAAa,CAAA,EAAAb,EAAAa,CAAA,EAAAZ,YAAAY,CAAA,EAAAZ,EAAAY,CAAA,CAAA,EAAA,GAAAN,EAAAK,IAAA,CAAA,wBAAA,CAAAV,YAAAW,CAAA,EAAAX,EAAAW,CAAA,EAAAV,SAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,eAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAN,EAAAK,IAAA,CAAA,2BAAA,CAAAP,kBAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAN,EAAAK,IAAA,CAAA,6BAAA,CAAAN,iCAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAMzF,IAAMJ,EAAiCA,IACtCC,EAAuB,IAAII,MAGtBJ,EAA0BK,IACtC,IAAMC,EAAef,EAAY,MAAO,4BAExC,OAAOE,EAAS,CAAC,UAAW,WAAY,OAAO,CAAE,UAChD,GAAM,CAAEc,KAAAA,CAAAA,CAAM,CAAG,MAAMD,EAAa,CAAED,KAAMA,EAAKG,WAAW,EAAE,GAC9D,OAAOD,CACR,EACD,EAEaN,EAAiCA,KAC7C,IAAMQ,EAAInB,IACJoB,EAAchB,IAEdiB,EAA0Bf,IAE1BgB,EAAuBvB,IAEvBwB,EAAerB,EAAY,CAChCsB,WAAY,UACX,MAAMnB,IAEN,MAAMe,EAAYK,iBAAiB,CAAC,CAAC,UAAW,WAAY,OAAO,EAEnE,MAAMJ,EAAwBK,WAAW,EAC1C,EACAC,UAAWA,KACVL,EAAqB,CAAEM,KAAM,UAAWC,QAASV,EAAE,uBAAuB,EAC3E,EACAW,QAAUC,IACLA,aAAiBC,OAASD,AAAkB,UAAlBA,EAAMF,OAAO,EAG3CP,EAAqB,CAAEM,KAAM,QAASC,QAASV,EAAE,sBAAsB,EACxE,IAED,OAAOI,CACR\"}"}