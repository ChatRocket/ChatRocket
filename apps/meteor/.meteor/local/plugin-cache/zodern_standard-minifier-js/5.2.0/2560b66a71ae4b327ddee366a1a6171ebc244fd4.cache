{"code":"function module(e,t,s){let o,r,n,i,u;s.link(\"meteor/meteor\",{Meteor(e){o=e}},0),s.link(\"meteor/tracker\",{Tracker(e){r=e}},1),s.link(\"underscore\",{default(e){n=e}},2),s.link(\"../../custom-oauth/client/CustomOAuth\",{CustomOAuth(e){i=e}},3),s.link(\"../../settings/client\",{settings(e){u=e}},4);let a={serverURL:\"\",identityPath:\"/oauth/me\",addAutopublishFields:{forLoggedInUser:[\"services.wordpress\"],forOtherUsers:[\"services.wordpress.user_login\"]},accessTokenParam:\"access_token\"},c=new i(\"wordpress\",a),_=n.debounce(async()=>{if(a.serverURL=u.get(\"API_Wordpress_URL\"),!a.serverURL)return void 0===a.serverURL?_():void 0;delete a.identityPath,delete a.identityTokenSentVia,delete a.authorizePath,delete a.tokenPath,delete a.scope;let e=u.get(\"Accounts_OAuth_Wordpress_server_type\");switch(e){case\"custom\":u.get(\"Accounts_OAuth_Wordpress_identity_path\")&&(a.identityPath=u.get(\"Accounts_OAuth_Wordpress_identity_path\")),u.get(\"Accounts_OAuth_Wordpress_identity_token_sent_via\")&&(a.identityTokenSentVia=u.get(\"Accounts_OAuth_Wordpress_identity_token_sent_via\")),u.get(\"Accounts_OAuth_Wordpress_token_path\")&&(a.tokenPath=u.get(\"Accounts_OAuth_Wordpress_token_path\")),u.get(\"Accounts_OAuth_Wordpress_authorize_path\")&&(a.authorizePath=u.get(\"Accounts_OAuth_Wordpress_authorize_path\")),u.get(\"Accounts_OAuth_Wordpress_scope\")&&(a.scope=u.get(\"Accounts_OAuth_Wordpress_scope\"));break;case\"wordpress-com\":a.identityPath=\"https://public-api.wordpress.com/rest/v1/me\",a.identityTokenSentVia=\"header\",a.authorizePath=\"https://public-api.wordpress.com/oauth2/authorize\",a.tokenPath=\"https://public-api.wordpress.com/oauth2/token\",a.scope=\"auth\";break;default:a.identityPath=\"/oauth/me\"}let t=c.configure(a);return t},100);o.startup(()=>r.autorun(()=>_()))}","map":"{\"version\":3,\"sources\":[\"app/wordpress/client/lib.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { OauthConfig } from '@rocket.chat/core-typings';\\nimport { Meteor } from 'meteor/meteor';\\nimport { Tracker } from 'meteor/tracker';\\nimport _ from 'underscore';\\n\\nimport { CustomOAuth } from '../../custom-oauth/client/CustomOAuth';\\nimport { settings } from '../../settings/client';\\n\\nconst config: OauthConfig = {\\n\\tserverURL: '',\\n\\tidentityPath: '/oauth/me',\\n\\n\\taddAutopublishFields: {\\n\\t\\tforLoggedInUser: ['services.wordpress'],\\n\\t\\tforOtherUsers: ['services.wordpress.user_login'],\\n\\t},\\n\\taccessTokenParam: 'access_token',\\n};\\n\\nconst WordPress = new CustomOAuth('wordpress', config);\\n\\nconst fillSettings = _.debounce(async (): Promise<void> => {\\n\\tconfig.serverURL = settings.get('API_Wordpress_URL');\\n\\tif (!config.serverURL) {\\n\\t\\tif (config.serverURL === undefined) {\\n\\t\\t\\treturn fillSettings();\\n\\t\\t}\\n\\t\\treturn;\\n\\t}\\n\\n\\tdelete config.identityPath;\\n\\tdelete config.identityTokenSentVia;\\n\\tdelete config.authorizePath;\\n\\tdelete config.tokenPath;\\n\\tdelete config.scope;\\n\\n\\tconst serverType = settings.get('Accounts_OAuth_Wordpress_server_type');\\n\\tswitch (serverType) {\\n\\t\\tcase 'custom':\\n\\t\\t\\tif (settings.get('Accounts_OAuth_Wordpress_identity_path')) {\\n\\t\\t\\t\\tconfig.identityPath = settings.get('Accounts_OAuth_Wordpress_identity_path');\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (settings.get('Accounts_OAuth_Wordpress_identity_token_sent_via')) {\\n\\t\\t\\t\\tconfig.identityTokenSentVia = settings.get('Accounts_OAuth_Wordpress_identity_token_sent_via');\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (settings.get('Accounts_OAuth_Wordpress_token_path')) {\\n\\t\\t\\t\\tconfig.tokenPath = settings.get('Accounts_OAuth_Wordpress_token_path');\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (settings.get('Accounts_OAuth_Wordpress_authorize_path')) {\\n\\t\\t\\t\\tconfig.authorizePath = settings.get('Accounts_OAuth_Wordpress_authorize_path');\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (settings.get('Accounts_OAuth_Wordpress_scope')) {\\n\\t\\t\\t\\tconfig.scope = settings.get('Accounts_OAuth_Wordpress_scope');\\n\\t\\t\\t}\\n\\t\\t\\tbreak;\\n\\t\\tcase 'wordpress-com':\\n\\t\\t\\tconfig.identityPath = 'https://public-api.wordpress.com/rest/v1/me';\\n\\t\\t\\tconfig.identityTokenSentVia = 'header';\\n\\t\\t\\tconfig.authorizePath = 'https://public-api.wordpress.com/oauth2/authorize';\\n\\t\\t\\tconfig.tokenPath = 'https://public-api.wordpress.com/oauth2/token';\\n\\t\\t\\tconfig.scope = 'auth';\\n\\t\\t\\tbreak;\\n\\t\\tdefault:\\n\\t\\t\\tconfig.identityPath = '/oauth/me';\\n\\t\\t\\tbreak;\\n\\t}\\n\\n\\tconst result = WordPress.configure(config);\\n\\treturn result;\\n}, 100);\\n\\nMeteor.startup(() => {\\n\\treturn Tracker.autorun(() => {\\n\\t\\treturn fillSettings();\\n\\t});\\n});\\n\",null],\"names\":[\"Meteor\",\"Tracker\",\"_\",\"CustomOAuth\",\"settings\",\"module\",\"link\",\"v\",\"default\",\"config\",\"serverURL\",\"identityPath\",\"addAutopublishFields\",\"forLoggedInUser\",\"forOtherUsers\",\"accessTokenParam\",\"WordPress\",\"fillSettings\",\"debounce\",\"get\",\"undefined\",\"identityTokenSentVia\",\"authorizePath\",\"tokenPath\",\"scope\",\"serverType\",\"result\",\"configure\",\"startup\",\"autorun\"],\"mappings\":\"2BACAA,EAAuCC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAN,OAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,iBAAA,CAAAL,QAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,aAAA,CAAAE,QAAAD,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,wCAAA,CAAAH,YAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,wBAAA,CAAAF,SAAAG,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,GAOvC,IAAME,EAAsB,CAC3BC,UAAW,GACXC,aAAc,YAEdC,qBAAsB,CACrBC,gBAAiB,CAAC,qBAAqB,CACvCC,cAAe,CAAC,gCAA+B,EAEhDC,iBAAkB,gBAGbC,EAAY,IAAIb,EAAY,YAAaM,GAEzCQ,EAAef,EAAEgB,QAAQ,CAAC,UAE/B,GADAT,EAAOC,SAAS,CAAGN,EAASe,GAAG,CAAC,qBAC5B,CAACV,EAAOC,SAAS,QACpB,AAAID,AAAqBW,KAAAA,IAArBX,EAAOC,SAAS,CACZO,IAER,KAAA,CAGD,QAAOR,EAAOE,YAAY,CAC1B,OAAOF,EAAOY,oBAAoB,CAClC,OAAOZ,EAAOa,aAAa,CAC3B,OAAOb,EAAOc,SAAS,CACvB,OAAOd,EAAOe,KAAK,CAEnB,IAAMC,EAAarB,EAASe,GAAG,CAAC,wCAChC,OAAQM,GACP,IAAK,SACArB,EAASe,GAAG,CAAC,2CAChBV,CAAAA,EAAOE,YAAY,CAAGP,EAASe,GAAG,CAAC,yCAAwC,EAGxEf,EAASe,GAAG,CAAC,qDAChBV,CAAAA,EAAOY,oBAAoB,CAAGjB,EAASe,GAAG,CAAC,mDAAkD,EAG1Ff,EAASe,GAAG,CAAC,wCAChBV,CAAAA,EAAOc,SAAS,CAAGnB,EAASe,GAAG,CAAC,sCAAqC,EAGlEf,EAASe,GAAG,CAAC,4CAChBV,CAAAA,EAAOa,aAAa,CAAGlB,EAASe,GAAG,CAAC,0CAAyC,EAG1Ef,EAASe,GAAG,CAAC,mCAChBV,CAAAA,EAAOe,KAAK,CAAGpB,EAASe,GAAG,CAAC,iCAAgC,EAE7D,KACD,KAAK,gBACJV,EAAOE,YAAY,CAAG,8CACtBF,EAAOY,oBAAoB,CAAG,SAC9BZ,EAAOa,aAAa,CAAG,oDACvBb,EAAOc,SAAS,CAAG,gDACnBd,EAAOe,KAAK,CAAG,OACf,KACD,SACCf,EAAOE,YAAY,CAAG,WAExB,CAEA,IAAMe,EAASV,EAAUW,SAAS,CAAClB,GACnC,OAAOiB,CACR,EAAG,KAEH1B,EAAO4B,OAAO,CAAC,IACP3B,EAAQ4B,OAAO,CAAC,IACfZ\"}"}