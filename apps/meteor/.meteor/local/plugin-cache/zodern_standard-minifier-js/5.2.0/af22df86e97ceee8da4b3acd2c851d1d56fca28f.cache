{"code":"function module(e,r,t){var n=e(\"inherits\"),o=e(\"buffer\").Buffer,i=e(\"../../asn1\"),s=i.base,f=i.constants.der;function u(e){this.enc=\"der\",this.name=e.name,this.entity=e,this.tree=new a,this.tree._init(e.body)}function a(e){s.Node.call(this,\"der\",e)}function c(e){return e<10?\"0\"+e:e}t.exports=u,u.prototype.encode=function e(e,r){return this.tree._encode(e,r).join()},n(a,s.Node),a.prototype._encodeComposite=function e(e,r,t,n){var i=function(e,r,t,n){var o;if(\"seqof\"===e?e=\"seq\":\"setof\"===e&&(e=\"set\"),f.tagByName.hasOwnProperty(e))o=f.tagByName[e];else{if(\"number\"!=typeof e||(0|e)!==e)return n.error(\"Unknown tag: \"+e);o=e}return o>=31?n.error(\"Multi-octet tag encoding unsupported\"):(r||(o|=32),o|=f.tagClassByName[t||\"universal\"]<<6)}(e,r,t,this.reporter);if(n.length<128){var s=new o(2);return s[0]=i,s[1]=n.length,this._createEncoderBuffer([s,n])}for(var u=1,a=n.length;a>=256;a>>=8)u++;var s=new o(2+u);s[0]=i,s[1]=128|u;for(var a=1+u,c=n.length;c>0;a--,c>>=8)s[a]=255&c;return this._createEncoderBuffer([s,n])},a.prototype._encodeStr=function e(e,r){if(\"bitstr\"===r)return this._createEncoderBuffer([0|e.unused,e.data]);if(\"bmpstr\"===r){for(var t=new o(2*e.length),n=0;n<e.length;n++)t.writeUInt16BE(e.charCodeAt(n),2*n);return this._createEncoderBuffer(t)}return\"numstr\"===r?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error(\"Encoding of string type: numstr supports only digits and space\"):\"printstr\"===r?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error(\"Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark\"):/str$/.test(r)?this._createEncoderBuffer(e):\"objDesc\"===r?this._createEncoderBuffer(e):this.reporter.error(\"Encoding of string type: \"+r+\" unsupported\")},a.prototype._encodeObjid=function e(e,r,t){if(\"string\"==typeof e){if(!r)return this.reporter.error(\"string objid given, but no values map found\");if(!r.hasOwnProperty(e))return this.reporter.error(\"objid not found in values map\");e=r[e].split(/[\\s\\.]+/g);for(var n=0;n<e.length;n++)e[n]|=0}else if(Array.isArray(e)){e=e.slice();for(var n=0;n<e.length;n++)e[n]|=0}if(!Array.isArray(e))return this.reporter.error(\"objid() should be either array or string, got: \"+JSON.stringify(e));if(!t){if(e[1]>=40)return this.reporter.error(\"Second objid identifier OOB\");e.splice(0,2,40*e[0]+e[1])}for(var i=0,n=0;n<e.length;n++){var s=e[n];for(i++;s>=128;s>>=7)i++}for(var f=new o(i),u=f.length-1,n=e.length-1;n>=0;n--){var s=e[n];for(f[u--]=127&s;(s>>=7)>0;)f[u--]=128|127&s}return this._createEncoderBuffer(f)},a.prototype._encodeTime=function e(e,r){var t,n=new Date(e);return\"gentime\"===r?t=[c(n.getFullYear()),c(n.getUTCMonth()+1),c(n.getUTCDate()),c(n.getUTCHours()),c(n.getUTCMinutes()),c(n.getUTCSeconds()),\"Z\"].join(\"\"):\"utctime\"===r?t=[c(n.getFullYear()%100),c(n.getUTCMonth()+1),c(n.getUTCDate()),c(n.getUTCHours()),c(n.getUTCMinutes()),c(n.getUTCSeconds()),\"Z\"].join(\"\"):this.reporter.error(\"Encoding \"+r+\" time is not supported yet\"),this._encodeStr(t,\"octstr\")},a.prototype._encodeNull=function e(){return this._createEncoderBuffer(\"\")},a.prototype._encodeInt=function e(e,r){if(\"string\"==typeof e){if(!r)return this.reporter.error(\"String int or enum given, but no values map\");if(!r.hasOwnProperty(e))return this.reporter.error(\"Values map doesn't contain: \"+JSON.stringify(e));e=r[e]}if(\"number\"!=typeof e&&!o.isBuffer(e)){var t=e.toArray();!e.sign&&128&t[0]&&t.unshift(0),e=new o(t)}if(o.isBuffer(e)){var n=e.length;0===e.length&&n++;var i=new o(n);return e.copy(i),0===e.length&&(i[0]=0),this._createEncoderBuffer(i)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);for(var n=1,s=e;s>=256;s>>=8)n++;for(var i=Array(n),s=i.length-1;s>=0;s--)i[s]=255&e,e>>=8;return 128&i[0]&&i.unshift(0),this._createEncoderBuffer(new o(i))},a.prototype._encodeBool=function e(e){return this._createEncoderBuffer(e?255:0)},a.prototype._use=function e(e,r){return\"function\"==typeof e&&(e=e(r)),e._getEncoder(\"der\").tree},a.prototype._skipDefault=function e(e,r,t){var n,o=this._baseState;if(null===o.default)return!1;var i=e.join();if(void 0===o.defaultBuffer&&(o.defaultBuffer=this._encodeValue(o.default,r,t).join()),i.length!==o.defaultBuffer.length)return!1;for(n=0;n<i.length;n++)if(i[n]!==o.defaultBuffer[n])return!1;return!0}}","map":"{\"version\":3,\"sources\":[\"<anon>\"],\"names\":[],\"mappings\":\"\"}"}