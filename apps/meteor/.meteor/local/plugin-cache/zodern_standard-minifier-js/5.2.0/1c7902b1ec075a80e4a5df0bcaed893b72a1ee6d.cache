{"code":"function module(t,e,r){let a;r.export({getAvatarAsPng:()=>n}),r.link(\"../../../app/utils/client/getUserAvatarURL\",{getUserAvatarURL(t){a=t}},0);let n=(t,e)=>{let r=new Image,n=()=>e(\"\");return r.onload=()=>{let t=document.createElement(\"canvas\");t.width=r.width,t.height=r.height;let a=t.getContext(\"2d\");if(!a)throw Error(\"failed to get canvas context\");a.drawImage(r,0,0);try{return e(t.toDataURL(\"image/png\"))}catch(t){return e(\"\")}},r.onerror=n,r.src=a(t||\"\"),n}}","map":"{\"version\":3,\"sources\":[\"client/lib/utils/getAvatarAsPng.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IUser } from '@rocket.chat/core-typings';\\n\\nimport { getUserAvatarURL } from '../../../app/utils/client/getUserAvatarURL';\\n\\nexport const getAvatarAsPng = (username: IUser['username'], cb: (dataURL: string) => void): (() => void) => {\\n\\tconst image = new Image();\\n\\n\\tconst onLoad = (): void => {\\n\\t\\tconst canvas = document.createElement('canvas');\\n\\t\\tcanvas.width = image.width;\\n\\t\\tcanvas.height = image.height;\\n\\t\\tconst context = canvas.getContext('2d');\\n\\n\\t\\tif (!context) {\\n\\t\\t\\tthrow new Error('failed to get canvas context');\\n\\t\\t}\\n\\n\\t\\tcontext.drawImage(image, 0, 0);\\n\\t\\ttry {\\n\\t\\t\\treturn cb(canvas.toDataURL('image/png'));\\n\\t\\t} catch (e) {\\n\\t\\t\\treturn cb('');\\n\\t\\t}\\n\\t};\\n\\n\\tconst onError = (): void => cb('');\\n\\n\\timage.onload = onLoad;\\n\\timage.onerror = onError;\\n\\timage.src = getUserAvatarURL(username || '') as string;\\n\\n\\treturn onError;\\n};\\n\",null],\"names\":[\"getUserAvatarURL\",\"module\",\"export\",\"getAvatarAsPng\",\"link\",\"v\",\"username\",\"cb\",\"image\",\"Image\",\"onError\",\"onload\",\"onLoad\",\"canvas\",\"document\",\"createElement\",\"width\",\"height\",\"context\",\"getContext\",\"Error\",\"drawImage\",\"toDataURL\",\"e\",\"onerror\",\"src\"],\"mappings\":\"2BAEiCA,EAAjCC,EAAOC,MAAE,CAAA,CAAAC,eAAkBA,IAAMA,CAAA,GAAAF,EAA6CG,IAAA,CAAA,6CAAA,CAAAJ,iBAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAEvE,IAAMF,EAAiBA,CAACG,EAA6BC,KAC3D,IAAMC,EAAQ,IAAIC,MAoBZC,EAAUA,IAAYH,EAAG,IAM/B,OAJAC,EAAMG,MAAM,CApBGC,KACd,IAAMC,EAASC,SAASC,aAAa,CAAC,SACtCF,CAAAA,EAAOG,KAAK,CAAGR,EAAMQ,KAAK,CAC1BH,EAAOI,MAAM,CAAGT,EAAMS,MAAM,CAC5B,IAAMC,EAAUL,EAAOM,UAAU,CAAC,MAElC,GAAI,CAACD,EACJ,MAAM,AAAIE,MAAM,gCAGjBF,EAAQG,SAAS,CAACb,EAAO,EAAG,GAC5B,GAAI,CACH,OAAOD,EAAGM,EAAOS,SAAS,CAAC,aAC5B,CAAE,MAAOC,EAAG,CACX,OAAOhB,EAAG,GACX,CACD,EAKAC,EAAMgB,OAAO,CAAGd,EAChBF,EAAMiB,GAAG,CAAGzB,EAAiBM,GAAY,IAElCI,CACR\"}"}