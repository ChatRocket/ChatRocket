{"code":"function module(e,a,t){let l,r,i,n,o,s,c,u,d,m,f,k,g,p,v,x,E,U;t.link(\"@rocket.chat/fuselage\",{Box(e){l=e},Button(e){r=e},Avatar(e){i=e},TextInput(e){n=e},IconButton(e){o=e},Label(e){s=e}},0),t.link(\"@rocket.chat/fuselage-hooks\",{useUniqueId(e){c=e}},1),t.link(\"@rocket.chat/ui-avatar\",{UserAvatar(e){u=e}},2),t.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch(e){d=e},useSetting(e){m=e}},3),t.link(\"react\",{default(e){f=e},useState(e){k=e},useCallback(e){g=e}},4),t.link(\"react-i18next\",{useTranslation(e){p=e}},5),t.link(\"../../../hooks/useSingleFileInput\",{useSingleFileInput(e){v=e}},6),t.link(\"../../../lib/utils/isValidImageFormat\",{isValidImageFormat(e){x=e}},7),t.link(\"./UserAvatarSuggestions\",{default(e){E=e}},8),t.link(\"./readFileAsDataURL\",{readFileAsDataURL(e){U=e}},9),t.exportDefault(function(e){let{currentUsername:a,username:t,setAvatarObj:b,disabled:y,etag:A}=e,{t:_}=p(),h=m(\"FileUpload_RotateImages\"),[D,F]=k(\"\"),[S,I]=k(),w=c(),C=d(),L=g(async(e,a)=>{b(a);try{let a=await U(e);await x(a)&&I(a)}catch(e){C({type:\"error\",message:_(\"Avatar_format_invalid\")})}},[b,_,C]),[q]=v(L),R=g(e=>{b(e),I(e.blob)},[b,I]);return f.createElement(l,{display:\"flex\",flexDirection:\"column\",fontScale:\"p2m\",color:\"default\"},_(\"Profile_picture\"),f.createElement(l,{display:\"flex\",flexDirection:\"row\",mbs:4},f.createElement(u,{size:\"x124\",url:S,key:S,\"data-qa-id\":\"UserAvatarEditor\",username:a||\"\",etag:A,style:{imageOrientation:h?\"from-image\":\"none\",objectFit:\"contain\"},onError:()=>C({type:\"error\",message:_(\"error-invalid-image-url\")})}),f.createElement(l,{display:\"flex\",flexDirection:\"column\",flexGrow:\"1\",justifyContent:\"space-between\",mis:4},f.createElement(l,{display:\"flex\",flexDirection:\"row\",mbs:\"none\"},f.createElement(r,{square:!0,disabled:y,mi:4,title:_(\"Accounts_SetDefaultAvatar\"),onClick:()=>{I(\"/avatar/%40\".concat(t)),b(\"reset\")}},f.createElement(i,{url:\"/avatar/%40\".concat(t)})),f.createElement(o,{icon:\"upload\",secondary:!0,disabled:y,title:_(\"Upload\"),mi:4,onClick:q}),f.createElement(o,{icon:\"permalink\",secondary:!0,disabled:y||!D,title:_(\"Add_URL\"),mi:4,onClick:()=>{I(D),b({avatarUrl:D})},\"data-qa-id\":\"UserAvatarEditorSetAvatarLink\"}),f.createElement(E,{disabled:y,onSelectOne:R})),f.createElement(s,{htmlFor:w,mis:4},_(\"Use_url_for_avatar\")),f.createElement(n,{\"data-qa-id\":\"UserAvatarEditorLink\",id:w,flexGrow:0,placeholder:_(\"Use_url_for_avatar\"),value:D,mis:4,onChange:e=>{F(e.currentTarget.value)}}))))})}","map":"{\"version\":3,\"sources\":[\"client/components/avatar/UserAvatarEditor/UserAvatarEditor.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IUser, AvatarObject } from '@rocket.chat/core-typings';\\nimport { Box, Button, Avatar, TextInput, IconButton, Label } from '@rocket.chat/fuselage';\\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\\nimport { UserAvatar } from '@rocket.chat/ui-avatar';\\nimport { useToastMessageDispatch, useSetting } from '@rocket.chat/ui-contexts';\\nimport type { ReactElement, ChangeEvent } from 'react';\\nimport React, { useState, useCallback } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { useSingleFileInput } from '../../../hooks/useSingleFileInput';\\nimport { isValidImageFormat } from '../../../lib/utils/isValidImageFormat';\\nimport type { UserAvatarSuggestion } from './UserAvatarSuggestion';\\nimport UserAvatarSuggestions from './UserAvatarSuggestions';\\nimport { readFileAsDataURL } from './readFileAsDataURL';\\n\\ntype UserAvatarEditorProps = {\\n\\tcurrentUsername: IUser['username'];\\n\\tusername: IUser['username'];\\n\\tsetAvatarObj: (obj: AvatarObject) => void;\\n\\tdisabled?: boolean;\\n\\tetag: IUser['avatarETag'];\\n};\\n\\nfunction UserAvatarEditor({ currentUsername, username, setAvatarObj, disabled, etag }: UserAvatarEditorProps): ReactElement {\\n\\tconst { t } = useTranslation();\\n\\tconst rotateImages = useSetting('FileUpload_RotateImages');\\n\\tconst [avatarFromUrl, setAvatarFromUrl] = useState('');\\n\\tconst [newAvatarSource, setNewAvatarSource] = useState<string>();\\n\\tconst imageUrlField = useUniqueId();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst setUploadedPreview = useCallback(\\n\\t\\tasync (file, avatarObj) => {\\n\\t\\t\\tsetAvatarObj(avatarObj);\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tconst dataURL = await readFileAsDataURL(file);\\n\\n\\t\\t\\t\\tif (await isValidImageFormat(dataURL)) {\\n\\t\\t\\t\\t\\tsetNewAvatarSource(dataURL);\\n\\t\\t\\t\\t}\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('Avatar_format_invalid') });\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\t[setAvatarObj, t, dispatchToastMessage],\\n\\t);\\n\\n\\tconst [clickUpload] = useSingleFileInput(setUploadedPreview);\\n\\n\\tconst handleAddUrl = (): void => {\\n\\t\\tsetNewAvatarSource(avatarFromUrl);\\n\\t\\tsetAvatarObj({ avatarUrl: avatarFromUrl });\\n\\t};\\n\\n\\tconst clickReset = (): void => {\\n\\t\\tsetNewAvatarSource(`/avatar/%40${username}`);\\n\\t\\tsetAvatarObj('reset');\\n\\t};\\n\\n\\tconst url = newAvatarSource;\\n\\n\\tconst handleAvatarFromUrlChange = (event: ChangeEvent<HTMLInputElement>): void => {\\n\\t\\tsetAvatarFromUrl(event.currentTarget.value);\\n\\t};\\n\\n\\tconst handleSelectSuggestion = useCallback(\\n\\t\\t(suggestion: UserAvatarSuggestion) => {\\n\\t\\t\\tsetAvatarObj(suggestion as unknown as AvatarObject);\\n\\t\\t\\tsetNewAvatarSource(suggestion.blob);\\n\\t\\t},\\n\\t\\t[setAvatarObj, setNewAvatarSource],\\n\\t);\\n\\n\\treturn (\\n\\t\\t<Box display='flex' flexDirection='column' fontScale='p2m' color='default'>\\n\\t\\t\\t{t('Profile_picture')}\\n\\t\\t\\t<Box display='flex' flexDirection='row' mbs={4}>\\n\\t\\t\\t\\t<UserAvatar\\n\\t\\t\\t\\t\\tsize='x124'\\n\\t\\t\\t\\t\\turl={url}\\n\\t\\t\\t\\t\\tkey={url}\\n\\t\\t\\t\\t\\tdata-qa-id='UserAvatarEditor'\\n\\t\\t\\t\\t\\tusername={currentUsername || ''}\\n\\t\\t\\t\\t\\tetag={etag}\\n\\t\\t\\t\\t\\tstyle={{\\n\\t\\t\\t\\t\\t\\timageOrientation: rotateImages ? 'from-image' : 'none',\\n\\t\\t\\t\\t\\t\\tobjectFit: 'contain',\\n\\t\\t\\t\\t\\t}}\\n\\t\\t\\t\\t\\tonError={() => dispatchToastMessage({ type: 'error', message: t('error-invalid-image-url') })}\\n\\t\\t\\t\\t/>\\n\\t\\t\\t\\t<Box display='flex' flexDirection='column' flexGrow='1' justifyContent='space-between' mis={4}>\\n\\t\\t\\t\\t\\t<Box display='flex' flexDirection='row' mbs='none'>\\n\\t\\t\\t\\t\\t\\t<Button square disabled={disabled} mi={4} title={t('Accounts_SetDefaultAvatar')} onClick={clickReset}>\\n\\t\\t\\t\\t\\t\\t\\t<Avatar url={`/avatar/%40${username}`} />\\n\\t\\t\\t\\t\\t\\t</Button>\\n\\t\\t\\t\\t\\t\\t<IconButton icon='upload' secondary disabled={disabled} title={t('Upload')} mi={4} onClick={clickUpload} />\\n\\t\\t\\t\\t\\t\\t<IconButton\\n\\t\\t\\t\\t\\t\\t\\ticon='permalink'\\n\\t\\t\\t\\t\\t\\t\\tsecondary\\n\\t\\t\\t\\t\\t\\t\\tdisabled={disabled || !avatarFromUrl}\\n\\t\\t\\t\\t\\t\\t\\ttitle={t('Add_URL')}\\n\\t\\t\\t\\t\\t\\t\\tmi={4}\\n\\t\\t\\t\\t\\t\\t\\tonClick={handleAddUrl}\\n\\t\\t\\t\\t\\t\\t\\tdata-qa-id='UserAvatarEditorSetAvatarLink'\\n\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t<UserAvatarSuggestions disabled={disabled} onSelectOne={handleSelectSuggestion} />\\n\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t<Label htmlFor={imageUrlField} mis={4}>\\n\\t\\t\\t\\t\\t\\t{t('Use_url_for_avatar')}\\n\\t\\t\\t\\t\\t</Label>\\n\\t\\t\\t\\t\\t<TextInput\\n\\t\\t\\t\\t\\t\\tdata-qa-id='UserAvatarEditorLink'\\n\\t\\t\\t\\t\\t\\tid={imageUrlField}\\n\\t\\t\\t\\t\\t\\tflexGrow={0}\\n\\t\\t\\t\\t\\t\\tplaceholder={t('Use_url_for_avatar')}\\n\\t\\t\\t\\t\\t\\tvalue={avatarFromUrl}\\n\\t\\t\\t\\t\\t\\tmis={4}\\n\\t\\t\\t\\t\\t\\tonChange={handleAvatarFromUrlChange}\\n\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t</Box>\\n\\t\\t\\t</Box>\\n\\t\\t</Box>\\n\\t);\\n}\\n\\nexport default UserAvatarEditor;\\n\",null],\"names\":[\"Box\",\"Button\",\"Avatar\",\"TextInput\",\"IconButton\",\"Label\",\"useUniqueId\",\"UserAvatar\",\"useToastMessageDispatch\",\"useSetting\",\"React\",\"useState\",\"useCallback\",\"useTranslation\",\"useSingleFileInput\",\"isValidImageFormat\",\"UserAvatarSuggestions\",\"readFileAsDataURL\",\"module\",\"link\",\"v\",\"default\",\"exportDefault\",\"_ref\",\"currentUsername\",\"username\",\"setAvatarObj\",\"disabled\",\"etag\",\"t\",\"rotateImages\",\"avatarFromUrl\",\"setAvatarFromUrl\",\"newAvatarSource\",\"setNewAvatarSource\",\"imageUrlField\",\"dispatchToastMessage\",\"setUploadedPreview\",\"file\",\"avatarObj\",\"dataURL\",\"error\",\"type\",\"message\",\"clickUpload\",\"handleSelectSuggestion\",\"suggestion\",\"blob\",\"createElement\",\"display\",\"flexDirection\",\"fontScale\",\"color\",\"mbs\",\"size\",\"url\",\"key\",\"style\",\"imageOrientation\",\"objectFit\",\"onError\",\"flexGrow\",\"justifyContent\",\"mis\",\"square\",\"mi\",\"title\",\"onClick\",\"clickReset\",\"concat\",\"icon\",\"secondary\",\"handleAddUrl\",\"avatarUrl\",\"onSelectOne\",\"htmlFor\",\"id\",\"placeholder\",\"value\",\"onChange\",\"event\",\"currentTarget\"],\"mappings\":\"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\"}"}