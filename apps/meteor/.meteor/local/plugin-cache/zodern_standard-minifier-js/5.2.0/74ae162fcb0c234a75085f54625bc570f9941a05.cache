{"code":"function module(e,n,t){let r,l,o,u,a;t.link(\"@rocket.chat/fuselage\",{Box(e){r=e}},0),t.link(\"react\",{default(e){l=e},useCallback(e){o=e},useEffect(e){u=e},useRef(e){a=e}},1);let i=e=>{u(()=>{let n=n=>{\"Escape\"===n.key&&(n.stopPropagation(),null==e||e())};return window.addEventListener(\"keydown\",n),()=>{window.removeEventListener(\"keydown\",n)}},[e])},c=(e,n)=>{var t;let r=n.current,{parentElement:l}=e.target;return null!==(t=!!l&&(null==r?void 0:r.contains(l)))&&void 0!==t&&t},s=(e,n)=>{let t=a(!1),r=o(n=>{if(c(n,e)){t.current=!1;return}t.current=!0},[e]),l=o(r=>{if(c(r,e)){t.current=!1;return}t.current&&(t.current=!1,r.stopPropagation(),null==n||n())},[n,e]);return{onMouseDown:r,onMouseUp:l}};t.exportDefault(e=>{let{children:n,onDismiss:t}=e,o=a(null);i(t);let{onMouseDown:u,onMouseUp:c}=s(o,t);return l.createElement(r,{ref:o,children:n,className:\"rcx-modal__backdrop\",position:\"fixed\",zIndex:9999,inset:0,display:\"flex\",flexDirection:\"column\",onMouseDown:u,onMouseUp:c})})}","map":"{\"version\":3,\"sources\":[\"client/components/ModalBackdrop.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Box } from '@rocket.chat/fuselage';\\nimport type { MouseEvent, ReactElement, ReactNode, RefObject } from 'react';\\nimport React, { useCallback, useEffect, useRef } from 'react';\\n\\nconst useEscapeKey = (onDismiss: (() => void) | undefined): void => {\\n\\tuseEffect(() => {\\n\\t\\tconst closeOnEsc = (e: KeyboardEvent): void => {\\n\\t\\t\\tif (e.key !== 'Escape') {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\te.stopPropagation();\\n\\t\\t\\tonDismiss?.();\\n\\t\\t};\\n\\n\\t\\twindow.addEventListener('keydown', closeOnEsc);\\n\\n\\t\\treturn (): void => {\\n\\t\\t\\twindow.removeEventListener('keydown', closeOnEsc);\\n\\t\\t};\\n\\t}, [onDismiss]);\\n};\\n\\nconst isAtBackdropChildren = (e: MouseEvent, ref: RefObject<HTMLElement>): boolean => {\\n\\tconst backdrop = ref.current;\\n\\tconst { parentElement } = e.target as HTMLElement;\\n\\n\\treturn (Boolean(parentElement) && backdrop?.contains(parentElement)) ?? false;\\n};\\n\\nconst useOutsideClick = (\\n\\tref: RefObject<HTMLElement>,\\n\\tonDismiss: (() => void) | undefined,\\n): {\\n\\tonMouseDown: (e: MouseEvent) => void;\\n\\tonMouseUp: (e: MouseEvent) => void;\\n} => {\\n\\tconst hasClicked = useRef<boolean>(false);\\n\\n\\tconst onMouseDown = useCallback(\\n\\t\\t(e) => {\\n\\t\\t\\tif (isAtBackdropChildren(e, ref)) {\\n\\t\\t\\t\\thasClicked.current = false;\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\thasClicked.current = true;\\n\\t\\t},\\n\\t\\t[ref],\\n\\t);\\n\\n\\tconst onMouseUp = useCallback(\\n\\t\\t(e: MouseEvent) => {\\n\\t\\t\\tif (isAtBackdropChildren(e, ref)) {\\n\\t\\t\\t\\thasClicked.current = false;\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tif (!hasClicked.current) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\thasClicked.current = false;\\n\\t\\t\\te.stopPropagation();\\n\\t\\t\\tonDismiss?.();\\n\\t\\t},\\n\\t\\t[onDismiss, ref],\\n\\t);\\n\\n\\treturn {\\n\\t\\tonMouseDown,\\n\\t\\tonMouseUp,\\n\\t};\\n};\\n\\ntype ModalBackdropProps = {\\n\\tchildren?: ReactNode;\\n\\tonDismiss?: () => void;\\n};\\n\\nconst ModalBackdrop = ({ children, onDismiss }: ModalBackdropProps): ReactElement => {\\n\\tconst ref = useRef<HTMLDivElement>(null);\\n\\n\\tuseEscapeKey(onDismiss);\\n\\tconst { onMouseDown, onMouseUp } = useOutsideClick(ref, onDismiss);\\n\\n\\treturn (\\n\\t\\t<Box\\n\\t\\t\\tref={ref}\\n\\t\\t\\tchildren={children}\\n\\t\\t\\tclassName='rcx-modal__backdrop'\\n\\t\\t\\tposition='fixed'\\n\\t\\t\\tzIndex={9999}\\n\\t\\t\\tinset={0}\\n\\t\\t\\tdisplay='flex'\\n\\t\\t\\tflexDirection='column'\\n\\t\\t\\tonMouseDown={onMouseDown}\\n\\t\\t\\tonMouseUp={onMouseUp}\\n\\t\\t/>\\n\\t);\\n};\\n\\nexport default ModalBackdrop;\\n\",null],\"names\":[\"Box\",\"React\",\"useCallback\",\"useEffect\",\"useRef\",\"module\",\"link\",\"v\",\"default\",\"useEscapeKey\",\"onDismiss\",\"closeOnEsc\",\"e\",\"key\",\"stopPropagation\",\"window\",\"addEventListener\",\"removeEventListener\",\"isAtBackdropChildren\",\"ref\",\"_ref\",\"backdrop\",\"current\",\"parentElement\",\"target\",\"Boolean\",\"contains\",\"useOutsideClick\",\"hasClicked\",\"onMouseDown\",\"onMouseUp\",\"exportDefault\",\"_ref2\",\"children\",\"createElement\",\"className\",\"position\",\"zIndex\",\"inset\",\"display\",\"flexDirection\"],\"mappings\":\"2BAAAA,EAA4CC,EAAAC,EAAAC,EAAAC,EAArCC,EAAOC,IAAA,CAAM,wBAAwB,CAAAN,IAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,QAAA,CAAAE,QAAAD,CAAA,EAAAN,EAAAM,CAAA,EAAAL,YAAAK,CAAA,EAAAL,EAAAK,CAAA,EAAAJ,UAAAI,CAAA,EAAAJ,EAAAI,CAAA,EAAAH,OAAAG,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,GAI5C,IAAME,EAAgBC,IACrBP,EAAU,KACT,IAAMQ,EAAcC,IACL,WAAVA,EAAEC,GAAG,GAITD,EAAEE,eAAe,GACjBJ,MAAAA,GAAAA,IACD,EAIA,OAFAK,OAAOC,gBAAgB,CAAC,UAAWL,GAE5B,KACNI,OAAOE,mBAAmB,CAAC,UAAWN,EACvC,CACD,EAAG,CAACD,EAAU,CACf,EAEMQ,EAAuBA,CAACN,EAAeO,KAAwC,IAAAC,EACpF,IAAMC,EAAWF,EAAIG,OAAO,CACtB,CAAEC,cAAAA,CAAAA,CAAe,CAAGX,EAAEY,MAAqB,CAEjD,OAAA,AAAmE,OAAnEJ,CAAAA,EAAQK,CAAAA,CAAQF,GAAkBF,CAAAA,MAAAA,EAAQ,KAAA,EAARA,EAAUK,QAAQ,CAACH,EAAa,CAAC,GAAAH,AAAA,KAAA,IAAAA,GAAAA,CACpE,EAEMO,EAAkBA,CACvBR,EACAT,KAKA,IAAMkB,EAAaxB,EAAgB,CAAA,GAE7ByB,EAAc3B,EAClBU,IACA,GAAIM,EAAqBN,EAAGO,GAAM,CACjCS,EAAWN,OAAO,CAAG,CAAA,EACrB,MACD,CAEAM,EAAWN,OAAO,CAAG,CAAA,CACtB,EACA,CAACH,EAAI,EAGAW,EAAY5B,EAChBU,IACA,GAAIM,EAAqBN,EAAGO,GAAM,CACjCS,EAAWN,OAAO,CAAG,CAAA,EACrB,MACD,CAEKM,EAAWN,OAAO,GAIvBM,EAAWN,OAAO,CAAG,CAAA,EACrBV,EAAEE,eAAe,GACjBJ,MAAAA,GAAAA,IACD,EACA,CAACA,EAAWS,EAAI,EAGjB,MAAO,CACNU,YAAAA,EACAC,UAAAA,EAEF,EAzEAzB,EAAO0B,aAAa,CAgFEC,IAA8D,GAA7D,CAAEC,SAAAA,CAAQ,CAAEvB,UAAAA,CAAAA,CAA+B,CAAAsB,EAC3Db,EAAMf,EAAuB,MAEnCK,EAAaC,GACb,GAAM,CAAEmB,YAAAA,CAAW,CAAEC,UAAAA,CAAAA,CAAW,CAAGH,EAAgBR,EAAKT,GAExD,OACCT,EAAAiC,aAAA,CAAClC,EAAG,CACHmB,IAAKA,EACLc,SAAUA,EACVE,UAAU,sBACVC,SAAS,QACTC,OAAQ,KACRC,MAAO,EACPC,QAAQ,OACRC,cAAc,SACdX,YAAaA,EACbC,UAAWA,CAAU,EAGxB\"}"}