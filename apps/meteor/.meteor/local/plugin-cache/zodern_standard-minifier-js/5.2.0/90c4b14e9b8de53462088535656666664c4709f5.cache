{"code":"function module(e,s,n){let i,t,r,a,o,p;n.link(\"meteor/meteor\",{Meteor(e){i=e}},0),n.link(\"../../app/models/client\",{ChatMessage(e){t=e},ChatSubscription(e){r=e}},1),n.link(\"../../app/settings/client\",{settings(e){a=e}},2),n.link(\"../../app/utils/lib/i18n\",{t(e){o=e}},3),n.link(\"../lib/toast\",{dispatchToastMessage(e){p=e}},4),i.methods({unpinMessage:e=>i.userId()?a.get(\"Message_AllowPinning\")?r.findOne({rid:e.rid})&&\"string\"==typeof e._id?(p({type:\"success\",message:o(\"Message_has_been_unpinned\")}),t.update({_id:e._id,rid:e.rid},{$set:{pinned:!1}}),!0):(p({type:\"error\",message:o(\"error-unpinning-message\")}),!1):(p({type:\"error\",message:o(\"unpinning-not-allowed\")}),!1):(p({type:\"error\",message:o(\"error-not-authorized\")}),!1)})}","map":"{\"version\":3,\"sources\":[\"client/methods/unpinMessage.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IMessage } from '@rocket.chat/core-typings';\\nimport type { ServerMethods } from '@rocket.chat/ddp-client';\\nimport { Meteor } from 'meteor/meteor';\\n\\nimport { ChatMessage, ChatSubscription } from '../../app/models/client';\\nimport { settings } from '../../app/settings/client';\\nimport { t } from '../../app/utils/lib/i18n';\\nimport { dispatchToastMessage } from '../lib/toast';\\n\\nMeteor.methods<ServerMethods>({\\n\\tunpinMessage(message: IMessage) {\\n\\t\\tif (!Meteor.userId()) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('error-not-authorized') });\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\t\\tif (!settings.get('Message_AllowPinning')) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('unpinning-not-allowed') });\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\t\\tif (!ChatSubscription.findOne({ rid: message.rid })) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('error-unpinning-message') });\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\t\\tif (typeof message._id !== 'string') {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: t('error-unpinning-message') });\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\t\\tdispatchToastMessage({ type: 'success', message: t('Message_has_been_unpinned') });\\n\\t\\tChatMessage.update(\\n\\t\\t\\t{\\n\\t\\t\\t\\t_id: message._id,\\n\\t\\t\\t\\trid: message.rid,\\n\\t\\t\\t},\\n\\t\\t\\t{\\n\\t\\t\\t\\t$set: {\\n\\t\\t\\t\\t\\tpinned: false,\\n\\t\\t\\t\\t},\\n\\t\\t\\t},\\n\\t\\t);\\n\\n\\t\\treturn true;\\n\\t},\\n});\\n\",null],\"names\":[\"Meteor\",\"ChatMessage\",\"ChatSubscription\",\"settings\",\"t\",\"dispatchToastMessage\",\"module\",\"link\",\"v\",\"methods\",\"unpinMessage\",\"message\",\"userId\",\"get\",\"findOne\",\"rid\",\"_id\",\"type\",\"update\",\"$set\",\"pinned\"],\"mappings\":\"2BAEAA,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAP,OAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,0BAAA,CAAAN,YAAAO,CAAA,EAAAP,EAAAO,CAAA,EAAAN,iBAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,4BAAA,CAAAJ,SAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,2BAAA,CAAAH,EAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,eAAA,CAAAF,qBAAAG,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,GAOvCR,EAAOS,OAAO,CAAgB,CAC7BC,aAAAA,AAAaC,GACZ,AAAKX,EAAOY,MAAM,GAIbT,EAASU,GAAG,CAAC,wBAIbX,EAAiBY,OAAO,CAAC,CAAEC,IAAKJ,EAAQI,GAAAA,AAAG,IAI5C,AAAuB,UAAvB,OAAOJ,EAAQK,GAAG,EAItBX,EAAqB,CAAEY,KAAM,UAAWN,QAASP,EAAE,4BAA4B,GAC/EH,EAAYiB,MAAM,CACjB,CACCF,IAAKL,EAAQK,GAAG,CAChBD,IAAKJ,EAAQI,GAAAA,EAEd,CACCI,KAAM,CACLC,OAAQ,CAAA,KAKJ,CAAA,IApBNf,EAAqB,CAAEY,KAAM,QAASN,QAASP,EAAE,0BAA0B,GACpE,CAAA,IALPC,EAAqB,CAAEY,KAAM,QAASN,QAASP,EAAE,wBAAwB,GAClE,CAAA,IALPC,EAAqB,CAAEY,KAAM,QAASN,QAASP,EAAE,uBAAuB,GACjE,CAAA\"}"}