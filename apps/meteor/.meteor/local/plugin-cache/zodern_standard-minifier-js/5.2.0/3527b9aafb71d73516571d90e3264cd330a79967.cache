{"code":"function module(e,t,a){var n,r,i,c,l,u,s,o,f,d,h,b,p,m,k,v=[\"departmentId\",\"dateRange\",\"chartName\"];a.link(\"@babel/runtime/regenerator\",{default:function(e){n=e}},0),a.link(\"@babel/runtime/helpers/extends\",{default:function(e){r=e}},1),a.link(\"@babel/runtime/helpers/objectSpread2\",{default:function(e){i=e}},2),a.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default:function(e){c=e}},3),a.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){l=e}},4),a.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback:function(e){u=e}},0),a.link(\"@rocket.chat/ui-contexts\",{useToastMessageDispatch:function(e){s=e},useMethod:function(e){o=e}},1),a.link(\"react\",{default:function(e){f=e},useRef:function(e){d=e},useEffect:function(e){h=e}},2),a.link(\"react-i18next\",{useTranslation:function(e){b=e}},3),a.link(\"../../../../app/livechat/client/lib/chartHandler\",{drawLineChart:function(e){p=e}},4),a.link(\"../../../../lib/utils/secondsToHHMMSS\",{secondsToHHMMSS:function(e){m=e}},5),a.link(\"../realTimeMonitoring/charts/Chart\",{default:function(e){k=e}},6);var g=function(e){switch(e){case\"Avg_chat_duration\":case\"Avg_first_response_time\":case\"Best_first_response_time\":case\"Avg_response_time\":case\"Avg_reaction_time\":return{callbacks:{title:function(e){return l(e,1)[0].dataset.label},label:function(e){var t=e.dataset,a=e.dataIndex,n=t.data[a];return m(\"number\"==typeof n?n:0)}}};default:return{}}};a.exportDefault(function(e){var t=e.departmentId,a=e.dateRange,l=e.chartName,m=c(e,v),x=b().t,_=s(),M=d(null),A=d(),w=a.start,y=a.end,C=o(\"livechat:getAnalyticsChartData\"),D=u(function(e){var t,a,r,i;return n.async(function(c){for(;;)switch(c.prev=c.next){case 0:if(c.prev=0,r=g(l),!(!(null!=e&&null!==(t=e.daterange)&&void 0!==t&&t.from)||!(null!=e&&null!==(a=e.daterange)&&void 0!==a&&a.to))){c.next=4;break}return c.abrupt(\"return\");case 4:return c.next=6,n.awrap(C(e));case 6:if(!(!(null!=(i=c.sent)&&i.chartLabel)||!(null!=i&&i.dataLabels)||!(null!=i&&i.dataPoints))){c.next=9;break}throw Error(\"Error! fetching chart data. Details: livechat:getAnalyticsChartData => Missing Data\");case 9:if(c.t0=(A.current||void 0===A.current)&&M.current,!c.t0){c.next=14;break}return c.next=13,n.awrap(p(M.current,A.current,[i.chartLabel],i.dataLabels,[i.dataPoints],{tooltipCallbacks:r}));case 13:A.current=c.sent;case 14:c.next=19;break;case 16:c.prev=16,c.t1=c.catch(0),_({type:\"error\",message:c.t1});case 19:case\"end\":return c.stop()}},null,null,[[0,16]],Promise)});return h(function(){D(i({daterange:{from:w,to:y},chartOptions:{name:l}},t&&{departmentId:t}))},[l,t,D,y,w,x,C]),f.createElement(k,r({canvasRef:M},m))})}","map":"{\"version\":3,\"sources\":[\"client/views/omnichannel/analytics/InterchangeableChart.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useToastMessageDispatch, useMethod } from '@rocket.chat/ui-contexts';\\nimport type * as chartjs from 'chart.js';\\nimport React, { useRef, useEffect } from 'react';\\nimport { useTranslation } from 'react-i18next';\\n\\nimport { drawLineChart } from '../../../../app/livechat/client/lib/chartHandler';\\nimport { secondsToHHMMSS } from '../../../../lib/utils/secondsToHHMMSS';\\nimport Chart from '../realTimeMonitoring/charts/Chart';\\n\\nconst getChartTooltips = (chartName: string) => {\\n\\tswitch (chartName) {\\n\\t\\tcase 'Avg_chat_duration':\\n\\t\\tcase 'Avg_first_response_time':\\n\\t\\tcase 'Best_first_response_time':\\n\\t\\tcase 'Avg_response_time':\\n\\t\\tcase 'Avg_reaction_time':\\n\\t\\t\\treturn {\\n\\t\\t\\t\\tcallbacks: {\\n\\t\\t\\t\\t\\ttitle([ctx]: [chartjs.TooltipItem<'line'>]) {\\n\\t\\t\\t\\t\\t\\tconst { dataset } = ctx;\\n\\t\\t\\t\\t\\t\\treturn dataset.label;\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\tlabel(ctx: chartjs.TooltipItem<'line'>) {\\n\\t\\t\\t\\t\\t\\tconst { dataset, dataIndex } = ctx;\\n\\t\\t\\t\\t\\t\\tconst item = dataset.data[dataIndex];\\n\\t\\t\\t\\t\\t\\treturn secondsToHHMMSS(typeof item === 'number' ? item : 0);\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t},\\n\\t\\t\\t};\\n\\t\\tdefault:\\n\\t\\t\\treturn {};\\n\\t}\\n};\\n\\nconst InterchangeableChart = ({\\n\\tdepartmentId,\\n\\tdateRange,\\n\\tchartName,\\n\\t...props\\n}: {\\n\\tdepartmentId: string;\\n\\tdateRange: { start: string; end: string };\\n\\tchartName: string;\\n\\tflexShrink: number;\\n\\th: string;\\n\\tw: string;\\n\\talignSelf: string;\\n}) => {\\n\\tconst { t } = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst canvas = useRef<HTMLCanvasElement | null>(null);\\n\\tconst context = useRef<chartjs.Chart<'line', number[], string>>();\\n\\n\\tconst { start, end } = dateRange;\\n\\n\\tconst loadData = useMethod('livechat:getAnalyticsChartData');\\n\\n\\tconst draw = useMutableCallback(async (params) => {\\n\\t\\ttry {\\n\\t\\t\\tconst tooltipCallbacks = getChartTooltips(chartName);\\n\\t\\t\\tif (!params?.daterange?.from || !params?.daterange?.to) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t\\tconst result = await loadData(params);\\n\\t\\t\\tif (!result?.chartLabel || !result?.dataLabels || !result?.dataPoints) {\\n\\t\\t\\t\\tthrow new Error('Error! fetching chart data. Details: livechat:getAnalyticsChartData => Missing Data');\\n\\t\\t\\t}\\n\\t\\t\\t(context.current || typeof context.current === 'undefined') &&\\n\\t\\t\\t\\tcanvas.current &&\\n\\t\\t\\t\\t(context.current = await drawLineChart(\\n\\t\\t\\t\\t\\tcanvas.current,\\n\\t\\t\\t\\t\\tcontext.current,\\n\\t\\t\\t\\t\\t[result.chartLabel],\\n\\t\\t\\t\\t\\tresult.dataLabels,\\n\\t\\t\\t\\t\\t[result.dataPoints],\\n\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\ttooltipCallbacks,\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t));\\n\\t\\t} catch (error) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t}\\n\\t});\\n\\n\\tuseEffect(() => {\\n\\t\\tdraw({\\n\\t\\t\\tdaterange: {\\n\\t\\t\\t\\tfrom: start,\\n\\t\\t\\t\\tto: end,\\n\\t\\t\\t},\\n\\t\\t\\tchartOptions: { name: chartName },\\n\\t\\t\\t...(departmentId && { departmentId }),\\n\\t\\t});\\n\\t}, [chartName, departmentId, draw, end, start, t, loadData]);\\n\\n\\treturn <Chart canvasRef={canvas} {...props} />;\\n};\\n\\nexport default InterchangeableChart;\\n\",null],\"names\":[\"_regeneratorRuntime\",\"_extends\",\"_objectSpread\",\"_objectWithoutProperties\",\"_slicedToArray\",\"useMutableCallback\",\"useToastMessageDispatch\",\"useMethod\",\"React\",\"useRef\",\"useEffect\",\"useTranslation\",\"drawLineChart\",\"secondsToHHMMSS\",\"Chart\",\"module\",\"link\",\"default\",\"v\",\"getChartTooltips\",\"chartName\",\"callbacks\",\"title\",\"_ref\",\"dataset\",\"ctx\",\"_ref2\",\"label\",\"dataIndex\",\"item\",\"data\",\"exportDefault\",\"_ref3\",\"departmentId\",\"dateRange\",\"props\",\"_excluded\",\"t\",\"_useTranslation\",\"dispatchToastMessage\",\"canvas\",\"context\",\"start\",\"end\",\"loadData\",\"draw\",\"params\",\"_params$daterange\",\"_params$daterange2\",\"tooltipCallbacks\",\"result\",\"async\",\"_context\",\"prev\",\"next\",\"daterange\",\"from\",\"to\",\"abrupt\",\"awrap\",\"sent\",\"chartLabel\",\"dataLabels\",\"dataPoints\",\"Error\",\"t0\",\"current\",\"t1\",\"type\",\"message\",\"stop\",\"Promise\",\"chartOptions\",\"name\",\"createElement\",\"canvasRef\"],\"mappings\":\"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\"}"}