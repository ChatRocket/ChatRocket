{"code":"function module(e,t,n){var a,c,l,r,i,s,o,u,f,m,p,d,E,v,k,g=[\"email\",\"step\",\"setStep\",\"onClose\",\"intentData\",\"onSuccess\"];n.link(\"@babel/runtime/regenerator\",{default:function(e){a=e}},0),n.link(\"@babel/runtime/helpers/objectWithoutProperties\",{default:function(e){c=e}},1),n.link(\"@rocket.chat/fuselage\",{Modal:function(e){l=e},Box:function(e){r=e},Field:function(e){i=e},FieldLabel:function(e){s=e},FieldRow:function(e){o=e},TextInput:function(e){u=e}},0),n.link(\"@rocket.chat/ui-contexts\",{useEndpoint:function(e){f=e},useToastMessageDispatch:function(e){m=e}},1),n.link(\"react\",{default:function(e){p=e},useCallback:function(e){d=e},useEffect:function(e){E=e}},2),n.link(\"react-i18next\",{useTranslation:function(e){v=e},Trans:function(e){k=e}},3),n.exportDefault(function(e){var t=e.email,n=e.step,_=e.setStep,S=e.onClose,b=e.intentData,x=e.onSuccess,h=c(e,g),C=v().t,y=m(),T=f(\"GET\",\"/v1/cloud.confirmationPoll\"),w=f(\"POST\",\"/v1/cloud.createRegistrationIntent\"),D=d(function(){var e;return a.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a.awrap(T({deviceCode:b.device_code}));case 3:\"successful\"in(e=t.sent.pollData)&&e.successful&&(y({type:\"success\",message:C(\"Workspace_registered\")}),x()),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case\"end\":return t.stop()}},null,null,[[0,8]],Promise)},[T,b.device_code,y,C,x]);return E(function(){var e,t=setInterval(function(){return D()},(e=b.interval)?1e3*e:0);return function(){return clearInterval(t)}},[D,b]),p.createElement(l,h,p.createElement(l.Header,null,p.createElement(l.HeaderText,null,p.createElement(l.Tagline,null,C(\"RegisterWorkspace_Setup_Steps\",{step:n,numberOfSteps:2})),p.createElement(l.Title,null,C(\"Awaiting_confirmation\"))),p.createElement(l.Close,{onClick:S})),p.createElement(l.Content,null,p.createElement(r,{fontSize:\"p2\"},p.createElement(r,null,p.createElement(k,{i18nKey:\"RegisterWorkspace_Setup_Email_Confirmation\"},p.createElement(r,{is:\"p\"},\"Email sent to\",\" \",p.createElement(r,{is:\"span\",fontScale:\"p2b\"},t,\" \"),\"with a confirmation link.\"))),p.createElement(r,{is:\"p\"},C(\"RegisterWorkspace_Setup_Email_Verification\")),p.createElement(i,{pbs:10},p.createElement(s,null,C(\"Security_code\")),p.createElement(o,null,p.createElement(u,{defaultValue:b.user_code,disabled:!0}))))),p.createElement(l.Footer,null,p.createElement(r,{is:\"div\",display:\"flex\",justifyContent:\"start\",fontSize:\"c1\",w:\"full\"},\"Didn’t receive email?\",\" \",p.createElement(r,{is:\"a\",pi:4,onClick:function(){return a.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.awrap(w({resend:!0,email:t}));case 3:y({type:\"success\",message:C(\"Email_sent\")}),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),y({type:\"error\",message:e.t0});case 9:case\"end\":return e.stop()}},null,null,[[0,6]],Promise)}},\"Resend\"),\" \",\"or\",\" \",p.createElement(r,{is:\"a\",pi:4,onClick:function(){return _(n-1)}},\"change email\"))))})}","map":"{\"version\":3,\"sources\":[\"client/views/admin/workspace/VersionCard/modals/RegisterWorkspaceSetupModal/RegisterWorkspaceSetupStepTwoModal.tsx\",\"<anon>\"],\"sourcesContent\":[\"import { Modal, Box, Field, FieldLabel, FieldRow, TextInput } from '@rocket.chat/fuselage';\\nimport { useEndpoint, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\\nimport React, { useCallback, useEffect } from 'react';\\nimport { useTranslation, Trans } from 'react-i18next';\\n\\ntype Props = {\\n\\temail: string;\\n\\tstep: number;\\n\\tsetStep: (step: number) => void;\\n\\tonClose: () => void;\\n\\tintentData: {\\n\\t\\tdevice_code: string;\\n\\t\\tinterval: number;\\n\\t\\tuser_code: string;\\n\\t};\\n\\tonSuccess: () => void;\\n};\\n\\nconst setIntervalTime = (interval?: number): number => (interval ? interval * 1000 : 0);\\n\\nconst RegisterWorkspaceSetupStepTwoModal = ({ email, step, setStep, onClose, intentData, onSuccess, ...props }: Props) => {\\n\\tconst { t } = useTranslation();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst cloudConfirmationPoll = useEndpoint('GET', '/v1/cloud.confirmationPoll');\\n\\tconst createRegistrationIntent = useEndpoint('POST', '/v1/cloud.createRegistrationIntent');\\n\\n\\tconst handleBackFromConfirmation = (): void => setStep(step - 1);\\n\\n\\tconst handleResendRegistrationEmail = async () => {\\n\\t\\ttry {\\n\\t\\t\\tawait createRegistrationIntent({ resend: true, email });\\n\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Email_sent') });\\n\\t\\t} catch (error: unknown) {\\n\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t}\\n\\t};\\n\\n\\tconst getConfirmation = useCallback(async () => {\\n\\t\\ttry {\\n\\t\\t\\tconst { pollData } = await cloudConfirmationPoll({\\n\\t\\t\\t\\tdeviceCode: intentData.device_code,\\n\\t\\t\\t});\\n\\n\\t\\t\\tif ('successful' in pollData && pollData.successful) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('Workspace_registered') });\\n\\t\\t\\t\\tonSuccess();\\n\\t\\t\\t}\\n\\t\\t} catch (error: any) {\\n\\t\\t\\tconsole.log(error);\\n\\t\\t}\\n\\t}, [cloudConfirmationPoll, intentData.device_code, dispatchToastMessage, t, onSuccess]);\\n\\n\\tuseEffect(() => {\\n\\t\\tconst pollInterval = setInterval(() => getConfirmation(), setIntervalTime(intentData.interval));\\n\\n\\t\\treturn (): void => clearInterval(pollInterval);\\n\\t}, [getConfirmation, intentData]);\\n\\n\\treturn (\\n\\t\\t<Modal {...props}>\\n\\t\\t\\t<Modal.Header>\\n\\t\\t\\t\\t<Modal.HeaderText>\\n\\t\\t\\t\\t\\t<Modal.Tagline>{t('RegisterWorkspace_Setup_Steps', { step, numberOfSteps: 2 })}</Modal.Tagline>\\n\\t\\t\\t\\t\\t<Modal.Title>{t('Awaiting_confirmation')}</Modal.Title>\\n\\t\\t\\t\\t</Modal.HeaderText>\\n\\t\\t\\t\\t<Modal.Close onClick={onClose} />\\n\\t\\t\\t</Modal.Header>\\n\\t\\t\\t<Modal.Content>\\n\\t\\t\\t\\t<Box fontSize='p2'>\\n\\t\\t\\t\\t\\t<Box>\\n\\t\\t\\t\\t\\t\\t<Trans i18nKey='RegisterWorkspace_Setup_Email_Confirmation'>\\n\\t\\t\\t\\t\\t\\t\\t<Box is='p'>\\n\\t\\t\\t\\t\\t\\t\\t\\tEmail sent to{' '}\\n\\t\\t\\t\\t\\t\\t\\t\\t<Box is='span' fontScale='p2b'>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t{email}{' '}\\n\\t\\t\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t\\t\\t\\twith a confirmation link.\\n\\t\\t\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t\\t</Trans>\\n\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t\\t<Box is='p'>{t('RegisterWorkspace_Setup_Email_Verification')}</Box>\\n\\t\\t\\t\\t\\t<Field pbs={10}>\\n\\t\\t\\t\\t\\t\\t<FieldLabel>{t('Security_code')}</FieldLabel>\\n\\t\\t\\t\\t\\t\\t<FieldRow>\\n\\t\\t\\t\\t\\t\\t\\t<TextInput defaultValue={intentData.user_code} disabled />\\n\\t\\t\\t\\t\\t\\t</FieldRow>\\n\\t\\t\\t\\t\\t</Field>\\n\\t\\t\\t\\t</Box>\\n\\t\\t\\t</Modal.Content>\\n\\t\\t\\t<Modal.Footer>\\n\\t\\t\\t\\t{/* FIXME: missing translation */}\\n\\t\\t\\t\\t<Box is='div' display='flex' justifyContent='start' fontSize='c1' w='full'>\\n\\t\\t\\t\\t\\tDidn’t receive email?{' '}\\n\\t\\t\\t\\t\\t<Box is='a' pi={4} onClick={handleResendRegistrationEmail}>\\n\\t\\t\\t\\t\\t\\tResend\\n\\t\\t\\t\\t\\t</Box>{' '}\\n\\t\\t\\t\\t\\tor{' '}\\n\\t\\t\\t\\t\\t<Box is='a' pi={4} onClick={handleBackFromConfirmation}>\\n\\t\\t\\t\\t\\t\\tchange email\\n\\t\\t\\t\\t\\t</Box>\\n\\t\\t\\t\\t</Box>\\n\\t\\t\\t</Modal.Footer>\\n\\t\\t</Modal>\\n\\t);\\n};\\n\\nexport default RegisterWorkspaceSetupStepTwoModal;\\n\",null],\"names\":[\"_regeneratorRuntime\",\"_objectWithoutProperties\",\"Modal\",\"Box\",\"Field\",\"FieldLabel\",\"FieldRow\",\"TextInput\",\"useEndpoint\",\"useToastMessageDispatch\",\"React\",\"useCallback\",\"useEffect\",\"useTranslation\",\"Trans\",\"module\",\"link\",\"default\",\"v\",\"exportDefault\",\"_ref\",\"email\",\"step\",\"setStep\",\"onClose\",\"intentData\",\"onSuccess\",\"props\",\"_excluded\",\"t\",\"_useTranslation\",\"dispatchToastMessage\",\"cloudConfirmationPoll\",\"createRegistrationIntent\",\"getConfirmation\",\"pollData\",\"async\",\"_context2\",\"prev\",\"next\",\"awrap\",\"deviceCode\",\"device_code\",\"_await$cloudConfirmat\",\"sent\",\"successful\",\"type\",\"message\",\"t0\",\"console\",\"log\",\"stop\",\"Promise\",\"interval\",\"pollInterval\",\"setInterval\",\"clearInterval\",\"createElement\",\"Header\",\"HeaderText\",\"Tagline\",\"numberOfSteps\",\"Title\",\"Close\",\"onClick\",\"Content\",\"fontSize\",\"i18nKey\",\"is\",\"fontScale\",\"pbs\",\"defaultValue\",\"user_code\",\"disabled\",\"Footer\",\"display\",\"justifyContent\",\"w\",\"pi\",\"_context\",\"resend\"],\"mappings\":\"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\"}"}