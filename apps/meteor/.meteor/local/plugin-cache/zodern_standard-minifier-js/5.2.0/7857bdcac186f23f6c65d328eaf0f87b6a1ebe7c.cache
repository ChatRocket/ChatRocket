{"code":"function module(e,t,n){let s,u,o,r,i,a,c;n.export({useDirectMessageAction:()=>m}),n.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback(e){s=e}},0),n.link(\"@rocket.chat/ui-contexts\",{useTranslation(e){u=e},usePermission(e){o=e},useRoute(e){r=e},useUserSubscription(e){i=e},useUserSubscriptionByName(e){a=e}},1),n.link(\"react\",{useMemo(e){c=e}},2);let l=(e,t,n,s)=>{var u;let o=e&&e.name!==s;return null!==(u=(n||t)&&o)&&void 0!==u&&u},m=(e,t)=>{var n;let m=u(),k=a(null!==(n=e.username)&&void 0!==n?n:\"\"),d=i(t),b=o(\"create-d\"),p=r(\"direct\"),v=l(d,k,b,e.username),h=s(()=>e.username&&p.push({rid:e.username})),M=c(()=>v?{content:m(\"Direct_Message\"),icon:\"balloon\",onClick:h,type:\"communication\"}:void 0,[h,v,m]);return M}}","map":"{\"version\":3,\"sources\":[\"client/views/room/hooks/useUserInfoActions/actions/useDirectMessageAction.ts\",\"<anon>\"],\"sourcesContent\":[\"import type { IRoom, IUser, ISubscription } from '@rocket.chat/core-typings';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport { useTranslation, usePermission, useRoute, useUserSubscription, useUserSubscriptionByName } from '@rocket.chat/ui-contexts';\\nimport { useMemo } from 'react';\\n\\nimport type { UserInfoAction, UserInfoActionType } from '../useUserInfoActions';\\n\\nconst getShouldOpenDirectMessage = (\\n\\tcurrentSubscription?: ISubscription,\\n\\tusernameSubscription?: ISubscription,\\n\\tcanOpenDirectMessage?: boolean,\\n\\tusername?: IUser['username'],\\n): boolean => {\\n\\tconst canOpenDm = canOpenDirectMessage || usernameSubscription;\\n\\tconst directMessageIsNotAlreadyOpen = currentSubscription && currentSubscription.name !== username;\\n\\treturn (canOpenDm && directMessageIsNotAlreadyOpen) ?? false;\\n};\\n\\nexport const useDirectMessageAction = (user: Pick<IUser, '_id' | 'username'>, rid: IRoom['_id']): UserInfoAction | undefined => {\\n\\tconst t = useTranslation();\\n\\tconst usernameSubscription = useUserSubscriptionByName(user.username ?? '');\\n\\tconst currentSubscription = useUserSubscription(rid);\\n\\tconst canOpenDirectMessage = usePermission('create-d');\\n\\tconst directRoute = useRoute('direct');\\n\\n\\tconst shouldOpenDirectMessage = getShouldOpenDirectMessage(\\n\\t\\tcurrentSubscription,\\n\\t\\tusernameSubscription,\\n\\t\\tcanOpenDirectMessage,\\n\\t\\tuser.username,\\n\\t);\\n\\n\\tconst openDirectMessage = useMutableCallback(\\n\\t\\t() =>\\n\\t\\t\\tuser.username &&\\n\\t\\t\\tdirectRoute.push({\\n\\t\\t\\t\\trid: user.username,\\n\\t\\t\\t}),\\n\\t);\\n\\n\\tconst openDirectMessageOption = useMemo(\\n\\t\\t() =>\\n\\t\\t\\tshouldOpenDirectMessage\\n\\t\\t\\t\\t? {\\n\\t\\t\\t\\t\\t\\tcontent: t('Direct_Message'),\\n\\t\\t\\t\\t\\t\\ticon: 'balloon' as const,\\n\\t\\t\\t\\t\\t\\tonClick: openDirectMessage,\\n\\t\\t\\t\\t\\t\\ttype: 'communication' as UserInfoActionType,\\n\\t\\t\\t\\t  }\\n\\t\\t\\t\\t: undefined,\\n\\t\\t[openDirectMessage, shouldOpenDirectMessage, t],\\n\\t);\\n\\n\\treturn openDirectMessageOption;\\n};\\n\",null],\"names\":[\"useMutableCallback\",\"useTranslation\",\"usePermission\",\"useRoute\",\"useUserSubscription\",\"useUserSubscriptionByName\",\"useMemo\",\"module\",\"export\",\"useDirectMessageAction\",\"link\",\"v\",\"getShouldOpenDirectMessage\",\"currentSubscription\",\"usernameSubscription\",\"canOpenDirectMessage\",\"username\",\"_ref\",\"directMessageIsNotAlreadyOpen\",\"name\",\"canOpenDm\",\"user\",\"rid\",\"_user$username\",\"t\",\"directRoute\",\"shouldOpenDirectMessage\",\"openDirectMessage\",\"push\",\"openDirectMessageOption\",\"content\",\"icon\",\"onClick\",\"type\",\"undefined\"],\"mappings\":\"2BACiEA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAjEC,EAAOC,MAAE,CAAA,CAAAC,uBAA0BA,IAAAA,CAA6B,GAACF,EAAAG,IAAA,CAAA,8BAAA,CAAAV,mBAAAW,CAAA,EAAAX,EAAAW,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,2BAAA,CAAAT,eAAAU,CAAA,EAAAV,EAAAU,CAAA,EAAAT,cAAAS,CAAA,EAAAT,EAAAS,CAAA,EAAAR,SAAAQ,CAAA,EAAAR,EAAAQ,CAAA,EAAAP,oBAAAO,CAAA,EAAAP,EAAAO,CAAA,EAAAN,0BAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAJ,EAAAG,IAAA,CAAA,QAAA,CAAAJ,QAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAMjE,IAAMC,EAA6BA,CAClCC,EACAC,EACAC,EACAC,KACY,IAAAC,EAEZ,IAAMC,EAAgCL,GAAuBA,EAAoBM,IAAI,GAAKH,EAC1F,OAAA,AAAkD,OAAlDC,CAAAA,EAAQG,AAFUL,CAAAA,GAAwBD,CAAAA,GAErBI,CAAAA,GAA6BD,AAAA,KAAA,IAAAA,GAAAA,CACnD,EAEaR,EAAyBA,CAACY,EAAuCC,KAAiD,IAAAC,EAC9H,IAAMC,EAAIvB,IACJa,EAAuBT,EAAyB,AAAc,OAAdkB,CAAAA,EAACF,EAAKL,QAAQ,AAARA,GAAQO,AAAA,KAAA,IAAAA,EAAAA,EAAI,IAClEV,EAAsBT,EAAoBkB,GAC1CP,EAAuBb,EAAc,YACrCuB,EAActB,EAAS,UAEvBuB,EAA0Bd,EAC/BC,EACAC,EACAC,EACAM,EAAKL,QAAQ,EAGRW,EAAoB3B,EACzB,IACCqB,EAAKL,QAAQ,EACbS,EAAYG,IAAI,CAAC,CAChBN,IAAKD,EAAKL,QAAAA,IAIPa,EAA0BvB,EAC/B,IACCoB,EACG,CACAI,QAASN,EAAE,kBACXO,KAAM,UACNC,QAASL,EACTM,KAAM,iBAENC,KAAAA,EACJ,CAACP,EAAmBD,EAAyBF,EAAE,EAGhD,OAAOK,CACR\"}"}