{"code":"function module(e,n,t){t.link(\"@babel/runtime/regenerator\",{default:function(e){r=e}},0),t.export({useDeleteUserAction:function(){return p}}),t.link(\"@rocket.chat/fuselage-hooks\",{useMutableCallback:function(e){u=e}},0),t.link(\"@rocket.chat/ui-contexts\",{useSetModal:function(e){i=e},useToastMessageDispatch:function(e){o=e},useRoute:function(e){s=e},useSetting:function(e){c=e},usePermission:function(e){a=e},useEndpoint:function(e){l=e},useTranslation:function(e){f=e}},1),t.link(\"react\",{default:function(e){d=e},useMemo:function(e){m=e}},2),t.link(\"../../../../components/GenericModal\",{default:function(e){h=e}},3),t.link(\"./useConfirmOwnerChanges\",{useConfirmOwnerChanges:function(e){g=e}},4);var r,u,i,o,s,c,a,l,f,d,m,h,g,p=function(e,n,t){var p=f(),k=i(),v=s(\"admin-users\"),_=a(\"delete-user\"),b=c(\"Message_ErasureType\"),x=g(),C=o(),D=function(){k(),v.push({}),t()},T=m(function(){return{userId:e,confirmRelinquish:!1}},[e]),M=l(\"POST\",\"/v1/users.delete\"),w=function(){return x(function(){var e,n=arguments;return r.async(function(t){for(;;)switch(t.prev=t.next){case 0:return(e=n.length>0&&void 0!==n[0]&&n[0])&&(T.confirmRelinquish=e),t.prev=2,t.next=5,r.awrap(M(T));case 5:C({type:\"success\",message:p(\"User_has_been_deleted\")}),D(),t.next=12;break;case 9:throw t.prev=9,t.t0=t.catch(2),t.t0;case 12:case\"end\":return t.stop()}},null,null,[[2,9]],Promise)},{contentTitle:p(\"Delete_User_Warning_\"+b),confirmText:p(\"Delete\")},n)},U=u(function(){k(d.createElement(h,{variant:\"danger\",onConfirm:w,onCancel:function(){return k()},confirmText:p(\"Delete\")},p(\"Delete_User_Warning_\"+b)))});return _?{icon:\"trash\",label:p(\"Delete\"),action:U}:void 0}}","map":"{\"version\":3,\"sources\":[\"client/views/admin/users/hooks/useDeleteUserAction.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IUser } from '@rocket.chat/core-typings';\\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\\nimport {\\n\\tuseSetModal,\\n\\tuseToastMessageDispatch,\\n\\tuseRoute,\\n\\tuseSetting,\\n\\tusePermission,\\n\\tuseEndpoint,\\n\\tuseTranslation,\\n} from '@rocket.chat/ui-contexts';\\nimport React, { useMemo } from 'react';\\n\\nimport GenericModal from '../../../../components/GenericModal';\\nimport type { Action } from '../../../hooks/useActionSpread';\\nimport { useConfirmOwnerChanges } from './useConfirmOwnerChanges';\\n\\nexport const useDeleteUserAction = (userId: IUser['_id'], onChange: () => void, onReload: () => void): Action | undefined => {\\n\\tconst t = useTranslation();\\n\\tconst setModal = useSetModal();\\n\\tconst userRoute = useRoute('admin-users');\\n\\tconst canDeleteUser = usePermission('delete-user');\\n\\tconst erasureType = useSetting('Message_ErasureType');\\n\\tconst confirmOwnerChanges = useConfirmOwnerChanges();\\n\\tconst dispatchToastMessage = useToastMessageDispatch();\\n\\n\\tconst handleDeletedUser = (): void => {\\n\\t\\tsetModal();\\n\\t\\tuserRoute.push({});\\n\\t\\tonReload();\\n\\t};\\n\\n\\tconst deleteUserQuery = useMemo(() => ({ userId, confirmRelinquish: false }), [userId]);\\n\\tconst deleteUserEndpoint = useEndpoint('POST', '/v1/users.delete');\\n\\n\\tconst deleteUser = (): Promise<void> =>\\n\\t\\tconfirmOwnerChanges(\\n\\t\\t\\tasync (confirm = false) => {\\n\\t\\t\\t\\tif (confirm) {\\n\\t\\t\\t\\t\\tdeleteUserQuery.confirmRelinquish = confirm;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\ttry {\\n\\t\\t\\t\\t\\tawait deleteUserEndpoint(deleteUserQuery);\\n\\t\\t\\t\\t\\tdispatchToastMessage({ type: 'success', message: t('User_has_been_deleted') });\\n\\t\\t\\t\\t\\thandleDeletedUser();\\n\\t\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\t\\tthrow error;\\n\\t\\t\\t\\t}\\n\\t\\t\\t},\\n\\t\\t\\t{\\n\\t\\t\\t\\tcontentTitle: t(`Delete_User_Warning_${erasureType}` as TranslationKey),\\n\\t\\t\\t\\tconfirmText: t('Delete'),\\n\\t\\t\\t},\\n\\t\\t\\tonChange,\\n\\t\\t);\\n\\n\\tconst confirmDeleteUser = useMutableCallback(() => {\\n\\t\\tsetModal(\\n\\t\\t\\t<GenericModal variant='danger' onConfirm={deleteUser} onCancel={(): void => setModal()} confirmText={t('Delete')}>\\n\\t\\t\\t\\t{t(`Delete_User_Warning_${erasureType}` as TranslationKey)}\\n\\t\\t\\t</GenericModal>,\\n\\t\\t);\\n\\t});\\n\\n\\treturn canDeleteUser\\n\\t\\t? {\\n\\t\\t\\t\\ticon: 'trash',\\n\\t\\t\\t\\tlabel: t('Delete'),\\n\\t\\t\\t\\taction: confirmDeleteUser,\\n\\t\\t  }\\n\\t\\t: undefined;\\n};\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_regeneratorRuntime\",\"export\",\"useDeleteUserAction\",\"useMutableCallback\",\"useSetModal\",\"useToastMessageDispatch\",\"useRoute\",\"useSetting\",\"usePermission\",\"useEndpoint\",\"useTranslation\",\"React\",\"useMemo\",\"GenericModal\",\"useConfirmOwnerChanges\",\"userId\",\"onChange\",\"onReload\",\"t\",\"setModal\",\"userRoute\",\"canDeleteUser\",\"erasureType\",\"confirmOwnerChanges\",\"dispatchToastMessage\",\"handleDeletedUser\",\"push\",\"deleteUserQuery\",\"confirmRelinquish\",\"deleteUserEndpoint\",\"deleteUser\",\"confirm\",\"_args\",\"arguments\",\"async\",\"_context\",\"prev\",\"next\",\"length\",\"undefined\",\"awrap\",\"type\",\"message\",\"t0\",\"stop\",\"Promise\",\"contentTitle\",\"confirmText\",\"confirmDeleteUser\",\"createElement\",\"variant\",\"onConfirm\",\"onCancel\",\"icon\",\"label\",\"action\"],\"mappings\":\"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\"}"}