{"code":"function module(e,i,n){let t,s,a,l,o,r,p,d;n.link(\"meteor/meteor\",{Meteor(e){t=e}},0),n.link(\"../../../app/authorization/client\",{hasAtLeastOnePermission(e){s=e}},1),n.link(\"../../../app/settings/client\",{settings(e){a=e}},2),n.link(\"../../../app/ui-utils/client\",{MessageAction(e){l=e}},3),n.link(\"../../../app/utils/client/lib/SDKClient\",{sdk(e){o=e}},4),n.link(\"../../lib/queryClient\",{queryClient(e){r=e}},5),n.link(\"../../lib/toast\",{dispatchToastMessage(e){p=e}},6),n.link(\"../../lib/utils/messageArgs\",{messageArgs(e){d=e}},7),t.startup(()=>{l.addButton({id:\"unpin-message\",icon:\"pin\",label:\"Unpin\",type:\"interaction\",context:[\"pinned\",\"message\",\"message-mobile\",\"threads\",\"direct\",\"videoconf\",\"videoconf-threads\"],async action(e,i){let{message:n=d(this).msg}=i;n.pinned=!1;try{await o.call(\"unpinMessage\",n),r.invalidateQueries([\"rooms\",n.rid,\"pinned-messages\"])}catch(e){p({type:\"error\",message:e})}},condition(e){let{message:i,subscription:n}=e;return!!(n&&a.get(\"Message_AllowPinning\"))&&!!i.pinned&&s(\"pin-message\",i.rid)},order:2,group:\"menu\"})})}","map":"{\"version\":3,\"sources\":[\"client/startup/actionButtons/unpinMessage.ts\",\"<anon>\"],\"sourcesContent\":[\"import { Meteor } from 'meteor/meteor';\\n\\nimport { hasAtLeastOnePermission } from '../../../app/authorization/client';\\nimport { settings } from '../../../app/settings/client';\\nimport { MessageAction } from '../../../app/ui-utils/client';\\nimport { sdk } from '../../../app/utils/client/lib/SDKClient';\\nimport { queryClient } from '../../lib/queryClient';\\nimport { dispatchToastMessage } from '../../lib/toast';\\nimport { messageArgs } from '../../lib/utils/messageArgs';\\n\\nMeteor.startup(() => {\\n\\tMessageAction.addButton({\\n\\t\\tid: 'unpin-message',\\n\\t\\ticon: 'pin',\\n\\t\\tlabel: 'Unpin',\\n\\t\\ttype: 'interaction',\\n\\t\\tcontext: ['pinned', 'message', 'message-mobile', 'threads', 'direct', 'videoconf', 'videoconf-threads'],\\n\\t\\tasync action(_, props) {\\n\\t\\t\\tconst { message = messageArgs(this).msg } = props;\\n\\t\\t\\tmessage.pinned = false;\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tawait sdk.call('unpinMessage', message);\\n\\t\\t\\t\\tqueryClient.invalidateQueries(['rooms', message.rid, 'pinned-messages']);\\n\\t\\t\\t} catch (error) {\\n\\t\\t\\t\\tdispatchToastMessage({ type: 'error', message: error });\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\tcondition({ message, subscription }) {\\n\\t\\t\\tif (!subscription || !settings.get('Message_AllowPinning') || !message.pinned) {\\n\\t\\t\\t\\treturn false;\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn hasAtLeastOnePermission('pin-message', message.rid);\\n\\t\\t},\\n\\t\\torder: 2,\\n\\t\\tgroup: 'menu',\\n\\t});\\n});\\n\",null],\"names\":[\"Meteor\",\"hasAtLeastOnePermission\",\"settings\",\"MessageAction\",\"sdk\",\"queryClient\",\"dispatchToastMessage\",\"messageArgs\",\"module\",\"link\",\"v\",\"startup\",\"addButton\",\"id\",\"icon\",\"label\",\"type\",\"context\",\"action\",\"_\",\"props\",\"message\",\"msg\",\"pinned\",\"call\",\"invalidateQueries\",\"rid\",\"error\",\"condition\",\"_ref\",\"subscription\",\"get\",\"order\",\"group\"],\"mappings\":\"2BAAAA,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAT,OAAAU,CAAA,EAAAV,EAAAU,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,oCAAA,CAAAR,wBAAAS,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,+BAAA,CAAAP,SAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,+BAAA,CAAAN,cAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,0CAAA,CAAAL,IAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,wBAAA,CAAAJ,YAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,kBAAA,CAAAH,qBAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAAAF,EAAAC,IAAA,CAAA,8BAAA,CAAAF,YAAAG,CAAA,EAAAH,EAAAG,CAAA,CAAA,EAAA,GAUvCV,EAAOW,OAAO,CAAC,KACdR,EAAcS,SAAS,CAAC,CACvBC,GAAI,gBACJC,KAAM,MACNC,MAAO,QACPC,KAAM,cACNC,QAAS,CAAC,SAAU,UAAW,iBAAkB,UAAW,SAAU,YAAa,oBAAoB,CACvG,MAAMC,OAAOC,CAAC,CAAEC,CAAK,EACpB,GAAM,CAAEC,QAAAA,EAAUd,EAAY,IAAI,EAAEe,GAAAA,CAAK,CAAGF,CAC5CC,CAAAA,EAAQE,MAAM,CAAG,CAAA,EACjB,GAAI,CACH,MAAMnB,EAAIoB,IAAI,CAAC,eAAgBH,GAC/BhB,EAAYoB,iBAAiB,CAAC,CAAC,QAASJ,EAAQK,GAAG,CAAE,kBAAkB,CACxE,CAAE,MAAOC,EAAO,CACfrB,EAAqB,CAAEU,KAAM,QAASK,QAASM,CAAK,EACrD,CACD,EACAC,UAASC,CAAA,EAA0B,GAAzB,CAAER,QAAAA,CAAO,CAAES,aAAAA,CAAAA,CAAc,CAAAD,QAClC,EAAI,CAAA,AAACC,GAAiB5B,EAAS6B,GAAG,CAAC,uBAAsB,KAAMV,EAAQE,MAAM,EAItEtB,EAAwB,cAAeoB,EAAQK,GAAG,CAC1D,EACAM,MAAO,EACPC,MAAO,QAET\"}"}