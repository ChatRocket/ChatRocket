{"code":"function module(e,n,t){t.link(\"@babel/runtime/helpers/inheritsLoose\",{default:function(e){i=e}},0),t.link(\"@rocket.chat/emitter\",{Emitter:function(e){r=e}},0),t.link(\"@rocket.chat/ui-contexts\",{AuthorizationContext:function(e){o=e}},1),t.link(\"meteor/meteor\",{Meteor:function(e){u=e}},2),t.link(\"react\",{default:function(e){c=e},useCallback:function(e){l=e},useEffect:function(e){a=e}},3),t.link(\"../../app/authorization/client\",{hasPermission:function(e){s=e},hasAtLeastOnePermission:function(e){f=e},hasAllPermission:function(e){h=e},hasRole:function(e){m=e}},4),t.link(\"../../app/models/client/models/Roles\",{Roles:function(e){d=e}},5),t.link(\"../hooks/useReactiveValue\",{useReactiveValue:function(e){k=e}},6),t.link(\"../lib/createReactiveSubscriptionFactory\",{createReactiveSubscriptionFactory:function(e){v=e}},7);var i,r,o,u,c,l,a,s,f,h,m,d,k,v,p=function(e){function n(){for(var n,t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return(n=e.call.apply(e,[this].concat(i))||this).roles={},n}return i(n,e),n}(r),y={queryPermission:v(function(e,n,t){return s(e,n,t)}),queryAtLeastOnePermission:v(function(e,n){return f(e,n)}),queryAllPermissions:v(function(e,n){return h(e,n)}),queryRole:v(function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!!u.userId()&&m(u.userId(),e,n,t)}),roleStore:new p};t.exportDefault(function(e){var n=e.children,t=k(l(function(){return d.find().fetch().reduce(function(e,n){return e[n._id]=n,e},{})},[]));return a(function(){y.roleStore.roles=t,y.roleStore.emit(\"change\",t)},[t]),c.createElement(o.Provider,{children:n,value:y})})}","map":"{\"version\":3,\"sources\":[\"client/providers/AuthorizationProvider.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IRole } from '@rocket.chat/core-typings';\\nimport { Emitter } from '@rocket.chat/emitter';\\nimport { AuthorizationContext } from '@rocket.chat/ui-contexts';\\nimport { Meteor } from 'meteor/meteor';\\nimport type { ReactNode } from 'react';\\nimport React, { useCallback, useEffect } from 'react';\\n\\nimport { hasPermission, hasAtLeastOnePermission, hasAllPermission, hasRole } from '../../app/authorization/client';\\nimport { Roles } from '../../app/models/client/models/Roles';\\nimport { useReactiveValue } from '../hooks/useReactiveValue';\\nimport { createReactiveSubscriptionFactory } from '../lib/createReactiveSubscriptionFactory';\\n\\nclass RoleStore extends Emitter<{\\n\\tchange: { [_id: string]: IRole };\\n}> {\\n\\troles: { [_id: string]: IRole } = {};\\n}\\n\\nconst contextValue = {\\n\\tqueryPermission: createReactiveSubscriptionFactory((permission, scope, scopeRoles) => hasPermission(permission, scope, scopeRoles)),\\n\\tqueryAtLeastOnePermission: createReactiveSubscriptionFactory((permissions, scope) => hasAtLeastOnePermission(permissions, scope)),\\n\\tqueryAllPermissions: createReactiveSubscriptionFactory((permissions, scope) => hasAllPermission(permissions, scope)),\\n\\tqueryRole: createReactiveSubscriptionFactory(\\n\\t\\t(role, scope?, ignoreSubscriptions = false) =>\\n\\t\\t\\t!!Meteor.userId() && hasRole(Meteor.userId() as string, role, scope, ignoreSubscriptions),\\n\\t),\\n\\troleStore: new RoleStore(),\\n};\\n\\ntype AuthorizationProviderProps = {\\n\\tchildren?: ReactNode;\\n};\\n\\nconst AuthorizationProvider = ({ children }: AuthorizationProviderProps) => {\\n\\tconst roles = useReactiveValue(\\n\\t\\tuseCallback(\\n\\t\\t\\t() =>\\n\\t\\t\\t\\tRoles.find()\\n\\t\\t\\t\\t\\t.fetch()\\n\\t\\t\\t\\t\\t.reduce((ret, obj) => {\\n\\t\\t\\t\\t\\t\\tret[obj._id] = obj;\\n\\t\\t\\t\\t\\t\\treturn ret;\\n\\t\\t\\t\\t\\t}, {} as Record<string, IRole>),\\n\\t\\t\\t[],\\n\\t\\t),\\n\\t);\\n\\n\\tuseEffect(() => {\\n\\t\\tcontextValue.roleStore.roles = roles;\\n\\t\\tcontextValue.roleStore.emit('change', roles);\\n\\t}, [roles]);\\n\\n\\treturn <AuthorizationContext.Provider children={children} value={contextValue} />;\\n};\\n\\nexport default AuthorizationProvider;\\n\",null],\"names\":[\"module\",\"link\",\"default\",\"v\",\"_inheritsLoose\",\"Emitter\",\"AuthorizationContext\",\"Meteor\",\"React\",\"useCallback\",\"useEffect\",\"hasPermission\",\"hasAtLeastOnePermission\",\"hasAllPermission\",\"hasRole\",\"Roles\",\"useReactiveValue\",\"createReactiveSubscriptionFactory\",\"RoleStore\",\"_Emitter\",\"_this\",\"_len\",\"arguments\",\"length\",\"args\",\"Array\",\"_key\",\"call\",\"apply\",\"concat\",\"roles\",\"contextValue\",\"queryPermission\",\"permission\",\"scope\",\"scopeRoles\",\"queryAtLeastOnePermission\",\"permissions\",\"queryAllPermissions\",\"queryRole\",\"role\",\"ignoreSubscriptions\",\"undefined\",\"userId\",\"roleStore\",\"exportDefault\",\"_ref\",\"children\",\"find\",\"fetch\",\"reduce\",\"ret\",\"obj\",\"_id\",\"emit\",\"createElement\",\"Provider\",\"value\"],\"mappings\":\"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\"}"}