{"code":"function module(e,n,t){var i,l,r,a,o,d;t.link(\"@babel/runtime/regenerator\",{default:function(e){i=e}},0),t.link(\"../../../client/lib/actionLinks\",{actionLinks:function(e){l=e}},0),t.link(\"../../../client/lib/toast\",{dispatchToastMessage:function(e){r=e}},1),t.link(\"../../models/client\",{ChatRoom:function(e){a=e}},2),t.link(\"../../utils/client/lib/SDKClient\",{sdk:function(e){o=e}},3),t.link(\"../../utils/lib/i18n\",{t:function(e){d=e}},4),l.register(\"joinLivechatWebRTCCall\",function(e){var n=a.findOne({_id:e.rid});if(!n)throw Error(\"Room not found\");var t=n.callStatus,i=n._id;if(\"declined\"===t||\"ended\"===t){r({type:\"info\",message:d(\"Call_Already_Ended\")});return}window.open(\"/meet/\"+i,i)}),l.register(\"endLivechatWebRTCCall\",function(e){var n,t,l;return i.async(function(c){for(;;)switch(c.prev=c.next){case 0:if(n=a.findOne({_id:e.rid})){c.next=3;break}throw Error(\"Room not found\");case 3:if(t=n.callStatus,l=n._id,!(\"declined\"===t||\"ended\"===t)){c.next=7;break}return r({type:\"info\",message:d(\"Call_Already_Ended\")}),c.abrupt(\"return\");case 7:return c.next=9,i.awrap(o.rest.put(\"/v1/livechat/webrtc.call/\"+e._id,{rid:l,status:\"ended\"}));case 9:o.publish(\"notify-room\",[l+\"/webrtc\",\"callStatus\",{callStatus:\"ended\"}]);case 10:case\"end\":return c.stop()}},null,null,null,Promise)})}","map":"{\"version\":3,\"sources\":[\"app/webrtc/client/actionLink.tsx\",\"<anon>\"],\"sourcesContent\":[\"import type { IMessage } from '@rocket.chat/core-typings';\\n\\nimport { actionLinks } from '../../../client/lib/actionLinks';\\nimport { dispatchToastMessage } from '../../../client/lib/toast';\\nimport { ChatRoom } from '../../models/client';\\nimport { sdk } from '../../utils/client/lib/SDKClient';\\nimport { t } from '../../utils/lib/i18n';\\n\\nactionLinks.register('joinLivechatWebRTCCall', (message: IMessage) => {\\n\\tconst room = ChatRoom.findOne({ _id: message.rid });\\n\\tif (!room) {\\n\\t\\tthrow new Error('Room not found');\\n\\t}\\n\\tconst { callStatus, _id } = room;\\n\\tif (callStatus === 'declined' || callStatus === 'ended') {\\n\\t\\tdispatchToastMessage({ type: 'info', message: t('Call_Already_Ended') });\\n\\t\\treturn;\\n\\t}\\n\\twindow.open(`/meet/${_id}`, _id);\\n});\\n\\nactionLinks.register('endLivechatWebRTCCall', async (message: IMessage) => {\\n\\tconst room = ChatRoom.findOne({ _id: message.rid });\\n\\tif (!room) {\\n\\t\\tthrow new Error('Room not found');\\n\\t}\\n\\tconst { callStatus, _id } = room;\\n\\tif (callStatus === 'declined' || callStatus === 'ended') {\\n\\t\\tdispatchToastMessage({ type: 'info', message: t('Call_Already_Ended') });\\n\\t\\treturn;\\n\\t}\\n\\tawait sdk.rest.put(`/v1/livechat/webrtc.call/${message._id}`, { rid: _id, status: 'ended' });\\n\\tsdk.publish('notify-room', [`${_id}/webrtc`, 'callStatus', { callStatus: 'ended' }]);\\n});\\n\",null],\"names\":[\"_regeneratorRuntime\",\"actionLinks\",\"dispatchToastMessage\",\"ChatRoom\",\"sdk\",\"t\",\"module\",\"link\",\"default\",\"v\",\"register\",\"message\",\"room\",\"findOne\",\"_id\",\"rid\",\"Error\",\"callStatus\",\"type\",\"window\",\"open\",\"async\",\"_context\",\"prev\",\"next\",\"abrupt\",\"awrap\",\"rest\",\"put\",\"status\",\"publish\",\"stop\",\"Promise\"],\"mappings\":\"2BAEAA,EAAAC,EAA8DC,EAAAC,EAAAC,EAAAC,EAAxCC,EAAMC,IAAA,CAAA,6BAAkC,CAAAC,QAAA,SAAAC,CAAA,EAAAT,EAAAS,CAAA,CAAA,EAAA,GAArDH,EAAaC,IAAA,CAAM,kCAAkC,CAAAN,YAAA,SAAAQ,CAAA,EAAAR,EAAAQ,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,4BAAA,CAAAL,qBAAA,SAAAO,CAAA,EAAAP,EAAAO,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,sBAAA,CAAAJ,SAAA,SAAAM,CAAA,EAAAN,EAAAM,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,mCAAA,CAAAH,IAAA,SAAAK,CAAA,EAAAL,EAAAK,CAAA,CAAA,EAAA,GAAAH,EAAAC,IAAA,CAAA,uBAAA,CAAAF,EAAA,SAAAI,CAAA,EAAAJ,EAAAI,CAAA,CAAA,EAAA,GAM9DR,EAAYS,QAAQ,CAAC,yBAA0B,SAACC,CAAiB,EAChE,IAAMC,EAAOT,EAASU,OAAO,CAAC,CAAEC,IAAKH,EAAQI,GAAAA,AAAG,GAChD,GAAI,CAACH,EACJ,MAAM,AAAII,MAAM,kBAEjB,IAAQC,EAAoBL,EAApBK,UAAU,CAAEH,EAAQF,EAARE,GAAG,CACvB,GAAIG,AAAe,aAAfA,GAA6BA,AAAe,UAAfA,EAAwB,CACxDf,EAAqB,CAAEgB,KAAM,OAAQP,QAASN,EAAE,qBAAqB,GACrE,MACD,CACAc,OAAOC,IAAI,CAAA,SAAUN,EAAOA,EAC7B,GAEAb,EAAYS,QAAQ,CAAC,wBAAyB,SAAOC,CAAiB,EAAA,IAAAC,EAAAK,EAAAH,EAAA,OAAAd,EAAAqB,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAClB,GAA7CZ,EAAOT,EAASU,OAAO,CAAC,CAAEC,IAAKH,EAAQI,GAAAA,AAAG,GACvC,CAAAO,EAAAE,IAAA,CAAA,EAAA,KAAA,CAAA,MACF,AAAIR,MAAM,iBAAiB,MAAA,EAEX,GAAfC,EAAoBL,EAApBK,UAAU,CAAEH,EAAQF,EAARE,GAAG,CAAA,CACnBG,CAAAA,AAAe,aAAfA,GAA6BA,AAAe,UAAfA,CAAe,EAAO,CAAAK,EAAAE,IAAA,CAAA,EAAA,KAAA,CACmB,OAAzEtB,EAAqB,CAAEgB,KAAM,OAAQP,QAASN,EAAE,qBAAqB,GAAIiB,EAAAG,MAAA,CAAA,SAAA,MAAA,EAAA,OAAAH,EAAAE,IAAA,CAAA,EAAAxB,EAAA0B,KAAA,CAGpEtB,EAAIuB,IAAI,CAACC,GAAG,CAAA,4BAA6BjB,EAAQG,GAAG,CAAI,CAAEC,IAAKD,EAAKe,OAAQ,OAAO,GAAG,MAAA,EAC5FzB,EAAI0B,OAAO,CAAC,cAAe,CAAIhB,EAAG,UAAW,aAAc,CAAEG,WAAY,OAAO,EAAG,CAAE,MAAA,GAAA,IAAA,MAAA,OAAAK,EAAAS,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA\"}"}