{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/server/routes/avatar/utils.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.arm64"},"sourceFileName":"server/routes/avatar/utils.js","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/server/routes/avatar/utils.js","targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true,"topLevelAwait":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/server/routes/avatar/utils.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"server/routes/avatar/utils.js"}},"code":"!module.wrapAsync(async function (module, __reifyWaitForDeps__, __reify_async_result__) {\n  \"use strict\";\n  try {\n    module.export({\n      serveAvatar: () => serveAvatar,\n      wasFallbackModified: () => wasFallbackModified,\n      userCanAccessAvatar: () => userCanAccessAvatar,\n      renderSVGLetters: () => renderSVGLetters,\n      setCacheAndDispositionHeaders: () => setCacheAndDispositionHeaders\n    });\n    let hashLoginToken;\n    module.link(\"@rocket.chat/account-utils\", {\n      hashLoginToken(v) {\n        hashLoginToken = v;\n      }\n    }, 0);\n    let Users;\n    module.link(\"@rocket.chat/models\", {\n      Users(v) {\n        Users = v;\n      }\n    }, 1);\n    let Cookies;\n    module.link(\"meteor/ostrio:cookies\", {\n      Cookies(v) {\n        Cookies = v;\n      }\n    }, 2);\n    let sharp;\n    module.link(\"sharp\", {\n      default(v) {\n        sharp = v;\n      }\n    }, 3);\n    let throttle;\n    module.link(\"underscore\", {\n      throttle(v) {\n        throttle = v;\n      }\n    }, 4);\n    let settings;\n    module.link(\"../../../app/settings/server\", {\n      settings(v) {\n        settings = v;\n      }\n    }, 5);\n    let getAvatarColor;\n    module.link(\"../../../app/utils/lib/getAvatarColor\", {\n      getAvatarColor(v) {\n        getAvatarColor = v;\n      }\n    }, 6);\n    if (__reifyWaitForDeps__()) (await __reifyWaitForDeps__())();\n    const FALLBACK_LAST_MODIFIED = 'Thu, 01 Jan 2015 00:00:00 GMT';\n    const cookie = new Cookies();\n    const serveAvatar = (avatar, format, res) => {\n      res.setHeader('Last-Modified', FALLBACK_LAST_MODIFIED);\n      if (['png', 'jpg', 'jpeg'].includes(format)) {\n        res.setHeader('Content-Type', \"image/\".concat(format));\n        sharp(Buffer.from(avatar)).toFormat(format).pipe(res);\n        return;\n      }\n      res.setHeader('Content-Type', 'image/svg+xml');\n      res.write(avatar);\n      res.end();\n    };\n    const wasFallbackModified = reqModifiedHeader => {\n      if (!reqModifiedHeader || reqModifiedHeader !== FALLBACK_LAST_MODIFIED) {\n        return true;\n      }\n      return false;\n    };\n    async function isUserAuthenticated(_ref) {\n      let {\n        headers,\n        query\n      } = _ref;\n      let {\n        rc_uid,\n        rc_token\n      } = query;\n      if (!rc_uid && headers.cookie) {\n        rc_uid = cookie.get('rc_uid', headers.cookie);\n        rc_token = cookie.get('rc_token', headers.cookie);\n      }\n      if (rc_uid == null || rc_token == null) {\n        return false;\n      }\n      const userFound = await Users.findOneByIdAndLoginToken(rc_uid, hashLoginToken(rc_token), {\n        projection: {\n          _id: 1\n        }\n      }); // TODO memoize find\n\n      return !!userFound;\n    }\n    const warnUnauthenticatedAccess = throttle(() => {\n      console.warn('The server detected an unauthenticated access to an user avatar. This type of request will soon be blocked by default.');\n    }, 60000 * 30); // 30 minutes\n\n    async function userCanAccessAvatar(_ref2) {\n      let {\n        headers = {},\n        query = {}\n      } = _ref2;\n      if (!settings.get('Accounts_AvatarBlockUnauthenticatedAccess')) {\n        return true;\n      }\n      const isAuthenticated = await isUserAuthenticated({\n        headers,\n        query\n      });\n      if (!isAuthenticated) {\n        warnUnauthenticatedAccess();\n      }\n      return isAuthenticated;\n    }\n    const getFirstLetter = name => name.replace(/[^A-Za-z0-9]/g, '').substr(0, 1).toUpperCase();\n    const renderSVGLetters = function (username) {\n      let viewSize = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 200;\n      let color = '';\n      let initials = '';\n      if (username === '?') {\n        color = '#000';\n        initials = username;\n      } else {\n        color = getAvatarColor(username);\n        initials = getFirstLetter(username);\n      }\n      const fontSize = viewSize / 1.6;\n      return \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 \".concat(viewSize, \" \").concat(viewSize, \"\\\">\\n<rect width=\\\"100%\\\" height=\\\"100%\\\" fill=\\\"\").concat(color, \"\\\"/>\\n<text x=\\\"50%\\\" y=\\\"50%\\\" dy=\\\"0.36em\\\" text-anchor=\\\"middle\\\" pointer-events=\\\"none\\\" fill=\\\"#ffffff\\\" font-family=\\\"'Helvetica', 'Arial', 'Lucida Grande', 'sans-serif'\\\" font-size=\\\"\").concat(fontSize, \"\\\">\\n\").concat(initials, \"\\n</text>\\n</svg>\");\n    };\n    const getCacheTime = cacheTime => cacheTime || settings.get('Accounts_AvatarCacheTime');\n    function setCacheAndDispositionHeaders(req, res) {\n      const cacheTime = getCacheTime(req.query.cacheTime);\n      res.setHeader('Cache-Control', \"public, max-age=\".concat(cacheTime));\n      res.setHeader('Content-Disposition', 'inline');\n    }\n    __reify_async_result__();\n  } catch (_reifyError) {\n    return __reify_async_result__(_reifyError);\n  }\n  __reify_async_result__()\n}, {\n  self: this,\n  async: false\n});","map":{"version":3,"names":["module","export","serveAvatar","wasFallbackModified","userCanAccessAvatar","renderSVGLetters","setCacheAndDispositionHeaders","hashLoginToken","link","v","Users","Cookies","sharp","default","throttle","settings","getAvatarColor","__reifyWaitForDeps__","FALLBACK_LAST_MODIFIED","cookie","avatar","format","res","setHeader","includes","concat","Buffer","from","toFormat","pipe","write","end","reqModifiedHeader","isUserAuthenticated","_ref","headers","query","rc_uid","rc_token","get","userFound","findOneByIdAndLoginToken","projection","_id","warnUnauthenticatedAccess","console","warn","_ref2","isAuthenticated","getFirstLetter","name","replace","substr","toUpperCase","username","viewSize","arguments","length","undefined","color","initials","fontSize","getCacheTime","cacheTime","req","__reify_async_result__","_reifyError","self","async"],"sources":["server/routes/avatar/utils.js"],"sourcesContent":["import { hashLoginToken } from '@rocket.chat/account-utils';\nimport { Users } from '@rocket.chat/models';\nimport { Cookies } from 'meteor/ostrio:cookies';\nimport sharp from 'sharp';\nimport { throttle } from 'underscore';\n\nimport { settings } from '../../../app/settings/server';\nimport { getAvatarColor } from '../../../app/utils/lib/getAvatarColor';\n\nconst FALLBACK_LAST_MODIFIED = 'Thu, 01 Jan 2015 00:00:00 GMT';\n\nconst cookie = new Cookies();\n\nexport const serveAvatar = (avatar, format, res) => {\n\tres.setHeader('Last-Modified', FALLBACK_LAST_MODIFIED);\n\n\tif (['png', 'jpg', 'jpeg'].includes(format)) {\n\t\tres.setHeader('Content-Type', `image/${format}`);\n\t\tsharp(Buffer.from(avatar)).toFormat(format).pipe(res);\n\t\treturn;\n\t}\n\tres.setHeader('Content-Type', 'image/svg+xml');\n\n\tres.write(avatar);\n\tres.end();\n};\n\nexport const wasFallbackModified = (reqModifiedHeader) => {\n\tif (!reqModifiedHeader || reqModifiedHeader !== FALLBACK_LAST_MODIFIED) {\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nasync function isUserAuthenticated({ headers, query }) {\n\tlet { rc_uid, rc_token } = query;\n\n\tif (!rc_uid && headers.cookie) {\n\t\trc_uid = cookie.get('rc_uid', headers.cookie);\n\t\trc_token = cookie.get('rc_token', headers.cookie);\n\t}\n\n\tif (rc_uid == null || rc_token == null) {\n\t\treturn false;\n\t}\n\n\tconst userFound = await Users.findOneByIdAndLoginToken(rc_uid, hashLoginToken(rc_token), { projection: { _id: 1 } }); // TODO memoize find\n\n\treturn !!userFound;\n}\n\nconst warnUnauthenticatedAccess = throttle(() => {\n\tconsole.warn('The server detected an unauthenticated access to an user avatar. This type of request will soon be blocked by default.');\n}, 60000 * 30); // 30 minutes\n\nexport async function userCanAccessAvatar({ headers = {}, query = {} }) {\n\tif (!settings.get('Accounts_AvatarBlockUnauthenticatedAccess')) {\n\t\treturn true;\n\t}\n\n\tconst isAuthenticated = await isUserAuthenticated({ headers, query });\n\tif (!isAuthenticated) {\n\t\twarnUnauthenticatedAccess();\n\t}\n\n\treturn isAuthenticated;\n}\n\nconst getFirstLetter = (name) =>\n\tname\n\t\t.replace(/[^A-Za-z0-9]/g, '')\n\t\t.substr(0, 1)\n\t\t.toUpperCase();\n\nexport const renderSVGLetters = (username, viewSize = 200) => {\n\tlet color = '';\n\tlet initials = '';\n\n\tif (username === '?') {\n\t\tcolor = '#000';\n\t\tinitials = username;\n\t} else {\n\t\tcolor = getAvatarColor(username);\n\t\tinitials = getFirstLetter(username);\n\t}\n\n\tconst fontSize = viewSize / 1.6;\n\n\treturn `<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 ${viewSize} ${viewSize}\\\">\\n<rect width=\\\"100%\\\" height=\\\"100%\\\" fill=\\\"${color}\\\"/>\\n<text x=\\\"50%\\\" y=\\\"50%\\\" dy=\\\"0.36em\\\" text-anchor=\\\"middle\\\" pointer-events=\\\"none\\\" fill=\\\"#ffffff\\\" font-family=\\\"'Helvetica', 'Arial', 'Lucida Grande', 'sans-serif'\\\" font-size=\"${fontSize}\">\\n${initials}\\n</text>\\n</svg>`;\n};\n\nconst getCacheTime = (cacheTime) => cacheTime || settings.get('Accounts_AvatarCacheTime');\n\nexport function setCacheAndDispositionHeaders(req, res) {\n\tconst cacheTime = getCacheTime(req.query.cacheTime);\n\tres.setHeader('Cache-Control', `public, max-age=${cacheTime}`);\n\tres.setHeader('Content-Disposition', 'inline');\n}\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"ef3e9480c2c4647c36125f178e11c9aac60f015b"}
