{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/federation/server/hooks/afterCreateRoom.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.arm64"},"sourceFileName":"app/federation/server/hooks/afterCreateRoom.js","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/federation/server/hooks/afterCreateRoom.js","targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true,"topLevelAwait":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/app/federation/server/hooks/afterCreateRoom.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/federation/server/hooks/afterCreateRoom.js"}},"code":"!module.wrapAsync(async function (module, __reifyWaitForDeps__, __reify_async_result__) {\n  \"use strict\";\n  try {\n    let _asyncIterator;\n    module.link(\"@babel/runtime/helpers/asyncIterator\", {\n      default(v) {\n        _asyncIterator = v;\n      }\n    }, 0);\n    module.export({\n      doAfterCreateRoom: () => doAfterCreateRoom,\n      definition: () => definition\n    });\n    let FederationRoomEvents, Users, Subscriptions;\n    module.link(\"@rocket.chat/models\", {\n      FederationRoomEvents(v) {\n        FederationRoomEvents = v;\n      },\n      Users(v) {\n        Users = v;\n      },\n      Subscriptions(v) {\n        Subscriptions = v;\n      }\n    }, 0);\n    let deleteRoom;\n    module.link(\"../../../lib/server/functions/deleteRoom\", {\n      deleteRoom(v) {\n        deleteRoom = v;\n      }\n    }, 1);\n    let checkRoomType, checkRoomDomainsLength;\n    module.link(\"../functions/helpers\", {\n      checkRoomType(v) {\n        checkRoomType = v;\n      },\n      checkRoomDomainsLength(v) {\n        checkRoomDomainsLength = v;\n      }\n    }, 2);\n    let dispatchEvents;\n    module.link(\"../handler\", {\n      dispatchEvents(v) {\n        dispatchEvents = v;\n      }\n    }, 3);\n    let getFederationDomain;\n    module.link(\"../lib/getFederationDomain\", {\n      getFederationDomain(v) {\n        getFederationDomain = v;\n      }\n    }, 4);\n    let clientLogger;\n    module.link(\"../lib/logger\", {\n      clientLogger(v) {\n        clientLogger = v;\n      }\n    }, 5);\n    let normalizers;\n    module.link(\"../normalizers\", {\n      normalizers(v) {\n        normalizers = v;\n      }\n    }, 6);\n    if (__reifyWaitForDeps__()) (await __reifyWaitForDeps__())();\n    async function doAfterCreateRoom(room, users, subscriptions) {\n      const normalizedUsers = [];\n\n      //\n      // Add user events\n      //\n      const addUserEvents = [];\n      var _iteratorAbruptCompletion = false;\n      var _didIteratorError = false;\n      var _iteratorError;\n      try {\n        for (var _iterator = _asyncIterator(users), _step; _iteratorAbruptCompletion = !(_step = await _iterator.next()).done; _iteratorAbruptCompletion = false) {\n          const user = _step.value;\n          {\n            /* eslint-disable no-await-in-loop */\n\n            const subscription = subscriptions[user._id];\n            const normalizedSourceUser = await normalizers.normalizeUser(user);\n            const normalizedSourceSubscription = normalizers.normalizeSubscription(subscription);\n            normalizedUsers.push(normalizedSourceUser);\n            const addUserEvent = await FederationRoomEvents.createAddUserEvent(getFederationDomain(), room._id, normalizedSourceUser, normalizedSourceSubscription);\n            addUserEvents.push(addUserEvent);\n\n            /* eslint-enable no-await-in-loop */\n          }\n        }\n\n        //\n        // Genesis\n        //\n\n        // Normalize room\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (_iteratorAbruptCompletion && _iterator.return != null) {\n            await _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n      const normalizedRoom = normalizers.normalizeRoom(room, normalizedUsers);\n\n      // Check if the number of domains is allowed\n      if (!checkRoomDomainsLength(normalizedRoom.federation.domains)) {\n        throw new Error(\"Cannot federate rooms with more than \".concat(process.env.FEDERATED_DOMAINS_LENGTH || 10, \" domains\"));\n      }\n\n      // Ensure a genesis event for this room\n      const genesisEvent = await FederationRoomEvents.createGenesisEvent(getFederationDomain(), normalizedRoom);\n\n      // Dispatch the events\n      await dispatchEvents(normalizedRoom.federation.domains, [genesisEvent, ...addUserEvents]);\n    }\n    async function afterCreateRoom(roomOwner, room) {\n      // If the room is federated, ignore\n      if (room.federation) {\n        return roomOwner;\n      }\n\n      // Find all subscriptions of this room\n      let subscriptions = await Subscriptions.findByRoomIdWhenUsernameExists(room._id).toArray();\n      subscriptions = subscriptions.reduce((acc, s) => {\n        acc[s.u._id] = s;\n        return acc;\n      }, {});\n\n      // Get all user ids\n      const userIds = Object.keys(subscriptions);\n\n      // Load all the users\n      const users = await Users.findUsersWithUsernameByIds(userIds).toArray();\n\n      // Check if there is a federated user on this room\n      const hasFederatedUser = users.find(u => u.username.indexOf('@') !== -1);\n\n      // If there are not federated users on this room, ignore it\n      if (!hasFederatedUser) {\n        return roomOwner;\n      }\n      try {\n        // If the room is not on the allowed types, ignore\n        if (!checkRoomType(room)) {\n          throw new Error('Channels cannot be federated');\n        }\n        clientLogger.debug({\n          msg: 'afterCreateRoom',\n          roomOwner,\n          room\n        });\n        await doAfterCreateRoom(room, users, subscriptions);\n      } catch (err) {\n        await deleteRoom(room._id);\n        clientLogger.error({\n          msg: 'afterCreateRoom => Could not create federated room:',\n          err\n        });\n      }\n      return room;\n    }\n    const definition = {\n      hook: 'afterCreateRoom',\n      callback: afterCreateRoom,\n      id: 'federation-after-create-room'\n    };\n    __reify_async_result__();\n  } catch (_reifyError) {\n    return __reify_async_result__(_reifyError);\n  }\n  __reify_async_result__()\n}, {\n  self: this,\n  async: false\n});","map":{"version":3,"names":["_asyncIterator","module","link","default","v","export","doAfterCreateRoom","definition","FederationRoomEvents","Users","Subscriptions","deleteRoom","checkRoomType","checkRoomDomainsLength","dispatchEvents","getFederationDomain","clientLogger","normalizers","__reifyWaitForDeps__","room","users","subscriptions","normalizedUsers","addUserEvents","_iteratorAbruptCompletion","_didIteratorError","_iteratorError","_iterator","_step","next","done","user","value","subscription","_id","normalizedSourceUser","normalizeUser","normalizedSourceSubscription","normalizeSubscription","push","addUserEvent","createAddUserEvent","err","return","normalizedRoom","normalizeRoom","federation","domains","Error","concat","process","env","FEDERATED_DOMAINS_LENGTH","genesisEvent","createGenesisEvent","afterCreateRoom","roomOwner","findByRoomIdWhenUsernameExists","toArray","reduce","acc","s","u","userIds","Object","keys","findUsersWithUsernameByIds","hasFederatedUser","find","username","indexOf","debug","msg","error","hook","callback","id","__reify_async_result__","_reifyError","self","async"],"sources":["app/federation/server/hooks/afterCreateRoom.js"],"sourcesContent":["import { FederationRoomEvents, Users, Subscriptions } from '@rocket.chat/models';\n\nimport { deleteRoom } from '../../../lib/server/functions/deleteRoom';\nimport { checkRoomType, checkRoomDomainsLength } from '../functions/helpers';\nimport { dispatchEvents } from '../handler';\nimport { getFederationDomain } from '../lib/getFederationDomain';\nimport { clientLogger } from '../lib/logger';\nimport { normalizers } from '../normalizers';\n\nexport async function doAfterCreateRoom(room, users, subscriptions) {\n\tconst normalizedUsers = [];\n\n\t//\n\t// Add user events\n\t//\n\tconst addUserEvents = [];\n\n\tfor await (const user of users) {\n\t\t/* eslint-disable no-await-in-loop */\n\n\t\tconst subscription = subscriptions[user._id];\n\n\t\tconst normalizedSourceUser = await normalizers.normalizeUser(user);\n\t\tconst normalizedSourceSubscription = normalizers.normalizeSubscription(subscription);\n\n\t\tnormalizedUsers.push(normalizedSourceUser);\n\n\t\tconst addUserEvent = await FederationRoomEvents.createAddUserEvent(\n\t\t\tgetFederationDomain(),\n\t\t\troom._id,\n\t\t\tnormalizedSourceUser,\n\t\t\tnormalizedSourceSubscription,\n\t\t);\n\n\t\taddUserEvents.push(addUserEvent);\n\n\t\t/* eslint-enable no-await-in-loop */\n\t}\n\n\t//\n\t// Genesis\n\t//\n\n\t// Normalize room\n\tconst normalizedRoom = normalizers.normalizeRoom(room, normalizedUsers);\n\n\t// Check if the number of domains is allowed\n\tif (!checkRoomDomainsLength(normalizedRoom.federation.domains)) {\n\t\tthrow new Error(`Cannot federate rooms with more than ${process.env.FEDERATED_DOMAINS_LENGTH || 10} domains`);\n\t}\n\n\t// Ensure a genesis event for this room\n\tconst genesisEvent = await FederationRoomEvents.createGenesisEvent(getFederationDomain(), normalizedRoom);\n\n\t// Dispatch the events\n\tawait dispatchEvents(normalizedRoom.federation.domains, [genesisEvent, ...addUserEvents]);\n}\n\nasync function afterCreateRoom(roomOwner, room) {\n\t// If the room is federated, ignore\n\tif (room.federation) {\n\t\treturn roomOwner;\n\t}\n\n\t// Find all subscriptions of this room\n\tlet subscriptions = await Subscriptions.findByRoomIdWhenUsernameExists(room._id).toArray();\n\tsubscriptions = subscriptions.reduce((acc, s) => {\n\t\tacc[s.u._id] = s;\n\n\t\treturn acc;\n\t}, {});\n\n\t// Get all user ids\n\tconst userIds = Object.keys(subscriptions);\n\n\t// Load all the users\n\tconst users = await Users.findUsersWithUsernameByIds(userIds).toArray();\n\n\t// Check if there is a federated user on this room\n\tconst hasFederatedUser = users.find((u) => u.username.indexOf('@') !== -1);\n\n\t// If there are not federated users on this room, ignore it\n\tif (!hasFederatedUser) {\n\t\treturn roomOwner;\n\t}\n\n\ttry {\n\t\t// If the room is not on the allowed types, ignore\n\t\tif (!checkRoomType(room)) {\n\t\t\tthrow new Error('Channels cannot be federated');\n\t\t}\n\n\t\tclientLogger.debug({ msg: 'afterCreateRoom', roomOwner, room });\n\n\t\tawait doAfterCreateRoom(room, users, subscriptions);\n\t} catch (err) {\n\t\tawait deleteRoom(room._id);\n\n\t\tclientLogger.error({ msg: 'afterCreateRoom => Could not create federated room:', err });\n\t}\n\n\treturn room;\n}\n\nexport const definition = {\n\thook: 'afterCreateRoom',\n\tcallback: afterCreateRoom,\n\tid: 'federation-after-create-room',\n};\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"e3656599a15a4988955a9d81e225b9cc10360b21"}
