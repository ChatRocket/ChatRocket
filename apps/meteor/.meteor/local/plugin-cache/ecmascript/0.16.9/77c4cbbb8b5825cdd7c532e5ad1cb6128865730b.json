{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/packages/oauth1/oauth1_binding.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.arm64"},"sourceFileName":"packages/oauth1/oauth1_binding.js","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/packages/oauth1/oauth1_binding.js","targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true,"topLevelAwait":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/packages/oauth1/oauth1_binding.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/oauth1/oauth1_binding.js"}},"code":"!module.wrapAsync(async function (module, __reifyWaitForDeps__, __reify_async_result__) {\n  \"use strict\";\n  try {\n    let _objectSpread;\n    module.link(\"@babel/runtime/helpers/objectSpread2\", {\n      default(v) {\n        _objectSpread = v;\n      }\n    }, 0);\n    module.export({\n      OAuth1Binding: () => OAuth1Binding\n    });\n    let crypto;\n    module.link(\"crypto\", {\n      default(v) {\n        crypto = v;\n      }\n    }, 0);\n    let querystring;\n    module.link(\"querystring\", {\n      default(v) {\n        querystring = v;\n      }\n    }, 1);\n    let urlModule;\n    module.link(\"url\", {\n      default(v) {\n        urlModule = v;\n      }\n    }, 2);\n    if (__reifyWaitForDeps__()) (await __reifyWaitForDeps__())();\n    class OAuth1Binding {\n      constructor(config, urls) {\n        this._config = config;\n        this._urls = urls;\n      }\n      async prepareRequestToken(callbackUrl) {\n        const headers = this._buildHeader({\n          oauth_callback: callbackUrl\n        });\n        const response = await this._call({\n          method: 'POST',\n          url: this._urls.requestToken,\n          headers\n        });\n        const tokens = querystring.parse(response.content);\n        if (!tokens.oauth_callback_confirmed) throw Object.assign(new Error(\"oauth_callback_confirmed false when requesting oauth1 token\"), {\n          response: response\n        });\n        this.requestToken = tokens.oauth_token;\n        this.requestTokenSecret = tokens.oauth_token_secret;\n      }\n      async prepareAccessToken(query, requestTokenSecret) {\n        // support implementations that use request token secrets. This is\n        // read by this._call.\n        //\n        // XXX make it a param to call, not something stashed on self? It's\n        // kinda confusing right now, everything except this is passed as\n        // arguments, but this is stored.\n        if (requestTokenSecret) this.accessTokenSecret = requestTokenSecret;\n        const headers = this._buildHeader({\n          oauth_token: query.oauth_token,\n          oauth_verifier: query.oauth_verifier\n        });\n        const response = await this._call({\n          method: 'POST',\n          url: this._urls.accessToken,\n          headers\n        });\n        const tokens = querystring.parse(response.content);\n        if (!tokens.oauth_token || !tokens.oauth_token_secret) {\n          const error = new Error(\"missing oauth token or secret\");\n          // We provide response only if no token is available, we do not want to leak any tokens\n          if (!tokens.oauth_token && !tokens.oauth_token_secret) {\n            Object.assign(error, {\n              response: response\n            });\n          }\n          throw error;\n        }\n        this.accessToken = tokens.oauth_token;\n        this.accessTokenSecret = tokens.oauth_token_secret;\n      }\n      async callAsync(method, url, params, callback) {\n        const headers = this._buildHeader({\n          oauth_token: this.accessToken\n        });\n        if (!params) {\n          params = {};\n        }\n        return this._call({\n          method,\n          url,\n          headers,\n          params,\n          callback\n        });\n      }\n      async getAsync(url, params, callback) {\n        return this.callAsync('GET', url, params, callback);\n      }\n      async postAsync(url, params, callback) {\n        return this.callAsync('POST', url, params, callback);\n      }\n      get(url, params, callback) {\n        // Require changes when remove Fibers. Exposed to public api.\n        return this.call('GET', url, params, callback);\n      }\n      post(url, params, callback) {\n        // Require changes when remove Fibers. Exposed to public api.\n        return this.call('POST', url, params, callback);\n      }\n      _buildHeader(headers) {\n        return _objectSpread({\n          oauth_consumer_key: this._config.consumerKey,\n          oauth_nonce: Random.secret().replace(/\\W/g, ''),\n          oauth_signature_method: 'HMAC-SHA1',\n          oauth_timestamp: (new Date().valueOf() / 1000).toFixed().toString(),\n          oauth_version: '1.0'\n        }, headers);\n      }\n      _getSignature(method, url, rawHeaders, accessTokenSecret, params) {\n        const headers = this._encodeHeader(_objectSpread(_objectSpread({}, rawHeaders), params));\n        const parameters = Object.keys(headers).map(key => \"\".concat(key, \"=\").concat(headers[key])).sort().join('&');\n        const signatureBase = [method, this._encodeString(url), this._encodeString(parameters)].join('&');\n        const secret = OAuth.openSecret(this._config.secret);\n        let signingKey = \"\".concat(this._encodeString(secret), \"&\");\n        if (accessTokenSecret) signingKey += this._encodeString(accessTokenSecret);\n        return crypto.createHmac('SHA1', signingKey).update(signatureBase).digest('base64');\n      }\n      async _call(_ref) {\n        let {\n          method,\n          url,\n          headers = {},\n          params = {},\n          callback\n        } = _ref;\n        // all URLs to be functions to support parameters/customization\n        if (typeof url === \"function\") {\n          url = url(this);\n        }\n\n        // Extract all query string parameters from the provided URL\n        const parsedUrl = urlModule.parse(url, true);\n        // Merge them in a way that params given to the method call have precedence\n        params = _objectSpread(_objectSpread({}, parsedUrl.query), params);\n\n        // Reconstruct the URL back without any query string parameters\n        // (they are now in params)\n        parsedUrl.query = {};\n        parsedUrl.search = '';\n        url = urlModule.format(parsedUrl);\n\n        // Get the signature\n        headers.oauth_signature = this._getSignature(method, url, headers, this.accessTokenSecret, params);\n\n        // Make a authorization string according to oauth1 spec\n        const authString = this._getAuthHeaderString(headers);\n        // Make signed request\n        return OAuth._fetch(url, method, _objectSpread({\n          headers: _objectSpread({\n            Authorization: authString\n          }, method.toUpperCase() === 'POST' ? {\n            'Content-Type': 'application/x-www-form-urlencoded'\n          } : {})\n        }, method.toUpperCase() === 'POST' ? {\n          body: OAuth._addValuesToQueryParams(params).toString()\n        } : {\n          queryParams: params\n        })).then(res => res.text().then(content => {\n          const responseHeaders = Array.from(res.headers.entries()).reduce((acc, _ref2) => {\n            let [key, val] = _ref2;\n            return _objectSpread(_objectSpread({}, acc), {}, {\n              [key.toLowerCase()]: val\n            });\n          }, {});\n          const data = responseHeaders['content-type'].includes('application/json') ? JSON.parse(content) : undefined;\n          return {\n            content: data ? '' : content,\n            data,\n            headers: _objectSpread(_objectSpread({}, responseHeaders), {}, {\n              nonce: headers.oauth_nonce\n            }),\n            redirected: res.redirected,\n            ok: res.ok,\n            statusCode: res.status\n          };\n        })).then(response => {\n          if (callback) {\n            callback(undefined, response);\n          }\n          return response;\n        }).catch(err => {\n          if (callback) {\n            callback(err);\n          }\n          console.log({\n            err\n          });\n          throw Object.assign(new Error(\"Failed to send OAuth1 request to \".concat(url, \". \").concat(err.message)), {\n            response: err.response\n          });\n        });\n      }\n      _encodeHeader(header) {\n        return Object.keys(header).reduce((memo, key) => {\n          memo[this._encodeString(key)] = this._encodeString(header[key]);\n          return memo;\n        }, {});\n      }\n      _encodeString(str) {\n        return encodeURIComponent(str).replace(/[!'()]/g, escape).replace(/\\*/g, \"%2A\");\n      }\n      _getAuthHeaderString(headers) {\n        return 'OAuth ' + Object.keys(headers).map(key => \"\".concat(this._encodeString(key), \"=\\\"\").concat(this._encodeString(headers[key]), \"\\\"\")).sort().join(', ');\n      }\n    }\n    ;\n    __reify_async_result__();\n  } catch (_reifyError) {\n    return __reify_async_result__(_reifyError);\n  }\n  __reify_async_result__()\n}, {\n  self: this,\n  async: false\n});","map":{"version":3,"names":["_objectSpread","module","link","default","v","export","OAuth1Binding","crypto","querystring","urlModule","__reifyWaitForDeps__","constructor","config","urls","_config","_urls","prepareRequestToken","callbackUrl","headers","_buildHeader","oauth_callback","response","_call","method","url","requestToken","tokens","parse","content","oauth_callback_confirmed","Object","assign","Error","oauth_token","requestTokenSecret","oauth_token_secret","prepareAccessToken","query","accessTokenSecret","oauth_verifier","accessToken","error","callAsync","params","callback","getAsync","postAsync","get","call","post","oauth_consumer_key","consumerKey","oauth_nonce","Random","secret","replace","oauth_signature_method","oauth_timestamp","Date","valueOf","toFixed","toString","oauth_version","_getSignature","rawHeaders","_encodeHeader","parameters","keys","map","key","concat","sort","join","signatureBase","_encodeString","OAuth","openSecret","signingKey","createHmac","update","digest","_ref","parsedUrl","search","format","oauth_signature","authString","_getAuthHeaderString","_fetch","Authorization","toUpperCase","body","_addValuesToQueryParams","queryParams","then","res","text","responseHeaders","Array","from","entries","reduce","acc","_ref2","val","toLowerCase","data","includes","JSON","undefined","nonce","redirected","ok","statusCode","status","catch","err","console","log","message","header","memo","str","encodeURIComponent","escape","__reify_async_result__","_reifyError","self","async"],"sources":["packages/oauth1/oauth1_binding.js"],"sourcesContent":["import crypto from 'crypto';\nimport querystring from 'querystring';\nimport urlModule from 'url';\n\n// An OAuth1 wrapper around http calls which helps get tokens and\n// takes care of HTTP headers\n//\n// @param config {Object}\n//   - consumerKey (String): oauth consumer key\n//   - secret (String): oauth consumer secret\n// @param urls {Object}\n//   - requestToken (String): url\n//   - authorize (String): url\n//   - accessToken (String): url\n//   - authenticate (String): url\nexport class OAuth1Binding {\n  constructor(config, urls) {\n    this._config = config;\n    this._urls = urls;\n  }\n\n  async prepareRequestToken(callbackUrl) {\n    const headers = this._buildHeader({\n      oauth_callback: callbackUrl\n    });\n\n    const response = await this._call({method: 'POST', url: this._urls.requestToken, headers});\n    const tokens = querystring.parse(response.content);\n\n    if (! tokens.oauth_callback_confirmed)\n      throw Object.assign(new Error(\"oauth_callback_confirmed false when requesting oauth1 token\"),\n                               {response: response});\n\n    this.requestToken = tokens.oauth_token;\n    this.requestTokenSecret = tokens.oauth_token_secret;\n  }\n\n  async prepareAccessToken(query, requestTokenSecret) {\n    // support implementations that use request token secrets. This is\n    // read by this._call.\n    //\n    // XXX make it a param to call, not something stashed on self? It's\n    // kinda confusing right now, everything except this is passed as\n    // arguments, but this is stored.\n    if (requestTokenSecret)\n      this.accessTokenSecret = requestTokenSecret;\n\n    const headers = this._buildHeader({\n      oauth_token: query.oauth_token,\n      oauth_verifier: query.oauth_verifier\n    });\n\n    const response = await this._call({ method: 'POST', url: this._urls.accessToken, headers });\n    const tokens = querystring.parse(response.content);\n\n    if (! tokens.oauth_token || ! tokens.oauth_token_secret) {\n      const error = new Error(\"missing oauth token or secret\");\n      // We provide response only if no token is available, we do not want to leak any tokens\n      if (! tokens.oauth_token && ! tokens.oauth_token_secret) {\n        Object.assign(error, {response: response});\n      }\n      throw error;\n    }\n\n    this.accessToken = tokens.oauth_token;\n    this.accessTokenSecret = tokens.oauth_token_secret;\n  }\n\n  async callAsync(method, url, params, callback) {\n    const headers = this._buildHeader({\n      oauth_token: this.accessToken\n    });\n\n    if(! params) {\n      params = {};\n    }\n\n    return this._call({ method, url, headers, params, callback });\n  }\n\n  async getAsync(url, params, callback) {\n    return this.callAsync('GET', url, params, callback);\n  }\n\n  async postAsync(url, params, callback) {\n    return this.callAsync('POST', url, params, callback);\n  }\n\n  get(url, params, callback) {\n    // Require changes when remove Fibers. Exposed to public api.\n    return this.call('GET', url, params, callback);\n  }\n\n  post(url, params, callback) {\n    // Require changes when remove Fibers. Exposed to public api.\n    return this.call('POST', url, params, callback);\n  }\n\n  _buildHeader(headers) {\n    return {\n      oauth_consumer_key: this._config.consumerKey,\n      oauth_nonce: Random.secret().replace(/\\W/g, ''),\n      oauth_signature_method: 'HMAC-SHA1',\n      oauth_timestamp: (new Date().valueOf()/1000).toFixed().toString(),\n      oauth_version: '1.0',\n      ...headers,\n    }\n  }\n\n  _getSignature(method, url, rawHeaders, accessTokenSecret, params) {\n    const headers = this._encodeHeader({ ...rawHeaders, ...params });\n\n    const parameters = Object.keys(headers).map(key => `${key}=${headers[key]}`)\n      .sort().join('&');\n\n    const signatureBase = [\n      method,\n      this._encodeString(url),\n      this._encodeString(parameters)\n    ].join('&');\n\n    const secret = OAuth.openSecret(this._config.secret);\n\n    let signingKey = `${this._encodeString(secret)}&`;\n    if (accessTokenSecret)\n      signingKey += this._encodeString(accessTokenSecret);\n\n    return crypto.createHmac('SHA1', signingKey).update(signatureBase).digest('base64');\n  };\n\n  async _call({method, url, headers = {}, params = {}, callback}) {\n    // all URLs to be functions to support parameters/customization\n    if(typeof url === \"function\") {\n      url = url(this);\n    }\n\n    // Extract all query string parameters from the provided URL\n    const parsedUrl = urlModule.parse(url, true);\n    // Merge them in a way that params given to the method call have precedence\n    params = { ...parsedUrl.query, ...params };\n\n    // Reconstruct the URL back without any query string parameters\n    // (they are now in params)\n    parsedUrl.query = {};\n    parsedUrl.search = '';\n    url = urlModule.format(parsedUrl);\n\n    // Get the signature\n    headers.oauth_signature =\n      this._getSignature(method, url, headers, this.accessTokenSecret, params);\n\n    // Make a authorization string according to oauth1 spec\n    const authString = this._getAuthHeaderString(headers);\n    // Make signed request\n    return OAuth._fetch(url, method, {\n      headers: {\n        Authorization: authString,\n        ...(method.toUpperCase() === 'POST' ? { 'Content-Type': 'application/x-www-form-urlencoded' } : {})\n      },\n      ...(method.toUpperCase() === 'POST' ?\n        { body: OAuth._addValuesToQueryParams(params).toString() }\n        : { queryParams: params })\n    }).then((res) =>\n        res.text().then((content) => {\n          const responseHeaders = Array.from(res.headers.entries()).reduce(\n            (acc, [key, val]) => {\n              return { ...acc, [key.toLowerCase()]: val };\n            },\n            {}\n          );\n          const data = responseHeaders['content-type'].includes('application/json') ?\n            JSON.parse(content) : undefined;\n          return  {\n            content: data ? '' : content,\n            data,\n            headers: { ...responseHeaders, nonce: headers.oauth_nonce },\n            redirected: res.redirected,\n            ok: res.ok,\n            statusCode: res.status,\n          };\n        })\n      )\n      .then((response) => {\n        if (callback) {\n          callback(undefined, response);\n        }\n        return response;\n      })\n      .catch((err) => {\n        if (callback) {\n          callback(err);\n        }\n        console.log({ err });\n        throw Object.assign(\n          new Error(`Failed to send OAuth1 request to ${url}. ${err.message}`),\n          { response: err.response }\n        );\n      });\n  }\n\n  _encodeHeader(header) {\n    return Object.keys(header).reduce((memo, key) => {\n      memo[this._encodeString(key)] = this._encodeString(header[key]);\n      return memo;\n    }, {});\n  };\n\n  _encodeString(str) {\n    return encodeURIComponent(str).replace(/[!'()]/g, escape).replace(/\\*/g, \"%2A\");\n  };\n\n  _getAuthHeaderString(headers) {\n    return 'OAuth ' +  Object.keys(headers).map(key =>\n      `${this._encodeString(key)}=\"${this._encodeString(headers[key])}\"`\n    ).sort().join(', ');\n  };\n\n};\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"77c4cbbb8b5825cdd7c532e5ad1cb6128865730b"}
