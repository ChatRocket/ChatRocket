{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/packages/facebook-oauth/facebook_server.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.arm64"},"sourceFileName":"packages/facebook-oauth/facebook_server.js","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/packages/facebook-oauth/facebook_server.js","targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true,"topLevelAwait":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/packages/facebook-oauth/facebook_server.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/facebook-oauth/facebook_server.js"}},"code":"!module.wrapAsync(async function (module, __reifyWaitForDeps__, __reify_async_result__) {\n  \"use strict\";\n  try {\n    let _objectSpread;\n    module.link(\"@babel/runtime/helpers/objectSpread2\", {\n      default(v) {\n        _objectSpread = v;\n      }\n    }, 0);\n    var _Meteor$settings, _Meteor$settings$publ, _Meteor$settings$publ2, _Meteor$settings$publ3;\n    let crypto;\n    module.link(\"crypto\", {\n      default(v) {\n        crypto = v;\n      }\n    }, 0);\n    let Accounts;\n    module.link(\"meteor/accounts-base\", {\n      Accounts(v) {\n        Accounts = v;\n      }\n    }, 1);\n    if (__reifyWaitForDeps__()) (await __reifyWaitForDeps__())();\n    Facebook = {};\n    const API_VERSION = ((_Meteor$settings = Meteor.settings) === null || _Meteor$settings === void 0 ? void 0 : (_Meteor$settings$publ = _Meteor$settings.public) === null || _Meteor$settings$publ === void 0 ? void 0 : (_Meteor$settings$publ2 = _Meteor$settings$publ.packages) === null || _Meteor$settings$publ2 === void 0 ? void 0 : (_Meteor$settings$publ3 = _Meteor$settings$publ2['facebook-oauth']) === null || _Meteor$settings$publ3 === void 0 ? void 0 : _Meteor$settings$publ3.apiVersion) || '17.0';\n    Facebook.handleAuthFromAccessToken = async (accessToken, expiresAt) => {\n      // include basic fields from facebook\n      // https://developers.facebook.com/docs/facebook-login/permissions/\n      const whitelisted = ['id', 'email', 'name', 'first_name', 'last_name', 'middle_name', 'name_format', 'picture', 'short_name'];\n      const identity = await getIdentity(accessToken, whitelisted);\n      const fields = {};\n      whitelisted.forEach(field => fields[field] = identity[field]);\n      const serviceData = _objectSpread({\n        accessToken,\n        expiresAt\n      }, fields);\n      return {\n        serviceData,\n        options: {\n          profile: {\n            name: identity.name\n          }\n        }\n      };\n    };\n    Accounts.registerLoginHandler(request => {\n      if (request.facebookSignIn !== true) {\n        return;\n      }\n      const facebookData = Facebook.handleAuthFromAccessToken(request.accessToken, +new Date() + 1000 * request.expirationTime);\n      return Accounts.updateOrCreateUserFromExternalService('facebook', facebookData.serviceData, facebookData.options);\n    });\n    OAuth.registerService('facebook', 2, null, async query => {\n      const response = await getTokenResponse(query);\n      const {\n        accessToken\n      } = response;\n      const {\n        expiresIn\n      } = response;\n      return Facebook.handleAuthFromAccessToken(accessToken, +new Date() + 1000 * expiresIn);\n    });\n    function getAbsoluteUrlOptions(query) {\n      var _Meteor$settings2, _Meteor$settings2$pac, _Meteor$settings2$pac2;\n      const overrideRootUrlFromStateRedirectUrl = (_Meteor$settings2 = Meteor.settings) === null || _Meteor$settings2 === void 0 ? void 0 : (_Meteor$settings2$pac = _Meteor$settings2.packages) === null || _Meteor$settings2$pac === void 0 ? void 0 : (_Meteor$settings2$pac2 = _Meteor$settings2$pac['facebook-oauth']) === null || _Meteor$settings2$pac2 === void 0 ? void 0 : _Meteor$settings2$pac2.overrideRootUrlFromStateRedirectUrl;\n      if (!overrideRootUrlFromStateRedirectUrl) {\n        return undefined;\n      }\n      try {\n        const state = OAuth._stateFromQuery(query) || {};\n        const redirectUrl = new URL(state.redirectUrl);\n        return {\n          rootUrl: redirectUrl.origin\n        };\n      } catch (e) {\n        console.error(\"Failed to complete OAuth handshake with Facebook because it was not able to obtain the redirect url from the state and you are using overrideRootUrlFromStateRedirectUrl.\", e);\n        return undefined;\n      }\n    }\n\n    /**\n     * @typedef {Object} UserAccessToken\n     * @property {string} accessToken - User access Token\n     * @property {number} expiresIn - lifetime of token in seconds\n     */\n    /**\n     * @async\n     * @function getTokenResponse\n     * @param {Object} query - An object with the code.\n     * @returns {Promise<UserAccessToken>} - Promise with an Object containing the accessToken and expiresIn (lifetime of token in seconds)\n     */\n    const getTokenResponse = async query => {\n      const config = await ServiceConfiguration.configurations.findOneAsync({\n        service: 'facebook'\n      });\n      if (!config) throw new ServiceConfiguration.ConfigError();\n      const absoluteUrlOptions = getAbsoluteUrlOptions(query);\n      const redirectUri = OAuth._redirectUri('facebook', config, undefined, absoluteUrlOptions);\n      return OAuth._fetch(\"https://graph.facebook.com/v\".concat(API_VERSION, \"/oauth/access_token\"), 'GET', {\n        queryParams: {\n          client_id: config.appId,\n          redirect_uri: redirectUri,\n          client_secret: OAuth.openSecret(config.secret),\n          code: query.code\n        }\n      }).then(res => res.json()).then(data => {\n        const fbAccessToken = data.access_token;\n        console.log(\"-> fbAccessToken\", fbAccessToken);\n        const fbExpires = data.expires_in;\n        if (!fbAccessToken) {\n          throw new Error(\"Failed to complete OAuth handshake with facebook \" + \"-- can't find access token in HTTP response. \".concat(data));\n        }\n        return {\n          accessToken: fbAccessToken,\n          expiresIn: fbExpires\n        };\n      }).catch(err => {\n        throw Object.assign(new Error(\"Failed to complete OAuth handshake with Facebook. \".concat(err.message)), {\n          response: err.response\n        });\n      });\n    };\n    const getIdentity = async (accessToken, fields) => {\n      const config = await ServiceConfiguration.configurations.findOneAsync({\n        service: 'facebook'\n      });\n      if (!config) throw new ServiceConfiguration.ConfigError();\n\n      // Generate app secret proof that is a sha256 hash of the app access token, with the app secret as the key\n      // https://developers.facebook.com/docs/graph-api/securing-requests#appsecret_proof\n      const hmac = crypto.createHmac('sha256', OAuth.openSecret(config.secret));\n      hmac.update(accessToken);\n      return OAuth._fetch(\"https://graph.facebook.com/v\".concat(API_VERSION, \"/me\"), 'GET', {\n        queryParams: {\n          access_token: accessToken,\n          appsecret_proof: hmac.digest('hex'),\n          fields: fields.join(',')\n        }\n      }).then(res => res.json()).catch(err => {\n        throw Object.assign(new Error(\"Failed to fetch identity from Facebook. \".concat(err.message)), {\n          response: err.response\n        });\n      });\n    };\n    Facebook.retrieveCredential = (credentialToken, credentialSecret) => OAuth.retrieveCredential(credentialToken, credentialSecret);\n    __reify_async_result__();\n  } catch (_reifyError) {\n    return __reify_async_result__(_reifyError);\n  }\n  __reify_async_result__()\n}, {\n  self: this,\n  async: false\n});","map":{"version":3,"names":["_objectSpread","module","link","default","v","_Meteor$settings","_Meteor$settings$publ","_Meteor$settings$publ2","_Meteor$settings$publ3","crypto","Accounts","__reifyWaitForDeps__","Facebook","API_VERSION","Meteor","settings","public","packages","apiVersion","handleAuthFromAccessToken","accessToken","expiresAt","whitelisted","identity","getIdentity","fields","forEach","field","serviceData","options","profile","name","registerLoginHandler","request","facebookSignIn","facebookData","Date","expirationTime","updateOrCreateUserFromExternalService","OAuth","registerService","query","response","getTokenResponse","expiresIn","getAbsoluteUrlOptions","_Meteor$settings2","_Meteor$settings2$pac","_Meteor$settings2$pac2","overrideRootUrlFromStateRedirectUrl","undefined","state","_stateFromQuery","redirectUrl","URL","rootUrl","origin","e","console","error","config","ServiceConfiguration","configurations","findOneAsync","service","ConfigError","absoluteUrlOptions","redirectUri","_redirectUri","_fetch","concat","queryParams","client_id","appId","redirect_uri","client_secret","openSecret","secret","code","then","res","json","data","fbAccessToken","access_token","log","fbExpires","expires_in","Error","catch","err","Object","assign","message","hmac","createHmac","update","appsecret_proof","digest","join","retrieveCredential","credentialToken","credentialSecret","__reify_async_result__","_reifyError","self","async"],"sources":["packages/facebook-oauth/facebook_server.js"],"sourcesContent":["Facebook = {};\nimport crypto from 'crypto';\nimport { Accounts } from 'meteor/accounts-base';\n\nconst API_VERSION = Meteor.settings?.public?.packages?.['facebook-oauth']?.apiVersion || '17.0';\n\nFacebook.handleAuthFromAccessToken = async (accessToken, expiresAt) => {\n  // include basic fields from facebook\n  // https://developers.facebook.com/docs/facebook-login/permissions/\n  const whitelisted = ['id', 'email', 'name', 'first_name', 'last_name',\n    'middle_name', 'name_format', 'picture', 'short_name'];\n\n  const identity = await getIdentity(accessToken, whitelisted);\n\n  const fields = {};\n  whitelisted.forEach(field => fields[field] = identity[field]);\n  const serviceData = {\n    accessToken,\n    expiresAt,\n    ...fields,\n  };\n\n  return {\n    serviceData,\n    options: {profile: {name: identity.name}}\n  };\n};\n\nAccounts.registerLoginHandler(request => {\n  if (request.facebookSignIn !== true) {\n    return;\n  }\n  const facebookData = Facebook.handleAuthFromAccessToken(request.accessToken, (+new Date) + (1000 * request.expirationTime));\n  return Accounts.updateOrCreateUserFromExternalService('facebook', facebookData.serviceData, facebookData.options);\n});\n\nOAuth.registerService('facebook', 2, null, async query => {\n  const response = await getTokenResponse(query);\n  const { accessToken } = response;\n  const { expiresIn } = response;\n\n  return Facebook.handleAuthFromAccessToken(accessToken, (+new Date) + (1000 * expiresIn));\n});\n\nfunction getAbsoluteUrlOptions(query) {\n  const overrideRootUrlFromStateRedirectUrl = Meteor.settings?.packages?.['facebook-oauth']?.overrideRootUrlFromStateRedirectUrl;\n  if (!overrideRootUrlFromStateRedirectUrl) {\n    return undefined;\n  }\n  try {\n    const state = OAuth._stateFromQuery(query) || {};\n    const redirectUrl = new URL(state.redirectUrl);\n    return {\n      rootUrl: redirectUrl.origin,\n    };\n  } catch (e) {\n    console.error(\n      `Failed to complete OAuth handshake with Facebook because it was not able to obtain the redirect url from the state and you are using overrideRootUrlFromStateRedirectUrl.`, e\n    );\n    return undefined;\n  }\n}\n\n/**\n * @typedef {Object} UserAccessToken\n * @property {string} accessToken - User access Token\n * @property {number} expiresIn - lifetime of token in seconds\n */\n/**\n * @async\n * @function getTokenResponse\n * @param {Object} query - An object with the code.\n * @returns {Promise<UserAccessToken>} - Promise with an Object containing the accessToken and expiresIn (lifetime of token in seconds)\n */\nconst getTokenResponse = async (query) => {\n  const config = await ServiceConfiguration.configurations.findOneAsync({\n    service: 'facebook',\n  });\n  if (!config) throw new ServiceConfiguration.ConfigError();\n\n  const absoluteUrlOptions = getAbsoluteUrlOptions(query);\n  const redirectUri = OAuth._redirectUri('facebook', config, undefined, absoluteUrlOptions);\n\n  return OAuth._fetch(\n    `https://graph.facebook.com/v${API_VERSION}/oauth/access_token`,\n    'GET',\n    {\n      queryParams: {\n        client_id: config.appId,\n        redirect_uri: redirectUri,\n        client_secret: OAuth.openSecret(config.secret),\n        code: query.code,\n      },\n    }\n  )\n    .then((res) => res.json())\n    .then(data => {\n      const fbAccessToken = data.access_token;\n      console.log(\"-> fbAccessToken\", fbAccessToken);\n      const fbExpires = data.expires_in;\n      if (!fbAccessToken) {\n        throw new Error(\"Failed to complete OAuth handshake with facebook \" +\n          `-- can't find access token in HTTP response. ${data}`);\n      }\n      return {\n        accessToken: fbAccessToken,\n        expiresIn: fbExpires\n      };\n    })\n    .catch((err) => {\n      throw Object.assign(\n        new Error(\n          `Failed to complete OAuth handshake with Facebook. ${err.message}`\n        ),\n        { response: err.response }\n      );\n    });\n};\n\nconst getIdentity = async (accessToken, fields) => {\n  const config = await ServiceConfiguration.configurations.findOneAsync({\n    service: 'facebook',\n  });\n  if (!config) throw new ServiceConfiguration.ConfigError();\n\n  // Generate app secret proof that is a sha256 hash of the app access token, with the app secret as the key\n  // https://developers.facebook.com/docs/graph-api/securing-requests#appsecret_proof\n  const hmac = crypto.createHmac('sha256', OAuth.openSecret(config.secret));\n  hmac.update(accessToken);\n\n  return OAuth._fetch(`https://graph.facebook.com/v${API_VERSION}/me`, 'GET', {\n    queryParams: {\n      access_token: accessToken,\n      appsecret_proof: hmac.digest('hex'),\n      fields: fields.join(','),\n    },\n  })\n    .then((res) => res.json())\n    .catch((err) => {\n      throw Object.assign(\n        new Error(`Failed to fetch identity from Facebook. ${err.message}`),\n        { response: err.response }\n      );\n    });\n};\n\nFacebook.retrieveCredential = (credentialToken, credentialSecret) =>\n  OAuth.retrieveCredential(credentialToken, credentialSecret);\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"07c5afffa6daa5122884df6b87355007bb0531c2"}
